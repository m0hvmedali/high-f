var ap=Object.defineProperty;var ou=o=>{throw TypeError(o)};var op=(o,i,_)=>i in o?ap(o,i,{enumerable:!0,configurable:!0,writable:!0,value:_}):o[i]=_;var Rn=(o,i,_)=>op(o,typeof i!="symbol"?i+"":i,_),Mo=(o,i,_)=>i.has(o)||ou("Cannot "+_);var $t=(o,i,_)=>(Mo(o,i,"read from private field"),_?_.call(o):i.get(o)),Er=(o,i,_)=>i.has(o)?ou("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(o):i.set(o,_),Tr=(o,i,_,$)=>(Mo(o,i,"write to private field"),$?$.call(o,_):i.set(o,_),_),mr=(o,i,_)=>(Mo(o,i,"access private method"),_);var Os=(o,i,_,$)=>({set _(j){Tr(o,i,j,_)},get _(){return $t(o,i,$)}});function _mergeNamespaces(o,i){for(var _=0;_<i.length;_++){const $=i[_];if(typeof $!="string"&&!Array.isArray($)){for(const j in $)if(j!=="default"&&!(j in o)){const _e=Object.getOwnPropertyDescriptor($,j);_e&&Object.defineProperty(o,j,_e.get?_e:{enumerable:!0,get:()=>$[j]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const j of document.querySelectorAll('link[rel="modulepreload"]'))$(j);new MutationObserver(j=>{for(const _e of j)if(_e.type==="childList")for(const et of _e.addedNodes)et.tagName==="LINK"&&et.rel==="modulepreload"&&$(et)}).observe(document,{childList:!0,subtree:!0});function _(j){const _e={};return j.integrity&&(_e.integrity=j.integrity),j.referrerPolicy&&(_e.referrerPolicy=j.referrerPolicy),j.crossOrigin==="use-credentials"?_e.credentials="include":j.crossOrigin==="anonymous"?_e.credentials="omit":_e.credentials="same-origin",_e}function $(j){if(j.ep)return;j.ep=!0;const _e=_(j);fetch(j.href,_e)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function getAugmentedNamespace(o){if(o.__esModule)return o;var i=o.default;if(typeof i=="function"){var _=function $(){return this instanceof $?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};_.prototype=i.prototype}else _={};return Object.defineProperty(_,"__esModule",{value:!0}),Object.keys(o).forEach(function($){var j=Object.getOwnPropertyDescriptor(o,$);Object.defineProperty(_,$,j.get?j:{enumerable:!0,get:function(){return o[$]}})}),_}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$3=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x$1=Symbol.for("react.memo"),y$1=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(o){return o===null||typeof o!="object"?null:(o=z$1&&o[z$1]||o["@@iterator"],typeof o=="function"?o:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(o,i,_){this.props=o,this.context=i,this.refs=D$1,this.updater=_||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(o,i){if(typeof o!="object"&&typeof o!="function"&&o!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,o,i,"setState")};E$1.prototype.forceUpdate=function(o){this.updater.enqueueForceUpdate(this,o,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(o,i,_){this.props=o,this.context=i,this.refs=D$1,this.updater=_||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(o,i,_){var $,j={},_e=null,et=null;if(i!=null)for($ in i.ref!==void 0&&(et=i.ref),i.key!==void 0&&(_e=""+i.key),i)J.call(i,$)&&!L$1.hasOwnProperty($)&&(j[$]=i[$]);var tt=arguments.length-2;if(tt===1)j.children=_;else if(1<tt){for(var rt=Array(tt),nt=0;nt<tt;nt++)rt[nt]=arguments[nt+2];j.children=rt}if(o&&o.defaultProps)for($ in tt=o.defaultProps,tt)j[$]===void 0&&(j[$]=tt[$]);return{$$typeof:l$2,type:o,key:_e,ref:et,props:j,_owner:K$1.current}}function N$1(o,i){return{$$typeof:l$2,type:o.type,key:i,ref:o.ref,props:o.props,_owner:o._owner}}function O$1(o){return typeof o=="object"&&o!==null&&o.$$typeof===l$2}function escape$2(o){var i={"=":"=0",":":"=2"};return"$"+o.replace(/[=:]/g,function(_){return i[_]})}var P$2=/\/+/g;function Q$1(o,i){return typeof o=="object"&&o!==null&&o.key!=null?escape$2(""+o.key):i.toString(36)}function R$1(o,i,_,$,j){var _e=typeof o;(_e==="undefined"||_e==="boolean")&&(o=null);var et=!1;if(o===null)et=!0;else switch(_e){case"string":case"number":et=!0;break;case"object":switch(o.$$typeof){case l$2:case n$2:et=!0}}if(et)return et=o,j=j(et),o=$===""?"."+Q$1(et,0):$,I$1(j)?(_="",o!=null&&(_=o.replace(P$2,"$&/")+"/"),R$1(j,i,_,"",function(nt){return nt})):j!=null&&(O$1(j)&&(j=N$1(j,_+(!j.key||et&&et.key===j.key?"":(""+j.key).replace(P$2,"$&/")+"/")+o)),i.push(j)),1;if(et=0,$=$===""?".":$+":",I$1(o))for(var tt=0;tt<o.length;tt++){_e=o[tt];var rt=$+Q$1(_e,tt);et+=R$1(_e,i,_,rt,j)}else if(rt=A$1(o),typeof rt=="function")for(o=rt.call(o),tt=0;!(_e=o.next()).done;)_e=_e.value,rt=$+Q$1(_e,tt++),et+=R$1(_e,i,_,rt,j);else if(_e==="object")throw i=String(o),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return et}function S$1(o,i,_){if(o==null)return o;var $=[],j=0;return R$1(o,$,"","",function(_e){return i.call(_,_e,j++)}),$}function T$1(o){if(o._status===-1){var i=o._result;i=i(),i.then(function(_){(o._status===0||o._status===-1)&&(o._status=1,o._result=_)},function(_){(o._status===0||o._status===-1)&&(o._status=2,o._result=_)}),o._status===-1&&(o._status=0,o._result=i)}if(o._status===1)return o._result.default;throw o._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(o,i,_){S$1(o,function(){i.apply(this,arguments)},_)},count:function(o){var i=0;return S$1(o,function(){i++}),i},toArray:function(o){return S$1(o,function(i){return i})||[]},only:function(o){if(!O$1(o))throw Error("React.Children.only expected to receive a single React element child.");return o}};react_production_min.Component=E$1;react_production_min.Fragment=p$3;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$2;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(o,i,_){if(o==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+o+".");var $=C$1({},o.props),j=o.key,_e=o.ref,et=o._owner;if(i!=null){if(i.ref!==void 0&&(_e=i.ref,et=K$1.current),i.key!==void 0&&(j=""+i.key),o.type&&o.type.defaultProps)var tt=o.type.defaultProps;for(rt in i)J.call(i,rt)&&!L$1.hasOwnProperty(rt)&&($[rt]=i[rt]===void 0&&tt!==void 0?tt[rt]:i[rt])}var rt=arguments.length-2;if(rt===1)$.children=_;else if(1<rt){tt=Array(rt);for(var nt=0;nt<rt;nt++)tt[nt]=arguments[nt+2];$.children=tt}return{$$typeof:l$2,type:o.type,key:j,ref:_e,props:$,_owner:et}};react_production_min.createContext=function(o){return o={$$typeof:u$1,_currentValue:o,_currentValue2:o,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},o.Provider={$$typeof:t$1,_context:o},o.Consumer=o};react_production_min.createElement=M$1;react_production_min.createFactory=function(o){var i=M$1.bind(null,o);return i.type=o,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(o){return{$$typeof:v$2,render:o}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(o){return{$$typeof:y$1,_payload:{_status:-1,_result:o},_init:T$1}};react_production_min.memo=function(o,i){return{$$typeof:x$1,type:o,compare:i===void 0?null:i}};react_production_min.startTransition=function(o){var i=V$1.transition;V$1.transition={};try{o()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(o,i){return U$1.current.useCallback(o,i)};react_production_min.useContext=function(o){return U$1.current.useContext(o)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(o){return U$1.current.useDeferredValue(o)};react_production_min.useEffect=function(o,i){return U$1.current.useEffect(o,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(o,i,_){return U$1.current.useImperativeHandle(o,i,_)};react_production_min.useInsertionEffect=function(o,i){return U$1.current.useInsertionEffect(o,i)};react_production_min.useLayoutEffect=function(o,i){return U$1.current.useLayoutEffect(o,i)};react_production_min.useMemo=function(o,i){return U$1.current.useMemo(o,i)};react_production_min.useReducer=function(o,i,_){return U$1.current.useReducer(o,i,_)};react_production_min.useRef=function(o){return U$1.current.useRef(o)};react_production_min.useState=function(o){return U$1.current.useState(o)};react_production_min.useSyncExternalStore=function(o,i,_){return U$1.current.useSyncExternalStore(o,i,_)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React$2=getDefaultExportFromCjs$1(reactExports),React$3=_mergeNamespaces({__proto__:null,default:React$2},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$2=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$2={key:!0,ref:!0,__self:!0,__source:!0};function q$1(o,i,_){var $,j={},_e=null,et=null;_!==void 0&&(_e=""+_),i.key!==void 0&&(_e=""+i.key),i.ref!==void 0&&(et=i.ref);for($ in i)m$2.call(i,$)&&!p$2.hasOwnProperty($)&&(j[$]=i[$]);if(o&&o.defaultProps)for($ in i=o.defaultProps,i)j[$]===void 0&&(j[$]=i[$]);return{$$typeof:k$2,type:o,key:_e,ref:et,props:j,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(o){function i(Et,_t){var Mt=Et.length;Et.push(_t);e:for(;0<Mt;){var Dt=Mt-1>>>1,Lt=Et[Dt];if(0<j(Lt,_t))Et[Dt]=_t,Et[Mt]=Lt,Mt=Dt;else break e}}function _(Et){return Et.length===0?null:Et[0]}function $(Et){if(Et.length===0)return null;var _t=Et[0],Mt=Et.pop();if(Mt!==_t){Et[0]=Mt;e:for(var Dt=0,Lt=Et.length,Ct=Lt>>>1;Dt<Ct;){var kt=2*(Dt+1)-1,jt=Et[kt],Vt=kt+1,zt=Et[Vt];if(0>j(jt,Mt))Vt<Lt&&0>j(zt,jt)?(Et[Dt]=zt,Et[Vt]=Mt,Dt=Vt):(Et[Dt]=jt,Et[kt]=Mt,Dt=kt);else if(Vt<Lt&&0>j(zt,Mt))Et[Dt]=zt,Et[Vt]=Mt,Dt=Vt;else break e}}return _t}function j(Et,_t){var Mt=Et.sortIndex-_t.sortIndex;return Mt!==0?Mt:Et.id-_t.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _e=performance;o.unstable_now=function(){return _e.now()}}else{var et=Date,tt=et.now();o.unstable_now=function(){return et.now()-tt}}var rt=[],nt=[],it=1,st=null,at=3,ot=!1,lt=!1,ct=!1,ft=typeof setTimeout=="function"?setTimeout:null,ut=typeof clearTimeout=="function"?clearTimeout:null,ht=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function dt(Et){for(var _t=_(nt);_t!==null;){if(_t.callback===null)$(nt);else if(_t.startTime<=Et)$(nt),_t.sortIndex=_t.expirationTime,i(rt,_t);else break;_t=_(nt)}}function mt(Et){if(ct=!1,dt(Et),!lt)if(_(rt)!==null)lt=!0,Pt(pt);else{var _t=_(nt);_t!==null&&Rt(mt,_t.startTime-Et)}}function pt(Et,_t){lt=!1,ct&&(ct=!1,ut(vt),vt=-1),ot=!0;var Mt=at;try{for(dt(_t),st=_(rt);st!==null&&(!(st.expirationTime>_t)||Et&&!xt());){var Dt=st.callback;if(typeof Dt=="function"){st.callback=null,at=st.priorityLevel;var Lt=Dt(st.expirationTime<=_t);_t=o.unstable_now(),typeof Lt=="function"?st.callback=Lt:st===_(rt)&&$(rt),dt(_t)}else $(rt);st=_(rt)}if(st!==null)var Ct=!0;else{var kt=_(nt);kt!==null&&Rt(mt,kt.startTime-_t),Ct=!1}return Ct}finally{st=null,at=Mt,ot=!1}}var yt=!1,gt=null,vt=-1,St=5,At=-1;function xt(){return!(o.unstable_now()-At<St)}function wt(){if(gt!==null){var Et=o.unstable_now();At=Et;var _t=!0;try{_t=gt(!0,Et)}finally{_t?Ot():(yt=!1,gt=null)}}else yt=!1}var Ot;if(typeof ht=="function")Ot=function(){ht(wt)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Ft=Bt.port2;Bt.port1.onmessage=wt,Ot=function(){Ft.postMessage(null)}}else Ot=function(){ft(wt,0)};function Pt(Et){gt=Et,yt||(yt=!0,Ot())}function Rt(Et,_t){vt=ft(function(){Et(o.unstable_now())},_t)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(Et){Et.callback=null},o.unstable_continueExecution=function(){lt||ot||(lt=!0,Pt(pt))},o.unstable_forceFrameRate=function(Et){0>Et||125<Et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):St=0<Et?Math.floor(1e3/Et):5},o.unstable_getCurrentPriorityLevel=function(){return at},o.unstable_getFirstCallbackNode=function(){return _(rt)},o.unstable_next=function(Et){switch(at){case 1:case 2:case 3:var _t=3;break;default:_t=at}var Mt=at;at=_t;try{return Et()}finally{at=Mt}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(Et,_t){switch(Et){case 1:case 2:case 3:case 4:case 5:break;default:Et=3}var Mt=at;at=Et;try{return _t()}finally{at=Mt}},o.unstable_scheduleCallback=function(Et,_t,Mt){var Dt=o.unstable_now();switch(typeof Mt=="object"&&Mt!==null?(Mt=Mt.delay,Mt=typeof Mt=="number"&&0<Mt?Dt+Mt:Dt):Mt=Dt,Et){case 1:var Lt=-1;break;case 2:Lt=250;break;case 5:Lt=1073741823;break;case 4:Lt=1e4;break;default:Lt=5e3}return Lt=Mt+Lt,Et={id:it++,callback:_t,priorityLevel:Et,startTime:Mt,expirationTime:Lt,sortIndex:-1},Mt>Dt?(Et.sortIndex=Mt,i(nt,Et),_(rt)===null&&Et===_(nt)&&(ct?(ut(vt),vt=-1):ct=!0,Rt(mt,Mt-Dt))):(Et.sortIndex=Lt,i(rt,Et),lt||ot||(lt=!0,Pt(pt))),Et},o.unstable_shouldYield=xt,o.unstable_wrapCallback=function(Et){var _t=at;return function(){var Mt=at;at=_t;try{return Et.apply(this,arguments)}finally{at=Mt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$1(o){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+o,_=1;_<arguments.length;_++)i+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+o+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(o,i){ha(o,i),ha(o+"Capture",i)}function ha(o,i){for(ea[o]=i,o=0;o<i.length;o++)da.add(i[o])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(o){return ja.call(ma,o)?!0:ja.call(la,o)?!1:ka$1.test(o)?ma[o]=!0:(la[o]=!0,!1)}function pa(o,i,_,$){if(_!==null&&_.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return $?!1:_!==null?!_.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function qa(o,i,_,$){if(i===null||typeof i>"u"||pa(o,i,_,$))return!0;if($)return!1;if(_!==null)switch(_.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v$1(o,i,_,$,j,_e,et){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=$,this.attributeNamespace=j,this.mustUseProperty=_,this.propertyName=o,this.type=i,this.sanitizeURL=_e,this.removeEmptyString=et}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){z[o]=new v$1(o,0,!1,o,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var i=o[0];z[i]=new v$1(i,1,!1,o[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(o){z[o]=new v$1(o,2,!1,o.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){z[o]=new v$1(o,2,!1,o,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){z[o]=new v$1(o,3,!1,o.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(o){z[o]=new v$1(o,3,!0,o,null,!1,!1)});["capture","download"].forEach(function(o){z[o]=new v$1(o,4,!1,o,null,!1,!1)});["cols","rows","size","span"].forEach(function(o){z[o]=new v$1(o,6,!1,o,null,!1,!1)});["rowSpan","start"].forEach(function(o){z[o]=new v$1(o,5,!1,o.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var i=o.replace(ra,sa);z[i]=new v$1(i,1,!1,o,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var i=o.replace(ra,sa);z[i]=new v$1(i,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(o){var i=o.replace(ra,sa);z[i]=new v$1(i,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(o){z[o]=new v$1(o,1,!1,o.toLowerCase(),null,!1,!1)});z.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(o){z[o]=new v$1(o,1,!1,o.toLowerCase(),null,!0,!0)});function ta(o,i,_,$){var j=z.hasOwnProperty(i)?z[i]:null;(j!==null?j.type!==0:$||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,_,j,$)&&(_=null),$||j===null?oa(i)&&(_===null?o.removeAttribute(i):o.setAttribute(i,""+_)):j.mustUseProperty?o[j.propertyName]=_===null?j.type===3?!1:"":_:(i=j.attributeName,$=j.attributeNamespace,_===null?o.removeAttribute(i):(j=j.type,_=j===3||j===4&&_===!0?"":""+_,$?o.setAttributeNS($,i,_):o.setAttribute(i,_))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(o){return o===null||typeof o!="object"?null:(o=Ja&&o[Ja]||o["@@iterator"],typeof o=="function"?o:null)}var A=Object.assign,La;function Ma(o){if(La===void 0)try{throw Error()}catch(_){var i=_.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+o}var Na=!1;function Oa(o,i){if(!o||Na)return"";Na=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(nt){var $=nt}Reflect.construct(o,[],i)}else{try{i.call()}catch(nt){$=nt}o.call(i.prototype)}else{try{throw Error()}catch(nt){$=nt}o()}}catch(nt){if(nt&&$&&typeof nt.stack=="string"){for(var j=nt.stack.split(`
`),_e=$.stack.split(`
`),et=j.length-1,tt=_e.length-1;1<=et&&0<=tt&&j[et]!==_e[tt];)tt--;for(;1<=et&&0<=tt;et--,tt--)if(j[et]!==_e[tt]){if(et!==1||tt!==1)do if(et--,tt--,0>tt||j[et]!==_e[tt]){var rt=`
`+j[et].replace(" at new "," at ");return o.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",o.displayName)),rt}while(1<=et&&0<=tt);break}}}finally{Na=!1,Error.prepareStackTrace=_}return(o=o?o.displayName||o.name:"")?Ma(o):""}function Pa(o){switch(o.tag){case 5:return Ma(o.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return o=Oa(o.type,!1),o;case 11:return o=Oa(o.type.render,!1),o;case 1:return o=Oa(o.type,!0),o;default:return""}}function Qa(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case Ca:return(o.displayName||"Context")+".Consumer";case Ba:return(o._context.displayName||"Context")+".Provider";case Da:var i=o.render;return o=o.displayName,o||(o=i.displayName||i.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Ga:return i=o.displayName||null,i!==null?i:Qa(o.type)||"Memo";case Ha:i=o._payload,o=o._init;try{return Qa(o(i))}catch{}}return null}function Ra(o){var i=o.type;switch(o.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=i.render,o=o.displayName||o.name||"",i.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ta(o){var i=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(o){var i=Ta(o)?"checked":"value",_=Object.getOwnPropertyDescriptor(o.constructor.prototype,i),$=""+o[i];if(!o.hasOwnProperty(i)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,_e=_.set;return Object.defineProperty(o,i,{configurable:!0,get:function(){return j.call(this)},set:function(et){$=""+et,_e.call(this,et)}}),Object.defineProperty(o,i,{enumerable:_.enumerable}),{getValue:function(){return $},setValue:function(et){$=""+et},stopTracking:function(){o._valueTracker=null,delete o[i]}}}}function Va(o){o._valueTracker||(o._valueTracker=Ua(o))}function Wa(o){if(!o)return!1;var i=o._valueTracker;if(!i)return!0;var _=i.getValue(),$="";return o&&($=Ta(o)?o.checked?"true":"false":o.value),o=$,o!==_?(i.setValue(o),!0):!1}function Xa(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ya(o,i){var _=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??o._wrapperState.initialChecked})}function Za(o,i){var _=i.defaultValue==null?"":i.defaultValue,$=i.checked!=null?i.checked:i.defaultChecked;_=Sa(i.value!=null?i.value:_),o._wrapperState={initialChecked:$,initialValue:_,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(o,i){i=i.checked,i!=null&&ta(o,"checked",i,!1)}function bb(o,i){ab(o,i);var _=Sa(i.value),$=i.type;if(_!=null)$==="number"?(_===0&&o.value===""||o.value!=_)&&(o.value=""+_):o.value!==""+_&&(o.value=""+_);else if($==="submit"||$==="reset"){o.removeAttribute("value");return}i.hasOwnProperty("value")?cb(o,i.type,_):i.hasOwnProperty("defaultValue")&&cb(o,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(o.defaultChecked=!!i.defaultChecked)}function db$1(o,i,_){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var $=i.type;if(!($!=="submit"&&$!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+o._wrapperState.initialValue,_||i===o.value||(o.value=i),o.defaultValue=i}_=o.name,_!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,_!==""&&(o.name=_)}function cb(o,i,_){(i!=="number"||Xa(o.ownerDocument)!==o)&&(_==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+_&&(o.defaultValue=""+_))}var eb=Array.isArray;function fb(o,i,_,$){if(o=o.options,i){i={};for(var j=0;j<_.length;j++)i["$"+_[j]]=!0;for(_=0;_<o.length;_++)j=i.hasOwnProperty("$"+o[_].value),o[_].selected!==j&&(o[_].selected=j),j&&$&&(o[_].defaultSelected=!0)}else{for(_=""+Sa(_),i=null,j=0;j<o.length;j++){if(o[j].value===_){o[j].selected=!0,$&&(o[j].defaultSelected=!0);return}i!==null||o[j].disabled||(i=o[j])}i!==null&&(i.selected=!0)}}function gb(o,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p$1(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function hb(o,i){var _=i.value;if(_==null){if(_=i.children,i=i.defaultValue,_!=null){if(i!=null)throw Error(p$1(92));if(eb(_)){if(1<_.length)throw Error(p$1(93));_=_[0]}i=_}i==null&&(i=""),_=i}o._wrapperState={initialValue:Sa(_)}}function ib(o,i){var _=Sa(i.value),$=Sa(i.defaultValue);_!=null&&(_=""+_,_!==o.value&&(o.value=_),i.defaultValue==null&&o.defaultValue!==_&&(o.defaultValue=_)),$!=null&&(o.defaultValue=""+$)}function jb(o){var i=o.textContent;i===o._wrapperState.initialValue&&i!==""&&i!==null&&(o.value=i)}function kb(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(o,i){return o==null||o==="http://www.w3.org/1999/xhtml"?kb(i):o==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var mb,nb=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,_,$,j){MSApp.execUnsafeLocalFunction(function(){return o(i,_,$,j)})}:o}(function(o,i){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;i.firstChild;)o.appendChild(i.firstChild)}});function ob(o,i){if(i){var _=o.firstChild;if(_&&_===o.lastChild&&_.nodeType===3){_.nodeValue=i;return}}o.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(o){qb.forEach(function(i){i=i+o.charAt(0).toUpperCase()+o.substring(1),pb[i]=pb[o]})});function rb(o,i,_){return i==null||typeof i=="boolean"||i===""?"":_||typeof i!="number"||i===0||pb.hasOwnProperty(o)&&pb[o]?(""+i).trim():i+"px"}function sb(o,i){o=o.style;for(var _ in i)if(i.hasOwnProperty(_)){var $=_.indexOf("--")===0,j=rb(_,i[_],$);_==="float"&&(_="cssFloat"),$?o.setProperty(_,j):o[_]=j}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(o,i){if(i){if(tb[o]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p$1(137,o));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p$1(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p$1(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p$1(62))}}function vb(o,i){if(o.indexOf("-")===-1)return typeof i.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var yb=null,zb=null,Ab=null;function Bb(o){if(o=Cb(o)){if(typeof yb!="function")throw Error(p$1(280));var i=o.stateNode;i&&(i=Db(i),yb(o.stateNode,o.type,i))}}function Eb(o){zb?Ab?Ab.push(o):Ab=[o]:zb=o}function Fb(){if(zb){var o=zb,i=Ab;if(Ab=zb=null,Bb(o),i)for(o=0;o<i.length;o++)Bb(i[o])}}function Gb(o,i){return o(i)}function Hb(){}var Ib=!1;function Jb(o,i,_){if(Ib)return o(i,_);Ib=!0;try{return Gb(o,i,_)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(o,i){var _=o.stateNode;if(_===null)return null;var $=Db(_);if($===null)return null;_=$[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":($=!$.disabled)||(o=o.type,$=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!$;break e;default:o=!1}if(o)return null;if(_&&typeof _!="function")throw Error(p$1(231,i,typeof _));return _}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(o,i,_,$,j,_e,et,tt,rt){var nt=Array.prototype.slice.call(arguments,3);try{i.apply(_,nt)}catch(it){this.onError(it)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(o){Ob=!0,Pb=o}};function Tb(o,i,_,$,j,_e,et,tt,rt){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(o,i,_,$,j,_e,et,tt,rt){if(Tb.apply(this,arguments),Ob){if(Ob){var nt=Pb;Ob=!1,Pb=null}else throw Error(p$1(198));Qb||(Qb=!0,Rb=nt)}}function Vb(o){var i=o,_=o;if(o.alternate)for(;i.return;)i=i.return;else{o=i;do i=o,i.flags&4098&&(_=i.return),o=i.return;while(o)}return i.tag===3?_:null}function Wb(o){if(o.tag===13){var i=o.memoizedState;if(i===null&&(o=o.alternate,o!==null&&(i=o.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(o){if(Vb(o)!==o)throw Error(p$1(188))}function Yb(o){var i=o.alternate;if(!i){if(i=Vb(o),i===null)throw Error(p$1(188));return i!==o?null:o}for(var _=o,$=i;;){var j=_.return;if(j===null)break;var _e=j.alternate;if(_e===null){if($=j.return,$!==null){_=$;continue}break}if(j.child===_e.child){for(_e=j.child;_e;){if(_e===_)return Xb(j),o;if(_e===$)return Xb(j),i;_e=_e.sibling}throw Error(p$1(188))}if(_.return!==$.return)_=j,$=_e;else{for(var et=!1,tt=j.child;tt;){if(tt===_){et=!0,_=j,$=_e;break}if(tt===$){et=!0,$=j,_=_e;break}tt=tt.sibling}if(!et){for(tt=_e.child;tt;){if(tt===_){et=!0,_=_e,$=j;break}if(tt===$){et=!0,$=_e,_=j;break}tt=tt.sibling}if(!et)throw Error(p$1(189))}}if(_.alternate!==$)throw Error(p$1(190))}if(_.tag!==3)throw Error(p$1(188));return _.stateNode.current===_?o:i}function Zb(o){return o=Yb(o),o!==null?$b(o):null}function $b(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var i=$b(o);if(i!==null)return i;o=o.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(o){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,o,void 0,(o.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(o){return o>>>=0,o===0?32:31-(pc(o)/qc|0)|0}var rc=64,sc=4194304;function tc(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function uc(o,i){var _=o.pendingLanes;if(_===0)return 0;var $=0,j=o.suspendedLanes,_e=o.pingedLanes,et=_&268435455;if(et!==0){var tt=et&~j;tt!==0?$=tc(tt):(_e&=et,_e!==0&&($=tc(_e)))}else et=_&~j,et!==0?$=tc(et):_e!==0&&($=tc(_e));if($===0)return 0;if(i!==0&&i!==$&&!(i&j)&&(j=$&-$,_e=i&-i,j>=_e||j===16&&(_e&4194240)!==0))return i;if($&4&&($|=_&16),i=o.entangledLanes,i!==0)for(o=o.entanglements,i&=$;0<i;)_=31-oc(i),j=1<<_,$|=o[_],i&=~j;return $}function vc(o,i){switch(o){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(o,i){for(var _=o.suspendedLanes,$=o.pingedLanes,j=o.expirationTimes,_e=o.pendingLanes;0<_e;){var et=31-oc(_e),tt=1<<et,rt=j[et];rt===-1?(!(tt&_)||tt&$)&&(j[et]=vc(tt,i)):rt<=i&&(o.expiredLanes|=tt),_e&=~tt}}function xc(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function yc(){var o=rc;return rc<<=1,!(rc&4194240)&&(rc=64),o}function zc(o){for(var i=[],_=0;31>_;_++)i.push(o);return i}function Ac(o,i,_){o.pendingLanes|=i,i!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,i=31-oc(i),o[i]=_}function Bc(o,i){var _=o.pendingLanes&~i;o.pendingLanes=i,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=i,o.mutableReadLanes&=i,o.entangledLanes&=i,i=o.entanglements;var $=o.eventTimes;for(o=o.expirationTimes;0<_;){var j=31-oc(_),_e=1<<j;i[j]=0,$[j]=-1,o[j]=-1,_&=~_e}}function Cc(o,i){var _=o.entangledLanes|=i;for(o=o.entanglements;_;){var $=31-oc(_),j=1<<$;j&i|o[$]&i&&(o[$]|=i),_&=~j}}var C=0;function Dc(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(o,i){switch(o){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(o,i,_,$,j,_e){return o===null||o.nativeEvent!==_e?(o={blockedOn:i,domEventName:_,eventSystemFlags:$,nativeEvent:_e,targetContainers:[j]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),o):(o.eventSystemFlags|=$,i=o.targetContainers,j!==null&&i.indexOf(j)===-1&&i.push(j),o)}function Uc(o,i,_,$,j){switch(i){case"focusin":return Lc=Tc(Lc,o,i,_,$,j),!0;case"dragenter":return Mc=Tc(Mc,o,i,_,$,j),!0;case"mouseover":return Nc=Tc(Nc,o,i,_,$,j),!0;case"pointerover":var _e=j.pointerId;return Oc.set(_e,Tc(Oc.get(_e)||null,o,i,_,$,j)),!0;case"gotpointercapture":return _e=j.pointerId,Pc.set(_e,Tc(Pc.get(_e)||null,o,i,_,$,j)),!0}return!1}function Vc(o){var i=Wc(o.target);if(i!==null){var _=Vb(i);if(_!==null){if(i=_.tag,i===13){if(i=Wb(_),i!==null){o.blockedOn=i,Ic(o.priority,function(){Gc(_)});return}}else if(i===3&&_.stateNode.current.memoizedState.isDehydrated){o.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Xc(o){if(o.blockedOn!==null)return!1;for(var i=o.targetContainers;0<i.length;){var _=Yc(o.domEventName,o.eventSystemFlags,i[0],o.nativeEvent);if(_===null){_=o.nativeEvent;var $=new _.constructor(_.type,_);wb=$,_.target.dispatchEvent($),wb=null}else return i=Cb(_),i!==null&&Fc(i),o.blockedOn=_,!1;i.shift()}return!0}function Zc(o,i,_){Xc(o)&&_.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(o,i){o.blockedOn===i&&(o.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(o){function i(j){return ad(j,o)}if(0<Kc.length){ad(Kc[0],o);for(var _=1;_<Kc.length;_++){var $=Kc[_];$.blockedOn===o&&($.blockedOn=null)}}for(Lc!==null&&ad(Lc,o),Mc!==null&&ad(Mc,o),Nc!==null&&ad(Nc,o),Oc.forEach(i),Pc.forEach(i),_=0;_<Qc.length;_++)$=Qc[_],$.blockedOn===o&&($.blockedOn=null);for(;0<Qc.length&&(_=Qc[0],_.blockedOn===null);)Vc(_),_.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(o,i,_,$){var j=C,_e=cd.transition;cd.transition=null;try{C=1,fd(o,i,_,$)}finally{C=j,cd.transition=_e}}function gd(o,i,_,$){var j=C,_e=cd.transition;cd.transition=null;try{C=4,fd(o,i,_,$)}finally{C=j,cd.transition=_e}}function fd(o,i,_,$){if(dd){var j=Yc(o,i,_,$);if(j===null)hd(o,i,$,id$2,_),Sc(o,$);else if(Uc(j,o,i,_,$))$.stopPropagation();else if(Sc(o,$),i&4&&-1<Rc.indexOf(o)){for(;j!==null;){var _e=Cb(j);if(_e!==null&&Ec(_e),_e=Yc(o,i,_,$),_e===null&&hd(o,i,$,id$2,_),_e===j)break;j=_e}j!==null&&$.stopPropagation()}else hd(o,i,$,null,_)}}var id$2=null;function Yc(o,i,_,$){if(id$2=null,o=xb($),o=Wc(o),o!==null)if(i=Vb(o),i===null)o=null;else if(_=i.tag,_===13){if(o=Wb(i),o!==null)return o;o=null}else if(_===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;o=null}else i!==o&&(o=null);return id$2=o,null}function jd(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var o,i=ld,_=i.length,$,j="value"in kd?kd.value:kd.textContent,_e=j.length;for(o=0;o<_&&i[o]===j[o];o++);var et=_-o;for($=1;$<=et&&i[_-$]===j[_e-$];$++);return md=j.slice(o,1<$?1-$:void 0)}function od(o){var i=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&i===13&&(o=13)):o=i,o===10&&(o=13),32<=o||o===13?o:0}function pd(){return!0}function qd(){return!1}function rd(o){function i(_,$,j,_e,et){this._reactName=_,this._targetInst=j,this.type=$,this.nativeEvent=_e,this.target=et,this.currentTarget=null;for(var tt in o)o.hasOwnProperty(tt)&&(_=o[tt],this[tt]=_?_(_e):_e[tt]);return this.isDefaultPrevented=(_e.defaultPrevented!=null?_e.defaultPrevented:_e.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==yd&&(yd&&o.type==="mousemove"?(wd=o.screenX-yd.screenX,xd=o.screenY-yd.screenY):xd=wd=0,yd=o),wd)},movementY:function(o){return"movementY"in o?o.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(o){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(o):(o=Od[o])?!!i[o]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(o){if(o.key){var i=Md[o.key]||o.key;if(i!=="Unidentified")return i}return o.type==="keypress"?(o=od(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Nd[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(o){return o.type==="keypress"?od(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?od(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(o,i){switch(o){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ie=!1;function je(o,i){switch(o){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return o=i.data,o===ee&&fe?null:o;default:return null}}function ke(o,i){if(ie)return o==="compositionend"||!ae&&ge(o,i)?(o=nd(),md=ld=kd=null,ie=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(o){var i=o&&o.nodeName&&o.nodeName.toLowerCase();return i==="input"?!!le[o.type]:i==="textarea"}function ne(o,i,_,$){Eb($),i=oe(i,"onChange"),0<i.length&&(_=new td("onChange","change",null,_,$),o.push({event:_,listeners:i}))}var pe=null,qe=null;function re$1(o){se(o,0)}function te(o){var i=ue(o);if(Wa(i))return o}function ve(o,i){if(o==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(o){if(o.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,o,xb(o)),Jb(re$1,i)}}function Ce(o,i,_){o==="focusin"?(Ae(),pe=i,qe=_,pe.attachEvent("onpropertychange",Be)):o==="focusout"&&Ae()}function De(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return te(qe)}function Ee(o,i){if(o==="click")return te(i)}function Fe(o,i){if(o==="input"||o==="change")return te(i)}function Ge(o,i){return o===i&&(o!==0||1/o===1/i)||o!==o&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(o,i){if(He(o,i))return!0;if(typeof o!="object"||o===null||typeof i!="object"||i===null)return!1;var _=Object.keys(o),$=Object.keys(i);if(_.length!==$.length)return!1;for($=0;$<_.length;$++){var j=_[$];if(!ja.call(i,j)||!He(o[j],i[j]))return!1}return!0}function Je(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Ke(o,i){var _=Je(o);o=0;for(var $;_;){if(_.nodeType===3){if($=o+_.textContent.length,o<=i&&$>=i)return{node:_,offset:i-o};o=$}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=Je(_)}}function Le(o,i){return o&&i?o===i?!0:o&&o.nodeType===3?!1:i&&i.nodeType===3?Le(o,i.parentNode):"contains"in o?o.contains(i):o.compareDocumentPosition?!!(o.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var o=window,i=Xa();i instanceof o.HTMLIFrameElement;){try{var _=typeof i.contentWindow.location.href=="string"}catch{_=!1}if(_)o=i.contentWindow;else break;i=Xa(o.document)}return i}function Ne(o){var i=o&&o.nodeName&&o.nodeName.toLowerCase();return i&&(i==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||i==="textarea"||o.contentEditable==="true")}function Oe(o){var i=Me(),_=o.focusedElem,$=o.selectionRange;if(i!==_&&_&&_.ownerDocument&&Le(_.ownerDocument.documentElement,_)){if($!==null&&Ne(_)){if(i=$.start,o=$.end,o===void 0&&(o=i),"selectionStart"in _)_.selectionStart=i,_.selectionEnd=Math.min(o,_.value.length);else if(o=(i=_.ownerDocument||document)&&i.defaultView||window,o.getSelection){o=o.getSelection();var j=_.textContent.length,_e=Math.min($.start,j);$=$.end===void 0?_e:Math.min($.end,j),!o.extend&&_e>$&&(j=$,$=_e,_e=j),j=Ke(_,_e);var et=Ke(_,$);j&&et&&(o.rangeCount!==1||o.anchorNode!==j.node||o.anchorOffset!==j.offset||o.focusNode!==et.node||o.focusOffset!==et.offset)&&(i=i.createRange(),i.setStart(j.node,j.offset),o.removeAllRanges(),_e>$?(o.addRange(i),o.extend(et.node,et.offset)):(i.setEnd(et.node,et.offset),o.addRange(i)))}}for(i=[],o=_;o=o.parentNode;)o.nodeType===1&&i.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<i.length;_++)o=i[_],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(o,i,_){var $=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;Te||Qe==null||Qe!==Xa($)||($=Qe,"selectionStart"in $&&Ne($)?$={start:$.selectionStart,end:$.selectionEnd}:($=($.ownerDocument&&$.ownerDocument.defaultView||window).getSelection(),$={anchorNode:$.anchorNode,anchorOffset:$.anchorOffset,focusNode:$.focusNode,focusOffset:$.focusOffset}),Se&&Ie(Se,$)||(Se=$,$=oe(Re,"onSelect"),0<$.length&&(i=new td("onSelect","select",null,i,_),o.push({event:i,listeners:$}),i.target=Qe)))}function Ve(o,i){var _={};return _[o.toLowerCase()]=i.toLowerCase(),_["Webkit"+o]="webkit"+i,_["Moz"+o]="moz"+i,_}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(o){if(Xe[o])return Xe[o];if(!We[o])return o;var i=We[o],_;for(_ in i)if(i.hasOwnProperty(_)&&_ in Ye)return Xe[o]=i[_];return o}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(o,i){df.set(o,i),fa(i,[o])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(o,i,_){var $=o.type||"unknown-event";o.currentTarget=_,Ub($,i,void 0,o),o.currentTarget=null}function se(o,i){i=(i&4)!==0;for(var _=0;_<o.length;_++){var $=o[_],j=$.event;$=$.listeners;e:{var _e=void 0;if(i)for(var et=$.length-1;0<=et;et--){var tt=$[et],rt=tt.instance,nt=tt.currentTarget;if(tt=tt.listener,rt!==_e&&j.isPropagationStopped())break e;nf(j,tt,nt),_e=rt}else for(et=0;et<$.length;et++){if(tt=$[et],rt=tt.instance,nt=tt.currentTarget,tt=tt.listener,rt!==_e&&j.isPropagationStopped())break e;nf(j,tt,nt),_e=rt}}}if(Qb)throw o=Rb,Qb=!1,Rb=null,o}function D(o,i){var _=i[of];_===void 0&&(_=i[of]=new Set);var $=o+"__bubble";_.has($)||(pf(i,o,2,!1),_.add($))}function qf(o,i,_){var $=0;i&&($|=4),pf(_,o,$,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(o){if(!o[rf]){o[rf]=!0,da.forEach(function(_){_!=="selectionchange"&&(mf.has(_)||qf(_,!1,o),qf(_,!0,o))});var i=o.nodeType===9?o:o.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(o,i,_,$){switch(jd(i)){case 1:var j=ed;break;case 4:j=gd;break;default:j=fd}_=j.bind(null,i,_,o),j=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(j=!0),$?j!==void 0?o.addEventListener(i,_,{capture:!0,passive:j}):o.addEventListener(i,_,!0):j!==void 0?o.addEventListener(i,_,{passive:j}):o.addEventListener(i,_,!1)}function hd(o,i,_,$,j){var _e=$;if(!(i&1)&&!(i&2)&&$!==null)e:for(;;){if($===null)return;var et=$.tag;if(et===3||et===4){var tt=$.stateNode.containerInfo;if(tt===j||tt.nodeType===8&&tt.parentNode===j)break;if(et===4)for(et=$.return;et!==null;){var rt=et.tag;if((rt===3||rt===4)&&(rt=et.stateNode.containerInfo,rt===j||rt.nodeType===8&&rt.parentNode===j))return;et=et.return}for(;tt!==null;){if(et=Wc(tt),et===null)return;if(rt=et.tag,rt===5||rt===6){$=_e=et;continue e}tt=tt.parentNode}}$=$.return}Jb(function(){var nt=_e,it=xb(_),st=[];e:{var at=df.get(o);if(at!==void 0){var ot=td,lt=o;switch(o){case"keypress":if(od(_)===0)break e;case"keydown":case"keyup":ot=Rd;break;case"focusin":lt="focus",ot=Fd;break;case"focusout":lt="blur",ot=Fd;break;case"beforeblur":case"afterblur":ot=Fd;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Vd;break;case $e:case af:case bf:ot=Hd;break;case cf:ot=Xd;break;case"scroll":ot=vd;break;case"wheel":ot=Zd;break;case"copy":case"cut":case"paste":ot=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=Td}var ct=(i&4)!==0,ft=!ct&&o==="scroll",ut=ct?at!==null?at+"Capture":null:at;ct=[];for(var ht=nt,dt;ht!==null;){dt=ht;var mt=dt.stateNode;if(dt.tag===5&&mt!==null&&(dt=mt,ut!==null&&(mt=Kb(ht,ut),mt!=null&&ct.push(tf(ht,mt,dt)))),ft)break;ht=ht.return}0<ct.length&&(at=new ot(at,lt,null,_,it),st.push({event:at,listeners:ct}))}}if(!(i&7)){e:{if(at=o==="mouseover"||o==="pointerover",ot=o==="mouseout"||o==="pointerout",at&&_!==wb&&(lt=_.relatedTarget||_.fromElement)&&(Wc(lt)||lt[uf]))break e;if((ot||at)&&(at=it.window===it?it:(at=it.ownerDocument)?at.defaultView||at.parentWindow:window,ot?(lt=_.relatedTarget||_.toElement,ot=nt,lt=lt?Wc(lt):null,lt!==null&&(ft=Vb(lt),lt!==ft||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(ot=null,lt=nt),ot!==lt)){if(ct=Bd,mt="onMouseLeave",ut="onMouseEnter",ht="mouse",(o==="pointerout"||o==="pointerover")&&(ct=Td,mt="onPointerLeave",ut="onPointerEnter",ht="pointer"),ft=ot==null?at:ue(ot),dt=lt==null?at:ue(lt),at=new ct(mt,ht+"leave",ot,_,it),at.target=ft,at.relatedTarget=dt,mt=null,Wc(it)===nt&&(ct=new ct(ut,ht+"enter",lt,_,it),ct.target=dt,ct.relatedTarget=ft,mt=ct),ft=mt,ot&&lt)t:{for(ct=ot,ut=lt,ht=0,dt=ct;dt;dt=vf(dt))ht++;for(dt=0,mt=ut;mt;mt=vf(mt))dt++;for(;0<ht-dt;)ct=vf(ct),ht--;for(;0<dt-ht;)ut=vf(ut),dt--;for(;ht--;){if(ct===ut||ut!==null&&ct===ut.alternate)break t;ct=vf(ct),ut=vf(ut)}ct=null}else ct=null;ot!==null&&wf(st,at,ot,ct,!1),lt!==null&&ft!==null&&wf(st,ft,lt,ct,!0)}}e:{if(at=nt?ue(nt):window,ot=at.nodeName&&at.nodeName.toLowerCase(),ot==="select"||ot==="input"&&at.type==="file")var pt=ve;else if(me(at))if(we)pt=Fe;else{pt=De;var yt=Ce}else(ot=at.nodeName)&&ot.toLowerCase()==="input"&&(at.type==="checkbox"||at.type==="radio")&&(pt=Ee);if(pt&&(pt=pt(o,nt))){ne(st,pt,_,it);break e}yt&&yt(o,at,nt),o==="focusout"&&(yt=at._wrapperState)&&yt.controlled&&at.type==="number"&&cb(at,"number",at.value)}switch(yt=nt?ue(nt):window,o){case"focusin":(me(yt)||yt.contentEditable==="true")&&(Qe=yt,Re=nt,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(st,_,it);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(st,_,it)}var gt;if(ae)e:{switch(o){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else ie?ge(o,_)&&(vt="onCompositionEnd"):o==="keydown"&&_.keyCode===229&&(vt="onCompositionStart");vt&&(de&&_.locale!=="ko"&&(ie||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&ie&&(gt=nd()):(kd=it,ld="value"in kd?kd.value:kd.textContent,ie=!0)),yt=oe(nt,vt),0<yt.length&&(vt=new Ld(vt,o,null,_,it),st.push({event:vt,listeners:yt}),gt?vt.data=gt:(gt=he(_),gt!==null&&(vt.data=gt)))),(gt=ce?je(o,_):ke(o,_))&&(nt=oe(nt,"onBeforeInput"),0<nt.length&&(it=new Ld("onBeforeInput","beforeinput",null,_,it),st.push({event:it,listeners:nt}),it.data=gt))}se(st,i)})}function tf(o,i,_){return{instance:o,listener:i,currentTarget:_}}function oe(o,i){for(var _=i+"Capture",$=[];o!==null;){var j=o,_e=j.stateNode;j.tag===5&&_e!==null&&(j=_e,_e=Kb(o,_),_e!=null&&$.unshift(tf(o,_e,j)),_e=Kb(o,i),_e!=null&&$.push(tf(o,_e,j))),o=o.return}return $}function vf(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function wf(o,i,_,$,j){for(var _e=i._reactName,et=[];_!==null&&_!==$;){var tt=_,rt=tt.alternate,nt=tt.stateNode;if(rt!==null&&rt===$)break;tt.tag===5&&nt!==null&&(tt=nt,j?(rt=Kb(_,_e),rt!=null&&et.unshift(tf(_,rt,tt))):j||(rt=Kb(_,_e),rt!=null&&et.push(tf(_,rt,tt)))),_=_.return}et.length!==0&&o.push({event:i,listeners:et})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(o){return(typeof o=="string"?o:""+o).replace(xf,`
`).replace(yf,"")}function Af(o,i,_){if(i=zf(i),zf(o)!==i&&_)throw Error(p$1(425))}function Bf(){}var Cf=null,Df=null;function Ef(o,i){return o==="textarea"||o==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(o){return Hf.resolve(null).then(o).catch(If)}:Ff;function If(o){setTimeout(function(){throw o})}function Kf(o,i){var _=i,$=0;do{var j=_.nextSibling;if(o.removeChild(_),j&&j.nodeType===8)if(_=j.data,_==="/$"){if($===0){o.removeChild(j),bd(i);return}$--}else _!=="$"&&_!=="$?"&&_!=="$!"||$++;_=j}while(_);bd(i)}function Lf(o){for(;o!=null;o=o.nextSibling){var i=o.nodeType;if(i===1||i===3)break;if(i===8){if(i=o.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return o}function Mf(o){o=o.previousSibling;for(var i=0;o;){if(o.nodeType===8){var _=o.data;if(_==="$"||_==="$!"||_==="$?"){if(i===0)return o;i--}else _==="/$"&&i++}o=o.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(o){var i=o[Of];if(i)return i;for(var _=o.parentNode;_;){if(i=_[uf]||_[Of]){if(_=i.alternate,i.child!==null||_!==null&&_.child!==null)for(o=Mf(o);o!==null;){if(_=o[Of])return _;o=Mf(o)}return i}o=_,_=o.parentNode}return null}function Cb(o){return o=o[Of]||o[uf],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function ue(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(p$1(33))}function Db(o){return o[Pf]||null}var Sf=[],Tf=-1;function Uf(o){return{current:o}}function E(o){0>Tf||(o.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(o,i){Tf++,Sf[Tf]=o.current,o.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(o,i){var _=o.type.contextTypes;if(!_)return Vf;var $=o.stateNode;if($&&$.__reactInternalMemoizedUnmaskedChildContext===i)return $.__reactInternalMemoizedMaskedChildContext;var j={},_e;for(_e in _)j[_e]=i[_e];return $&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=i,o.__reactInternalMemoizedMaskedChildContext=j),j}function Zf(o){return o=o.childContextTypes,o!=null}function $f(){E(Wf),E(H)}function ag(o,i,_){if(H.current!==Vf)throw Error(p$1(168));G(H,i),G(Wf,_)}function bg(o,i,_){var $=o.stateNode;if(i=i.childContextTypes,typeof $.getChildContext!="function")return _;$=$.getChildContext();for(var j in $)if(!(j in i))throw Error(p$1(108,Ra(o)||"Unknown",j));return A({},_,$)}function cg(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,o),G(Wf,Wf.current),!0}function dg(o,i,_){var $=o.stateNode;if(!$)throw Error(p$1(169));_?(o=bg(o,i,Xf),$.__reactInternalMemoizedMergedChildContext=o,E(Wf),E(H),G(H,o)):E(Wf),G(Wf,_)}var eg=null,fg=!1,gg=!1;function hg(o){eg===null?eg=[o]:eg.push(o)}function ig(o){fg=!0,hg(o)}function jg(){if(!gg&&eg!==null){gg=!0;var o=0,i=C;try{var _=eg;for(C=1;o<_.length;o++){var $=_[o];do $=$(!0);while($!==null)}eg=null,fg=!1}catch(j){throw eg!==null&&(eg=eg.slice(o+1)),ac(fc,jg),j}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(o,i){kg[lg++]=ng,kg[lg++]=mg,mg=o,ng=i}function ug(o,i,_){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=o;var $=rg;o=sg;var j=32-oc($)-1;$&=~(1<<j),_+=1;var _e=32-oc(i)+j;if(30<_e){var et=j-j%5;_e=($&(1<<et)-1).toString(32),$>>=et,j-=et,rg=1<<32-oc(i)+j|_<<j|$,sg=_e+o}else rg=1<<_e|_<<j|$,sg=o}function vg(o){o.return!==null&&(tg(o,1),ug(o,1,0))}function wg(o){for(;o===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;o===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(o,i){var _=Bg(5,null,null,0);_.elementType="DELETED",_.stateNode=i,_.return=o,i=o.deletions,i===null?(o.deletions=[_],o.flags|=16):i.push(_)}function Cg(o,i){switch(o.tag){case 5:var _=o.type;return i=i.nodeType!==1||_.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(o.stateNode=i,xg=o,yg=Lf(i.firstChild),!0):!1;case 6:return i=o.pendingProps===""||i.nodeType!==3?null:i,i!==null?(o.stateNode=i,xg=o,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(_=qg!==null?{id:rg,overflow:sg}:null,o.memoizedState={dehydrated:i,treeContext:_,retryLane:1073741824},_=Bg(18,null,null,0),_.stateNode=i,_.return=o,o.child=_,xg=o,yg=null,!0):!1;default:return!1}}function Dg(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Eg(o){if(I){var i=yg;if(i){var _=i;if(!Cg(o,i)){if(Dg(o))throw Error(p$1(418));i=Lf(_.nextSibling);var $=xg;i&&Cg(o,i)?Ag($,_):(o.flags=o.flags&-4097|2,I=!1,xg=o)}}else{if(Dg(o))throw Error(p$1(418));o.flags=o.flags&-4097|2,I=!1,xg=o}}}function Fg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;xg=o}function Gg(o){if(o!==xg)return!1;if(!I)return Fg(o),I=!0,!1;var i;if((i=o.tag!==3)&&!(i=o.tag!==5)&&(i=o.type,i=i!=="head"&&i!=="body"&&!Ef(o.type,o.memoizedProps)),i&&(i=yg)){if(Dg(o))throw Hg(),Error(p$1(418));for(;i;)Ag(o,i),i=Lf(i.nextSibling)}if(Fg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(p$1(317));e:{for(o=o.nextSibling,i=0;o;){if(o.nodeType===8){var _=o.data;if(_==="/$"){if(i===0){yg=Lf(o.nextSibling);break e}i--}else _!=="$"&&_!=="$!"&&_!=="$?"||i++}o=o.nextSibling}yg=null}}else yg=xg?Lf(o.stateNode.nextSibling):null;return!0}function Hg(){for(var o=yg;o;)o=Lf(o.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(o){zg===null?zg=[o]:zg.push(o)}var Kg=ua.ReactCurrentBatchConfig;function Lg(o,i,_){if(o=_.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(p$1(309));var $=_.stateNode}if(!$)throw Error(p$1(147,o));var j=$,_e=""+o;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===_e?i.ref:(i=function(et){var tt=j.refs;et===null?delete tt[_e]:tt[_e]=et},i._stringRef=_e,i)}if(typeof o!="string")throw Error(p$1(284));if(!_._owner)throw Error(p$1(290,o))}return o}function Mg(o,i){throw o=Object.prototype.toString.call(i),Error(p$1(31,o==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":o))}function Ng(o){var i=o._init;return i(o._payload)}function Og(o){function i(ut,ht){if(o){var dt=ut.deletions;dt===null?(ut.deletions=[ht],ut.flags|=16):dt.push(ht)}}function _(ut,ht){if(!o)return null;for(;ht!==null;)i(ut,ht),ht=ht.sibling;return null}function $(ut,ht){for(ut=new Map;ht!==null;)ht.key!==null?ut.set(ht.key,ht):ut.set(ht.index,ht),ht=ht.sibling;return ut}function j(ut,ht){return ut=Pg(ut,ht),ut.index=0,ut.sibling=null,ut}function _e(ut,ht,dt){return ut.index=dt,o?(dt=ut.alternate,dt!==null?(dt=dt.index,dt<ht?(ut.flags|=2,ht):dt):(ut.flags|=2,ht)):(ut.flags|=1048576,ht)}function et(ut){return o&&ut.alternate===null&&(ut.flags|=2),ut}function tt(ut,ht,dt,mt){return ht===null||ht.tag!==6?(ht=Qg(dt,ut.mode,mt),ht.return=ut,ht):(ht=j(ht,dt),ht.return=ut,ht)}function rt(ut,ht,dt,mt){var pt=dt.type;return pt===ya?it(ut,ht,dt.props.children,mt,dt.key):ht!==null&&(ht.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===Ha&&Ng(pt)===ht.type)?(mt=j(ht,dt.props),mt.ref=Lg(ut,ht,dt),mt.return=ut,mt):(mt=Rg(dt.type,dt.key,dt.props,null,ut.mode,mt),mt.ref=Lg(ut,ht,dt),mt.return=ut,mt)}function nt(ut,ht,dt,mt){return ht===null||ht.tag!==4||ht.stateNode.containerInfo!==dt.containerInfo||ht.stateNode.implementation!==dt.implementation?(ht=Sg(dt,ut.mode,mt),ht.return=ut,ht):(ht=j(ht,dt.children||[]),ht.return=ut,ht)}function it(ut,ht,dt,mt,pt){return ht===null||ht.tag!==7?(ht=Tg(dt,ut.mode,mt,pt),ht.return=ut,ht):(ht=j(ht,dt),ht.return=ut,ht)}function st(ut,ht,dt){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return ht=Qg(""+ht,ut.mode,dt),ht.return=ut,ht;if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case va:return dt=Rg(ht.type,ht.key,ht.props,null,ut.mode,dt),dt.ref=Lg(ut,null,ht),dt.return=ut,dt;case wa:return ht=Sg(ht,ut.mode,dt),ht.return=ut,ht;case Ha:var mt=ht._init;return st(ut,mt(ht._payload),dt)}if(eb(ht)||Ka(ht))return ht=Tg(ht,ut.mode,dt,null),ht.return=ut,ht;Mg(ut,ht)}return null}function at(ut,ht,dt,mt){var pt=ht!==null?ht.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number")return pt!==null?null:tt(ut,ht,""+dt,mt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:return dt.key===pt?rt(ut,ht,dt,mt):null;case wa:return dt.key===pt?nt(ut,ht,dt,mt):null;case Ha:return pt=dt._init,at(ut,ht,pt(dt._payload),mt)}if(eb(dt)||Ka(dt))return pt!==null?null:it(ut,ht,dt,mt,null);Mg(ut,dt)}return null}function ot(ut,ht,dt,mt,pt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return ut=ut.get(dt)||null,tt(ht,ut,""+mt,pt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case va:return ut=ut.get(mt.key===null?dt:mt.key)||null,rt(ht,ut,mt,pt);case wa:return ut=ut.get(mt.key===null?dt:mt.key)||null,nt(ht,ut,mt,pt);case Ha:var yt=mt._init;return ot(ut,ht,dt,yt(mt._payload),pt)}if(eb(mt)||Ka(mt))return ut=ut.get(dt)||null,it(ht,ut,mt,pt,null);Mg(ht,mt)}return null}function lt(ut,ht,dt,mt){for(var pt=null,yt=null,gt=ht,vt=ht=0,St=null;gt!==null&&vt<dt.length;vt++){gt.index>vt?(St=gt,gt=null):St=gt.sibling;var At=at(ut,gt,dt[vt],mt);if(At===null){gt===null&&(gt=St);break}o&&gt&&At.alternate===null&&i(ut,gt),ht=_e(At,ht,vt),yt===null?pt=At:yt.sibling=At,yt=At,gt=St}if(vt===dt.length)return _(ut,gt),I&&tg(ut,vt),pt;if(gt===null){for(;vt<dt.length;vt++)gt=st(ut,dt[vt],mt),gt!==null&&(ht=_e(gt,ht,vt),yt===null?pt=gt:yt.sibling=gt,yt=gt);return I&&tg(ut,vt),pt}for(gt=$(ut,gt);vt<dt.length;vt++)St=ot(gt,ut,vt,dt[vt],mt),St!==null&&(o&&St.alternate!==null&&gt.delete(St.key===null?vt:St.key),ht=_e(St,ht,vt),yt===null?pt=St:yt.sibling=St,yt=St);return o&&gt.forEach(function(xt){return i(ut,xt)}),I&&tg(ut,vt),pt}function ct(ut,ht,dt,mt){var pt=Ka(dt);if(typeof pt!="function")throw Error(p$1(150));if(dt=pt.call(dt),dt==null)throw Error(p$1(151));for(var yt=pt=null,gt=ht,vt=ht=0,St=null,At=dt.next();gt!==null&&!At.done;vt++,At=dt.next()){gt.index>vt?(St=gt,gt=null):St=gt.sibling;var xt=at(ut,gt,At.value,mt);if(xt===null){gt===null&&(gt=St);break}o&&gt&&xt.alternate===null&&i(ut,gt),ht=_e(xt,ht,vt),yt===null?pt=xt:yt.sibling=xt,yt=xt,gt=St}if(At.done)return _(ut,gt),I&&tg(ut,vt),pt;if(gt===null){for(;!At.done;vt++,At=dt.next())At=st(ut,At.value,mt),At!==null&&(ht=_e(At,ht,vt),yt===null?pt=At:yt.sibling=At,yt=At);return I&&tg(ut,vt),pt}for(gt=$(ut,gt);!At.done;vt++,At=dt.next())At=ot(gt,ut,vt,At.value,mt),At!==null&&(o&&At.alternate!==null&&gt.delete(At.key===null?vt:At.key),ht=_e(At,ht,vt),yt===null?pt=At:yt.sibling=At,yt=At);return o&&gt.forEach(function(wt){return i(ut,wt)}),I&&tg(ut,vt),pt}function ft(ut,ht,dt,mt){if(typeof dt=="object"&&dt!==null&&dt.type===ya&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:e:{for(var pt=dt.key,yt=ht;yt!==null;){if(yt.key===pt){if(pt=dt.type,pt===ya){if(yt.tag===7){_(ut,yt.sibling),ht=j(yt,dt.props.children),ht.return=ut,ut=ht;break e}}else if(yt.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===Ha&&Ng(pt)===yt.type){_(ut,yt.sibling),ht=j(yt,dt.props),ht.ref=Lg(ut,yt,dt),ht.return=ut,ut=ht;break e}_(ut,yt);break}else i(ut,yt);yt=yt.sibling}dt.type===ya?(ht=Tg(dt.props.children,ut.mode,mt,dt.key),ht.return=ut,ut=ht):(mt=Rg(dt.type,dt.key,dt.props,null,ut.mode,mt),mt.ref=Lg(ut,ht,dt),mt.return=ut,ut=mt)}return et(ut);case wa:e:{for(yt=dt.key;ht!==null;){if(ht.key===yt)if(ht.tag===4&&ht.stateNode.containerInfo===dt.containerInfo&&ht.stateNode.implementation===dt.implementation){_(ut,ht.sibling),ht=j(ht,dt.children||[]),ht.return=ut,ut=ht;break e}else{_(ut,ht);break}else i(ut,ht);ht=ht.sibling}ht=Sg(dt,ut.mode,mt),ht.return=ut,ut=ht}return et(ut);case Ha:return yt=dt._init,ft(ut,ht,yt(dt._payload),mt)}if(eb(dt))return lt(ut,ht,dt,mt);if(Ka(dt))return ct(ut,ht,dt,mt);Mg(ut,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"?(dt=""+dt,ht!==null&&ht.tag===6?(_(ut,ht.sibling),ht=j(ht,dt),ht.return=ut,ut=ht):(_(ut,ht),ht=Qg(dt,ut.mode,mt),ht.return=ut,ut=ht),et(ut)):_(ut,ht)}return ft}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(o){var i=Wg.current;E(Wg),o._currentValue=i}function bh(o,i,_){for(;o!==null;){var $=o.alternate;if((o.childLanes&i)!==i?(o.childLanes|=i,$!==null&&($.childLanes|=i)):$!==null&&($.childLanes&i)!==i&&($.childLanes|=i),o===_)break;o=o.return}}function ch(o,i){Xg=o,Zg=Yg=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&i&&(dh=!0),o.firstContext=null)}function eh(o){var i=o._currentValue;if(Zg!==o)if(o={context:o,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p$1(308));Yg=o,Xg.dependencies={lanes:0,firstContext:o}}else Yg=Yg.next=o;return i}var fh=null;function gh(o){fh===null?fh=[o]:fh.push(o)}function hh(o,i,_,$){var j=i.interleaved;return j===null?(_.next=_,gh(i)):(_.next=j.next,j.next=_),i.interleaved=_,ih(o,$)}function ih(o,i){o.lanes|=i;var _=o.alternate;for(_!==null&&(_.lanes|=i),_=o,o=o.return;o!==null;)o.childLanes|=i,_=o.alternate,_!==null&&(_.childLanes|=i),_=o,o=o.return;return _.tag===3?_.stateNode:null}var jh=!1;function kh(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(o,i){o=o.updateQueue,i.updateQueue===o&&(i.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function mh(o,i){return{eventTime:o,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(o,i,_){var $=o.updateQueue;if($===null)return null;if($=$.shared,K&2){var j=$.pending;return j===null?i.next=i:(i.next=j.next,j.next=i),$.pending=i,ih(o,_)}return j=$.interleaved,j===null?(i.next=i,gh($)):(i.next=j.next,j.next=i),$.interleaved=i,ih(o,_)}function oh(o,i,_){if(i=i.updateQueue,i!==null&&(i=i.shared,(_&4194240)!==0)){var $=i.lanes;$&=o.pendingLanes,_|=$,i.lanes=_,Cc(o,_)}}function ph(o,i){var _=o.updateQueue,$=o.alternate;if($!==null&&($=$.updateQueue,_===$)){var j=null,_e=null;if(_=_.firstBaseUpdate,_!==null){do{var et={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};_e===null?j=_e=et:_e=_e.next=et,_=_.next}while(_!==null);_e===null?j=_e=i:_e=_e.next=i}else j=_e=i;_={baseState:$.baseState,firstBaseUpdate:j,lastBaseUpdate:_e,shared:$.shared,effects:$.effects},o.updateQueue=_;return}o=_.lastBaseUpdate,o===null?_.firstBaseUpdate=i:o.next=i,_.lastBaseUpdate=i}function qh(o,i,_,$){var j=o.updateQueue;jh=!1;var _e=j.firstBaseUpdate,et=j.lastBaseUpdate,tt=j.shared.pending;if(tt!==null){j.shared.pending=null;var rt=tt,nt=rt.next;rt.next=null,et===null?_e=nt:et.next=nt,et=rt;var it=o.alternate;it!==null&&(it=it.updateQueue,tt=it.lastBaseUpdate,tt!==et&&(tt===null?it.firstBaseUpdate=nt:tt.next=nt,it.lastBaseUpdate=rt))}if(_e!==null){var st=j.baseState;et=0,it=nt=rt=null,tt=_e;do{var at=tt.lane,ot=tt.eventTime;if(($&at)===at){it!==null&&(it=it.next={eventTime:ot,lane:0,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null});e:{var lt=o,ct=tt;switch(at=i,ot=_,ct.tag){case 1:if(lt=ct.payload,typeof lt=="function"){st=lt.call(ot,st,at);break e}st=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ct.payload,at=typeof lt=="function"?lt.call(ot,st,at):lt,at==null)break e;st=A({},st,at);break e;case 2:jh=!0}}tt.callback!==null&&tt.lane!==0&&(o.flags|=64,at=j.effects,at===null?j.effects=[tt]:at.push(tt))}else ot={eventTime:ot,lane:at,tag:tt.tag,payload:tt.payload,callback:tt.callback,next:null},it===null?(nt=it=ot,rt=st):it=it.next=ot,et|=at;if(tt=tt.next,tt===null){if(tt=j.shared.pending,tt===null)break;at=tt,tt=at.next,at.next=null,j.lastBaseUpdate=at,j.shared.pending=null}}while(!0);if(it===null&&(rt=st),j.baseState=rt,j.firstBaseUpdate=nt,j.lastBaseUpdate=it,i=j.shared.interleaved,i!==null){j=i;do et|=j.lane,j=j.next;while(j!==i)}else _e===null&&(j.shared.lanes=0);rh|=et,o.lanes=et,o.memoizedState=st}}function sh(o,i,_){if(o=i.effects,i.effects=null,o!==null)for(i=0;i<o.length;i++){var $=o[i],j=$.callback;if(j!==null){if($.callback=null,$=_,typeof j!="function")throw Error(p$1(191,j));j.call($)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(o){if(o===th)throw Error(p$1(174));return o}function yh(o,i){switch(G(wh,i),G(vh$1,o),G(uh,th),o=i.nodeType,o){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:o=o===8?i.parentNode:i,i=o.namespaceURI||null,o=o.tagName,i=lb(i,o)}E(uh),G(uh,i)}function zh(){E(uh),E(vh$1),E(wh)}function Ah(o){xh(wh.current);var i=xh(uh.current),_=lb(i,o.type);i!==_&&(G(vh$1,o),G(uh,_))}function Bh(o){vh$1.current===o&&(E(uh),E(vh$1))}var L=Uf(0);function Ch(o){for(var i=o;i!==null;){if(i.tag===13){var _=i.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break;for(;i.sibling===null;){if(i.return===null||i.return===o)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var o=0;o<Dh.length;o++)Dh[o]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$1(321))}function Mh(o,i){if(i===null)return!1;for(var _=0;_<i.length&&_<o.length;_++)if(!He(o[_],i[_]))return!1;return!0}function Nh(o,i,_,$,j,_e){if(Hh=_e,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=o===null||o.memoizedState===null?Oh:Ph,o=_($,j),Jh){_e=0;do{if(Jh=!1,Kh=0,25<=_e)throw Error(p$1(301));_e+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,o=_($,j)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p$1(300));return o}function Sh(){var o=Kh!==0;return Kh=0,o}function Th(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=o:O=O.next=o,O}function Uh(){if(N===null){var o=M.alternate;o=o!==null?o.memoizedState:null}else o=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=o;else{if(o===null)throw Error(p$1(310));N=o,o={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=o:O=O.next=o}return O}function Vh(o,i){return typeof i=="function"?i(o):i}function Wh(o){var i=Uh(),_=i.queue;if(_===null)throw Error(p$1(311));_.lastRenderedReducer=o;var $=N,j=$.baseQueue,_e=_.pending;if(_e!==null){if(j!==null){var et=j.next;j.next=_e.next,_e.next=et}$.baseQueue=j=_e,_.pending=null}if(j!==null){_e=j.next,$=$.baseState;var tt=et=null,rt=null,nt=_e;do{var it=nt.lane;if((Hh&it)===it)rt!==null&&(rt=rt.next={lane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),$=nt.hasEagerState?nt.eagerState:o($,nt.action);else{var st={lane:it,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null};rt===null?(tt=rt=st,et=$):rt=rt.next=st,M.lanes|=it,rh|=it}nt=nt.next}while(nt!==null&&nt!==_e);rt===null?et=$:rt.next=tt,He($,i.memoizedState)||(dh=!0),i.memoizedState=$,i.baseState=et,i.baseQueue=rt,_.lastRenderedState=$}if(o=_.interleaved,o!==null){j=o;do _e=j.lane,M.lanes|=_e,rh|=_e,j=j.next;while(j!==o)}else j===null&&(_.lanes=0);return[i.memoizedState,_.dispatch]}function Xh(o){var i=Uh(),_=i.queue;if(_===null)throw Error(p$1(311));_.lastRenderedReducer=o;var $=_.dispatch,j=_.pending,_e=i.memoizedState;if(j!==null){_.pending=null;var et=j=j.next;do _e=o(_e,et.action),et=et.next;while(et!==j);He(_e,i.memoizedState)||(dh=!0),i.memoizedState=_e,i.baseQueue===null&&(i.baseState=_e),_.lastRenderedState=_e}return[_e,$]}function Yh(){}function Zh(o,i){var _=M,$=Uh(),j=i(),_e=!He($.memoizedState,j);if(_e&&($.memoizedState=j,dh=!0),$=$.queue,$h(ai.bind(null,_,$,o),[o]),$.getSnapshot!==i||_e||O!==null&&O.memoizedState.tag&1){if(_.flags|=2048,bi(9,ci.bind(null,_,$,j,i),void 0,null),Q===null)throw Error(p$1(349));Hh&30||di(_,i,j)}return j}function di(o,i,_){o.flags|=16384,o={getSnapshot:i,value:_},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[o]):(_=i.stores,_===null?i.stores=[o]:_.push(o))}function ci(o,i,_,$){i.value=_,i.getSnapshot=$,ei(i)&&fi(o)}function ai(o,i,_){return _(function(){ei(i)&&fi(o)})}function ei(o){var i=o.getSnapshot;o=o.value;try{var _=i();return!He(o,_)}catch{return!0}}function fi(o){var i=ih(o,1);i!==null&&gi(i,o,1,-1)}function hi(o){var i=Th();return typeof o=="function"&&(o=o()),i.memoizedState=i.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:o},i.queue=o,o=o.dispatch=ii.bind(null,M,o),[i.memoizedState,o]}function bi(o,i,_,$){return o={tag:o,create:i,destroy:_,deps:$,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=o.next=o):(_=i.lastEffect,_===null?i.lastEffect=o.next=o:($=_.next,_.next=o,o.next=$,i.lastEffect=o)),o}function ji(){return Uh().memoizedState}function ki(o,i,_,$){var j=Th();M.flags|=o,j.memoizedState=bi(1|i,_,void 0,$===void 0?null:$)}function li(o,i,_,$){var j=Uh();$=$===void 0?null:$;var _e=void 0;if(N!==null){var et=N.memoizedState;if(_e=et.destroy,$!==null&&Mh($,et.deps)){j.memoizedState=bi(i,_,_e,$);return}}M.flags|=o,j.memoizedState=bi(1|i,_,_e,$)}function mi(o,i){return ki(8390656,8,o,i)}function $h(o,i){return li(2048,8,o,i)}function ni(o,i){return li(4,2,o,i)}function oi(o,i){return li(4,4,o,i)}function pi$2(o,i){if(typeof i=="function")return o=o(),i(o),function(){i(null)};if(i!=null)return o=o(),i.current=o,function(){i.current=null}}function qi(o,i,_){return _=_!=null?_.concat([o]):null,li(4,4,pi$2.bind(null,i,o),_)}function ri(){}function si(o,i){var _=Uh();i=i===void 0?null:i;var $=_.memoizedState;return $!==null&&i!==null&&Mh(i,$[1])?$[0]:(_.memoizedState=[o,i],o)}function ti(o,i){var _=Uh();i=i===void 0?null:i;var $=_.memoizedState;return $!==null&&i!==null&&Mh(i,$[1])?$[0]:(o=o(),_.memoizedState=[o,i],o)}function ui(o,i,_){return Hh&21?(He(_,i)||(_=yc(),M.lanes|=_,rh|=_,o.baseState=!0),i):(o.baseState&&(o.baseState=!1,dh=!0),o.memoizedState=_)}function vi(o,i){var _=C;C=_!==0&&4>_?_:4,o(!0);var $=Gh.transition;Gh.transition={};try{o(!1),i()}finally{C=_,Gh.transition=$}}function wi(){return Uh().memoizedState}function xi(o,i,_){var $=yi(o);if(_={lane:$,action:_,hasEagerState:!1,eagerState:null,next:null},zi(o))Ai(i,_);else if(_=hh(o,i,_,$),_!==null){var j=R();gi(_,o,$,j),Bi(_,i,$)}}function ii(o,i,_){var $=yi(o),j={lane:$,action:_,hasEagerState:!1,eagerState:null,next:null};if(zi(o))Ai(i,j);else{var _e=o.alternate;if(o.lanes===0&&(_e===null||_e.lanes===0)&&(_e=i.lastRenderedReducer,_e!==null))try{var et=i.lastRenderedState,tt=_e(et,_);if(j.hasEagerState=!0,j.eagerState=tt,He(tt,et)){var rt=i.interleaved;rt===null?(j.next=j,gh(i)):(j.next=rt.next,rt.next=j),i.interleaved=j;return}}catch{}finally{}_=hh(o,i,j,$),_!==null&&(j=R(),gi(_,o,$,j),Bi(_,i,$))}}function zi(o){var i=o.alternate;return o===M||i!==null&&i===M}function Ai(o,i){Jh=Ih=!0;var _=o.pending;_===null?i.next=i:(i.next=_.next,_.next=i),o.pending=i}function Bi(o,i,_){if(_&4194240){var $=i.lanes;$&=o.pendingLanes,_|=$,i.lanes=_,Cc(o,_)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(o,i){return Th().memoizedState=[o,i===void 0?null:i],o},useContext:eh,useEffect:mi,useImperativeHandle:function(o,i,_){return _=_!=null?_.concat([o]):null,ki(4194308,4,pi$2.bind(null,i,o),_)},useLayoutEffect:function(o,i){return ki(4194308,4,o,i)},useInsertionEffect:function(o,i){return ki(4,2,o,i)},useMemo:function(o,i){var _=Th();return i=i===void 0?null:i,o=o(),_.memoizedState=[o,i],o},useReducer:function(o,i,_){var $=Th();return i=_!==void 0?_(i):i,$.memoizedState=$.baseState=i,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:i},$.queue=o,o=o.dispatch=xi.bind(null,M,o),[$.memoizedState,o]},useRef:function(o){var i=Th();return o={current:o},i.memoizedState=o},useState:hi,useDebugValue:ri,useDeferredValue:function(o){return Th().memoizedState=o},useTransition:function(){var o=hi(!1),i=o[0];return o=vi.bind(null,o[1]),Th().memoizedState=o,[i,o]},useMutableSource:function(){},useSyncExternalStore:function(o,i,_){var $=M,j=Th();if(I){if(_===void 0)throw Error(p$1(407));_=_()}else{if(_=i(),Q===null)throw Error(p$1(349));Hh&30||di($,i,_)}j.memoizedState=_;var _e={value:_,getSnapshot:i};return j.queue=_e,mi(ai.bind(null,$,_e,o),[o]),$.flags|=2048,bi(9,ci.bind(null,$,_e,_,i),void 0,null),_},useId:function(){var o=Th(),i=Q.identifierPrefix;if(I){var _=sg,$=rg;_=($&~(1<<32-oc($)-1)).toString(32)+_,i=":"+i+"R"+_,_=Kh++,0<_&&(i+="H"+_.toString(32)),i+=":"}else _=Lh++,i=":"+i+"r"+_.toString(32)+":";return o.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(o){var i=Uh();return ui(i,N.memoizedState,o)},useTransition:function(){var o=Wh(Vh)[0],i=Uh().memoizedState;return[o,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(o){var i=Uh();return N===null?i.memoizedState=o:ui(i,N.memoizedState,o)},useTransition:function(){var o=Xh(Vh)[0],i=Uh().memoizedState;return[o,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(o,i){if(o&&o.defaultProps){i=A({},i),o=o.defaultProps;for(var _ in o)i[_]===void 0&&(i[_]=o[_]);return i}return i}function Di(o,i,_,$){i=o.memoizedState,_=_($,i),_=_==null?i:A({},i,_),o.memoizedState=_,o.lanes===0&&(o.updateQueue.baseState=_)}var Ei={isMounted:function(o){return(o=o._reactInternals)?Vb(o)===o:!1},enqueueSetState:function(o,i,_){o=o._reactInternals;var $=R(),j=yi(o),_e=mh($,j);_e.payload=i,_!=null&&(_e.callback=_),i=nh(o,_e,j),i!==null&&(gi(i,o,j,$),oh(i,o,j))},enqueueReplaceState:function(o,i,_){o=o._reactInternals;var $=R(),j=yi(o),_e=mh($,j);_e.tag=1,_e.payload=i,_!=null&&(_e.callback=_),i=nh(o,_e,j),i!==null&&(gi(i,o,j,$),oh(i,o,j))},enqueueForceUpdate:function(o,i){o=o._reactInternals;var _=R(),$=yi(o),j=mh(_,$);j.tag=2,i!=null&&(j.callback=i),i=nh(o,j,$),i!==null&&(gi(i,o,$,_),oh(i,o,$))}};function Fi(o,i,_,$,j,_e,et){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate($,_e,et):i.prototype&&i.prototype.isPureReactComponent?!Ie(_,$)||!Ie(j,_e):!0}function Gi(o,i,_){var $=!1,j=Vf,_e=i.contextType;return typeof _e=="object"&&_e!==null?_e=eh(_e):(j=Zf(i)?Xf:H.current,$=i.contextTypes,_e=($=$!=null)?Yf(o,j):Vf),i=new i(_,_e),o.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,o.stateNode=i,i._reactInternals=o,$&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=j,o.__reactInternalMemoizedMaskedChildContext=_e),i}function Hi(o,i,_,$){o=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(_,$),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(_,$),i.state!==o&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(o,i,_,$){var j=o.stateNode;j.props=_,j.state=o.memoizedState,j.refs={},kh(o);var _e=i.contextType;typeof _e=="object"&&_e!==null?j.context=eh(_e):(_e=Zf(i)?Xf:H.current,j.context=Yf(o,_e)),j.state=o.memoizedState,_e=i.getDerivedStateFromProps,typeof _e=="function"&&(Di(o,i,_e,_),j.state=o.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(i=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),i!==j.state&&Ei.enqueueReplaceState(j,j.state,null),qh(o,_,j,$),j.state=o.memoizedState),typeof j.componentDidMount=="function"&&(o.flags|=4194308)}function Ji(o,i){try{var _="",$=i;do _+=Pa($),$=$.return;while($);var j=_}catch(_e){j=`
Error generating stack: `+_e.message+`
`+_e.stack}return{value:o,source:i,stack:j,digest:null}}function Ki(o,i,_){return{value:o,source:null,stack:_??null,digest:i??null}}function Li(o,i){try{console.error(i.value)}catch(_){setTimeout(function(){throw _})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(o,i,_){_=mh(-1,_),_.tag=3,_.payload={element:null};var $=i.value;return _.callback=function(){Oi||(Oi=!0,Pi=$),Li(o,i)},_}function Qi(o,i,_){_=mh(-1,_),_.tag=3;var $=o.type.getDerivedStateFromError;if(typeof $=="function"){var j=i.value;_.payload=function(){return $(j)},_.callback=function(){Li(o,i)}}var _e=o.stateNode;return _e!==null&&typeof _e.componentDidCatch=="function"&&(_.callback=function(){Li(o,i),typeof $!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var et=i.stack;this.componentDidCatch(i.value,{componentStack:et!==null?et:""})}),_}function Si(o,i,_){var $=o.pingCache;if($===null){$=o.pingCache=new Mi;var j=new Set;$.set(i,j)}else j=$.get(i),j===void 0&&(j=new Set,$.set(i,j));j.has(_)||(j.add(_),o=Ti.bind(null,o,i,_),i.then(o,o))}function Ui(o){do{var i;if((i=o.tag===13)&&(i=o.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return o;o=o.return}while(o!==null);return null}function Vi(o,i,_,$,j){return o.mode&1?(o.flags|=65536,o.lanes=j,o):(o===i?o.flags|=65536:(o.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(i=mh(-1,1),i.tag=2,nh(_,i,1))),_.lanes|=1),o)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(o,i,_,$){i.child=o===null?Vg(i,null,_,$):Ug(i,o.child,_,$)}function Yi(o,i,_,$,j){_=_.render;var _e=i.ref;return ch(i,j),$=Nh(o,i,_,$,_e,j),_=Sh(),o!==null&&!dh?(i.updateQueue=o.updateQueue,i.flags&=-2053,o.lanes&=~j,Zi(o,i,j)):(I&&_&&vg(i),i.flags|=1,Xi(o,i,$,j),i.child)}function $i(o,i,_,$,j){if(o===null){var _e=_.type;return typeof _e=="function"&&!aj(_e)&&_e.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(i.tag=15,i.type=_e,bj(o,i,_e,$,j)):(o=Rg(_.type,null,$,i,i.mode,j),o.ref=i.ref,o.return=i,i.child=o)}if(_e=o.child,!(o.lanes&j)){var et=_e.memoizedProps;if(_=_.compare,_=_!==null?_:Ie,_(et,$)&&o.ref===i.ref)return Zi(o,i,j)}return i.flags|=1,o=Pg(_e,$),o.ref=i.ref,o.return=i,i.child=o}function bj(o,i,_,$,j){if(o!==null){var _e=o.memoizedProps;if(Ie(_e,$)&&o.ref===i.ref)if(dh=!1,i.pendingProps=$=_e,(o.lanes&j)!==0)o.flags&131072&&(dh=!0);else return i.lanes=o.lanes,Zi(o,i,j)}return cj(o,i,_,$,j)}function dj(o,i,_){var $=i.pendingProps,j=$.children,_e=o!==null?o.memoizedState:null;if($.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=_;else{if(!(_&1073741824))return o=_e!==null?_e.baseLanes|_:_,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:o,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=o,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},$=_e!==null?_e.baseLanes:_,G(ej,fj),fj|=$}else _e!==null?($=_e.baseLanes|_,i.memoizedState=null):$=_,G(ej,fj),fj|=$;return Xi(o,i,j,_),i.child}function gj(o,i){var _=i.ref;(o===null&&_!==null||o!==null&&o.ref!==_)&&(i.flags|=512,i.flags|=2097152)}function cj(o,i,_,$,j){var _e=Zf(_)?Xf:H.current;return _e=Yf(i,_e),ch(i,j),_=Nh(o,i,_,$,_e,j),$=Sh(),o!==null&&!dh?(i.updateQueue=o.updateQueue,i.flags&=-2053,o.lanes&=~j,Zi(o,i,j)):(I&&$&&vg(i),i.flags|=1,Xi(o,i,_,j),i.child)}function hj(o,i,_,$,j){if(Zf(_)){var _e=!0;cg(i)}else _e=!1;if(ch(i,j),i.stateNode===null)ij(o,i),Gi(i,_,$),Ii(i,_,$,j),$=!0;else if(o===null){var et=i.stateNode,tt=i.memoizedProps;et.props=tt;var rt=et.context,nt=_.contextType;typeof nt=="object"&&nt!==null?nt=eh(nt):(nt=Zf(_)?Xf:H.current,nt=Yf(i,nt));var it=_.getDerivedStateFromProps,st=typeof it=="function"||typeof et.getSnapshotBeforeUpdate=="function";st||typeof et.UNSAFE_componentWillReceiveProps!="function"&&typeof et.componentWillReceiveProps!="function"||(tt!==$||rt!==nt)&&Hi(i,et,$,nt),jh=!1;var at=i.memoizedState;et.state=at,qh(i,$,et,j),rt=i.memoizedState,tt!==$||at!==rt||Wf.current||jh?(typeof it=="function"&&(Di(i,_,it,$),rt=i.memoizedState),(tt=jh||Fi(i,_,tt,$,at,rt,nt))?(st||typeof et.UNSAFE_componentWillMount!="function"&&typeof et.componentWillMount!="function"||(typeof et.componentWillMount=="function"&&et.componentWillMount(),typeof et.UNSAFE_componentWillMount=="function"&&et.UNSAFE_componentWillMount()),typeof et.componentDidMount=="function"&&(i.flags|=4194308)):(typeof et.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=$,i.memoizedState=rt),et.props=$,et.state=rt,et.context=nt,$=tt):(typeof et.componentDidMount=="function"&&(i.flags|=4194308),$=!1)}else{et=i.stateNode,lh(o,i),tt=i.memoizedProps,nt=i.type===i.elementType?tt:Ci(i.type,tt),et.props=nt,st=i.pendingProps,at=et.context,rt=_.contextType,typeof rt=="object"&&rt!==null?rt=eh(rt):(rt=Zf(_)?Xf:H.current,rt=Yf(i,rt));var ot=_.getDerivedStateFromProps;(it=typeof ot=="function"||typeof et.getSnapshotBeforeUpdate=="function")||typeof et.UNSAFE_componentWillReceiveProps!="function"&&typeof et.componentWillReceiveProps!="function"||(tt!==st||at!==rt)&&Hi(i,et,$,rt),jh=!1,at=i.memoizedState,et.state=at,qh(i,$,et,j);var lt=i.memoizedState;tt!==st||at!==lt||Wf.current||jh?(typeof ot=="function"&&(Di(i,_,ot,$),lt=i.memoizedState),(nt=jh||Fi(i,_,nt,$,at,lt,rt)||!1)?(it||typeof et.UNSAFE_componentWillUpdate!="function"&&typeof et.componentWillUpdate!="function"||(typeof et.componentWillUpdate=="function"&&et.componentWillUpdate($,lt,rt),typeof et.UNSAFE_componentWillUpdate=="function"&&et.UNSAFE_componentWillUpdate($,lt,rt)),typeof et.componentDidUpdate=="function"&&(i.flags|=4),typeof et.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof et.componentDidUpdate!="function"||tt===o.memoizedProps&&at===o.memoizedState||(i.flags|=4),typeof et.getSnapshotBeforeUpdate!="function"||tt===o.memoizedProps&&at===o.memoizedState||(i.flags|=1024),i.memoizedProps=$,i.memoizedState=lt),et.props=$,et.state=lt,et.context=rt,$=nt):(typeof et.componentDidUpdate!="function"||tt===o.memoizedProps&&at===o.memoizedState||(i.flags|=4),typeof et.getSnapshotBeforeUpdate!="function"||tt===o.memoizedProps&&at===o.memoizedState||(i.flags|=1024),$=!1)}return jj(o,i,_,$,_e,j)}function jj(o,i,_,$,j,_e){gj(o,i);var et=(i.flags&128)!==0;if(!$&&!et)return j&&dg(i,_,!1),Zi(o,i,_e);$=i.stateNode,Wi.current=i;var tt=et&&typeof _.getDerivedStateFromError!="function"?null:$.render();return i.flags|=1,o!==null&&et?(i.child=Ug(i,o.child,null,_e),i.child=Ug(i,null,tt,_e)):Xi(o,i,tt,_e),i.memoizedState=$.state,j&&dg(i,_,!0),i.child}function kj(o){var i=o.stateNode;i.pendingContext?ag(o,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(o,i.context,!1),yh(o,i.containerInfo)}function lj(o,i,_,$,j){return Ig(),Jg(j),i.flags|=256,Xi(o,i,_,$),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(o){return{baseLanes:o,cachePool:null,transitions:null}}function oj(o,i,_){var $=i.pendingProps,j=L.current,_e=!1,et=(i.flags&128)!==0,tt;if((tt=et)||(tt=o!==null&&o.memoizedState===null?!1:(j&2)!==0),tt?(_e=!0,i.flags&=-129):(o===null||o.memoizedState!==null)&&(j|=1),G(L,j&1),o===null)return Eg(i),o=i.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(i.mode&1?o.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(et=$.children,o=$.fallback,_e?($=i.mode,_e=i.child,et={mode:"hidden",children:et},!($&1)&&_e!==null?(_e.childLanes=0,_e.pendingProps=et):_e=pj(et,$,0,null),o=Tg(o,$,_,null),_e.return=i,o.return=i,_e.sibling=o,i.child=_e,i.child.memoizedState=nj(_),i.memoizedState=mj,o):qj(i,et));if(j=o.memoizedState,j!==null&&(tt=j.dehydrated,tt!==null))return rj(o,i,et,$,tt,j,_);if(_e){_e=$.fallback,et=i.mode,j=o.child,tt=j.sibling;var rt={mode:"hidden",children:$.children};return!(et&1)&&i.child!==j?($=i.child,$.childLanes=0,$.pendingProps=rt,i.deletions=null):($=Pg(j,rt),$.subtreeFlags=j.subtreeFlags&14680064),tt!==null?_e=Pg(tt,_e):(_e=Tg(_e,et,_,null),_e.flags|=2),_e.return=i,$.return=i,$.sibling=_e,i.child=$,$=_e,_e=i.child,et=o.child.memoizedState,et=et===null?nj(_):{baseLanes:et.baseLanes|_,cachePool:null,transitions:et.transitions},_e.memoizedState=et,_e.childLanes=o.childLanes&~_,i.memoizedState=mj,$}return _e=o.child,o=_e.sibling,$=Pg(_e,{mode:"visible",children:$.children}),!(i.mode&1)&&($.lanes=_),$.return=i,$.sibling=null,o!==null&&(_=i.deletions,_===null?(i.deletions=[o],i.flags|=16):_.push(o)),i.child=$,i.memoizedState=null,$}function qj(o,i){return i=pj({mode:"visible",children:i},o.mode,0,null),i.return=o,o.child=i}function sj(o,i,_,$){return $!==null&&Jg($),Ug(i,o.child,null,_),o=qj(i,i.pendingProps.children),o.flags|=2,i.memoizedState=null,o}function rj(o,i,_,$,j,_e,et){if(_)return i.flags&256?(i.flags&=-257,$=Ki(Error(p$1(422))),sj(o,i,et,$)):i.memoizedState!==null?(i.child=o.child,i.flags|=128,null):(_e=$.fallback,j=i.mode,$=pj({mode:"visible",children:$.children},j,0,null),_e=Tg(_e,j,et,null),_e.flags|=2,$.return=i,_e.return=i,$.sibling=_e,i.child=$,i.mode&1&&Ug(i,o.child,null,et),i.child.memoizedState=nj(et),i.memoizedState=mj,_e);if(!(i.mode&1))return sj(o,i,et,null);if(j.data==="$!"){if($=j.nextSibling&&j.nextSibling.dataset,$)var tt=$.dgst;return $=tt,_e=Error(p$1(419)),$=Ki(_e,$,void 0),sj(o,i,et,$)}if(tt=(et&o.childLanes)!==0,dh||tt){if($=Q,$!==null){switch(et&-et){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=j&($.suspendedLanes|et)?0:j,j!==0&&j!==_e.retryLane&&(_e.retryLane=j,ih(o,j),gi($,o,j,-1))}return tj(),$=Ki(Error(p$1(421))),sj(o,i,et,$)}return j.data==="$?"?(i.flags|=128,i.child=o.child,i=uj.bind(null,o),j._reactRetry=i,null):(o=_e.treeContext,yg=Lf(j.nextSibling),xg=i,I=!0,zg=null,o!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=o.id,sg=o.overflow,qg=i),i=qj(i,$.children),i.flags|=4096,i)}function vj(o,i,_){o.lanes|=i;var $=o.alternate;$!==null&&($.lanes|=i),bh(o.return,i,_)}function wj(o,i,_,$,j){var _e=o.memoizedState;_e===null?o.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:$,tail:_,tailMode:j}:(_e.isBackwards=i,_e.rendering=null,_e.renderingStartTime=0,_e.last=$,_e.tail=_,_e.tailMode=j)}function xj(o,i,_){var $=i.pendingProps,j=$.revealOrder,_e=$.tail;if(Xi(o,i,$.children,_),$=L.current,$&2)$=$&1|2,i.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=i.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&vj(o,_,i);else if(o.tag===19)vj(o,_,i);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}$&=1}if(G(L,$),!(i.mode&1))i.memoizedState=null;else switch(j){case"forwards":for(_=i.child,j=null;_!==null;)o=_.alternate,o!==null&&Ch(o)===null&&(j=_),_=_.sibling;_=j,_===null?(j=i.child,i.child=null):(j=_.sibling,_.sibling=null),wj(i,!1,j,_,_e);break;case"backwards":for(_=null,j=i.child,i.child=null;j!==null;){if(o=j.alternate,o!==null&&Ch(o)===null){i.child=j;break}o=j.sibling,j.sibling=_,_=j,j=o}wj(i,!0,_,null,_e);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(o,i){!(i.mode&1)&&o!==null&&(o.alternate=null,i.alternate=null,i.flags|=2)}function Zi(o,i,_){if(o!==null&&(i.dependencies=o.dependencies),rh|=i.lanes,!(_&i.childLanes))return null;if(o!==null&&i.child!==o.child)throw Error(p$1(153));if(i.child!==null){for(o=i.child,_=Pg(o,o.pendingProps),i.child=_,_.return=i;o.sibling!==null;)o=o.sibling,_=_.sibling=Pg(o,o.pendingProps),_.return=i;_.sibling=null}return i.child}function yj(o,i,_){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var $=i.type._context,j=i.memoizedProps.value;G(Wg,$._currentValue),$._currentValue=j;break;case 13:if($=i.memoizedState,$!==null)return $.dehydrated!==null?(G(L,L.current&1),i.flags|=128,null):_&i.child.childLanes?oj(o,i,_):(G(L,L.current&1),o=Zi(o,i,_),o!==null?o.sibling:null);G(L,L.current&1);break;case 19:if($=(_&i.childLanes)!==0,o.flags&128){if($)return xj(o,i,_);i.flags|=128}if(j=i.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),G(L,L.current),$)break;return null;case 22:case 23:return i.lanes=0,dj(o,i,_)}return Zi(o,i,_)}var zj,Aj,Bj,Cj;zj=function(o,i){for(var _=i.child;_!==null;){if(_.tag===5||_.tag===6)o.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===i)break;for(;_.sibling===null;){if(_.return===null||_.return===i)return;_=_.return}_.sibling.return=_.return,_=_.sibling}};Aj=function(){};Bj=function(o,i,_,$){var j=o.memoizedProps;if(j!==$){o=i.stateNode,xh(uh.current);var _e=null;switch(_){case"input":j=Ya(o,j),$=Ya(o,$),_e=[];break;case"select":j=A({},j,{value:void 0}),$=A({},$,{value:void 0}),_e=[];break;case"textarea":j=gb(o,j),$=gb(o,$),_e=[];break;default:typeof j.onClick!="function"&&typeof $.onClick=="function"&&(o.onclick=Bf)}ub(_,$);var et;_=null;for(nt in j)if(!$.hasOwnProperty(nt)&&j.hasOwnProperty(nt)&&j[nt]!=null)if(nt==="style"){var tt=j[nt];for(et in tt)tt.hasOwnProperty(et)&&(_||(_={}),_[et]="")}else nt!=="dangerouslySetInnerHTML"&&nt!=="children"&&nt!=="suppressContentEditableWarning"&&nt!=="suppressHydrationWarning"&&nt!=="autoFocus"&&(ea.hasOwnProperty(nt)?_e||(_e=[]):(_e=_e||[]).push(nt,null));for(nt in $){var rt=$[nt];if(tt=j!=null?j[nt]:void 0,$.hasOwnProperty(nt)&&rt!==tt&&(rt!=null||tt!=null))if(nt==="style")if(tt){for(et in tt)!tt.hasOwnProperty(et)||rt&&rt.hasOwnProperty(et)||(_||(_={}),_[et]="");for(et in rt)rt.hasOwnProperty(et)&&tt[et]!==rt[et]&&(_||(_={}),_[et]=rt[et])}else _||(_e||(_e=[]),_e.push(nt,_)),_=rt;else nt==="dangerouslySetInnerHTML"?(rt=rt?rt.__html:void 0,tt=tt?tt.__html:void 0,rt!=null&&tt!==rt&&(_e=_e||[]).push(nt,rt)):nt==="children"?typeof rt!="string"&&typeof rt!="number"||(_e=_e||[]).push(nt,""+rt):nt!=="suppressContentEditableWarning"&&nt!=="suppressHydrationWarning"&&(ea.hasOwnProperty(nt)?(rt!=null&&nt==="onScroll"&&D("scroll",o),_e||tt===rt||(_e=[])):(_e=_e||[]).push(nt,rt))}_&&(_e=_e||[]).push("style",_);var nt=_e;(i.updateQueue=nt)&&(i.flags|=4)}};Cj=function(o,i,_,$){_!==$&&(i.flags|=4)};function Dj(o,i){if(!I)switch(o.tailMode){case"hidden":i=o.tail;for(var _=null;i!==null;)i.alternate!==null&&(_=i),i=i.sibling;_===null?o.tail=null:_.sibling=null;break;case"collapsed":_=o.tail;for(var $=null;_!==null;)_.alternate!==null&&($=_),_=_.sibling;$===null?i||o.tail===null?o.tail=null:o.tail.sibling=null:$.sibling=null}}function S(o){var i=o.alternate!==null&&o.alternate.child===o.child,_=0,$=0;if(i)for(var j=o.child;j!==null;)_|=j.lanes|j.childLanes,$|=j.subtreeFlags&14680064,$|=j.flags&14680064,j.return=o,j=j.sibling;else for(j=o.child;j!==null;)_|=j.lanes|j.childLanes,$|=j.subtreeFlags,$|=j.flags,j.return=o,j=j.sibling;return o.subtreeFlags|=$,o.childLanes=_,i}function Ej(o,i,_){var $=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return $=i.stateNode,zh(),E(Wf),E(H),Eh(),$.pendingContext&&($.context=$.pendingContext,$.pendingContext=null),(o===null||o.child===null)&&(Gg(i)?i.flags|=4:o===null||o.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(o,i),S(i),null;case 5:Bh(i);var j=xh(wh.current);if(_=i.type,o!==null&&i.stateNode!=null)Bj(o,i,_,$,j),o.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!$){if(i.stateNode===null)throw Error(p$1(166));return S(i),null}if(o=xh(uh.current),Gg(i)){$=i.stateNode,_=i.type;var _e=i.memoizedProps;switch($[Of]=i,$[Pf]=_e,o=(i.mode&1)!==0,_){case"dialog":D("cancel",$),D("close",$);break;case"iframe":case"object":case"embed":D("load",$);break;case"video":case"audio":for(j=0;j<lf.length;j++)D(lf[j],$);break;case"source":D("error",$);break;case"img":case"image":case"link":D("error",$),D("load",$);break;case"details":D("toggle",$);break;case"input":Za($,_e),D("invalid",$);break;case"select":$._wrapperState={wasMultiple:!!_e.multiple},D("invalid",$);break;case"textarea":hb($,_e),D("invalid",$)}ub(_,_e),j=null;for(var et in _e)if(_e.hasOwnProperty(et)){var tt=_e[et];et==="children"?typeof tt=="string"?$.textContent!==tt&&(_e.suppressHydrationWarning!==!0&&Af($.textContent,tt,o),j=["children",tt]):typeof tt=="number"&&$.textContent!==""+tt&&(_e.suppressHydrationWarning!==!0&&Af($.textContent,tt,o),j=["children",""+tt]):ea.hasOwnProperty(et)&&tt!=null&&et==="onScroll"&&D("scroll",$)}switch(_){case"input":Va($),db$1($,_e,!0);break;case"textarea":Va($),jb($);break;case"select":case"option":break;default:typeof _e.onClick=="function"&&($.onclick=Bf)}$=j,i.updateQueue=$,$!==null&&(i.flags|=4)}else{et=j.nodeType===9?j:j.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=kb(_)),o==="http://www.w3.org/1999/xhtml"?_==="script"?(o=et.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof $.is=="string"?o=et.createElement(_,{is:$.is}):(o=et.createElement(_),_==="select"&&(et=o,$.multiple?et.multiple=!0:$.size&&(et.size=$.size))):o=et.createElementNS(o,_),o[Of]=i,o[Pf]=$,zj(o,i,!1,!1),i.stateNode=o;e:{switch(et=vb(_,$),_){case"dialog":D("cancel",o),D("close",o),j=$;break;case"iframe":case"object":case"embed":D("load",o),j=$;break;case"video":case"audio":for(j=0;j<lf.length;j++)D(lf[j],o);j=$;break;case"source":D("error",o),j=$;break;case"img":case"image":case"link":D("error",o),D("load",o),j=$;break;case"details":D("toggle",o),j=$;break;case"input":Za(o,$),j=Ya(o,$),D("invalid",o);break;case"option":j=$;break;case"select":o._wrapperState={wasMultiple:!!$.multiple},j=A({},$,{value:void 0}),D("invalid",o);break;case"textarea":hb(o,$),j=gb(o,$),D("invalid",o);break;default:j=$}ub(_,j),tt=j;for(_e in tt)if(tt.hasOwnProperty(_e)){var rt=tt[_e];_e==="style"?sb(o,rt):_e==="dangerouslySetInnerHTML"?(rt=rt?rt.__html:void 0,rt!=null&&nb(o,rt)):_e==="children"?typeof rt=="string"?(_!=="textarea"||rt!=="")&&ob(o,rt):typeof rt=="number"&&ob(o,""+rt):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(ea.hasOwnProperty(_e)?rt!=null&&_e==="onScroll"&&D("scroll",o):rt!=null&&ta(o,_e,rt,et))}switch(_){case"input":Va(o),db$1(o,$,!1);break;case"textarea":Va(o),jb(o);break;case"option":$.value!=null&&o.setAttribute("value",""+Sa($.value));break;case"select":o.multiple=!!$.multiple,_e=$.value,_e!=null?fb(o,!!$.multiple,_e,!1):$.defaultValue!=null&&fb(o,!!$.multiple,$.defaultValue,!0);break;default:typeof j.onClick=="function"&&(o.onclick=Bf)}switch(_){case"button":case"input":case"select":case"textarea":$=!!$.autoFocus;break e;case"img":$=!0;break e;default:$=!1}}$&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(o&&i.stateNode!=null)Cj(o,i,o.memoizedProps,$);else{if(typeof $!="string"&&i.stateNode===null)throw Error(p$1(166));if(_=xh(wh.current),xh(uh.current),Gg(i)){if($=i.stateNode,_=i.memoizedProps,$[Of]=i,(_e=$.nodeValue!==_)&&(o=xg,o!==null))switch(o.tag){case 3:Af($.nodeValue,_,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Af($.nodeValue,_,(o.mode&1)!==0)}_e&&(i.flags|=4)}else $=(_.nodeType===9?_:_.ownerDocument).createTextNode($),$[Of]=i,i.stateNode=$}return S(i),null;case 13:if(E(L),$=i.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,_e=!1;else if(_e=Gg(i),$!==null&&$.dehydrated!==null){if(o===null){if(!_e)throw Error(p$1(318));if(_e=i.memoizedState,_e=_e!==null?_e.dehydrated:null,!_e)throw Error(p$1(317));_e[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),_e=!1}else zg!==null&&(Fj(zg),zg=null),_e=!0;if(!_e)return i.flags&65536?i:null}return i.flags&128?(i.lanes=_,i):($=$!==null,$!==(o!==null&&o.memoizedState!==null)&&$&&(i.child.flags|=8192,i.mode&1&&(o===null||L.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(o,i),o===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L),_e=i.memoizedState,_e===null)return S(i),null;if($=(i.flags&128)!==0,et=_e.rendering,et===null)if($)Dj(_e,!1);else{if(T!==0||o!==null&&o.flags&128)for(o=i.child;o!==null;){if(et=Ch(o),et!==null){for(i.flags|=128,Dj(_e,!1),$=et.updateQueue,$!==null&&(i.updateQueue=$,i.flags|=4),i.subtreeFlags=0,$=_,_=i.child;_!==null;)_e=_,o=$,_e.flags&=14680066,et=_e.alternate,et===null?(_e.childLanes=0,_e.lanes=o,_e.child=null,_e.subtreeFlags=0,_e.memoizedProps=null,_e.memoizedState=null,_e.updateQueue=null,_e.dependencies=null,_e.stateNode=null):(_e.childLanes=et.childLanes,_e.lanes=et.lanes,_e.child=et.child,_e.subtreeFlags=0,_e.deletions=null,_e.memoizedProps=et.memoizedProps,_e.memoizedState=et.memoizedState,_e.updateQueue=et.updateQueue,_e.type=et.type,o=et.dependencies,_e.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),_=_.sibling;return G(L,L.current&1|2),i.child}o=o.sibling}_e.tail!==null&&B()>Gj&&(i.flags|=128,$=!0,Dj(_e,!1),i.lanes=4194304)}else{if(!$)if(o=Ch(et),o!==null){if(i.flags|=128,$=!0,_=o.updateQueue,_!==null&&(i.updateQueue=_,i.flags|=4),Dj(_e,!0),_e.tail===null&&_e.tailMode==="hidden"&&!et.alternate&&!I)return S(i),null}else 2*B()-_e.renderingStartTime>Gj&&_!==1073741824&&(i.flags|=128,$=!0,Dj(_e,!1),i.lanes=4194304);_e.isBackwards?(et.sibling=i.child,i.child=et):(_=_e.last,_!==null?_.sibling=et:i.child=et,_e.last=et)}return _e.tail!==null?(i=_e.tail,_e.rendering=i,_e.tail=i.sibling,_e.renderingStartTime=B(),i.sibling=null,_=L.current,G(L,$?_&1|2:_&1),i):(S(i),null);case 22:case 23:return Hj(),$=i.memoizedState!==null,o!==null&&o.memoizedState!==null!==$&&(i.flags|=8192),$&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p$1(156,i.tag))}function Ij(o,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),o=i.flags,o&65536?(i.flags=o&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),o=i.flags,o&65536&&!(o&128)?(i.flags=o&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L),o=i.memoizedState,o!==null&&o.dehydrated!==null){if(i.alternate===null)throw Error(p$1(340));Ig()}return o=i.flags,o&65536?(i.flags=o&-65537|128,i):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(o,i){var _=o.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch($){W(o,i,$)}else _.current=null}function Mj(o,i,_){try{_()}catch($){W(o,i,$)}}var Nj=!1;function Oj(o,i){if(Cf=dd,o=Me(),Ne(o)){if("selectionStart"in o)var _={start:o.selectionStart,end:o.selectionEnd};else e:{_=(_=o.ownerDocument)&&_.defaultView||window;var $=_.getSelection&&_.getSelection();if($&&$.rangeCount!==0){_=$.anchorNode;var j=$.anchorOffset,_e=$.focusNode;$=$.focusOffset;try{_.nodeType,_e.nodeType}catch{_=null;break e}var et=0,tt=-1,rt=-1,nt=0,it=0,st=o,at=null;t:for(;;){for(var ot;st!==_||j!==0&&st.nodeType!==3||(tt=et+j),st!==_e||$!==0&&st.nodeType!==3||(rt=et+$),st.nodeType===3&&(et+=st.nodeValue.length),(ot=st.firstChild)!==null;)at=st,st=ot;for(;;){if(st===o)break t;if(at===_&&++nt===j&&(tt=et),at===_e&&++it===$&&(rt=et),(ot=st.nextSibling)!==null)break;st=at,at=st.parentNode}st=ot}_=tt===-1||rt===-1?null:{start:tt,end:rt}}else _=null}_=_||{start:0,end:0}}else _=null;for(Df={focusedElem:o,selectionRange:_},dd=!1,V=i;V!==null;)if(i=V,o=i.child,(i.subtreeFlags&1028)!==0&&o!==null)o.return=i,V=o;else for(;V!==null;){i=V;try{var lt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ct=lt.memoizedProps,ft=lt.memoizedState,ut=i.stateNode,ht=ut.getSnapshotBeforeUpdate(i.elementType===i.type?ct:Ci(i.type,ct),ft);ut.__reactInternalSnapshotBeforeUpdate=ht}break;case 3:var dt=i.stateNode.containerInfo;dt.nodeType===1?dt.textContent="":dt.nodeType===9&&dt.documentElement&&dt.removeChild(dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$1(163))}}catch(mt){W(i,i.return,mt)}if(o=i.sibling,o!==null){o.return=i.return,V=o;break}V=i.return}return lt=Nj,Nj=!1,lt}function Pj(o,i,_){var $=i.updateQueue;if($=$!==null?$.lastEffect:null,$!==null){var j=$=$.next;do{if((j.tag&o)===o){var _e=j.destroy;j.destroy=void 0,_e!==void 0&&Mj(i,_,_e)}j=j.next}while(j!==$)}}function Qj(o,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var _=i=i.next;do{if((_.tag&o)===o){var $=_.create;_.destroy=$()}_=_.next}while(_!==i)}}function Rj(o){var i=o.ref;if(i!==null){var _=o.stateNode;switch(o.tag){case 5:o=_;break;default:o=_}typeof i=="function"?i(o):i.current=o}}function Sj(o){var i=o.alternate;i!==null&&(o.alternate=null,Sj(i)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(i=o.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Tj(o){return o.tag===5||o.tag===3||o.tag===4}function Uj(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Tj(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Vj(o,i,_){var $=o.tag;if($===5||$===6)o=o.stateNode,i?_.nodeType===8?_.parentNode.insertBefore(o,i):_.insertBefore(o,i):(_.nodeType===8?(i=_.parentNode,i.insertBefore(o,_)):(i=_,i.appendChild(o)),_=_._reactRootContainer,_!=null||i.onclick!==null||(i.onclick=Bf));else if($!==4&&(o=o.child,o!==null))for(Vj(o,i,_),o=o.sibling;o!==null;)Vj(o,i,_),o=o.sibling}function Wj(o,i,_){var $=o.tag;if($===5||$===6)o=o.stateNode,i?_.insertBefore(o,i):_.appendChild(o);else if($!==4&&(o=o.child,o!==null))for(Wj(o,i,_),o=o.sibling;o!==null;)Wj(o,i,_),o=o.sibling}var X=null,Xj=!1;function Yj(o,i,_){for(_=_.child;_!==null;)Zj(o,i,_),_=_.sibling}function Zj(o,i,_){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,_)}catch{}switch(_.tag){case 5:U||Lj(_,i);case 6:var $=X,j=Xj;X=null,Yj(o,i,_),X=$,Xj=j,X!==null&&(Xj?(o=X,_=_.stateNode,o.nodeType===8?o.parentNode.removeChild(_):o.removeChild(_)):X.removeChild(_.stateNode));break;case 18:X!==null&&(Xj?(o=X,_=_.stateNode,o.nodeType===8?Kf(o.parentNode,_):o.nodeType===1&&Kf(o,_),bd(o)):Kf(X,_.stateNode));break;case 4:$=X,j=Xj,X=_.stateNode.containerInfo,Xj=!0,Yj(o,i,_),X=$,Xj=j;break;case 0:case 11:case 14:case 15:if(!U&&($=_.updateQueue,$!==null&&($=$.lastEffect,$!==null))){j=$=$.next;do{var _e=j,et=_e.destroy;_e=_e.tag,et!==void 0&&(_e&2||_e&4)&&Mj(_,i,et),j=j.next}while(j!==$)}Yj(o,i,_);break;case 1:if(!U&&(Lj(_,i),$=_.stateNode,typeof $.componentWillUnmount=="function"))try{$.props=_.memoizedProps,$.state=_.memoizedState,$.componentWillUnmount()}catch(tt){W(_,i,tt)}Yj(o,i,_);break;case 21:Yj(o,i,_);break;case 22:_.mode&1?(U=($=U)||_.memoizedState!==null,Yj(o,i,_),U=$):Yj(o,i,_);break;default:Yj(o,i,_)}}function ak(o){var i=o.updateQueue;if(i!==null){o.updateQueue=null;var _=o.stateNode;_===null&&(_=o.stateNode=new Kj),i.forEach(function($){var j=bk.bind(null,o,$);_.has($)||(_.add($),$.then(j,j))})}}function ck(o,i){var _=i.deletions;if(_!==null)for(var $=0;$<_.length;$++){var j=_[$];try{var _e=o,et=i,tt=et;e:for(;tt!==null;){switch(tt.tag){case 5:X=tt.stateNode,Xj=!1;break e;case 3:X=tt.stateNode.containerInfo,Xj=!0;break e;case 4:X=tt.stateNode.containerInfo,Xj=!0;break e}tt=tt.return}if(X===null)throw Error(p$1(160));Zj(_e,et,j),X=null,Xj=!1;var rt=j.alternate;rt!==null&&(rt.return=null),j.return=null}catch(nt){W(j,i,nt)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,o),i=i.sibling}function dk(o,i){var _=o.alternate,$=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ck(i,o),ek(o),$&4){try{Pj(3,o,o.return),Qj(3,o)}catch(ct){W(o,o.return,ct)}try{Pj(5,o,o.return)}catch(ct){W(o,o.return,ct)}}break;case 1:ck(i,o),ek(o),$&512&&_!==null&&Lj(_,_.return);break;case 5:if(ck(i,o),ek(o),$&512&&_!==null&&Lj(_,_.return),o.flags&32){var j=o.stateNode;try{ob(j,"")}catch(ct){W(o,o.return,ct)}}if($&4&&(j=o.stateNode,j!=null)){var _e=o.memoizedProps,et=_!==null?_.memoizedProps:_e,tt=o.type,rt=o.updateQueue;if(o.updateQueue=null,rt!==null)try{tt==="input"&&_e.type==="radio"&&_e.name!=null&&ab(j,_e),vb(tt,et);var nt=vb(tt,_e);for(et=0;et<rt.length;et+=2){var it=rt[et],st=rt[et+1];it==="style"?sb(j,st):it==="dangerouslySetInnerHTML"?nb(j,st):it==="children"?ob(j,st):ta(j,it,st,nt)}switch(tt){case"input":bb(j,_e);break;case"textarea":ib(j,_e);break;case"select":var at=j._wrapperState.wasMultiple;j._wrapperState.wasMultiple=!!_e.multiple;var ot=_e.value;ot!=null?fb(j,!!_e.multiple,ot,!1):at!==!!_e.multiple&&(_e.defaultValue!=null?fb(j,!!_e.multiple,_e.defaultValue,!0):fb(j,!!_e.multiple,_e.multiple?[]:"",!1))}j[Pf]=_e}catch(ct){W(o,o.return,ct)}}break;case 6:if(ck(i,o),ek(o),$&4){if(o.stateNode===null)throw Error(p$1(162));j=o.stateNode,_e=o.memoizedProps;try{j.nodeValue=_e}catch(ct){W(o,o.return,ct)}}break;case 3:if(ck(i,o),ek(o),$&4&&_!==null&&_.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(ct){W(o,o.return,ct)}break;case 4:ck(i,o),ek(o);break;case 13:ck(i,o),ek(o),j=o.child,j.flags&8192&&(_e=j.memoizedState!==null,j.stateNode.isHidden=_e,!_e||j.alternate!==null&&j.alternate.memoizedState!==null||(fk=B())),$&4&&ak(o);break;case 22:if(it=_!==null&&_.memoizedState!==null,o.mode&1?(U=(nt=U)||it,ck(i,o),U=nt):ck(i,o),ek(o),$&8192){if(nt=o.memoizedState!==null,(o.stateNode.isHidden=nt)&&!it&&o.mode&1)for(V=o,it=o.child;it!==null;){for(st=V=it;V!==null;){switch(at=V,ot=at.child,at.tag){case 0:case 11:case 14:case 15:Pj(4,at,at.return);break;case 1:Lj(at,at.return);var lt=at.stateNode;if(typeof lt.componentWillUnmount=="function"){$=at,_=at.return;try{i=$,lt.props=i.memoizedProps,lt.state=i.memoizedState,lt.componentWillUnmount()}catch(ct){W($,_,ct)}}break;case 5:Lj(at,at.return);break;case 22:if(at.memoizedState!==null){gk(st);continue}}ot!==null?(ot.return=at,V=ot):gk(st)}it=it.sibling}e:for(it=null,st=o;;){if(st.tag===5){if(it===null){it=st;try{j=st.stateNode,nt?(_e=j.style,typeof _e.setProperty=="function"?_e.setProperty("display","none","important"):_e.display="none"):(tt=st.stateNode,rt=st.memoizedProps.style,et=rt!=null&&rt.hasOwnProperty("display")?rt.display:null,tt.style.display=rb("display",et))}catch(ct){W(o,o.return,ct)}}}else if(st.tag===6){if(it===null)try{st.stateNode.nodeValue=nt?"":st.memoizedProps}catch(ct){W(o,o.return,ct)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===o)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===o)break e;for(;st.sibling===null;){if(st.return===null||st.return===o)break e;it===st&&(it=null),st=st.return}it===st&&(it=null),st.sibling.return=st.return,st=st.sibling}}break;case 19:ck(i,o),ek(o),$&4&&ak(o);break;case 21:break;default:ck(i,o),ek(o)}}function ek(o){var i=o.flags;if(i&2){try{e:{for(var _=o.return;_!==null;){if(Tj(_)){var $=_;break e}_=_.return}throw Error(p$1(160))}switch($.tag){case 5:var j=$.stateNode;$.flags&32&&(ob(j,""),$.flags&=-33);var _e=Uj(o);Wj(o,_e,j);break;case 3:case 4:var et=$.stateNode.containerInfo,tt=Uj(o);Vj(o,tt,et);break;default:throw Error(p$1(161))}}catch(rt){W(o,o.return,rt)}o.flags&=-3}i&4096&&(o.flags&=-4097)}function hk(o,i,_){V=o,ik(o)}function ik(o,i,_){for(var $=(o.mode&1)!==0;V!==null;){var j=V,_e=j.child;if(j.tag===22&&$){var et=j.memoizedState!==null||Jj;if(!et){var tt=j.alternate,rt=tt!==null&&tt.memoizedState!==null||U;tt=Jj;var nt=U;if(Jj=et,(U=rt)&&!nt)for(V=j;V!==null;)et=V,rt=et.child,et.tag===22&&et.memoizedState!==null?jk(j):rt!==null?(rt.return=et,V=rt):jk(j);for(;_e!==null;)V=_e,ik(_e),_e=_e.sibling;V=j,Jj=tt,U=nt}kk(o)}else j.subtreeFlags&8772&&_e!==null?(_e.return=j,V=_e):kk(o)}}function kk(o){for(;V!==null;){var i=V;if(i.flags&8772){var _=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var $=i.stateNode;if(i.flags&4&&!U)if(_===null)$.componentDidMount();else{var j=i.elementType===i.type?_.memoizedProps:Ci(i.type,_.memoizedProps);$.componentDidUpdate(j,_.memoizedState,$.__reactInternalSnapshotBeforeUpdate)}var _e=i.updateQueue;_e!==null&&sh(i,_e,$);break;case 3:var et=i.updateQueue;if(et!==null){if(_=null,i.child!==null)switch(i.child.tag){case 5:_=i.child.stateNode;break;case 1:_=i.child.stateNode}sh(i,et,_)}break;case 5:var tt=i.stateNode;if(_===null&&i.flags&4){_=tt;var rt=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":rt.autoFocus&&_.focus();break;case"img":rt.src&&(_.src=rt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var nt=i.alternate;if(nt!==null){var it=nt.memoizedState;if(it!==null){var st=it.dehydrated;st!==null&&bd(st)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$1(163))}U||i.flags&512&&Rj(i)}catch(at){W(i,i.return,at)}}if(i===o){V=null;break}if(_=i.sibling,_!==null){_.return=i.return,V=_;break}V=i.return}}function gk(o){for(;V!==null;){var i=V;if(i===o){V=null;break}var _=i.sibling;if(_!==null){_.return=i.return,V=_;break}V=i.return}}function jk(o){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var _=i.return;try{Qj(4,i)}catch(rt){W(i,_,rt)}break;case 1:var $=i.stateNode;if(typeof $.componentDidMount=="function"){var j=i.return;try{$.componentDidMount()}catch(rt){W(i,j,rt)}}var _e=i.return;try{Rj(i)}catch(rt){W(i,_e,rt)}break;case 5:var et=i.return;try{Rj(i)}catch(rt){W(i,et,rt)}}}catch(rt){W(i,i.return,rt)}if(i===o){V=null;break}var tt=i.sibling;if(tt!==null){tt.return=i.return,V=tt;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(o){return o.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(o=C,o!==0||(o=window.event,o=o===void 0?16:jd(o.type)),o):1}function gi(o,i,_,$){if(50<yk)throw yk=0,zk=null,Error(p$1(185));Ac(o,_,$),(!(K&2)||o!==Q)&&(o===Q&&(!(K&2)&&(qk|=_),T===4&&Ck(o,Z)),Dk(o,$),_===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(o,i){var _=o.callbackNode;wc(o,i);var $=uc(o,o===Q?Z:0);if($===0)_!==null&&bc(_),o.callbackNode=null,o.callbackPriority=0;else if(i=$&-$,o.callbackPriority!==i){if(_!=null&&bc(_),i===1)o.tag===0?ig(Ek.bind(null,o)):hg(Ek.bind(null,o)),Jf(function(){!(K&6)&&jg()}),_=null;else{switch(Dc($)){case 1:_=fc;break;case 4:_=gc;break;case 16:_=hc;break;case 536870912:_=jc;break;default:_=hc}_=Fk(_,Gk.bind(null,o))}o.callbackPriority=i,o.callbackNode=_}}function Gk(o,i){if(Ak=-1,Bk=0,K&6)throw Error(p$1(327));var _=o.callbackNode;if(Hk()&&o.callbackNode!==_)return null;var $=uc(o,o===Q?Z:0);if($===0)return null;if($&30||$&o.expiredLanes||i)i=Ik(o,$);else{i=$;var j=K;K|=2;var _e=Jk();(Q!==o||Z!==i)&&(uk=null,Gj=B()+500,Kk(o,i));do try{Lk();break}catch(tt){Mk(o,tt)}while(!0);$g(),mk.current=_e,K=j,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(j=xc(o),j!==0&&($=j,i=Nk(o,j))),i===1)throw _=pk,Kk(o,0),Ck(o,$),Dk(o,B()),_;if(i===6)Ck(o,$);else{if(j=o.current.alternate,!($&30)&&!Ok(j)&&(i=Ik(o,$),i===2&&(_e=xc(o),_e!==0&&($=_e,i=Nk(o,_e))),i===1))throw _=pk,Kk(o,0),Ck(o,$),Dk(o,B()),_;switch(o.finishedWork=j,o.finishedLanes=$,i){case 0:case 1:throw Error(p$1(345));case 2:Pk(o,tk,uk);break;case 3:if(Ck(o,$),($&130023424)===$&&(i=fk+500-B(),10<i)){if(uc(o,0)!==0)break;if(j=o.suspendedLanes,(j&$)!==$){R(),o.pingedLanes|=o.suspendedLanes&j;break}o.timeoutHandle=Ff(Pk.bind(null,o,tk,uk),i);break}Pk(o,tk,uk);break;case 4:if(Ck(o,$),($&4194240)===$)break;for(i=o.eventTimes,j=-1;0<$;){var et=31-oc($);_e=1<<et,et=i[et],et>j&&(j=et),$&=~_e}if($=j,$=B()-$,$=(120>$?120:480>$?480:1080>$?1080:1920>$?1920:3e3>$?3e3:4320>$?4320:1960*lk($/1960))-$,10<$){o.timeoutHandle=Ff(Pk.bind(null,o,tk,uk),$);break}Pk(o,tk,uk);break;case 5:Pk(o,tk,uk);break;default:throw Error(p$1(329))}}}return Dk(o,B()),o.callbackNode===_?Gk.bind(null,o):null}function Nk(o,i){var _=sk;return o.current.memoizedState.isDehydrated&&(Kk(o,i).flags|=256),o=Ik(o,i),o!==2&&(i=tk,tk=_,i!==null&&Fj(i)),o}function Fj(o){tk===null?tk=o:tk.push.apply(tk,o)}function Ok(o){for(var i=o;;){if(i.flags&16384){var _=i.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var $=0;$<_.length;$++){var j=_[$],_e=j.getSnapshot;j=j.value;try{if(!He(_e(),j))return!1}catch{return!1}}}if(_=i.child,i.subtreeFlags&16384&&_!==null)_.return=i,i=_;else{if(i===o)break;for(;i.sibling===null;){if(i.return===null||i.return===o)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(o,i){for(i&=~rk,i&=~qk,o.suspendedLanes|=i,o.pingedLanes&=~i,o=o.expirationTimes;0<i;){var _=31-oc(i),$=1<<_;o[_]=-1,i&=~$}}function Ek(o){if(K&6)throw Error(p$1(327));Hk();var i=uc(o,0);if(!(i&1))return Dk(o,B()),null;var _=Ik(o,i);if(o.tag!==0&&_===2){var $=xc(o);$!==0&&(i=$,_=Nk(o,$))}if(_===1)throw _=pk,Kk(o,0),Ck(o,i),Dk(o,B()),_;if(_===6)throw Error(p$1(345));return o.finishedWork=o.current.alternate,o.finishedLanes=i,Pk(o,tk,uk),Dk(o,B()),null}function Qk(o,i){var _=K;K|=1;try{return o(i)}finally{K=_,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(o){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var _=ok.transition,$=C;try{if(ok.transition=null,C=1,o)return o()}finally{C=$,ok.transition=_,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(o,i){o.finishedWork=null,o.finishedLanes=0;var _=o.timeoutHandle;if(_!==-1&&(o.timeoutHandle=-1,Gf(_)),Y!==null)for(_=Y.return;_!==null;){var $=_;switch(wg($),$.tag){case 1:$=$.type.childContextTypes,$!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh($);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah($.type._context);break;case 22:case 23:Hj()}_=_.return}if(Q=o,Y=o=Pg(o.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(_=fh[i],$=_.interleaved,$!==null){_.interleaved=null;var j=$.next,_e=_.pending;if(_e!==null){var et=_e.next;_e.next=j,$.next=et}_.pending=$}fh=null}return o}function Mk(o,i){do{var _=Y;try{if($g(),Fh.current=Rh,Ih){for(var $=M.memoizedState;$!==null;){var j=$.queue;j!==null&&(j.pending=null),$=$.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,_===null||_.return===null){T=1,pk=i,Y=null;break}e:{var _e=o,et=_.return,tt=_,rt=i;if(i=Z,tt.flags|=32768,rt!==null&&typeof rt=="object"&&typeof rt.then=="function"){var nt=rt,it=tt,st=it.tag;if(!(it.mode&1)&&(st===0||st===11||st===15)){var at=it.alternate;at?(it.updateQueue=at.updateQueue,it.memoizedState=at.memoizedState,it.lanes=at.lanes):(it.updateQueue=null,it.memoizedState=null)}var ot=Ui(et);if(ot!==null){ot.flags&=-257,Vi(ot,et,tt,_e,i),ot.mode&1&&Si(_e,nt,i),i=ot,rt=nt;var lt=i.updateQueue;if(lt===null){var ct=new Set;ct.add(rt),i.updateQueue=ct}else lt.add(rt);break e}else{if(!(i&1)){Si(_e,nt,i),tj();break e}rt=Error(p$1(426))}}else if(I&&tt.mode&1){var ft=Ui(et);if(ft!==null){!(ft.flags&65536)&&(ft.flags|=256),Vi(ft,et,tt,_e,i),Jg(Ji(rt,tt));break e}}_e=rt=Ji(rt,tt),T!==4&&(T=2),sk===null?sk=[_e]:sk.push(_e),_e=et;do{switch(_e.tag){case 3:_e.flags|=65536,i&=-i,_e.lanes|=i;var ut=Ni(_e,rt,i);ph(_e,ut);break e;case 1:tt=rt;var ht=_e.type,dt=_e.stateNode;if(!(_e.flags&128)&&(typeof ht.getDerivedStateFromError=="function"||dt!==null&&typeof dt.componentDidCatch=="function"&&(Ri===null||!Ri.has(dt)))){_e.flags|=65536,i&=-i,_e.lanes|=i;var mt=Qi(_e,tt,i);ph(_e,mt);break e}}_e=_e.return}while(_e!==null)}Sk(_)}catch(pt){i=pt,Y===_&&_!==null&&(Y=_=_.return);continue}break}while(!0)}function Jk(){var o=mk.current;return mk.current=Rh,o===null?Rh:o}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(o,i){var _=K;K|=2;var $=Jk();(Q!==o||Z!==i)&&(uk=null,Kk(o,i));do try{Tk();break}catch(j){Mk(o,j)}while(!0);if($g(),K=_,mk.current=$,Y!==null)throw Error(p$1(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(o){var i=Vk(o.alternate,o,fj);o.memoizedProps=o.pendingProps,i===null?Sk(o):Y=i,nk.current=null}function Sk(o){var i=o;do{var _=i.alternate;if(o=i.return,i.flags&32768){if(_=Ij(_,i),_!==null){_.flags&=32767,Y=_;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{T=6,Y=null;return}}else if(_=Ej(_,i,fj),_!==null){Y=_;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=o}while(i!==null);T===0&&(T=5)}function Pk(o,i,_){var $=C,j=ok.transition;try{ok.transition=null,C=1,Wk(o,i,_,$)}finally{ok.transition=j,C=$}return null}function Wk(o,i,_,$){do Hk();while(wk!==null);if(K&6)throw Error(p$1(327));_=o.finishedWork;var j=o.finishedLanes;if(_===null)return null;if(o.finishedWork=null,o.finishedLanes=0,_===o.current)throw Error(p$1(177));o.callbackNode=null,o.callbackPriority=0;var _e=_.lanes|_.childLanes;if(Bc(o,_e),o===Q&&(Y=Q=null,Z=0),!(_.subtreeFlags&2064)&&!(_.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),_e=(_.flags&15990)!==0,_.subtreeFlags&15990||_e){_e=ok.transition,ok.transition=null;var et=C;C=1;var tt=K;K|=4,nk.current=null,Oj(o,_),dk(_,o),Oe(Df),dd=!!Cf,Df=Cf=null,o.current=_,hk(_),dc(),K=tt,C=et,ok.transition=_e}else o.current=_;if(vk&&(vk=!1,wk=o,xk=j),_e=o.pendingLanes,_e===0&&(Ri=null),mc(_.stateNode),Dk(o,B()),i!==null)for($=o.onRecoverableError,_=0;_<i.length;_++)j=i[_],$(j.value,{componentStack:j.stack,digest:j.digest});if(Oi)throw Oi=!1,o=Pi,Pi=null,o;return xk&1&&o.tag!==0&&Hk(),_e=o.pendingLanes,_e&1?o===zk?yk++:(yk=0,zk=o):yk=0,jg(),null}function Hk(){if(wk!==null){var o=Dc(xk),i=ok.transition,_=C;try{if(ok.transition=null,C=16>o?16:o,wk===null)var $=!1;else{if(o=wk,wk=null,xk=0,K&6)throw Error(p$1(331));var j=K;for(K|=4,V=o.current;V!==null;){var _e=V,et=_e.child;if(V.flags&16){var tt=_e.deletions;if(tt!==null){for(var rt=0;rt<tt.length;rt++){var nt=tt[rt];for(V=nt;V!==null;){var it=V;switch(it.tag){case 0:case 11:case 15:Pj(8,it,_e)}var st=it.child;if(st!==null)st.return=it,V=st;else for(;V!==null;){it=V;var at=it.sibling,ot=it.return;if(Sj(it),it===nt){V=null;break}if(at!==null){at.return=ot,V=at;break}V=ot}}}var lt=_e.alternate;if(lt!==null){var ct=lt.child;if(ct!==null){lt.child=null;do{var ft=ct.sibling;ct.sibling=null,ct=ft}while(ct!==null)}}V=_e}}if(_e.subtreeFlags&2064&&et!==null)et.return=_e,V=et;else e:for(;V!==null;){if(_e=V,_e.flags&2048)switch(_e.tag){case 0:case 11:case 15:Pj(9,_e,_e.return)}var ut=_e.sibling;if(ut!==null){ut.return=_e.return,V=ut;break e}V=_e.return}}var ht=o.current;for(V=ht;V!==null;){et=V;var dt=et.child;if(et.subtreeFlags&2064&&dt!==null)dt.return=et,V=dt;else e:for(et=ht;V!==null;){if(tt=V,tt.flags&2048)try{switch(tt.tag){case 0:case 11:case 15:Qj(9,tt)}}catch(pt){W(tt,tt.return,pt)}if(tt===et){V=null;break e}var mt=tt.sibling;if(mt!==null){mt.return=tt.return,V=mt;break e}V=tt.return}}if(K=j,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,o)}catch{}$=!0}return $}finally{C=_,ok.transition=i}}return!1}function Xk(o,i,_){i=Ji(_,i),i=Ni(o,i,1),o=nh(o,i,1),i=R(),o!==null&&(Ac(o,1,i),Dk(o,i))}function W(o,i,_){if(o.tag===3)Xk(o,o,_);else for(;i!==null;){if(i.tag===3){Xk(i,o,_);break}else if(i.tag===1){var $=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof $.componentDidCatch=="function"&&(Ri===null||!Ri.has($))){o=Ji(_,o),o=Qi(i,o,1),i=nh(i,o,1),o=R(),i!==null&&(Ac(i,1,o),Dk(i,o));break}}i=i.return}}function Ti(o,i,_){var $=o.pingCache;$!==null&&$.delete(i),i=R(),o.pingedLanes|=o.suspendedLanes&_,Q===o&&(Z&_)===_&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(o,0):rk|=_),Dk(o,i)}function Yk(o,i){i===0&&(o.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var _=R();o=ih(o,i),o!==null&&(Ac(o,i,_),Dk(o,_))}function uj(o){var i=o.memoizedState,_=0;i!==null&&(_=i.retryLane),Yk(o,_)}function bk(o,i){var _=0;switch(o.tag){case 13:var $=o.stateNode,j=o.memoizedState;j!==null&&(_=j.retryLane);break;case 19:$=o.stateNode;break;default:throw Error(p$1(314))}$!==null&&$.delete(i),Yk(o,_)}var Vk;Vk=function(o,i,_){if(o!==null)if(o.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(o.lanes&_)&&!(i.flags&128))return dh=!1,yj(o,i,_);dh=!!(o.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var $=i.type;ij(o,i),o=i.pendingProps;var j=Yf(i,H.current);ch(i,_),j=Nh(null,i,$,o,j,_);var _e=Sh();return i.flags|=1,typeof j=="object"&&j!==null&&typeof j.render=="function"&&j.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf($)?(_e=!0,cg(i)):_e=!1,i.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,kh(i),j.updater=Ei,i.stateNode=j,j._reactInternals=i,Ii(i,$,o,_),i=jj(null,i,$,!0,_e,_)):(i.tag=0,I&&_e&&vg(i),Xi(null,i,j,_),i=i.child),i;case 16:$=i.elementType;e:{switch(ij(o,i),o=i.pendingProps,j=$._init,$=j($._payload),i.type=$,j=i.tag=Zk($),o=Ci($,o),j){case 0:i=cj(null,i,$,o,_);break e;case 1:i=hj(null,i,$,o,_);break e;case 11:i=Yi(null,i,$,o,_);break e;case 14:i=$i(null,i,$,Ci($.type,o),_);break e}throw Error(p$1(306,$,""))}return i;case 0:return $=i.type,j=i.pendingProps,j=i.elementType===$?j:Ci($,j),cj(o,i,$,j,_);case 1:return $=i.type,j=i.pendingProps,j=i.elementType===$?j:Ci($,j),hj(o,i,$,j,_);case 3:e:{if(kj(i),o===null)throw Error(p$1(387));$=i.pendingProps,_e=i.memoizedState,j=_e.element,lh(o,i),qh(i,$,null,_);var et=i.memoizedState;if($=et.element,_e.isDehydrated)if(_e={element:$,isDehydrated:!1,cache:et.cache,pendingSuspenseBoundaries:et.pendingSuspenseBoundaries,transitions:et.transitions},i.updateQueue.baseState=_e,i.memoizedState=_e,i.flags&256){j=Ji(Error(p$1(423)),i),i=lj(o,i,$,_,j);break e}else if($!==j){j=Ji(Error(p$1(424)),i),i=lj(o,i,$,_,j);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,_=Vg(i,null,$,_),i.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Ig(),$===j){i=Zi(o,i,_);break e}Xi(o,i,$,_)}i=i.child}return i;case 5:return Ah(i),o===null&&Eg(i),$=i.type,j=i.pendingProps,_e=o!==null?o.memoizedProps:null,et=j.children,Ef($,j)?et=null:_e!==null&&Ef($,_e)&&(i.flags|=32),gj(o,i),Xi(o,i,et,_),i.child;case 6:return o===null&&Eg(i),null;case 13:return oj(o,i,_);case 4:return yh(i,i.stateNode.containerInfo),$=i.pendingProps,o===null?i.child=Ug(i,null,$,_):Xi(o,i,$,_),i.child;case 11:return $=i.type,j=i.pendingProps,j=i.elementType===$?j:Ci($,j),Yi(o,i,$,j,_);case 7:return Xi(o,i,i.pendingProps,_),i.child;case 8:return Xi(o,i,i.pendingProps.children,_),i.child;case 12:return Xi(o,i,i.pendingProps.children,_),i.child;case 10:e:{if($=i.type._context,j=i.pendingProps,_e=i.memoizedProps,et=j.value,G(Wg,$._currentValue),$._currentValue=et,_e!==null)if(He(_e.value,et)){if(_e.children===j.children&&!Wf.current){i=Zi(o,i,_);break e}}else for(_e=i.child,_e!==null&&(_e.return=i);_e!==null;){var tt=_e.dependencies;if(tt!==null){et=_e.child;for(var rt=tt.firstContext;rt!==null;){if(rt.context===$){if(_e.tag===1){rt=mh(-1,_&-_),rt.tag=2;var nt=_e.updateQueue;if(nt!==null){nt=nt.shared;var it=nt.pending;it===null?rt.next=rt:(rt.next=it.next,it.next=rt),nt.pending=rt}}_e.lanes|=_,rt=_e.alternate,rt!==null&&(rt.lanes|=_),bh(_e.return,_,i),tt.lanes|=_;break}rt=rt.next}}else if(_e.tag===10)et=_e.type===i.type?null:_e.child;else if(_e.tag===18){if(et=_e.return,et===null)throw Error(p$1(341));et.lanes|=_,tt=et.alternate,tt!==null&&(tt.lanes|=_),bh(et,_,i),et=_e.sibling}else et=_e.child;if(et!==null)et.return=_e;else for(et=_e;et!==null;){if(et===i){et=null;break}if(_e=et.sibling,_e!==null){_e.return=et.return,et=_e;break}et=et.return}_e=et}Xi(o,i,j.children,_),i=i.child}return i;case 9:return j=i.type,$=i.pendingProps.children,ch(i,_),j=eh(j),$=$(j),i.flags|=1,Xi(o,i,$,_),i.child;case 14:return $=i.type,j=Ci($,i.pendingProps),j=Ci($.type,j),$i(o,i,$,j,_);case 15:return bj(o,i,i.type,i.pendingProps,_);case 17:return $=i.type,j=i.pendingProps,j=i.elementType===$?j:Ci($,j),ij(o,i),i.tag=1,Zf($)?(o=!0,cg(i)):o=!1,ch(i,_),Gi(i,$,j),Ii(i,$,j,_),jj(null,i,$,!0,o,_);case 19:return xj(o,i,_);case 22:return dj(o,i,_)}throw Error(p$1(156,i.tag))};function Fk(o,i){return ac(o,i)}function $k(o,i,_,$){this.tag=o,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=$,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(o,i,_,$){return new $k(o,i,_,$)}function aj(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Zk(o){if(typeof o=="function")return aj(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Da)return 11;if(o===Ga)return 14}return 2}function Pg(o,i){var _=o.alternate;return _===null?(_=Bg(o.tag,i,o.key,o.mode),_.elementType=o.elementType,_.type=o.type,_.stateNode=o.stateNode,_.alternate=o,o.alternate=_):(_.pendingProps=i,_.type=o.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=o.flags&14680064,_.childLanes=o.childLanes,_.lanes=o.lanes,_.child=o.child,_.memoizedProps=o.memoizedProps,_.memoizedState=o.memoizedState,_.updateQueue=o.updateQueue,i=o.dependencies,_.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},_.sibling=o.sibling,_.index=o.index,_.ref=o.ref,_}function Rg(o,i,_,$,j,_e){var et=2;if($=o,typeof o=="function")aj(o)&&(et=1);else if(typeof o=="string")et=5;else e:switch(o){case ya:return Tg(_.children,j,_e,i);case za:et=8,j|=8;break;case Aa:return o=Bg(12,_,i,j|2),o.elementType=Aa,o.lanes=_e,o;case Ea:return o=Bg(13,_,i,j),o.elementType=Ea,o.lanes=_e,o;case Fa:return o=Bg(19,_,i,j),o.elementType=Fa,o.lanes=_e,o;case Ia:return pj(_,j,_e,i);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case Ba:et=10;break e;case Ca:et=9;break e;case Da:et=11;break e;case Ga:et=14;break e;case Ha:et=16,$=null;break e}throw Error(p$1(130,o==null?o:typeof o,""))}return i=Bg(et,_,i,j),i.elementType=o,i.type=$,i.lanes=_e,i}function Tg(o,i,_,$){return o=Bg(7,o,$,i),o.lanes=_,o}function pj(o,i,_,$){return o=Bg(22,o,$,i),o.elementType=Ia,o.lanes=_,o.stateNode={isHidden:!1},o}function Qg(o,i,_){return o=Bg(6,o,null,i),o.lanes=_,o}function Sg(o,i,_){return i=Bg(4,o.children!==null?o.children:[],o.key,i),i.lanes=_,i.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},i}function al(o,i,_,$,j){this.tag=i,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=$,this.onRecoverableError=j,this.mutableSourceEagerHydrationData=null}function bl(o,i,_,$,j,_e,et,tt,rt){return o=new al(o,i,_,tt,rt),i===1?(i=1,_e===!0&&(i|=8)):i=0,_e=Bg(3,null,null,i),o.current=_e,_e.stateNode=o,_e.memoizedState={element:$,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(_e),o}function cl(o,i,_){var $=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:$==null?null:""+$,children:o,containerInfo:i,implementation:_}}function dl(o){if(!o)return Vf;o=o._reactInternals;e:{if(Vb(o)!==o||o.tag!==1)throw Error(p$1(170));var i=o;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p$1(171))}if(o.tag===1){var _=o.type;if(Zf(_))return bg(o,_,i)}return i}function el(o,i,_,$,j,_e,et,tt,rt){return o=bl(_,$,!0,o,j,_e,et,tt,rt),o.context=dl(null),_=o.current,$=R(),j=yi(_),_e=mh($,j),_e.callback=i??null,nh(_,_e,j),o.current.lanes=j,Ac(o,j,$),Dk(o,$),o}function fl(o,i,_,$){var j=i.current,_e=R(),et=yi(j);return _=dl(_),i.context===null?i.context=_:i.pendingContext=_,i=mh(_e,et),i.payload={element:o},$=$===void 0?null:$,$!==null&&(i.callback=$),o=nh(j,i,et),o!==null&&(gi(o,j,et,_e),oh(o,j,et)),et}function gl(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function hl(o,i){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var _=o.retryLane;o.retryLane=_!==0&&_<i?_:i}}function il(o,i){hl(o,i),(o=o.alternate)&&hl(o,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(o){console.error(o)};function ll(o){this._internalRoot=o}ml.prototype.render=ll.prototype.render=function(o){var i=this._internalRoot;if(i===null)throw Error(p$1(409));fl(o,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var i=o.containerInfo;Rk(function(){fl(null,o,null,null)}),i[uf]=null}};function ml(o){this._internalRoot=o}ml.prototype.unstable_scheduleHydration=function(o){if(o){var i=Hc();o={blockedOn:null,target:o,priority:i};for(var _=0;_<Qc.length&&i!==0&&i<Qc[_].priority;_++);Qc.splice(_,0,o),_===0&&Vc(o)}};function nl(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function ol(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(o,i,_,$,j){if(j){if(typeof $=="function"){var _e=$;$=function(){var nt=gl(et);_e.call(nt)}}var et=el(i,$,o,0,null,!1,!1,"",pl);return o._reactRootContainer=et,o[uf]=et.current,sf(o.nodeType===8?o.parentNode:o),Rk(),et}for(;j=o.lastChild;)o.removeChild(j);if(typeof $=="function"){var tt=$;$=function(){var nt=gl(rt);tt.call(nt)}}var rt=bl(o,0,!1,null,null,!1,!1,"",pl);return o._reactRootContainer=rt,o[uf]=rt.current,sf(o.nodeType===8?o.parentNode:o),Rk(function(){fl(i,rt,_,$)}),rt}function rl(o,i,_,$,j){var _e=_._reactRootContainer;if(_e){var et=_e;if(typeof j=="function"){var tt=j;j=function(){var rt=gl(et);tt.call(rt)}}fl(i,et,o,j)}else et=ql(_,i,o,j,$);return gl(et)}Ec=function(o){switch(o.tag){case 3:var i=o.stateNode;if(i.current.memoizedState.isDehydrated){var _=tc(i.pendingLanes);_!==0&&(Cc(i,_|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var $=ih(o,1);if($!==null){var j=R();gi($,o,1,j)}}),il(o,1)}};Fc=function(o){if(o.tag===13){var i=ih(o,134217728);if(i!==null){var _=R();gi(i,o,134217728,_)}il(o,134217728)}};Gc=function(o){if(o.tag===13){var i=yi(o),_=ih(o,i);if(_!==null){var $=R();gi(_,o,i,$)}il(o,i)}};Hc=function(){return C};Ic=function(o,i){var _=C;try{return C=o,i()}finally{C=_}};yb=function(o,i,_){switch(i){case"input":if(bb(o,_),i=_.name,_.type==="radio"&&i!=null){for(_=o;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<_.length;i++){var $=_[i];if($!==o&&$.form===o.form){var j=Db($);if(!j)throw Error(p$1(90));Wa($),bb($,j)}}}break;case"textarea":ib(o,_);break;case"select":i=_.value,i!=null&&fb(o,!!_.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Zb(o),o===null?null:o.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(o,i){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p$1(200));return cl(o,i,null,_)};reactDom_production_min.createRoot=function(o,i){if(!nl(o))throw Error(p$1(299));var _=!1,$="",j=kl;return i!=null&&(i.unstable_strictMode===!0&&(_=!0),i.identifierPrefix!==void 0&&($=i.identifierPrefix),i.onRecoverableError!==void 0&&(j=i.onRecoverableError)),i=bl(o,1,!1,null,null,_,!1,$,j),o[uf]=i.current,sf(o.nodeType===8?o.parentNode:o),new ll(i)};reactDom_production_min.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var i=o._reactInternals;if(i===void 0)throw typeof o.render=="function"?Error(p$1(188)):(o=Object.keys(o).join(","),Error(p$1(268,o)));return o=Zb(i),o=o===null?null:o.stateNode,o};reactDom_production_min.flushSync=function(o){return Rk(o)};reactDom_production_min.hydrate=function(o,i,_){if(!ol(i))throw Error(p$1(200));return rl(null,o,i,!0,_)};reactDom_production_min.hydrateRoot=function(o,i,_){if(!nl(o))throw Error(p$1(405));var $=_!=null&&_.hydratedSources||null,j=!1,_e="",et=kl;if(_!=null&&(_.unstable_strictMode===!0&&(j=!0),_.identifierPrefix!==void 0&&(_e=_.identifierPrefix),_.onRecoverableError!==void 0&&(et=_.onRecoverableError)),i=el(i,null,o,1,_??null,j,!1,_e,et),o[uf]=i.current,sf(o),$)for(o=0;o<$.length;o++)_=$[o],j=_._getVersion,j=j(_._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[_,j]:i.mutableSourceEagerHydrationData.push(_,j);return new ml(i)};reactDom_production_min.render=function(o,i,_){if(!ol(i))throw Error(p$1(200));return rl(null,o,i,!1,_)};reactDom_production_min.unmountComponentAtNode=function(o){if(!ol(o))throw Error(p$1(40));return o._reactRootContainer?(Rk(function(){rl(null,null,o,!1,function(){o._reactRootContainer=null,o[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(o,i,_,$){if(!ol(_))throw Error(p$1(200));if(o==null||o._reactInternals===void 0)throw Error(p$1(38));return rl(o,i,_,!1,$)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(o){console.error(o)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs$1(reactDomExports),ReactDOM$1=_mergeNamespaces({__proto__:null,default:ReactDOM},[reactDomExports]);var createRoot,m$1=reactDomExports;createRoot=m$1.createRoot,m$1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$x(){return _extends$x=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$x.apply(this,arguments)}var Action;(function(o){o.Pop="POP",o.Push="PUSH",o.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(o){o===void 0&&(o={});function i($,j){let{pathname:_e,search:et,hash:tt}=$.location;return createLocation("",{pathname:_e,search:et,hash:tt},j.state&&j.state.usr||null,j.state&&j.state.key||"default")}function _($,j){return typeof j=="string"?j:createPath(j)}return getUrlBasedHistory(i,_,null,o)}function invariant$2(o,i){if(o===!1||o===null||typeof o>"u")throw new Error(i)}function warning$2(o,i){if(!o){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(o,i){return{usr:o.state,key:o.key,idx:i}}function createLocation(o,i,_,$){return _===void 0&&(_=null),_extends$x({pathname:typeof o=="string"?o:o.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:_,key:i&&i.key||$||createKey()})}function createPath(o){let{pathname:i="/",search:_="",hash:$=""}=o;return _&&_!=="?"&&(i+=_.charAt(0)==="?"?_:"?"+_),$&&$!=="#"&&(i+=$.charAt(0)==="#"?$:"#"+$),i}function parsePath(o){let i={};if(o){let _=o.indexOf("#");_>=0&&(i.hash=o.substr(_),o=o.substr(0,_));let $=o.indexOf("?");$>=0&&(i.search=o.substr($),o=o.substr(0,$)),o&&(i.pathname=o)}return i}function getUrlBasedHistory(o,i,_,$){$===void 0&&($={});let{window:j=document.defaultView,v5Compat:_e=!1}=$,et=j.history,tt=Action.Pop,rt=null,nt=it();nt==null&&(nt=0,et.replaceState(_extends$x({},et.state,{idx:nt}),""));function it(){return(et.state||{idx:null}).idx}function st(){tt=Action.Pop;let ft=it(),ut=ft==null?null:ft-nt;nt=ft,rt&&rt({action:tt,location:ct.location,delta:ut})}function at(ft,ut){tt=Action.Push;let ht=createLocation(ct.location,ft,ut);nt=it()+1;let dt=getHistoryState(ht,nt),mt=ct.createHref(ht);try{et.pushState(dt,"",mt)}catch(pt){if(pt instanceof DOMException&&pt.name==="DataCloneError")throw pt;j.location.assign(mt)}_e&&rt&&rt({action:tt,location:ct.location,delta:1})}function ot(ft,ut){tt=Action.Replace;let ht=createLocation(ct.location,ft,ut);nt=it();let dt=getHistoryState(ht,nt),mt=ct.createHref(ht);et.replaceState(dt,"",mt),_e&&rt&&rt({action:tt,location:ct.location,delta:0})}function lt(ft){let ut=j.location.origin!=="null"?j.location.origin:j.location.href,ht=typeof ft=="string"?ft:createPath(ft);return ht=ht.replace(/ $/,"%20"),invariant$2(ut,"No window.location.(origin|href) available to create URL for href: "+ht),new URL(ht,ut)}let ct={get action(){return tt},get location(){return o(j,et)},listen(ft){if(rt)throw new Error("A history only accepts one active listener");return j.addEventListener(PopStateEventType,st),rt=ft,()=>{j.removeEventListener(PopStateEventType,st),rt=null}},createHref(ft){return i(j,ft)},createURL:lt,encodeLocation(ft){let ut=lt(ft);return{pathname:ut.pathname,search:ut.search,hash:ut.hash}},push:at,replace:ot,go(ft){return et.go(ft)}};return ct}var ResultType;(function(o){o.data="data",o.deferred="deferred",o.redirect="redirect",o.error="error"})(ResultType||(ResultType={}));const immutableRouteKeys=new Set(["lazy","caseSensitive","path","id","index","children"]);function isIndexRoute(o){return o.index===!0}function convertRoutesToDataRoutes(o,i,_,$){return _===void 0&&(_=[]),$===void 0&&($={}),o.map((j,_e)=>{let et=[..._,String(_e)],tt=typeof j.id=="string"?j.id:et.join("-");if(invariant$2(j.index!==!0||!j.children,"Cannot specify children on an index route"),invariant$2(!$[tt],'Found a route id collision on id "'+tt+`".  Route id's must be globally unique within Data Router usages`),isIndexRoute(j)){let rt=_extends$x({},j,i(j),{id:tt});return $[tt]=rt,rt}else{let rt=_extends$x({},j,i(j),{id:tt,children:void 0});return $[tt]=rt,j.children&&(rt.children=convertRoutesToDataRoutes(j.children,i,et,$)),rt}})}function matchRoutes(o,i,_){return _===void 0&&(_="/"),matchRoutesImpl(o,i,_,!1)}function matchRoutesImpl(o,i,_,$){let j=typeof i=="string"?parsePath(i):i,_e=stripBasename(j.pathname||"/",_);if(_e==null)return null;let et=flattenRoutes(o);rankRouteBranches(et);let tt=null;for(let rt=0;tt==null&&rt<et.length;++rt){let nt=decodePath(_e);tt=matchRouteBranch(et[rt],nt,$)}return tt}function convertRouteMatchToUiMatch(o,i){let{route:_,pathname:$,params:j}=o;return{id:_.id,pathname:$,params:j,data:i[_.id],handle:_.handle}}function flattenRoutes(o,i,_,$){i===void 0&&(i=[]),_===void 0&&(_=[]),$===void 0&&($="");let j=(_e,et,tt)=>{let rt={relativePath:tt===void 0?_e.path||"":tt,caseSensitive:_e.caseSensitive===!0,childrenIndex:et,route:_e};rt.relativePath.startsWith("/")&&(invariant$2(rt.relativePath.startsWith($),'Absolute route path "'+rt.relativePath+'" nested under path '+('"'+$+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),rt.relativePath=rt.relativePath.slice($.length));let nt=joinPaths([$,rt.relativePath]),it=_.concat(rt);_e.children&&_e.children.length>0&&(invariant$2(_e.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+nt+'".')),flattenRoutes(_e.children,i,it,nt)),!(_e.path==null&&!_e.index)&&i.push({path:nt,score:computeScore(nt,_e.index),routesMeta:it})};return o.forEach((_e,et)=>{var tt;if(_e.path===""||!((tt=_e.path)!=null&&tt.includes("?")))j(_e,et);else for(let rt of explodeOptionalSegments(_e.path))j(_e,et,rt)}),i}function explodeOptionalSegments(o){let i=o.split("/");if(i.length===0)return[];let[_,...$]=i,j=_.endsWith("?"),_e=_.replace(/\?$/,"");if($.length===0)return j?[_e,""]:[_e];let et=explodeOptionalSegments($.join("/")),tt=[];return tt.push(...et.map(rt=>rt===""?_e:[_e,rt].join("/"))),j&&tt.push(...et),tt.map(rt=>o.startsWith("/")&&rt===""?"/":rt)}function rankRouteBranches(o){o.sort((i,_)=>i.score!==_.score?_.score-i.score:compareIndexes(i.routesMeta.map($=>$.childrenIndex),_.routesMeta.map($=>$.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=o=>o==="*";function computeScore(o,i){let _=o.split("/"),$=_.length;return _.some(isSplat)&&($+=splatPenalty),i&&($+=indexRouteValue),_.filter(j=>!isSplat(j)).reduce((j,_e)=>j+(paramRe.test(_e)?dynamicSegmentValue:_e===""?emptySegmentValue:staticSegmentValue),$)}function compareIndexes(o,i){return o.length===i.length&&o.slice(0,-1).every(($,j)=>$===i[j])?o[o.length-1]-i[i.length-1]:0}function matchRouteBranch(o,i,_){_===void 0&&(_=!1);let{routesMeta:$}=o,j={},_e="/",et=[];for(let tt=0;tt<$.length;++tt){let rt=$[tt],nt=tt===$.length-1,it=_e==="/"?i:i.slice(_e.length)||"/",st=matchPath({path:rt.relativePath,caseSensitive:rt.caseSensitive,end:nt},it),at=rt.route;if(!st&&nt&&_&&!$[$.length-1].route.index&&(st=matchPath({path:rt.relativePath,caseSensitive:rt.caseSensitive,end:!1},it)),!st)return null;Object.assign(j,st.params),et.push({params:j,pathname:joinPaths([_e,st.pathname]),pathnameBase:normalizePathname(joinPaths([_e,st.pathnameBase])),route:at}),st.pathnameBase!=="/"&&(_e=joinPaths([_e,st.pathnameBase]))}return et}function matchPath(o,i){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[_,$]=compilePath(o.path,o.caseSensitive,o.end),j=i.match(_);if(!j)return null;let _e=j[0],et=_e.replace(/(.)\/+$/,"$1"),tt=j.slice(1);return{params:$.reduce((nt,it,st)=>{let{paramName:at,isOptional:ot}=it;if(at==="*"){let ct=tt[st]||"";et=_e.slice(0,_e.length-ct.length).replace(/(.)\/+$/,"$1")}const lt=tt[st];return ot&&!lt?nt[at]=void 0:nt[at]=(lt||"").replace(/%2F/g,"/"),nt},{}),pathname:_e,pathnameBase:et,pattern:o}}function compilePath(o,i,_){i===void 0&&(i=!1),_===void 0&&(_=!0),warning$2(o==="*"||!o.endsWith("*")||o.endsWith("/*"),'Route path "'+o+'" will be treated as if it were '+('"'+o.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+o.replace(/\*$/,"/*")+'".'));let $=[],j="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(et,tt,rt)=>($.push({paramName:tt,isOptional:rt!=null}),rt?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?($.push({paramName:"*"}),j+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):_?j+="\\/*$":o!==""&&o!=="/"&&(j+="(?:(?=\\/|$))"),[new RegExp(j,i?void 0:"i"),$]}function decodePath(o){try{return o.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return warning$2(!1,'The URL path "'+o+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),o}}function stripBasename(o,i){if(i==="/")return o;if(!o.toLowerCase().startsWith(i.toLowerCase()))return null;let _=i.endsWith("/")?i.length-1:i.length,$=o.charAt(_);return $&&$!=="/"?null:o.slice(_)||"/"}function resolvePath(o,i){i===void 0&&(i="/");let{pathname:_,search:$="",hash:j=""}=typeof o=="string"?parsePath(o):o;return{pathname:_?_.startsWith("/")?_:resolvePathname(_,i):i,search:normalizeSearch($),hash:normalizeHash(j)}}function resolvePathname(o,i){let _=i.replace(/\/+$/,"").split("/");return o.split("/").forEach(j=>{j===".."?_.length>1&&_.pop():j!=="."&&_.push(j)}),_.length>1?_.join("/"):"/"}function getInvalidPathError(o,i,_,$){return"Cannot include a '"+o+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify($)+"].  Please separate it out to the ")+("`to."+_+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(o){return o.filter((i,_)=>_===0||i.route.path&&i.route.path.length>0)}function getResolveToMatches(o,i){let _=getPathContributingMatches(o);return i?_.map(($,j)=>j===_.length-1?$.pathname:$.pathnameBase):_.map($=>$.pathnameBase)}function resolveTo(o,i,_,$){$===void 0&&($=!1);let j;typeof o=="string"?j=parsePath(o):(j=_extends$x({},o),invariant$2(!j.pathname||!j.pathname.includes("?"),getInvalidPathError("?","pathname","search",j)),invariant$2(!j.pathname||!j.pathname.includes("#"),getInvalidPathError("#","pathname","hash",j)),invariant$2(!j.search||!j.search.includes("#"),getInvalidPathError("#","search","hash",j)));let _e=o===""||j.pathname==="",et=_e?"/":j.pathname,tt;if(et==null)tt=_;else{let st=i.length-1;if(!$&&et.startsWith("..")){let at=et.split("/");for(;at[0]==="..";)at.shift(),st-=1;j.pathname=at.join("/")}tt=st>=0?i[st]:"/"}let rt=resolvePath(j,tt),nt=et&&et!=="/"&&et.endsWith("/"),it=(_e||et===".")&&_.endsWith("/");return!rt.pathname.endsWith("/")&&(nt||it)&&(rt.pathname+="/"),rt}const joinPaths=o=>o.join("/").replace(/\/\/+/g,"/"),normalizePathname=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,normalizeHash=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;class ErrorResponseImpl{constructor(i,_,$,j){j===void 0&&(j=!1),this.status=i,this.statusText=_||"",this.internal=j,$ instanceof Error?(this.data=$.toString(),this.error=$):this.data=$}}function isRouteErrorResponse(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}const validMutationMethodsArr=["post","put","patch","delete"],validMutationMethods=new Set(validMutationMethodsArr),validRequestMethodsArr=["get",...validMutationMethodsArr],validRequestMethods=new Set(validRequestMethodsArr),redirectStatusCodes=new Set([301,302,303,307,308]),redirectPreserveMethodStatusCodes=new Set([307,308]),IDLE_NAVIGATION={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_FETCHER={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},IDLE_BLOCKER={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ABSOLUTE_URL_REGEX$1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,defaultMapRouteProperties=o=>({hasErrorBoundary:!!o.hasErrorBoundary}),TRANSITIONS_STORAGE_KEY="remix-router-transitions";function createRouter(o){const i=o.window?o.window:typeof window<"u"?window:void 0,_=typeof i<"u"&&typeof i.document<"u"&&typeof i.document.createElement<"u",$=!_;invariant$2(o.routes.length>0,"You must provide a non-empty routes array to createRouter");let j;if(o.mapRouteProperties)j=o.mapRouteProperties;else if(o.detectErrorBoundary){let Ht=o.detectErrorBoundary;j=Xt=>({hasErrorBoundary:Ht(Xt)})}else j=defaultMapRouteProperties;let _e={},et=convertRoutesToDataRoutes(o.routes,j,void 0,_e),tt,rt=o.basename||"/",nt=o.dataStrategy||defaultDataStrategy,it=o.patchRoutesOnNavigation,st=_extends$x({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},o.future),at=null,ot=new Set,lt=null,ct=null,ft=null,ut=o.hydrationData!=null,ht=matchRoutes(et,o.history.location,rt),dt=!1,mt=null;if(ht==null&&!it){let Ht=getInternalRouterError(404,{pathname:o.history.location.pathname}),{matches:Xt,route:tr}=getShortCircuitMatches(et);ht=Xt,mt={[tr.id]:Ht}}ht&&!o.hydrationData&&Zt(ht,et,o.history.location.pathname).active&&(ht=null);let pt;if(ht)if(ht.some(Ht=>Ht.route.lazy))pt=!1;else if(!ht.some(Ht=>Ht.route.loader))pt=!0;else if(st.v7_partialHydration){let Ht=o.hydrationData?o.hydrationData.loaderData:null,Xt=o.hydrationData?o.hydrationData.errors:null;if(Xt){let tr=ht.findIndex(wr=>Xt[wr.route.id]!==void 0);pt=ht.slice(0,tr+1).every(wr=>!shouldLoadRouteOnHydration(wr.route,Ht,Xt))}else pt=ht.every(tr=>!shouldLoadRouteOnHydration(tr.route,Ht,Xt))}else pt=o.hydrationData!=null;else if(pt=!1,ht=[],st.v7_partialHydration){let Ht=Zt(null,et,o.history.location.pathname);Ht.active&&Ht.matches&&(dt=!0,ht=Ht.matches)}let yt,gt={historyAction:o.history.action,location:o.history.location,matches:ht,initialized:pt,navigation:IDLE_NAVIGATION,restoreScrollPosition:o.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:o.hydrationData&&o.hydrationData.loaderData||{},actionData:o.hydrationData&&o.hydrationData.actionData||null,errors:o.hydrationData&&o.hydrationData.errors||mt,fetchers:new Map,blockers:new Map},vt=Action.Pop,St=!1,At,xt=!1,wt=new Map,Ot=null,Bt=!1,Ft=!1,Pt=[],Rt=new Set,Et=new Map,_t=0,Mt=-1,Dt=new Map,Lt=new Set,Ct=new Map,kt=new Map,jt=new Set,Vt=new Map,zt=new Map,qt;function Wt(){if(at=o.history.listen(Ht=>{let{action:Xt,location:tr,delta:wr}=Ht;if(qt){qt(),qt=void 0;return}warning$2(zt.size===0||wr!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Dr=qr({currentLocation:gt.location,nextLocation:tr,historyAction:Xt});if(Dr&&wr!=null){let Nr=new Promise(Qr=>{qt=Qr});o.history.go(wr*-1),bn(Dr,{state:"blocked",location:tr,proceed(){bn(Dr,{state:"proceeding",proceed:void 0,reset:void 0,location:tr}),Nr.then(()=>o.history.go(wr))},reset(){let Qr=new Map(gt.blockers);Qr.set(Dr,IDLE_BLOCKER),Qt({blockers:Qr})}});return}return er(Xt,tr)}),_){restoreAppliedTransitions(i,wt);let Ht=()=>persistAppliedTransitions(i,wt);i.addEventListener("pagehide",Ht),Ot=()=>i.removeEventListener("pagehide",Ht)}return gt.initialized||er(Action.Pop,gt.location,{initialHydration:!0}),yt}function ir(){at&&at(),Ot&&Ot(),ot.clear(),At&&At.abort(),gt.fetchers.forEach((Ht,Xt)=>Jr(Xt)),gt.blockers.forEach((Ht,Xt)=>en(Xt))}function or(Ht){return ot.add(Ht),()=>ot.delete(Ht)}function Qt(Ht,Xt){Xt===void 0&&(Xt={}),gt=_extends$x({},gt,Ht);let tr=[],wr=[];st.v7_fetcherPersist&&gt.fetchers.forEach((Dr,Nr)=>{Dr.state==="idle"&&(jt.has(Nr)?wr.push(Nr):tr.push(Nr))}),jt.forEach(Dr=>{!gt.fetchers.has(Dr)&&!Et.has(Dr)&&wr.push(Dr)}),[...ot].forEach(Dr=>Dr(gt,{deletedFetchers:wr,viewTransitionOpts:Xt.viewTransitionOpts,flushSync:Xt.flushSync===!0})),st.v7_fetcherPersist?(tr.forEach(Dr=>gt.fetchers.delete(Dr)),wr.forEach(Dr=>Jr(Dr))):wr.forEach(Dr=>jt.delete(Dr))}function gr(Ht,Xt,tr){var wr,Dr;let{flushSync:Nr}=tr===void 0?{}:tr,Qr=gt.actionData!=null&&gt.navigation.formMethod!=null&&isMutationMethod(gt.navigation.formMethod)&&gt.navigation.state==="loading"&&((wr=Ht.state)==null?void 0:wr._isRedirect)!==!0,Ur;Xt.actionData?Object.keys(Xt.actionData).length>0?Ur=Xt.actionData:Ur=null:Qr?Ur=gt.actionData:Ur=null;let Br=Xt.loaderData?mergeLoaderData(gt.loaderData,Xt.loaderData,Xt.matches||[],Xt.errors):gt.loaderData,Kr=gt.blockers;Kr.size>0&&(Kr=new Map(Kr),Kr.forEach((gn,Tn)=>Kr.set(Tn,IDLE_BLOCKER)));let Yr=St===!0||gt.navigation.formMethod!=null&&isMutationMethod(gt.navigation.formMethod)&&((Dr=Ht.state)==null?void 0:Dr._isRedirect)!==!0;tt&&(et=tt,tt=void 0),Bt||vt===Action.Pop||(vt===Action.Push?o.history.push(Ht,Ht.state):vt===Action.Replace&&o.history.replace(Ht,Ht.state));let on;if(vt===Action.Pop){let gn=wt.get(gt.location.pathname);gn&&gn.has(Ht.pathname)?on={currentLocation:gt.location,nextLocation:Ht}:wt.has(Ht.pathname)&&(on={currentLocation:Ht,nextLocation:gt.location})}else if(xt){let gn=wt.get(gt.location.pathname);gn?gn.add(Ht.pathname):(gn=new Set([Ht.pathname]),wt.set(gt.location.pathname,gn)),on={currentLocation:gt.location,nextLocation:Ht}}Qt(_extends$x({},Xt,{actionData:Ur,loaderData:Br,historyAction:vt,location:Ht,initialized:!0,navigation:IDLE_NAVIGATION,revalidation:"idle",restoreScrollPosition:rn(Ht,Xt.matches||gt.matches),preventScrollReset:Yr,blockers:Kr}),{viewTransitionOpts:on,flushSync:Nr===!0}),vt=Action.Pop,St=!1,xt=!1,Bt=!1,Ft=!1,Pt=[]}async function ar(Ht,Xt){if(typeof Ht=="number"){o.history.go(Ht);return}let tr=normalizeTo(gt.location,gt.matches,rt,st.v7_prependBasename,Ht,st.v7_relativeSplatPath,Xt==null?void 0:Xt.fromRouteId,Xt==null?void 0:Xt.relative),{path:wr,submission:Dr,error:Nr}=normalizeNavigateOptions(st.v7_normalizeFormMethod,!1,tr,Xt),Qr=gt.location,Ur=createLocation(gt.location,wr,Xt&&Xt.state);Ur=_extends$x({},Ur,o.history.encodeLocation(Ur));let Br=Xt&&Xt.replace!=null?Xt.replace:void 0,Kr=Action.Push;Br===!0?Kr=Action.Replace:Br===!1||Dr!=null&&isMutationMethod(Dr.formMethod)&&Dr.formAction===gt.location.pathname+gt.location.search&&(Kr=Action.Replace);let Yr=Xt&&"preventScrollReset"in Xt?Xt.preventScrollReset===!0:void 0,on=(Xt&&Xt.flushSync)===!0,gn=qr({currentLocation:Qr,nextLocation:Ur,historyAction:Kr});if(gn){bn(gn,{state:"blocked",location:Ur,proceed(){bn(gn,{state:"proceeding",proceed:void 0,reset:void 0,location:Ur}),ar(Ht,Xt)},reset(){let Tn=new Map(gt.blockers);Tn.set(gn,IDLE_BLOCKER),Qt({blockers:Tn})}});return}return await er(Kr,Ur,{submission:Dr,pendingError:Nr,preventScrollReset:Yr,replace:Xt&&Xt.replace,enableViewTransition:Xt&&Xt.viewTransition,flushSync:on})}function Ar(){if(Gr(),Qt({revalidation:"loading"}),gt.navigation.state!=="submitting"){if(gt.navigation.state==="idle"){er(gt.historyAction,gt.location,{startUninterruptedRevalidation:!0});return}er(vt||gt.historyAction,gt.navigation.location,{overrideNavigation:gt.navigation,enableViewTransition:xt===!0})}}async function er(Ht,Xt,tr){At&&At.abort(),At=null,vt=Ht,Bt=(tr&&tr.startUninterruptedRevalidation)===!0,hn(gt.location,gt.matches),St=(tr&&tr.preventScrollReset)===!0,xt=(tr&&tr.enableViewTransition)===!0;let wr=tt||et,Dr=tr&&tr.overrideNavigation,Nr=tr!=null&&tr.initialHydration&&gt.matches&&gt.matches.length>0&&!dt?gt.matches:matchRoutes(wr,Xt,rt),Qr=(tr&&tr.flushSync)===!0;if(Nr&&gt.initialized&&!Ft&&isHashChangeOnly(gt.location,Xt)&&!(tr&&tr.submission&&isMutationMethod(tr.submission.formMethod))){gr(Xt,{matches:Nr},{flushSync:Qr});return}let Ur=Zt(Nr,wr,Xt.pathname);if(Ur.active&&Ur.matches&&(Nr=Ur.matches),!Nr){let{error:En,notFoundMatches:xn,route:In}=rr(Xt.pathname);gr(Xt,{matches:xn,loaderData:{},errors:{[In.id]:En}},{flushSync:Qr});return}At=new AbortController;let Br=createClientSideRequest(o.history,Xt,At.signal,tr&&tr.submission),Kr;if(tr&&tr.pendingError)Kr=[findNearestBoundary(Nr).route.id,{type:ResultType.error,error:tr.pendingError}];else if(tr&&tr.submission&&isMutationMethod(tr.submission.formMethod)){let En=await sr(Br,Xt,tr.submission,Nr,Ur.active,{replace:tr.replace,flushSync:Qr});if(En.shortCircuited)return;if(En.pendingActionResult){let[xn,In]=En.pendingActionResult;if(isErrorResult(In)&&isRouteErrorResponse(In.error)&&In.error.status===404){At=null,gr(Xt,{matches:En.matches,loaderData:{},errors:{[xn]:In.error}});return}}Nr=En.matches||Nr,Kr=En.pendingActionResult,Dr=getLoadingNavigation(Xt,tr.submission),Qr=!1,Ur.active=!1,Br=createClientSideRequest(o.history,Br.url,Br.signal)}let{shortCircuited:Yr,matches:on,loaderData:gn,errors:Tn}=await Gt(Br,Xt,Nr,Ur.active,Dr,tr&&tr.submission,tr&&tr.fetcherSubmission,tr&&tr.replace,tr&&tr.initialHydration===!0,Qr,Kr);Yr||(At=null,gr(Xt,_extends$x({matches:on||Nr},getActionDataForCommit(Kr),{loaderData:gn,errors:Tn})))}async function sr(Ht,Xt,tr,wr,Dr,Nr){Nr===void 0&&(Nr={}),Gr();let Qr=getSubmittingNavigation(Xt,tr);if(Qt({navigation:Qr},{flushSync:Nr.flushSync===!0}),Dr){let Kr=await Yt(wr,Xt.pathname,Ht.signal);if(Kr.type==="aborted")return{shortCircuited:!0};if(Kr.type==="error"){let Yr=findNearestBoundary(Kr.partialMatches).route.id;return{matches:Kr.partialMatches,pendingActionResult:[Yr,{type:ResultType.error,error:Kr.error}]}}else if(Kr.matches)wr=Kr.matches;else{let{notFoundMatches:Yr,error:on,route:gn}=rr(Xt.pathname);return{matches:Yr,pendingActionResult:[gn.id,{type:ResultType.error,error:on}]}}}let Ur,Br=getTargetMatch(wr,Xt);if(!Br.route.action&&!Br.route.lazy)Ur={type:ResultType.error,error:getInternalRouterError(405,{method:Ht.method,pathname:Xt.pathname,routeId:Br.route.id})};else if(Ur=(await fr("action",gt,Ht,[Br],wr,null))[Br.route.id],Ht.signal.aborted)return{shortCircuited:!0};if(isRedirectResult(Ur)){let Kr;return Nr&&Nr.replace!=null?Kr=Nr.replace:Kr=normalizeRedirectLocation(Ur.response.headers.get("Location"),new URL(Ht.url),rt)===gt.location.pathname+gt.location.search,await Or(Ht,Ur,!0,{submission:tr,replace:Kr}),{shortCircuited:!0}}if(isDeferredResult(Ur))throw getInternalRouterError(400,{type:"defer-action"});if(isErrorResult(Ur)){let Kr=findNearestBoundary(wr,Br.route.id);return(Nr&&Nr.replace)!==!0&&(vt=Action.Push),{matches:wr,pendingActionResult:[Kr.route.id,Ur]}}return{matches:wr,pendingActionResult:[Br.route.id,Ur]}}async function Gt(Ht,Xt,tr,wr,Dr,Nr,Qr,Ur,Br,Kr,Yr){let on=Dr||getLoadingNavigation(Xt,Nr),gn=Nr||Qr||getSubmissionFromNavigation(on),Tn=!Bt&&(!st.v7_partialHydration||!Br);if(wr){if(Tn){let On=Jt(Yr);Qt(_extends$x({navigation:on},On!==void 0?{actionData:On}:{}),{flushSync:Kr})}let Cn=await Yt(tr,Xt.pathname,Ht.signal);if(Cn.type==="aborted")return{shortCircuited:!0};if(Cn.type==="error"){let On=findNearestBoundary(Cn.partialMatches).route.id;return{matches:Cn.partialMatches,loaderData:{},errors:{[On]:Cn.error}}}else if(Cn.matches)tr=Cn.matches;else{let{error:On,notFoundMatches:Qn,route:ss}=rr(Xt.pathname);return{matches:Qn,loaderData:{},errors:{[ss.id]:On}}}}let En=tt||et,[xn,In]=getMatchesToLoad(o.history,gt,tr,gn,Xt,st.v7_partialHydration&&Br===!0,st.v7_skipActionErrorRevalidation,Ft,Pt,Rt,jt,Ct,Lt,En,rt,Yr);if(Fr(Cn=>!(tr&&tr.some(On=>On.route.id===Cn))||xn&&xn.some(On=>On.route.id===Cn)),Mt=++_t,xn.length===0&&In.length===0){let Cn=jr();return gr(Xt,_extends$x({matches:tr,loaderData:{},errors:Yr&&isErrorResult(Yr[1])?{[Yr[0]]:Yr[1].error}:null},getActionDataForCommit(Yr),Cn?{fetchers:new Map(gt.fetchers)}:{}),{flushSync:Kr}),{shortCircuited:!0}}if(Tn){let Cn={};if(!wr){Cn.navigation=on;let On=Jt(Yr);On!==void 0&&(Cn.actionData=On)}In.length>0&&(Cn.fetchers=lr(In)),Qt(Cn,{flushSync:Kr})}In.forEach(Cn=>{yn(Cn.key),Cn.controller&&Et.set(Cn.key,Cn.controller)});let jn=()=>In.forEach(Cn=>yn(Cn.key));At&&At.signal.addEventListener("abort",jn);let{loaderResults:$n,fetcherResults:Un}=await Hr(gt,tr,xn,In,Ht);if(Ht.signal.aborted)return{shortCircuited:!0};At&&At.signal.removeEventListener("abort",jn),In.forEach(Cn=>Et.delete(Cn.key));let Nn=findRedirect($n);if(Nn)return await Or(Ht,Nn.result,!0,{replace:Ur}),{shortCircuited:!0};if(Nn=findRedirect(Un),Nn)return Lt.add(Nn.key),await Or(Ht,Nn.result,!0,{replace:Ur}),{shortCircuited:!0};let{loaderData:ds,errors:zn}=processLoaderData(gt,tr,$n,Yr,In,Un,Vt);Vt.forEach((Cn,On)=>{Cn.subscribe(Qn=>{(Qn||Cn.done)&&Vt.delete(On)})}),st.v7_partialHydration&&Br&&gt.errors&&(zn=_extends$x({},gt.errors,zn));let qn=jr(),rs=cr(Mt),ns=qn||rs||In.length>0;return _extends$x({matches:tr,loaderData:ds,errors:zn},ns?{fetchers:new Map(gt.fetchers)}:{})}function Jt(Ht){if(Ht&&!isErrorResult(Ht[1]))return{[Ht[0]]:Ht[1].data};if(gt.actionData)return Object.keys(gt.actionData).length===0?null:gt.actionData}function lr(Ht){return Ht.forEach(Xt=>{let tr=gt.fetchers.get(Xt.key),wr=getLoadingFetcher(void 0,tr?tr.data:void 0);gt.fetchers.set(Xt.key,wr)}),new Map(gt.fetchers)}function dr(Ht,Xt,tr,wr){if($)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");yn(Ht);let Dr=(wr&&wr.flushSync)===!0,Nr=tt||et,Qr=normalizeTo(gt.location,gt.matches,rt,st.v7_prependBasename,tr,st.v7_relativeSplatPath,Xt,wr==null?void 0:wr.relative),Ur=matchRoutes(Nr,Qr,rt),Br=Zt(Ur,Nr,Qr);if(Br.active&&Br.matches&&(Ur=Br.matches),!Ur){nn(Ht,Xt,getInternalRouterError(404,{pathname:Qr}),{flushSync:Dr});return}let{path:Kr,submission:Yr,error:on}=normalizeNavigateOptions(st.v7_normalizeFormMethod,!0,Qr,wr);if(on){nn(Ht,Xt,on,{flushSync:Dr});return}let gn=getTargetMatch(Ur,Kr),Tn=(wr&&wr.preventScrollReset)===!0;if(Yr&&isMutationMethod(Yr.formMethod)){xr(Ht,Xt,Kr,gn,Ur,Br.active,Dr,Tn,Yr);return}Ct.set(Ht,{routeId:Xt,path:Kr}),Mr(Ht,Xt,Kr,gn,Ur,Br.active,Dr,Tn,Yr)}async function xr(Ht,Xt,tr,wr,Dr,Nr,Qr,Ur,Br){Gr(),Ct.delete(Ht);function Kr(Sn){if(!Sn.route.action&&!Sn.route.lazy){let _i=getInternalRouterError(405,{method:Br.formMethod,pathname:tr,routeId:Xt});return nn(Ht,Xt,_i,{flushSync:Qr}),!0}return!1}if(!Nr&&Kr(wr))return;let Yr=gt.fetchers.get(Ht);dn(Ht,getSubmittingFetcher(Br,Yr),{flushSync:Qr});let on=new AbortController,gn=createClientSideRequest(o.history,tr,on.signal,Br);if(Nr){let Sn=await Yt(Dr,new URL(gn.url).pathname,gn.signal,Ht);if(Sn.type==="aborted")return;if(Sn.type==="error"){nn(Ht,Xt,Sn.error,{flushSync:Qr});return}else if(Sn.matches){if(Dr=Sn.matches,wr=getTargetMatch(Dr,tr),Kr(wr))return}else{nn(Ht,Xt,getInternalRouterError(404,{pathname:tr}),{flushSync:Qr});return}}Et.set(Ht,on);let Tn=_t,xn=(await fr("action",gt,gn,[wr],Dr,Ht))[wr.route.id];if(gn.signal.aborted){Et.get(Ht)===on&&Et.delete(Ht);return}if(st.v7_fetcherPersist&&jt.has(Ht)){if(isRedirectResult(xn)||isErrorResult(xn)){dn(Ht,getDoneFetcher(void 0));return}}else{if(isRedirectResult(xn))if(Et.delete(Ht),Mt>Tn){dn(Ht,getDoneFetcher(void 0));return}else return Lt.add(Ht),dn(Ht,getLoadingFetcher(Br)),Or(gn,xn,!1,{fetcherSubmission:Br,preventScrollReset:Ur});if(isErrorResult(xn)){nn(Ht,Xt,xn.error);return}}if(isDeferredResult(xn))throw getInternalRouterError(400,{type:"defer-action"});let In=gt.navigation.location||gt.location,jn=createClientSideRequest(o.history,In,on.signal),$n=tt||et,Un=gt.navigation.state!=="idle"?matchRoutes($n,gt.navigation.location,rt):gt.matches;invariant$2(Un,"Didn't find any matches after fetcher action");let Nn=++_t;Dt.set(Ht,Nn);let ds=getLoadingFetcher(Br,xn.data);gt.fetchers.set(Ht,ds);let[zn,qn]=getMatchesToLoad(o.history,gt,Un,Br,In,!1,st.v7_skipActionErrorRevalidation,Ft,Pt,Rt,jt,Ct,Lt,$n,rt,[wr.route.id,xn]);qn.filter(Sn=>Sn.key!==Ht).forEach(Sn=>{let _i=Sn.key,Ts=gt.fetchers.get(_i),ps=getLoadingFetcher(void 0,Ts?Ts.data:void 0);gt.fetchers.set(_i,ps),yn(_i),Sn.controller&&Et.set(_i,Sn.controller)}),Qt({fetchers:new Map(gt.fetchers)});let rs=()=>qn.forEach(Sn=>yn(Sn.key));on.signal.addEventListener("abort",rs);let{loaderResults:ns,fetcherResults:Cn}=await Hr(gt,Un,zn,qn,jn);if(on.signal.aborted)return;on.signal.removeEventListener("abort",rs),Dt.delete(Ht),Et.delete(Ht),qn.forEach(Sn=>Et.delete(Sn.key));let On=findRedirect(ns);if(On)return Or(jn,On.result,!1,{preventScrollReset:Ur});if(On=findRedirect(Cn),On)return Lt.add(On.key),Or(jn,On.result,!1,{preventScrollReset:Ur});let{loaderData:Qn,errors:ss}=processLoaderData(gt,Un,ns,void 0,qn,Cn,Vt);if(gt.fetchers.has(Ht)){let Sn=getDoneFetcher(xn.data);gt.fetchers.set(Ht,Sn)}cr(Nn),gt.navigation.state==="loading"&&Nn>Mt?(invariant$2(vt,"Expected pending action"),At&&At.abort(),gr(gt.navigation.location,{matches:Un,loaderData:Qn,errors:ss,fetchers:new Map(gt.fetchers)})):(Qt({errors:ss,loaderData:mergeLoaderData(gt.loaderData,Qn,Un,ss),fetchers:new Map(gt.fetchers)}),Ft=!1)}async function Mr(Ht,Xt,tr,wr,Dr,Nr,Qr,Ur,Br){let Kr=gt.fetchers.get(Ht);dn(Ht,getLoadingFetcher(Br,Kr?Kr.data:void 0),{flushSync:Qr});let Yr=new AbortController,on=createClientSideRequest(o.history,tr,Yr.signal);if(Nr){let xn=await Yt(Dr,new URL(on.url).pathname,on.signal,Ht);if(xn.type==="aborted")return;if(xn.type==="error"){nn(Ht,Xt,xn.error,{flushSync:Qr});return}else if(xn.matches)Dr=xn.matches,wr=getTargetMatch(Dr,tr);else{nn(Ht,Xt,getInternalRouterError(404,{pathname:tr}),{flushSync:Qr});return}}Et.set(Ht,Yr);let gn=_t,En=(await fr("loader",gt,on,[wr],Dr,Ht))[wr.route.id];if(isDeferredResult(En)&&(En=await resolveDeferredData(En,on.signal,!0)||En),Et.get(Ht)===Yr&&Et.delete(Ht),!on.signal.aborted){if(jt.has(Ht)){dn(Ht,getDoneFetcher(void 0));return}if(isRedirectResult(En))if(Mt>gn){dn(Ht,getDoneFetcher(void 0));return}else{Lt.add(Ht),await Or(on,En,!1,{preventScrollReset:Ur});return}if(isErrorResult(En)){nn(Ht,Xt,En.error);return}invariant$2(!isDeferredResult(En),"Unhandled fetcher deferred data"),dn(Ht,getDoneFetcher(En.data))}}async function Or(Ht,Xt,tr,wr){let{submission:Dr,fetcherSubmission:Nr,preventScrollReset:Qr,replace:Ur}=wr===void 0?{}:wr;Xt.response.headers.has("X-Remix-Revalidate")&&(Ft=!0);let Br=Xt.response.headers.get("Location");invariant$2(Br,"Expected a Location header on the redirect Response"),Br=normalizeRedirectLocation(Br,new URL(Ht.url),rt);let Kr=createLocation(gt.location,Br,{_isRedirect:!0});if(_){let xn=!1;if(Xt.response.headers.has("X-Remix-Reload-Document"))xn=!0;else if(ABSOLUTE_URL_REGEX$1.test(Br)){const In=o.history.createURL(Br);xn=In.origin!==i.location.origin||stripBasename(In.pathname,rt)==null}if(xn){Ur?i.location.replace(Br):i.location.assign(Br);return}}At=null;let Yr=Ur===!0||Xt.response.headers.has("X-Remix-Replace")?Action.Replace:Action.Push,{formMethod:on,formAction:gn,formEncType:Tn}=gt.navigation;!Dr&&!Nr&&on&&gn&&Tn&&(Dr=getSubmissionFromNavigation(gt.navigation));let En=Dr||Nr;if(redirectPreserveMethodStatusCodes.has(Xt.response.status)&&En&&isMutationMethod(En.formMethod))await er(Yr,Kr,{submission:_extends$x({},En,{formAction:Br}),preventScrollReset:Qr||St,enableViewTransition:tr?xt:void 0});else{let xn=getLoadingNavigation(Kr,Dr);await er(Yr,Kr,{overrideNavigation:xn,fetcherSubmission:Nr,preventScrollReset:Qr||St,enableViewTransition:tr?xt:void 0})}}async function fr(Ht,Xt,tr,wr,Dr,Nr){let Qr,Ur={};try{Qr=await callDataStrategyImpl(nt,Ht,Xt,tr,wr,Dr,Nr,_e,j)}catch(Br){return wr.forEach(Kr=>{Ur[Kr.route.id]={type:ResultType.error,error:Br}}),Ur}for(let[Br,Kr]of Object.entries(Qr))if(isRedirectDataStrategyResultResult(Kr)){let Yr=Kr.result;Ur[Br]={type:ResultType.redirect,response:normalizeRelativeRoutingRedirectResponse(Yr,tr,Br,Dr,rt,st.v7_relativeSplatPath)}}else Ur[Br]=await convertDataStrategyResultToDataResult(Kr);return Ur}async function Hr(Ht,Xt,tr,wr,Dr){let Nr=Ht.matches,Qr=fr("loader",Ht,Dr,tr,Xt,null),Ur=Promise.all(wr.map(async Yr=>{if(Yr.matches&&Yr.match&&Yr.controller){let gn=(await fr("loader",Ht,createClientSideRequest(o.history,Yr.path,Yr.controller.signal),[Yr.match],Yr.matches,Yr.key))[Yr.match.route.id];return{[Yr.key]:gn}}else return Promise.resolve({[Yr.key]:{type:ResultType.error,error:getInternalRouterError(404,{pathname:Yr.path})}})})),Br=await Qr,Kr=(await Ur).reduce((Yr,on)=>Object.assign(Yr,on),{});return await Promise.all([resolveNavigationDeferredResults(Xt,Br,Dr.signal,Nr,Ht.loaderData),resolveFetcherDeferredResults(Xt,Kr,wr)]),{loaderResults:Br,fetcherResults:Kr}}function Gr(){Ft=!0,Pt.push(...Fr()),Ct.forEach((Ht,Xt)=>{Et.has(Xt)&&Rt.add(Xt),yn(Xt)})}function dn(Ht,Xt,tr){tr===void 0&&(tr={}),gt.fetchers.set(Ht,Xt),Qt({fetchers:new Map(gt.fetchers)},{flushSync:(tr&&tr.flushSync)===!0})}function nn(Ht,Xt,tr,wr){wr===void 0&&(wr={});let Dr=findNearestBoundary(gt.matches,Xt);Jr(Ht),Qt({errors:{[Dr.route.id]:tr},fetchers:new Map(gt.fetchers)},{flushSync:(wr&&wr.flushSync)===!0})}function vn(Ht){return kt.set(Ht,(kt.get(Ht)||0)+1),jt.has(Ht)&&jt.delete(Ht),gt.fetchers.get(Ht)||IDLE_FETCHER}function Jr(Ht){let Xt=gt.fetchers.get(Ht);Et.has(Ht)&&!(Xt&&Xt.state==="loading"&&Dt.has(Ht))&&yn(Ht),Ct.delete(Ht),Dt.delete(Ht),Lt.delete(Ht),st.v7_fetcherPersist&&jt.delete(Ht),Rt.delete(Ht),gt.fetchers.delete(Ht)}function an(Ht){let Xt=(kt.get(Ht)||0)-1;Xt<=0?(kt.delete(Ht),jt.add(Ht),st.v7_fetcherPersist||Jr(Ht)):kt.set(Ht,Xt),Qt({fetchers:new Map(gt.fetchers)})}function yn(Ht){let Xt=Et.get(Ht);Xt&&(Xt.abort(),Et.delete(Ht))}function _n(Ht){for(let Xt of Ht){let tr=vn(Xt),wr=getDoneFetcher(tr.data);gt.fetchers.set(Xt,wr)}}function jr(){let Ht=[],Xt=!1;for(let tr of Lt){let wr=gt.fetchers.get(tr);invariant$2(wr,"Expected fetcher: "+tr),wr.state==="loading"&&(Lt.delete(tr),Ht.push(tr),Xt=!0)}return _n(Ht),Xt}function cr(Ht){let Xt=[];for(let[tr,wr]of Dt)if(wr<Ht){let Dr=gt.fetchers.get(tr);invariant$2(Dr,"Expected fetcher: "+tr),Dr.state==="loading"&&(yn(tr),Dt.delete(tr),Xt.push(tr))}return _n(Xt),Xt.length>0}function Sr(Ht,Xt){let tr=gt.blockers.get(Ht)||IDLE_BLOCKER;return zt.get(Ht)!==Xt&&zt.set(Ht,Xt),tr}function en(Ht){gt.blockers.delete(Ht),zt.delete(Ht)}function bn(Ht,Xt){let tr=gt.blockers.get(Ht)||IDLE_BLOCKER;invariant$2(tr.state==="unblocked"&&Xt.state==="blocked"||tr.state==="blocked"&&Xt.state==="blocked"||tr.state==="blocked"&&Xt.state==="proceeding"||tr.state==="blocked"&&Xt.state==="unblocked"||tr.state==="proceeding"&&Xt.state==="unblocked","Invalid blocker state transition: "+tr.state+" -> "+Xt.state);let wr=new Map(gt.blockers);wr.set(Ht,Xt),Qt({blockers:wr})}function qr(Ht){let{currentLocation:Xt,nextLocation:tr,historyAction:wr}=Ht;if(zt.size===0)return;zt.size>1&&warning$2(!1,"A router only supports one blocker at a time");let Dr=Array.from(zt.entries()),[Nr,Qr]=Dr[Dr.length-1],Ur=gt.blockers.get(Nr);if(!(Ur&&Ur.state==="proceeding")&&Qr({currentLocation:Xt,nextLocation:tr,historyAction:wr}))return Nr}function rr(Ht){let Xt=getInternalRouterError(404,{pathname:Ht}),tr=tt||et,{matches:wr,route:Dr}=getShortCircuitMatches(tr);return Fr(),{notFoundMatches:wr,route:Dr,error:Xt}}function Fr(Ht){let Xt=[];return Vt.forEach((tr,wr)=>{(!Ht||Ht(wr))&&(tr.cancel(),Xt.push(wr),Vt.delete(wr))}),Xt}function Xr(Ht,Xt,tr){if(lt=Ht,ft=Xt,ct=tr||null,!ut&&gt.navigation===IDLE_NAVIGATION){ut=!0;let wr=rn(gt.location,gt.matches);wr!=null&&Qt({restoreScrollPosition:wr})}return()=>{lt=null,ft=null,ct=null}}function un(Ht,Xt){return ct&&ct(Ht,Xt.map(wr=>convertRouteMatchToUiMatch(wr,gt.loaderData)))||Ht.key}function hn(Ht,Xt){if(lt&&ft){let tr=un(Ht,Xt);lt[tr]=ft()}}function rn(Ht,Xt){if(lt){let tr=un(Ht,Xt),wr=lt[tr];if(typeof wr=="number")return wr}return null}function Zt(Ht,Xt,tr){if(it)if(Ht){if(Object.keys(Ht[0].params).length>0)return{active:!0,matches:matchRoutesImpl(Xt,tr,rt,!0)}}else return{active:!0,matches:matchRoutesImpl(Xt,tr,rt,!0)||[]};return{active:!1,matches:null}}async function Yt(Ht,Xt,tr,wr){if(!it)return{type:"success",matches:Ht};let Dr=Ht;for(;;){let Nr=tt==null,Qr=tt||et,Ur=_e;try{await it({signal:tr,path:Xt,matches:Dr,fetcherKey:wr,patch:(Yr,on)=>{tr.aborted||patchRoutesImpl(Yr,on,Qr,Ur,j)}})}catch(Yr){return{type:"error",error:Yr,partialMatches:Dr}}finally{Nr&&!tr.aborted&&(et=[...et])}if(tr.aborted)return{type:"aborted"};let Br=matchRoutes(Qr,Xt,rt);if(Br)return{type:"success",matches:Br};let Kr=matchRoutesImpl(Qr,Xt,rt,!0);if(!Kr||Dr.length===Kr.length&&Dr.every((Yr,on)=>Yr.route.id===Kr[on].route.id))return{type:"success",matches:null};Dr=Kr}}function hr(Ht){_e={},tt=convertRoutesToDataRoutes(Ht,j,void 0,_e)}function Lr(Ht,Xt){let tr=tt==null;patchRoutesImpl(Ht,Xt,tt||et,_e,j),tr&&(et=[...et],Qt({}))}return yt={get basename(){return rt},get future(){return st},get state(){return gt},get routes(){return et},get window(){return i},initialize:Wt,subscribe:or,enableScrollRestoration:Xr,navigate:ar,fetch:dr,revalidate:Ar,createHref:Ht=>o.history.createHref(Ht),encodeLocation:Ht=>o.history.encodeLocation(Ht),getFetcher:vn,deleteFetcher:an,dispose:ir,getBlocker:Sr,deleteBlocker:en,patchRoutes:Lr,_internalFetchControllers:Et,_internalActiveDeferreds:Vt,_internalSetRoutes:hr},yt}function isSubmissionNavigation(o){return o!=null&&("formData"in o&&o.formData!=null||"body"in o&&o.body!==void 0)}function normalizeTo(o,i,_,$,j,_e,et,tt){let rt,nt;if(et){rt=[];for(let st of i)if(rt.push(st),st.route.id===et){nt=st;break}}else rt=i,nt=i[i.length-1];let it=resolveTo(j||".",getResolveToMatches(rt,_e),stripBasename(o.pathname,_)||o.pathname,tt==="path");if(j==null&&(it.search=o.search,it.hash=o.hash),(j==null||j===""||j===".")&&nt){let st=hasNakedIndexQuery(it.search);if(nt.route.index&&!st)it.search=it.search?it.search.replace(/^\?/,"?index&"):"?index";else if(!nt.route.index&&st){let at=new URLSearchParams(it.search),ot=at.getAll("index");at.delete("index"),ot.filter(ct=>ct).forEach(ct=>at.append("index",ct));let lt=at.toString();it.search=lt?"?"+lt:""}}return $&&_!=="/"&&(it.pathname=it.pathname==="/"?_:joinPaths([_,it.pathname])),createPath(it)}function normalizeNavigateOptions(o,i,_,$){if(!$||!isSubmissionNavigation($))return{path:_};if($.formMethod&&!isValidMethod($.formMethod))return{path:_,error:getInternalRouterError(405,{method:$.formMethod})};let j=()=>({path:_,error:getInternalRouterError(400,{type:"invalid-body"})}),_e=$.formMethod||"get",et=o?_e.toUpperCase():_e.toLowerCase(),tt=stripHashFromPath(_);if($.body!==void 0){if($.formEncType==="text/plain"){if(!isMutationMethod(et))return j();let at=typeof $.body=="string"?$.body:$.body instanceof FormData||$.body instanceof URLSearchParams?Array.from($.body.entries()).reduce((ot,lt)=>{let[ct,ft]=lt;return""+ot+ct+"="+ft+`
`},""):String($.body);return{path:_,submission:{formMethod:et,formAction:tt,formEncType:$.formEncType,formData:void 0,json:void 0,text:at}}}else if($.formEncType==="application/json"){if(!isMutationMethod(et))return j();try{let at=typeof $.body=="string"?JSON.parse($.body):$.body;return{path:_,submission:{formMethod:et,formAction:tt,formEncType:$.formEncType,formData:void 0,json:at,text:void 0}}}catch{return j()}}}invariant$2(typeof FormData=="function","FormData is not available in this environment");let rt,nt;if($.formData)rt=convertFormDataToSearchParams($.formData),nt=$.formData;else if($.body instanceof FormData)rt=convertFormDataToSearchParams($.body),nt=$.body;else if($.body instanceof URLSearchParams)rt=$.body,nt=convertSearchParamsToFormData(rt);else if($.body==null)rt=new URLSearchParams,nt=new FormData;else try{rt=new URLSearchParams($.body),nt=convertSearchParamsToFormData(rt)}catch{return j()}let it={formMethod:et,formAction:tt,formEncType:$&&$.formEncType||"application/x-www-form-urlencoded",formData:nt,json:void 0,text:void 0};if(isMutationMethod(it.formMethod))return{path:_,submission:it};let st=parsePath(_);return i&&st.search&&hasNakedIndexQuery(st.search)&&rt.append("index",""),st.search="?"+rt,{path:createPath(st),submission:it}}function getLoaderMatchesUntilBoundary(o,i,_){_===void 0&&(_=!1);let $=o.findIndex(j=>j.route.id===i);return $>=0?o.slice(0,_?$+1:$):o}function getMatchesToLoad(o,i,_,$,j,_e,et,tt,rt,nt,it,st,at,ot,lt,ct){let ft=ct?isErrorResult(ct[1])?ct[1].error:ct[1].data:void 0,ut=o.createURL(i.location),ht=o.createURL(j),dt=_;_e&&i.errors?dt=getLoaderMatchesUntilBoundary(_,Object.keys(i.errors)[0],!0):ct&&isErrorResult(ct[1])&&(dt=getLoaderMatchesUntilBoundary(_,ct[0]));let mt=ct?ct[1].statusCode:void 0,pt=et&&mt&&mt>=400,yt=dt.filter((vt,St)=>{let{route:At}=vt;if(At.lazy)return!0;if(At.loader==null)return!1;if(_e)return shouldLoadRouteOnHydration(At,i.loaderData,i.errors);if(isNewLoader(i.loaderData,i.matches[St],vt)||rt.some(Ot=>Ot===vt.route.id))return!0;let xt=i.matches[St],wt=vt;return shouldRevalidateLoader(vt,_extends$x({currentUrl:ut,currentParams:xt.params,nextUrl:ht,nextParams:wt.params},$,{actionResult:ft,actionStatus:mt,defaultShouldRevalidate:pt?!1:tt||ut.pathname+ut.search===ht.pathname+ht.search||ut.search!==ht.search||isNewRouteInstance(xt,wt)}))}),gt=[];return st.forEach((vt,St)=>{if(_e||!_.some(Bt=>Bt.route.id===vt.routeId)||it.has(St))return;let At=matchRoutes(ot,vt.path,lt);if(!At){gt.push({key:St,routeId:vt.routeId,path:vt.path,matches:null,match:null,controller:null});return}let xt=i.fetchers.get(St),wt=getTargetMatch(At,vt.path),Ot=!1;at.has(St)?Ot=!1:nt.has(St)?(nt.delete(St),Ot=!0):xt&&xt.state!=="idle"&&xt.data===void 0?Ot=tt:Ot=shouldRevalidateLoader(wt,_extends$x({currentUrl:ut,currentParams:i.matches[i.matches.length-1].params,nextUrl:ht,nextParams:_[_.length-1].params},$,{actionResult:ft,actionStatus:mt,defaultShouldRevalidate:pt?!1:tt})),Ot&&gt.push({key:St,routeId:vt.routeId,path:vt.path,matches:At,match:wt,controller:new AbortController})}),[yt,gt]}function shouldLoadRouteOnHydration(o,i,_){if(o.lazy)return!0;if(!o.loader)return!1;let $=i!=null&&i[o.id]!==void 0,j=_!=null&&_[o.id]!==void 0;return!$&&j?!1:typeof o.loader=="function"&&o.loader.hydrate===!0?!0:!$&&!j}function isNewLoader(o,i,_){let $=!i||_.route.id!==i.route.id,j=o[_.route.id]===void 0;return $||j}function isNewRouteInstance(o,i){let _=o.route.path;return o.pathname!==i.pathname||_!=null&&_.endsWith("*")&&o.params["*"]!==i.params["*"]}function shouldRevalidateLoader(o,i){if(o.route.shouldRevalidate){let _=o.route.shouldRevalidate(i);if(typeof _=="boolean")return _}return i.defaultShouldRevalidate}function patchRoutesImpl(o,i,_,$,j){var _e;let et;if(o){let nt=$[o];invariant$2(nt,"No route found to patch children into: routeId = "+o),nt.children||(nt.children=[]),et=nt.children}else et=_;let tt=i.filter(nt=>!et.some(it=>isSameRoute(nt,it))),rt=convertRoutesToDataRoutes(tt,j,[o||"_","patch",String(((_e=et)==null?void 0:_e.length)||"0")],$);et.push(...rt)}function isSameRoute(o,i){return"id"in o&&"id"in i&&o.id===i.id?!0:o.index===i.index&&o.path===i.path&&o.caseSensitive===i.caseSensitive?(!o.children||o.children.length===0)&&(!i.children||i.children.length===0)?!0:o.children.every((_,$)=>{var j;return(j=i.children)==null?void 0:j.some(_e=>isSameRoute(_,_e))}):!1}async function loadLazyRouteModule(o,i,_){if(!o.lazy)return;let $=await o.lazy();if(!o.lazy)return;let j=_[o.id];invariant$2(j,"No route found in manifest");let _e={};for(let et in $){let rt=j[et]!==void 0&&et!=="hasErrorBoundary";warning$2(!rt,'Route "'+j.id+'" has a static property "'+et+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+et+'" will be ignored.')),!rt&&!immutableRouteKeys.has(et)&&(_e[et]=$[et])}Object.assign(j,_e),Object.assign(j,_extends$x({},i(j),{lazy:void 0}))}async function defaultDataStrategy(o){let{matches:i}=o,_=i.filter(j=>j.shouldLoad);return(await Promise.all(_.map(j=>j.resolve()))).reduce((j,_e,et)=>Object.assign(j,{[_[et].route.id]:_e}),{})}async function callDataStrategyImpl(o,i,_,$,j,_e,et,tt,rt,nt){let it=_e.map(ot=>ot.route.lazy?loadLazyRouteModule(ot.route,rt,tt):void 0),st=_e.map((ot,lt)=>{let ct=it[lt],ft=j.some(ht=>ht.route.id===ot.route.id);return _extends$x({},ot,{shouldLoad:ft,resolve:async ht=>(ht&&$.method==="GET"&&(ot.route.lazy||ot.route.loader)&&(ft=!0),ft?callLoaderOrAction(i,$,ot,ct,ht,nt):Promise.resolve({type:ResultType.data,result:void 0}))})}),at=await o({matches:st,request:$,params:_e[0].params,fetcherKey:et,context:nt});try{await Promise.all(it)}catch{}return at}async function callLoaderOrAction(o,i,_,$,j,_e){let et,tt,rt=nt=>{let it,st=new Promise((lt,ct)=>it=ct);tt=()=>it(),i.signal.addEventListener("abort",tt);let at=lt=>typeof nt!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+o+'" [routeId: '+_.route.id+"]"))):nt({request:i,params:_.params,context:_e},...lt!==void 0?[lt]:[]),ot=(async()=>{try{return{type:"data",result:await(j?j(ct=>at(ct)):at())}}catch(lt){return{type:"error",result:lt}}})();return Promise.race([ot,st])};try{let nt=_.route[o];if($)if(nt){let it,[st]=await Promise.all([rt(nt).catch(at=>{it=at}),$]);if(it!==void 0)throw it;et=st}else if(await $,nt=_.route[o],nt)et=await rt(nt);else if(o==="action"){let it=new URL(i.url),st=it.pathname+it.search;throw getInternalRouterError(405,{method:i.method,pathname:st,routeId:_.route.id})}else return{type:ResultType.data,result:void 0};else if(nt)et=await rt(nt);else{let it=new URL(i.url),st=it.pathname+it.search;throw getInternalRouterError(404,{pathname:st})}invariant$2(et.result!==void 0,"You defined "+(o==="action"?"an action":"a loader")+" for route "+('"'+_.route.id+"\" but didn't return anything from your `"+o+"` ")+"function. Please return a value or `null`.")}catch(nt){return{type:ResultType.error,result:nt}}finally{tt&&i.signal.removeEventListener("abort",tt)}return et}async function convertDataStrategyResultToDataResult(o){let{result:i,type:_}=o;if(isResponse(i)){let st;try{let at=i.headers.get("Content-Type");at&&/\bapplication\/json\b/.test(at)?i.body==null?st=null:st=await i.json():st=await i.text()}catch(at){return{type:ResultType.error,error:at}}return _===ResultType.error?{type:ResultType.error,error:new ErrorResponseImpl(i.status,i.statusText,st),statusCode:i.status,headers:i.headers}:{type:ResultType.data,data:st,statusCode:i.status,headers:i.headers}}if(_===ResultType.error){if(isDataWithResponseInit(i)){var $,j;if(i.data instanceof Error){var _e,et;return{type:ResultType.error,error:i.data,statusCode:(_e=i.init)==null?void 0:_e.status,headers:(et=i.init)!=null&&et.headers?new Headers(i.init.headers):void 0}}return{type:ResultType.error,error:new ErrorResponseImpl((($=i.init)==null?void 0:$.status)||500,void 0,i.data),statusCode:isRouteErrorResponse(i)?i.status:void 0,headers:(j=i.init)!=null&&j.headers?new Headers(i.init.headers):void 0}}return{type:ResultType.error,error:i,statusCode:isRouteErrorResponse(i)?i.status:void 0}}if(isDeferredData(i)){var tt,rt;return{type:ResultType.deferred,deferredData:i,statusCode:(tt=i.init)==null?void 0:tt.status,headers:((rt=i.init)==null?void 0:rt.headers)&&new Headers(i.init.headers)}}if(isDataWithResponseInit(i)){var nt,it;return{type:ResultType.data,data:i.data,statusCode:(nt=i.init)==null?void 0:nt.status,headers:(it=i.init)!=null&&it.headers?new Headers(i.init.headers):void 0}}return{type:ResultType.data,data:i}}function normalizeRelativeRoutingRedirectResponse(o,i,_,$,j,_e){let et=o.headers.get("Location");if(invariant$2(et,"Redirects returned/thrown from loaders/actions must have a Location header"),!ABSOLUTE_URL_REGEX$1.test(et)){let tt=$.slice(0,$.findIndex(rt=>rt.route.id===_)+1);et=normalizeTo(new URL(i.url),tt,j,!0,et,_e),o.headers.set("Location",et)}return o}function normalizeRedirectLocation(o,i,_){if(ABSOLUTE_URL_REGEX$1.test(o)){let $=o,j=$.startsWith("//")?new URL(i.protocol+$):new URL($),_e=stripBasename(j.pathname,_)!=null;if(j.origin===i.origin&&_e)return j.pathname+j.search+j.hash}return o}function createClientSideRequest(o,i,_,$){let j=o.createURL(stripHashFromPath(i)).toString(),_e={signal:_};if($&&isMutationMethod($.formMethod)){let{formMethod:et,formEncType:tt}=$;_e.method=et.toUpperCase(),tt==="application/json"?(_e.headers=new Headers({"Content-Type":tt}),_e.body=JSON.stringify($.json)):tt==="text/plain"?_e.body=$.text:tt==="application/x-www-form-urlencoded"&&$.formData?_e.body=convertFormDataToSearchParams($.formData):_e.body=$.formData}return new Request(j,_e)}function convertFormDataToSearchParams(o){let i=new URLSearchParams;for(let[_,$]of o.entries())i.append(_,typeof $=="string"?$:$.name);return i}function convertSearchParamsToFormData(o){let i=new FormData;for(let[_,$]of o.entries())i.append(_,$);return i}function processRouteLoaderData(o,i,_,$,j){let _e={},et=null,tt,rt=!1,nt={},it=_&&isErrorResult(_[1])?_[1].error:void 0;return o.forEach(st=>{if(!(st.route.id in i))return;let at=st.route.id,ot=i[at];if(invariant$2(!isRedirectResult(ot),"Cannot handle redirect results in processLoaderData"),isErrorResult(ot)){let lt=ot.error;it!==void 0&&(lt=it,it=void 0),et=et||{};{let ct=findNearestBoundary(o,at);et[ct.route.id]==null&&(et[ct.route.id]=lt)}_e[at]=void 0,rt||(rt=!0,tt=isRouteErrorResponse(ot.error)?ot.error.status:500),ot.headers&&(nt[at]=ot.headers)}else isDeferredResult(ot)?($.set(at,ot.deferredData),_e[at]=ot.deferredData.data,ot.statusCode!=null&&ot.statusCode!==200&&!rt&&(tt=ot.statusCode),ot.headers&&(nt[at]=ot.headers)):(_e[at]=ot.data,ot.statusCode&&ot.statusCode!==200&&!rt&&(tt=ot.statusCode),ot.headers&&(nt[at]=ot.headers))}),it!==void 0&&_&&(et={[_[0]]:it},_e[_[0]]=void 0),{loaderData:_e,errors:et,statusCode:tt||200,loaderHeaders:nt}}function processLoaderData(o,i,_,$,j,_e,et){let{loaderData:tt,errors:rt}=processRouteLoaderData(i,_,$,et);return j.forEach(nt=>{let{key:it,match:st,controller:at}=nt,ot=_e[it];if(invariant$2(ot,"Did not find corresponding fetcher result"),!(at&&at.signal.aborted))if(isErrorResult(ot)){let lt=findNearestBoundary(o.matches,st==null?void 0:st.route.id);rt&&rt[lt.route.id]||(rt=_extends$x({},rt,{[lt.route.id]:ot.error})),o.fetchers.delete(it)}else if(isRedirectResult(ot))invariant$2(!1,"Unhandled fetcher revalidation redirect");else if(isDeferredResult(ot))invariant$2(!1,"Unhandled fetcher deferred data");else{let lt=getDoneFetcher(ot.data);o.fetchers.set(it,lt)}}),{loaderData:tt,errors:rt}}function mergeLoaderData(o,i,_,$){let j=_extends$x({},i);for(let _e of _){let et=_e.route.id;if(i.hasOwnProperty(et)?i[et]!==void 0&&(j[et]=i[et]):o[et]!==void 0&&_e.route.loader&&(j[et]=o[et]),$&&$.hasOwnProperty(et))break}return j}function getActionDataForCommit(o){return o?isErrorResult(o[1])?{actionData:{}}:{actionData:{[o[0]]:o[1].data}}:{}}function findNearestBoundary(o,i){return(i?o.slice(0,o.findIndex($=>$.route.id===i)+1):[...o]).reverse().find($=>$.route.hasErrorBoundary===!0)||o[0]}function getShortCircuitMatches(o){let i=o.length===1?o[0]:o.find(_=>_.index||!_.path||_.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:i}],route:i}}function getInternalRouterError(o,i){let{pathname:_,routeId:$,method:j,type:_e,message:et}=i===void 0?{}:i,tt="Unknown Server Error",rt="Unknown @remix-run/router error";return o===400?(tt="Bad Request",j&&_&&$?rt="You made a "+j+' request to "'+_+'" but '+('did not provide a `loader` for route "'+$+'", ')+"so there is no way to handle the request.":_e==="defer-action"?rt="defer() is not supported in actions":_e==="invalid-body"&&(rt="Unable to encode submission body")):o===403?(tt="Forbidden",rt='Route "'+$+'" does not match URL "'+_+'"'):o===404?(tt="Not Found",rt='No route matches URL "'+_+'"'):o===405&&(tt="Method Not Allowed",j&&_&&$?rt="You made a "+j.toUpperCase()+' request to "'+_+'" but '+('did not provide an `action` for route "'+$+'", ')+"so there is no way to handle the request.":j&&(rt='Invalid request method "'+j.toUpperCase()+'"')),new ErrorResponseImpl(o||500,tt,new Error(rt),!0)}function findRedirect(o){let i=Object.entries(o);for(let _=i.length-1;_>=0;_--){let[$,j]=i[_];if(isRedirectResult(j))return{key:$,result:j}}}function stripHashFromPath(o){let i=typeof o=="string"?parsePath(o):o;return createPath(_extends$x({},i,{hash:""}))}function isHashChangeOnly(o,i){return o.pathname!==i.pathname||o.search!==i.search?!1:o.hash===""?i.hash!=="":o.hash===i.hash?!0:i.hash!==""}function isRedirectDataStrategyResultResult(o){return isResponse(o.result)&&redirectStatusCodes.has(o.result.status)}function isDeferredResult(o){return o.type===ResultType.deferred}function isErrorResult(o){return o.type===ResultType.error}function isRedirectResult(o){return(o&&o.type)===ResultType.redirect}function isDataWithResponseInit(o){return typeof o=="object"&&o!=null&&"type"in o&&"data"in o&&"init"in o&&o.type==="DataWithResponseInit"}function isDeferredData(o){let i=o;return i&&typeof i=="object"&&typeof i.data=="object"&&typeof i.subscribe=="function"&&typeof i.cancel=="function"&&typeof i.resolveData=="function"}function isResponse(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.headers=="object"&&typeof o.body<"u"}function isValidMethod(o){return validRequestMethods.has(o.toLowerCase())}function isMutationMethod(o){return validMutationMethods.has(o.toLowerCase())}async function resolveNavigationDeferredResults(o,i,_,$,j){let _e=Object.entries(i);for(let et=0;et<_e.length;et++){let[tt,rt]=_e[et],nt=o.find(at=>(at==null?void 0:at.route.id)===tt);if(!nt)continue;let it=$.find(at=>at.route.id===nt.route.id),st=it!=null&&!isNewRouteInstance(it,nt)&&(j&&j[nt.route.id])!==void 0;isDeferredResult(rt)&&st&&await resolveDeferredData(rt,_,!1).then(at=>{at&&(i[tt]=at)})}}async function resolveFetcherDeferredResults(o,i,_){for(let $=0;$<_.length;$++){let{key:j,routeId:_e,controller:et}=_[$],tt=i[j];o.find(nt=>(nt==null?void 0:nt.route.id)===_e)&&isDeferredResult(tt)&&(invariant$2(et,"Expected an AbortController for revalidating fetcher deferred result"),await resolveDeferredData(tt,et.signal,!0).then(nt=>{nt&&(i[j]=nt)}))}}async function resolveDeferredData(o,i,_){if(_===void 0&&(_=!1),!await o.deferredData.resolveData(i)){if(_)try{return{type:ResultType.data,data:o.deferredData.unwrappedData}}catch(j){return{type:ResultType.error,error:j}}return{type:ResultType.data,data:o.deferredData.data}}}function hasNakedIndexQuery(o){return new URLSearchParams(o).getAll("index").some(i=>i==="")}function getTargetMatch(o,i){let _=typeof i=="string"?parsePath(i).search:i.search;if(o[o.length-1].route.index&&hasNakedIndexQuery(_||""))return o[o.length-1];let $=getPathContributingMatches(o);return $[$.length-1]}function getSubmissionFromNavigation(o){let{formMethod:i,formAction:_,formEncType:$,text:j,formData:_e,json:et}=o;if(!(!i||!_||!$)){if(j!=null)return{formMethod:i,formAction:_,formEncType:$,formData:void 0,json:void 0,text:j};if(_e!=null)return{formMethod:i,formAction:_,formEncType:$,formData:_e,json:void 0,text:void 0};if(et!==void 0)return{formMethod:i,formAction:_,formEncType:$,formData:void 0,json:et,text:void 0}}}function getLoadingNavigation(o,i){return i?{state:"loading",location:o,formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text}:{state:"loading",location:o,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function getSubmittingNavigation(o,i){return{state:"submitting",location:o,formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text}}function getLoadingFetcher(o,i){return o?{state:"loading",formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text,data:i}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:i}}function getSubmittingFetcher(o,i){return{state:"submitting",formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text,data:i?i.data:void 0}}function getDoneFetcher(o){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:o}}function restoreAppliedTransitions(o,i){try{let _=o.sessionStorage.getItem(TRANSITIONS_STORAGE_KEY);if(_){let $=JSON.parse(_);for(let[j,_e]of Object.entries($||{}))_e&&Array.isArray(_e)&&i.set(j,new Set(_e||[]))}}catch{}}function persistAppliedTransitions(o,i){if(i.size>0){let _={};for(let[$,j]of i)_[$]=[...j];try{o.sessionStorage.setItem(TRANSITIONS_STORAGE_KEY,JSON.stringify(_))}catch($){warning$2(!1,"Failed to save applied view transitions in sessionStorage ("+$+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$w(){return _extends$w=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$w.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(o,i){let{relative:_}=i===void 0?{}:i;useInRouterContext()||invariant$2(!1);let{basename:$,navigator:j}=reactExports.useContext(NavigationContext),{hash:_e,pathname:et,search:tt}=useResolvedPath(o,{relative:_}),rt=et;return $!=="/"&&(rt=et==="/"?$:joinPaths([$,et])),j.createHref({pathname:rt,search:tt,hash:_e})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$2(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(o){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(o)}function useNavigate(){let{isDataRoute:o}=reactExports.useContext(RouteContext);return o?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$2(!1);let o=reactExports.useContext(DataRouterContext),{basename:i,future:_,navigator:$}=reactExports.useContext(NavigationContext),{matches:j}=reactExports.useContext(RouteContext),{pathname:_e}=useLocation(),et=JSON.stringify(getResolveToMatches(j,_.v7_relativeSplatPath)),tt=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{tt.current=!0}),reactExports.useCallback(function(nt,it){if(it===void 0&&(it={}),!tt.current)return;if(typeof nt=="number"){$.go(nt);return}let st=resolveTo(nt,JSON.parse(et),_e,it.relative==="path");o==null&&i!=="/"&&(st.pathname=st.pathname==="/"?i:joinPaths([i,st.pathname])),(it.replace?$.replace:$.push)(st,it.state,it)},[i,$,et,_e,o])}const OutletContext=reactExports.createContext(null);function useOutlet(o){let i=reactExports.useContext(RouteContext).outlet;return i&&reactExports.createElement(OutletContext.Provider,{value:o},i)}function useParams(){let{matches:o}=reactExports.useContext(RouteContext),i=o[o.length-1];return i?i.params:{}}function useResolvedPath(o,i){let{relative:_}=i===void 0?{}:i,{future:$}=reactExports.useContext(NavigationContext),{matches:j}=reactExports.useContext(RouteContext),{pathname:_e}=useLocation(),et=JSON.stringify(getResolveToMatches(j,$.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(o,JSON.parse(et),_e,_==="path"),[o,et,_e,_])}function useRoutesImpl(o,i,_,$){useInRouterContext()||invariant$2(!1);let{navigator:j}=reactExports.useContext(NavigationContext),{matches:_e}=reactExports.useContext(RouteContext),et=_e[_e.length-1],tt=et?et.params:{};et&&et.pathname;let rt=et?et.pathnameBase:"/";et&&et.route;let nt=useLocation(),it;it=nt;let st=it.pathname||"/",at=st;if(rt!=="/"){let ct=rt.replace(/^\//,"").split("/");at="/"+st.replace(/^\//,"").split("/").slice(ct.length).join("/")}let ot=matchRoutes(o,{pathname:at});return _renderMatches(ot&&ot.map(ct=>Object.assign({},ct,{params:Object.assign({},tt,ct.params),pathname:joinPaths([rt,j.encodeLocation?j.encodeLocation(ct.pathname).pathname:ct.pathname]),pathnameBase:ct.pathnameBase==="/"?rt:joinPaths([rt,j.encodeLocation?j.encodeLocation(ct.pathnameBase).pathname:ct.pathnameBase])})),_e,_,$)}function DefaultErrorComponent(){let o=useRouteError(),i=isRouteErrorResponse(o)?o.status+" "+o.statusText:o instanceof Error?o.message:JSON.stringify(o),_=o instanceof Error?o.stack:null,j={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),_?reactExports.createElement("pre",{style:j},_):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,_){return _.location!==i.location||_.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:_.error,location:_.location,revalidation:i.revalidation||_.revalidation}}componentDidCatch(i,_){console.error("React Router caught the following error during render",i,_)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(o){let{routeContext:i,match:_,children:$}=o,j=reactExports.useContext(DataRouterContext);return j&&j.static&&j.staticContext&&(_.route.errorElement||_.route.ErrorBoundary)&&(j.staticContext._deepestRenderedBoundaryId=_.route.id),reactExports.createElement(RouteContext.Provider,{value:i},$)}function _renderMatches(o,i,_,$){var j;if(i===void 0&&(i=[]),_===void 0&&(_=null),$===void 0&&($=null),o==null){var _e;if(!_)return null;if(_.errors)o=_.matches;else if((_e=$)!=null&&_e.v7_partialHydration&&i.length===0&&!_.initialized&&_.matches.length>0)o=_.matches;else return null}let et=o,tt=(j=_)==null?void 0:j.errors;if(tt!=null){let it=et.findIndex(st=>st.route.id&&(tt==null?void 0:tt[st.route.id])!==void 0);it>=0||invariant$2(!1),et=et.slice(0,Math.min(et.length,it+1))}let rt=!1,nt=-1;if(_&&$&&$.v7_partialHydration)for(let it=0;it<et.length;it++){let st=et[it];if((st.route.HydrateFallback||st.route.hydrateFallbackElement)&&(nt=it),st.route.id){let{loaderData:at,errors:ot}=_,lt=st.route.loader&&at[st.route.id]===void 0&&(!ot||ot[st.route.id]===void 0);if(st.route.lazy||lt){rt=!0,nt>=0?et=et.slice(0,nt+1):et=[et[0]];break}}}return et.reduceRight((it,st,at)=>{let ot,lt=!1,ct=null,ft=null;_&&(ot=tt&&st.route.id?tt[st.route.id]:void 0,ct=st.route.errorElement||defaultErrorElement,rt&&(nt<0&&at===0?(warningOnce("route-fallback"),lt=!0,ft=null):nt===at&&(lt=!0,ft=st.route.hydrateFallbackElement||null)));let ut=i.concat(et.slice(0,at+1)),ht=()=>{let dt;return ot?dt=ct:lt?dt=ft:st.route.Component?dt=reactExports.createElement(st.route.Component,null):st.route.element?dt=st.route.element:dt=it,reactExports.createElement(RenderedRoute,{match:st,routeContext:{outlet:it,matches:ut,isDataRoute:_!=null},children:dt})};return _&&(st.route.ErrorBoundary||st.route.errorElement||at===0)?reactExports.createElement(RenderErrorBoundary,{location:_.location,revalidation:_.revalidation,component:ct,error:ot,children:ht(),routeContext:{outlet:null,matches:ut,isDataRoute:!0}}):ht()},null)}var DataRouterHook$1=function(o){return o.UseBlocker="useBlocker",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o}(DataRouterHook$1||{}),DataRouterStateHook$1=function(o){return o.UseBlocker="useBlocker",o.UseLoaderData="useLoaderData",o.UseActionData="useActionData",o.UseRouteError="useRouteError",o.UseNavigation="useNavigation",o.UseRouteLoaderData="useRouteLoaderData",o.UseMatches="useMatches",o.UseRevalidator="useRevalidator",o.UseNavigateStable="useNavigate",o.UseRouteId="useRouteId",o}(DataRouterStateHook$1||{});function useDataRouterContext$1(o){let i=reactExports.useContext(DataRouterContext);return i||invariant$2(!1),i}function useDataRouterState(o){let i=reactExports.useContext(DataRouterStateContext);return i||invariant$2(!1),i}function useRouteContext(o){let i=reactExports.useContext(RouteContext);return i||invariant$2(!1),i}function useCurrentRouteId(o){let i=useRouteContext(),_=i.matches[i.matches.length-1];return _.route.id||invariant$2(!1),_.route.id}function useRouteError(){var o;let i=reactExports.useContext(RouteErrorContext),_=useDataRouterState(DataRouterStateHook$1.UseRouteError),$=useCurrentRouteId();return i!==void 0?i:(o=_.errors)==null?void 0:o[$]}function useNavigateStable(){let{router:o}=useDataRouterContext$1(DataRouterHook$1.UseNavigateStable),i=useCurrentRouteId(),_=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{_.current=!0}),reactExports.useCallback(function(j,_e){_e===void 0&&(_e={}),_.current&&(typeof j=="number"?o.navigate(j):o.navigate(j,_extends$w({fromRouteId:i},_e)))},[o,i])}const alreadyWarned$1={};function warningOnce(o,i,_){alreadyWarned$1[o]||(alreadyWarned$1[o]=!0)}function logV6DeprecationWarnings(o,i){o==null||o.v7_startTransition,(o==null?void 0:o.v7_relativeSplatPath)===void 0&&(!i||i.v7_relativeSplatPath),i&&(i.v7_fetcherPersist,i.v7_normalizeFormMethod,i.v7_partialHydration,i.v7_skipActionErrorRevalidation)}function Outlet(o){return useOutlet(o.context)}function Router(o){let{basename:i="/",children:_=null,location:$,navigationType:j=Action.Pop,navigator:_e,static:et=!1,future:tt}=o;useInRouterContext()&&invariant$2(!1);let rt=i.replace(/^\/*/,"/"),nt=reactExports.useMemo(()=>({basename:rt,navigator:_e,static:et,future:_extends$w({v7_relativeSplatPath:!1},tt)}),[rt,tt,_e,et]);typeof $=="string"&&($=parsePath($));let{pathname:it="/",search:st="",hash:at="",state:ot=null,key:lt="default"}=$,ct=reactExports.useMemo(()=>{let ft=stripBasename(it,rt);return ft==null?null:{location:{pathname:ft,search:st,hash:at,state:ot,key:lt},navigationType:j}},[rt,it,st,at,ot,lt,j]);return ct==null?null:reactExports.createElement(NavigationContext.Provider,{value:nt},reactExports.createElement(LocationContext.Provider,{children:_,value:ct}))}new Promise(()=>{});function mapRouteProperties(o){let i={hasErrorBoundary:o.ErrorBoundary!=null||o.errorElement!=null};return o.Component&&Object.assign(i,{element:reactExports.createElement(o.Component),Component:void 0}),o.HydrateFallback&&Object.assign(i,{hydrateFallbackElement:reactExports.createElement(o.HydrateFallback),HydrateFallback:void 0}),o.ErrorBoundary&&Object.assign(i,{errorElement:reactExports.createElement(o.ErrorBoundary),ErrorBoundary:void 0}),i}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$v(){return _extends$v=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$v.apply(this,arguments)}function _objectWithoutPropertiesLoose$k(o,i){if(o==null)return{};var _={},$=Object.keys(o),j,_e;for(_e=0;_e<$.length;_e++)j=$[_e],!(i.indexOf(j)>=0)&&(_[j]=o[j]);return _}function isModifiedEvent(o){return!!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)}function shouldProcessLinkClick(o,i){return o.button===0&&(!i||i==="_self")&&!isModifiedEvent(o)}const _excluded$k=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],_excluded2$7=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}function createBrowserRouter(o,i){return createRouter({basename:void 0,future:_extends$v({},void 0,{v7_prependBasename:!0}),history:createBrowserHistory({window:void 0}),hydrationData:parseHydrationData(),routes:o,mapRouteProperties,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function parseHydrationData(){var o;let i=(o=window)==null?void 0:o.__staticRouterHydrationData;return i&&i.errors&&(i=_extends$v({},i,{errors:deserializeErrors(i.errors)})),i}function deserializeErrors(o){if(!o)return null;let i=Object.entries(o),_={};for(let[$,j]of i)if(j&&j.__type==="RouteErrorResponse")_[$]=new ErrorResponseImpl(j.status,j.statusText,j.data,j.internal===!0);else if(j&&j.__type==="Error"){if(j.__subType){let _e=window[j.__subType];if(typeof _e=="function")try{let et=new _e(j.message);et.stack="",_[$]=et}catch{}}if(_[$]==null){let _e=new Error(j.message);_e.stack="",_[$]=_e}}else _[$]=j;return _}const ViewTransitionContext=reactExports.createContext({isTransitioning:!1}),FetchersContext=reactExports.createContext(new Map),START_TRANSITION="startTransition",startTransitionImpl=React$3[START_TRANSITION],FLUSH_SYNC="flushSync",flushSyncImpl=ReactDOM$1[FLUSH_SYNC];function startTransitionSafe(o){startTransitionImpl?startTransitionImpl(o):o()}function flushSyncSafe(o){flushSyncImpl?flushSyncImpl(o):o()}let Deferred$1=class{constructor(){this.status="pending",this.promise=new Promise((i,_)=>{this.resolve=$=>{this.status==="pending"&&(this.status="resolved",i($))},this.reject=$=>{this.status==="pending"&&(this.status="rejected",_($))}})}};function RouterProvider(o){let{fallbackElement:i,router:_,future:$}=o,[j,_e]=reactExports.useState(_.state),[et,tt]=reactExports.useState(),[rt,nt]=reactExports.useState({isTransitioning:!1}),[it,st]=reactExports.useState(),[at,ot]=reactExports.useState(),[lt,ct]=reactExports.useState(),ft=reactExports.useRef(new Map),{v7_startTransition:ut}=$||{},ht=reactExports.useCallback(vt=>{ut?startTransitionSafe(vt):vt()},[ut]),dt=reactExports.useCallback((vt,St)=>{let{deletedFetchers:At,flushSync:xt,viewTransitionOpts:wt}=St;vt.fetchers.forEach((Bt,Ft)=>{Bt.data!==void 0&&ft.current.set(Ft,Bt.data)}),At.forEach(Bt=>ft.current.delete(Bt));let Ot=_.window==null||_.window.document==null||typeof _.window.document.startViewTransition!="function";if(!wt||Ot){xt?flushSyncSafe(()=>_e(vt)):ht(()=>_e(vt));return}if(xt){flushSyncSafe(()=>{at&&(it&&it.resolve(),at.skipTransition()),nt({isTransitioning:!0,flushSync:!0,currentLocation:wt.currentLocation,nextLocation:wt.nextLocation})});let Bt=_.window.document.startViewTransition(()=>{flushSyncSafe(()=>_e(vt))});Bt.finished.finally(()=>{flushSyncSafe(()=>{st(void 0),ot(void 0),tt(void 0),nt({isTransitioning:!1})})}),flushSyncSafe(()=>ot(Bt));return}at?(it&&it.resolve(),at.skipTransition(),ct({state:vt,currentLocation:wt.currentLocation,nextLocation:wt.nextLocation})):(tt(vt),nt({isTransitioning:!0,flushSync:!1,currentLocation:wt.currentLocation,nextLocation:wt.nextLocation}))},[_.window,at,it,ft,ht]);reactExports.useLayoutEffect(()=>_.subscribe(dt),[_,dt]),reactExports.useEffect(()=>{rt.isTransitioning&&!rt.flushSync&&st(new Deferred$1)},[rt]),reactExports.useEffect(()=>{if(it&&et&&_.window){let vt=et,St=it.promise,At=_.window.document.startViewTransition(async()=>{ht(()=>_e(vt)),await St});At.finished.finally(()=>{st(void 0),ot(void 0),tt(void 0),nt({isTransitioning:!1})}),ot(At)}},[ht,et,it,_.window]),reactExports.useEffect(()=>{it&&et&&j.location.key===et.location.key&&it.resolve()},[it,at,j.location,et]),reactExports.useEffect(()=>{!rt.isTransitioning&&lt&&(tt(lt.state),nt({isTransitioning:!0,flushSync:!1,currentLocation:lt.currentLocation,nextLocation:lt.nextLocation}),ct(void 0))},[rt.isTransitioning,lt]),reactExports.useEffect(()=>{},[]);let mt=reactExports.useMemo(()=>({createHref:_.createHref,encodeLocation:_.encodeLocation,go:vt=>_.navigate(vt),push:(vt,St,At)=>_.navigate(vt,{state:St,preventScrollReset:At==null?void 0:At.preventScrollReset}),replace:(vt,St,At)=>_.navigate(vt,{replace:!0,state:St,preventScrollReset:At==null?void 0:At.preventScrollReset})}),[_]),pt=_.basename||"/",yt=reactExports.useMemo(()=>({router:_,navigator:mt,static:!1,basename:pt}),[_,mt,pt]),gt=reactExports.useMemo(()=>({v7_relativeSplatPath:_.future.v7_relativeSplatPath}),[_.future.v7_relativeSplatPath]);return reactExports.useEffect(()=>logV6DeprecationWarnings($,_.future),[$,_.future]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(DataRouterContext.Provider,{value:yt},reactExports.createElement(DataRouterStateContext.Provider,{value:j},reactExports.createElement(FetchersContext.Provider,{value:ft.current},reactExports.createElement(ViewTransitionContext.Provider,{value:rt},reactExports.createElement(Router,{basename:pt,location:j.location,navigationType:j.historyAction,navigator:mt,future:gt},j.initialized||_.future.v7_partialHydration?reactExports.createElement(MemoizedDataRoutes,{routes:_.routes,future:_.future,state:j}):i))))),null)}const MemoizedDataRoutes=reactExports.memo(DataRoutes);function DataRoutes(o){let{routes:i,future:_,state:$}=o;return useRoutesImpl(i,void 0,$,_)}const isBrowser$3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(i,_){let{onClick:$,relative:j,reloadDocument:_e,replace:et,state:tt,target:rt,to:nt,preventScrollReset:it,viewTransition:st}=i,at=_objectWithoutPropertiesLoose$k(i,_excluded$k),{basename:ot}=reactExports.useContext(NavigationContext),lt,ct=!1;if(typeof nt=="string"&&ABSOLUTE_URL_REGEX.test(nt)&&(lt=nt,isBrowser$3))try{let dt=new URL(window.location.href),mt=nt.startsWith("//")?new URL(dt.protocol+nt):new URL(nt),pt=stripBasename(mt.pathname,ot);mt.origin===dt.origin&&pt!=null?nt=pt+mt.search+mt.hash:ct=!0}catch{}let ft=useHref(nt,{relative:j}),ut=useLinkClickHandler(nt,{replace:et,state:tt,target:rt,preventScrollReset:it,relative:j,viewTransition:st});function ht(dt){$&&$(dt),dt.defaultPrevented||ut(dt)}return reactExports.createElement("a",_extends$v({},at,{href:lt||ft,onClick:ct||_e?$:ht,ref:_,target:rt}))}),NavLink=reactExports.forwardRef(function(i,_){let{"aria-current":$="page",caseSensitive:j=!1,className:_e="",end:et=!1,style:tt,to:rt,viewTransition:nt,children:it}=i,st=_objectWithoutPropertiesLoose$k(i,_excluded2$7),at=useResolvedPath(rt,{relative:st.relative}),ot=useLocation(),lt=reactExports.useContext(DataRouterStateContext),{navigator:ct,basename:ft}=reactExports.useContext(NavigationContext),ut=lt!=null&&useViewTransitionState(at)&&nt===!0,ht=ct.encodeLocation?ct.encodeLocation(at).pathname:at.pathname,dt=ot.pathname,mt=lt&&lt.navigation&&lt.navigation.location?lt.navigation.location.pathname:null;j||(dt=dt.toLowerCase(),mt=mt?mt.toLowerCase():null,ht=ht.toLowerCase()),mt&&ft&&(mt=stripBasename(mt,ft)||mt);const pt=ht!=="/"&&ht.endsWith("/")?ht.length-1:ht.length;let yt=dt===ht||!et&&dt.startsWith(ht)&&dt.charAt(pt)==="/",gt=mt!=null&&(mt===ht||!et&&mt.startsWith(ht)&&mt.charAt(ht.length)==="/"),vt={isActive:yt,isPending:gt,isTransitioning:ut},St=yt?$:void 0,At;typeof _e=="function"?At=_e(vt):At=[_e,yt?"active":null,gt?"pending":null,ut?"transitioning":null].filter(Boolean).join(" ");let xt=typeof tt=="function"?tt(vt):tt;return reactExports.createElement(Link,_extends$v({},st,{"aria-current":St,className:At,ref:_,style:xt,to:rt,viewTransition:nt}),typeof it=="function"?it(vt):it)});var DataRouterHook;(function(o){o.UseScrollRestoration="useScrollRestoration",o.UseSubmit="useSubmit",o.UseSubmitFetcher="useSubmitFetcher",o.UseFetcher="useFetcher",o.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(o){o.UseFetcher="useFetcher",o.UseFetchers="useFetchers",o.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useDataRouterContext(o){let i=reactExports.useContext(DataRouterContext);return i||invariant$2(!1),i}function useLinkClickHandler(o,i){let{target:_,replace:$,state:j,preventScrollReset:_e,relative:et,viewTransition:tt}=i===void 0?{}:i,rt=useNavigate(),nt=useLocation(),it=useResolvedPath(o,{relative:et});return reactExports.useCallback(st=>{if(shouldProcessLinkClick(st,_)){st.preventDefault();let at=$!==void 0?$:createPath(nt)===createPath(it);rt(o,{replace:at,state:j,preventScrollReset:_e,relative:et,viewTransition:tt})}},[nt,rt,it,$,j,_,o,_e,et,tt])}function useViewTransitionState(o,i){i===void 0&&(i={});let _=reactExports.useContext(ViewTransitionContext);_==null&&invariant$2(!1);let{basename:$}=useDataRouterContext(DataRouterHook.useViewTransitionState),j=useResolvedPath(o,{relative:i.relative});if(!_.isTransitioning)return!1;let _e=stripBasename(_.currentLocation.pathname,$)||_.currentLocation.pathname,et=stripBasename(_.nextLocation.pathname,$)||_.nextLocation.pathname;return matchPath(j.pathname,et)!=null||matchPath(j.pathname,_e)!=null}const __vite_import_meta_env__$2={},createStoreImpl=o=>{let i;const _=new Set,$=(it,st)=>{const at=typeof it=="function"?it(i):it;if(!Object.is(at,i)){const ot=i;i=st??(typeof at!="object"||at===null)?at:Object.assign({},i,at),_.forEach(lt=>lt(i,ot))}},j=()=>i,rt={setState:$,getState:j,getInitialState:()=>nt,subscribe:it=>(_.add(it),()=>_.delete(it)),destroy:()=>{(__vite_import_meta_env__$2?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),_.clear()}},nt=i=o($,j,rt);return rt},createStore=o=>o?createStoreImpl(o):createStoreImpl;var withSelector={exports:{}},withSelector_production={},shim$2={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React$1=reactExports;function is$1(o,i){return o===i&&(o!==0||1/o===1/i)||o!==o&&i!==i}var objectIs$1=typeof Object.is=="function"?Object.is:is$1,useState=React$1.useState,useEffect$1=React$1.useEffect,useLayoutEffect=React$1.useLayoutEffect,useDebugValue$2=React$1.useDebugValue;function useSyncExternalStore$2(o,i){var _=i(),$=useState({inst:{value:_,getSnapshot:i}}),j=$[0].inst,_e=$[1];return useLayoutEffect(function(){j.value=_,j.getSnapshot=i,checkIfSnapshotChanged(j)&&_e({inst:j})},[o,_,i]),useEffect$1(function(){return checkIfSnapshotChanged(j)&&_e({inst:j}),o(function(){checkIfSnapshotChanged(j)&&_e({inst:j})})},[o]),useDebugValue$2(_),_}function checkIfSnapshotChanged(o){var i=o.getSnapshot;o=o.value;try{var _=i();return!objectIs$1(o,_)}catch{return!0}}function useSyncExternalStore$1(o,i){return i()}var shim$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?useSyncExternalStore$1:useSyncExternalStore$2;useSyncExternalStoreShim_production.useSyncExternalStore=React$1.useSyncExternalStore!==void 0?React$1.useSyncExternalStore:shim$1;shim$2.exports=useSyncExternalStoreShim_production;var shimExports=shim$2.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var React=reactExports,shim=shimExports;function is(o,i){return o===i&&(o!==0||1/o===1/i)||o!==o&&i!==i}var objectIs=typeof Object.is=="function"?Object.is:is,useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue$1=React.useDebugValue;withSelector_production.useSyncExternalStoreWithSelector=function(o,i,_,$,j){var _e=useRef(null);if(_e.current===null){var et={hasValue:!1,value:null};_e.current=et}else et=_e.current;_e=useMemo(function(){function rt(ot){if(!nt){if(nt=!0,it=ot,ot=$(ot),j!==void 0&&et.hasValue){var lt=et.value;if(j(lt,ot))return st=lt}return st=ot}if(lt=st,objectIs(it,ot))return lt;var ct=$(ot);return j!==void 0&&j(lt,ct)?(it=ot,lt):(it=ot,st=ct)}var nt=!1,it,st,at=_===void 0?null:_;return[function(){return rt(i())},at===null?void 0:function(){return rt(at())}]},[i,_,$,j]);var tt=useSyncExternalStore(o,_e[0],_e[1]);return useEffect(function(){et.hasValue=!0,et.value=tt},[tt]),useDebugValue$1(tt),tt};withSelector.exports=withSelector_production;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs$1(withSelectorExports),__vite_import_meta_env__$1={},{useDebugValue}=React$2,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;let didWarnAboutEqualityFn=!1;const identity$c=o=>o;function useStore(o,i=identity$c,_){(__vite_import_meta_env__$1?"production":void 0)!=="production"&&_&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const $=useSyncExternalStoreWithSelector(o.subscribe,o.getState,o.getServerState||o.getInitialState,i,_);return useDebugValue($),$}const createImpl=o=>{(__vite_import_meta_env__$1?"production":void 0)!=="production"&&typeof o!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const i=typeof o=="function"?createStore(o):o,_=($,j)=>useStore(i,$,j);return Object.assign(_,i),_},create=o=>createImpl,__vite_import_meta_env__={};function createJSONStorage(o,i){let _;try{_=o()}catch{return}return{getItem:j=>{var _e;const et=rt=>rt===null?null:JSON.parse(rt,void 0),tt=(_e=_.getItem(j))!=null?_e:null;return tt instanceof Promise?tt.then(et):et(tt)},setItem:(j,_e)=>_.setItem(j,JSON.stringify(_e,void 0)),removeItem:j=>_.removeItem(j)}}const toThenable=o=>i=>{try{const _=o(i);return _ instanceof Promise?_:{then($){return toThenable($)(_)},catch($){return this}}}catch(_){return{then($){return this},catch($){return toThenable($)(_)}}}},oldImpl=(o,i)=>(_,$,j)=>{let _e={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:ft=>ft,version:0,merge:(ft,ut)=>({...ut,...ft}),...i},et=!1;const tt=new Set,rt=new Set;let nt;try{nt=_e.getStorage()}catch{}if(!nt)return o((...ft)=>{console.warn(`[zustand persist middleware] Unable to update item '${_e.name}', the given storage is currently unavailable.`),_(...ft)},$,j);const it=toThenable(_e.serialize),st=()=>{const ft=_e.partialize({...$()});let ut;const ht=it({state:ft,version:_e.version}).then(dt=>nt.setItem(_e.name,dt)).catch(dt=>{ut=dt});if(ut)throw ut;return ht},at=j.setState;j.setState=(ft,ut)=>{at(ft,ut),st()};const ot=o((...ft)=>{_(...ft),st()},$,j);let lt;const ct=()=>{var ft;if(!nt)return;et=!1,tt.forEach(ht=>ht($()));const ut=((ft=_e.onRehydrateStorage)==null?void 0:ft.call(_e,$()))||void 0;return toThenable(nt.getItem.bind(nt))(_e.name).then(ht=>{if(ht)return _e.deserialize(ht)}).then(ht=>{if(ht)if(typeof ht.version=="number"&&ht.version!==_e.version){if(_e.migrate)return _e.migrate(ht.state,ht.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return ht.state}).then(ht=>{var dt;return lt=_e.merge(ht,(dt=$())!=null?dt:ot),_(lt,!0),st()}).then(()=>{ut==null||ut(lt,void 0),et=!0,rt.forEach(ht=>ht(lt))}).catch(ht=>{ut==null||ut(void 0,ht)})};return j.persist={setOptions:ft=>{_e={..._e,...ft},ft.getStorage&&(nt=ft.getStorage())},clearStorage:()=>{nt==null||nt.removeItem(_e.name)},getOptions:()=>_e,rehydrate:()=>ct(),hasHydrated:()=>et,onHydrate:ft=>(tt.add(ft),()=>{tt.delete(ft)}),onFinishHydration:ft=>(rt.add(ft),()=>{rt.delete(ft)})},ct(),lt||ot},newImpl=(o,i)=>(_,$,j)=>{let _e={storage:createJSONStorage(()=>localStorage),partialize:ct=>ct,version:0,merge:(ct,ft)=>({...ft,...ct}),...i},et=!1;const tt=new Set,rt=new Set;let nt=_e.storage;if(!nt)return o((...ct)=>{console.warn(`[zustand persist middleware] Unable to update item '${_e.name}', the given storage is currently unavailable.`),_(...ct)},$,j);const it=()=>{const ct=_e.partialize({...$()});return nt.setItem(_e.name,{state:ct,version:_e.version})},st=j.setState;j.setState=(ct,ft)=>{st(ct,ft),it()};const at=o((...ct)=>{_(...ct),it()},$,j);j.getInitialState=()=>at;let ot;const lt=()=>{var ct,ft;if(!nt)return;et=!1,tt.forEach(ht=>{var dt;return ht((dt=$())!=null?dt:at)});const ut=((ft=_e.onRehydrateStorage)==null?void 0:ft.call(_e,(ct=$())!=null?ct:at))||void 0;return toThenable(nt.getItem.bind(nt))(_e.name).then(ht=>{if(ht)if(typeof ht.version=="number"&&ht.version!==_e.version){if(_e.migrate)return[!0,_e.migrate(ht.state,ht.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,ht.state];return[!1,void 0]}).then(ht=>{var dt;const[mt,pt]=ht;if(ot=_e.merge(pt,(dt=$())!=null?dt:at),_(ot,!0),mt)return it()}).then(()=>{ut==null||ut(ot,void 0),ot=$(),et=!0,rt.forEach(ht=>ht(ot))}).catch(ht=>{ut==null||ut(void 0,ht)})};return j.persist={setOptions:ct=>{_e={..._e,...ct},ct.storage&&(nt=ct.storage)},clearStorage:()=>{nt==null||nt.removeItem(_e.name)},getOptions:()=>_e,rehydrate:()=>lt(),hasHydrated:()=>et,onHydrate:ct=>(tt.add(ct),()=>{tt.delete(ct)}),onFinishHydration:ct=>(rt.add(ct),()=>{rt.delete(ct)})},_e.skipHydration||lt(),ot||at},persistImpl=(o,i)=>"getStorage"in i||"serialize"in i||"deserialize"in i?((__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(o,i)):newImpl(o,i),persist=persistImpl,useSettingsStore=create()(persist(o=>({theme:"light",language:"ar",disableMotion:!1,studyMode:!1,setTheme:i=>o({theme:i}),setLanguage:i=>o({language:i}),setDisableMotion:i=>o({disableMotion:i}),toggleStudyMode:()=>o(i=>({studyMode:!i.studyMode}))}),{name:"settings-store"})),LayoutGroupContext=reactExports.createContext({});function useConstant(o){const i=reactExports.useRef(null);return i.current===null&&(i.current=o()),i.current}const PresenceContext=reactExports.createContext(null),MotionConfigContext=reactExports.createContext({transformPagePoint:o=>o,isStatic:!1,reducedMotion:"never"});class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(i){const _=this.props.childRef.current;if(_&&i.isPresent&&!this.props.isPresent){const $=this.props.sizeRef.current;$.height=_.offsetHeight||0,$.width=_.offsetWidth||0,$.top=_.offsetTop,$.left=_.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:o,isPresent:i}){const _=reactExports.useId(),$=reactExports.useRef(null),j=reactExports.useRef({width:0,height:0,top:0,left:0}),{nonce:_e}=reactExports.useContext(MotionConfigContext);return reactExports.useInsertionEffect(()=>{const{width:et,height:tt,top:rt,left:nt}=j.current;if(i||!$.current||!et||!tt)return;$.current.dataset.motionPopId=_;const it=document.createElement("style");return _e&&(it.nonce=_e),document.head.appendChild(it),it.sheet&&it.sheet.insertRule(`
          [data-motion-pop-id="${_}"] {
            position: absolute !important;
            width: ${et}px !important;
            height: ${tt}px !important;
            top: ${rt}px !important;
            left: ${nt}px !important;
          }
        `),()=>{document.head.removeChild(it)}},[i]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:i,childRef:$,sizeRef:j,children:reactExports.cloneElement(o,{ref:$})})}const PresenceChild=({children:o,initial:i,isPresent:_,onExitComplete:$,custom:j,presenceAffectsLayout:_e,mode:et})=>{const tt=useConstant(newChildrenMap),rt=reactExports.useId(),nt=reactExports.useCallback(st=>{tt.set(st,!0);for(const at of tt.values())if(!at)return;$&&$()},[tt,$]),it=reactExports.useMemo(()=>({id:rt,initial:i,isPresent:_,custom:j,onExitComplete:nt,register:st=>(tt.set(st,!1),()=>tt.delete(st))}),_e?[Math.random(),nt]:[_,nt]);return reactExports.useMemo(()=>{tt.forEach((st,at)=>tt.set(at,!1))},[_]),reactExports.useEffect(()=>{!_&&!tt.size&&$&&$()},[_]),et==="popLayout"&&(o=jsxRuntimeExports.jsx(PopChild,{isPresent:_,children:o})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:it,children:o})};function newChildrenMap(){return new Map}function usePresence(o=!0){const i=reactExports.useContext(PresenceContext);if(i===null)return[!0,null];const{isPresent:_,onExitComplete:$,register:j}=i,_e=reactExports.useId();reactExports.useEffect(()=>{o&&j(_e)},[o]);const et=reactExports.useCallback(()=>o&&$&&$(_e),[_e,$,o]);return!_&&$?[!1,et]:[!0]}const getChildKey=o=>o.key||"";function onlyElements(o){const i=[];return reactExports.Children.forEach(o,_=>{reactExports.isValidElement(_)&&i.push(_)}),i}const isBrowser$2=typeof window<"u",useIsomorphicLayoutEffect=isBrowser$2?reactExports.useLayoutEffect:reactExports.useEffect,AnimatePresence=({children:o,custom:i,initial:_=!0,onExitComplete:$,presenceAffectsLayout:j=!0,mode:_e="sync",propagate:et=!1})=>{const[tt,rt]=usePresence(et),nt=reactExports.useMemo(()=>onlyElements(o),[o]),it=et&&!tt?[]:nt.map(getChildKey),st=reactExports.useRef(!0),at=reactExports.useRef(nt),ot=useConstant(()=>new Map),[lt,ct]=reactExports.useState(nt),[ft,ut]=reactExports.useState(nt);useIsomorphicLayoutEffect(()=>{st.current=!1,at.current=nt;for(let mt=0;mt<ft.length;mt++){const pt=getChildKey(ft[mt]);it.includes(pt)?ot.delete(pt):ot.get(pt)!==!0&&ot.set(pt,!1)}},[ft,it.length,it.join("-")]);const ht=[];if(nt!==lt){let mt=[...nt];for(let pt=0;pt<ft.length;pt++){const yt=ft[pt],gt=getChildKey(yt);it.includes(gt)||(mt.splice(pt,0,yt),ht.push(yt))}_e==="wait"&&ht.length&&(mt=ht),ut(onlyElements(mt)),ct(nt);return}const{forceRender:dt}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ft.map(mt=>{const pt=getChildKey(mt),yt=et&&!tt?!1:nt===ft||it.includes(pt),gt=()=>{if(ot.has(pt))ot.set(pt,!0);else return;let vt=!0;ot.forEach(St=>{St||(vt=!1)}),vt&&(dt==null||dt(),ut(at.current),et&&(rt==null||rt()),$&&$())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:yt,initial:!st.current||_?void 0:!1,custom:yt?void 0:i,presenceAffectsLayout:j,mode:_e,onExitComplete:yt?void 0:gt,children:mt},pt)})})},noop$7=o=>o;let invariant$1=noop$7;function memo(o){let i;return()=>(i===void 0&&(i=o()),i)}const progress$2=(o,i,_)=>{const $=i-o;return $===0?1:(_-o)/$},secondsToMilliseconds=o=>o*1e3,millisecondsToSeconds=o=>o/1e3,MotionGlobalConfig={useManualTiming:!1};function createRenderStep(o){let i=new Set,_=new Set,$=!1,j=!1;const _e=new WeakSet;let et={delta:0,timestamp:0,isProcessing:!1};function tt(nt){_e.has(nt)&&(rt.schedule(nt),o()),nt(et)}const rt={schedule:(nt,it=!1,st=!1)=>{const ot=st&&$?i:_;return it&&_e.add(nt),ot.has(nt)||ot.add(nt),nt},cancel:nt=>{_.delete(nt),_e.delete(nt)},process:nt=>{if(et=nt,$){j=!0;return}$=!0,[i,_]=[_,i],i.forEach(tt),i.clear(),$=!1,j&&(j=!1,rt.process(nt))}};return rt}const stepsOrder=["read","resolveKeyframes","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(o,i){let _=!1,$=!0;const j={delta:0,timestamp:0,isProcessing:!1},_e=()=>_=!0,et=stepsOrder.reduce((ut,ht)=>(ut[ht]=createRenderStep(_e),ut),{}),{read:tt,resolveKeyframes:rt,update:nt,preRender:it,render:st,postRender:at}=et,ot=()=>{const ut=performance.now();_=!1,j.delta=$?1e3/60:Math.max(Math.min(ut-j.timestamp,maxElapsed),1),j.timestamp=ut,j.isProcessing=!0,tt.process(j),rt.process(j),nt.process(j),it.process(j),st.process(j),at.process(j),j.isProcessing=!1,_&&i&&($=!1,o(ot))},lt=()=>{_=!0,$=!0,j.isProcessing||o(ot)};return{schedule:stepsOrder.reduce((ut,ht)=>{const dt=et[ht];return ut[ht]=(mt,pt=!1,yt=!1)=>(_||lt(),dt.schedule(mt,pt,yt)),ut},{}),cancel:ut=>{for(let ht=0;ht<stepsOrder.length;ht++)et[stepsOrder[ht]].cancel(ut)},state:j,steps:et}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$7,!0),LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const o in featureProps)featureDefinitions[o]={isEnabled:i=>featureProps[o].some(_=>!!i[_])};function loadFeatures(o){for(const i in o)featureDefinitions[i]={...featureDefinitions[i],...o[i]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(o){return o.startsWith("while")||o.startsWith("drag")&&o!=="draggable"||o.startsWith("layout")||o.startsWith("onTap")||o.startsWith("onPan")||o.startsWith("onLayout")||validMotionProps.has(o)}let shouldForward=o=>!isValidMotionProp(o);function loadExternalIsValidProp(o){o&&(shouldForward=i=>i.startsWith("on")?!isValidMotionProp(i):o(i))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps$1(o,i,_){const $={};for(const j in o)j==="values"&&typeof o.values=="object"||(shouldForward(j)||_===!0&&isValidMotionProp(j)||!i&&!isValidMotionProp(j)||o.draggable&&j.startsWith("onDrag"))&&($[j]=o[j]);return $}function createDOMMotionComponentProxy(o){if(typeof Proxy>"u")return o;const i=new Map,_=(...$)=>o(...$);return new Proxy(_,{get:($,j)=>j==="create"?o:(i.has(j)||i.set(j,o(j)),i.get(j))})}const MotionContext=reactExports.createContext({});function isVariantLabel(o){return typeof o=="string"||Array.isArray(o)}function isAnimationControls(o){return o!==null&&typeof o=="object"&&typeof o.start=="function"}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(o){return isAnimationControls(o.animate)||variantProps.some(i=>isVariantLabel(o[i]))}function isVariantNode(o){return!!(isControllingVariants(o)||o.variants)}function getCurrentTreeVariants(o,i){if(isControllingVariants(o)){const{initial:_,animate:$}=o;return{initial:_===!1||isVariantLabel(_)?_:void 0,animate:isVariantLabel($)?$:void 0}}return o.inherit!==!1?i:{}}function useCreateMotionContext(o){const{initial:i,animate:_}=getCurrentTreeVariants(o,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:i,animate:_}),[variantLabelsAsDependency(i),variantLabelsAsDependency(_)])}function variantLabelsAsDependency(o){return Array.isArray(o)?o.join(" "):o}const motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(o){return o&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,"current")}function useMotionRef(o,i,_){return reactExports.useCallback($=>{$&&o.onMount&&o.onMount($),i&&($?i.mount($):i.unmount()),_&&(typeof _=="function"?_($):isRefObject(_)&&(_.current=$))},[i])}const camelToDash=o=>o.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(o,i,_,$,j){var _e,et;const{visualElement:tt}=reactExports.useContext(MotionContext),rt=reactExports.useContext(LazyContext),nt=reactExports.useContext(PresenceContext),it=reactExports.useContext(MotionConfigContext).reducedMotion,st=reactExports.useRef(null);$=$||rt.renderer,!st.current&&$&&(st.current=$(o,{visualState:i,parent:tt,props:_,presenceContext:nt,blockInitialAnimation:nt?nt.initial===!1:!1,reducedMotionConfig:it}));const at=st.current,ot=reactExports.useContext(SwitchLayoutGroupContext);at&&!at.projection&&j&&(at.type==="html"||at.type==="svg")&&createProjectionNode$1(st.current,_,j,ot);const lt=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{at&&lt.current&&at.update(_,nt)});const ct=_[optimizedAppearDataAttribute],ft=reactExports.useRef(!!ct&&!(!((_e=window.MotionHandoffIsComplete)===null||_e===void 0)&&_e.call(window,ct))&&((et=window.MotionHasOptimisedAnimation)===null||et===void 0?void 0:et.call(window,ct)));return useIsomorphicLayoutEffect(()=>{at&&(lt.current=!0,window.MotionIsMounted=!0,at.updateFeatures(),microtask.render(at.render),ft.current&&at.animationState&&at.animationState.animateChanges())}),reactExports.useEffect(()=>{at&&(!ft.current&&at.animationState&&at.animationState.animateChanges(),ft.current&&(queueMicrotask(()=>{var ut;(ut=window.MotionHandoffMarkAsComplete)===null||ut===void 0||ut.call(window,ct)}),ft.current=!1))}),at}function createProjectionNode$1(o,i,_,$){const{layoutId:j,layout:_e,drag:et,dragConstraints:tt,layoutScroll:rt,layoutRoot:nt}=i;o.projection=new _(o.latestValues,i["data-framer-portal-id"]?void 0:getClosestProjectingNode(o.parent)),o.projection.setOptions({layoutId:j,layout:_e,alwaysMeasureLayout:!!et||tt&&isRefObject(tt),visualElement:o,animationType:typeof _e=="string"?_e:"both",initialPromotionConfig:$,layoutScroll:rt,layoutRoot:nt})}function getClosestProjectingNode(o){if(o)return o.options.allowProjection!==!1?o.projection:getClosestProjectingNode(o.parent)}function createRendererMotionComponent({preloadedFeatures:o,createVisualElement:i,useRender:_,useVisualState:$,Component:j}){var _e,et;o&&loadFeatures(o);function tt(nt,it){let st;const at={...reactExports.useContext(MotionConfigContext),...nt,layoutId:useLayoutId(nt)},{isStatic:ot}=at,lt=useCreateMotionContext(nt),ct=$(nt,ot);if(!ot&&isBrowser$2){useStrictMode();const ft=getProjectionFunctionality(at);st=ft.MeasureLayout,lt.visualElement=useVisualElement(j,ct,at,i,ft.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:lt,children:[st&&lt.visualElement?jsxRuntimeExports.jsx(st,{visualElement:lt.visualElement,...at}):null,_(j,nt,useMotionRef(ct,lt.visualElement,it),ct,ot,lt.visualElement)]})}tt.displayName=`motion.${typeof j=="string"?j:`create(${(et=(_e=j.displayName)!==null&&_e!==void 0?_e:j.name)!==null&&et!==void 0?et:""})`}`;const rt=reactExports.forwardRef(tt);return rt[motionComponentSymbol]=j,rt}function useLayoutId({layoutId:o}){const i=reactExports.useContext(LayoutGroupContext).id;return i&&o!==void 0?i+"-"+o:o}function useStrictMode(o,i){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(o){const{drag:i,layout:_}=featureDefinitions;if(!i&&!_)return{};const $={...i,..._};return{MeasureLayout:i!=null&&i.isEnabled(o)||_!=null&&_.isEnabled(o)?$.MeasureLayout:void 0,ProjectionNode:$.ProjectionNode}}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(o){return typeof o!="string"||o.includes("-")?!1:!!(lowercaseSVGElements.indexOf(o)>-1||/[A-Z]/u.test(o))}function getValueState(o){const i=[{},{}];return o==null||o.values.forEach((_,$)=>{i[0][$]=_.get(),i[1][$]=_.getVelocity()}),i}function resolveVariantFromProps(o,i,_,$){if(typeof i=="function"){const[j,_e]=getValueState($);i=i(_!==void 0?_:o.custom,j,_e)}if(typeof i=="string"&&(i=o.variants&&o.variants[i]),typeof i=="function"){const[j,_e]=getValueState($);i=i(_!==void 0?_:o.custom,j,_e)}return i}const isKeyframesTarget=o=>Array.isArray(o),isCustomValue=o=>!!(o&&typeof o=="object"&&o.mix&&o.toValue),resolveFinalValueInKeyframes=o=>isKeyframesTarget(o)?o[o.length-1]||0:o,isMotionValue=o=>!!(o&&o.getVelocity);function resolveMotionValue(o){const i=isMotionValue(o)?o.get():o;return isCustomValue(i)?i.toValue():i}function makeState({scrapeMotionValuesFromProps:o,createRenderState:i,onUpdate:_},$,j,_e){const et={latestValues:makeLatestValues($,j,_e,o),renderState:i()};return _&&(et.onMount=tt=>_({props:$,current:tt,...et}),et.onUpdate=tt=>_(tt)),et}const makeUseVisualState=o=>(i,_)=>{const $=reactExports.useContext(MotionContext),j=reactExports.useContext(PresenceContext),_e=()=>makeState(o,i,$,j);return _?_e():useConstant(_e)};function makeLatestValues(o,i,_,$){const j={},_e=$(o,{});for(const at in _e)j[at]=resolveMotionValue(_e[at]);let{initial:et,animate:tt}=o;const rt=isControllingVariants(o),nt=isVariantNode(o);i&&nt&&!rt&&o.inherit!==!1&&(et===void 0&&(et=i.initial),tt===void 0&&(tt=i.animate));let it=_?_.initial===!1:!1;it=it||et===!1;const st=it?tt:et;if(st&&typeof st!="boolean"&&!isAnimationControls(st)){const at=Array.isArray(st)?st:[st];for(let ot=0;ot<at.length;ot++){const lt=resolveVariantFromProps(o,at[ot]);if(lt){const{transitionEnd:ct,transition:ft,...ut}=lt;for(const ht in ut){let dt=ut[ht];if(Array.isArray(dt)){const mt=it?dt.length-1:0;dt=dt[mt]}dt!==null&&(j[ht]=dt)}for(const ht in ct)j[ht]=ct[ht]}}}return j}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),checkStringStartsWith=o=>i=>typeof i=="string"&&i.startsWith(o),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=o=>startsAsVariableToken(o)?singleCssVariableRegex.test(o.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,getValueAsType=(o,i)=>i&&typeof o=="number"?i.transform(o):o,clamp=(o,i,_)=>_>i?i:_<o?o:_,number$3={test:o=>typeof o=="number",parse:parseFloat,transform:o=>o},alpha$1={...number$3,transform:o=>clamp(0,1,o)},scale={...number$3,default:1},createUnitType=o=>({test:i=>typeof i=="string"&&i.endsWith(o)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${o}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:o=>percent.parse(o)/100,transform:o=>percent.transform(o*100)},browserNumberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha$1,originX:progressPercentage,originY:progressPercentage,originZ:px},int={...number$3,transform:Math.round},numberValueTypes={...browserNumberValueTypes,...transformValueTypes,zIndex:int,size:px,fillOpacity:alpha$1,strokeOpacity:alpha$1,numOctaves:int},translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(o,i,_){let $="",j=!0;for(let _e=0;_e<numTransforms;_e++){const et=transformPropOrder[_e],tt=o[et];if(tt===void 0)continue;let rt=!0;if(typeof tt=="number"?rt=tt===(et.startsWith("scale")?1:0):rt=parseFloat(tt)===0,!rt||_){const nt=getValueAsType(tt,numberValueTypes[et]);if(!rt){j=!1;const it=translateAlias[et]||et;$+=`${it}(${nt}) `}_&&(i[et]=nt)}}return $=$.trim(),_?$=_(i,j?"":$):j&&($="none"),$}function buildHTMLStyles(o,i,_){const{style:$,vars:j,transformOrigin:_e}=o;let et=!1,tt=!1;for(const rt in i){const nt=i[rt];if(transformProps.has(rt)){et=!0;continue}else if(isCSSVariableName(rt)){j[rt]=nt;continue}else{const it=getValueAsType(nt,numberValueTypes[rt]);rt.startsWith("origin")?(tt=!0,_e[rt]=it):$[rt]=it}}if(i.transform||(et||_?$.transform=buildTransform(i,o.transform,_):$.transform&&($.transform="none")),tt){const{originX:rt="50%",originY:nt="50%",originZ:it=0}=_e;$.transformOrigin=`${rt} ${nt} ${it}`}}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(o,i,_=1,$=0,j=!0){o.pathLength=1;const _e=j?dashKeys:camelKeys;o[_e.offset]=px.transform(-$);const et=px.transform(i),tt=px.transform(_);o[_e.array]=`${et} ${tt}`}function calcOrigin$1(o,i,_){return typeof o=="string"?o:px.transform(i+_*o)}function calcSVGTransformOrigin(o,i,_){const $=calcOrigin$1(i,o.x,o.width),j=calcOrigin$1(_,o.y,o.height);return`${$} ${j}`}function buildSVGAttrs(o,{attrX:i,attrY:_,attrScale:$,originX:j,originY:_e,pathLength:et,pathSpacing:tt=1,pathOffset:rt=0,...nt},it,st){if(buildHTMLStyles(o,nt,st),it){o.style.viewBox&&(o.attrs.viewBox=o.style.viewBox);return}o.attrs=o.style,o.style={};const{attrs:at,style:ot,dimensions:lt}=o;at.transform&&(lt&&(ot.transform=at.transform),delete at.transform),lt&&(j!==void 0||_e!==void 0||ot.transform)&&(ot.transformOrigin=calcSVGTransformOrigin(lt,j!==void 0?j:.5,_e!==void 0?_e:.5)),i!==void 0&&(at.x=i),_!==void 0&&(at.y=_),$!==void 0&&(at.scale=$),et!==void 0&&buildSVGPath(at,et,tt,rt,!1)}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=o=>typeof o=="string"&&o.toLowerCase()==="svg";function renderHTML(o,{style:i,vars:_},$,j){Object.assign(o.style,i,j&&j.getProjectionStyles($));for(const _e in _)o.style.setProperty(_e,_[_e])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(o,i,_,$){renderHTML(o,i,void 0,$);for(const j in i.attrs)o.setAttribute(camelCaseAttributes.has(j)?j:camelToDash(j),i.attrs[j])}const scaleCorrectors={};function addScaleCorrector(o){Object.assign(scaleCorrectors,o)}function isForcedMotionValue(o,{layout:i,layoutId:_}){return transformProps.has(o)||o.startsWith("origin")||(i||_!==void 0)&&(!!scaleCorrectors[o]||o==="opacity")}function scrapeMotionValuesFromProps$1(o,i,_){var $;const{style:j}=o,_e={};for(const et in j)(isMotionValue(j[et])||i.style&&isMotionValue(i.style[et])||isForcedMotionValue(et,o)||(($=_==null?void 0:_.getValue(et))===null||$===void 0?void 0:$.liveStyle)!==void 0)&&(_e[et]=j[et]);return _e}function scrapeMotionValuesFromProps(o,i,_){const $=scrapeMotionValuesFromProps$1(o,i,_);for(const j in o)if(isMotionValue(o[j])||isMotionValue(i[j])){const _e=transformPropOrder.indexOf(j)!==-1?"attr"+j.charAt(0).toUpperCase()+j.substring(1):j;$[_e]=o[j]}return $}function updateSVGDimensions(o,i){try{i.dimensions=typeof o.getBBox=="function"?o.getBBox():o.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}}const layoutProps=["x","y","width","height","cx","cy","r"],svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onUpdate:({props:o,prevProps:i,current:_,renderState:$,latestValues:j})=>{if(!_)return;let _e=!!o.drag;if(!_e){for(const tt in j)if(transformProps.has(tt)){_e=!0;break}}if(!_e)return;let et=!i;if(i)for(let tt=0;tt<layoutProps.length;tt++){const rt=layoutProps[tt];o[rt]!==i[rt]&&(et=!0)}et&&frame.read(()=>{updateSVGDimensions(_,$),frame.render(()=>{buildSVGAttrs($,j,isSVGTag(_.tagName),o.transformTemplate),renderSVG(_,$)})})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function copyRawValuesOnly(o,i,_){for(const $ in i)!isMotionValue(i[$])&&!isForcedMotionValue($,_)&&(o[$]=i[$])}function useInitialMotionValues({transformTemplate:o},i){return reactExports.useMemo(()=>{const _=createHtmlRenderState();return buildHTMLStyles(_,i,o),Object.assign({},_.vars,_.style)},[i])}function useStyle(o,i){const _=o.style||{},$={};return copyRawValuesOnly($,_,o),Object.assign($,useInitialMotionValues(o,i)),$}function useHTMLProps(o,i){const _={},$=useStyle(o,i);return o.drag&&o.dragListener!==!1&&(_.draggable=!1,$.userSelect=$.WebkitUserSelect=$.WebkitTouchCallout="none",$.touchAction=o.drag===!0?"none":`pan-${o.drag==="x"?"y":"x"}`),o.tabIndex===void 0&&(o.onTap||o.onTapStart||o.whileTap)&&(_.tabIndex=0),_.style=$,_}function useSVGProps(o,i,_,$){const j=reactExports.useMemo(()=>{const _e=createSvgRenderState();return buildSVGAttrs(_e,i,isSVGTag($),o.transformTemplate),{..._e.attrs,style:{..._e.style}}},[i]);if(o.style){const _e={};copyRawValuesOnly(_e,o.style,o),j.style={..._e,...j.style}}return j}function createUseRender(o=!1){return(_,$,j,{latestValues:_e},et)=>{const rt=(isSVGComponent(_)?useSVGProps:useHTMLProps)($,_e,et,_),nt=filterProps$1($,typeof _=="string",o),it=_!==reactExports.Fragment?{...nt,...rt,ref:j}:{},{children:st}=$,at=reactExports.useMemo(()=>isMotionValue(st)?st.get():st,[st]);return reactExports.createElement(_,{...it,children:at})}}function createMotionComponentFactory(o,i){return function($,{forwardMotionProps:j}={forwardMotionProps:!1}){const et={...isSVGComponent($)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:o,useRender:createUseRender(j),createVisualElement:i,Component:$};return createRendererMotionComponent(et)}}function shallowCompare(o,i){if(!Array.isArray(i))return!1;const _=i.length;if(_!==o.length)return!1;for(let $=0;$<_;$++)if(i[$]!==o[$])return!1;return!0}function resolveVariant(o,i,_){const $=o.getProps();return resolveVariantFromProps($,i,_!==void 0?_:$.custom,o)}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0);class BaseGroupPlaybackControls{constructor(i){this.stop=()=>this.runAll("stop"),this.animations=i.filter(Boolean)}get finished(){return Promise.all(this.animations.map(i=>"finished"in i?i.finished:i))}getAll(i){return this.animations[0][i]}setAll(i,_){for(let $=0;$<this.animations.length;$++)this.animations[$][i]=_}attachTimeline(i,_){const $=this.animations.map(j=>{if(supportsScrollTimeline()&&j.attachTimeline)return j.attachTimeline(i);if(typeof _=="function")return _(j)});return()=>{$.forEach((j,_e)=>{j&&j(),this.animations[_e].stop()})}}get time(){return this.getAll("time")}set time(i){this.setAll("time",i)}get speed(){return this.getAll("speed")}set speed(i){this.setAll("speed",i)}get startTime(){return this.getAll("startTime")}get duration(){let i=0;for(let _=0;_<this.animations.length;_++)i=Math.max(i,this.animations[_].duration);return i}runAll(i){this.animations.forEach(_=>_[i]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class GroupPlaybackControls extends BaseGroupPlaybackControls{then(i,_){return Promise.all(this.animations).then(i).catch(_)}}function getValueTransition(o,i){return o?o[i]||o.default||o:void 0}const maxGeneratorDuration=2e4;function calcGeneratorDuration(o){let i=0;const _=50;let $=o.next(i);for(;!$.done&&i<maxGeneratorDuration;)i+=_,$=o.next(i);return i>=maxGeneratorDuration?1/0:i}function isGenerator(o){return typeof o=="function"}function attachTimeline(o,i){o.timeline=i,o.onfinish=null}const isBezierDefinition=o=>Array.isArray(o)&&typeof o[0]=="number",supportsFlags={linearEasing:void 0};function memoSupports(o,i){const _=memo(o);return()=>{var $;return($=supportsFlags[i])!==null&&$!==void 0?$:_()}}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),generateLinearEasing=(o,i,_=10)=>{let $="";const j=Math.max(Math.round(i/_),2);for(let _e=0;_e<j;_e++)$+=o(progress$2(0,j-1,_e))+", ";return`linear(${$.substring(0,$.length-2)})`};function isWaapiSupportedEasing(o){return!!(typeof o=="function"&&supportsLinearEasing()||!o||typeof o=="string"&&(o in supportedWaapiEasing||supportsLinearEasing())||isBezierDefinition(o)||Array.isArray(o)&&o.every(isWaapiSupportedEasing))}const cubicBezierAsString=([o,i,_,$])=>`cubic-bezier(${o}, ${i}, ${_}, ${$})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(o,i){if(o)return typeof o=="function"&&supportsLinearEasing()?generateLinearEasing(o,i):isBezierDefinition(o)?cubicBezierAsString(o):Array.isArray(o)?o.map(_=>mapEasingToNativeEasing(_,i)||supportedWaapiEasing.easeOut):supportedWaapiEasing[o]}const isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function resolveElements(o,i,_){var $;if(o instanceof Element)return[o];if(typeof o=="string"){let j=document;const _e=($=void 0)!==null&&$!==void 0?$:j.querySelectorAll(o);return _e?Array.from(_e):[]}return Array.from(o)}function setupGesture(o,i){const _=resolveElements(o),$=new AbortController,j={passive:!0,...i,signal:$.signal};return[_,j,()=>$.abort()]}function filterEvents$1(o){return i=>{i.pointerType==="touch"||isDragActive()||o(i)}}function hover(o,i,_={}){const[$,j,_e]=setupGesture(o,_),et=filterEvents$1(tt=>{const{target:rt}=tt,nt=i(tt);if(typeof nt!="function"||!rt)return;const it=filterEvents$1(st=>{nt(st),rt.removeEventListener("pointerleave",it)});rt.addEventListener("pointerleave",it,j)});return $.forEach(tt=>{tt.addEventListener("pointerenter",et,j)}),_e}const isNodeOrChild=(o,i)=>i?o===i?!0:isNodeOrChild(o,i.parentElement):!1,isPrimaryPointer=o=>o.pointerType==="mouse"?typeof o.button!="number"||o.button<=0:o.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(o){return focusableElements.has(o.tagName)||o.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(o){return i=>{i.key==="Enter"&&o(i)}}function firePointerEvent(o,i){o.dispatchEvent(new PointerEvent("pointer"+i,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(o,i)=>{const _=o.currentTarget;if(!_)return;const $=filterEvents(()=>{if(isPressing.has(_))return;firePointerEvent(_,"down");const j=filterEvents(()=>{firePointerEvent(_,"up")}),_e=()=>firePointerEvent(_,"cancel");_.addEventListener("keyup",j,i),_.addEventListener("blur",_e,i)});_.addEventListener("keydown",$,i),_.addEventListener("blur",()=>_.removeEventListener("keydown",$),i)};function isValidPressEvent(o){return isPrimaryPointer(o)&&!isDragActive()}function press(o,i,_={}){const[$,j,_e]=setupGesture(o,_),et=tt=>{const rt=tt.currentTarget;if(!isValidPressEvent(tt)||isPressing.has(rt))return;isPressing.add(rt);const nt=i(tt),it=(ot,lt)=>{window.removeEventListener("pointerup",st),window.removeEventListener("pointercancel",at),!(!isValidPressEvent(ot)||!isPressing.has(rt))&&(isPressing.delete(rt),typeof nt=="function"&&nt(ot,{success:lt}))},st=ot=>{it(ot,_.useGlobalTarget||isNodeOrChild(rt,ot.target))},at=ot=>{it(ot,!1)};window.addEventListener("pointerup",st,j),window.addEventListener("pointercancel",at,j)};return $.forEach(tt=>{!isElementKeyboardAccessible(tt)&&tt.getAttribute("tabindex")===null&&(tt.tabIndex=0),(_.useGlobalTarget?window:tt).addEventListener("pointerdown",et,j),tt.addEventListener("focus",nt=>enableKeyboardPress(nt,j),j)}),_e}function setDragLock(o){return o==="x"||o==="y"?isDragging[o]?null:(isDragging[o]=!0,()=>{isDragging[o]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]);let now$3;function clearTime(){now$3=void 0}const time$1={now:()=>(now$3===void 0&&time$1.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now$3),set:o=>{now$3=o,queueMicrotask(clearTime)}};function addUniqueItem(o,i){o.indexOf(i)===-1&&o.push(i)}function removeItem(o,i){const _=o.indexOf(i);_>-1&&o.splice(_,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(i){return addUniqueItem(this.subscriptions,i),()=>removeItem(this.subscriptions,i)}notify(i,_,$){const j=this.subscriptions.length;if(j)if(j===1)this.subscriptions[0](i,_,$);else for(let _e=0;_e<j;_e++){const et=this.subscriptions[_e];et&&et(i,_,$)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function velocityPerSecond(o,i){return i?o*(1e3/i):0}const MAX_VELOCITY_DELTA=30,isFloat=o=>!isNaN(parseFloat(o));class MotionValue{constructor(i,_={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=($,j=!0)=>{const _e=time$1.now();this.updatedAt!==_e&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent($),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),j&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(i),this.owner=_.owner}setCurrent(i){this.current=i,this.updatedAt=time$1.now(),this.canTrackVelocity===null&&i!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(i=this.current){this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt}onChange(i){return this.on("change",i)}on(i,_){this.events[i]||(this.events[i]=new SubscriptionManager);const $=this.events[i].add(_);return i==="change"?()=>{$(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:$}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,_){this.passiveEffect=i,this.stopPassiveEffect=_}set(i,_=!0){!_||!this.passiveEffect?this.updateAndNotify(i,_):this.passiveEffect(i,this.updateAndNotify)}setWithVelocity(i,_,$){this.set(_),this.prev=void 0,this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt-$}jump(i,_=!0){this.updateAndNotify(i),this.prev=i,this.prevUpdatedAt=this.prevFrameValue=void 0,_&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const i=time$1.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||i-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const _=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),_)}start(i){return this.stop(),new Promise(_=>{this.hasAnimated=!0,this.animation=i(_),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(o,i){return new MotionValue(o,i)}function setMotionValue(o,i,_){o.hasValue(i)?o.getValue(i).set(_):o.addValue(i,motionValue(_))}function setTarget(o,i){const _=resolveVariant(o,i);let{transitionEnd:$={},transition:j={},..._e}=_||{};_e={..._e,...$};for(const et in _e){const tt=resolveFinalValueInKeyframes(_e[et]);setMotionValue(o,et,tt)}}function isWillChangeMotionValue(o){return!!(isMotionValue(o)&&o.add)}function addValueToWillChange(o,i){const _=o.getValue("willChange");if(isWillChangeMotionValue(_))return _.add(i)}function getOptimisedAppearId(o){return o.props[optimizedAppearDataAttribute]}const calcBezier=(o,i,_)=>(((1-3*_+3*i)*o+(3*_-6*i))*o+3*i)*o,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(o,i,_,$,j){let _e,et,tt=0;do et=i+(_-i)/2,_e=calcBezier(et,$,j)-o,_e>0?_=et:i=et;while(Math.abs(_e)>subdivisionPrecision&&++tt<subdivisionMaxIterations);return et}function cubicBezier$1(o,i,_,$){if(o===i&&_===$)return noop$7;const j=_e=>binarySubdivide(_e,0,1,o,_);return _e=>_e===0||_e===1?_e:calcBezier(j(_e),i,$)}const mirrorEasing=o=>i=>i<=.5?o(2*i)/2:(2-o(2*(1-i)))/2,reverseEasing=o=>i=>1-o(1-i),backOut=cubicBezier$1(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=o=>(o*=2)<1?.5*backIn(o):.5*(2-Math.pow(2,-10*(o-1))),circIn=o=>1-Math.sin(Math.acos(o)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),isZeroValueString=o=>/^0[^.\s]+$/u.test(o);function isNone(o){return typeof o=="number"?o===0:o!==null?o==="none"||o==="0"||isZeroValueString(o):!0}const sanitize=o=>Math.round(o*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(o){return o==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(o,i)=>_=>!!(typeof _=="string"&&singleColorRegex.test(_)&&_.startsWith(o)||i&&!isNullish(_)&&Object.prototype.hasOwnProperty.call(_,i)),splitColor=(o,i,_)=>$=>{if(typeof $!="string")return $;const[j,_e,et,tt]=$.match(floatRegex);return{[o]:parseFloat(j),[i]:parseFloat(_e),[_]:parseFloat(et),alpha:tt!==void 0?parseFloat(tt):1}},clampRgbUnit=o=>clamp(0,255,o),rgbUnit={...number$3,transform:o=>Math.round(clampRgbUnit(o))},rgba$1={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:o,green:i,blue:_,alpha:$=1})=>"rgba("+rgbUnit.transform(o)+", "+rgbUnit.transform(i)+", "+rgbUnit.transform(_)+", "+sanitize(alpha$1.transform($))+")"};function parseHex(o){let i="",_="",$="",j="";return o.length>5?(i=o.substring(1,3),_=o.substring(3,5),$=o.substring(5,7),j=o.substring(7,9)):(i=o.substring(1,2),_=o.substring(2,3),$=o.substring(3,4),j=o.substring(4,5),i+=i,_+=_,$+=$,j+=j),{red:parseInt(i,16),green:parseInt(_,16),blue:parseInt($,16),alpha:j?parseInt(j,16)/255:1}}const hex$1={test:isColorString("#"),parse:parseHex,transform:rgba$1.transform},hsla$1={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:o,saturation:i,lightness:_,alpha:$=1})=>"hsla("+Math.round(o)+", "+percent.transform(sanitize(i))+", "+percent.transform(sanitize(_))+", "+sanitize(alpha$1.transform($))+")"},color$1={test:o=>rgba$1.test(o)||hex$1.test(o)||hsla$1.test(o),parse:o=>rgba$1.test(o)?rgba$1.parse(o):hsla$1.test(o)?hsla$1.parse(o):hex$1.parse(o),transform:o=>typeof o=="string"?o:o.hasOwnProperty("red")?rgba$1.transform(o):hsla$1.transform(o)},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(o){var i,_;return isNaN(o)&&typeof o=="string"&&(((i=o.match(floatRegex))===null||i===void 0?void 0:i.length)||0)+(((_=o.match(colorRegex))===null||_===void 0?void 0:_.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(o){const i=o.toString(),_=[],$={color:[],number:[],var:[]},j=[];let _e=0;const tt=i.replace(complexRegex,rt=>(color$1.test(rt)?($.color.push(_e),j.push(COLOR_TOKEN),_.push(color$1.parse(rt))):rt.startsWith(VAR_FUNCTION_TOKEN)?($.var.push(_e),j.push(VAR_TOKEN),_.push(rt)):($.number.push(_e),j.push(NUMBER_TOKEN),_.push(parseFloat(rt))),++_e,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:_,split:tt,indexes:$,types:j}}function parseComplexValue(o){return analyseComplexValue(o).values}function createTransformer(o){const{split:i,types:_}=analyseComplexValue(o),$=i.length;return j=>{let _e="";for(let et=0;et<$;et++)if(_e+=i[et],j[et]!==void 0){const tt=_[et];tt===NUMBER_TOKEN?_e+=sanitize(j[et]):tt===COLOR_TOKEN?_e+=color$1.transform(j[et]):_e+=j[et]}return _e}}const convertNumbersToZero=o=>typeof o=="number"?0:o;function getAnimatableNone$1(o){const i=parseComplexValue(o);return createTransformer(o)(i.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(o){const[i,_]=o.slice(0,-1).split("(");if(i==="drop-shadow")return o;const[$]=_.match(floatRegex)||[];if(!$)return o;const j=_.replace($,"");let _e=maxDefaults.has(i)?1:0;return $!==_&&(_e*=100),i+"("+_e+j+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:o=>{const i=o.match(functionRegex);return i?i.map(applyDefaultFilter).join(" "):o}},defaultValueTypes={...numberValueTypes,color:color$1,backgroundColor:color$1,outlineColor:color$1,fill:color$1,stroke:color$1,borderColor:color$1,borderTopColor:color$1,borderRightColor:color$1,borderBottomColor:color$1,borderLeftColor:color$1,filter,WebkitFilter:filter},getDefaultValueType=o=>defaultValueTypes[o];function getAnimatableNone(o,i){let _=getDefaultValueType(o);return _!==filter&&(_=complex),_.getAnimatableNone?_.getAnimatableNone(i):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(o,i,_){let $=0,j;for(;$<o.length&&!j;){const _e=o[$];typeof _e=="string"&&!invalidTemplates.has(_e)&&analyseComplexValue(_e).values.length&&(j=o[$]),$++}if(j&&_)for(const _e of i)o[_e]=getAnimatableNone(_,j)}const isNumOrPxType=o=>o===number$3||o===px,getPosFromMatrix=(o,i)=>parseFloat(o.split(", ")[i]),getTranslateFromMatrix=(o,i)=>(_,{transform:$})=>{if($==="none"||!$)return 0;const j=$.match(/^matrix3d\((.+)\)$/u);if(j)return getPosFromMatrix(j[1],i);{const _e=$.match(/^matrix\((.+)\)$/u);return _e?getPosFromMatrix(_e[1],o):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(o=>!transformKeys.has(o));function removeNonTranslationalTransform(o){const i=[];return nonTranslationalTransformKeys.forEach(_=>{const $=o.getValue(_);$!==void 0&&(i.push([_,$.get()]),$.set(_.startsWith("scale")?1:0))}),i}const positionalValues={width:({x:o},{paddingLeft:i="0",paddingRight:_="0"})=>o.max-o.min-parseFloat(i)-parseFloat(_),height:({y:o},{paddingTop:i="0",paddingBottom:_="0"})=>o.max-o.min-parseFloat(i)-parseFloat(_),top:(o,{top:i})=>parseFloat(i),left:(o,{left:i})=>parseFloat(i),bottom:({y:o},{top:i})=>parseFloat(i)+(o.max-o.min),right:({x:o},{left:i})=>parseFloat(i)+(o.max-o.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const o=Array.from(toResolve).filter($=>$.needsMeasurement),i=new Set(o.map($=>$.element)),_=new Map;i.forEach($=>{const j=removeNonTranslationalTransform($);j.length&&(_.set($,j),$.render())}),o.forEach($=>$.measureInitialState()),i.forEach($=>{$.render();const j=_.get($);j&&j.forEach(([_e,et])=>{var tt;(tt=$.getValue(_e))===null||tt===void 0||tt.set(et)})}),o.forEach($=>$.measureEndState()),o.forEach($=>{$.suspendedScrollY!==void 0&&window.scrollTo(0,$.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(o=>o.complete()),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(o=>{o.readKeyframes(),o.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){readAllKeyframes(),measureAllKeyframes()}class KeyframeResolver{constructor(i,_,$,j,_e,et=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...i],this.onComplete=_,this.name=$,this.motionValue=j,this.element=_e,this.isAsync=et}scheduleResolve(){this.isScheduled=!0,this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:i,name:_,element:$,motionValue:j}=this;for(let _e=0;_e<i.length;_e++)if(i[_e]===null)if(_e===0){const et=j==null?void 0:j.get(),tt=i[i.length-1];if(et!==void 0)i[0]=et;else if($&&_){const rt=$.readValue(_,tt);rt!=null&&(i[0]=rt)}i[0]===void 0&&(i[0]=tt),j&&et===void 0&&j.set(i[0])}else i[_e]=i[_e-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),toResolve.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,toResolve.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const isNumericalString=o=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(o),splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(o){const i=splitCSSVariableRegex.exec(o);if(!i)return[,];const[,_,$,j]=i;return[`--${_??$}`,j]}function getVariableValue(o,i,_=1){const[$,j]=parseCSSVariable(o);if(!$)return;const _e=window.getComputedStyle(i).getPropertyValue($);if(_e){const et=_e.trim();return isNumericalString(et)?parseFloat(et):et}return isCSSVariableToken(j)?getVariableValue(j,i,_+1):j}const testValueType=o=>i=>i.test(o),auto={test:o=>o==="auto",parse:o=>o},dimensionValueTypes=[number$3,px,percent,degrees,vw,vh,auto],findDimensionValueType=o=>dimensionValueTypes.find(testValueType(o));class DOMKeyframesResolver extends KeyframeResolver{constructor(i,_,$,j,_e){super(i,_,$,j,_e,!0)}readKeyframes(){const{unresolvedKeyframes:i,element:_,name:$}=this;if(!_||!_.current)return;super.readKeyframes();for(let rt=0;rt<i.length;rt++){let nt=i[rt];if(typeof nt=="string"&&(nt=nt.trim(),isCSSVariableToken(nt))){const it=getVariableValue(nt,_.current);it!==void 0&&(i[rt]=it),rt===i.length-1&&(this.finalKeyframe=nt)}}if(this.resolveNoneKeyframes(),!positionalKeys.has($)||i.length!==2)return;const[j,_e]=i,et=findDimensionValueType(j),tt=findDimensionValueType(_e);if(et!==tt)if(isNumOrPxType(et)&&isNumOrPxType(tt))for(let rt=0;rt<i.length;rt++){const nt=i[rt];typeof nt=="string"&&(i[rt]=parseFloat(nt))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:i,name:_}=this,$=[];for(let j=0;j<i.length;j++)isNone(i[j])&&$.push(j);$.length&&makeNoneKeyframesAnimatable(i,$,_)}measureInitialState(){const{element:i,unresolvedKeyframes:_,name:$}=this;if(!i||!i.current)return;$==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[$](i.measureViewportBox(),window.getComputedStyle(i.current)),_[0]=this.measuredOrigin;const j=_[_.length-1];j!==void 0&&i.getValue($,j).jump(j,!1)}measureEndState(){var i;const{element:_,name:$,unresolvedKeyframes:j}=this;if(!_||!_.current)return;const _e=_.getValue($);_e&&_e.jump(this.measuredOrigin,!1);const et=j.length-1,tt=j[et];j[et]=positionalValues[$](_.measureViewportBox(),window.getComputedStyle(_.current)),tt!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=tt),!((i=this.removedTransforms)===null||i===void 0)&&i.length&&this.removedTransforms.forEach(([rt,nt])=>{_.getValue(rt).set(nt)}),this.resolveNoneKeyframes()}}const isAnimatable=(o,i)=>i==="zIndex"?!1:!!(typeof o=="number"||Array.isArray(o)||typeof o=="string"&&(complex.test(o)||o==="0")&&!o.startsWith("url("));function hasKeyframesChanged(o){const i=o[0];if(o.length===1)return!0;for(let _=0;_<o.length;_++)if(o[_]!==i)return!0}function canAnimate(o,i,_,$){const j=o[0];if(j===null)return!1;if(i==="display"||i==="visibility")return!0;const _e=o[o.length-1],et=isAnimatable(j,i),tt=isAnimatable(_e,i);return!et||!tt?!1:hasKeyframesChanged(o)||(_==="spring"||isGenerator(_))&&$}const isNotNull=o=>o!==null;function getFinalKeyframe(o,{repeat:i,repeatType:_="loop"},$){const j=o.filter(isNotNull),_e=i&&_!=="loop"&&i%2===1?0:j.length-1;return!_e||$===void 0?j[_e]:$}const MAX_RESOLVE_DELAY=40;class BaseAnimation{constructor({autoplay:i=!0,delay:_=0,type:$="keyframes",repeat:j=0,repeatDelay:_e=0,repeatType:et="loop",...tt}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=time$1.now(),this.options={autoplay:i,delay:_,type:$,repeat:j,repeatDelay:_e,repeatType:et,...tt},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&flushKeyframeResolvers(),this._resolved}onKeyframesResolved(i,_){this.resolvedAt=time$1.now(),this.hasAttemptedResolve=!0;const{name:$,type:j,velocity:_e,delay:et,onComplete:tt,onUpdate:rt,isGenerator:nt}=this.options;if(!nt&&!canAnimate(i,$,j,_e))if(et)this.options.duration=0;else{rt&&rt(getFinalKeyframe(i,this.options,_)),tt&&tt(),this.resolveFinishedPromise();return}const it=this.initPlayback(i,_);it!==!1&&(this._resolved={keyframes:i,finalKeyframe:_,...it},this.onPostResolved())}onPostResolved(){}then(i,_){return this.currentFinishedPromise.then(i,_)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(i=>{this.resolveFinishedPromise=i})}}const mixNumber$1=(o,i,_)=>o+(i-o)*_;function hueToRgb(o,i,_){return _<0&&(_+=1),_>1&&(_-=1),_<1/6?o+(i-o)*6*_:_<1/2?i:_<2/3?o+(i-o)*(2/3-_)*6:o}function hslaToRgba({hue:o,saturation:i,lightness:_,alpha:$}){o/=360,i/=100,_/=100;let j=0,_e=0,et=0;if(!i)j=_e=et=_;else{const tt=_<.5?_*(1+i):_+i-_*i,rt=2*_-tt;j=hueToRgb(rt,tt,o+1/3),_e=hueToRgb(rt,tt,o),et=hueToRgb(rt,tt,o-1/3)}return{red:Math.round(j*255),green:Math.round(_e*255),blue:Math.round(et*255),alpha:$}}function mixImmediate(o,i){return _=>_>0?i:o}const mixLinearColor=(o,i,_)=>{const $=o*o,j=_*(i*i-$)+$;return j<0?0:Math.sqrt(j)},colorTypes=[hex$1,rgba$1,hsla$1],getColorType=o=>colorTypes.find(i=>i.test(o));function asRGBA(o){const i=getColorType(o);if(!i)return!1;let _=i.parse(o);return i===hsla$1&&(_=hslaToRgba(_)),_}const mixColor=(o,i)=>{const _=asRGBA(o),$=asRGBA(i);if(!_||!$)return mixImmediate(o,i);const j={..._};return _e=>(j.red=mixLinearColor(_.red,$.red,_e),j.green=mixLinearColor(_.green,$.green,_e),j.blue=mixLinearColor(_.blue,$.blue,_e),j.alpha=mixNumber$1(_.alpha,$.alpha,_e),rgba$1.transform(j))},combineFunctions=(o,i)=>_=>i(o(_)),pipe=(...o)=>o.reduce(combineFunctions),invisibleValues=new Set(["none","hidden"]);function mixVisibility(o,i){return invisibleValues.has(o)?_=>_<=0?o:i:_=>_>=1?i:o}function mixNumber(o,i){return _=>mixNumber$1(o,i,_)}function getMixer(o){return typeof o=="number"?mixNumber:typeof o=="string"?isCSSVariableToken(o)?mixImmediate:color$1.test(o)?mixColor:mixComplex:Array.isArray(o)?mixArray:typeof o=="object"?color$1.test(o)?mixColor:mixObject:mixImmediate}function mixArray(o,i){const _=[...o],$=_.length,j=o.map((_e,et)=>getMixer(_e)(_e,i[et]));return _e=>{for(let et=0;et<$;et++)_[et]=j[et](_e);return _}}function mixObject(o,i){const _={...o,...i},$={};for(const j in _)o[j]!==void 0&&i[j]!==void 0&&($[j]=getMixer(o[j])(o[j],i[j]));return j=>{for(const _e in $)_[_e]=$[_e](j);return _}}function matchOrder(o,i){var _;const $=[],j={color:0,var:0,number:0};for(let _e=0;_e<i.values.length;_e++){const et=i.types[_e],tt=o.indexes[et][j[et]],rt=(_=o.values[tt])!==null&&_!==void 0?_:0;$[_e]=rt,j[et]++}return $}const mixComplex=(o,i)=>{const _=complex.createTransformer(i),$=analyseComplexValue(o),j=analyseComplexValue(i);return $.indexes.var.length===j.indexes.var.length&&$.indexes.color.length===j.indexes.color.length&&$.indexes.number.length>=j.indexes.number.length?invisibleValues.has(o)&&!j.values.length||invisibleValues.has(i)&&!$.values.length?mixVisibility(o,i):pipe(mixArray(matchOrder($,j),j.values),_):mixImmediate(o,i)};function mix(o,i,_){return typeof o=="number"&&typeof i=="number"&&typeof _=="number"?mixNumber$1(o,i,_):getMixer(o)(o,i)}const velocitySampleDuration=5;function calcGeneratorVelocity(o,i,_){const $=Math.max(i-velocitySampleDuration,0);return velocityPerSecond(_-o($),i-$)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:o=springDefaults.duration,bounce:i=springDefaults.bounce,velocity:_=springDefaults.velocity,mass:$=springDefaults.mass}){let j,_e,et=1-i;et=clamp(springDefaults.minDamping,springDefaults.maxDamping,et),o=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(o)),et<1?(j=nt=>{const it=nt*et,st=it*o,at=it-_,ot=calcAngularFreq(nt,et),lt=Math.exp(-st);return safeMin-at/ot*lt},_e=nt=>{const st=nt*et*o,at=st*_+_,ot=Math.pow(et,2)*Math.pow(nt,2)*o,lt=Math.exp(-st),ct=calcAngularFreq(Math.pow(nt,2),et);return(-j(nt)+safeMin>0?-1:1)*((at-ot)*lt)/ct}):(j=nt=>{const it=Math.exp(-nt*o),st=(nt-_)*o+1;return-.001+it*st},_e=nt=>{const it=Math.exp(-nt*o),st=(_-nt)*(o*o);return it*st});const tt=5/o,rt=approximateRoot(j,_e,tt);if(o=secondsToMilliseconds(o),isNaN(rt))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:o};{const nt=Math.pow(rt,2)*$;return{stiffness:nt,damping:et*2*Math.sqrt($*nt),duration:o}}}const rootIterations=12;function approximateRoot(o,i,_){let $=_;for(let j=1;j<rootIterations;j++)$=$-o($)/i($);return $}function calcAngularFreq(o,i){return o*Math.sqrt(1-i*i)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(o,i){return i.some(_=>o[_]!==void 0)}function getSpringOptions(o){let i={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...o};if(!isSpringType(o,physicsKeys)&&isSpringType(o,durationKeys))if(o.visualDuration){const _=o.visualDuration,$=2*Math.PI/(_*1.2),j=$*$,_e=2*clamp(.05,1,1-(o.bounce||0))*Math.sqrt(j);i={...i,mass:springDefaults.mass,stiffness:j,damping:_e}}else{const _=findSpring(o);i={...i,..._,mass:springDefaults.mass},i.isResolvedFromDuration=!0}return i}function spring(o=springDefaults.visualDuration,i=springDefaults.bounce){const _=typeof o!="object"?{visualDuration:o,keyframes:[0,1],bounce:i}:o;let{restSpeed:$,restDelta:j}=_;const _e=_.keyframes[0],et=_.keyframes[_.keyframes.length-1],tt={done:!1,value:_e},{stiffness:rt,damping:nt,mass:it,duration:st,velocity:at,isResolvedFromDuration:ot}=getSpringOptions({..._,velocity:-millisecondsToSeconds(_.velocity||0)}),lt=at||0,ct=nt/(2*Math.sqrt(rt*it)),ft=et-_e,ut=millisecondsToSeconds(Math.sqrt(rt/it)),ht=Math.abs(ft)<5;$||($=ht?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),j||(j=ht?springDefaults.restDelta.granular:springDefaults.restDelta.default);let dt;if(ct<1){const pt=calcAngularFreq(ut,ct);dt=yt=>{const gt=Math.exp(-ct*ut*yt);return et-gt*((lt+ct*ut*ft)/pt*Math.sin(pt*yt)+ft*Math.cos(pt*yt))}}else if(ct===1)dt=pt=>et-Math.exp(-ut*pt)*(ft+(lt+ut*ft)*pt);else{const pt=ut*Math.sqrt(ct*ct-1);dt=yt=>{const gt=Math.exp(-ct*ut*yt),vt=Math.min(pt*yt,300);return et-gt*((lt+ct*ut*ft)*Math.sinh(vt)+pt*ft*Math.cosh(vt))/pt}}const mt={calculatedDuration:ot&&st||null,next:pt=>{const yt=dt(pt);if(ot)tt.done=pt>=st;else{let gt=0;ct<1&&(gt=pt===0?secondsToMilliseconds(lt):calcGeneratorVelocity(dt,pt,yt));const vt=Math.abs(gt)<=$,St=Math.abs(et-yt)<=j;tt.done=vt&&St}return tt.value=tt.done?et:yt,tt},toString:()=>{const pt=Math.min(calcGeneratorDuration(mt),maxGeneratorDuration),yt=generateLinearEasing(gt=>mt.next(pt*gt).value,pt,30);return pt+"ms "+yt}};return mt}function inertia({keyframes:o,velocity:i=0,power:_=.8,timeConstant:$=325,bounceDamping:j=10,bounceStiffness:_e=500,modifyTarget:et,min:tt,max:rt,restDelta:nt=.5,restSpeed:it}){const st=o[0],at={done:!1,value:st},ot=vt=>tt!==void 0&&vt<tt||rt!==void 0&&vt>rt,lt=vt=>tt===void 0?rt:rt===void 0||Math.abs(tt-vt)<Math.abs(rt-vt)?tt:rt;let ct=_*i;const ft=st+ct,ut=et===void 0?ft:et(ft);ut!==ft&&(ct=ut-st);const ht=vt=>-ct*Math.exp(-vt/$),dt=vt=>ut+ht(vt),mt=vt=>{const St=ht(vt),At=dt(vt);at.done=Math.abs(St)<=nt,at.value=at.done?ut:At};let pt,yt;const gt=vt=>{ot(at.value)&&(pt=vt,yt=spring({keyframes:[at.value,lt(at.value)],velocity:calcGeneratorVelocity(dt,vt,at.value),damping:j,stiffness:_e,restDelta:nt,restSpeed:it}))};return gt(0),{calculatedDuration:null,next:vt=>{let St=!1;return!yt&&pt===void 0&&(St=!0,mt(vt),gt(vt)),pt!==void 0&&vt>=pt?yt.next(vt-pt):(!St&&mt(vt),at)}}}const easeIn=cubicBezier$1(.42,0,1,1),easeOut=cubicBezier$1(0,0,.58,1),easeInOut=cubicBezier$1(.42,0,.58,1),isEasingArray=o=>Array.isArray(o)&&typeof o[0]!="number",easingLookup={linear:noop$7,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=o=>{if(isBezierDefinition(o)){invariant$1(o.length===4);const[i,_,$,j]=o;return cubicBezier$1(i,_,$,j)}else if(typeof o=="string")return easingLookup[o];return o};function createMixers(o,i,_){const $=[],j=_||mix,_e=o.length-1;for(let et=0;et<_e;et++){let tt=j(o[et],o[et+1]);if(i){const rt=Array.isArray(i)?i[et]||noop$7:i;tt=pipe(rt,tt)}$.push(tt)}return $}function interpolate$1(o,i,{clamp:_=!0,ease:$,mixer:j}={}){const _e=o.length;if(invariant$1(_e===i.length),_e===1)return()=>i[0];if(_e===2&&i[0]===i[1])return()=>i[1];const et=o[0]===o[1];o[0]>o[_e-1]&&(o=[...o].reverse(),i=[...i].reverse());const tt=createMixers(i,$,j),rt=tt.length,nt=it=>{if(et&&it<o[0])return i[0];let st=0;if(rt>1)for(;st<o.length-2&&!(it<o[st+1]);st++);const at=progress$2(o[st],o[st+1],it);return tt[st](at)};return _?it=>nt(clamp(o[0],o[_e-1],it)):nt}function fillOffset(o,i){const _=o[o.length-1];for(let $=1;$<=i;$++){const j=progress$2(0,i,$);o.push(mixNumber$1(_,1,j))}}function defaultOffset(o){const i=[0];return fillOffset(i,o.length-1),i}function convertOffsetToTimes(o,i){return o.map(_=>_*i)}function defaultEasing(o,i){return o.map(()=>i||easeInOut).splice(0,o.length-1)}function keyframes({duration:o=300,keyframes:i,times:_,ease:$="easeInOut"}){const j=isEasingArray($)?$.map(easingDefinitionToFunction):easingDefinitionToFunction($),_e={done:!1,value:i[0]},et=convertOffsetToTimes(_&&_.length===i.length?_:defaultOffset(i),o),tt=interpolate$1(et,i,{ease:Array.isArray(j)?j:defaultEasing(i,j)});return{calculatedDuration:o,next:rt=>(_e.value=tt(rt),_e.done=rt>=o,_e)}}const frameloopDriver=o=>{const i=({timestamp:_})=>o(_);return{start:()=>frame.update(i,!0),stop:()=>cancelFrame(i),now:()=>frameData.isProcessing?frameData.timestamp:time$1.now()}},generators={decay:inertia,inertia,tween:keyframes,keyframes,spring},percentToProgress=o=>o/100;class MainThreadAnimation extends BaseAnimation{constructor(i){super(i),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:rt}=this.options;rt&&rt()};const{name:_,motionValue:$,element:j,keyframes:_e}=this.options,et=(j==null?void 0:j.KeyframeResolver)||KeyframeResolver,tt=(rt,nt)=>this.onKeyframesResolved(rt,nt);this.resolver=new et(_e,tt,_,$,j),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(i){const{type:_="keyframes",repeat:$=0,repeatDelay:j=0,repeatType:_e,velocity:et=0}=this.options,tt=isGenerator(_)?_:generators[_]||keyframes;let rt,nt;tt!==keyframes&&typeof i[0]!="number"&&(rt=pipe(percentToProgress,mix(i[0],i[1])),i=[0,100]);const it=tt({...this.options,keyframes:i});_e==="mirror"&&(nt=tt({...this.options,keyframes:[...i].reverse(),velocity:-et})),it.calculatedDuration===null&&(it.calculatedDuration=calcGeneratorDuration(it));const{calculatedDuration:st}=it,at=st+j,ot=at*($+1)-j;return{generator:it,mirroredGenerator:nt,mapPercentToKeyframes:rt,calculatedDuration:st,resolvedDuration:at,totalDuration:ot}}onPostResolved(){const{autoplay:i=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!i?this.pause():this.state=this.pendingPlayState}tick(i,_=!1){const{resolved:$}=this;if(!$){const{keyframes:vt}=this.options;return{done:!0,value:vt[vt.length-1]}}const{finalKeyframe:j,generator:_e,mirroredGenerator:et,mapPercentToKeyframes:tt,keyframes:rt,calculatedDuration:nt,totalDuration:it,resolvedDuration:st}=$;if(this.startTime===null)return _e.next(0);const{delay:at,repeat:ot,repeatType:lt,repeatDelay:ct,onUpdate:ft}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,i):this.speed<0&&(this.startTime=Math.min(i-it/this.speed,this.startTime)),_?this.currentTime=i:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(i-this.startTime)*this.speed;const ut=this.currentTime-at*(this.speed>=0?1:-1),ht=this.speed>=0?ut<0:ut>it;this.currentTime=Math.max(ut,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=it);let dt=this.currentTime,mt=_e;if(ot){const vt=Math.min(this.currentTime,it)/st;let St=Math.floor(vt),At=vt%1;!At&&vt>=1&&(At=1),At===1&&St--,St=Math.min(St,ot+1),!!(St%2)&&(lt==="reverse"?(At=1-At,ct&&(At-=ct/st)):lt==="mirror"&&(mt=et)),dt=clamp(0,1,At)*st}const pt=ht?{done:!1,value:rt[0]}:mt.next(dt);tt&&(pt.value=tt(pt.value));let{done:yt}=pt;!ht&&nt!==null&&(yt=this.speed>=0?this.currentTime>=it:this.currentTime<=0);const gt=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&yt);return gt&&j!==void 0&&(pt.value=getFinalKeyframe(rt,this.options,j)),ft&&ft(pt.value),gt&&this.finish(),pt}get duration(){const{resolved:i}=this;return i?millisecondsToSeconds(i.calculatedDuration):0}get time(){return millisecondsToSeconds(this.currentTime)}set time(i){i=secondsToMilliseconds(i),this.currentTime=i,this.holdTime!==null||this.speed===0?this.holdTime=i:this.driver&&(this.startTime=this.driver.now()-i/this.speed)}get speed(){return this.playbackSpeed}set speed(i){const _=this.playbackSpeed!==i;this.playbackSpeed=i,_&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:i=frameloopDriver,onPlay:_,startTime:$}=this.options;this.driver||(this.driver=i(_e=>this.tick(_e))),_&&_();const j=this.driver.now();this.holdTime!==null?this.startTime=j-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=j):this.startTime=$??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var i;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(i=this.currentTime)!==null&&i!==void 0?i:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:i}=this.options;i&&i()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(i){return this.startTime=0,this.tick(i,!0)}}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]);function startWaapiAnimation(o,i,_,{delay:$=0,duration:j=300,repeat:_e=0,repeatType:et="loop",ease:tt="easeInOut",times:rt}={}){const nt={[i]:_};rt&&(nt.offset=rt);const it=mapEasingToNativeEasing(tt,j);return Array.isArray(it)&&(nt.easing=it),o.animate(nt,{delay:$,duration:j,easing:Array.isArray(it)?"linear":it,fill:"both",iterations:_e+1,direction:et==="reverse"?"alternate":"normal"})}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),sampleDelta=10,maxDuration=2e4;function requiresPregeneratedKeyframes(o){return isGenerator(o.type)||o.type==="spring"||!isWaapiSupportedEasing(o.ease)}function pregenerateKeyframes(o,i){const _=new MainThreadAnimation({...i,keyframes:o,repeat:0,delay:0,isGenerator:!0});let $={done:!1,value:o[0]};const j=[];let _e=0;for(;!$.done&&_e<maxDuration;)$=_.sample(_e),j.push($.value),_e+=sampleDelta;return{times:void 0,keyframes:j,duration:_e-sampleDelta,ease:"linear"}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(o){return o in unsupportedEasingFunctions}class AcceleratedAnimation extends BaseAnimation{constructor(i){super(i);const{name:_,motionValue:$,element:j,keyframes:_e}=this.options;this.resolver=new DOMKeyframesResolver(_e,(et,tt)=>this.onKeyframesResolved(et,tt),_,$,j),this.resolver.scheduleResolve()}initPlayback(i,_){let{duration:$=300,times:j,ease:_e,type:et,motionValue:tt,name:rt,startTime:nt}=this.options;if(!tt.owner||!tt.owner.current)return!1;if(typeof _e=="string"&&supportsLinearEasing()&&isUnsupportedEase(_e)&&(_e=unsupportedEasingFunctions[_e]),requiresPregeneratedKeyframes(this.options)){const{onComplete:st,onUpdate:at,motionValue:ot,element:lt,...ct}=this.options,ft=pregenerateKeyframes(i,ct);i=ft.keyframes,i.length===1&&(i[1]=i[0]),$=ft.duration,j=ft.times,_e=ft.ease,et="keyframes"}const it=startWaapiAnimation(tt.owner.current,rt,i,{...this.options,duration:$,times:j,ease:_e});return it.startTime=nt??this.calcStartTime(),this.pendingTimeline?(attachTimeline(it,this.pendingTimeline),this.pendingTimeline=void 0):it.onfinish=()=>{const{onComplete:st}=this.options;tt.set(getFinalKeyframe(i,this.options,_)),st&&st(),this.cancel(),this.resolveFinishedPromise()},{animation:it,duration:$,times:j,type:et,ease:_e,keyframes:i}}get duration(){const{resolved:i}=this;if(!i)return 0;const{duration:_}=i;return millisecondsToSeconds(_)}get time(){const{resolved:i}=this;if(!i)return 0;const{animation:_}=i;return millisecondsToSeconds(_.currentTime||0)}set time(i){const{resolved:_}=this;if(!_)return;const{animation:$}=_;$.currentTime=secondsToMilliseconds(i)}get speed(){const{resolved:i}=this;if(!i)return 1;const{animation:_}=i;return _.playbackRate}set speed(i){const{resolved:_}=this;if(!_)return;const{animation:$}=_;$.playbackRate=i}get state(){const{resolved:i}=this;if(!i)return"idle";const{animation:_}=i;return _.playState}get startTime(){const{resolved:i}=this;if(!i)return null;const{animation:_}=i;return _.startTime}attachTimeline(i){if(!this._resolved)this.pendingTimeline=i;else{const{resolved:_}=this;if(!_)return noop$7;const{animation:$}=_;attachTimeline($,i)}return noop$7}play(){if(this.isStopped)return;const{resolved:i}=this;if(!i)return;const{animation:_}=i;_.playState==="finished"&&this.updateFinishedPromise(),_.play()}pause(){const{resolved:i}=this;if(!i)return;const{animation:_}=i;_.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:i}=this;if(!i)return;const{animation:_,keyframes:$,duration:j,type:_e,ease:et,times:tt}=i;if(_.playState==="idle"||_.playState==="finished")return;if(this.time){const{motionValue:nt,onUpdate:it,onComplete:st,element:at,...ot}=this.options,lt=new MainThreadAnimation({...ot,keyframes:$,duration:j,type:_e,ease:et,times:tt,isGenerator:!0}),ct=secondsToMilliseconds(this.time);nt.setWithVelocity(lt.sample(ct-sampleDelta).value,lt.sample(ct).value,sampleDelta)}const{onStop:rt}=this.options;rt&&rt(),this.cancel()}complete(){const{resolved:i}=this;i&&i.animation.finish()}cancel(){const{resolved:i}=this;i&&i.animation.cancel()}static supports(i){const{motionValue:_,name:$,repeatDelay:j,repeatType:_e,damping:et,type:tt}=i;if(!_||!_.owner||!(_.owner.current instanceof HTMLElement))return!1;const{onUpdate:rt,transformTemplate:nt}=_.owner.getProps();return supportsWaapi()&&$&&acceleratedValues.has($)&&!rt&&!nt&&!j&&_e!=="mirror"&&et!==0&&tt!=="inertia"}}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=o=>({type:"spring",stiffness:550,damping:o===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(o,{keyframes:i})=>i.length>2?keyframesTransition:transformProps.has(o)?o.startsWith("scale")?criticallyDampedSpring(i[1]):underDampedSpring:ease;function isTransitionDefined({when:o,delay:i,delayChildren:_,staggerChildren:$,staggerDirection:j,repeat:_e,repeatType:et,repeatDelay:tt,from:rt,elapsed:nt,...it}){return!!Object.keys(it).length}const animateMotionValue=(o,i,_,$={},j,_e)=>et=>{const tt=getValueTransition($,o)||{},rt=tt.delay||$.delay||0;let{elapsed:nt=0}=$;nt=nt-secondsToMilliseconds(rt);let it={keyframes:Array.isArray(_)?_:[null,_],ease:"easeOut",velocity:i.getVelocity(),...tt,delay:-nt,onUpdate:at=>{i.set(at),tt.onUpdate&&tt.onUpdate(at)},onComplete:()=>{et(),tt.onComplete&&tt.onComplete()},name:o,motionValue:i,element:_e?void 0:j};isTransitionDefined(tt)||(it={...it,...getDefaultTransition(o,it)}),it.duration&&(it.duration=secondsToMilliseconds(it.duration)),it.repeatDelay&&(it.repeatDelay=secondsToMilliseconds(it.repeatDelay)),it.from!==void 0&&(it.keyframes[0]=it.from);let st=!1;if((it.type===!1||it.duration===0&&!it.repeatDelay)&&(it.duration=0,it.delay===0&&(st=!0)),st&&!_e&&i.get()!==void 0){const at=getFinalKeyframe(it.keyframes,tt);if(at!==void 0)return frame.update(()=>{it.onUpdate(at),it.onComplete()}),new GroupPlaybackControls([])}return!_e&&AcceleratedAnimation.supports(it)?new AcceleratedAnimation(it):new MainThreadAnimation(it)};function shouldBlockAnimation({protectedKeys:o,needsAnimating:i},_){const $=o.hasOwnProperty(_)&&i[_]!==!0;return i[_]=!1,$}function animateTarget(o,i,{delay:_=0,transitionOverride:$,type:j}={}){var _e;let{transition:et=o.getDefaultTransition(),transitionEnd:tt,...rt}=i;$&&(et=$);const nt=[],it=j&&o.animationState&&o.animationState.getState()[j];for(const st in rt){const at=o.getValue(st,(_e=o.latestValues[st])!==null&&_e!==void 0?_e:null),ot=rt[st];if(ot===void 0||it&&shouldBlockAnimation(it,st))continue;const lt={delay:_,...getValueTransition(et||{},st)};let ct=!1;if(window.MotionHandoffAnimation){const ut=getOptimisedAppearId(o);if(ut){const ht=window.MotionHandoffAnimation(ut,st,frame);ht!==null&&(lt.startTime=ht,ct=!0)}}addValueToWillChange(o,st),at.start(animateMotionValue(st,at,ot,o.shouldReduceMotion&&positionalKeys.has(st)?{type:!1}:lt,o,ct));const ft=at.animation;ft&&nt.push(ft)}return tt&&Promise.all(nt).then(()=>{frame.update(()=>{tt&&setTarget(o,tt)})}),nt}function animateVariant(o,i,_={}){var $;const j=resolveVariant(o,i,_.type==="exit"?($=o.presenceContext)===null||$===void 0?void 0:$.custom:void 0);let{transition:_e=o.getDefaultTransition()||{}}=j||{};_.transitionOverride&&(_e=_.transitionOverride);const et=j?()=>Promise.all(animateTarget(o,j,_)):()=>Promise.resolve(),tt=o.variantChildren&&o.variantChildren.size?(nt=0)=>{const{delayChildren:it=0,staggerChildren:st,staggerDirection:at}=_e;return animateChildren(o,i,it+nt,st,at,_)}:()=>Promise.resolve(),{when:rt}=_e;if(rt){const[nt,it]=rt==="beforeChildren"?[et,tt]:[tt,et];return nt().then(()=>it())}else return Promise.all([et(),tt(_.delay)])}function animateChildren(o,i,_=0,$=0,j=1,_e){const et=[],tt=(o.variantChildren.size-1)*$,rt=j===1?(nt=0)=>nt*$:(nt=0)=>tt-nt*$;return Array.from(o.variantChildren).sort(sortByTreeOrder).forEach((nt,it)=>{nt.notify("AnimationStart",i),et.push(animateVariant(nt,i,{..._e,delay:_+rt(it)}).then(()=>nt.notify("AnimationComplete",i)))}),Promise.all(et)}function sortByTreeOrder(o,i){return o.sortNodePosition(i)}function animateVisualElement(o,i,_={}){o.notify("AnimationStart",i);let $;if(Array.isArray(i)){const j=i.map(_e=>animateVariant(o,_e,_));$=Promise.all(j)}else if(typeof i=="string")$=animateVariant(o,i,_);else{const j=typeof i=="function"?resolveVariant(o,i,_.custom):i;$=Promise.all(animateTarget(o,j,_))}return $.then(()=>{o.notify("AnimationComplete",i)})}const numVariantProps=variantProps.length;function getVariantContext(o){if(!o)return;if(!o.isControllingVariants){const _=o.parent?getVariantContext(o.parent)||{}:{};return o.props.initial!==void 0&&(_.initial=o.props.initial),_}const i={};for(let _=0;_<numVariantProps;_++){const $=variantProps[_],j=o.props[$];(isVariantLabel(j)||j===!1)&&(i[$]=j)}return i}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(o){return i=>Promise.all(i.map(({animation:_,options:$})=>animateVisualElement(o,_,$)))}function createAnimationState(o){let i=animateList(o),_=createState(),$=!0;const j=rt=>(nt,it)=>{var st;const at=resolveVariant(o,it,rt==="exit"?(st=o.presenceContext)===null||st===void 0?void 0:st.custom:void 0);if(at){const{transition:ot,transitionEnd:lt,...ct}=at;nt={...nt,...ct,...lt}}return nt};function _e(rt){i=rt(o)}function et(rt){const{props:nt}=o,it=getVariantContext(o.parent)||{},st=[],at=new Set;let ot={},lt=1/0;for(let ft=0;ft<numAnimationTypes;ft++){const ut=reversePriorityOrder[ft],ht=_[ut],dt=nt[ut]!==void 0?nt[ut]:it[ut],mt=isVariantLabel(dt),pt=ut===rt?ht.isActive:null;pt===!1&&(lt=ft);let yt=dt===it[ut]&&dt!==nt[ut]&&mt;if(yt&&$&&o.manuallyAnimateOnMount&&(yt=!1),ht.protectedKeys={...ot},!ht.isActive&&pt===null||!dt&&!ht.prevProp||isAnimationControls(dt)||typeof dt=="boolean")continue;const gt=checkVariantsDidChange(ht.prevProp,dt);let vt=gt||ut===rt&&ht.isActive&&!yt&&mt||ft>lt&&mt,St=!1;const At=Array.isArray(dt)?dt:[dt];let xt=At.reduce(j(ut),{});pt===!1&&(xt={});const{prevResolvedValues:wt={}}=ht,Ot={...wt,...xt},Bt=Rt=>{vt=!0,at.has(Rt)&&(St=!0,at.delete(Rt)),ht.needsAnimating[Rt]=!0;const Et=o.getValue(Rt);Et&&(Et.liveStyle=!1)};for(const Rt in Ot){const Et=xt[Rt],_t=wt[Rt];if(ot.hasOwnProperty(Rt))continue;let Mt=!1;isKeyframesTarget(Et)&&isKeyframesTarget(_t)?Mt=!shallowCompare(Et,_t):Mt=Et!==_t,Mt?Et!=null?Bt(Rt):at.add(Rt):Et!==void 0&&at.has(Rt)?Bt(Rt):ht.protectedKeys[Rt]=!0}ht.prevProp=dt,ht.prevResolvedValues=xt,ht.isActive&&(ot={...ot,...xt}),$&&o.blockInitialAnimation&&(vt=!1),vt&&(!(yt&&gt)||St)&&st.push(...At.map(Rt=>({animation:Rt,options:{type:ut}})))}if(at.size){const ft={};at.forEach(ut=>{const ht=o.getBaseTarget(ut),dt=o.getValue(ut);dt&&(dt.liveStyle=!0),ft[ut]=ht??null}),st.push({animation:ft})}let ct=!!st.length;return $&&(nt.initial===!1||nt.initial===nt.animate)&&!o.manuallyAnimateOnMount&&(ct=!1),$=!1,ct?i(st):Promise.resolve()}function tt(rt,nt){var it;if(_[rt].isActive===nt)return Promise.resolve();(it=o.variantChildren)===null||it===void 0||it.forEach(at=>{var ot;return(ot=at.animationState)===null||ot===void 0?void 0:ot.setActive(rt,nt)}),_[rt].isActive=nt;const st=et(rt);for(const at in _)_[at].protectedKeys={};return st}return{animateChanges:et,setActive:tt,setAnimateFunction:_e,getState:()=>_,reset:()=>{_=createState(),$=!0}}}function checkVariantsDidChange(o,i){return typeof i=="string"?i!==o:Array.isArray(i)?!shallowCompare(i,o):!1}function createTypeState(o=!1){return{isActive:o,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(i){this.isMounted=!1,this.node=i}update(){}}class AnimationFeature extends Feature{constructor(i){super(i),i.animationState||(i.animationState=createAnimationState(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();isAnimationControls(i)&&(this.unmountControls=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:_}=this.node.prevProps||{};i!==_&&this.updateAnimationControlsSubscription()}unmount(){var i;this.node.animationState.reset(),(i=this.unmountControls)===null||i===void 0||i.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:_}=this.node.presenceContext,{isPresent:$}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===$)return;const j=this.node.animationState.setActive("exit",!i);_&&!i&&j.then(()=>_(this.id))}mount(){const{register:i}=this.node.presenceContext||{};i&&(this.unmount=i(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(o,i,_,$={passive:!0}){return o.addEventListener(i,_,$),()=>o.removeEventListener(i,_)}function extractEventInfo(o){return{point:{x:o.pageX,y:o.pageY}}}const addPointerInfo=o=>i=>isPrimaryPointer(i)&&o(i,extractEventInfo(i));function addPointerEvent(o,i,_,$){return addDomEvent(o,i,addPointerInfo(_),$)}const distance=(o,i)=>Math.abs(o-i);function distance2D(o,i){const _=distance(o.x,i.x),$=distance(o.y,i.y);return Math.sqrt(_**2+$**2)}class PanSession{constructor(i,_,{transformPagePoint:$,contextWindow:j,dragSnapToOrigin:_e=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const st=getPanInfo(this.lastMoveEventInfo,this.history),at=this.startEvent!==null,ot=distance2D(st.offset,{x:0,y:0})>=3;if(!at&&!ot)return;const{point:lt}=st,{timestamp:ct}=frameData;this.history.push({...lt,timestamp:ct});const{onStart:ft,onMove:ut}=this.handlers;at||(ft&&ft(this.lastMoveEvent,st),this.startEvent=this.lastMoveEvent),ut&&ut(this.lastMoveEvent,st)},this.handlePointerMove=(st,at)=>{this.lastMoveEvent=st,this.lastMoveEventInfo=transformPoint(at,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(st,at)=>{this.end();const{onEnd:ot,onSessionEnd:lt,resumeAnimation:ct}=this.handlers;if(this.dragSnapToOrigin&&ct&&ct(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ft=getPanInfo(st.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(at,this.transformPagePoint),this.history);this.startEvent&&ot&&ot(st,ft),lt&&lt(st,ft)},!isPrimaryPointer(i))return;this.dragSnapToOrigin=_e,this.handlers=_,this.transformPagePoint=$,this.contextWindow=j||window;const et=extractEventInfo(i),tt=transformPoint(et,this.transformPagePoint),{point:rt}=tt,{timestamp:nt}=frameData;this.history=[{...rt,timestamp:nt}];const{onSessionStart:it}=_;it&&it(i,getPanInfo(tt,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(o,i){return i?{point:i(o.point)}:o}function subtractPoint(o,i){return{x:o.x-i.x,y:o.y-i.y}}function getPanInfo({point:o},i){return{point:o,delta:subtractPoint(o,lastDevicePoint(i)),offset:subtractPoint(o,startDevicePoint(i)),velocity:getVelocity(i,.1)}}function startDevicePoint(o){return o[0]}function lastDevicePoint(o){return o[o.length-1]}function getVelocity(o,i){if(o.length<2)return{x:0,y:0};let _=o.length-1,$=null;const j=lastDevicePoint(o);for(;_>=0&&($=o[_],!(j.timestamp-$.timestamp>secondsToMilliseconds(i)));)_--;if(!$)return{x:0,y:0};const _e=millisecondsToSeconds(j.timestamp-$.timestamp);if(_e===0)return{x:0,y:0};const et={x:(j.x-$.x)/_e,y:(j.y-$.y)/_e};return et.x===1/0&&(et.x=0),et.y===1/0&&(et.y=0),et}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(o){return o.max-o.min}function isNear(o,i,_){return Math.abs(o-i)<=_}function calcAxisDelta(o,i,_,$=.5){o.origin=$,o.originPoint=mixNumber$1(i.min,i.max,o.origin),o.scale=calcLength(_)/calcLength(i),o.translate=mixNumber$1(_.min,_.max,o.origin)-o.originPoint,(o.scale>=SCALE_MIN&&o.scale<=SCALE_MAX||isNaN(o.scale))&&(o.scale=1),(o.translate>=TRANSLATE_MIN&&o.translate<=TRANSLATE_MAX||isNaN(o.translate))&&(o.translate=0)}function calcBoxDelta(o,i,_,$){calcAxisDelta(o.x,i.x,_.x,$?$.originX:void 0),calcAxisDelta(o.y,i.y,_.y,$?$.originY:void 0)}function calcRelativeAxis(o,i,_){o.min=_.min+i.min,o.max=o.min+calcLength(i)}function calcRelativeBox(o,i,_){calcRelativeAxis(o.x,i.x,_.x),calcRelativeAxis(o.y,i.y,_.y)}function calcRelativeAxisPosition(o,i,_){o.min=i.min-_.min,o.max=o.min+calcLength(i)}function calcRelativePosition(o,i,_){calcRelativeAxisPosition(o.x,i.x,_.x),calcRelativeAxisPosition(o.y,i.y,_.y)}function applyConstraints(o,{min:i,max:_},$){return i!==void 0&&o<i?o=$?mixNumber$1(i,o,$.min):Math.max(o,i):_!==void 0&&o>_&&(o=$?mixNumber$1(_,o,$.max):Math.min(o,_)),o}function calcRelativeAxisConstraints(o,i,_){return{min:i!==void 0?o.min+i:void 0,max:_!==void 0?o.max+_-(o.max-o.min):void 0}}function calcRelativeConstraints(o,{top:i,left:_,bottom:$,right:j}){return{x:calcRelativeAxisConstraints(o.x,_,j),y:calcRelativeAxisConstraints(o.y,i,$)}}function calcViewportAxisConstraints(o,i){let _=i.min-o.min,$=i.max-o.max;return i.max-i.min<o.max-o.min&&([_,$]=[$,_]),{min:_,max:$}}function calcViewportConstraints(o,i){return{x:calcViewportAxisConstraints(o.x,i.x),y:calcViewportAxisConstraints(o.y,i.y)}}function calcOrigin(o,i){let _=.5;const $=calcLength(o),j=calcLength(i);return j>$?_=progress$2(i.min,i.max-$,o.min):$>j&&(_=progress$2(o.min,o.max-j,i.min)),clamp(0,1,_)}function rebaseAxisConstraints(o,i){const _={};return i.min!==void 0&&(_.min=i.min-o.min),i.max!==void 0&&(_.max=i.max-o.min),_}const defaultElastic=.35;function resolveDragElastic(o=defaultElastic){return o===!1?o=0:o===!0&&(o=defaultElastic),{x:resolveAxisElastic(o,"left","right"),y:resolveAxisElastic(o,"top","bottom")}}function resolveAxisElastic(o,i,_){return{min:resolvePointElastic(o,i),max:resolvePointElastic(o,_)}}function resolvePointElastic(o,i){return typeof o=="number"?o:o[i]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(o){return[o("x"),o("y")]}function convertBoundingBoxToBox({top:o,left:i,right:_,bottom:$}){return{x:{min:i,max:_},y:{min:o,max:$}}}function convertBoxToBoundingBox({x:o,y:i}){return{top:i.min,right:o.max,bottom:i.max,left:o.min}}function transformBoxPoints(o,i){if(!i)return o;const _=i({x:o.left,y:o.top}),$=i({x:o.right,y:o.bottom});return{top:_.y,left:_.x,bottom:$.y,right:$.x}}function isIdentityScale(o){return o===void 0||o===1}function hasScale({scale:o,scaleX:i,scaleY:_}){return!isIdentityScale(o)||!isIdentityScale(i)||!isIdentityScale(_)}function hasTransform(o){return hasScale(o)||has2DTranslate(o)||o.z||o.rotate||o.rotateX||o.rotateY||o.skewX||o.skewY}function has2DTranslate(o){return is2DTranslate(o.x)||is2DTranslate(o.y)}function is2DTranslate(o){return o&&o!=="0%"}function scalePoint(o,i,_){const $=o-_,j=i*$;return _+j}function applyPointDelta(o,i,_,$,j){return j!==void 0&&(o=scalePoint(o,j,$)),scalePoint(o,_,$)+i}function applyAxisDelta(o,i=0,_=1,$,j){o.min=applyPointDelta(o.min,i,_,$,j),o.max=applyPointDelta(o.max,i,_,$,j)}function applyBoxDelta(o,{x:i,y:_}){applyAxisDelta(o.x,i.translate,i.scale,i.originPoint),applyAxisDelta(o.y,_.translate,_.scale,_.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(o,i,_,$=!1){const j=_.length;if(!j)return;i.x=i.y=1;let _e,et;for(let tt=0;tt<j;tt++){_e=_[tt],et=_e.projectionDelta;const{visualElement:rt}=_e.options;rt&&rt.props.style&&rt.props.style.display==="contents"||($&&_e.options.layoutScroll&&_e.scroll&&_e!==_e.root&&transformBox(o,{x:-_e.scroll.offset.x,y:-_e.scroll.offset.y}),et&&(i.x*=et.x.scale,i.y*=et.y.scale,applyBoxDelta(o,et)),$&&hasTransform(_e.latestValues)&&transformBox(o,_e.latestValues))}i.x<TREE_SCALE_SNAP_MAX&&i.x>TREE_SCALE_SNAP_MIN&&(i.x=1),i.y<TREE_SCALE_SNAP_MAX&&i.y>TREE_SCALE_SNAP_MIN&&(i.y=1)}function translateAxis(o,i){o.min=o.min+i,o.max=o.max+i}function transformAxis(o,i,_,$,j=.5){const _e=mixNumber$1(o.min,o.max,j);applyAxisDelta(o,i,_,_e,$)}function transformBox(o,i){transformAxis(o.x,i.x,i.scaleX,i.scale,i.originX),transformAxis(o.y,i.y,i.scaleY,i.scale,i.originY)}function measureViewportBox(o,i){return convertBoundingBoxToBox(transformBoxPoints(o.getBoundingClientRect(),i))}function measurePageBox(o,i,_){const $=measureViewportBox(o,_),{scroll:j}=i;return j&&(translateAxis($.x,j.offset.x),translateAxis($.y,j.offset.y)),$}const getContextWindow=({current:o})=>o?o.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(i){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=i}start(i,{snapToCursor:_=!1}={}){const{presenceContext:$}=this.visualElement;if($&&$.isPresent===!1)return;const j=it=>{const{dragSnapToOrigin:st}=this.getProps();st?this.pauseAnimation():this.stopAnimation(),_&&this.snapToCursor(extractEventInfo(it).point)},_e=(it,st)=>{const{drag:at,dragPropagation:ot,onDragStart:lt}=this.getProps();if(at&&!ot&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(at),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(ft=>{let ut=this.getAxisMotionValue(ft).get()||0;if(percent.test(ut)){const{projection:ht}=this.visualElement;if(ht&&ht.layout){const dt=ht.layout.layoutBox[ft];dt&&(ut=calcLength(dt)*(parseFloat(ut)/100))}}this.originPoint[ft]=ut}),lt&&frame.postRender(()=>lt(it,st)),addValueToWillChange(this.visualElement,"transform");const{animationState:ct}=this.visualElement;ct&&ct.setActive("whileDrag",!0)},et=(it,st)=>{const{dragPropagation:at,dragDirectionLock:ot,onDirectionLock:lt,onDrag:ct}=this.getProps();if(!at&&!this.openDragLock)return;const{offset:ft}=st;if(ot&&this.currentDirection===null){this.currentDirection=getCurrentDirection(ft),this.currentDirection!==null&&lt&&lt(this.currentDirection);return}this.updateAxis("x",st.point,ft),this.updateAxis("y",st.point,ft),this.visualElement.render(),ct&&ct(it,st)},tt=(it,st)=>this.stop(it,st),rt=()=>eachAxis(it=>{var st;return this.getAnimationState(it)==="paused"&&((st=this.getAxisMotionValue(it).animation)===null||st===void 0?void 0:st.play())}),{dragSnapToOrigin:nt}=this.getProps();this.panSession=new PanSession(i,{onSessionStart:j,onStart:_e,onMove:et,onSessionEnd:tt,resumeAnimation:rt},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:nt,contextWindow:getContextWindow(this.visualElement)})}stop(i,_){const $=this.isDragging;if(this.cancel(),!$)return;const{velocity:j}=_;this.startAnimation(j);const{onDragEnd:_e}=this.getProps();_e&&frame.postRender(()=>_e(i,_))}cancel(){this.isDragging=!1;const{projection:i,animationState:_}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:$}=this.getProps();!$&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),_&&_.setActive("whileDrag",!1)}updateAxis(i,_,$){const{drag:j}=this.getProps();if(!$||!shouldDrag(i,j,this.currentDirection))return;const _e=this.getAxisMotionValue(i);let et=this.originPoint[i]+$[i];this.constraints&&this.constraints[i]&&(et=applyConstraints(et,this.constraints[i],this.elastic[i])),_e.set(et)}resolveConstraints(){var i;const{dragConstraints:_,dragElastic:$}=this.getProps(),j=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)===null||i===void 0?void 0:i.layout,_e=this.constraints;_&&isRefObject(_)?this.constraints||(this.constraints=this.resolveRefConstraints()):_&&j?this.constraints=calcRelativeConstraints(j.layoutBox,_):this.constraints=!1,this.elastic=resolveDragElastic($),_e!==this.constraints&&j&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(et=>{this.constraints!==!1&&this.getAxisMotionValue(et)&&(this.constraints[et]=rebaseAxisConstraints(j.layoutBox[et],this.constraints[et]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:_}=this.getProps();if(!i||!isRefObject(i))return!1;const $=i.current,{projection:j}=this.visualElement;if(!j||!j.layout)return!1;const _e=measurePageBox($,j.root,this.visualElement.getTransformPagePoint());let et=calcViewportConstraints(j.layout.layoutBox,_e);if(_){const tt=_(convertBoxToBoundingBox(et));this.hasMutatedConstraints=!!tt,tt&&(et=convertBoundingBoxToBox(tt))}return et}startAnimation(i){const{drag:_,dragMomentum:$,dragElastic:j,dragTransition:_e,dragSnapToOrigin:et,onDragTransitionEnd:tt}=this.getProps(),rt=this.constraints||{},nt=eachAxis(it=>{if(!shouldDrag(it,_,this.currentDirection))return;let st=rt&&rt[it]||{};et&&(st={min:0,max:0});const at=j?200:1e6,ot=j?40:1e7,lt={type:"inertia",velocity:$?i[it]:0,bounceStiffness:at,bounceDamping:ot,timeConstant:750,restDelta:1,restSpeed:10,..._e,...st};return this.startAxisValueAnimation(it,lt)});return Promise.all(nt).then(tt)}startAxisValueAnimation(i,_){const $=this.getAxisMotionValue(i);return addValueToWillChange(this.visualElement,i),$.start(animateMotionValue(i,$,0,_,this.visualElement,!1))}stopAnimation(){eachAxis(i=>this.getAxisMotionValue(i).stop())}pauseAnimation(){eachAxis(i=>{var _;return(_=this.getAxisMotionValue(i).animation)===null||_===void 0?void 0:_.pause()})}getAnimationState(i){var _;return(_=this.getAxisMotionValue(i).animation)===null||_===void 0?void 0:_.state}getAxisMotionValue(i){const _=`_drag${i.toUpperCase()}`,$=this.visualElement.getProps(),j=$[_];return j||this.visualElement.getValue(i,($.initial?$.initial[i]:void 0)||0)}snapToCursor(i){eachAxis(_=>{const{drag:$}=this.getProps();if(!shouldDrag(_,$,this.currentDirection))return;const{projection:j}=this.visualElement,_e=this.getAxisMotionValue(_);if(j&&j.layout){const{min:et,max:tt}=j.layout.layoutBox[_];_e.set(i[_]-mixNumber$1(et,tt,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:_}=this.getProps(),{projection:$}=this.visualElement;if(!isRefObject(_)||!$||!this.constraints)return;this.stopAnimation();const j={x:0,y:0};eachAxis(et=>{const tt=this.getAxisMotionValue(et);if(tt&&this.constraints!==!1){const rt=tt.get();j[et]=calcOrigin({min:rt,max:rt},this.constraints[et])}});const{transformTemplate:_e}=this.visualElement.getProps();this.visualElement.current.style.transform=_e?_e({},""):"none",$.root&&$.root.updateScroll(),$.updateLayout(),this.resolveConstraints(),eachAxis(et=>{if(!shouldDrag(et,i,null))return;const tt=this.getAxisMotionValue(et),{min:rt,max:nt}=this.constraints[et];tt.set(mixNumber$1(rt,nt,j[et]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const i=this.visualElement.current,_=addPointerEvent(i,"pointerdown",rt=>{const{drag:nt,dragListener:it=!0}=this.getProps();nt&&it&&this.start(rt)}),$=()=>{const{dragConstraints:rt}=this.getProps();isRefObject(rt)&&rt.current&&(this.constraints=this.resolveRefConstraints())},{projection:j}=this.visualElement,_e=j.addEventListener("measure",$);j&&!j.layout&&(j.root&&j.root.updateScroll(),j.updateLayout()),frame.read($);const et=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),tt=j.addEventListener("didUpdate",({delta:rt,hasLayoutChanged:nt})=>{this.isDragging&&nt&&(eachAxis(it=>{const st=this.getAxisMotionValue(it);st&&(this.originPoint[it]+=rt[it].translate,st.set(st.get()+rt[it].translate))}),this.visualElement.render())});return()=>{et(),_(),_e(),tt&&tt()}}getProps(){const i=this.visualElement.getProps(),{drag:_=!1,dragDirectionLock:$=!1,dragPropagation:j=!1,dragConstraints:_e=!1,dragElastic:et=defaultElastic,dragMomentum:tt=!0}=i;return{...i,drag:_,dragDirectionLock:$,dragPropagation:j,dragConstraints:_e,dragElastic:et,dragMomentum:tt}}}function shouldDrag(o,i,_){return(i===!0||i===o)&&(_===null||_===o)}function getCurrentDirection(o,i=10){let _=null;return Math.abs(o.y)>i?_="y":Math.abs(o.x)>i&&(_="x"),_}class DragGesture extends Feature{constructor(i){super(i),this.removeGroupControls=noop$7,this.removeListeners=noop$7,this.controls=new VisualElementDragControls(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$7}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=o=>(i,_)=>{o&&frame.postRender(()=>o(i,_))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$7}onPointerDown(i){this.session=new PanSession(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:_,onPan:$,onPanEnd:j}=this.node.getProps();return{onSessionStart:asyncHandler(i),onStart:asyncHandler(_),onMove:$,onEnd:(_e,et)=>{delete this.session,j&&frame.postRender(()=>j(_e,et))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(o,i){return i.max===i.min?0:o/(i.max-i.min)*100}const correctBorderRadius={correct:(o,i)=>{if(!i.target)return o;if(typeof o=="string")if(px.test(o))o=parseFloat(o);else return o;const _=pixelsToPercent(o,i.target.x),$=pixelsToPercent(o,i.target.y);return`${_}% ${$}%`}},correctBoxShadow={correct:(o,{treeScale:i,projectionDelta:_})=>{const $=o,j=complex.parse(o);if(j.length>5)return $;const _e=complex.createTransformer(o),et=typeof j[0]!="number"?1:0,tt=_.x.scale*i.x,rt=_.y.scale*i.y;j[0+et]/=tt,j[1+et]/=rt;const nt=mixNumber$1(tt,rt,.5);return typeof j[2+et]=="number"&&(j[2+et]/=nt),typeof j[3+et]=="number"&&(j[3+et]/=nt),_e(j)}};class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:i,layoutGroup:_,switchLayoutGroup:$,layoutId:j}=this.props,{projection:_e}=i;addScaleCorrector(defaultScaleCorrectors),_e&&(_.group&&_.group.add(_e),$&&$.register&&j&&$.register(_e),_e.root.didUpdate(),_e.addEventListener("animationComplete",()=>{this.safeToRemove()}),_e.setOptions({..._e.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:_,visualElement:$,drag:j,isPresent:_e}=this.props,et=$.projection;return et&&(et.isPresent=_e,j||i.layoutDependency!==_||_===void 0?et.willUpdate():this.safeToRemove(),i.isPresent!==_e&&(_e?et.promote():et.relegate()||frame.postRender(()=>{const tt=et.getStack();(!tt||!tt.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),microtask.postRender(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:_,switchLayoutGroup:$}=this.props,{projection:j}=i;j&&(j.scheduleCheckAfterUnmount(),_&&_.group&&_.group.remove(j),$&&$.deregister&&$.deregister(j))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function MeasureLayout(o){const[i,_]=usePresence(),$=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...o,layoutGroup:$,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:i,safeToRemove:_})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(o,i,_){const $=isMotionValue(o)?o:motionValue(o);return $.start(animateMotionValue("",$,i,_)),$.animation}function isSVGElement(o){return o instanceof SVGElement&&o.tagName!=="svg"}const compareByDepth=(o,i)=>o.depth-i.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(i){addUniqueItem(this.children,i),this.isDirty=!0}remove(i){removeItem(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(i)}}function delay(o,i){const _=time$1.now(),$=({timestamp:j})=>{const _e=j-_;_e>=i&&(cancelFrame($),o(_e-i))};return frame.read($,!0),()=>cancelFrame($)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=o=>typeof o=="string"?parseFloat(o):o,isPx=o=>typeof o=="number"||px.test(o);function mixValues(o,i,_,$,j,_e){j?(o.opacity=mixNumber$1(0,_.opacity!==void 0?_.opacity:1,easeCrossfadeIn($)),o.opacityExit=mixNumber$1(i.opacity!==void 0?i.opacity:1,0,easeCrossfadeOut($))):_e&&(o.opacity=mixNumber$1(i.opacity!==void 0?i.opacity:1,_.opacity!==void 0?_.opacity:1,$));for(let et=0;et<numBorders;et++){const tt=`border${borders[et]}Radius`;let rt=getRadius(i,tt),nt=getRadius(_,tt);if(rt===void 0&&nt===void 0)continue;rt||(rt=0),nt||(nt=0),rt===0||nt===0||isPx(rt)===isPx(nt)?(o[tt]=Math.max(mixNumber$1(asNumber(rt),asNumber(nt),$),0),(percent.test(nt)||percent.test(rt))&&(o[tt]+="%")):o[tt]=nt}(i.rotate||_.rotate)&&(o.rotate=mixNumber$1(i.rotate||0,_.rotate||0,$))}function getRadius(o,i){return o[i]!==void 0?o[i]:o.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$7);function compress(o,i,_){return $=>$<o?0:$>i?1:_(progress$2(o,i,$))}function copyAxisInto(o,i){o.min=i.min,o.max=i.max}function copyBoxInto(o,i){copyAxisInto(o.x,i.x),copyAxisInto(o.y,i.y)}function copyAxisDeltaInto(o,i){o.translate=i.translate,o.scale=i.scale,o.originPoint=i.originPoint,o.origin=i.origin}function removePointDelta(o,i,_,$,j){return o-=i,o=scalePoint(o,1/_,$),j!==void 0&&(o=scalePoint(o,1/j,$)),o}function removeAxisDelta(o,i=0,_=1,$=.5,j,_e=o,et=o){if(percent.test(i)&&(i=parseFloat(i),i=mixNumber$1(et.min,et.max,i/100)-et.min),typeof i!="number")return;let tt=mixNumber$1(_e.min,_e.max,$);o===_e&&(tt-=i),o.min=removePointDelta(o.min,i,_,tt,j),o.max=removePointDelta(o.max,i,_,tt,j)}function removeAxisTransforms(o,i,[_,$,j],_e,et){removeAxisDelta(o,i[_],i[$],i[j],i.scale,_e,et)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(o,i,_,$){removeAxisTransforms(o.x,i,xKeys,_?_.x:void 0,$?$.x:void 0),removeAxisTransforms(o.y,i,yKeys,_?_.y:void 0,$?$.y:void 0)}function isAxisDeltaZero(o){return o.translate===0&&o.scale===1}function isDeltaZero(o){return isAxisDeltaZero(o.x)&&isAxisDeltaZero(o.y)}function axisEquals(o,i){return o.min===i.min&&o.max===i.max}function boxEquals(o,i){return axisEquals(o.x,i.x)&&axisEquals(o.y,i.y)}function axisEqualsRounded(o,i){return Math.round(o.min)===Math.round(i.min)&&Math.round(o.max)===Math.round(i.max)}function boxEqualsRounded(o,i){return axisEqualsRounded(o.x,i.x)&&axisEqualsRounded(o.y,i.y)}function aspectRatio(o){return calcLength(o.x)/calcLength(o.y)}function axisDeltaEquals(o,i){return o.translate===i.translate&&o.scale===i.scale&&o.originPoint===i.originPoint}class NodeStack{constructor(){this.members=[]}add(i){addUniqueItem(this.members,i),i.scheduleRender()}remove(i){if(removeItem(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const _=this.members[this.members.length-1];_&&this.promote(_)}}relegate(i){const _=this.members.findIndex(j=>i===j);if(_===0)return!1;let $;for(let j=_;j>=0;j--){const _e=this.members[j];if(_e.isPresent!==!1){$=_e;break}}return $?(this.promote($),!0):!1}promote(i,_){const $=this.lead;if(i!==$&&(this.prevLead=$,this.lead=i,i.show(),$)){$.instance&&$.scheduleRender(),i.scheduleRender(),i.resumeFrom=$,_&&(i.resumeFrom.preserveOpacity=!0),$.snapshot&&(i.snapshot=$.snapshot,i.snapshot.latestValues=$.animationValues||$.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0);const{crossfade:j}=i.options;j===!1&&$.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:_,resumingFrom:$}=i;_.onExitComplete&&_.onExitComplete(),$&&$.options.onExitComplete&&$.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(o,i,_){let $="";const j=o.x.translate/i.x,_e=o.y.translate/i.y,et=(_==null?void 0:_.z)||0;if((j||_e||et)&&($=`translate3d(${j}px, ${_e}px, ${et}px) `),(i.x!==1||i.y!==1)&&($+=`scale(${1/i.x}, ${1/i.y}) `),_){const{transformPerspective:nt,rotate:it,rotateX:st,rotateY:at,skewX:ot,skewY:lt}=_;nt&&($=`perspective(${nt}px) ${$}`),it&&($+=`rotate(${it}deg) `),st&&($+=`rotateX(${st}deg) `),at&&($+=`rotateY(${at}deg) `),ot&&($+=`skewX(${ot}deg) `),lt&&($+=`skewY(${lt}deg) `)}const tt=o.x.scale*i.x,rt=o.y.scale*i.y;return(tt!==1||rt!==1)&&($+=`scale(${tt}, ${rt})`),$||"none"}const metrics={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},isDebug=typeof window<"u"&&window.MotionDebug!==void 0,transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;function resetDistortingTransform(o,i,_,$){const{latestValues:j}=i;j[o]&&(_[o]=j[o],i.setStaticValue(o,0),$&&($[o]=0))}function cancelTreeOptimisedTransformAnimations(o){if(o.hasCheckedOptimisedAppear=!0,o.root===o)return;const{visualElement:i}=o.options;if(!i)return;const _=getOptimisedAppearId(i);if(window.MotionHasOptimisedAnimation(_,"transform")){const{layout:j,layoutId:_e}=o.options;window.MotionCancelOptimisedAnimation(_,"transform",frame,!(j||_e))}const{parent:$}=o;$&&!$.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations($)}function createProjectionNode({attachResizeListener:o,defaultParent:i,measureScroll:_,checkIsScrollRoot:$,resetTransform:j}){return class{constructor(et={},tt=i==null?void 0:i()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,isDebug&&(metrics.totalNodes=metrics.resolvedTargetDeltas=metrics.recalculatedProjection=0),this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),isDebug&&window.MotionDebug.record(metrics)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=et,this.root=tt?tt.root||tt:this,this.path=tt?[...tt.path,tt]:[],this.parent=tt,this.depth=tt?tt.depth+1:0;for(let rt=0;rt<this.path.length;rt++)this.path[rt].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(et,tt){return this.eventHandlers.has(et)||this.eventHandlers.set(et,new SubscriptionManager),this.eventHandlers.get(et).add(tt)}notifyListeners(et,...tt){const rt=this.eventHandlers.get(et);rt&&rt.notify(...tt)}hasListeners(et){return this.eventHandlers.has(et)}mount(et,tt=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(et),this.instance=et;const{layoutId:rt,layout:nt,visualElement:it}=this.options;if(it&&!it.current&&it.mount(et),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),tt&&(nt||rt)&&(this.isLayoutDirty=!0),o){let st;const at=()=>this.root.updateBlockedByResize=!1;o(et,()=>{this.root.updateBlockedByResize=!0,st&&st(),st=delay(at,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}rt&&this.root.registerSharedNode(rt,this),this.options.animate!==!1&&it&&(rt||nt)&&this.addEventListener("didUpdate",({delta:st,hasLayoutChanged:at,hasRelativeTargetChanged:ot,layout:lt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const ct=this.options.transition||it.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:ft,onLayoutAnimationComplete:ut}=it.getProps(),ht=!this.targetLayout||!boxEqualsRounded(this.targetLayout,lt)||ot,dt=!at&&ot;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||dt||at&&(ht||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(st,dt);const mt={...getValueTransition(ct,"layout"),onPlay:ft,onComplete:ut};(it.shouldReduceMotion||this.options.layoutRoot)&&(mt.delay=0,mt.type=!1),this.startAnimation(mt)}else at||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=lt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const et=this.getStack();et&&et.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:et}=this.options;return et&&et.getProps().transformTemplate}willUpdate(et=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let it=0;it<this.path.length;it++){const st=this.path[it];st.shouldResetTransform=!0,st.updateScroll("snapshot"),st.options.layoutRoot&&st.willUpdate(!1)}const{layoutId:tt,layout:rt}=this.options;if(tt===void 0&&!rt)return;const nt=this.getTransformTemplate();this.prevTransformTemplateValue=nt?nt(this.latestValues,""):void 0,this.updateSnapshot(),et&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const tt=time$1.now();frameData.delta=clamp(0,1e3/60,tt-frameData.timestamp),frameData.timestamp=tt,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let rt=0;rt<this.path.length;rt++)this.path[rt].updateScroll();const et=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:tt}=this.options;tt&&tt.notify("LayoutMeasure",this.layout.layoutBox,et?et.layoutBox:void 0)}updateScroll(et="measure"){let tt=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===et&&(tt=!1),tt){const rt=$(this.instance);this.scroll={animationId:this.root.animationId,phase:et,isRoot:rt,offset:_(this.instance),wasRoot:this.scroll?this.scroll.isRoot:rt}}}resetTransform(){if(!j)return;const et=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,tt=this.projectionDelta&&!isDeltaZero(this.projectionDelta),rt=this.getTransformTemplate(),nt=rt?rt(this.latestValues,""):void 0,it=nt!==this.prevTransformTemplateValue;et&&(tt||hasTransform(this.latestValues)||it)&&(j(this.instance,nt),this.shouldResetTransform=!1,this.scheduleRender())}measure(et=!0){const tt=this.measurePageBox();let rt=this.removeElementScroll(tt);return et&&(rt=this.removeTransform(rt)),roundBox(rt),{animationId:this.root.animationId,measuredBox:tt,layoutBox:rt,latestValues:{},source:this.id}}measurePageBox(){var et;const{visualElement:tt}=this.options;if(!tt)return createBox();const rt=tt.measureViewportBox();if(!(((et=this.scroll)===null||et===void 0?void 0:et.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:it}=this.root;it&&(translateAxis(rt.x,it.offset.x),translateAxis(rt.y,it.offset.y))}return rt}removeElementScroll(et){var tt;const rt=createBox();if(copyBoxInto(rt,et),!((tt=this.scroll)===null||tt===void 0)&&tt.wasRoot)return rt;for(let nt=0;nt<this.path.length;nt++){const it=this.path[nt],{scroll:st,options:at}=it;it!==this.root&&st&&at.layoutScroll&&(st.wasRoot&&copyBoxInto(rt,et),translateAxis(rt.x,st.offset.x),translateAxis(rt.y,st.offset.y))}return rt}applyTransform(et,tt=!1){const rt=createBox();copyBoxInto(rt,et);for(let nt=0;nt<this.path.length;nt++){const it=this.path[nt];!tt&&it.options.layoutScroll&&it.scroll&&it!==it.root&&transformBox(rt,{x:-it.scroll.offset.x,y:-it.scroll.offset.y}),hasTransform(it.latestValues)&&transformBox(rt,it.latestValues)}return hasTransform(this.latestValues)&&transformBox(rt,this.latestValues),rt}removeTransform(et){const tt=createBox();copyBoxInto(tt,et);for(let rt=0;rt<this.path.length;rt++){const nt=this.path[rt];if(!nt.instance||!hasTransform(nt.latestValues))continue;hasScale(nt.latestValues)&&nt.updateSnapshot();const it=createBox(),st=nt.measurePageBox();copyBoxInto(it,st),removeBoxTransforms(tt,nt.latestValues,nt.snapshot?nt.snapshot.layoutBox:void 0,it)}return hasTransform(this.latestValues)&&removeBoxTransforms(tt,this.latestValues),tt}setTargetDelta(et){this.targetDelta=et,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(et){this.options={...this.options,...et,crossfade:et.crossfade!==void 0?et.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(et=!1){var tt;const rt=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=rt.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=rt.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=rt.isSharedProjectionDirty);const nt=!!this.resumingFrom||this!==rt;if(!(et||nt&&this.isSharedProjectionDirty||this.isProjectionDirty||!((tt=this.parent)===null||tt===void 0)&&tt.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:st,layoutId:at}=this.options;if(!(!this.layout||!(st||at))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const ot=this.getClosestProjectingParent();ot&&ot.layout&&this.animationProgress!==1?(this.relativeParent=ot,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,ot.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const ot=this.getClosestProjectingParent();ot&&!!ot.resumingFrom==!!this.resumingFrom&&!ot.options.layoutScroll&&ot.target&&this.animationProgress!==1?(this.relativeParent=ot,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,ot.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}isDebug&&metrics.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var et;const tt=this.getLead(),rt=!!this.resumingFrom||this!==tt;let nt=!0;if((this.isProjectionDirty||!((et=this.parent)===null||et===void 0)&&et.isProjectionDirty)&&(nt=!1),rt&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(nt=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(nt=!1),nt)return;const{layout:it,layoutId:st}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(it||st))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const at=this.treeScale.x,ot=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,rt),tt.layout&&!tt.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(tt.target=tt.layout.layoutBox,tt.targetWithTransforms=createBox());const{target:lt}=tt;if(!lt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,lt,this.latestValues),(this.treeScale.x!==at||this.treeScale.y!==ot||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",lt)),isDebug&&metrics.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(et=!0){var tt;if((tt=this.options.visualElement)===null||tt===void 0||tt.scheduleRender(),et){const rt=this.getStack();rt&&rt.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(et,tt=!1){const rt=this.snapshot,nt=rt?rt.latestValues:{},it={...this.latestValues},st=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!tt;const at=createBox(),ot=rt?rt.source:void 0,lt=this.layout?this.layout.source:void 0,ct=ot!==lt,ft=this.getStack(),ut=!ft||ft.members.length<=1,ht=!!(ct&&!ut&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let dt;this.mixTargetDelta=mt=>{const pt=mt/1e3;mixAxisDelta(st.x,et.x,pt),mixAxisDelta(st.y,et.y,pt),this.setTargetDelta(st),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(at,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,at,pt),dt&&boxEquals(this.relativeTarget,dt)&&(this.isProjectionDirty=!1),dt||(dt=createBox()),copyBoxInto(dt,this.relativeTarget)),ct&&(this.animationValues=it,mixValues(it,nt,this.latestValues,pt,ht,ut)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=pt},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(et){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...et,onUpdate:tt=>{this.mixTargetDelta(tt),et.onUpdate&&et.onUpdate(tt)},onComplete:()=>{et.onComplete&&et.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const et=this.getStack();et&&et.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const et=this.getLead();let{targetWithTransforms:tt,target:rt,layout:nt,latestValues:it}=et;if(!(!tt||!rt||!nt)){if(this!==et&&this.layout&&nt&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,nt.layoutBox)){rt=this.target||createBox();const st=calcLength(this.layout.layoutBox.x);rt.x.min=et.target.x.min,rt.x.max=rt.x.min+st;const at=calcLength(this.layout.layoutBox.y);rt.y.min=et.target.y.min,rt.y.max=rt.y.min+at}copyBoxInto(tt,rt),transformBox(tt,it),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,tt,it)}}registerSharedNode(et,tt){this.sharedNodes.has(et)||this.sharedNodes.set(et,new NodeStack),this.sharedNodes.get(et).add(tt);const nt=tt.options.initialPromotionConfig;tt.promote({transition:nt?nt.transition:void 0,preserveFollowOpacity:nt&&nt.shouldPreserveFollowOpacity?nt.shouldPreserveFollowOpacity(tt):void 0})}isLead(){const et=this.getStack();return et?et.lead===this:!0}getLead(){var et;const{layoutId:tt}=this.options;return tt?((et=this.getStack())===null||et===void 0?void 0:et.lead)||this:this}getPrevLead(){var et;const{layoutId:tt}=this.options;return tt?(et=this.getStack())===null||et===void 0?void 0:et.prevLead:void 0}getStack(){const{layoutId:et}=this.options;if(et)return this.root.sharedNodes.get(et)}promote({needsReset:et,transition:tt,preserveFollowOpacity:rt}={}){const nt=this.getStack();nt&&nt.promote(this,rt),et&&(this.projectionDelta=void 0,this.needsReset=!0),tt&&this.setOptions({transition:tt})}relegate(){const et=this.getStack();return et?et.relegate(this):!1}resetSkewAndRotation(){const{visualElement:et}=this.options;if(!et)return;let tt=!1;const{latestValues:rt}=et;if((rt.z||rt.rotate||rt.rotateX||rt.rotateY||rt.rotateZ||rt.skewX||rt.skewY)&&(tt=!0),!tt)return;const nt={};rt.z&&resetDistortingTransform("z",et,nt,this.animationValues);for(let it=0;it<transformAxes.length;it++)resetDistortingTransform(`rotate${transformAxes[it]}`,et,nt,this.animationValues),resetDistortingTransform(`skew${transformAxes[it]}`,et,nt,this.animationValues);et.render();for(const it in nt)et.setStaticValue(it,nt[it]),this.animationValues&&(this.animationValues[it]=nt[it]);et.scheduleRender()}getProjectionStyles(et){var tt,rt;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const nt={visibility:""},it=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,nt.opacity="",nt.pointerEvents=resolveMotionValue(et==null?void 0:et.pointerEvents)||"",nt.transform=it?it(this.latestValues,""):"none",nt;const st=this.getLead();if(!this.projectionDelta||!this.layout||!st.target){const ct={};return this.options.layoutId&&(ct.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,ct.pointerEvents=resolveMotionValue(et==null?void 0:et.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(ct.transform=it?it({},""):"none",this.hasProjected=!1),ct}const at=st.animationValues||st.latestValues;this.applyTransformsToTarget(),nt.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,at),it&&(nt.transform=it(at,nt.transform));const{x:ot,y:lt}=this.projectionDelta;nt.transformOrigin=`${ot.origin*100}% ${lt.origin*100}% 0`,st.animationValues?nt.opacity=st===this?(rt=(tt=at.opacity)!==null&&tt!==void 0?tt:this.latestValues.opacity)!==null&&rt!==void 0?rt:1:this.preserveOpacity?this.latestValues.opacity:at.opacityExit:nt.opacity=st===this?at.opacity!==void 0?at.opacity:"":at.opacityExit!==void 0?at.opacityExit:0;for(const ct in scaleCorrectors){if(at[ct]===void 0)continue;const{correct:ft,applyTo:ut}=scaleCorrectors[ct],ht=nt.transform==="none"?at[ct]:ft(at[ct],st);if(ut){const dt=ut.length;for(let mt=0;mt<dt;mt++)nt[ut[mt]]=ht}else nt[ct]=ht}return this.options.layoutId&&(nt.pointerEvents=st===this?resolveMotionValue(et==null?void 0:et.pointerEvents)||"":"none"),nt}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(et=>{var tt;return(tt=et.currentAnimation)===null||tt===void 0?void 0:tt.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(o){o.updateLayout()}function notifyLayoutUpdate(o){var i;const _=((i=o.resumeFrom)===null||i===void 0?void 0:i.snapshot)||o.snapshot;if(o.isLead()&&o.layout&&_&&o.hasListeners("didUpdate")){const{layoutBox:$,measuredBox:j}=o.layout,{animationType:_e}=o.options,et=_.source!==o.layout.source;_e==="size"?eachAxis(st=>{const at=et?_.measuredBox[st]:_.layoutBox[st],ot=calcLength(at);at.min=$[st].min,at.max=at.min+ot}):shouldAnimatePositionOnly(_e,_.layoutBox,$)&&eachAxis(st=>{const at=et?_.measuredBox[st]:_.layoutBox[st],ot=calcLength($[st]);at.max=at.min+ot,o.relativeTarget&&!o.currentAnimation&&(o.isProjectionDirty=!0,o.relativeTarget[st].max=o.relativeTarget[st].min+ot)});const tt=createDelta();calcBoxDelta(tt,$,_.layoutBox);const rt=createDelta();et?calcBoxDelta(rt,o.applyTransform(j,!0),_.measuredBox):calcBoxDelta(rt,$,_.layoutBox);const nt=!isDeltaZero(tt);let it=!1;if(!o.resumeFrom){const st=o.getClosestProjectingParent();if(st&&!st.resumeFrom){const{snapshot:at,layout:ot}=st;if(at&&ot){const lt=createBox();calcRelativePosition(lt,_.layoutBox,at.layoutBox);const ct=createBox();calcRelativePosition(ct,$,ot.layoutBox),boxEqualsRounded(lt,ct)||(it=!0),st.options.layoutRoot&&(o.relativeTarget=ct,o.relativeTargetOrigin=lt,o.relativeParent=st)}}}o.notifyListeners("didUpdate",{layout:$,snapshot:_,delta:rt,layoutDelta:tt,hasLayoutChanged:nt,hasRelativeTargetChanged:it})}else if(o.isLead()){const{onExitComplete:$}=o.options;$&&$()}o.options.transition=void 0}function propagateDirtyNodes(o){isDebug&&metrics.totalNodes++,o.parent&&(o.isProjecting()||(o.isProjectionDirty=o.parent.isProjectionDirty),o.isSharedProjectionDirty||(o.isSharedProjectionDirty=!!(o.isProjectionDirty||o.parent.isProjectionDirty||o.parent.isSharedProjectionDirty)),o.isTransformDirty||(o.isTransformDirty=o.parent.isTransformDirty))}function cleanDirtyNodes(o){o.isProjectionDirty=o.isSharedProjectionDirty=o.isTransformDirty=!1}function clearSnapshot(o){o.clearSnapshot()}function clearMeasurements(o){o.clearMeasurements()}function clearIsLayoutDirty(o){o.isLayoutDirty=!1}function resetTransformStyle(o){const{visualElement:i}=o.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),o.resetTransform()}function finishAnimation(o){o.finishAnimation(),o.targetDelta=o.relativeTarget=o.target=void 0,o.isProjectionDirty=!0}function resolveTargetDelta(o){o.resolveTargetDelta()}function calcProjection(o){o.calcProjection()}function resetSkewAndRotation(o){o.resetSkewAndRotation()}function removeLeadSnapshots(o){o.removeLeadSnapshot()}function mixAxisDelta(o,i,_){o.translate=mixNumber$1(i.translate,0,_),o.scale=mixNumber$1(i.scale,1,_),o.origin=i.origin,o.originPoint=i.originPoint}function mixAxis(o,i,_,$){o.min=mixNumber$1(i.min,_.min,$),o.max=mixNumber$1(i.max,_.max,$)}function mixBox(o,i,_,$){mixAxis(o.x,i.x,_.x,$),mixAxis(o.y,i.y,_.y,$)}function hasOpacityCrossfade(o){return o.animationValues&&o.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=o=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(o),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$7;function roundAxis(o){o.min=roundPoint(o.min),o.max=roundPoint(o.max)}function roundBox(o){roundAxis(o.x),roundAxis(o.y)}function shouldAnimatePositionOnly(o,i,_){return o==="position"||o==="preserve-aspect"&&!isNear(aspectRatio(i),aspectRatio(_),.2)}function checkNodeWasScrollRoot(o){var i;return o!==o.root&&((i=o.scroll)===null||i===void 0?void 0:i.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(o,i)=>addDomEvent(o,"resize",i),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:o=>({x:o.scrollLeft,y:o.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const o=new DocumentProjectionNode({});o.mount(window),o.setOptions({layoutScroll:!0}),rootProjectionNode.current=o}return rootProjectionNode.current},resetTransform:(o,i)=>{o.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:o=>window.getComputedStyle(o).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(o,i,_){const{props:$}=o;o.animationState&&$.whileHover&&o.animationState.setActive("whileHover",_==="Start");const j="onHover"+_,_e=$[j];_e&&frame.postRender(()=>_e(i,extractEventInfo(i)))}class HoverGesture extends Feature{mount(){const{current:i}=this.node;i&&(this.unmount=hover(i,_=>(handleHoverEvent(this.node,_,"Start"),$=>handleHoverEvent(this.node,$,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(o,i,_){const{props:$}=o;o.animationState&&$.whileTap&&o.animationState.setActive("whileTap",_==="Start");const j="onTap"+(_==="End"?"":_),_e=$[j];_e&&frame.postRender(()=>_e(i,extractEventInfo(i)))}class PressGesture extends Feature{mount(){const{current:i}=this.node;i&&(this.unmount=press(i,_=>(handlePressEvent(this.node,_,"Start"),($,{success:j})=>handlePressEvent(this.node,$,j?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=o=>{const i=observerCallbacks.get(o.target);i&&i(o)},fireAllObserverCallbacks=o=>{o.forEach(fireObserverCallback)};function initIntersectionObserver({root:o,...i}){const _=o||document;observers.has(_)||observers.set(_,{});const $=observers.get(_),j=JSON.stringify(i);return $[j]||($[j]=new IntersectionObserver(fireAllObserverCallbacks,{root:o,...i})),$[j]}function observeIntersection(o,i,_){const $=initIntersectionObserver(i);return observerCallbacks.set(o,_),$.observe(o),()=>{observerCallbacks.delete(o),$.unobserve(o)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:_,margin:$,amount:j="some",once:_e}=i,et={root:_?_.current:void 0,rootMargin:$,threshold:typeof j=="number"?j:thresholdNames[j]},tt=rt=>{const{isIntersecting:nt}=rt;if(this.isInView===nt||(this.isInView=nt,_e&&!nt&&this.hasEnteredView))return;nt&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",nt);const{onViewportEnter:it,onViewportLeave:st}=this.node.getProps(),at=nt?it:st;at&&at(rt)};return observeIntersection(this.node.current,et,tt)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:_}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(i,_))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:o={}},{viewport:i={}}={}){return _=>o[_]!==i[_]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser$2)if(window.matchMedia){const o=window.matchMedia("(prefers-reduced-motion)"),i=()=>prefersReducedMotion.current=o.matches;o.addListener(i),i()}else prefersReducedMotion.current=!1}const valueTypes=[...dimensionValueTypes,color$1,complex],findValueType=o=>valueTypes.find(testValueType(o)),visualElementStore=new WeakMap;function updateMotionValuesFromProps(o,i,_){for(const $ in i){const j=i[$],_e=_[$];if(isMotionValue(j))o.addValue($,j);else if(isMotionValue(_e))o.addValue($,motionValue(j,{owner:o}));else if(_e!==j)if(o.hasValue($)){const et=o.getValue($);et.liveStyle===!0?et.jump(j):et.hasAnimated||et.set(j)}else{const et=o.getStaticValue($);o.addValue($,motionValue(et!==void 0?et:j,{owner:o}))}}for(const $ in _)i[$]===void 0&&o.removeValue($);return i}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(i,_,$){return{}}constructor({parent:i,props:_,presenceContext:$,reducedMotionConfig:j,blockInitialAnimation:_e,visualState:et},tt={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const ot=time$1.now();this.renderScheduledAt<ot&&(this.renderScheduledAt=ot,frame.render(this.render,!1,!0))};const{latestValues:rt,renderState:nt,onUpdate:it}=et;this.onUpdate=it,this.latestValues=rt,this.baseTarget={...rt},this.initialValues=_.initial?{...rt}:{},this.renderState=nt,this.parent=i,this.props=_,this.presenceContext=$,this.depth=i?i.depth+1:0,this.reducedMotionConfig=j,this.options=tt,this.blockInitialAnimation=!!_e,this.isControllingVariants=isControllingVariants(_),this.isVariantNode=isVariantNode(_),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:st,...at}=this.scrapeMotionValuesFromProps(_,{},this);for(const ot in at){const lt=at[ot];rt[ot]!==void 0&&isMotionValue(lt)&&lt.set(rt[ot],!1)}}mount(i){this.current=i,visualElementStore.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((_,$)=>this.bindToMotionValue($,_)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const _=this.features[i];_&&(_.unmount(),_.isMounted=!1)}this.current=null}bindToMotionValue(i,_){this.valueSubscriptions.has(i)&&this.valueSubscriptions.get(i)();const $=transformProps.has(i),j=_.on("change",tt=>{this.latestValues[i]=tt,this.props.onUpdate&&frame.preRender(this.notifyUpdate),$&&this.projection&&(this.projection.isTransformDirty=!0)}),_e=_.on("renderRequest",this.scheduleRender);let et;window.MotionCheckAppearSync&&(et=window.MotionCheckAppearSync(this,i,_)),this.valueSubscriptions.set(i,()=>{j(),_e(),et&&et(),_.owner&&_.stop()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}updateFeatures(){let i="animation";for(i in featureDefinitions){const _=featureDefinitions[i];if(!_)continue;const{isEnabled:$,Feature:j}=_;if(!this.features[i]&&j&&$(this.props)&&(this.features[i]=new j(this)),this.features[i]){const _e=this.features[i];_e.isMounted?_e.update():(_e.mount(),_e.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,_){this.latestValues[i]=_}update(i,_){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=_;for(let $=0;$<propEventHandlers.length;$++){const j=propEventHandlers[$];this.propEventSubscriptions[j]&&(this.propEventSubscriptions[j](),delete this.propEventSubscriptions[j]);const _e="on"+j,et=i[_e];et&&(this.propEventSubscriptions[j]=this.on(j,et))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(i,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(i){const _=this.getClosestVariantNode();if(_)return _.variantChildren&&_.variantChildren.add(i),()=>_.variantChildren.delete(i)}addValue(i,_){const $=this.values.get(i);_!==$&&($&&this.removeValue(i),this.bindToMotionValue(i,_),this.values.set(i,_),this.latestValues[i]=_.get())}removeValue(i){this.values.delete(i);const _=this.valueSubscriptions.get(i);_&&(_(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,_){if(this.props.values&&this.props.values[i])return this.props.values[i];let $=this.values.get(i);return $===void 0&&_!==void 0&&($=motionValue(_===null?void 0:_,{owner:this}),this.addValue(i,$)),$}readValue(i,_){var $;let j=this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:($=this.getBaseTargetFromProps(this.props,i))!==null&&$!==void 0?$:this.readValueFromInstance(this.current,i,this.options);return j!=null&&(typeof j=="string"&&(isNumericalString(j)||isZeroValueString(j))?j=parseFloat(j):!findValueType(j)&&complex.test(_)&&(j=getAnimatableNone(i,_)),this.setBaseTarget(i,isMotionValue(j)?j.get():j)),isMotionValue(j)?j.get():j}setBaseTarget(i,_){this.baseTarget[i]=_}getBaseTarget(i){var _;const{initial:$}=this.props;let j;if(typeof $=="string"||typeof $=="object"){const et=resolveVariantFromProps(this.props,$,(_=this.presenceContext)===null||_===void 0?void 0:_.custom);et&&(j=et[i])}if($&&j!==void 0)return j;const _e=this.getBaseTargetFromProps(this.props,i);return _e!==void 0&&!isMotionValue(_e)?_e:this.initialValues[i]!==void 0&&j===void 0?void 0:this.baseTarget[i]}on(i,_){return this.events[i]||(this.events[i]=new SubscriptionManager),this.events[i].add(_)}notify(i,..._){this.events[i]&&this.events[i].notify(..._)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(i,_){return i.compareDocumentPosition(_)&2?1:-1}getBaseTargetFromProps(i,_){return i.style?i.style[_]:void 0}removeValueFromRenderState(i,{vars:_,style:$}){delete _[i],delete $[i]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;isMotionValue(i)&&(this.childSubscription=i.on("change",_=>{this.current&&(this.current.textContent=`${_}`)}))}}function getComputedStyle$1(o){return window.getComputedStyle(o)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(i,_){if(transformProps.has(_)){const $=getDefaultValueType(_);return $&&$.default||0}else{const $=getComputedStyle$1(i),j=(isCSSVariableName(_)?$.getPropertyValue(_):$[_])||0;return typeof j=="string"?j.trim():j}}measureInstanceViewportBox(i,{transformPagePoint:_}){return measureViewportBox(i,_)}build(i,_,$){buildHTMLStyles(i,_,$.transformTemplate)}scrapeMotionValuesFromProps(i,_,$){return scrapeMotionValuesFromProps$1(i,_,$)}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(i,_){return i[_]}readValueFromInstance(i,_){if(transformProps.has(_)){const $=getDefaultValueType(_);return $&&$.default||0}return _=camelCaseAttributes.has(_)?_:camelToDash(_),i.getAttribute(_)}scrapeMotionValuesFromProps(i,_,$){return scrapeMotionValuesFromProps(i,_,$)}build(i,_,$){buildSVGAttrs(i,_,this.isSVGTag,$.transformTemplate)}renderInstance(i,_,$,j){renderSVG(i,_,$,j)}mount(i){this.isSVGTag=isSVGTag(i.tagName),super.mount(i)}}const createDomVisualElement=(o,i)=>isSVGComponent(o)?new SVGVisualElement(i):new HTMLVisualElement(i,{allowProjection:o!==reactExports.Fragment}),createMotionComponent=createMotionComponentFactory({...animations,...gestureAnimations,...drag,...layout},createDomVisualElement),motion=createDOMMotionComponentProxy(createMotionComponent);function useReducedMotionPref(){const{disableMotion:o}=useSettingsStore(),[i,_]=reactExports.useState(!1);return reactExports.useEffect(()=>{const $=window.matchMedia("(prefers-reduced-motion: reduce)"),j=()=>_($.matches);return j(),$.addEventListener("change",j),()=>$.removeEventListener("change",j)},[]),o||i}function AppLayout(){const{studyMode:o,setTheme:i,theme:_,setLanguage:$,language:j}=useSettingsStore(),_e=useLocation(),[et,tt]=reactExports.useState(!0),rt=useReducedMotionPref();return reactExports.useEffect(()=>{o&&tt(!1)},[o]),reactExports.useEffect(()=>{const nt=it=>{if(it.key.toLowerCase()==="s"){it.preventDefault();const st=document.querySelector('[aria-label="Toggle study mode"]');st==null||st.click()}if(it.key.toLowerCase()==="t"){it.preventDefault();const st=["light","dark","high-contrast"],at=st.indexOf(_);i(st[(at+1)%st.length])}it.key.toLowerCase()==="l"&&(it.preventDefault(),$(j==="ar"?"en":"ar"))};return window.addEventListener("keydown",nt),()=>window.removeEventListener("keydown",nt)},[_,i,j,$]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-bg text-[15px]",children:[jsxRuntimeExports.jsx(Header,{onToggleSidebar:()=>tt(nt=>!nt)}),jsxRuntimeExports.jsxs("div",{className:"mx-auto grid max-w-7xl grid-cols-12 gap-4 p-4",children:[jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,children:!o&&et&&jsxRuntimeExports.jsx(motion.aside,{initial:rt?!1:{opacity:0,x:-12},animate:rt?{opacity:1}:{opacity:1,x:0},exit:rt?{opacity:0}:{opacity:0,x:-12},transition:{duration:.3},className:"col-span-12 md:col-span-3 lg:col-span-2 rounded-xl bg-surface p-3 shadow-soft-warm","aria-label":"Sidebar",children:jsxRuntimeExports.jsx(Nav,{className:"space-y-1"})},"sidebar")}),jsxRuntimeExports.jsxs("main",{className:`${o?"col-span-12":"col-span-12 md:col-span-9 lg:col-span-10"} min-h-[70vh]`,children:[jsxRuntimeExports.jsx(motion.div,{initial:rt?!1:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:rt?0:.4,ease:[.22,1,.36,1]},className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:jsxRuntimeExports.jsx(Outlet,{})},_e.pathname),jsxRuntimeExports.jsx(Footer,{})]})]})]})}function Header({onToggleSidebar:o}){return jsxRuntimeExports.jsx("header",{className:"sticky top-0 z-40 w-full border-b border-border/60 backdrop-blur bg-bg/60",children:jsxRuntimeExports.jsxs("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-4 px-4 py-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:o,"aria-label":"Toggle sidebar",children:""}),jsxRuntimeExports.jsx("div",{className:"text-lg font-semibold",children:"StudyForge"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(LanguageToggle,{}),jsxRuntimeExports.jsx(ThemeToggle,{}),jsxRuntimeExports.jsx(StudyModeToggle,{})]})]})})}function Nav({className:o=""}){const i=[{to:"/",label:""},{to:"/dashboard",label:" "},{to:"/teacher",label:" "},{to:"/settings",label:""}];return jsxRuntimeExports.jsx("nav",{className:o,children:i.map(_=>jsxRuntimeExports.jsx(NavLink,{to:_.to,className:({isActive:$})=>`block rounded-lg px-3 py-2 text-sm transition-colors ${$?"bg-warm-gradient text-primary":"hover:bg-warm-gradient"}`,children:_.label},_.to))})}function Footer(){return jsxRuntimeExports.jsxs("footer",{className:"mt-6 text-xs text-muted",children:[" ",new Date().getFullYear()," StudyForge"]})}function LanguageToggle(){const{language:o,setLanguage:i}=useSettingsStore();return jsxRuntimeExports.jsxs("select",{"aria-label":"Language",className:"btn btn-secondary",value:o,onChange:_=>i(_.target.value),children:[jsxRuntimeExports.jsx("option",{value:"ar",children:"AR"}),jsxRuntimeExports.jsx("option",{value:"en",children:"EN"})]})}function ThemeToggle(){const{theme:o,setTheme:i}=useSettingsStore();return jsxRuntimeExports.jsxs("select",{"aria-label":"Theme",className:"btn btn-secondary",value:o,onChange:_=>i(_.target.value),children:[jsxRuntimeExports.jsx("option",{value:"light",children:"Light"}),jsxRuntimeExports.jsx("option",{value:"dark",children:"Dark"}),jsxRuntimeExports.jsx("option",{value:"high-contrast",children:"High Contrast"})]})}function StudyModeToggle(){const{studyMode:o,toggleStudyMode:i}=useSettingsStore();return jsxRuntimeExports.jsxs("button",{className:"btn btn-primary",onClick:i,"aria-pressed":o,"aria-label":"Toggle study mode",children:[" ",o?"  ":"  "]})}var lottie$1={exports:{}};(function(module,exports){typeof document<"u"&&typeof navigator<"u"&&function(o,i){module.exports=i()}(commonjsGlobal,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(i){_useWebWorker=!!i},getWebWorker=function(){return _useWebWorker},setLocationHref=function(i){locationHref=i},getLocationHref=function(){return locationHref};function createTag(o){return document.createElement(o)}function extendPrototype(o,i){var _,$=o.length,j;for(_=0;_<$;_+=1){j=o[_].prototype;for(var _e in j)Object.prototype.hasOwnProperty.call(j,_e)&&(i.prototype[_e]=j[_e])}}function getDescriptor(o,i){return Object.getOwnPropertyDescriptor(o,i)}function createProxyFunction(o){function i(){}return i.prototype=o,i}var audioControllerFactory=function(){function o(i){this.audios=[],this.audioFactory=i,this._volume=1,this._isMuted=!1}return o.prototype={addAudio:function(_){this.audios.push(_)},pause:function(){var _,$=this.audios.length;for(_=0;_<$;_+=1)this.audios[_].pause()},resume:function(){var _,$=this.audios.length;for(_=0;_<$;_+=1)this.audios[_].resume()},setRate:function(_){var $,j=this.audios.length;for($=0;$<j;$+=1)this.audios[$].setRate(_)},createAudio:function(_){return this.audioFactory?this.audioFactory(_):window.Howl?new window.Howl({src:[_]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(_){this.audioFactory=_},setVolume:function(_){this._volume=_,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var _,$=this.audios.length;for(_=0;_<$;_+=1)this.audios[_].volume(this._volume*(this._isMuted?0:1))}},function(){return new o}}(),createTypedArray=function(){function o(_,$){var j=0,_e=[],et;switch(_){case"int16":case"uint8c":et=1;break;default:et=1.1;break}for(j=0;j<$;j+=1)_e.push(et);return _e}function i(_,$){return _==="float32"?new Float32Array($):_==="int16"?new Int16Array($):_==="uint8c"?new Uint8ClampedArray($):o(_,$)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?i:o}();function createSizedArray(o){return Array.apply(null,{length:o})}function _typeof$6(o){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$6(o)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var o=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],i,_=o.length;for(i=0;i<_;i+=1)BMMath[o[i]]=Math[o[i]]})(),BMMath.random=Math.random,BMMath.abs=function(o){var i=_typeof$6(o);if(i==="object"&&o.length){var _=createSizedArray(o.length),$,j=o.length;for($=0;$<j;$+=1)_[$]=Math.abs(o[$]);return _}return Math.abs(o)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(o){o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.display="block",o.style.transformOrigin="0 0",o.style.webkitTransformOrigin="0 0",o.style.backfaceVisibility="visible",o.style.webkitBackfaceVisibility="visible",o.style.transformStyle="preserve-3d",o.style.webkitTransformStyle="preserve-3d",o.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(o,i,_,$){this.type=o,this.currentTime=i,this.totalTime=_,this.direction=$<0?-1:1}function BMCompleteEvent(o,i){this.type=o,this.direction=i<0?-1:1}function BMCompleteLoopEvent(o,i,_,$){this.type=o,this.currentLoop=_,this.totalLoops=i,this.direction=$<0?-1:1}function BMSegmentStartEvent(o,i,_){this.type=o,this.firstFrame=i,this.totalFrames=_}function BMDestroyEvent(o,i){this.type=o,this.target=i}function BMRenderFrameErrorEvent(o,i){this.type="renderFrameError",this.nativeError=o,this.currentTime=i}function BMConfigErrorEvent(o){this.type="configError",this.nativeError=o}var createElementID=function(){var o=0;return function(){return o+=1,idPrefix$1+"__lottie_element_"+o}}();function HSVtoRGB(o,i,_){var $,j,_e,et,tt,rt,nt,it;switch(et=Math.floor(o*6),tt=o*6-et,rt=_*(1-i),nt=_*(1-tt*i),it=_*(1-(1-tt)*i),et%6){case 0:$=_,j=it,_e=rt;break;case 1:$=nt,j=_,_e=rt;break;case 2:$=rt,j=_,_e=it;break;case 3:$=rt,j=nt,_e=_;break;case 4:$=it,j=rt,_e=_;break;case 5:$=_,j=rt,_e=nt;break}return[$,j,_e]}function RGBtoHSV(o,i,_){var $=Math.max(o,i,_),j=Math.min(o,i,_),_e=$-j,et,tt=$===0?0:_e/$,rt=$/255;switch($){case j:et=0;break;case o:et=i-_+_e*(i<_?6:0),et/=6*_e;break;case i:et=_-o+_e*2,et/=6*_e;break;case _:et=o-i+_e*4,et/=6*_e;break}return[et,tt,rt]}function addSaturationToRGB(o,i){var _=RGBtoHSV(o[0]*255,o[1]*255,o[2]*255);return _[1]+=i,_[1]>1?_[1]=1:_[1]<=0&&(_[1]=0),HSVtoRGB(_[0],_[1],_[2])}function addBrightnessToRGB(o,i){var _=RGBtoHSV(o[0]*255,o[1]*255,o[2]*255);return _[2]+=i,_[2]>1?_[2]=1:_[2]<0&&(_[2]=0),HSVtoRGB(_[0],_[1],_[2])}function addHueToRGB(o,i){var _=RGBtoHSV(o[0]*255,o[1]*255,o[2]*255);return _[0]+=i/360,_[0]>1?_[0]-=1:_[0]<0&&(_[0]+=1),HSVtoRGB(_[0],_[1],_[2])}var rgbToHex=function(){var o=[],i,_;for(i=0;i<256;i+=1)_=i.toString(16),o[i]=_.length===1?"0"+_:_;return function($,j,_e){return $<0&&($=0),j<0&&(j=0),_e<0&&(_e=0),"#"+o[$]+o[j]+o[_e]}}(),setSubframeEnabled=function(i){subframeEnabled=!!i},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(i){expressionsPlugin=i},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(i){expressionsInterfaces=i},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(i){defaultCurveSegments=i},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(i){idPrefix$1=i};function createNS(o){return document.createElementNS(svgNS,o)}function _typeof$5(o){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$5(o)}var dataManager=function(){var o=1,i=[],_,$,j={onmessage:function(){},postMessage:function(ot){_({data:ot})}},_e={postMessage:function(ot){j.onmessage({data:ot})}};function et(at){if(window.Worker&&window.Blob&&getWebWorker()){var ot=new Blob(["var _workerSelf = self; self.onmessage = ",at.toString()],{type:"text/javascript"}),lt=URL.createObjectURL(ot);return new Worker(lt)}return _=at,j}function tt(){$||($=et(function(ot){function lt(){function ft(Ft,Pt){var Rt,Et,_t=Ft.length,Mt,Dt,Lt,Ct;for(Et=0;Et<_t;Et+=1)if(Rt=Ft[Et],"ks"in Rt&&!Rt.completed){if(Rt.completed=!0,Rt.hasMask){var kt=Rt.masksProperties;for(Dt=kt.length,Mt=0;Mt<Dt;Mt+=1)if(kt[Mt].pt.k.i)pt(kt[Mt].pt.k);else for(Ct=kt[Mt].pt.k.length,Lt=0;Lt<Ct;Lt+=1)kt[Mt].pt.k[Lt].s&&pt(kt[Mt].pt.k[Lt].s[0]),kt[Mt].pt.k[Lt].e&&pt(kt[Mt].pt.k[Lt].e[0])}Rt.ty===0?(Rt.layers=dt(Rt.refId,Pt),ft(Rt.layers,Pt)):Rt.ty===4?mt(Rt.shapes):Rt.ty===5&&Ot(Rt)}}function ut(Ft,Pt){if(Ft){var Rt=0,Et=Ft.length;for(Rt=0;Rt<Et;Rt+=1)Ft[Rt].t===1&&(Ft[Rt].data.layers=dt(Ft[Rt].data.refId,Pt),ft(Ft[Rt].data.layers,Pt))}}function ht(Ft,Pt){for(var Rt=0,Et=Pt.length;Rt<Et;){if(Pt[Rt].id===Ft)return Pt[Rt];Rt+=1}return null}function dt(Ft,Pt){var Rt=ht(Ft,Pt);return Rt?Rt.layers.__used?JSON.parse(JSON.stringify(Rt.layers)):(Rt.layers.__used=!0,Rt.layers):null}function mt(Ft){var Pt,Rt=Ft.length,Et,_t;for(Pt=Rt-1;Pt>=0;Pt-=1)if(Ft[Pt].ty==="sh")if(Ft[Pt].ks.k.i)pt(Ft[Pt].ks.k);else for(_t=Ft[Pt].ks.k.length,Et=0;Et<_t;Et+=1)Ft[Pt].ks.k[Et].s&&pt(Ft[Pt].ks.k[Et].s[0]),Ft[Pt].ks.k[Et].e&&pt(Ft[Pt].ks.k[Et].e[0]);else Ft[Pt].ty==="gr"&&mt(Ft[Pt].it)}function pt(Ft){var Pt,Rt=Ft.i.length;for(Pt=0;Pt<Rt;Pt+=1)Ft.i[Pt][0]+=Ft.v[Pt][0],Ft.i[Pt][1]+=Ft.v[Pt][1],Ft.o[Pt][0]+=Ft.v[Pt][0],Ft.o[Pt][1]+=Ft.v[Pt][1]}function yt(Ft,Pt){var Rt=Pt?Pt.split("."):[100,100,100];return Ft[0]>Rt[0]?!0:Rt[0]>Ft[0]?!1:Ft[1]>Rt[1]?!0:Rt[1]>Ft[1]?!1:Ft[2]>Rt[2]?!0:Rt[2]>Ft[2]?!1:null}var gt=function(){var Ft=[4,4,14];function Pt(Et){var _t=Et.t.d;Et.t.d={k:[{s:_t,t:0}]}}function Rt(Et){var _t,Mt=Et.length;for(_t=0;_t<Mt;_t+=1)Et[_t].ty===5&&Pt(Et[_t])}return function(Et){if(yt(Ft,Et.v)&&(Rt(Et.layers),Et.assets)){var _t,Mt=Et.assets.length;for(_t=0;_t<Mt;_t+=1)Et.assets[_t].layers&&Rt(Et.assets[_t].layers)}}}(),vt=function(){var Ft=[4,7,99];return function(Pt){if(Pt.chars&&!yt(Ft,Pt.v)){var Rt,Et=Pt.chars.length;for(Rt=0;Rt<Et;Rt+=1){var _t=Pt.chars[Rt];_t.data&&_t.data.shapes&&(mt(_t.data.shapes),_t.data.ip=0,_t.data.op=99999,_t.data.st=0,_t.data.sr=1,_t.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},Pt.chars[Rt].t||(_t.data.shapes.push({ty:"no"}),_t.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),St=function(){var Ft=[5,7,15];function Pt(Et){var _t=Et.t.p;typeof _t.a=="number"&&(_t.a={a:0,k:_t.a}),typeof _t.p=="number"&&(_t.p={a:0,k:_t.p}),typeof _t.r=="number"&&(_t.r={a:0,k:_t.r})}function Rt(Et){var _t,Mt=Et.length;for(_t=0;_t<Mt;_t+=1)Et[_t].ty===5&&Pt(Et[_t])}return function(Et){if(yt(Ft,Et.v)&&(Rt(Et.layers),Et.assets)){var _t,Mt=Et.assets.length;for(_t=0;_t<Mt;_t+=1)Et.assets[_t].layers&&Rt(Et.assets[_t].layers)}}}(),At=function(){var Ft=[4,1,9];function Pt(Et){var _t,Mt=Et.length,Dt,Lt;for(_t=0;_t<Mt;_t+=1)if(Et[_t].ty==="gr")Pt(Et[_t].it);else if(Et[_t].ty==="fl"||Et[_t].ty==="st")if(Et[_t].c.k&&Et[_t].c.k[0].i)for(Lt=Et[_t].c.k.length,Dt=0;Dt<Lt;Dt+=1)Et[_t].c.k[Dt].s&&(Et[_t].c.k[Dt].s[0]/=255,Et[_t].c.k[Dt].s[1]/=255,Et[_t].c.k[Dt].s[2]/=255,Et[_t].c.k[Dt].s[3]/=255),Et[_t].c.k[Dt].e&&(Et[_t].c.k[Dt].e[0]/=255,Et[_t].c.k[Dt].e[1]/=255,Et[_t].c.k[Dt].e[2]/=255,Et[_t].c.k[Dt].e[3]/=255);else Et[_t].c.k[0]/=255,Et[_t].c.k[1]/=255,Et[_t].c.k[2]/=255,Et[_t].c.k[3]/=255}function Rt(Et){var _t,Mt=Et.length;for(_t=0;_t<Mt;_t+=1)Et[_t].ty===4&&Pt(Et[_t].shapes)}return function(Et){if(yt(Ft,Et.v)&&(Rt(Et.layers),Et.assets)){var _t,Mt=Et.assets.length;for(_t=0;_t<Mt;_t+=1)Et.assets[_t].layers&&Rt(Et.assets[_t].layers)}}}(),xt=function(){var Ft=[4,4,18];function Pt(Et){var _t,Mt=Et.length,Dt,Lt;for(_t=Mt-1;_t>=0;_t-=1)if(Et[_t].ty==="sh")if(Et[_t].ks.k.i)Et[_t].ks.k.c=Et[_t].closed;else for(Lt=Et[_t].ks.k.length,Dt=0;Dt<Lt;Dt+=1)Et[_t].ks.k[Dt].s&&(Et[_t].ks.k[Dt].s[0].c=Et[_t].closed),Et[_t].ks.k[Dt].e&&(Et[_t].ks.k[Dt].e[0].c=Et[_t].closed);else Et[_t].ty==="gr"&&Pt(Et[_t].it)}function Rt(Et){var _t,Mt,Dt=Et.length,Lt,Ct,kt,jt;for(Mt=0;Mt<Dt;Mt+=1){if(_t=Et[Mt],_t.hasMask){var Vt=_t.masksProperties;for(Ct=Vt.length,Lt=0;Lt<Ct;Lt+=1)if(Vt[Lt].pt.k.i)Vt[Lt].pt.k.c=Vt[Lt].cl;else for(jt=Vt[Lt].pt.k.length,kt=0;kt<jt;kt+=1)Vt[Lt].pt.k[kt].s&&(Vt[Lt].pt.k[kt].s[0].c=Vt[Lt].cl),Vt[Lt].pt.k[kt].e&&(Vt[Lt].pt.k[kt].e[0].c=Vt[Lt].cl)}_t.ty===4&&Pt(_t.shapes)}}return function(Et){if(yt(Ft,Et.v)&&(Rt(Et.layers),Et.assets)){var _t,Mt=Et.assets.length;for(_t=0;_t<Mt;_t+=1)Et.assets[_t].layers&&Rt(Et.assets[_t].layers)}}}();function wt(Ft){Ft.__complete||(At(Ft),gt(Ft),vt(Ft),St(Ft),xt(Ft),ft(Ft.layers,Ft.assets),ut(Ft.chars,Ft.assets),Ft.__complete=!0)}function Ot(Ft){Ft.t.a.length===0&&"m"in Ft.t.p}var Bt={};return Bt.completeData=wt,Bt.checkColors=At,Bt.checkChars=vt,Bt.checkPathProperties=St,Bt.checkShapes=xt,Bt.completeLayers=ft,Bt}if(_e.dataManager||(_e.dataManager=lt()),_e.assetLoader||(_e.assetLoader=function(){function ft(ht){var dt=ht.getResponseHeader("content-type");return dt&&ht.responseType==="json"&&dt.indexOf("json")!==-1||ht.response&&_typeof$5(ht.response)==="object"?ht.response:ht.response&&typeof ht.response=="string"?JSON.parse(ht.response):ht.responseText?JSON.parse(ht.responseText):null}function ut(ht,dt,mt,pt){var yt,gt=new XMLHttpRequest;try{gt.responseType="json"}catch{}gt.onreadystatechange=function(){if(gt.readyState===4)if(gt.status===200)yt=ft(gt),mt(yt);else try{yt=ft(gt),mt(yt)}catch(vt){pt&&pt(vt)}};try{gt.open(["G","E","T"].join(""),ht,!0)}catch{gt.open(["G","E","T"].join(""),dt+"/"+ht,!0)}gt.send()}return{load:ut}}()),ot.data.type==="loadAnimation")_e.assetLoader.load(ot.data.path,ot.data.fullPath,function(ft){_e.dataManager.completeData(ft),_e.postMessage({id:ot.data.id,payload:ft,status:"success"})},function(){_e.postMessage({id:ot.data.id,status:"error"})});else if(ot.data.type==="complete"){var ct=ot.data.animation;_e.dataManager.completeData(ct),_e.postMessage({id:ot.data.id,payload:ct,status:"success"})}else ot.data.type==="loadData"&&_e.assetLoader.load(ot.data.path,ot.data.fullPath,function(ft){_e.postMessage({id:ot.data.id,payload:ft,status:"success"})},function(){_e.postMessage({id:ot.data.id,status:"error"})})}),$.onmessage=function(at){var ot=at.data,lt=ot.id,ct=i[lt];i[lt]=null,ot.status==="success"?ct.onComplete(ot.payload):ct.onError&&ct.onError()})}function rt(at,ot){o+=1;var lt="processId_"+o;return i[lt]={onComplete:at,onError:ot},lt}function nt(at,ot,lt){tt();var ct=rt(ot,lt);$.postMessage({type:"loadAnimation",path:at,fullPath:window.location.origin+window.location.pathname,id:ct})}function it(at,ot,lt){tt();var ct=rt(ot,lt);$.postMessage({type:"loadData",path:at,fullPath:window.location.origin+window.location.pathname,id:ct})}function st(at,ot,lt){tt();var ct=rt(ot,lt);$.postMessage({type:"complete",animation:at,id:ct})}return{loadAnimation:nt,loadData:it,completeAnimation:st}}(),ImagePreloader=function(){var o=function(){var ut=createTag("canvas");ut.width=1,ut.height=1;var ht=ut.getContext("2d");return ht.fillStyle="rgba(0,0,0,0)",ht.fillRect(0,0,1,1),ut}();function i(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function _(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function $(ut,ht,dt){var mt="";if(ut.e)mt=ut.p;else if(ht){var pt=ut.p;pt.indexOf("images/")!==-1&&(pt=pt.split("/")[1]),mt=ht+pt}else mt=dt,mt+=ut.u?ut.u:"",mt+=ut.p;return mt}function j(ut){var ht=0,dt=setInterval((function(){var mt=ut.getBBox();(mt.width||ht>500)&&(this._imageLoaded(),clearInterval(dt)),ht+=1}).bind(this),50)}function _e(ut){var ht=$(ut,this.assetsPath,this.path),dt=createNS("image");isSafari?this.testImageLoaded(dt):dt.addEventListener("load",this._imageLoaded,!1),dt.addEventListener("error",(function(){mt.img=o,this._imageLoaded()}).bind(this),!1),dt.setAttributeNS("http://www.w3.org/1999/xlink","href",ht),this._elementHelper.append?this._elementHelper.append(dt):this._elementHelper.appendChild(dt);var mt={img:dt,assetData:ut};return mt}function et(ut){var ht=$(ut,this.assetsPath,this.path),dt=createTag("img");dt.crossOrigin="anonymous",dt.addEventListener("load",this._imageLoaded,!1),dt.addEventListener("error",(function(){mt.img=o,this._imageLoaded()}).bind(this),!1),dt.src=ht;var mt={img:dt,assetData:ut};return mt}function tt(ut){var ht={assetData:ut},dt=$(ut,this.assetsPath,this.path);return dataManager.loadData(dt,(function(mt){ht.img=mt,this._footageLoaded()}).bind(this),(function(){ht.img={},this._footageLoaded()}).bind(this)),ht}function rt(ut,ht){this.imagesLoadedCb=ht;var dt,mt=ut.length;for(dt=0;dt<mt;dt+=1)ut[dt].layers||(!ut[dt].t||ut[dt].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(ut[dt]))):ut[dt].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(ut[dt]))))}function nt(ut){this.path=ut||""}function it(ut){this.assetsPath=ut||""}function st(ut){for(var ht=0,dt=this.images.length;ht<dt;){if(this.images[ht].assetData===ut)return this.images[ht].img;ht+=1}return null}function at(){this.imagesLoadedCb=null,this.images.length=0}function ot(){return this.totalImages===this.loadedAssets}function lt(){return this.totalFootages===this.loadedFootagesCount}function ct(ut,ht){ut==="svg"?(this._elementHelper=ht,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function ft(){this._imageLoaded=i.bind(this),this._footageLoaded=_.bind(this),this.testImageLoaded=j.bind(this),this.createFootageData=tt.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return ft.prototype={loadAssets:rt,setAssetsPath:it,setPath:nt,loadedImages:ot,loadedFootages:lt,destroy:at,getAsset:st,createImgData:et,createImageData:_e,imageLoaded:i,footageLoaded:_,setCacheType:ct},ft}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(i,_){if(this._cbs[i])for(var $=this._cbs[i],j=0;j<$.length;j+=1)$[j](_)},addEventListener:function(i,_){return this._cbs[i]||(this._cbs[i]=[]),this._cbs[i].push(_),(function(){this.removeEventListener(i,_)}).bind(this)},removeEventListener:function(i,_){if(!_)this._cbs[i]=null;else if(this._cbs[i]){for(var $=0,j=this._cbs[i].length;$<j;)this._cbs[i][$]===_&&(this._cbs[i].splice($,1),$-=1,j-=1),$+=1;this._cbs[i].length||(this._cbs[i]=null)}}};var markerParser=function(){function o(i){for(var _=i.split(`\r
`),$={},j,_e=0,et=0;et<_.length;et+=1)j=_[et].split(":"),j.length===2&&($[j[0]]=j[1].trim(),_e+=1);if(_e===0)throw new Error;return $}return function(i){for(var _=[],$=0;$<i.length;$+=1){var j=i[$],_e={time:j.tm,duration:j.dr};try{_e.payload=JSON.parse(i[$].cm)}catch{try{_e.payload=o(i[$].cm)}catch{_e.payload={name:i[$].cm}}}_.push(_e)}return _}}(),ProjectInterface=function(){function o(i){this.compositions.push(i)}return function(){function i(_){for(var $=0,j=this.compositions.length;$<j;){if(this.compositions[$].data&&this.compositions[$].data.nm===_)return this.compositions[$].prepareFrame&&this.compositions[$].data.xt&&this.compositions[$].prepareFrame(this.currentFrame),this.compositions[$].compInterface;$+=1}return null}return i.compositions=[],i.currentFrame=0,i.registerComposition=o,i}}(),renderers={},registerRenderer=function(i,_){renderers[i]=_};function getRenderer(o){return renderers[o]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var o in renderers)if(renderers[o])return o;return""}function _typeof$4(o){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$4(o)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(o){(o.wrapper||o.container)&&(this.wrapper=o.wrapper||o.container);var i="svg";o.animType?i=o.animType:o.renderer&&(i=o.renderer);var _=getRenderer(i);this.renderer=new _(this,o.rendererSettings),this.imagePreloader.setCacheType(i,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=i,o.loop===""||o.loop===null||o.loop===void 0||o.loop===!0?this.loop=!0:o.loop===!1?this.loop=!1:this.loop=parseInt(o.loop,10),this.autoplay="autoplay"in o?o.autoplay:!0,this.name=o.name?o.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(o,"autoloadSegments")?o.autoloadSegments:!0,this.assetsPath=o.assetsPath,this.initialSegment=o.initialSegment,o.audioFactory&&this.audioController.setAudioFactory(o.audioFactory),o.animationData?this.setupAnimation(o.animationData):o.path&&(o.path.lastIndexOf("\\")!==-1?this.path=o.path.substr(0,o.path.lastIndexOf("\\")+1):this.path=o.path.substr(0,o.path.lastIndexOf("/")+1),this.fileName=o.path.substr(o.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(o.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(o){dataManager.completeAnimation(o,this.configAnimation)},AnimationItem.prototype.setData=function(o,i){i&&_typeof$4(i)!=="object"&&(i=JSON.parse(i));var _={wrapper:o,animationData:i},$=o.attributes;_.path=$.getNamedItem("data-animation-path")?$.getNamedItem("data-animation-path").value:$.getNamedItem("data-bm-path")?$.getNamedItem("data-bm-path").value:$.getNamedItem("bm-path")?$.getNamedItem("bm-path").value:"",_.animType=$.getNamedItem("data-anim-type")?$.getNamedItem("data-anim-type").value:$.getNamedItem("data-bm-type")?$.getNamedItem("data-bm-type").value:$.getNamedItem("bm-type")?$.getNamedItem("bm-type").value:$.getNamedItem("data-bm-renderer")?$.getNamedItem("data-bm-renderer").value:$.getNamedItem("bm-renderer")?$.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var j=$.getNamedItem("data-anim-loop")?$.getNamedItem("data-anim-loop").value:$.getNamedItem("data-bm-loop")?$.getNamedItem("data-bm-loop").value:$.getNamedItem("bm-loop")?$.getNamedItem("bm-loop").value:"";j==="false"?_.loop=!1:j==="true"?_.loop=!0:j!==""&&(_.loop=parseInt(j,10));var _e=$.getNamedItem("data-anim-autoplay")?$.getNamedItem("data-anim-autoplay").value:$.getNamedItem("data-bm-autoplay")?$.getNamedItem("data-bm-autoplay").value:$.getNamedItem("bm-autoplay")?$.getNamedItem("bm-autoplay").value:!0;_.autoplay=_e!=="false",_.name=$.getNamedItem("data-name")?$.getNamedItem("data-name").value:$.getNamedItem("data-bm-name")?$.getNamedItem("data-bm-name").value:$.getNamedItem("bm-name")?$.getNamedItem("bm-name").value:"";var et=$.getNamedItem("data-anim-prerender")?$.getNamedItem("data-anim-prerender").value:$.getNamedItem("data-bm-prerender")?$.getNamedItem("data-bm-prerender").value:$.getNamedItem("bm-prerender")?$.getNamedItem("bm-prerender").value:"";et==="false"&&(_.prerender=!1),_.path?this.setParams(_):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(o){o.op>this.animationData.op&&(this.animationData.op=o.op,this.totalFrames=Math.floor(o.op-this.animationData.ip));var i=this.animationData.layers,_,$=i.length,j=o.layers,_e,et=j.length;for(_e=0;_e<et;_e+=1)for(_=0;_<$;){if(i[_].id===j[_e].id){i[_]=j[_e];break}_+=1}if((o.chars||o.fonts)&&(this.renderer.globalData.fontManager.addChars(o.chars),this.renderer.globalData.fontManager.addFonts(o.fonts,this.renderer.globalData.defs)),o.assets)for($=o.assets.length,_=0;_<$;_+=1)this.animationData.assets.push(o.assets[_]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(o){this.animationData=o;var i=getExpressionsPlugin();i&&i.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var o=this.animationData.segments;if(!o||o.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var i=o.shift();this.timeCompleted=i.time*this.frameRate;var _=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(_,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var o=this.animationData.segments;o||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(o){if(this.renderer)try{this.animationData=o,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(o),o.assets||(o.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(o.assets),this.markers=markerParser(o.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(i){this.triggerConfigError(i)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var o=getExpressionsPlugin();o&&o.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(o,i){var _=typeof o=="number"?o:void 0,$=typeof i=="number"?i:void 0;this.renderer.updateContainerSize(_,$)},AnimationItem.prototype.setSubframe=function(o){this.isSubframeEnabled=!!o},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(o){this.triggerRenderFrameError(o)}},AnimationItem.prototype.play=function(o){o&&this.name!==o||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(o){o&&this.name!==o||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(o){o&&this.name!==o||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(o){o&&this.name!==o||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(o){for(var i,_=0;_<this.markers.length;_+=1)if(i=this.markers[_],i.payload&&i.payload.name===o)return i;return null},AnimationItem.prototype.goToAndStop=function(o,i,_){if(!(_&&this.name!==_)){var $=Number(o);if(isNaN($)){var j=this.getMarkerData(o);j&&this.goToAndStop(j.time,!0)}else i?this.setCurrentRawFrameValue(o):this.setCurrentRawFrameValue(o*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(o,i,_){if(!(_&&this.name!==_)){var $=Number(o);if(isNaN($)){var j=this.getMarkerData(o);j&&(j.duration?this.playSegments([j.time,j.time+j.duration],!0):this.goToAndStop(j.time,!0))}else this.goToAndStop($,i,_);this.play()}},AnimationItem.prototype.advanceTime=function(o){if(!(this.isPaused===!0||this.isLoaded===!1)){var i=this.currentRawFrame+o*this.frameModifier,_=!1;i>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(i>this.totalFrames?i%this.totalFrames:0)||(_=!0,i=this.totalFrames-1):i>=this.totalFrames?(this.playCount+=1,this.checkSegments(i%this.totalFrames)||(this.setCurrentRawFrameValue(i%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(i):i<0?this.checkSegments(i%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+i%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(_=!0,i=0)):this.setCurrentRawFrameValue(i),_&&(this.setCurrentRawFrameValue(i),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(o,i){this.playCount=0,o[1]<o[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=o[0]-o[1],this.timeCompleted=this.totalFrames,this.firstFrame=o[1],this.setCurrentRawFrameValue(this.totalFrames-.001-i)):o[1]>o[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=o[1]-o[0],this.timeCompleted=this.totalFrames,this.firstFrame=o[0],this.setCurrentRawFrameValue(.001+i)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(o,i){var _=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<o?_=o:this.currentRawFrame+this.firstFrame>i&&(_=i-o)),this.firstFrame=o,this.totalFrames=i-o,this.timeCompleted=this.totalFrames,_!==-1&&this.goToAndStop(_,!0)},AnimationItem.prototype.playSegments=function(o,i){if(i&&(this.segments.length=0),_typeof$4(o[0])==="object"){var _,$=o.length;for(_=0;_<$;_+=1)this.segments.push(o[_])}else this.segments.push(o);this.segments.length&&i&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(o){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),o&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(o){return this.segments.length?(this.adjustSegment(this.segments.shift(),o),!0):!1},AnimationItem.prototype.destroy=function(o){o&&this.name!==o||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(o){this.currentRawFrame=o,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(o){this.playSpeed=o,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(o){this.playDirection=o<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(o){this.loop=o},AnimationItem.prototype.setVolume=function(o,i){i&&this.name!==i||this.audioController.setVolume(o)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(o){o&&this.name!==o||this.audioController.mute()},AnimationItem.prototype.unmute=function(o){o&&this.name!==o||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(o){var i="";if(o.e)i=o.p;else if(this.assetsPath){var _=o.p;_.indexOf("images/")!==-1&&(_=_.split("/")[1]),i=this.assetsPath+_}else i=this.path,i+=o.u?o.u:"",i+=o.p;return i},AnimationItem.prototype.getAssetData=function(o){for(var i=0,_=this.assets.length;i<_;){if(o===this.assets[i].id)return this.assets[i];i+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(o){return o?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(o,i,_){try{var $=this.renderer.getElementByPath(o);$.updateDocumentData(i,_)}catch{}},AnimationItem.prototype.trigger=function(o){if(this._cbs&&this._cbs[o])switch(o){case"enterFrame":this.triggerEvent(o,new BMEnterFrameEvent(o,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(o,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(o,new BMCompleteLoopEvent(o,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(o,new BMCompleteEvent(o,this.frameMult));break;case"segmentStart":this.triggerEvent(o,new BMSegmentStartEvent(o,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(o,new BMDestroyEvent(o,this));break;default:this.triggerEvent(o)}o==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(o,this.currentFrame,this.totalFrames,this.frameMult)),o==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(o,this.loop,this.playCount,this.frameMult)),o==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(o,this.frameMult)),o==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(o,this.firstFrame,this.totalFrames)),o==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(o,this))},AnimationItem.prototype.triggerRenderFrameError=function(o){var i=new BMRenderFrameErrorEvent(o,this.currentFrame);this.triggerEvent("error",i),this.onError&&this.onError.call(this,i)},AnimationItem.prototype.triggerConfigError=function(o){var i=new BMConfigErrorEvent(o,this.currentFrame);this.triggerEvent("error",i),this.onError&&this.onError.call(this,i)};var animationManager=function(){var o={},i=[],_=0,$=0,j=0,_e=!0,et=!1;function tt(Pt){for(var Rt=0,Et=Pt.target;Rt<$;)i[Rt].animation===Et&&(i.splice(Rt,1),Rt-=1,$-=1,Et.isPaused||st()),Rt+=1}function rt(Pt,Rt){if(!Pt)return null;for(var Et=0;Et<$;){if(i[Et].elem===Pt&&i[Et].elem!==null)return i[Et].animation;Et+=1}var _t=new AnimationItem;return at(_t,Pt),_t.setData(Pt,Rt),_t}function nt(){var Pt,Rt=i.length,Et=[];for(Pt=0;Pt<Rt;Pt+=1)Et.push(i[Pt].animation);return Et}function it(){j+=1,At()}function st(){j-=1}function at(Pt,Rt){Pt.addEventListener("destroy",tt),Pt.addEventListener("_active",it),Pt.addEventListener("_idle",st),i.push({elem:Rt,animation:Pt}),$+=1}function ot(Pt){var Rt=new AnimationItem;return at(Rt,null),Rt.setParams(Pt),Rt}function lt(Pt,Rt){var Et;for(Et=0;Et<$;Et+=1)i[Et].animation.setSpeed(Pt,Rt)}function ct(Pt,Rt){var Et;for(Et=0;Et<$;Et+=1)i[Et].animation.setDirection(Pt,Rt)}function ft(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.play(Pt)}function ut(Pt){var Rt=Pt-_,Et;for(Et=0;Et<$;Et+=1)i[Et].animation.advanceTime(Rt);_=Pt,j&&!et?window.requestAnimationFrame(ut):_e=!0}function ht(Pt){_=Pt,window.requestAnimationFrame(ut)}function dt(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.pause(Pt)}function mt(Pt,Rt,Et){var _t;for(_t=0;_t<$;_t+=1)i[_t].animation.goToAndStop(Pt,Rt,Et)}function pt(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.stop(Pt)}function yt(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.togglePause(Pt)}function gt(Pt){var Rt;for(Rt=$-1;Rt>=0;Rt-=1)i[Rt].animation.destroy(Pt)}function vt(Pt,Rt,Et){var _t=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),Mt,Dt=_t.length;for(Mt=0;Mt<Dt;Mt+=1)Et&&_t[Mt].setAttribute("data-bm-type",Et),rt(_t[Mt],Pt);if(Rt&&Dt===0){Et||(Et="svg");var Lt=document.getElementsByTagName("body")[0];Lt.innerText="";var Ct=createTag("div");Ct.style.width="100%",Ct.style.height="100%",Ct.setAttribute("data-bm-type",Et),Lt.appendChild(Ct),rt(Ct,Pt)}}function St(){var Pt;for(Pt=0;Pt<$;Pt+=1)i[Pt].animation.resize()}function At(){!et&&j&&_e&&(window.requestAnimationFrame(ht),_e=!1)}function xt(){et=!0}function wt(){et=!1,At()}function Ot(Pt,Rt){var Et;for(Et=0;Et<$;Et+=1)i[Et].animation.setVolume(Pt,Rt)}function Bt(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.mute(Pt)}function Ft(Pt){var Rt;for(Rt=0;Rt<$;Rt+=1)i[Rt].animation.unmute(Pt)}return o.registerAnimation=rt,o.loadAnimation=ot,o.setSpeed=lt,o.setDirection=ct,o.play=ft,o.pause=dt,o.stop=pt,o.togglePause=yt,o.searchAnimations=vt,o.resize=St,o.goToAndStop=mt,o.destroy=gt,o.freeze=xt,o.unfreeze=wt,o.setVolume=Ot,o.mute=Bt,o.unmute=Ft,o.getRegisteredAnimations=nt,o}(),BezierFactory=function(){var o={};o.getBezierEasing=_;var i={};function _(ht,dt,mt,pt,yt){var gt=yt||("bez_"+ht+"_"+dt+"_"+mt+"_"+pt).replace(/\./g,"p");if(i[gt])return i[gt];var vt=new ut([ht,dt,mt,pt]);return i[gt]=vt,vt}var $=4,j=.001,_e=1e-7,et=10,tt=11,rt=1/(tt-1),nt=typeof Float32Array=="function";function it(ht,dt){return 1-3*dt+3*ht}function st(ht,dt){return 3*dt-6*ht}function at(ht){return 3*ht}function ot(ht,dt,mt){return((it(dt,mt)*ht+st(dt,mt))*ht+at(dt))*ht}function lt(ht,dt,mt){return 3*it(dt,mt)*ht*ht+2*st(dt,mt)*ht+at(dt)}function ct(ht,dt,mt,pt,yt){var gt,vt,St=0;do vt=dt+(mt-dt)/2,gt=ot(vt,pt,yt)-ht,gt>0?mt=vt:dt=vt;while(Math.abs(gt)>_e&&++St<et);return vt}function ft(ht,dt,mt,pt){for(var yt=0;yt<$;++yt){var gt=lt(dt,mt,pt);if(gt===0)return dt;var vt=ot(dt,mt,pt)-ht;dt-=vt/gt}return dt}function ut(ht){this._p=ht,this._mSampleValues=nt?new Float32Array(tt):new Array(tt),this._precomputed=!1,this.get=this.get.bind(this)}return ut.prototype={get:function(dt){var mt=this._p[0],pt=this._p[1],yt=this._p[2],gt=this._p[3];return this._precomputed||this._precompute(),mt===pt&&yt===gt?dt:dt===0?0:dt===1?1:ot(this._getTForX(dt),pt,gt)},_precompute:function(){var dt=this._p[0],mt=this._p[1],pt=this._p[2],yt=this._p[3];this._precomputed=!0,(dt!==mt||pt!==yt)&&this._calcSampleValues()},_calcSampleValues:function(){for(var dt=this._p[0],mt=this._p[2],pt=0;pt<tt;++pt)this._mSampleValues[pt]=ot(pt*rt,dt,mt)},_getTForX:function(dt){for(var mt=this._p[0],pt=this._p[2],yt=this._mSampleValues,gt=0,vt=1,St=tt-1;vt!==St&&yt[vt]<=dt;++vt)gt+=rt;--vt;var At=(dt-yt[vt])/(yt[vt+1]-yt[vt]),xt=gt+At*rt,wt=lt(xt,mt,pt);return wt>=j?ft(dt,xt,mt,pt):wt===0?xt:ct(dt,gt,gt+rt,mt,pt)}},o}(),pooling=function(){function o(i){return i.concat(createSizedArray(i.length))}return{double:o}}(),poolFactory=function(){return function(o,i,_){var $=0,j=o,_e=createSizedArray(j),et={newElement:tt,release:rt};function tt(){var nt;return $?($-=1,nt=_e[$]):nt=i(),nt}function rt(nt){$===j&&(_e=pooling.double(_e),j*=2),_&&_(nt),_e[$]=nt,$+=1}return et}}(),bezierLengthPool=function(){function o(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,o)}(),segmentsLengthPool=function(){function o(){return{lengths:[],totalLength:0}}function i(_){var $,j=_.lengths.length;for($=0;$<j;$+=1)bezierLengthPool.release(_.lengths[$]);_.lengths.length=0}return poolFactory(8,o,i)}();function bezFunction(){var o=Math;function i(at,ot,lt,ct,ft,ut){var ht=at*ct+ot*ft+lt*ut-ft*ct-ut*at-lt*ot;return ht>-.001&&ht<.001}function _(at,ot,lt,ct,ft,ut,ht,dt,mt){if(lt===0&&ut===0&&mt===0)return i(at,ot,ct,ft,ht,dt);var pt=o.sqrt(o.pow(ct-at,2)+o.pow(ft-ot,2)+o.pow(ut-lt,2)),yt=o.sqrt(o.pow(ht-at,2)+o.pow(dt-ot,2)+o.pow(mt-lt,2)),gt=o.sqrt(o.pow(ht-ct,2)+o.pow(dt-ft,2)+o.pow(mt-ut,2)),vt;return pt>yt?pt>gt?vt=pt-yt-gt:vt=gt-yt-pt:gt>yt?vt=gt-yt-pt:vt=yt-pt-gt,vt>-1e-4&&vt<1e-4}var $=function(){return function(at,ot,lt,ct){var ft=getDefaultCurveSegments(),ut,ht,dt,mt,pt,yt=0,gt,vt=[],St=[],At=bezierLengthPool.newElement();for(dt=lt.length,ut=0;ut<ft;ut+=1){for(pt=ut/(ft-1),gt=0,ht=0;ht<dt;ht+=1)mt=bmPow(1-pt,3)*at[ht]+3*bmPow(1-pt,2)*pt*lt[ht]+3*(1-pt)*bmPow(pt,2)*ct[ht]+bmPow(pt,3)*ot[ht],vt[ht]=mt,St[ht]!==null&&(gt+=bmPow(vt[ht]-St[ht],2)),St[ht]=vt[ht];gt&&(gt=bmSqrt(gt),yt+=gt),At.percents[ut]=pt,At.lengths[ut]=yt}return At.addedLength=yt,At}}();function j(at){var ot=segmentsLengthPool.newElement(),lt=at.c,ct=at.v,ft=at.o,ut=at.i,ht,dt=at._length,mt=ot.lengths,pt=0;for(ht=0;ht<dt-1;ht+=1)mt[ht]=$(ct[ht],ct[ht+1],ft[ht],ut[ht+1]),pt+=mt[ht].addedLength;return lt&&dt&&(mt[ht]=$(ct[ht],ct[0],ft[ht],ut[0]),pt+=mt[ht].addedLength),ot.totalLength=pt,ot}function _e(at){this.segmentLength=0,this.points=new Array(at)}function et(at,ot){this.partialLength=at,this.point=ot}var tt=function(){var at={};return function(ot,lt,ct,ft){var ut=(ot[0]+"_"+ot[1]+"_"+lt[0]+"_"+lt[1]+"_"+ct[0]+"_"+ct[1]+"_"+ft[0]+"_"+ft[1]).replace(/\./g,"p");if(!at[ut]){var ht=getDefaultCurveSegments(),dt,mt,pt,yt,gt,vt=0,St,At,xt=null;ot.length===2&&(ot[0]!==lt[0]||ot[1]!==lt[1])&&i(ot[0],ot[1],lt[0],lt[1],ot[0]+ct[0],ot[1]+ct[1])&&i(ot[0],ot[1],lt[0],lt[1],lt[0]+ft[0],lt[1]+ft[1])&&(ht=2);var wt=new _e(ht);for(pt=ct.length,dt=0;dt<ht;dt+=1){for(At=createSizedArray(pt),gt=dt/(ht-1),St=0,mt=0;mt<pt;mt+=1)yt=bmPow(1-gt,3)*ot[mt]+3*bmPow(1-gt,2)*gt*(ot[mt]+ct[mt])+3*(1-gt)*bmPow(gt,2)*(lt[mt]+ft[mt])+bmPow(gt,3)*lt[mt],At[mt]=yt,xt!==null&&(St+=bmPow(At[mt]-xt[mt],2));St=bmSqrt(St),vt+=St,wt.points[dt]=new et(St,At),xt=At}wt.segmentLength=vt,at[ut]=wt}return at[ut]}}();function rt(at,ot){var lt=ot.percents,ct=ot.lengths,ft=lt.length,ut=bmFloor((ft-1)*at),ht=at*ot.addedLength,dt=0;if(ut===ft-1||ut===0||ht===ct[ut])return lt[ut];for(var mt=ct[ut]>ht?-1:1,pt=!0;pt;)if(ct[ut]<=ht&&ct[ut+1]>ht?(dt=(ht-ct[ut])/(ct[ut+1]-ct[ut]),pt=!1):ut+=mt,ut<0||ut>=ft-1){if(ut===ft-1)return lt[ut];pt=!1}return lt[ut]+(lt[ut+1]-lt[ut])*dt}function nt(at,ot,lt,ct,ft,ut){var ht=rt(ft,ut),dt=1-ht,mt=o.round((dt*dt*dt*at[0]+(ht*dt*dt+dt*ht*dt+dt*dt*ht)*lt[0]+(ht*ht*dt+dt*ht*ht+ht*dt*ht)*ct[0]+ht*ht*ht*ot[0])*1e3)/1e3,pt=o.round((dt*dt*dt*at[1]+(ht*dt*dt+dt*ht*dt+dt*dt*ht)*lt[1]+(ht*ht*dt+dt*ht*ht+ht*dt*ht)*ct[1]+ht*ht*ht*ot[1])*1e3)/1e3;return[mt,pt]}var it=createTypedArray("float32",8);function st(at,ot,lt,ct,ft,ut,ht){ft<0?ft=0:ft>1&&(ft=1);var dt=rt(ft,ht);ut=ut>1?1:ut;var mt=rt(ut,ht),pt,yt=at.length,gt=1-dt,vt=1-mt,St=gt*gt*gt,At=dt*gt*gt*3,xt=dt*dt*gt*3,wt=dt*dt*dt,Ot=gt*gt*vt,Bt=dt*gt*vt+gt*dt*vt+gt*gt*mt,Ft=dt*dt*vt+gt*dt*mt+dt*gt*mt,Pt=dt*dt*mt,Rt=gt*vt*vt,Et=dt*vt*vt+gt*mt*vt+gt*vt*mt,_t=dt*mt*vt+gt*mt*mt+dt*vt*mt,Mt=dt*mt*mt,Dt=vt*vt*vt,Lt=mt*vt*vt+vt*mt*vt+vt*vt*mt,Ct=mt*mt*vt+vt*mt*mt+mt*vt*mt,kt=mt*mt*mt;for(pt=0;pt<yt;pt+=1)it[pt*4]=o.round((St*at[pt]+At*lt[pt]+xt*ct[pt]+wt*ot[pt])*1e3)/1e3,it[pt*4+1]=o.round((Ot*at[pt]+Bt*lt[pt]+Ft*ct[pt]+Pt*ot[pt])*1e3)/1e3,it[pt*4+2]=o.round((Rt*at[pt]+Et*lt[pt]+_t*ct[pt]+Mt*ot[pt])*1e3)/1e3,it[pt*4+3]=o.round((Dt*at[pt]+Lt*lt[pt]+Ct*ct[pt]+kt*ot[pt])*1e3)/1e3;return it}return{getSegmentsLength:j,getNewSegment:st,getPointInSegment:nt,buildBezierData:tt,pointOnLine2D:i,pointOnLine3D:_}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(o,i){var _=this.offsetTime,$;this.propType==="multidimensional"&&($=createTypedArray("float32",this.pv.length));for(var j=i.lastIndex,_e=j,et=this.keyframes.length-1,tt=!0,rt,nt,it;tt;){if(rt=this.keyframes[_e],nt=this.keyframes[_e+1],_e===et-1&&o>=nt.t-_){rt.h&&(rt=nt),j=0;break}if(nt.t-_>o){j=_e;break}_e<et-1?_e+=1:(j=0,tt=!1)}it=this.keyframesMetadata[_e]||{};var st,at,ot,lt,ct,ft,ut=nt.t-_,ht=rt.t-_,dt;if(rt.to){it.bezierData||(it.bezierData=bez.buildBezierData(rt.s,nt.s||rt.e,rt.to,rt.ti));var mt=it.bezierData;if(o>=ut||o<ht){var pt=o>=ut?mt.points.length-1:0;for(at=mt.points[pt].point.length,st=0;st<at;st+=1)$[st]=mt.points[pt].point[st]}else{it.__fnct?ft=it.__fnct:(ft=BezierFactory.getBezierEasing(rt.o.x,rt.o.y,rt.i.x,rt.i.y,rt.n).get,it.__fnct=ft),ot=ft((o-ht)/(ut-ht));var yt=mt.segmentLength*ot,gt,vt=i.lastFrame<o&&i._lastKeyframeIndex===_e?i._lastAddedLength:0;for(ct=i.lastFrame<o&&i._lastKeyframeIndex===_e?i._lastPoint:0,tt=!0,lt=mt.points.length;tt;){if(vt+=mt.points[ct].partialLength,yt===0||ot===0||ct===mt.points.length-1){for(at=mt.points[ct].point.length,st=0;st<at;st+=1)$[st]=mt.points[ct].point[st];break}else if(yt>=vt&&yt<vt+mt.points[ct+1].partialLength){for(gt=(yt-vt)/mt.points[ct+1].partialLength,at=mt.points[ct].point.length,st=0;st<at;st+=1)$[st]=mt.points[ct].point[st]+(mt.points[ct+1].point[st]-mt.points[ct].point[st])*gt;break}ct<lt-1?ct+=1:tt=!1}i._lastPoint=ct,i._lastAddedLength=vt-mt.points[ct].partialLength,i._lastKeyframeIndex=_e}}else{var St,At,xt,wt,Ot;if(et=rt.s.length,dt=nt.s||rt.e,this.sh&&rt.h!==1)if(o>=ut)$[0]=dt[0],$[1]=dt[1],$[2]=dt[2];else if(o<=ht)$[0]=rt.s[0],$[1]=rt.s[1],$[2]=rt.s[2];else{var Bt=createQuaternion(rt.s),Ft=createQuaternion(dt),Pt=(o-ht)/(ut-ht);quaternionToEuler($,slerp(Bt,Ft,Pt))}else for(_e=0;_e<et;_e+=1)rt.h!==1&&(o>=ut?ot=1:o<ht?ot=0:(rt.o.x.constructor===Array?(it.__fnct||(it.__fnct=[]),it.__fnct[_e]?ft=it.__fnct[_e]:(St=rt.o.x[_e]===void 0?rt.o.x[0]:rt.o.x[_e],At=rt.o.y[_e]===void 0?rt.o.y[0]:rt.o.y[_e],xt=rt.i.x[_e]===void 0?rt.i.x[0]:rt.i.x[_e],wt=rt.i.y[_e]===void 0?rt.i.y[0]:rt.i.y[_e],ft=BezierFactory.getBezierEasing(St,At,xt,wt).get,it.__fnct[_e]=ft)):it.__fnct?ft=it.__fnct:(St=rt.o.x,At=rt.o.y,xt=rt.i.x,wt=rt.i.y,ft=BezierFactory.getBezierEasing(St,At,xt,wt).get,rt.keyframeMetadata=ft),ot=ft((o-ht)/(ut-ht)))),dt=nt.s||rt.e,Ot=rt.h===1?rt.s[_e]:rt.s[_e]+(dt[_e]-rt.s[_e])*ot,this.propType==="multidimensional"?$[_e]=Ot:$=Ot}return i.lastIndex=j,$}function slerp(o,i,_){var $=[],j=o[0],_e=o[1],et=o[2],tt=o[3],rt=i[0],nt=i[1],it=i[2],st=i[3],at,ot,lt,ct,ft;return ot=j*rt+_e*nt+et*it+tt*st,ot<0&&(ot=-ot,rt=-rt,nt=-nt,it=-it,st=-st),1-ot>1e-6?(at=Math.acos(ot),lt=Math.sin(at),ct=Math.sin((1-_)*at)/lt,ft=Math.sin(_*at)/lt):(ct=1-_,ft=_),$[0]=ct*j+ft*rt,$[1]=ct*_e+ft*nt,$[2]=ct*et+ft*it,$[3]=ct*tt+ft*st,$}function quaternionToEuler(o,i){var _=i[0],$=i[1],j=i[2],_e=i[3],et=Math.atan2(2*$*_e-2*_*j,1-2*$*$-2*j*j),tt=Math.asin(2*_*$+2*j*_e),rt=Math.atan2(2*_*_e-2*$*j,1-2*_*_-2*j*j);o[0]=et/degToRads,o[1]=tt/degToRads,o[2]=rt/degToRads}function createQuaternion(o){var i=o[0]*degToRads,_=o[1]*degToRads,$=o[2]*degToRads,j=Math.cos(i/2),_e=Math.cos(_/2),et=Math.cos($/2),tt=Math.sin(i/2),rt=Math.sin(_/2),nt=Math.sin($/2),it=j*_e*et-tt*rt*nt,st=tt*rt*et+j*_e*nt,at=tt*_e*et+j*rt*nt,ot=j*rt*et-tt*_e*nt;return[st,at,ot,it]}function getValueAtCurrentTime(){var o=this.comp.renderedFrame-this.offsetTime,i=this.keyframes[0].t-this.offsetTime,_=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(o===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=_&&o>=_||this._caching.lastFrame<i&&o<i))){this._caching.lastFrame>=o&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var $=this.interpolateValue(o,this._caching);this.pv=$}return this._caching.lastFrame=o,this.pv}function setVValue(o){var i;if(this.propType==="unidimensional")i=o*this.mult,mathAbs(this.v-i)>1e-5&&(this.v=i,this._mdf=!0);else for(var _=0,$=this.v.length;_<$;)i=o[_]*this.mult,mathAbs(this.v[_]-i)>1e-5&&(this.v[_]=i,this._mdf=!0),_+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var o,i=this.effectsSequence.length,_=this.kf?this.pv:this.data.k;for(o=0;o<i;o+=1)_=this.effectsSequence[o](_);this.setVValue(_),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(o){this.effectsSequence.push(o),this.container.addDynamicProperty(this)}function ValueProperty(o,i,_,$){this.propType="unidimensional",this.mult=_||1,this.data=i,this.v=_?i.k*_:i.k,this.pv=i.k,this._mdf=!1,this.elem=o,this.container=$,this.comp=o.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(o,i,_,$){this.propType="multidimensional",this.mult=_||1,this.data=i,this._mdf=!1,this.elem=o,this.container=$,this.comp=o.comp,this.k=!1,this.kf=!1,this.frameId=-1;var j,_e=i.k.length;for(this.v=createTypedArray("float32",_e),this.pv=createTypedArray("float32",_e),this.vel=createTypedArray("float32",_e),j=0;j<_e;j+=1)this.v[j]=i.k[j]*this.mult,this.pv[j]=i.k[j];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(o,i,_,$){this.propType="unidimensional",this.keyframes=i.k,this.keyframesMetadata=[],this.offsetTime=o.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=i,this.mult=_||1,this.elem=o,this.container=$,this.comp=o.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(o,i,_,$){this.propType="multidimensional";var j,_e=i.k.length,et,tt,rt,nt;for(j=0;j<_e-1;j+=1)i.k[j].to&&i.k[j].s&&i.k[j+1]&&i.k[j+1].s&&(et=i.k[j].s,tt=i.k[j+1].s,rt=i.k[j].to,nt=i.k[j].ti,(et.length===2&&!(et[0]===tt[0]&&et[1]===tt[1])&&bez.pointOnLine2D(et[0],et[1],tt[0],tt[1],et[0]+rt[0],et[1]+rt[1])&&bez.pointOnLine2D(et[0],et[1],tt[0],tt[1],tt[0]+nt[0],tt[1]+nt[1])||et.length===3&&!(et[0]===tt[0]&&et[1]===tt[1]&&et[2]===tt[2])&&bez.pointOnLine3D(et[0],et[1],et[2],tt[0],tt[1],tt[2],et[0]+rt[0],et[1]+rt[1],et[2]+rt[2])&&bez.pointOnLine3D(et[0],et[1],et[2],tt[0],tt[1],tt[2],tt[0]+nt[0],tt[1]+nt[1],tt[2]+nt[2]))&&(i.k[j].to=null,i.k[j].ti=null),et[0]===tt[0]&&et[1]===tt[1]&&rt[0]===0&&rt[1]===0&&nt[0]===0&&nt[1]===0&&(et.length===2||et[2]===tt[2]&&rt[2]===0&&nt[2]===0)&&(i.k[j].to=null,i.k[j].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=i,this.keyframes=i.k,this.keyframesMetadata=[],this.offsetTime=o.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=_||1,this.elem=o,this.container=$,this.comp=o.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var it=i.k[0].s.length;for(this.v=createTypedArray("float32",it),this.pv=createTypedArray("float32",it),j=0;j<it;j+=1)this.v[j]=initFrame,this.pv[j]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",it)},this.addEffect=addEffect}var PropertyFactory=function(){function o(_,$,j,_e,et){$.sid&&($=_.globalData.slotManager.getProp($));var tt;if(!$.k.length)tt=new ValueProperty(_,$,_e,et);else if(typeof $.k[0]=="number")tt=new MultiDimensionalProperty(_,$,_e,et);else switch(j){case 0:tt=new KeyframedValueProperty(_,$,_e,et);break;case 1:tt=new KeyframedMultidimensionalProperty(_,$,_e,et);break}return tt.effectsSequence.length&&et.addDynamicProperty(tt),tt}var i={getProp:o};return i}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(i){this.dynamicProperties.indexOf(i)===-1&&(this.dynamicProperties.push(i),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var i,_=this.dynamicProperties.length;for(i=0;i<_;i+=1)this.dynamicProperties[i].getValue(),this.dynamicProperties[i]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(i){this.container=i,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function o(){return createTypedArray("float32",2)}return poolFactory(8,o)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(o,i){this.c=o,this.setLength(i);for(var _=0;_<i;)this.v[_]=pointPool.newElement(),this.o[_]=pointPool.newElement(),this.i[_]=pointPool.newElement(),_+=1},ShapePath.prototype.setLength=function(o){for(;this._maxLength<o;)this.doubleArrayLength();this._length=o},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(o,i,_,$,j){var _e;switch(this._length=Math.max(this._length,$+1),this._length>=this._maxLength&&this.doubleArrayLength(),_){case"v":_e=this.v;break;case"i":_e=this.i;break;case"o":_e=this.o;break;default:_e=[];break}(!_e[$]||_e[$]&&!j)&&(_e[$]=pointPool.newElement()),_e[$][0]=o,_e[$][1]=i},ShapePath.prototype.setTripleAt=function(o,i,_,$,j,_e,et,tt){this.setXYAt(o,i,"v",et,tt),this.setXYAt(_,$,"o",et,tt),this.setXYAt(j,_e,"i",et,tt)},ShapePath.prototype.reverse=function(){var o=new ShapePath;o.setPathData(this.c,this._length);var i=this.v,_=this.o,$=this.i,j=0;this.c&&(o.setTripleAt(i[0][0],i[0][1],$[0][0],$[0][1],_[0][0],_[0][1],0,!1),j=1);var _e=this._length-1,et=this._length,tt;for(tt=j;tt<et;tt+=1)o.setTripleAt(i[_e][0],i[_e][1],$[_e][0],$[_e][1],_[_e][0],_[_e][1],tt,!1),_e-=1;return o},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function o(){return new ShapePath}function i(j){var _e=j._length,et;for(et=0;et<_e;et+=1)pointPool.release(j.v[et]),pointPool.release(j.i[et]),pointPool.release(j.o[et]),j.v[et]=null,j.i[et]=null,j.o[et]=null;j._length=0,j.c=!1}function _(j){var _e=$.newElement(),et,tt=j._length===void 0?j.v.length:j._length;for(_e.setLength(tt),_e.c=j.c,et=0;et<tt;et+=1)_e.setTripleAt(j.v[et][0],j.v[et][1],j.o[et][0],j.o[et][1],j.i[et][0],j.i[et][1],et);return _e}var $=poolFactory(4,o,i);return $.clone=_,$}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(o){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=o,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var o;for(o=0;o<this._length;o+=1)shapePool.release(this.shapes[o]);this._length=0};var shapeCollectionPool=function(){var o={newShapeCollection:j,release:_e},i=0,_=4,$=createSizedArray(_);function j(){var et;return i?(i-=1,et=$[i]):et=new ShapeCollection,et}function _e(et){var tt,rt=et._length;for(tt=0;tt<rt;tt+=1)shapePool.release(et.shapes[tt]);et._length=0,i===_&&($=pooling.double($),_*=2),$[i]=et,i+=1}return o}(),ShapePropertyFactory=function(){var o=-999999;function i(ut,ht,dt){var mt=dt.lastIndex,pt,yt,gt,vt,St,At,xt,wt,Ot,Bt=this.keyframes;if(ut<Bt[0].t-this.offsetTime)pt=Bt[0].s[0],gt=!0,mt=0;else if(ut>=Bt[Bt.length-1].t-this.offsetTime)pt=Bt[Bt.length-1].s?Bt[Bt.length-1].s[0]:Bt[Bt.length-2].e[0],gt=!0;else{for(var Ft=mt,Pt=Bt.length-1,Rt=!0,Et,_t,Mt;Rt&&(Et=Bt[Ft],_t=Bt[Ft+1],!(_t.t-this.offsetTime>ut));)Ft<Pt-1?Ft+=1:Rt=!1;if(Mt=this.keyframesMetadata[Ft]||{},gt=Et.h===1,mt=Ft,!gt){if(ut>=_t.t-this.offsetTime)wt=1;else if(ut<Et.t-this.offsetTime)wt=0;else{var Dt;Mt.__fnct?Dt=Mt.__fnct:(Dt=BezierFactory.getBezierEasing(Et.o.x,Et.o.y,Et.i.x,Et.i.y).get,Mt.__fnct=Dt),wt=Dt((ut-(Et.t-this.offsetTime))/(_t.t-this.offsetTime-(Et.t-this.offsetTime)))}yt=_t.s?_t.s[0]:Et.e[0]}pt=Et.s[0]}for(At=ht._length,xt=pt.i[0].length,dt.lastIndex=mt,vt=0;vt<At;vt+=1)for(St=0;St<xt;St+=1)Ot=gt?pt.i[vt][St]:pt.i[vt][St]+(yt.i[vt][St]-pt.i[vt][St])*wt,ht.i[vt][St]=Ot,Ot=gt?pt.o[vt][St]:pt.o[vt][St]+(yt.o[vt][St]-pt.o[vt][St])*wt,ht.o[vt][St]=Ot,Ot=gt?pt.v[vt][St]:pt.v[vt][St]+(yt.v[vt][St]-pt.v[vt][St])*wt,ht.v[vt][St]=Ot}function _(){var ut=this.comp.renderedFrame-this.offsetTime,ht=this.keyframes[0].t-this.offsetTime,dt=this.keyframes[this.keyframes.length-1].t-this.offsetTime,mt=this._caching.lastFrame;return mt!==o&&(mt<ht&&ut<ht||mt>dt&&ut>dt)||(this._caching.lastIndex=mt<ut?this._caching.lastIndex:0,this.interpolateShape(ut,this.pv,this._caching)),this._caching.lastFrame=ut,this.pv}function $(){this.paths=this.localShapeCollection}function j(ut,ht){if(ut._length!==ht._length||ut.c!==ht.c)return!1;var dt,mt=ut._length;for(dt=0;dt<mt;dt+=1)if(ut.v[dt][0]!==ht.v[dt][0]||ut.v[dt][1]!==ht.v[dt][1]||ut.o[dt][0]!==ht.o[dt][0]||ut.o[dt][1]!==ht.o[dt][1]||ut.i[dt][0]!==ht.i[dt][0]||ut.i[dt][1]!==ht.i[dt][1])return!1;return!0}function _e(ut){j(this.v,ut)||(this.v=shapePool.clone(ut),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function et(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var ut;this.kf?ut=this.pv:this.data.ks?ut=this.data.ks.k:ut=this.data.pt.k;var ht,dt=this.effectsSequence.length;for(ht=0;ht<dt;ht+=1)ut=this.effectsSequence[ht](ut);this.setVValue(ut),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function tt(ut,ht,dt){this.propType="shape",this.comp=ut.comp,this.container=ut,this.elem=ut,this.data=ht,this.k=!1,this.kf=!1,this._mdf=!1;var mt=dt===3?ht.pt.k:ht.ks.k;this.v=shapePool.clone(mt),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=$,this.effectsSequence=[]}function rt(ut){this.effectsSequence.push(ut),this.container.addDynamicProperty(this)}tt.prototype.interpolateShape=i,tt.prototype.getValue=et,tt.prototype.setVValue=_e,tt.prototype.addEffect=rt;function nt(ut,ht,dt){this.propType="shape",this.comp=ut.comp,this.elem=ut,this.container=ut,this.offsetTime=ut.data.st,this.keyframes=dt===3?ht.pt.k:ht.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var mt=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,mt),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=o,this.reset=$,this._caching={lastFrame:o,lastIndex:0},this.effectsSequence=[_.bind(this)]}nt.prototype.getValue=et,nt.prototype.interpolateShape=i,nt.prototype.setVValue=_e,nt.prototype.addEffect=rt;var it=function(){var ut=roundCorner;function ht(dt,mt){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=mt.d,this.elem=dt,this.comp=dt.comp,this.frameId=-1,this.initDynamicPropertyContainer(dt),this.p=PropertyFactory.getProp(dt,mt.p,1,0,this),this.s=PropertyFactory.getProp(dt,mt.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return ht.prototype={reset:$,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var mt=this.p.v[0],pt=this.p.v[1],yt=this.s.v[0]/2,gt=this.s.v[1]/2,vt=this.d!==3,St=this.v;St.v[0][0]=mt,St.v[0][1]=pt-gt,St.v[1][0]=vt?mt+yt:mt-yt,St.v[1][1]=pt,St.v[2][0]=mt,St.v[2][1]=pt+gt,St.v[3][0]=vt?mt-yt:mt+yt,St.v[3][1]=pt,St.i[0][0]=vt?mt-yt*ut:mt+yt*ut,St.i[0][1]=pt-gt,St.i[1][0]=vt?mt+yt:mt-yt,St.i[1][1]=pt-gt*ut,St.i[2][0]=vt?mt+yt*ut:mt-yt*ut,St.i[2][1]=pt+gt,St.i[3][0]=vt?mt-yt:mt+yt,St.i[3][1]=pt+gt*ut,St.o[0][0]=vt?mt+yt*ut:mt-yt*ut,St.o[0][1]=pt-gt,St.o[1][0]=vt?mt+yt:mt-yt,St.o[1][1]=pt+gt*ut,St.o[2][0]=vt?mt-yt*ut:mt+yt*ut,St.o[2][1]=pt+gt,St.o[3][0]=vt?mt-yt:mt+yt,St.o[3][1]=pt-gt*ut}},extendPrototype([DynamicPropertyContainer],ht),ht}(),st=function(){function ut(ht,dt){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=ht,this.comp=ht.comp,this.data=dt,this.frameId=-1,this.d=dt.d,this.initDynamicPropertyContainer(ht),dt.sy===1?(this.ir=PropertyFactory.getProp(ht,dt.ir,0,0,this),this.is=PropertyFactory.getProp(ht,dt.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(ht,dt.pt,0,0,this),this.p=PropertyFactory.getProp(ht,dt.p,1,0,this),this.r=PropertyFactory.getProp(ht,dt.r,0,degToRads,this),this.or=PropertyFactory.getProp(ht,dt.or,0,0,this),this.os=PropertyFactory.getProp(ht,dt.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return ut.prototype={reset:$,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var dt=Math.floor(this.pt.v)*2,mt=Math.PI*2/dt,pt=!0,yt=this.or.v,gt=this.ir.v,vt=this.os.v,St=this.is.v,At=2*Math.PI*yt/(dt*2),xt=2*Math.PI*gt/(dt*2),wt,Ot,Bt,Ft,Pt=-Math.PI/2;Pt+=this.r.v;var Rt=this.data.d===3?-1:1;for(this.v._length=0,wt=0;wt<dt;wt+=1){Ot=pt?yt:gt,Bt=pt?vt:St,Ft=pt?At:xt;var Et=Ot*Math.cos(Pt),_t=Ot*Math.sin(Pt),Mt=Et===0&&_t===0?0:_t/Math.sqrt(Et*Et+_t*_t),Dt=Et===0&&_t===0?0:-Et/Math.sqrt(Et*Et+_t*_t);Et+=+this.p.v[0],_t+=+this.p.v[1],this.v.setTripleAt(Et,_t,Et-Mt*Ft*Bt*Rt,_t-Dt*Ft*Bt*Rt,Et+Mt*Ft*Bt*Rt,_t+Dt*Ft*Bt*Rt,wt,!0),pt=!pt,Pt+=mt*Rt}},convertPolygonToPath:function(){var dt=Math.floor(this.pt.v),mt=Math.PI*2/dt,pt=this.or.v,yt=this.os.v,gt=2*Math.PI*pt/(dt*4),vt,St=-Math.PI*.5,At=this.data.d===3?-1:1;for(St+=this.r.v,this.v._length=0,vt=0;vt<dt;vt+=1){var xt=pt*Math.cos(St),wt=pt*Math.sin(St),Ot=xt===0&&wt===0?0:wt/Math.sqrt(xt*xt+wt*wt),Bt=xt===0&&wt===0?0:-xt/Math.sqrt(xt*xt+wt*wt);xt+=+this.p.v[0],wt+=+this.p.v[1],this.v.setTripleAt(xt,wt,xt-Ot*gt*yt*At,wt-Bt*gt*yt*At,xt+Ot*gt*yt*At,wt+Bt*gt*yt*At,vt,!0),St+=mt*At}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],ut),ut}(),at=function(){function ut(ht,dt){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=ht,this.comp=ht.comp,this.frameId=-1,this.d=dt.d,this.initDynamicPropertyContainer(ht),this.p=PropertyFactory.getProp(ht,dt.p,1,0,this),this.s=PropertyFactory.getProp(ht,dt.s,1,0,this),this.r=PropertyFactory.getProp(ht,dt.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return ut.prototype={convertRectToPath:function(){var dt=this.p.v[0],mt=this.p.v[1],pt=this.s.v[0]/2,yt=this.s.v[1]/2,gt=bmMin(pt,yt,this.r.v),vt=gt*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(dt+pt,mt-yt+gt,dt+pt,mt-yt+gt,dt+pt,mt-yt+vt,0,!0),this.v.setTripleAt(dt+pt,mt+yt-gt,dt+pt,mt+yt-vt,dt+pt,mt+yt-gt,1,!0),gt!==0?(this.v.setTripleAt(dt+pt-gt,mt+yt,dt+pt-gt,mt+yt,dt+pt-vt,mt+yt,2,!0),this.v.setTripleAt(dt-pt+gt,mt+yt,dt-pt+vt,mt+yt,dt-pt+gt,mt+yt,3,!0),this.v.setTripleAt(dt-pt,mt+yt-gt,dt-pt,mt+yt-gt,dt-pt,mt+yt-vt,4,!0),this.v.setTripleAt(dt-pt,mt-yt+gt,dt-pt,mt-yt+vt,dt-pt,mt-yt+gt,5,!0),this.v.setTripleAt(dt-pt+gt,mt-yt,dt-pt+gt,mt-yt,dt-pt+vt,mt-yt,6,!0),this.v.setTripleAt(dt+pt-gt,mt-yt,dt+pt-vt,mt-yt,dt+pt-gt,mt-yt,7,!0)):(this.v.setTripleAt(dt-pt,mt+yt,dt-pt+vt,mt+yt,dt-pt,mt+yt,2),this.v.setTripleAt(dt-pt,mt-yt,dt-pt,mt-yt+vt,dt-pt,mt-yt,3))):(this.v.setTripleAt(dt+pt,mt-yt+gt,dt+pt,mt-yt+vt,dt+pt,mt-yt+gt,0,!0),gt!==0?(this.v.setTripleAt(dt+pt-gt,mt-yt,dt+pt-gt,mt-yt,dt+pt-vt,mt-yt,1,!0),this.v.setTripleAt(dt-pt+gt,mt-yt,dt-pt+vt,mt-yt,dt-pt+gt,mt-yt,2,!0),this.v.setTripleAt(dt-pt,mt-yt+gt,dt-pt,mt-yt+gt,dt-pt,mt-yt+vt,3,!0),this.v.setTripleAt(dt-pt,mt+yt-gt,dt-pt,mt+yt-vt,dt-pt,mt+yt-gt,4,!0),this.v.setTripleAt(dt-pt+gt,mt+yt,dt-pt+gt,mt+yt,dt-pt+vt,mt+yt,5,!0),this.v.setTripleAt(dt+pt-gt,mt+yt,dt+pt-vt,mt+yt,dt+pt-gt,mt+yt,6,!0),this.v.setTripleAt(dt+pt,mt+yt-gt,dt+pt,mt+yt-gt,dt+pt,mt+yt-vt,7,!0)):(this.v.setTripleAt(dt-pt,mt-yt,dt-pt+vt,mt-yt,dt-pt,mt-yt,1,!0),this.v.setTripleAt(dt-pt,mt+yt,dt-pt,mt+yt-vt,dt-pt,mt+yt,2,!0),this.v.setTripleAt(dt+pt,mt+yt,dt+pt-vt,mt+yt,dt+pt,mt+yt,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:$},extendPrototype([DynamicPropertyContainer],ut),ut}();function ot(ut,ht,dt){var mt;if(dt===3||dt===4){var pt=dt===3?ht.pt:ht.ks,yt=pt.k;yt.length?mt=new nt(ut,ht,dt):mt=new tt(ut,ht,dt)}else dt===5?mt=new at(ut,ht):dt===6?mt=new it(ut,ht):dt===7&&(mt=new st(ut,ht));return mt.k&&ut.addDynamicProperty(mt),mt}function lt(){return tt}function ct(){return nt}var ft={};return ft.getShapeProp=ot,ft.getConstructorFunction=lt,ft.getKeyframedConstructorFunction=ct,ft}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var o=Math.cos,i=Math.sin,_=Math.tan,$=Math.round;function j(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function _e(Et){if(Et===0)return this;var _t=o(Et),Mt=i(Et);return this._t(_t,-Mt,0,0,Mt,_t,0,0,0,0,1,0,0,0,0,1)}function et(Et){if(Et===0)return this;var _t=o(Et),Mt=i(Et);return this._t(1,0,0,0,0,_t,-Mt,0,0,Mt,_t,0,0,0,0,1)}function tt(Et){if(Et===0)return this;var _t=o(Et),Mt=i(Et);return this._t(_t,0,Mt,0,0,1,0,0,-Mt,0,_t,0,0,0,0,1)}function rt(Et){if(Et===0)return this;var _t=o(Et),Mt=i(Et);return this._t(_t,-Mt,0,0,Mt,_t,0,0,0,0,1,0,0,0,0,1)}function nt(Et,_t){return this._t(1,_t,Et,1,0,0)}function it(Et,_t){return this.shear(_(Et),_(_t))}function st(Et,_t){var Mt=o(_t),Dt=i(_t);return this._t(Mt,Dt,0,0,-Dt,Mt,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,_(Et),1,0,0,0,0,1,0,0,0,0,1)._t(Mt,-Dt,0,0,Dt,Mt,0,0,0,0,1,0,0,0,0,1)}function at(Et,_t,Mt){return!Mt&&Mt!==0&&(Mt=1),Et===1&&_t===1&&Mt===1?this:this._t(Et,0,0,0,0,_t,0,0,0,0,Mt,0,0,0,0,1)}function ot(Et,_t,Mt,Dt,Lt,Ct,kt,jt,Vt,zt,qt,Wt,ir,or,Qt,gr){return this.props[0]=Et,this.props[1]=_t,this.props[2]=Mt,this.props[3]=Dt,this.props[4]=Lt,this.props[5]=Ct,this.props[6]=kt,this.props[7]=jt,this.props[8]=Vt,this.props[9]=zt,this.props[10]=qt,this.props[11]=Wt,this.props[12]=ir,this.props[13]=or,this.props[14]=Qt,this.props[15]=gr,this}function lt(Et,_t,Mt){return Mt=Mt||0,Et!==0||_t!==0||Mt!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,Et,_t,Mt,1):this}function ct(Et,_t,Mt,Dt,Lt,Ct,kt,jt,Vt,zt,qt,Wt,ir,or,Qt,gr){var ar=this.props;if(Et===1&&_t===0&&Mt===0&&Dt===0&&Lt===0&&Ct===1&&kt===0&&jt===0&&Vt===0&&zt===0&&qt===1&&Wt===0)return ar[12]=ar[12]*Et+ar[15]*ir,ar[13]=ar[13]*Ct+ar[15]*or,ar[14]=ar[14]*qt+ar[15]*Qt,ar[15]*=gr,this._identityCalculated=!1,this;var Ar=ar[0],er=ar[1],sr=ar[2],Gt=ar[3],Jt=ar[4],lr=ar[5],dr=ar[6],xr=ar[7],Mr=ar[8],Or=ar[9],fr=ar[10],Hr=ar[11],Gr=ar[12],dn=ar[13],nn=ar[14],vn=ar[15];return ar[0]=Ar*Et+er*Lt+sr*Vt+Gt*ir,ar[1]=Ar*_t+er*Ct+sr*zt+Gt*or,ar[2]=Ar*Mt+er*kt+sr*qt+Gt*Qt,ar[3]=Ar*Dt+er*jt+sr*Wt+Gt*gr,ar[4]=Jt*Et+lr*Lt+dr*Vt+xr*ir,ar[5]=Jt*_t+lr*Ct+dr*zt+xr*or,ar[6]=Jt*Mt+lr*kt+dr*qt+xr*Qt,ar[7]=Jt*Dt+lr*jt+dr*Wt+xr*gr,ar[8]=Mr*Et+Or*Lt+fr*Vt+Hr*ir,ar[9]=Mr*_t+Or*Ct+fr*zt+Hr*or,ar[10]=Mr*Mt+Or*kt+fr*qt+Hr*Qt,ar[11]=Mr*Dt+Or*jt+fr*Wt+Hr*gr,ar[12]=Gr*Et+dn*Lt+nn*Vt+vn*ir,ar[13]=Gr*_t+dn*Ct+nn*zt+vn*or,ar[14]=Gr*Mt+dn*kt+nn*qt+vn*Qt,ar[15]=Gr*Dt+dn*jt+nn*Wt+vn*gr,this._identityCalculated=!1,this}function ft(Et){var _t=Et.props;return this.transform(_t[0],_t[1],_t[2],_t[3],_t[4],_t[5],_t[6],_t[7],_t[8],_t[9],_t[10],_t[11],_t[12],_t[13],_t[14],_t[15])}function ut(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function ht(Et){for(var _t=0;_t<16;){if(Et.props[_t]!==this.props[_t])return!1;_t+=1}return!0}function dt(Et){var _t;for(_t=0;_t<16;_t+=1)Et.props[_t]=this.props[_t];return Et}function mt(Et){var _t;for(_t=0;_t<16;_t+=1)this.props[_t]=Et[_t]}function pt(Et,_t,Mt){return{x:Et*this.props[0]+_t*this.props[4]+Mt*this.props[8]+this.props[12],y:Et*this.props[1]+_t*this.props[5]+Mt*this.props[9]+this.props[13],z:Et*this.props[2]+_t*this.props[6]+Mt*this.props[10]+this.props[14]}}function yt(Et,_t,Mt){return Et*this.props[0]+_t*this.props[4]+Mt*this.props[8]+this.props[12]}function gt(Et,_t,Mt){return Et*this.props[1]+_t*this.props[5]+Mt*this.props[9]+this.props[13]}function vt(Et,_t,Mt){return Et*this.props[2]+_t*this.props[6]+Mt*this.props[10]+this.props[14]}function St(){var Et=this.props[0]*this.props[5]-this.props[1]*this.props[4],_t=this.props[5]/Et,Mt=-this.props[1]/Et,Dt=-this.props[4]/Et,Lt=this.props[0]/Et,Ct=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/Et,kt=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/Et,jt=new Matrix;return jt.props[0]=_t,jt.props[1]=Mt,jt.props[4]=Dt,jt.props[5]=Lt,jt.props[12]=Ct,jt.props[13]=kt,jt}function At(Et){var _t=this.getInverseMatrix();return _t.applyToPointArray(Et[0],Et[1],Et[2]||0)}function xt(Et){var _t,Mt=Et.length,Dt=[];for(_t=0;_t<Mt;_t+=1)Dt[_t]=At(Et[_t]);return Dt}function wt(Et,_t,Mt){var Dt=createTypedArray("float32",6);if(this.isIdentity())Dt[0]=Et[0],Dt[1]=Et[1],Dt[2]=_t[0],Dt[3]=_t[1],Dt[4]=Mt[0],Dt[5]=Mt[1];else{var Lt=this.props[0],Ct=this.props[1],kt=this.props[4],jt=this.props[5],Vt=this.props[12],zt=this.props[13];Dt[0]=Et[0]*Lt+Et[1]*kt+Vt,Dt[1]=Et[0]*Ct+Et[1]*jt+zt,Dt[2]=_t[0]*Lt+_t[1]*kt+Vt,Dt[3]=_t[0]*Ct+_t[1]*jt+zt,Dt[4]=Mt[0]*Lt+Mt[1]*kt+Vt,Dt[5]=Mt[0]*Ct+Mt[1]*jt+zt}return Dt}function Ot(Et,_t,Mt){var Dt;return this.isIdentity()?Dt=[Et,_t,Mt]:Dt=[Et*this.props[0]+_t*this.props[4]+Mt*this.props[8]+this.props[12],Et*this.props[1]+_t*this.props[5]+Mt*this.props[9]+this.props[13],Et*this.props[2]+_t*this.props[6]+Mt*this.props[10]+this.props[14]],Dt}function Bt(Et,_t){if(this.isIdentity())return Et+","+_t;var Mt=this.props;return Math.round((Et*Mt[0]+_t*Mt[4]+Mt[12])*100)/100+","+Math.round((Et*Mt[1]+_t*Mt[5]+Mt[13])*100)/100}function Ft(){for(var Et=0,_t=this.props,Mt="matrix3d(",Dt=1e4;Et<16;)Mt+=$(_t[Et]*Dt)/Dt,Mt+=Et===15?")":",",Et+=1;return Mt}function Pt(Et){var _t=1e4;return Et<1e-6&&Et>0||Et>-1e-6&&Et<0?$(Et*_t)/_t:Et}function Rt(){var Et=this.props,_t=Pt(Et[0]),Mt=Pt(Et[1]),Dt=Pt(Et[4]),Lt=Pt(Et[5]),Ct=Pt(Et[12]),kt=Pt(Et[13]);return"matrix("+_t+","+Mt+","+Dt+","+Lt+","+Ct+","+kt+")"}return function(){this.reset=j,this.rotate=_e,this.rotateX=et,this.rotateY=tt,this.rotateZ=rt,this.skew=it,this.skewFromAxis=st,this.shear=nt,this.scale=at,this.setTransform=ot,this.translate=lt,this.transform=ct,this.multiply=ft,this.applyToPoint=pt,this.applyToX=yt,this.applyToY=gt,this.applyToZ=vt,this.applyToPointArray=Ot,this.applyToTriplePoints=wt,this.applyToPointStringified=Bt,this.toCSS=Ft,this.to2dCSS=Rt,this.clone=dt,this.cloneFromProps=mt,this.equals=ht,this.inversePoints=xt,this.inversePoint=At,this.getInverseMatrix=St,this._t=this.transform,this.isIdentity=ut,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(o){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$3(o)}var lottie={};function setLocation(o){setLocationHref(o)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(o){setSubframeEnabled(o)}function setPrefix(o){setIdPrefix(o)}function loadAnimation(o){return animationManager.loadAnimation(o)}function setQuality(o){if(typeof o=="string")switch(o){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(o)&&o>1&&setDefaultCurveSegments(o)}function inBrowser(){return typeof navigator<"u"}function installPlugin(o,i){o==="expressions"&&setExpressionsPlugin(i)}function getFactory(o){switch(o){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(o){for(var i=queryString.split("&"),_=0;_<i.length;_+=1){var $=i[_].split("=");if(decodeURIComponent($[0])==o)return decodeURIComponent($[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(o){}var ShapeModifiers=function(){var o={},i={};o.registerModifier=_,o.getModifier=$;function _(j,_e){i[j]||(i[j]=_e)}function $(j,_e,et){return new i[j](_e,et)}return o}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(o){if(!this.closed){o.sh.container.addDynamicProperty(o.sh);var i={shape:o.sh,data:o,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(i),this.addShapeToModifier(i),this._isAnimated&&o.setAsAnimated()}},ShapeModifier.prototype.init=function(o,i){this.shapes=[],this.elem=o,this.initDynamicPropertyContainer(o),this.initModifierProperties(o,i),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(o,i){this.s=PropertyFactory.getProp(o,i.s,0,.01,this),this.e=PropertyFactory.getProp(o,i.e,0,.01,this),this.o=PropertyFactory.getProp(o,i.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=i.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(o){o.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(o,i,_,$,j){var _e=[];i<=1?_e.push({s:o,e:i}):o>=1?_e.push({s:o-1,e:i-1}):(_e.push({s:o,e:1}),_e.push({s:0,e:i-1}));var et=[],tt,rt=_e.length,nt;for(tt=0;tt<rt;tt+=1)if(nt=_e[tt],!(nt.e*j<$||nt.s*j>$+_)){var it,st;nt.s*j<=$?it=0:it=(nt.s*j-$)/_,nt.e*j>=$+_?st=1:st=(nt.e*j-$)/_,et.push([it,st])}return et.length||et.push([0,0]),et},TrimModifier.prototype.releasePathsData=function(o){var i,_=o.length;for(i=0;i<_;i+=1)segmentsLengthPool.release(o[i]);return o.length=0,o},TrimModifier.prototype.processShapes=function(o){var i,_;if(this._mdf||o){var $=this.o.v%360/360;if($<0&&($+=1),this.s.v>1?i=1+$:this.s.v<0?i=0+$:i=this.s.v+$,this.e.v>1?_=1+$:this.e.v<0?_=0+$:_=this.e.v+$,i>_){var j=i;i=_,_=j}i=Math.round(i*1e4)*1e-4,_=Math.round(_*1e4)*1e-4,this.sValue=i,this.eValue=_}else i=this.sValue,_=this.eValue;var _e,et,tt=this.shapes.length,rt,nt,it,st,at,ot=0;if(_===i)for(et=0;et<tt;et+=1)this.shapes[et].localShapeCollection.releaseShapes(),this.shapes[et].shape._mdf=!0,this.shapes[et].shape.paths=this.shapes[et].localShapeCollection,this._mdf&&(this.shapes[et].pathsData.length=0);else if(_===1&&i===0||_===0&&i===1){if(this._mdf)for(et=0;et<tt;et+=1)this.shapes[et].pathsData.length=0,this.shapes[et].shape._mdf=!0}else{var lt=[],ct,ft;for(et=0;et<tt;et+=1)if(ct=this.shapes[et],!ct.shape._mdf&&!this._mdf&&!o&&this.m!==2)ct.shape.paths=ct.localShapeCollection;else{if(_e=ct.shape.paths,nt=_e._length,at=0,!ct.shape._mdf&&ct.pathsData.length)at=ct.totalShapeLength;else{for(it=this.releasePathsData(ct.pathsData),rt=0;rt<nt;rt+=1)st=bez.getSegmentsLength(_e.shapes[rt]),it.push(st),at+=st.totalLength;ct.totalShapeLength=at,ct.pathsData=it}ot+=at,ct.shape._mdf=!0}var ut=i,ht=_,dt=0,mt;for(et=tt-1;et>=0;et-=1)if(ct=this.shapes[et],ct.shape._mdf){for(ft=ct.localShapeCollection,ft.releaseShapes(),this.m===2&&tt>1?(mt=this.calculateShapeEdges(i,_,ct.totalShapeLength,dt,ot),dt+=ct.totalShapeLength):mt=[[ut,ht]],nt=mt.length,rt=0;rt<nt;rt+=1){ut=mt[rt][0],ht=mt[rt][1],lt.length=0,ht<=1?lt.push({s:ct.totalShapeLength*ut,e:ct.totalShapeLength*ht}):ut>=1?lt.push({s:ct.totalShapeLength*(ut-1),e:ct.totalShapeLength*(ht-1)}):(lt.push({s:ct.totalShapeLength*ut,e:ct.totalShapeLength}),lt.push({s:0,e:ct.totalShapeLength*(ht-1)}));var pt=this.addShapes(ct,lt[0]);if(lt[0].s!==lt[0].e){if(lt.length>1){var yt=ct.shape.paths.shapes[ct.shape.paths._length-1];if(yt.c){var gt=pt.pop();this.addPaths(pt,ft),pt=this.addShapes(ct,lt[1],gt)}else this.addPaths(pt,ft),pt=this.addShapes(ct,lt[1])}this.addPaths(pt,ft)}}ct.shape.paths=ft}}},TrimModifier.prototype.addPaths=function(o,i){var _,$=o.length;for(_=0;_<$;_+=1)i.addShape(o[_])},TrimModifier.prototype.addSegment=function(o,i,_,$,j,_e,et){j.setXYAt(i[0],i[1],"o",_e),j.setXYAt(_[0],_[1],"i",_e+1),et&&j.setXYAt(o[0],o[1],"v",_e),j.setXYAt($[0],$[1],"v",_e+1)},TrimModifier.prototype.addSegmentFromArray=function(o,i,_,$){i.setXYAt(o[1],o[5],"o",_),i.setXYAt(o[2],o[6],"i",_+1),$&&i.setXYAt(o[0],o[4],"v",_),i.setXYAt(o[3],o[7],"v",_+1)},TrimModifier.prototype.addShapes=function(o,i,_){var $=o.pathsData,j=o.shape.paths.shapes,_e,et=o.shape.paths._length,tt,rt,nt=0,it,st,at,ot,lt=[],ct,ft=!0;for(_?(st=_._length,ct=_._length):(_=shapePool.newElement(),st=0,ct=0),lt.push(_),_e=0;_e<et;_e+=1){for(at=$[_e].lengths,_.c=j[_e].c,rt=j[_e].c?at.length:at.length+1,tt=1;tt<rt;tt+=1)if(it=at[tt-1],nt+it.addedLength<i.s)nt+=it.addedLength,_.c=!1;else if(nt>i.e){_.c=!1;break}else i.s<=nt&&i.e>=nt+it.addedLength?(this.addSegment(j[_e].v[tt-1],j[_e].o[tt-1],j[_e].i[tt],j[_e].v[tt],_,st,ft),ft=!1):(ot=bez.getNewSegment(j[_e].v[tt-1],j[_e].v[tt],j[_e].o[tt-1],j[_e].i[tt],(i.s-nt)/it.addedLength,(i.e-nt)/it.addedLength,at[tt-1]),this.addSegmentFromArray(ot,_,st,ft),ft=!1,_.c=!1),nt+=it.addedLength,st+=1;if(j[_e].c&&at.length){if(it=at[tt-1],nt<=i.e){var ut=at[tt-1].addedLength;i.s<=nt&&i.e>=nt+ut?(this.addSegment(j[_e].v[tt-1],j[_e].o[tt-1],j[_e].i[0],j[_e].v[0],_,st,ft),ft=!1):(ot=bez.getNewSegment(j[_e].v[tt-1],j[_e].v[0],j[_e].o[tt-1],j[_e].i[0],(i.s-nt)/ut,(i.e-nt)/ut,at[tt-1]),this.addSegmentFromArray(ot,_,st,ft),ft=!1,_.c=!1)}else _.c=!1;nt+=it.addedLength,st+=1}if(_._length&&(_.setXYAt(_.v[ct][0],_.v[ct][1],"i",ct),_.setXYAt(_.v[_._length-1][0],_.v[_._length-1][1],"o",_._length-1)),nt>i.e)break;_e<et-1&&(_=shapePool.newElement(),ft=!0,lt.push(_),st=0)}return lt};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(o,i){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(o,i.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(o,i){var _=i/100,$=[0,0],j=o._length,_e=0;for(_e=0;_e<j;_e+=1)$[0]+=o.v[_e][0],$[1]+=o.v[_e][1];$[0]/=j,$[1]/=j;var et=shapePool.newElement();et.c=o.c;var tt,rt,nt,it,st,at;for(_e=0;_e<j;_e+=1)tt=o.v[_e][0]+($[0]-o.v[_e][0])*_,rt=o.v[_e][1]+($[1]-o.v[_e][1])*_,nt=o.o[_e][0]+($[0]-o.o[_e][0])*-_,it=o.o[_e][1]+($[1]-o.o[_e][1])*-_,st=o.i[_e][0]+($[0]-o.i[_e][0])*-_,at=o.i[_e][1]+($[1]-o.i[_e][1])*-_,et.setTripleAt(tt,rt,nt,it,st,at,_e);return et},PuckerAndBloatModifier.prototype.processShapes=function(o){var i,_,$=this.shapes.length,j,_e,et=this.amount.v;if(et!==0){var tt,rt;for(_=0;_<$;_+=1){if(tt=this.shapes[_],rt=tt.localShapeCollection,!(!tt.shape._mdf&&!this._mdf&&!o))for(rt.releaseShapes(),tt.shape._mdf=!0,i=tt.shape.paths.shapes,_e=tt.shape.paths._length,j=0;j<_e;j+=1)rt.addShape(this.processPath(i[j],et));tt.shape.paths=tt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var o=[0,0];function i(rt){var nt=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||nt,this.a&&rt.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&rt.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&rt.skewFromAxis(-this.sk.v,this.sa.v),this.r?rt.rotate(-this.r.v):rt.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?rt.translate(this.px.v,this.py.v,-this.pz.v):rt.translate(this.px.v,this.py.v,0):rt.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function _(rt){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||rt){var nt;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var it,st;if(nt=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(it=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/nt,0),st=this.p.getValueAtTime(this.p.keyframes[0].t/nt,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(it=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/nt,0),st=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/nt,0)):(it=this.p.pv,st=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/nt,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){it=[],st=[];var at=this.px,ot=this.py;at._caching.lastFrame+at.offsetTime<=at.keyframes[0].t?(it[0]=at.getValueAtTime((at.keyframes[0].t+.01)/nt,0),it[1]=ot.getValueAtTime((ot.keyframes[0].t+.01)/nt,0),st[0]=at.getValueAtTime(at.keyframes[0].t/nt,0),st[1]=ot.getValueAtTime(ot.keyframes[0].t/nt,0)):at._caching.lastFrame+at.offsetTime>=at.keyframes[at.keyframes.length-1].t?(it[0]=at.getValueAtTime(at.keyframes[at.keyframes.length-1].t/nt,0),it[1]=ot.getValueAtTime(ot.keyframes[ot.keyframes.length-1].t/nt,0),st[0]=at.getValueAtTime((at.keyframes[at.keyframes.length-1].t-.01)/nt,0),st[1]=ot.getValueAtTime((ot.keyframes[ot.keyframes.length-1].t-.01)/nt,0)):(it=[at.pv,ot.pv],st[0]=at.getValueAtTime((at._caching.lastFrame+at.offsetTime-.01)/nt,at.offsetTime),st[1]=ot.getValueAtTime((ot._caching.lastFrame+ot.offsetTime-.01)/nt,ot.offsetTime))}else st=o,it=st;this.v.rotate(-Math.atan2(it[1]-st[1],it[0]-st[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function $(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function j(){}function _e(rt){this._addDynamicProperty(rt),this.elem.addDynamicProperty(rt),this._isDirty=!0}function et(rt,nt,it){if(this.elem=rt,this.frameId=-1,this.propType="transform",this.data=nt,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(it||rt),nt.p&&nt.p.s?(this.px=PropertyFactory.getProp(rt,nt.p.x,0,0,this),this.py=PropertyFactory.getProp(rt,nt.p.y,0,0,this),nt.p.z&&(this.pz=PropertyFactory.getProp(rt,nt.p.z,0,0,this))):this.p=PropertyFactory.getProp(rt,nt.p||{k:[0,0,0]},1,0,this),nt.rx){if(this.rx=PropertyFactory.getProp(rt,nt.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(rt,nt.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(rt,nt.rz,0,degToRads,this),nt.or.k[0].ti){var st,at=nt.or.k.length;for(st=0;st<at;st+=1)nt.or.k[st].to=null,nt.or.k[st].ti=null}this.or=PropertyFactory.getProp(rt,nt.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(rt,nt.r||{k:0},0,degToRads,this);nt.sk&&(this.sk=PropertyFactory.getProp(rt,nt.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(rt,nt.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(rt,nt.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(rt,nt.s||{k:[100,100,100]},1,.01,this),nt.o?this.o=PropertyFactory.getProp(rt,nt.o,0,.01,rt):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}et.prototype={applyToMatrix:i,getValue:_,precalculateMatrix:$,autoOrient:j},extendPrototype([DynamicPropertyContainer],et),et.prototype.addDynamicProperty=_e,et.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function tt(rt,nt,it){return new et(rt,nt,it)}return{getTransformProperty:tt}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(o,i){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(o,i.c,0,null,this),this.o=PropertyFactory.getProp(o,i.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(o,i.tr,this),this.so=PropertyFactory.getProp(o,i.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(o,i.tr.eo,0,.01,this),this.data=i,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(o,i,_,$,j,_e){var et=_e?-1:1,tt=$.s.v[0]+(1-$.s.v[0])*(1-j),rt=$.s.v[1]+(1-$.s.v[1])*(1-j);o.translate($.p.v[0]*et*j,$.p.v[1]*et*j,$.p.v[2]),i.translate(-$.a.v[0],-$.a.v[1],$.a.v[2]),i.rotate(-$.r.v*et*j),i.translate($.a.v[0],$.a.v[1],$.a.v[2]),_.translate(-$.a.v[0],-$.a.v[1],$.a.v[2]),_.scale(_e?1/tt:tt,_e?1/rt:rt),_.translate($.a.v[0],$.a.v[1],$.a.v[2])},RepeaterModifier.prototype.init=function(o,i,_,$){for(this.elem=o,this.arr=i,this.pos=_,this.elemsData=$,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(o),this.initModifierProperties(o,i[_]);_>0;)_-=1,this._elements.unshift(i[_]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(o){var i,_=o.length;for(i=0;i<_;i+=1)o[i]._processed=!1,o[i].ty==="gr"&&this.resetElements(o[i].it)},RepeaterModifier.prototype.cloneElements=function(o){var i=JSON.parse(JSON.stringify(o));return this.resetElements(i),i},RepeaterModifier.prototype.changeGroupRender=function(o,i){var _,$=o.length;for(_=0;_<$;_+=1)o[_]._render=i,o[_].ty==="gr"&&this.changeGroupRender(o[_].it,i)},RepeaterModifier.prototype.processShapes=function(o){var i,_,$,j,_e,et=!1;if(this._mdf||o){var tt=Math.ceil(this.c.v);if(this._groups.length<tt){for(;this._groups.length<tt;){var rt={it:this.cloneElements(this._elements),ty:"gr"};rt.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,rt),this._groups.splice(0,0,rt),this._currentCopies+=1}this.elem.reloadShapes(),et=!0}_e=0;var nt;for($=0;$<=this._groups.length-1;$+=1){if(nt=_e<tt,this._groups[$]._render=nt,this.changeGroupRender(this._groups[$].it,nt),!nt){var it=this.elemsData[$].it,st=it[it.length-1];st.transform.op.v!==0?(st.transform.op._mdf=!0,st.transform.op.v=0):st.transform.op._mdf=!1}_e+=1}this._currentCopies=tt;var at=this.o.v,ot=at%1,lt=at>0?Math.floor(at):Math.ceil(at),ct=this.pMatrix.props,ft=this.rMatrix.props,ut=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var ht=0;if(at>0){for(;ht<lt;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),ht+=1;ot&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,ot,!1),ht+=ot)}else if(at<0){for(;ht>lt;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),ht-=1;ot&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-ot,!0),ht-=ot)}$=this.data.m===1?0:this._currentCopies-1,j=this.data.m===1?1:-1,_e=this._currentCopies;for(var dt,mt;_e;){if(i=this.elemsData[$].it,_=i[i.length-1].transform.mProps.v.props,mt=_.length,i[i.length-1].transform.mProps._mdf=!0,i[i.length-1].transform.op._mdf=!0,i[i.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*($/(this._currentCopies-1)),ht!==0){for(($!==0&&j===1||$!==this._currentCopies-1&&j===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(ft[0],ft[1],ft[2],ft[3],ft[4],ft[5],ft[6],ft[7],ft[8],ft[9],ft[10],ft[11],ft[12],ft[13],ft[14],ft[15]),this.matrix.transform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5],ut[6],ut[7],ut[8],ut[9],ut[10],ut[11],ut[12],ut[13],ut[14],ut[15]),this.matrix.transform(ct[0],ct[1],ct[2],ct[3],ct[4],ct[5],ct[6],ct[7],ct[8],ct[9],ct[10],ct[11],ct[12],ct[13],ct[14],ct[15]),dt=0;dt<mt;dt+=1)_[dt]=this.matrix.props[dt];this.matrix.reset()}else for(this.matrix.reset(),dt=0;dt<mt;dt+=1)_[dt]=this.matrix.props[dt];ht+=1,_e-=1,$+=j}}else for(_e=this._currentCopies,$=0,j=1;_e;)i=this.elemsData[$].it,_=i[i.length-1].transform.mProps.v.props,i[i.length-1].transform.mProps._mdf=!1,i[i.length-1].transform.op._mdf=!1,_e-=1,$+=j;return et},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(o,i){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(o,i.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(o,i){var _=shapePool.newElement();_.c=o.c;var $,j=o._length,_e,et,tt,rt,nt,it,st=0,at,ot,lt,ct,ft,ut;for($=0;$<j;$+=1)_e=o.v[$],tt=o.o[$],et=o.i[$],_e[0]===tt[0]&&_e[1]===tt[1]&&_e[0]===et[0]&&_e[1]===et[1]?($===0||$===j-1)&&!o.c?(_.setTripleAt(_e[0],_e[1],tt[0],tt[1],et[0],et[1],st),st+=1):($===0?rt=o.v[j-1]:rt=o.v[$-1],nt=Math.sqrt(Math.pow(_e[0]-rt[0],2)+Math.pow(_e[1]-rt[1],2)),it=nt?Math.min(nt/2,i)/nt:0,ft=_e[0]+(rt[0]-_e[0])*it,at=ft,ut=_e[1]-(_e[1]-rt[1])*it,ot=ut,lt=at-(at-_e[0])*roundCorner,ct=ot-(ot-_e[1])*roundCorner,_.setTripleAt(at,ot,lt,ct,ft,ut,st),st+=1,$===j-1?rt=o.v[0]:rt=o.v[$+1],nt=Math.sqrt(Math.pow(_e[0]-rt[0],2)+Math.pow(_e[1]-rt[1],2)),it=nt?Math.min(nt/2,i)/nt:0,lt=_e[0]+(rt[0]-_e[0])*it,at=lt,ct=_e[1]+(rt[1]-_e[1])*it,ot=ct,ft=at-(at-_e[0])*roundCorner,ut=ot-(ot-_e[1])*roundCorner,_.setTripleAt(at,ot,lt,ct,ft,ut,st),st+=1):(_.setTripleAt(o.v[$][0],o.v[$][1],o.o[$][0],o.o[$][1],o.i[$][0],o.i[$][1],st),st+=1);return _},RoundCornersModifier.prototype.processShapes=function(o){var i,_,$=this.shapes.length,j,_e,et=this.rd.v;if(et!==0){var tt,rt;for(_=0;_<$;_+=1){if(tt=this.shapes[_],rt=tt.localShapeCollection,!(!tt.shape._mdf&&!this._mdf&&!o))for(rt.releaseShapes(),tt.shape._mdf=!0,i=tt.shape.paths.shapes,_e=tt.shape.paths._length,j=0;j<_e;j+=1)rt.addShape(this.processPath(i[j],et));tt.shape.paths=tt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(o,i){return Math.abs(o-i)*1e5<=Math.min(Math.abs(o),Math.abs(i))}function floatZero(o){return Math.abs(o)<=1e-5}function lerp(o,i,_){return o*(1-_)+i*_}function lerpPoint(o,i,_){return[lerp(o[0],i[0],_),lerp(o[1],i[1],_)]}function quadRoots(o,i,_){if(o===0)return[];var $=i*i-4*o*_;if($<0)return[];var j=-i/(2*o);if($===0)return[j];var _e=Math.sqrt($)/(2*o);return[j-_e,j+_e]}function polynomialCoefficients(o,i,_,$){return[-o+3*i-3*_+$,3*o-6*i+3*_,-3*o+3*i,o]}function singlePoint(o){return new PolynomialBezier(o,o,o,o,!1)}function PolynomialBezier(o,i,_,$,j){j&&pointEqual(o,i)&&(i=lerpPoint(o,$,1/3)),j&&pointEqual(_,$)&&(_=lerpPoint(o,$,2/3));var _e=polynomialCoefficients(o[0],i[0],_[0],$[0]),et=polynomialCoefficients(o[1],i[1],_[1],$[1]);this.a=[_e[0],et[0]],this.b=[_e[1],et[1]],this.c=[_e[2],et[2]],this.d=[_e[3],et[3]],this.points=[o,i,_,$]}PolynomialBezier.prototype.point=function(o){return[((this.a[0]*o+this.b[0])*o+this.c[0])*o+this.d[0],((this.a[1]*o+this.b[1])*o+this.c[1])*o+this.d[1]]},PolynomialBezier.prototype.derivative=function(o){return[(3*o*this.a[0]+2*this.b[0])*o+this.c[0],(3*o*this.a[1]+2*this.b[1])*o+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(o){var i=this.derivative(o);return Math.atan2(i[1],i[0])},PolynomialBezier.prototype.normalAngle=function(o){var i=this.derivative(o);return Math.atan2(i[0],i[1])},PolynomialBezier.prototype.inflectionPoints=function(){var o=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(o))return[];var i=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/o,_=i*i-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/o;if(_<0)return[];var $=Math.sqrt(_);return floatZero($)?$>0&&$<1?[i]:[]:[i-$,i+$].filter(function(j){return j>0&&j<1})},PolynomialBezier.prototype.split=function(o){if(o<=0)return[singlePoint(this.points[0]),this];if(o>=1)return[this,singlePoint(this.points[this.points.length-1])];var i=lerpPoint(this.points[0],this.points[1],o),_=lerpPoint(this.points[1],this.points[2],o),$=lerpPoint(this.points[2],this.points[3],o),j=lerpPoint(i,_,o),_e=lerpPoint(_,$,o),et=lerpPoint(j,_e,o);return[new PolynomialBezier(this.points[0],i,j,et,!0),new PolynomialBezier(et,_e,$,this.points[3],!0)]};function extrema(o,i){var _=o.points[0][i],$=o.points[o.points.length-1][i];if(_>$){var j=$;$=_,_=j}for(var _e=quadRoots(3*o.a[i],2*o.b[i],o.c[i]),et=0;et<_e.length;et+=1)if(_e[et]>0&&_e[et]<1){var tt=o.point(_e[et])[i];tt<_?_=tt:tt>$&&($=tt)}return{min:_,max:$}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var o=this.bounds();return{left:o.x.min,right:o.x.max,top:o.y.min,bottom:o.y.max,width:o.x.max-o.x.min,height:o.y.max-o.y.min,cx:(o.x.max+o.x.min)/2,cy:(o.y.max+o.y.min)/2}};function intersectData(o,i,_){var $=o.boundingBox();return{cx:$.cx,cy:$.cy,width:$.width,height:$.height,bez:o,t:(i+_)/2,t1:i,t2:_}}function splitData(o){var i=o.bez.split(.5);return[intersectData(i[0],o.t1,o.t),intersectData(i[1],o.t,o.t2)]}function boxIntersect(o,i){return Math.abs(o.cx-i.cx)*2<o.width+i.width&&Math.abs(o.cy-i.cy)*2<o.height+i.height}function intersectsImpl(o,i,_,$,j,_e){if(boxIntersect(o,i)){if(_>=_e||o.width<=$&&o.height<=$&&i.width<=$&&i.height<=$){j.push([o.t,i.t]);return}var et=splitData(o),tt=splitData(i);intersectsImpl(et[0],tt[0],_+1,$,j,_e),intersectsImpl(et[0],tt[1],_+1,$,j,_e),intersectsImpl(et[1],tt[0],_+1,$,j,_e),intersectsImpl(et[1],tt[1],_+1,$,j,_e)}}PolynomialBezier.prototype.intersections=function(o,i,_){i===void 0&&(i=2),_===void 0&&(_=7);var $=[];return intersectsImpl(intersectData(this,0,1),intersectData(o,0,1),0,i,$,_),$},PolynomialBezier.shapeSegment=function(o,i){var _=(i+1)%o.length();return new PolynomialBezier(o.v[i],o.o[i],o.i[_],o.v[_],!0)},PolynomialBezier.shapeSegmentInverted=function(o,i){var _=(i+1)%o.length();return new PolynomialBezier(o.v[_],o.i[_],o.o[i],o.v[i],!0)};function crossProduct(o,i){return[o[1]*i[2]-o[2]*i[1],o[2]*i[0]-o[0]*i[2],o[0]*i[1]-o[1]*i[0]]}function lineIntersection(o,i,_,$){var j=[o[0],o[1],1],_e=[i[0],i[1],1],et=[_[0],_[1],1],tt=[$[0],$[1],1],rt=crossProduct(crossProduct(j,_e),crossProduct(et,tt));return floatZero(rt[2])?null:[rt[0]/rt[2],rt[1]/rt[2]]}function polarOffset(o,i,_){return[o[0]+Math.cos(i)*_,o[1]-Math.sin(i)*_]}function pointDistance(o,i){return Math.hypot(o[0]-i[0],o[1]-i[1])}function pointEqual(o,i){return floatEqual(o[0],i[0])&&floatEqual(o[1],i[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(o,i){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(o,i.s,0,null,this),this.frequency=PropertyFactory.getProp(o,i.r,0,null,this),this.pointsType=PropertyFactory.getProp(o,i.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(o,i,_,$,j,_e,et){var tt=_-Math.PI/2,rt=_+Math.PI/2,nt=i[0]+Math.cos(_)*$*j,it=i[1]-Math.sin(_)*$*j;o.setTripleAt(nt,it,nt+Math.cos(tt)*_e,it-Math.sin(tt)*_e,nt+Math.cos(rt)*et,it-Math.sin(rt)*et,o.length())}function getPerpendicularVector(o,i){var _=[i[0]-o[0],i[1]-o[1]],$=-Math.PI*.5,j=[Math.cos($)*_[0]-Math.sin($)*_[1],Math.sin($)*_[0]+Math.cos($)*_[1]];return j}function getProjectingAngle(o,i){var _=i===0?o.length()-1:i-1,$=(i+1)%o.length(),j=o.v[_],_e=o.v[$],et=getPerpendicularVector(j,_e);return Math.atan2(0,1)-Math.atan2(et[1],et[0])}function zigZagCorner(o,i,_,$,j,_e,et){var tt=getProjectingAngle(i,_),rt=i.v[_%i._length],nt=i.v[_===0?i._length-1:_-1],it=i.v[(_+1)%i._length],st=_e===2?Math.sqrt(Math.pow(rt[0]-nt[0],2)+Math.pow(rt[1]-nt[1],2)):0,at=_e===2?Math.sqrt(Math.pow(rt[0]-it[0],2)+Math.pow(rt[1]-it[1],2)):0;setPoint(o,i.v[_%i._length],tt,et,$,at/((j+1)*2),st/((j+1)*2))}function zigZagSegment(o,i,_,$,j,_e){for(var et=0;et<$;et+=1){var tt=(et+1)/($+1),rt=j===2?Math.sqrt(Math.pow(i.points[3][0]-i.points[0][0],2)+Math.pow(i.points[3][1]-i.points[0][1],2)):0,nt=i.normalAngle(tt),it=i.point(tt);setPoint(o,it,nt,_e,_,rt/(($+1)*2),rt/(($+1)*2)),_e=-_e}return _e}ZigZagModifier.prototype.processPath=function(o,i,_,$){var j=o._length,_e=shapePool.newElement();if(_e.c=o.c,o.c||(j-=1),j===0)return _e;var et=-1,tt=PolynomialBezier.shapeSegment(o,0);zigZagCorner(_e,o,0,i,_,$,et);for(var rt=0;rt<j;rt+=1)et=zigZagSegment(_e,tt,i,_,$,-et),rt===j-1&&!o.c?tt=null:tt=PolynomialBezier.shapeSegment(o,(rt+1)%j),zigZagCorner(_e,o,rt+1,i,_,$,et);return _e},ZigZagModifier.prototype.processShapes=function(o){var i,_,$=this.shapes.length,j,_e,et=this.amplitude.v,tt=Math.max(0,Math.round(this.frequency.v)),rt=this.pointsType.v;if(et!==0){var nt,it;for(_=0;_<$;_+=1){if(nt=this.shapes[_],it=nt.localShapeCollection,!(!nt.shape._mdf&&!this._mdf&&!o))for(it.releaseShapes(),nt.shape._mdf=!0,i=nt.shape.paths.shapes,_e=nt.shape.paths._length,j=0;j<_e;j+=1)it.addShape(this.processPath(i[j],et,tt,rt));nt.shape.paths=nt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(o,i,_){var $=Math.atan2(i[0]-o[0],i[1]-o[1]);return[polarOffset(o,$,_),polarOffset(i,$,_)]}function offsetSegment(o,i){var _,$,j,_e,et,tt,rt;rt=linearOffset(o.points[0],o.points[1],i),_=rt[0],$=rt[1],rt=linearOffset(o.points[1],o.points[2],i),j=rt[0],_e=rt[1],rt=linearOffset(o.points[2],o.points[3],i),et=rt[0],tt=rt[1];var nt=lineIntersection(_,$,j,_e);nt===null&&(nt=$);var it=lineIntersection(et,tt,j,_e);return it===null&&(it=et),new PolynomialBezier(_,nt,it,tt)}function joinLines(o,i,_,$,j){var _e=i.points[3],et=_.points[0];if($===3||pointEqual(_e,et))return _e;if($===2){var tt=-i.tangentAngle(1),rt=-_.tangentAngle(0)+Math.PI,nt=lineIntersection(_e,polarOffset(_e,tt+Math.PI/2,100),et,polarOffset(et,tt+Math.PI/2,100)),it=nt?pointDistance(nt,_e):pointDistance(_e,et)/2,st=polarOffset(_e,tt,2*it*roundCorner);return o.setXYAt(st[0],st[1],"o",o.length()-1),st=polarOffset(et,rt,2*it*roundCorner),o.setTripleAt(et[0],et[1],et[0],et[1],st[0],st[1],o.length()),et}var at=pointEqual(_e,i.points[2])?i.points[0]:i.points[2],ot=pointEqual(et,_.points[1])?_.points[3]:_.points[1],lt=lineIntersection(at,_e,et,ot);return lt&&pointDistance(lt,_e)<j?(o.setTripleAt(lt[0],lt[1],lt[0],lt[1],lt[0],lt[1],o.length()),lt):_e}function getIntersection(o,i){var _=o.intersections(i);return _.length&&floatEqual(_[0][0],1)&&_.shift(),_.length?_[0]:null}function pruneSegmentIntersection(o,i){var _=o.slice(),$=i.slice(),j=getIntersection(o[o.length-1],i[0]);return j&&(_[o.length-1]=o[o.length-1].split(j[0])[0],$[0]=i[0].split(j[1])[1]),o.length>1&&i.length>1&&(j=getIntersection(o[0],i[i.length-1]),j)?[[o[0].split(j[0])[0]],[i[i.length-1].split(j[1])[1]]]:[_,$]}function pruneIntersections(o){for(var i,_=1;_<o.length;_+=1)i=pruneSegmentIntersection(o[_-1],o[_]),o[_-1]=i[0],o[_]=i[1];return o.length>1&&(i=pruneSegmentIntersection(o[o.length-1],o[0]),o[o.length-1]=i[0],o[0]=i[1]),o}function offsetSegmentSplit(o,i){var _=o.inflectionPoints(),$,j,_e,et;if(_.length===0)return[offsetSegment(o,i)];if(_.length===1||floatEqual(_[1],1))return _e=o.split(_[0]),$=_e[0],j=_e[1],[offsetSegment($,i),offsetSegment(j,i)];_e=o.split(_[0]),$=_e[0];var tt=(_[1]-_[0])/(1-_[0]);return _e=_e[1].split(tt),et=_e[0],j=_e[1],[offsetSegment($,i),offsetSegment(et,i),offsetSegment(j,i)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(o,i){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(o,i.a,0,null,this),this.miterLimit=PropertyFactory.getProp(o,i.ml,0,null,this),this.lineJoin=i.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(o,i,_,$){var j=shapePool.newElement();j.c=o.c;var _e=o.length();o.c||(_e-=1);var et,tt,rt,nt=[];for(et=0;et<_e;et+=1)rt=PolynomialBezier.shapeSegment(o,et),nt.push(offsetSegmentSplit(rt,i));if(!o.c)for(et=_e-1;et>=0;et-=1)rt=PolynomialBezier.shapeSegmentInverted(o,et),nt.push(offsetSegmentSplit(rt,i));nt=pruneIntersections(nt);var it=null,st=null;for(et=0;et<nt.length;et+=1){var at=nt[et];for(st&&(it=joinLines(j,st,at[0],_,$)),st=at[at.length-1],tt=0;tt<at.length;tt+=1)rt=at[tt],it&&pointEqual(rt.points[0],it)?j.setXYAt(rt.points[1][0],rt.points[1][1],"o",j.length()-1):j.setTripleAt(rt.points[0][0],rt.points[0][1],rt.points[1][0],rt.points[1][1],rt.points[0][0],rt.points[0][1],j.length()),j.setTripleAt(rt.points[3][0],rt.points[3][1],rt.points[3][0],rt.points[3][1],rt.points[2][0],rt.points[2][1],j.length()),it=rt.points[3]}return nt.length&&joinLines(j,st,nt[0][0],_,$),j},OffsetPathModifier.prototype.processShapes=function(o){var i,_,$=this.shapes.length,j,_e,et=this.amount.v,tt=this.miterLimit.v,rt=this.lineJoin;if(et!==0){var nt,it;for(_=0;_<$;_+=1){if(nt=this.shapes[_],it=nt.localShapeCollection,!(!nt.shape._mdf&&!this._mdf&&!o))for(it.releaseShapes(),nt.shape._mdf=!0,i=nt.shape.paths.shapes,_e=nt.shape.paths._length,j=0;j<_e;j+=1)it.addShape(this.processPath(i[j],et,rt,tt));nt.shape.paths=nt.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(o){for(var i=o.fStyle?o.fStyle.split(" "):[],_="normal",$="normal",j=i.length,_e,et=0;et<j;et+=1)switch(_e=i[et].toLowerCase(),_e){case"italic":$="italic";break;case"bold":_="700";break;case"black":_="900";break;case"medium":_="500";break;case"regular":case"normal":_="400";break;case"light":case"thin":_="200";break}return{style:$,weight:o.fWeight||_}}var FontManager=function(){var o=5e3,i={w:0,size:0,shapes:[],data:{shapes:[]}},_=[];_=_.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var $=127988,j=917631,_e=917601,et=917626,tt=65039,rt=8205,nt=127462,it=127487,st=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function at(Pt){var Rt=Pt.split(","),Et,_t=Rt.length,Mt=[];for(Et=0;Et<_t;Et+=1)Rt[Et]!=="sans-serif"&&Rt[Et]!=="monospace"&&Mt.push(Rt[Et]);return Mt.join(",")}function ot(Pt,Rt){var Et=createTag("span");Et.setAttribute("aria-hidden",!0),Et.style.fontFamily=Rt;var _t=createTag("span");_t.innerText="giItT1WQy@!-/#",Et.style.position="absolute",Et.style.left="-10000px",Et.style.top="-10000px",Et.style.fontSize="300px",Et.style.fontVariant="normal",Et.style.fontStyle="normal",Et.style.fontWeight="normal",Et.style.letterSpacing="0",Et.appendChild(_t),document.body.appendChild(Et);var Mt=_t.offsetWidth;return _t.style.fontFamily=at(Pt)+", "+Rt,{node:_t,w:Mt,parent:Et}}function lt(){var Pt,Rt=this.fonts.length,Et,_t,Mt=Rt;for(Pt=0;Pt<Rt;Pt+=1)this.fonts[Pt].loaded?Mt-=1:this.fonts[Pt].fOrigin==="n"||this.fonts[Pt].origin===0?this.fonts[Pt].loaded=!0:(Et=this.fonts[Pt].monoCase.node,_t=this.fonts[Pt].monoCase.w,Et.offsetWidth!==_t?(Mt-=1,this.fonts[Pt].loaded=!0):(Et=this.fonts[Pt].sansCase.node,_t=this.fonts[Pt].sansCase.w,Et.offsetWidth!==_t&&(Mt-=1,this.fonts[Pt].loaded=!0)),this.fonts[Pt].loaded&&(this.fonts[Pt].sansCase.parent.parentNode.removeChild(this.fonts[Pt].sansCase.parent),this.fonts[Pt].monoCase.parent.parentNode.removeChild(this.fonts[Pt].monoCase.parent)));Mt!==0&&Date.now()-this.initTime<o?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function ct(Pt,Rt){var Et=document.body&&Rt?"svg":"canvas",_t,Mt=getFontProperties(Pt);if(Et==="svg"){var Dt=createNS("text");Dt.style.fontSize="100px",Dt.setAttribute("font-family",Pt.fFamily),Dt.setAttribute("font-style",Mt.style),Dt.setAttribute("font-weight",Mt.weight),Dt.textContent="1",Pt.fClass?(Dt.style.fontFamily="inherit",Dt.setAttribute("class",Pt.fClass)):Dt.style.fontFamily=Pt.fFamily,Rt.appendChild(Dt),_t=Dt}else{var Lt=new OffscreenCanvas(500,500).getContext("2d");Lt.font=Mt.style+" "+Mt.weight+" 100px "+Pt.fFamily,_t=Lt}function Ct(kt){return Et==="svg"?(_t.textContent=kt,_t.getComputedTextLength()):_t.measureText(kt).width}return{measureText:Ct}}function ft(Pt,Rt){if(!Pt){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=Pt.list;return}if(!document.body){this.isLoaded=!0,Pt.list.forEach(function(qt){qt.helper=ct(qt),qt.cache={}}),this.fonts=Pt.list;return}var Et=Pt.list,_t,Mt=Et.length,Dt=Mt;for(_t=0;_t<Mt;_t+=1){var Lt=!0,Ct,kt;if(Et[_t].loaded=!1,Et[_t].monoCase=ot(Et[_t].fFamily,"monospace"),Et[_t].sansCase=ot(Et[_t].fFamily,"sans-serif"),!Et[_t].fPath)Et[_t].loaded=!0,Dt-=1;else if(Et[_t].fOrigin==="p"||Et[_t].origin===3){if(Ct=document.querySelectorAll('style[f-forigin="p"][f-family="'+Et[_t].fFamily+'"], style[f-origin="3"][f-family="'+Et[_t].fFamily+'"]'),Ct.length>0&&(Lt=!1),Lt){var jt=createTag("style");jt.setAttribute("f-forigin",Et[_t].fOrigin),jt.setAttribute("f-origin",Et[_t].origin),jt.setAttribute("f-family",Et[_t].fFamily),jt.type="text/css",jt.innerText="@font-face {font-family: "+Et[_t].fFamily+"; font-style: normal; src: url('"+Et[_t].fPath+"');}",Rt.appendChild(jt)}}else if(Et[_t].fOrigin==="g"||Et[_t].origin===1){for(Ct=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),kt=0;kt<Ct.length;kt+=1)Ct[kt].href.indexOf(Et[_t].fPath)!==-1&&(Lt=!1);if(Lt){var Vt=createTag("link");Vt.setAttribute("f-forigin",Et[_t].fOrigin),Vt.setAttribute("f-origin",Et[_t].origin),Vt.type="text/css",Vt.rel="stylesheet",Vt.href=Et[_t].fPath,document.body.appendChild(Vt)}}else if(Et[_t].fOrigin==="t"||Et[_t].origin===2){for(Ct=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),kt=0;kt<Ct.length;kt+=1)Et[_t].fPath===Ct[kt].src&&(Lt=!1);if(Lt){var zt=createTag("link");zt.setAttribute("f-forigin",Et[_t].fOrigin),zt.setAttribute("f-origin",Et[_t].origin),zt.setAttribute("rel","stylesheet"),zt.setAttribute("href",Et[_t].fPath),Rt.appendChild(zt)}}Et[_t].helper=ct(Et[_t],Rt),Et[_t].cache={},this.fonts.push(Et[_t])}Dt===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function ut(Pt){if(Pt){this.chars||(this.chars=[]);var Rt,Et=Pt.length,_t,Mt=this.chars.length,Dt;for(Rt=0;Rt<Et;Rt+=1){for(_t=0,Dt=!1;_t<Mt;)this.chars[_t].style===Pt[Rt].style&&this.chars[_t].fFamily===Pt[Rt].fFamily&&this.chars[_t].ch===Pt[Rt].ch&&(Dt=!0),_t+=1;Dt||(this.chars.push(Pt[Rt]),Mt+=1)}}}function ht(Pt,Rt,Et){for(var _t=0,Mt=this.chars.length;_t<Mt;){if(this.chars[_t].ch===Pt&&this.chars[_t].style===Rt&&this.chars[_t].fFamily===Et)return this.chars[_t];_t+=1}return(typeof Pt=="string"&&Pt.charCodeAt(0)!==13||!Pt)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",Pt,Rt,Et)),i}function dt(Pt,Rt,Et){var _t=this.getFontByName(Rt),Mt=Pt;if(!_t.cache[Mt]){var Dt=_t.helper;if(Pt===" "){var Lt=Dt.measureText("|"+Pt+"|"),Ct=Dt.measureText("||");_t.cache[Mt]=(Lt-Ct)/100}else _t.cache[Mt]=Dt.measureText(Pt)/100}return _t.cache[Mt]*Et}function mt(Pt){for(var Rt=0,Et=this.fonts.length;Rt<Et;){if(this.fonts[Rt].fName===Pt)return this.fonts[Rt];Rt+=1}return this.fonts[0]}function pt(Pt){var Rt=0,Et=Pt.charCodeAt(0);if(Et>=55296&&Et<=56319){var _t=Pt.charCodeAt(1);_t>=56320&&_t<=57343&&(Rt=(Et-55296)*1024+_t-56320+65536)}return Rt}function yt(Pt,Rt){var Et=Pt.toString(16)+Rt.toString(16);return st.indexOf(Et)!==-1}function gt(Pt){return Pt===rt}function vt(Pt){return Pt===tt}function St(Pt){var Rt=pt(Pt);return Rt>=nt&&Rt<=it}function At(Pt){return St(Pt.substr(0,2))&&St(Pt.substr(2,2))}function xt(Pt){return _.indexOf(Pt)!==-1}function wt(Pt,Rt){var Et=pt(Pt.substr(Rt,2));if(Et!==$)return!1;var _t=0;for(Rt+=2;_t<5;){if(Et=pt(Pt.substr(Rt,2)),Et<_e||Et>et)return!1;_t+=1,Rt+=2}return pt(Pt.substr(Rt,2))===j}function Ot(){this.isLoaded=!0}var Bt=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};Bt.isModifier=yt,Bt.isZeroWidthJoiner=gt,Bt.isFlagEmoji=At,Bt.isRegionalCode=St,Bt.isCombinedCharacter=xt,Bt.isRegionalFlag=wt,Bt.isVariationSelector=vt,Bt.BLACK_FLAG_CODE_POINT=$;var Ft={addChars:ut,addFonts:ft,getCharData:ht,getFontByName:mt,measureText:dt,checkLoadedFonts:lt,setIsLoaded:Ot};return Bt.prototype=Ft,Bt}();function SlotManager(o){this.animationData=o}SlotManager.prototype.getProp=function(o){return this.animationData.slots&&this.animationData.slots[o.sid]?Object.assign(o,this.animationData.slots[o.sid].p):o};function slotFactory(o){return new SlotManager(o)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(i){this.renderableComponents.indexOf(i)===-1&&this.renderableComponents.push(i)},removeRenderableComponent:function(i){this.renderableComponents.indexOf(i)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(i),1)},prepareRenderableFrame:function(i){this.checkLayerLimits(i)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(i){this.data.ip-this.data.st<=i&&this.data.op-this.data.st>i?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var i,_=this.renderableComponents.length;for(i=0;i<_;i+=1)this.renderableComponents[i].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var o={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(i){return o[i]||""}}();function SliderEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,0,0,_)}function AngleEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,0,0,_)}function ColorEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,1,0,_)}function PointEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,1,0,_)}function LayerIndexEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,0,0,_)}function MaskIndexEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,0,0,_)}function CheckboxEffect(o,i,_){this.p=PropertyFactory.getProp(i,o.v,0,0,_)}function NoValueEffect(){this.p={}}function EffectsManager(o,i){var _=o.ef||[];this.effectElements=[];var $,j=_.length,_e;for($=0;$<j;$+=1)_e=new GroupEffect(_[$],i),this.effectElements.push(_e)}function GroupEffect(o,i){this.init(o,i)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(o,i){this.data=o,this.effectElements=[],this.initDynamicPropertyContainer(i);var _,$=this.data.ef.length,j,_e=this.data.ef;for(_=0;_<$;_+=1){switch(j=null,_e[_].ty){case 0:j=new SliderEffect(_e[_],i,this);break;case 1:j=new AngleEffect(_e[_],i,this);break;case 2:j=new ColorEffect(_e[_],i,this);break;case 3:j=new PointEffect(_e[_],i,this);break;case 4:case 7:j=new CheckboxEffect(_e[_],i,this);break;case 10:j=new LayerIndexEffect(_e[_],i,this);break;case 11:j=new MaskIndexEffect(_e[_],i,this);break;case 5:j=new EffectsManager(_e[_],i);break;default:j=new NoValueEffect(_e[_]);break}j&&this.effectElements.push(j)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var i=0,_=this.data.masksProperties.length;i<_;){if(this.data.masksProperties[i].mode!=="n"&&this.data.masksProperties[i].cl!==!1)return!0;i+=1}return!1},initExpressions:function(){var i=getExpressionInterfaces();if(i){var _=i("layer"),$=i("effects"),j=i("shape"),_e=i("text"),et=i("comp");this.layerInterface=_(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var tt=$.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(tt),this.data.ty===0||this.data.xt?this.compInterface=et(this):this.data.ty===4?(this.layerInterface.shapeInterface=j(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=_e(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var i=getBlendMode(this.data.bm),_=this.baseElement||this.layerElement;_.style["mix-blend-mode"]=i},initBaseData:function(i,_,$){this.globalData=_,this.comp=$,this.data=i,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(i,_){var $,j=this.dynamicProperties.length;for($=0;$<j;$+=1)(_||this._isParent&&this.dynamicProperties[$].propType==="transform")&&(this.dynamicProperties[$].getValue(),this.dynamicProperties[$]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(i){this.dynamicProperties.indexOf(i)===-1&&this.dynamicProperties.push(i)}};function FootageElement(o,i,_){this.initFrame(),this.initRenderable(),this.assetData=i.getAssetData(o.refId),this.footageData=i.imageLoader.getAsset(this.assetData),this.initBaseData(o,i,_)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var o=getExpressionInterfaces();if(o){var i=o("footage");this.layerInterface=i(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(o,i,_){this.initFrame(),this.initRenderable(),this.assetData=i.getAssetData(o.refId),this.initBaseData(o,i,_),this._isPlaying=!1,this._canPlay=!1;var $=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio($),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=o.tm?PropertyFactory.getProp(this,o.tm,0,i.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,o.au&&o.au.lv?o.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(o){if(this.prepareRenderableFrame(o,!0),this.prepareProperties(o,!0),this.tm._placeholder)this._currentTime=o/this.data.sr;else{var i=this.tm.v;this._currentTime=i}this._volume=this.lv.v[0];var _=this._volume*this._volumeMultiplier;this._previousVolume!==_&&(this._previousVolume=_,this.audio.volume(_))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(o){this.audio.rate(o)},AudioElement.prototype.volume=function(o){this._volumeMultiplier=o,this._previousVolume=o*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(o){var i,_=this.layers.length,$;for(this.completeLayers=!0,i=_-1;i>=0;i-=1)this.elements[i]||($=this.layers[i],$.ip-$.st<=o-this.layers[i].st&&$.op-$.st>o-this.layers[i].st&&this.buildItem(i)),this.completeLayers=this.elements[i]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(o){switch(o.ty){case 2:return this.createImage(o);case 0:return this.createComp(o);case 1:return this.createSolid(o);case 3:return this.createNull(o);case 4:return this.createShape(o);case 5:return this.createText(o);case 6:return this.createAudio(o);case 13:return this.createCamera(o);case 15:return this.createFootage(o);default:return this.createNull(o)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(o){return new AudioElement(o,this.globalData,this)},BaseRenderer.prototype.createFootage=function(o){return new FootageElement(o,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var o,i=this.layers.length;for(o=0;o<i;o+=1)this.buildItem(o);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(o){this.completeLayers=!1;var i,_=o.length,$,j=this.layers.length;for(i=0;i<_;i+=1)for($=0;$<j;){if(this.layers[$].id===o[i].id){this.layers[$]=o[i];break}$+=1}},BaseRenderer.prototype.setProjectInterface=function(o){this.globalData.projectInterface=o},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(o,i,_){for(var $=this.elements,j=this.layers,_e=0,et=j.length;_e<et;)j[_e].ind==i&&(!$[_e]||$[_e]===!0?(this.buildItem(_e),this.addPendingElement(o)):(_.push($[_e]),$[_e].setAsParent(),j[_e].parent!==void 0?this.buildElementParenting(o,j[_e].parent,_):o.setHierarchy(_))),_e+=1},BaseRenderer.prototype.addPendingElement=function(o){this.pendingElements.push(o)},BaseRenderer.prototype.searchExtraCompositions=function(o){var i,_=o.length;for(i=0;i<_;i+=1)if(o[i].xt){var $=this.createComp(o[i]);$.initExpressions(),this.globalData.projectInterface.registerComposition($)}},BaseRenderer.prototype.getElementById=function(o){var i,_=this.elements.length;for(i=0;i<_;i+=1)if(this.elements[i].data.ind===o)return this.elements[i];return null},BaseRenderer.prototype.getElementByPath=function(o){var i=o.shift(),_;if(typeof i=="number")_=this.elements[i];else{var $,j=this.elements.length;for($=0;$<j;$+=1)if(this.elements[$].data.nm===i){_=this.elements[$];break}}return o.length===0?_:_.getElementByPath(o)},BaseRenderer.prototype.setupGlobalData=function(o,i){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(o),this.globalData.fontManager.addChars(o.chars),this.globalData.fontManager.addFonts(o.fonts,i),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=o.fr,this.globalData.nm=o.nm,this.globalData.compSize={w:o.w,h:o.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var i=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:i,localMat:i,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var i,_=this.finalTransform.mat,$=0,j=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;$<j;){if(this.hierarchy[$].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}$+=1}if(this.finalTransform._matMdf)for(i=this.finalTransform.mProp.v.props,_.cloneFromProps(i),$=0;$<j;$+=1)_.multiply(this.hierarchy[$].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var i=0,_=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;i<_;)this.localTransforms[i]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[i]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),i+=1;if(this.finalTransform._localMatMdf){var $=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone($),i=1;i<_;i+=1){var j=this.localTransforms[i].matrix;$.multiply(j)}$.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var _e=this.finalTransform.localOpacity;for(i=0;i<_;i+=1)_e*=this.localTransforms[i].opacity*.01;this.finalTransform.localOpacity=_e}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var i=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(i.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var _=0,$=i.length;for(_=0;_<$;_+=1)this.localTransforms.push(i[_])}}},globalToLocal:function(i){var _=[];_.push(this.finalTransform);for(var $=!0,j=this.comp;$;)j.finalTransform?(j.data.hasMask&&_.splice(0,0,j.finalTransform),j=j.comp):$=!1;var _e,et=_.length,tt;for(_e=0;_e<et;_e+=1)tt=_[_e].mat.applyToPointArray(0,0,0),i=[i[0]-tt[0],i[1]-tt[1],0];return i},mHelper:new Matrix};function MaskElement(o,i,_){this.data=o,this.element=i,this.globalData=_,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var $=this.globalData.defs,j,_e=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(_e),this.solidPath="";var et,tt=this.masksProperties,rt=0,nt=[],it,st,at=createElementID(),ot,lt,ct,ft,ut="clipPath",ht="clip-path";for(j=0;j<_e;j+=1)if((tt[j].mode!=="a"&&tt[j].mode!=="n"||tt[j].inv||tt[j].o.k!==100||tt[j].o.x)&&(ut="mask",ht="mask"),(tt[j].mode==="s"||tt[j].mode==="i")&&rt===0?(ot=createNS("rect"),ot.setAttribute("fill","#ffffff"),ot.setAttribute("width",this.element.comp.data.w||0),ot.setAttribute("height",this.element.comp.data.h||0),nt.push(ot)):ot=null,et=createNS("path"),tt[j].mode==="n")this.viewData[j]={op:PropertyFactory.getProp(this.element,tt[j].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,tt[j],3),elem:et,lastPath:""},$.appendChild(et);else{rt+=1,et.setAttribute("fill",tt[j].mode==="s"?"#000000":"#ffffff"),et.setAttribute("clip-rule","nonzero");var dt;if(tt[j].x.k!==0?(ut="mask",ht="mask",ft=PropertyFactory.getProp(this.element,tt[j].x,0,null,this.element),dt=createElementID(),lt=createNS("filter"),lt.setAttribute("id",dt),ct=createNS("feMorphology"),ct.setAttribute("operator","erode"),ct.setAttribute("in","SourceGraphic"),ct.setAttribute("radius","0"),lt.appendChild(ct),$.appendChild(lt),et.setAttribute("stroke",tt[j].mode==="s"?"#000000":"#ffffff")):(ct=null,ft=null),this.storedData[j]={elem:et,x:ft,expan:ct,lastPath:"",lastOperator:"",filterId:dt,lastRadius:0},tt[j].mode==="i"){st=nt.length;var mt=createNS("g");for(it=0;it<st;it+=1)mt.appendChild(nt[it]);var pt=createNS("mask");pt.setAttribute("mask-type","alpha"),pt.setAttribute("id",at+"_"+rt),pt.appendChild(et),$.appendChild(pt),mt.setAttribute("mask","url("+getLocationHref()+"#"+at+"_"+rt+")"),nt.length=0,nt.push(mt)}else nt.push(et);tt[j].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[j]={elem:et,lastPath:"",op:PropertyFactory.getProp(this.element,tt[j].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,tt[j],3),invRect:ot},this.viewData[j].prop.k||this.drawPath(tt[j],this.viewData[j].prop.v,this.viewData[j])}for(this.maskElement=createNS(ut),_e=nt.length,j=0;j<_e;j+=1)this.maskElement.appendChild(nt[j]);rt>0&&(this.maskElement.setAttribute("id",at),this.element.maskedElement.setAttribute(ht,"url("+getLocationHref()+"#"+at+")"),$.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(o){return this.viewData[o].prop},MaskElement.prototype.renderFrame=function(o){var i=this.element.finalTransform.mat,_,$=this.masksProperties.length;for(_=0;_<$;_+=1)if((this.viewData[_].prop._mdf||o)&&this.drawPath(this.masksProperties[_],this.viewData[_].prop.v,this.viewData[_]),(this.viewData[_].op._mdf||o)&&this.viewData[_].elem.setAttribute("fill-opacity",this.viewData[_].op.v),this.masksProperties[_].mode!=="n"&&(this.viewData[_].invRect&&(this.element.finalTransform.mProp._mdf||o)&&this.viewData[_].invRect.setAttribute("transform",i.getInverseMatrix().to2dCSS()),this.storedData[_].x&&(this.storedData[_].x._mdf||o))){var j=this.storedData[_].expan;this.storedData[_].x.v<0?(this.storedData[_].lastOperator!=="erode"&&(this.storedData[_].lastOperator="erode",this.storedData[_].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[_].filterId+")")),j.setAttribute("radius",-this.storedData[_].x.v)):(this.storedData[_].lastOperator!=="dilate"&&(this.storedData[_].lastOperator="dilate",this.storedData[_].elem.setAttribute("filter",null)),this.storedData[_].elem.setAttribute("stroke-width",this.storedData[_].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var o="M0,0 ";return o+=" h"+this.globalData.compSize.w,o+=" v"+this.globalData.compSize.h,o+=" h-"+this.globalData.compSize.w,o+=" v-"+this.globalData.compSize.h+" ",o},MaskElement.prototype.drawPath=function(o,i,_){var $=" M"+i.v[0][0]+","+i.v[0][1],j,_e;for(_e=i._length,j=1;j<_e;j+=1)$+=" C"+i.o[j-1][0]+","+i.o[j-1][1]+" "+i.i[j][0]+","+i.i[j][1]+" "+i.v[j][0]+","+i.v[j][1];if(i.c&&_e>1&&($+=" C"+i.o[j-1][0]+","+i.o[j-1][1]+" "+i.i[0][0]+","+i.i[0][1]+" "+i.v[0][0]+","+i.v[0][1]),_.lastPath!==$){var et="";_.elem&&(i.c&&(et=o.inv?this.solidPath+$:$),_.elem.setAttribute("d",et)),_.lastPath=$}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var o={};o.createFilter=i,o.createAlphaToLuminanceFilter=_;function i($,j){var _e=createNS("filter");return _e.setAttribute("id",$),j!==!0&&(_e.setAttribute("filterUnits","objectBoundingBox"),_e.setAttribute("x","0%"),_e.setAttribute("y","0%"),_e.setAttribute("width","100%"),_e.setAttribute("height","100%")),_e}function _(){var $=createNS("feColorMatrix");return $.setAttribute("type","matrix"),$.setAttribute("color-interpolation-filters","sRGB"),$.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),$}return o}(),featureSupport=function(){var o={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(o.maskType=!1),/firefox/i.test(navigator.userAgent)&&(o.svgLumaHidden=!1),o}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(o){var i,_="SourceGraphic",$=o.data.ef?o.data.ef.length:0,j=createElementID(),_e=filtersFactory.createFilter(j,!0),et=0;this.filters=[];var tt;for(i=0;i<$;i+=1){tt=null;var rt=o.data.ef[i].ty;if(registeredEffects$1[rt]){var nt=registeredEffects$1[rt].effect;tt=new nt(_e,o.effectsManager.effectElements[i],o,idPrefix+et,_),_=idPrefix+et,registeredEffects$1[rt].countsAsEffect&&(et+=1)}tt&&this.filters.push(tt)}et&&(o.globalData.defs.appendChild(_e),o.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+j+")")),this.filters.length&&o.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(o){var i,_=this.filters.length;for(i=0;i<_;i+=1)this.filters[i].renderFrame(o)},SVGEffects.prototype.getEffects=function(o){var i,_=this.filters.length,$=[];for(i=0;i<_;i+=1)this.filters[i].type===o&&$.push(this.filters[i]);return $};function registerEffect$1(o,i,_){registeredEffects$1[o]={effect:i,countsAsEffect:_}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var i=null;if(this.data.td){this.matteMasks={};var _=createNS("g");_.setAttribute("id",this.layerId),_.appendChild(this.layerElement),i=_,this.globalData.defs.appendChild(_)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),i=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var $=createNS("clipPath"),j=createNS("path");j.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var _e=createElementID();if($.setAttribute("id",_e),$.appendChild(j),this.globalData.defs.appendChild($),this.checkMasks()){var et=createNS("g");et.setAttribute("clip-path","url("+getLocationHref()+"#"+_e+")"),et.appendChild(this.layerElement),this.transformedElement=et,i?i.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+_e+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(i){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[i]){var _=this.layerId+"_"+i,$,j,_e,et;if(i===1||i===3){var tt=createNS("mask");tt.setAttribute("id",_),tt.setAttribute("mask-type",i===3?"luminance":"alpha"),_e=createNS("use"),_e.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),tt.appendChild(_e),this.globalData.defs.appendChild(tt),!featureSupport.maskType&&i===1&&(tt.setAttribute("mask-type","luminance"),$=createElementID(),j=filtersFactory.createFilter($),this.globalData.defs.appendChild(j),j.appendChild(filtersFactory.createAlphaToLuminanceFilter()),et=createNS("g"),et.appendChild(_e),tt.appendChild(et),et.setAttribute("filter","url("+getLocationHref()+"#"+$+")"))}else if(i===2){var rt=createNS("mask");rt.setAttribute("id",_),rt.setAttribute("mask-type","alpha");var nt=createNS("g");rt.appendChild(nt),$=createElementID(),j=filtersFactory.createFilter($);var it=createNS("feComponentTransfer");it.setAttribute("in","SourceGraphic"),j.appendChild(it);var st=createNS("feFuncA");st.setAttribute("type","table"),st.setAttribute("tableValues","1.0 0.0"),it.appendChild(st),this.globalData.defs.appendChild(j);var at=createNS("rect");at.setAttribute("width",this.comp.data.w),at.setAttribute("height",this.comp.data.h),at.setAttribute("x","0"),at.setAttribute("y","0"),at.setAttribute("fill","#ffffff"),at.setAttribute("opacity","0"),nt.setAttribute("filter","url("+getLocationHref()+"#"+$+")"),nt.appendChild(at),_e=createNS("use"),_e.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),nt.appendChild(_e),featureSupport.maskType||(rt.setAttribute("mask-type","luminance"),j.appendChild(filtersFactory.createAlphaToLuminanceFilter()),et=createNS("g"),nt.appendChild(at),et.appendChild(this.layerElement),nt.appendChild(et)),this.globalData.defs.appendChild(rt)}this.matteMasks[i]=_}return this.matteMasks[i]},setMatte:function(i){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+i+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(i){this.hierarchy=i},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var o={initElement:function(_,$,j){this.initFrame(),this.initBaseData(_,$,j),this.initTransform(_,$,j),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var _=this.baseElement||this.layerElement;_.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var _=this.baseElement||this.layerElement;_.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(_){this._mdf=!1,this.prepareRenderableFrame(_),this.prepareProperties(_,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(o)],RenderableDOMElement)})();function IImageElement(o,i,_){this.assetData=i.getAssetData(o.refId),this.assetData&&this.assetData.sid&&(this.assetData=i.slotManager.getProp(this.assetData)),this.initElement(o,i,_),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var o=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",o),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(o,i){this.elem=o,this.pos=i}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(i){var _,$=this.shapeModifiers.length;for(_=0;_<$;_+=1)this.shapeModifiers[_].addShape(i)},isShapeInAnimatedModifiers:function(i){for(var _=0,$=this.shapeModifiers.length;_<$;)if(this.shapeModifiers[_].isAnimatedWithShape(i))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var i,_=this.shapes.length;for(i=0;i<_;i+=1)this.shapes[i].sh.reset();_=this.shapeModifiers.length;var $;for(i=_-1;i>=0&&($=this.shapeModifiers[i].processShapes(this._isFirstFrame),!$);i-=1);}},searchProcessedElement:function(i){for(var _=this.processedElements,$=0,j=_.length;$<j;){if(_[$].elem===i)return _[$].pos;$+=1}return 0},addProcessedElement:function(i,_){for(var $=this.processedElements,j=$.length;j;)if(j-=1,$[j].elem===i){$[j].pos=_;return}$.push(new ProcessedElement(i,_))},prepareFrame:function(i){this.prepareRenderableFrame(i),this.prepareProperties(i,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(o,i,_){this.caches=[],this.styles=[],this.transformers=o,this.lStr="",this.sh=_,this.lvl=i,this._isAnimated=!!_.k;for(var $=0,j=o.length;$<j;){if(o[$].mProps.dynamicProperties.length){this._isAnimated=!0;break}$+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(o,i){this.data=o,this.type=o.ty,this.d="",this.lvl=i,this._mdf=!1,this.closed=o.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(o,i,_,$){this.elem=o,this.frameId=-1,this.dataProps=createSizedArray(i.length),this.renderer=_,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",i.length?i.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer($);var j,_e=i.length||0,et;for(j=0;j<_e;j+=1)et=PropertyFactory.getProp(o,i[j].v,0,0,this),this.k=et.k||this.k,this.dataProps[j]={n:i[j].n,p:et};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(o){if(!(this.elem.globalData.frameId===this.frameId&&!o)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||o,this._mdf)){var i=0,_=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),i=0;i<_;i+=1)this.dataProps[i].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[i].p.v:this.dashArray[i]=this.dataProps[i].p.v:this.dashoffset[0]=this.dataProps[i].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(o,i,_){this.initDynamicPropertyContainer(o),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(o,i.o,0,.01,this),this.w=PropertyFactory.getProp(o,i.w,0,null,this),this.d=new DashProperty(o,i.d||{},"svg",this),this.c=PropertyFactory.getProp(o,i.c,1,255,this),this.style=_,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(o,i,_){this.initDynamicPropertyContainer(o),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(o,i.o,0,.01,this),this.c=PropertyFactory.getProp(o,i.c,1,255,this),this.style=_}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(o,i,_){this.initDynamicPropertyContainer(o),this.getValue=this.iterateDynamicProperties,this.style=_}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(o,i,_){this.data=i,this.c=createTypedArray("uint8c",i.p*4);var $=i.k.k[0].s?i.k.k[0].s.length-i.p*4:i.k.k.length-i.p*4;this.o=createTypedArray("float32",$),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=$,this.initDynamicPropertyContainer(_),this.prop=PropertyFactory.getProp(o,i.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(o,i){for(var _=0,$=this.o.length/2,j;_<$;){if(j=Math.abs(o[_*4]-o[i*4+_*2]),j>.01)return!1;_+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var o=0,i=this.data.k.k.length;o<i;){if(!this.comparePoints(this.data.k.k[o].s,this.data.p))return!1;o+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(o){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||o){var i,_=this.data.p*4,$,j;for(i=0;i<_;i+=1)$=i%4===0?100:255,j=Math.round(this.prop.v[i]*$),this.c[i]!==j&&(this.c[i]=j,this._cmdf=!o);if(this.o.length)for(_=this.prop.v.length,i=this.data.p*4;i<_;i+=1)$=i%2===0?100:1,j=i%2===0?Math.round(this.prop.v[i]*100):this.prop.v[i],this.o[i-this.data.p*4]!==j&&(this.o[i-this.data.p*4]=j,this._omdf=!o);this._mdf=!o}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(o,i,_){this.initDynamicPropertyContainer(o),this.getValue=this.iterateDynamicProperties,this.initGradientData(o,i,_)}SVGGradientFillStyleData.prototype.initGradientData=function(o,i,_){this.o=PropertyFactory.getProp(o,i.o,0,.01,this),this.s=PropertyFactory.getProp(o,i.s,1,null,this),this.e=PropertyFactory.getProp(o,i.e,1,null,this),this.h=PropertyFactory.getProp(o,i.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(o,i.a||{k:0},0,degToRads,this),this.g=new GradientProperty(o,i.g,this),this.style=_,this.stops=[],this.setGradientData(_.pElem,i),this.setGradientOpacity(i,_),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(o,i){var _=createElementID(),$=createNS(i.t===1?"linearGradient":"radialGradient");$.setAttribute("id",_),$.setAttribute("spreadMethod","pad"),$.setAttribute("gradientUnits","userSpaceOnUse");var j=[],_e,et,tt;for(tt=i.g.p*4,et=0;et<tt;et+=4)_e=createNS("stop"),$.appendChild(_e),j.push(_e);o.setAttribute(i.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+_+")"),this.gf=$,this.cst=j},SVGGradientFillStyleData.prototype.setGradientOpacity=function(o,i){if(this.g._hasOpacity&&!this.g._collapsable){var _,$,j,_e=createNS("mask"),et=createNS("path");_e.appendChild(et);var tt=createElementID(),rt=createElementID();_e.setAttribute("id",rt);var nt=createNS(o.t===1?"linearGradient":"radialGradient");nt.setAttribute("id",tt),nt.setAttribute("spreadMethod","pad"),nt.setAttribute("gradientUnits","userSpaceOnUse"),j=o.g.k.k[0].s?o.g.k.k[0].s.length:o.g.k.k.length;var it=this.stops;for($=o.g.p*4;$<j;$+=2)_=createNS("stop"),_.setAttribute("stop-color","rgb(255,255,255)"),nt.appendChild(_),it.push(_);et.setAttribute(o.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+tt+")"),o.ty==="gs"&&(et.setAttribute("stroke-linecap",lineCapEnum[o.lc||2]),et.setAttribute("stroke-linejoin",lineJoinEnum[o.lj||2]),o.lj===1&&et.setAttribute("stroke-miterlimit",o.ml)),this.of=nt,this.ms=_e,this.ost=it,this.maskId=rt,i.msElem=et}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(o,i,_){this.initDynamicPropertyContainer(o),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(o,i.w,0,null,this),this.d=new DashProperty(o,i.d||{},"svg",this),this.initGradientData(o,i,_),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(o,i,_){this.transform={mProps:o,op:i,container:_},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(i,_,$,j){if(_===0)return"";var _e=i.o,et=i.i,tt=i.v,rt,nt=" M"+j.applyToPointStringified(tt[0][0],tt[0][1]);for(rt=1;rt<_;rt+=1)nt+=" C"+j.applyToPointStringified(_e[rt-1][0],_e[rt-1][1])+" "+j.applyToPointStringified(et[rt][0],et[rt][1])+" "+j.applyToPointStringified(tt[rt][0],tt[rt][1]);return $&&_&&(nt+=" C"+j.applyToPointStringified(_e[rt-1][0],_e[rt-1][1])+" "+j.applyToPointStringified(et[0][0],et[0][1])+" "+j.applyToPointStringified(tt[0][0],tt[0][1]),nt+="z"),nt},SVGElementsRenderer=function(){var o=new Matrix,i=new Matrix,_={createRenderFunction:$};function $(st){switch(st.ty){case"fl":return tt;case"gf":return nt;case"gs":return rt;case"st":return it;case"sh":case"el":case"rc":case"sr":return et;case"tr":return j;case"no":return _e;default:return null}}function j(st,at,ot){(ot||at.transform.op._mdf)&&at.transform.container.setAttribute("opacity",at.transform.op.v),(ot||at.transform.mProps._mdf)&&at.transform.container.setAttribute("transform",at.transform.mProps.v.to2dCSS())}function _e(){}function et(st,at,ot){var lt,ct,ft,ut,ht,dt,mt=at.styles.length,pt=at.lvl,yt,gt,vt,St;for(dt=0;dt<mt;dt+=1){if(ut=at.sh._mdf||ot,at.styles[dt].lvl<pt){for(gt=i.reset(),vt=pt-at.styles[dt].lvl,St=at.transformers.length-1;!ut&&vt>0;)ut=at.transformers[St].mProps._mdf||ut,vt-=1,St-=1;if(ut)for(vt=pt-at.styles[dt].lvl,St=at.transformers.length-1;vt>0;)gt.multiply(at.transformers[St].mProps.v),vt-=1,St-=1}else gt=o;if(yt=at.sh.paths,ct=yt._length,ut){for(ft="",lt=0;lt<ct;lt+=1)ht=yt.shapes[lt],ht&&ht._length&&(ft+=buildShapeString(ht,ht._length,ht.c,gt));at.caches[dt]=ft}else ft=at.caches[dt];at.styles[dt].d+=st.hd===!0?"":ft,at.styles[dt]._mdf=ut||at.styles[dt]._mdf}}function tt(st,at,ot){var lt=at.style;(at.c._mdf||ot)&&lt.pElem.setAttribute("fill","rgb("+bmFloor(at.c.v[0])+","+bmFloor(at.c.v[1])+","+bmFloor(at.c.v[2])+")"),(at.o._mdf||ot)&&lt.pElem.setAttribute("fill-opacity",at.o.v)}function rt(st,at,ot){nt(st,at,ot),it(st,at,ot)}function nt(st,at,ot){var lt=at.gf,ct=at.g._hasOpacity,ft=at.s.v,ut=at.e.v;if(at.o._mdf||ot){var ht=st.ty==="gf"?"fill-opacity":"stroke-opacity";at.style.pElem.setAttribute(ht,at.o.v)}if(at.s._mdf||ot){var dt=st.t===1?"x1":"cx",mt=dt==="x1"?"y1":"cy";lt.setAttribute(dt,ft[0]),lt.setAttribute(mt,ft[1]),ct&&!at.g._collapsable&&(at.of.setAttribute(dt,ft[0]),at.of.setAttribute(mt,ft[1]))}var pt,yt,gt,vt;if(at.g._cmdf||ot){pt=at.cst;var St=at.g.c;for(gt=pt.length,yt=0;yt<gt;yt+=1)vt=pt[yt],vt.setAttribute("offset",St[yt*4]+"%"),vt.setAttribute("stop-color","rgb("+St[yt*4+1]+","+St[yt*4+2]+","+St[yt*4+3]+")")}if(ct&&(at.g._omdf||ot)){var At=at.g.o;for(at.g._collapsable?pt=at.cst:pt=at.ost,gt=pt.length,yt=0;yt<gt;yt+=1)vt=pt[yt],at.g._collapsable||vt.setAttribute("offset",At[yt*2]+"%"),vt.setAttribute("stop-opacity",At[yt*2+1])}if(st.t===1)(at.e._mdf||ot)&&(lt.setAttribute("x2",ut[0]),lt.setAttribute("y2",ut[1]),ct&&!at.g._collapsable&&(at.of.setAttribute("x2",ut[0]),at.of.setAttribute("y2",ut[1])));else{var xt;if((at.s._mdf||at.e._mdf||ot)&&(xt=Math.sqrt(Math.pow(ft[0]-ut[0],2)+Math.pow(ft[1]-ut[1],2)),lt.setAttribute("r",xt),ct&&!at.g._collapsable&&at.of.setAttribute("r",xt)),at.s._mdf||at.e._mdf||at.h._mdf||at.a._mdf||ot){xt||(xt=Math.sqrt(Math.pow(ft[0]-ut[0],2)+Math.pow(ft[1]-ut[1],2)));var wt=Math.atan2(ut[1]-ft[1],ut[0]-ft[0]),Ot=at.h.v;Ot>=1?Ot=.99:Ot<=-1&&(Ot=-.99);var Bt=xt*Ot,Ft=Math.cos(wt+at.a.v)*Bt+ft[0],Pt=Math.sin(wt+at.a.v)*Bt+ft[1];lt.setAttribute("fx",Ft),lt.setAttribute("fy",Pt),ct&&!at.g._collapsable&&(at.of.setAttribute("fx",Ft),at.of.setAttribute("fy",Pt))}}}function it(st,at,ot){var lt=at.style,ct=at.d;ct&&(ct._mdf||ot)&&ct.dashStr&&(lt.pElem.setAttribute("stroke-dasharray",ct.dashStr),lt.pElem.setAttribute("stroke-dashoffset",ct.dashoffset[0])),at.c&&(at.c._mdf||ot)&&lt.pElem.setAttribute("stroke","rgb("+bmFloor(at.c.v[0])+","+bmFloor(at.c.v[1])+","+bmFloor(at.c.v[2])+")"),(at.o._mdf||ot)&&lt.pElem.setAttribute("stroke-opacity",at.o.v),(at.w._mdf||ot)&&(lt.pElem.setAttribute("stroke-width",at.w.v),lt.msElem&&lt.msElem.setAttribute("stroke-width",at.w.v))}return _}();function SVGShapeElement(o,i,_){this.shapes=[],this.shapesData=o.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(o,i,_),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var o,i=this.shapes.length,_,$,j=this.stylesList.length,_e,et=[],tt=!1;for($=0;$<j;$+=1){for(_e=this.stylesList[$],tt=!1,et.length=0,o=0;o<i;o+=1)_=this.shapes[o],_.styles.indexOf(_e)!==-1&&(et.push(_),tt=_._isAnimated||tt);et.length>1&&tt&&this.setShapesAsAnimated(et)}},SVGShapeElement.prototype.setShapesAsAnimated=function(o){var i,_=o.length;for(i=0;i<_;i+=1)o[i].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(o,i){var _,$=new SVGStyleData(o,i),j=$.pElem;if(o.ty==="st")_=new SVGStrokeStyleData(this,o,$);else if(o.ty==="fl")_=new SVGFillStyleData(this,o,$);else if(o.ty==="gf"||o.ty==="gs"){var _e=o.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;_=new _e(this,o,$),this.globalData.defs.appendChild(_.gf),_.maskId&&(this.globalData.defs.appendChild(_.ms),this.globalData.defs.appendChild(_.of),j.setAttribute("mask","url("+getLocationHref()+"#"+_.maskId+")"))}else o.ty==="no"&&(_=new SVGNoStyleData(this,o,$));return(o.ty==="st"||o.ty==="gs")&&(j.setAttribute("stroke-linecap",lineCapEnum[o.lc||2]),j.setAttribute("stroke-linejoin",lineJoinEnum[o.lj||2]),j.setAttribute("fill-opacity","0"),o.lj===1&&j.setAttribute("stroke-miterlimit",o.ml)),o.r===2&&j.setAttribute("fill-rule","evenodd"),o.ln&&j.setAttribute("id",o.ln),o.cl&&j.setAttribute("class",o.cl),o.bm&&(j.style["mix-blend-mode"]=getBlendMode(o.bm)),this.stylesList.push($),this.addToAnimatedContents(o,_),_},SVGShapeElement.prototype.createGroupElement=function(o){var i=new ShapeGroupData;return o.ln&&i.gr.setAttribute("id",o.ln),o.cl&&i.gr.setAttribute("class",o.cl),o.bm&&(i.gr.style["mix-blend-mode"]=getBlendMode(o.bm)),i},SVGShapeElement.prototype.createTransformElement=function(o,i){var _=TransformPropertyFactory.getTransformProperty(this,o,this),$=new SVGTransformData(_,_.o,i);return this.addToAnimatedContents(o,$),$},SVGShapeElement.prototype.createShapeElement=function(o,i,_){var $=4;o.ty==="rc"?$=5:o.ty==="el"?$=6:o.ty==="sr"&&($=7);var j=ShapePropertyFactory.getShapeProp(this,o,$,this),_e=new SVGShapeData(i,_,j);return this.shapes.push(_e),this.addShapeToModifiers(_e),this.addToAnimatedContents(o,_e),_e},SVGShapeElement.prototype.addToAnimatedContents=function(o,i){for(var _=0,$=this.animatedContents.length;_<$;){if(this.animatedContents[_].element===i)return;_+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(o),element:i,data:o})},SVGShapeElement.prototype.setElementStyles=function(o){var i=o.styles,_,$=this.stylesList.length;for(_=0;_<$;_+=1)i.indexOf(this.stylesList[_])===-1&&!this.stylesList[_].closed&&i.push(this.stylesList[_])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var o,i=this.itemsData.length;for(o=0;o<i;o+=1)this.prevViewData[o]=this.itemsData[o];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),i=this.dynamicProperties.length,o=0;o<i;o+=1)this.dynamicProperties[o].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(o,i,_,$,j,_e,et){var tt=[].concat(_e),rt,nt=o.length-1,it,st,at=[],ot=[],lt,ct,ft;for(rt=nt;rt>=0;rt-=1){if(ft=this.searchProcessedElement(o[rt]),ft?i[rt]=_[ft-1]:o[rt]._render=et,o[rt].ty==="fl"||o[rt].ty==="st"||o[rt].ty==="gf"||o[rt].ty==="gs"||o[rt].ty==="no")ft?i[rt].style.closed=o[rt].hd:i[rt]=this.createStyleElement(o[rt],j),o[rt]._render&&i[rt].style.pElem.parentNode!==$&&$.appendChild(i[rt].style.pElem),at.push(i[rt].style);else if(o[rt].ty==="gr"){if(!ft)i[rt]=this.createGroupElement(o[rt]);else for(st=i[rt].it.length,it=0;it<st;it+=1)i[rt].prevViewData[it]=i[rt].it[it];this.searchShapes(o[rt].it,i[rt].it,i[rt].prevViewData,i[rt].gr,j+1,tt,et),o[rt]._render&&i[rt].gr.parentNode!==$&&$.appendChild(i[rt].gr)}else o[rt].ty==="tr"?(ft||(i[rt]=this.createTransformElement(o[rt],$)),lt=i[rt].transform,tt.push(lt)):o[rt].ty==="sh"||o[rt].ty==="rc"||o[rt].ty==="el"||o[rt].ty==="sr"?(ft||(i[rt]=this.createShapeElement(o[rt],tt,j)),this.setElementStyles(i[rt])):o[rt].ty==="tm"||o[rt].ty==="rd"||o[rt].ty==="ms"||o[rt].ty==="pb"||o[rt].ty==="zz"||o[rt].ty==="op"?(ft?(ct=i[rt],ct.closed=!1):(ct=ShapeModifiers.getModifier(o[rt].ty),ct.init(this,o[rt]),i[rt]=ct,this.shapeModifiers.push(ct)),ot.push(ct)):o[rt].ty==="rp"&&(ft?(ct=i[rt],ct.closed=!0):(ct=ShapeModifiers.getModifier(o[rt].ty),i[rt]=ct,ct.init(this,o,rt,i),this.shapeModifiers.push(ct),et=!1),ot.push(ct));this.addProcessedElement(o[rt],rt+1)}for(nt=at.length,rt=0;rt<nt;rt+=1)at[rt].closed=!0;for(nt=ot.length,rt=0;rt<nt;rt+=1)ot[rt].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var o,i=this.stylesList.length;for(o=0;o<i;o+=1)this.stylesList[o].reset();for(this.renderShape(),o=0;o<i;o+=1)(this.stylesList[o]._mdf||this._isFirstFrame)&&(this.stylesList[o].msElem&&(this.stylesList[o].msElem.setAttribute("d",this.stylesList[o].d),this.stylesList[o].d="M0 0"+this.stylesList[o].d),this.stylesList[o].pElem.setAttribute("d",this.stylesList[o].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var o,i=this.animatedContents.length,_;for(o=0;o<i;o+=1)_=this.animatedContents[o],(this._isFirstFrame||_.element._isAnimated)&&_.data!==!0&&_.fn(_.data,_.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(o,i,_,$,j,_e){this.o=o,this.sw=i,this.sc=_,this.fc=$,this.m=j,this.p=_e,this._mdf={o:!0,sw:!!i,sc:!!_,fc:!!$,m:!0,p:!0}}LetterProps.prototype.update=function(o,i,_,$,j,_e){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var et=!1;return this.o!==o&&(this.o=o,this._mdf.o=!0,et=!0),this.sw!==i&&(this.sw=i,this._mdf.sw=!0,et=!0),this.sc!==_&&(this.sc=_,this._mdf.sc=!0,et=!0),this.fc!==$&&(this.fc=$,this._mdf.fc=!0,et=!0),this.m!==j&&(this.m=j,this._mdf.m=!0,et=!0),_e.length&&(this.p[0]!==_e[0]||this.p[1]!==_e[1]||this.p[4]!==_e[4]||this.p[5]!==_e[5]||this.p[12]!==_e[12]||this.p[13]!==_e[13])&&(this.p=_e,this._mdf.p=!0,et=!0),et};function TextProperty(o,i){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,i.d&&i.d.sid&&(i.d=o.globalData.slotManager.getProp(i.d)),this.data=i,this.elem=o,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(o,i){for(var _ in i)Object.prototype.hasOwnProperty.call(i,_)&&(o[_]=i[_]);return o},TextProperty.prototype.setCurrentData=function(o){o.__complete||this.completeTextData(o),this.currentData=o,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(o){this.effectsSequence.push(o),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(o){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!o)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var i=this.currentData,_=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var $,j=this.effectsSequence.length,_e=o||this.data.d.k[this.keysIndex].s;for($=0;$<j;$+=1)_!==this.keysIndex?_e=this.effectsSequence[$](_e,_e.t):_e=this.effectsSequence[$](this.currentData,_e.t);i!==_e&&this.setCurrentData(_e),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var o=this.data.d.k,i=this.elem.comp.renderedFrame,_=0,$=o.length;_<=$-1&&!(_===$-1||o[_+1].t>i);)_+=1;return this.keysIndex!==_&&(this.keysIndex=_),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(o){for(var i=[],_=0,$=o.length,j,_e,et=!1,tt=!1,rt="";_<$;)et=tt,tt=!1,j=o.charCodeAt(_),rt=o.charAt(_),FontManager.isCombinedCharacter(j)?et=!0:j>=55296&&j<=56319?FontManager.isRegionalFlag(o,_)?rt=o.substr(_,14):(_e=o.charCodeAt(_+1),_e>=56320&&_e<=57343&&(FontManager.isModifier(j,_e)?(rt=o.substr(_,2),et=!0):FontManager.isFlagEmoji(o.substr(_,4))?rt=o.substr(_,4):rt=o.substr(_,2))):j>56319?(_e=o.charCodeAt(_+1),FontManager.isVariationSelector(j)&&(et=!0)):FontManager.isZeroWidthJoiner(j)&&(et=!0,tt=!0),et?(i[i.length-1]+=rt,et=!1):i.push(rt),_+=rt.length;return i},TextProperty.prototype.completeTextData=function(o){o.__complete=!0;var i=this.elem.globalData.fontManager,_=this.data,$=[],j,_e,et,tt=0,rt,nt=_.m.g,it=0,st=0,at=0,ot=[],lt=0,ct=0,ft,ut,ht=i.getFontByName(o.f),dt,mt=0,pt=getFontProperties(ht);o.fWeight=pt.weight,o.fStyle=pt.style,o.finalSize=o.s,o.finalText=this.buildFinalText(o.t),_e=o.finalText.length,o.finalLineHeight=o.lh;var yt=o.tr/1e3*o.finalSize,gt;if(o.sz)for(var vt=!0,St=o.sz[0],At=o.sz[1],xt,wt;vt;){wt=this.buildFinalText(o.t),xt=0,lt=0,_e=wt.length,yt=o.tr/1e3*o.finalSize;var Ot=-1;for(j=0;j<_e;j+=1)gt=wt[j].charCodeAt(0),et=!1,wt[j]===" "?Ot=j:(gt===13||gt===3)&&(lt=0,et=!0,xt+=o.finalLineHeight||o.finalSize*1.2),i.chars?(dt=i.getCharData(wt[j],ht.fStyle,ht.fFamily),mt=et?0:dt.w*o.finalSize/100):mt=i.measureText(wt[j],o.f,o.finalSize),lt+mt>St&&wt[j]!==" "?(Ot===-1?_e+=1:j=Ot,xt+=o.finalLineHeight||o.finalSize*1.2,wt.splice(j,Ot===j?1:0,"\r"),Ot=-1,lt=0):(lt+=mt,lt+=yt);xt+=ht.ascent*o.finalSize/100,this.canResize&&o.finalSize>this.minimumFontSize&&At<xt?(o.finalSize-=1,o.finalLineHeight=o.finalSize*o.lh/o.s):(o.finalText=wt,_e=o.finalText.length,vt=!1)}lt=-yt,mt=0;var Bt=0,Ft;for(j=0;j<_e;j+=1)if(et=!1,Ft=o.finalText[j],gt=Ft.charCodeAt(0),gt===13||gt===3?(Bt=0,ot.push(lt),ct=lt>ct?lt:ct,lt=-2*yt,rt="",et=!0,at+=1):rt=Ft,i.chars?(dt=i.getCharData(Ft,ht.fStyle,i.getFontByName(o.f).fFamily),mt=et?0:dt.w*o.finalSize/100):mt=i.measureText(rt,o.f,o.finalSize),Ft===" "?Bt+=mt+yt:(lt+=mt+yt+Bt,Bt=0),$.push({l:mt,an:mt,add:it,n:et,anIndexes:[],val:rt,line:at,animatorJustifyOffset:0}),nt==2){if(it+=mt,rt===""||rt===" "||j===_e-1){for((rt===""||rt===" ")&&(it-=mt);st<=j;)$[st].an=it,$[st].ind=tt,$[st].extra=mt,st+=1;tt+=1,it=0}}else if(nt==3){if(it+=mt,rt===""||j===_e-1){for(rt===""&&(it-=mt);st<=j;)$[st].an=it,$[st].ind=tt,$[st].extra=mt,st+=1;it=0,tt+=1}}else $[tt].ind=tt,$[tt].extra=0,tt+=1;if(o.l=$,ct=lt>ct?lt:ct,ot.push(lt),o.sz)o.boxWidth=o.sz[0],o.justifyOffset=0;else switch(o.boxWidth=ct,o.j){case 1:o.justifyOffset=-o.boxWidth;break;case 2:o.justifyOffset=-o.boxWidth/2;break;default:o.justifyOffset=0}o.lineWidths=ot;var Pt=_.a,Rt,Et;ut=Pt.length;var _t,Mt,Dt=[];for(ft=0;ft<ut;ft+=1){for(Rt=Pt[ft],Rt.a.sc&&(o.strokeColorAnim=!0),Rt.a.sw&&(o.strokeWidthAnim=!0),(Rt.a.fc||Rt.a.fh||Rt.a.fs||Rt.a.fb)&&(o.fillColorAnim=!0),Mt=0,_t=Rt.s.b,j=0;j<_e;j+=1)Et=$[j],Et.anIndexes[ft]=Mt,(_t==1&&Et.val!==""||_t==2&&Et.val!==""&&Et.val!==" "||_t==3&&(Et.n||Et.val==" "||j==_e-1)||_t==4&&(Et.n||j==_e-1))&&(Rt.s.rn===1&&Dt.push(Mt),Mt+=1);_.a[ft].s.totalChars=Mt;var Lt=-1,Ct;if(Rt.s.rn===1)for(j=0;j<_e;j+=1)Et=$[j],Lt!=Et.anIndexes[ft]&&(Lt=Et.anIndexes[ft],Ct=Dt.splice(Math.floor(Math.random()*Dt.length),1)[0]),Et.anIndexes[ft]=Ct}o.yOffset=o.finalLineHeight||o.finalSize*1.2,o.ls=o.ls||0,o.ascent=ht.ascent*o.finalSize/100},TextProperty.prototype.updateDocumentData=function(o,i){i=i===void 0?this.keysIndex:i;var _=this.copyData({},this.data.d.k[i].s);_=this.copyData(_,o),this.data.d.k[i].s=_,this.recalculate(i),this.setCurrentData(_),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(o){var i=this.data.d.k[o].s;i.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(i)},TextProperty.prototype.canResizeFont=function(o){this.canResize=o,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(o){this.minimumFontSize=Math.floor(o)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var o=Math.max,i=Math.min,_=Math.floor;function $(_e,et){this._currentTextLength=-1,this.k=!1,this.data=et,this.elem=_e,this.comp=_e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(_e),this.s=PropertyFactory.getProp(_e,et.s||{k:0},0,0,this),"e"in et?this.e=PropertyFactory.getProp(_e,et.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(_e,et.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(_e,et.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(_e,et.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(_e,et.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(_e,et.a,0,.01,this),this.dynamicProperties.length||this.getValue()}$.prototype={getMult:function(et){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var tt=0,rt=0,nt=1,it=1;this.ne.v>0?tt=this.ne.v/100:rt=-this.ne.v/100,this.xe.v>0?nt=1-this.xe.v/100:it=1+this.xe.v/100;var st=BezierFactory.getBezierEasing(tt,rt,nt,it).get,at=0,ot=this.finalS,lt=this.finalE,ct=this.data.sh;if(ct===2)lt===ot?at=et>=lt?1:0:at=o(0,i(.5/(lt-ot)+(et-ot)/(lt-ot),1)),at=st(at);else if(ct===3)lt===ot?at=et>=lt?0:1:at=1-o(0,i(.5/(lt-ot)+(et-ot)/(lt-ot),1)),at=st(at);else if(ct===4)lt===ot?at=0:(at=o(0,i(.5/(lt-ot)+(et-ot)/(lt-ot),1)),at<.5?at*=2:at=1-2*(at-.5)),at=st(at);else if(ct===5){if(lt===ot)at=0;else{var ft=lt-ot;et=i(o(0,et+.5-ot),lt-ot);var ut=-ft/2+et,ht=ft/2;at=Math.sqrt(1-ut*ut/(ht*ht))}at=st(at)}else ct===6?(lt===ot?at=0:(et=i(o(0,et+.5-ot),lt-ot),at=(1+Math.cos(Math.PI+Math.PI*2*et/(lt-ot)))/2),at=st(at)):(et>=_(ot)&&(et-ot<0?at=o(0,i(i(lt,1)-(ot-et),1)):at=o(0,i(lt-et,1))),at=st(at));if(this.sm.v!==100){var dt=this.sm.v*.01;dt===0&&(dt=1e-8);var mt=.5-dt*.5;at<mt?at=0:(at=(at-mt)/dt,at>1&&(at=1))}return at*this.a.v},getValue:function(et){this.iterateDynamicProperties(),this._mdf=et||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,et&&this.data.r===2&&(this.e.v=this._currentTextLength);var tt=this.data.r===2?1:100/this.data.totalChars,rt=this.o.v/tt,nt=this.s.v/tt+rt,it=this.e.v/tt+rt;if(nt>it){var st=nt;nt=it,it=st}this.finalS=nt,this.finalE=it}},extendPrototype([DynamicPropertyContainer],$);function j(_e,et,tt){return new $(_e,et)}return{getTextSelectorProp:j}}();function TextAnimatorDataProperty(o,i,_){var $={propType:!1},j=PropertyFactory.getProp,_e=i.a;this.a={r:_e.r?j(o,_e.r,0,degToRads,_):$,rx:_e.rx?j(o,_e.rx,0,degToRads,_):$,ry:_e.ry?j(o,_e.ry,0,degToRads,_):$,sk:_e.sk?j(o,_e.sk,0,degToRads,_):$,sa:_e.sa?j(o,_e.sa,0,degToRads,_):$,s:_e.s?j(o,_e.s,1,.01,_):$,a:_e.a?j(o,_e.a,1,0,_):$,o:_e.o?j(o,_e.o,0,.01,_):$,p:_e.p?j(o,_e.p,1,0,_):$,sw:_e.sw?j(o,_e.sw,0,0,_):$,sc:_e.sc?j(o,_e.sc,1,0,_):$,fc:_e.fc?j(o,_e.fc,1,0,_):$,fh:_e.fh?j(o,_e.fh,0,0,_):$,fs:_e.fs?j(o,_e.fs,0,.01,_):$,fb:_e.fb?j(o,_e.fb,0,.01,_):$,t:_e.t?j(o,_e.t,0,0,_):$},this.s=TextSelectorProp.getTextSelectorProp(o,i.s,_),this.s.t=i.s.t}function TextAnimatorProperty(o,i,_){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=o,this._renderType=i,this._elem=_,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(_)}TextAnimatorProperty.prototype.searchProperties=function(){var o,i=this._textData.a.length,_,$=PropertyFactory.getProp;for(o=0;o<i;o+=1)_=this._textData.a[o],this._animatorsData[o]=new TextAnimatorDataProperty(this._elem,_,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:$(this._elem,this._textData.p.a,0,0,this),f:$(this._elem,this._textData.p.f,0,0,this),l:$(this._elem,this._textData.p.l,0,0,this),r:$(this._elem,this._textData.p.r,0,0,this),p:$(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=$(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(o,i){if(this.lettersChangedFlag=i,!(!this._mdf&&!this._isFirstFrame&&!i&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var _=this._moreOptions.alignment.v,$=this._animatorsData,j=this._textData,_e=this.mHelper,et=this._renderType,tt=this.renderedLetters.length,rt,nt,it,st,at=o.l,ot,lt,ct,ft,ut,ht,dt,mt,pt,yt,gt,vt,St,At,xt;if(this._hasMaskedPath){if(xt=this._pathData.m,!this._pathData.n||this._pathData._mdf){var wt=xt.v;this._pathData.r.v&&(wt=wt.reverse()),ot={tLength:0,segments:[]},st=wt._length-1;var Ot;for(vt=0,it=0;it<st;it+=1)Ot=bez.buildBezierData(wt.v[it],wt.v[it+1],[wt.o[it][0]-wt.v[it][0],wt.o[it][1]-wt.v[it][1]],[wt.i[it+1][0]-wt.v[it+1][0],wt.i[it+1][1]-wt.v[it+1][1]]),ot.tLength+=Ot.segmentLength,ot.segments.push(Ot),vt+=Ot.segmentLength;it=st,xt.v.c&&(Ot=bez.buildBezierData(wt.v[it],wt.v[0],[wt.o[it][0]-wt.v[it][0],wt.o[it][1]-wt.v[it][1]],[wt.i[0][0]-wt.v[0][0],wt.i[0][1]-wt.v[0][1]]),ot.tLength+=Ot.segmentLength,ot.segments.push(Ot),vt+=Ot.segmentLength),this._pathData.pi=ot}if(ot=this._pathData.pi,lt=this._pathData.f.v,dt=0,ht=1,ft=0,ut=!0,yt=ot.segments,lt<0&&xt.v.c)for(ot.tLength<Math.abs(lt)&&(lt=-Math.abs(lt)%ot.tLength),dt=yt.length-1,pt=yt[dt].points,ht=pt.length-1;lt<0;)lt+=pt[ht].partialLength,ht-=1,ht<0&&(dt-=1,pt=yt[dt].points,ht=pt.length-1);pt=yt[dt].points,mt=pt[ht-1],ct=pt[ht],gt=ct.partialLength}st=at.length,rt=0,nt=0;var Bt=o.finalSize*1.2*.714,Ft=!0,Pt,Rt,Et,_t,Mt;_t=$.length;var Dt,Lt=-1,Ct,kt,jt,Vt=lt,zt=dt,qt=ht,Wt=-1,ir,or,Qt,gr,ar,Ar,er,sr,Gt="",Jt=this.defaultPropsArray,lr;if(o.j===2||o.j===1){var dr=0,xr=0,Mr=o.j===2?-.5:-1,Or=0,fr=!0;for(it=0;it<st;it+=1)if(at[it].n){for(dr&&(dr+=xr);Or<it;)at[Or].animatorJustifyOffset=dr,Or+=1;dr=0,fr=!0}else{for(Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.t.propType&&(fr&&o.j===2&&(xr+=Pt.t.v*Mr),Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Dt.length?dr+=Pt.t.v*Dt[0]*Mr:dr+=Pt.t.v*Dt*Mr);fr=!1}for(dr&&(dr+=xr);Or<it;)at[Or].animatorJustifyOffset=dr,Or+=1}for(it=0;it<st;it+=1){if(_e.reset(),ir=1,at[it].n)rt=0,nt+=o.yOffset,nt+=Ft?1:0,lt=Vt,Ft=!1,this._hasMaskedPath&&(dt=zt,ht=qt,pt=yt[dt].points,mt=pt[ht-1],ct=pt[ht],gt=ct.partialLength,ft=0),Gt="",sr="",Ar="",lr="",Jt=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Wt!==at[it].line){switch(o.j){case 1:lt+=vt-o.lineWidths[at[it].line];break;case 2:lt+=(vt-o.lineWidths[at[it].line])/2;break}Wt=at[it].line}Lt!==at[it].ind&&(at[Lt]&&(lt+=at[Lt].extra),lt+=at[it].an/2,Lt=at[it].ind),lt+=_[0]*at[it].an*.005;var Hr=0;for(Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.p.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Dt.length?Hr+=Pt.p.v[0]*Dt[0]:Hr+=Pt.p.v[0]*Dt),Pt.a.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Dt.length?Hr+=Pt.a.v[0]*Dt[0]:Hr+=Pt.a.v[0]*Dt);for(ut=!0,this._pathData.a.v&&(lt=at[0].an*.5+(vt-this._pathData.f.v-at[0].an*.5-at[at.length-1].an*.5)*Lt/(st-1),lt+=this._pathData.f.v);ut;)ft+gt>=lt+Hr||!pt?(St=(lt+Hr-ft)/ct.partialLength,kt=mt.point[0]+(ct.point[0]-mt.point[0])*St,jt=mt.point[1]+(ct.point[1]-mt.point[1])*St,_e.translate(-_[0]*at[it].an*.005,-(_[1]*Bt)*.01),ut=!1):pt&&(ft+=ct.partialLength,ht+=1,ht>=pt.length&&(ht=0,dt+=1,yt[dt]?pt=yt[dt].points:xt.v.c?(ht=0,dt=0,pt=yt[dt].points):(ft-=ct.partialLength,pt=null)),pt&&(mt=ct,ct=pt[ht],gt=ct.partialLength));Ct=at[it].an/2-at[it].add,_e.translate(-Ct,0,0)}else Ct=at[it].an/2-at[it].add,_e.translate(-Ct,0,0),_e.translate(-_[0]*at[it].an*.005,-_[1]*Bt*.01,0);for(Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.t.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),(rt!==0||o.j!==0)&&(this._hasMaskedPath?Dt.length?lt+=Pt.t.v*Dt[0]:lt+=Pt.t.v*Dt:Dt.length?rt+=Pt.t.v*Dt[0]:rt+=Pt.t.v*Dt));for(o.strokeWidthAnim&&(Qt=o.sw||0),o.strokeColorAnim&&(o.sc?or=[o.sc[0],o.sc[1],o.sc[2]]:or=[0,0,0]),o.fillColorAnim&&o.fc&&(gr=[o.fc[0],o.fc[1],o.fc[2]]),Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.a.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Dt.length?_e.translate(-Pt.a.v[0]*Dt[0],-Pt.a.v[1]*Dt[1],Pt.a.v[2]*Dt[2]):_e.translate(-Pt.a.v[0]*Dt,-Pt.a.v[1]*Dt,Pt.a.v[2]*Dt));for(Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.s.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Dt.length?_e.scale(1+(Pt.s.v[0]-1)*Dt[0],1+(Pt.s.v[1]-1)*Dt[1],1):_e.scale(1+(Pt.s.v[0]-1)*Dt,1+(Pt.s.v[1]-1)*Dt,1));for(Et=0;Et<_t;Et+=1){if(Pt=$[Et].a,Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),Pt.sk.propType&&(Dt.length?_e.skewFromAxis(-Pt.sk.v*Dt[0],Pt.sa.v*Dt[1]):_e.skewFromAxis(-Pt.sk.v*Dt,Pt.sa.v*Dt)),Pt.r.propType&&(Dt.length?_e.rotateZ(-Pt.r.v*Dt[2]):_e.rotateZ(-Pt.r.v*Dt)),Pt.ry.propType&&(Dt.length?_e.rotateY(Pt.ry.v*Dt[1]):_e.rotateY(Pt.ry.v*Dt)),Pt.rx.propType&&(Dt.length?_e.rotateX(Pt.rx.v*Dt[0]):_e.rotateX(Pt.rx.v*Dt)),Pt.o.propType&&(Dt.length?ir+=(Pt.o.v*Dt[0]-ir)*Dt[0]:ir+=(Pt.o.v*Dt-ir)*Dt),o.strokeWidthAnim&&Pt.sw.propType&&(Dt.length?Qt+=Pt.sw.v*Dt[0]:Qt+=Pt.sw.v*Dt),o.strokeColorAnim&&Pt.sc.propType)for(ar=0;ar<3;ar+=1)Dt.length?or[ar]+=(Pt.sc.v[ar]-or[ar])*Dt[0]:or[ar]+=(Pt.sc.v[ar]-or[ar])*Dt;if(o.fillColorAnim&&o.fc){if(Pt.fc.propType)for(ar=0;ar<3;ar+=1)Dt.length?gr[ar]+=(Pt.fc.v[ar]-gr[ar])*Dt[0]:gr[ar]+=(Pt.fc.v[ar]-gr[ar])*Dt;Pt.fh.propType&&(Dt.length?gr=addHueToRGB(gr,Pt.fh.v*Dt[0]):gr=addHueToRGB(gr,Pt.fh.v*Dt)),Pt.fs.propType&&(Dt.length?gr=addSaturationToRGB(gr,Pt.fs.v*Dt[0]):gr=addSaturationToRGB(gr,Pt.fs.v*Dt)),Pt.fb.propType&&(Dt.length?gr=addBrightnessToRGB(gr,Pt.fb.v*Dt[0]):gr=addBrightnessToRGB(gr,Pt.fb.v*Dt))}}for(Et=0;Et<_t;Et+=1)Pt=$[Et].a,Pt.p.propType&&(Rt=$[Et].s,Dt=Rt.getMult(at[it].anIndexes[Et],j.a[Et].s.totalChars),this._hasMaskedPath?Dt.length?_e.translate(0,Pt.p.v[1]*Dt[0],-Pt.p.v[2]*Dt[1]):_e.translate(0,Pt.p.v[1]*Dt,-Pt.p.v[2]*Dt):Dt.length?_e.translate(Pt.p.v[0]*Dt[0],Pt.p.v[1]*Dt[1],-Pt.p.v[2]*Dt[2]):_e.translate(Pt.p.v[0]*Dt,Pt.p.v[1]*Dt,-Pt.p.v[2]*Dt));if(o.strokeWidthAnim&&(Ar=Qt<0?0:Qt),o.strokeColorAnim&&(er="rgb("+Math.round(or[0]*255)+","+Math.round(or[1]*255)+","+Math.round(or[2]*255)+")"),o.fillColorAnim&&o.fc&&(sr="rgb("+Math.round(gr[0]*255)+","+Math.round(gr[1]*255)+","+Math.round(gr[2]*255)+")"),this._hasMaskedPath){if(_e.translate(0,-o.ls),_e.translate(0,_[1]*Bt*.01+nt,0),this._pathData.p.v){At=(ct.point[1]-mt.point[1])/(ct.point[0]-mt.point[0]);var Gr=Math.atan(At)*180/Math.PI;ct.point[0]<mt.point[0]&&(Gr+=180),_e.rotate(-Gr*Math.PI/180)}_e.translate(kt,jt,0),lt-=_[0]*at[it].an*.005,at[it+1]&&Lt!==at[it+1].ind&&(lt+=at[it].an/2,lt+=o.tr*.001*o.finalSize)}else{switch(_e.translate(rt,nt,0),o.ps&&_e.translate(o.ps[0],o.ps[1]+o.ascent,0),o.j){case 1:_e.translate(at[it].animatorJustifyOffset+o.justifyOffset+(o.boxWidth-o.lineWidths[at[it].line]),0,0);break;case 2:_e.translate(at[it].animatorJustifyOffset+o.justifyOffset+(o.boxWidth-o.lineWidths[at[it].line])/2,0,0);break}_e.translate(0,-o.ls),_e.translate(Ct,0,0),_e.translate(_[0]*at[it].an*.005,_[1]*Bt*.01,0),rt+=at[it].l+o.tr*.001*o.finalSize}et==="html"?Gt=_e.toCSS():et==="svg"?Gt=_e.to2dCSS():Jt=[_e.props[0],_e.props[1],_e.props[2],_e.props[3],_e.props[4],_e.props[5],_e.props[6],_e.props[7],_e.props[8],_e.props[9],_e.props[10],_e.props[11],_e.props[12],_e.props[13],_e.props[14],_e.props[15]],lr=ir}tt<=it?(Mt=new LetterProps(lr,Ar,er,sr,Gt,Jt),this.renderedLetters.push(Mt),tt+=1,this.lettersChangedFlag=!0):(Mt=this.renderedLetters[it],this.lettersChangedFlag=Mt.update(lr,Ar,er,sr,Gt,Jt)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(o,i,_){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(o,i,_),this.textProperty=new TextProperty(this,o.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(o.t,this.renderType,this),this.initTransform(o,i,_),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(o){this._mdf=!1,this.prepareRenderableFrame(o),this.prepareProperties(o,this.isInRange)},ITextElement.prototype.createPathShape=function(o,i){var _,$=i.length,j,_e="";for(_=0;_<$;_+=1)i[_].ty==="sh"&&(j=i[_].ks.k,_e+=buildShapeString(j,j.i.length,!0,o));return _e},ITextElement.prototype.updateDocumentData=function(o,i){this.textProperty.updateDocumentData(o,i)},ITextElement.prototype.canResizeFont=function(o){this.textProperty.canResizeFont(o)},ITextElement.prototype.setMinimumFontSize=function(o){this.textProperty.setMinimumFontSize(o)},ITextElement.prototype.applyTextPropertiesToMatrix=function(o,i,_,$,j){switch(o.ps&&i.translate(o.ps[0],o.ps[1]+o.ascent,0),i.translate(0,-o.ls,0),o.j){case 1:i.translate(o.justifyOffset+(o.boxWidth-o.lineWidths[_]),0,0);break;case 2:i.translate(o.justifyOffset+(o.boxWidth-o.lineWidths[_])/2,0,0);break}i.translate($,j,0)},ITextElement.prototype.buildColor=function(o){return"rgb("+Math.round(o[0]*255)+","+Math.round(o[1]*255)+","+Math.round(o[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(o,i,_){this.textSpans=[],this.renderType="svg",this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(o){for(var i=0,_=o.length,$=[],j="";i<_;)o[i]==="\r"||o[i]===""?($.push(j),j=""):j+=o[i],i+=1;return $.push(j),$},SVGTextLottieElement.prototype.buildShapeData=function(o,i){if(o.shapes&&o.shapes.length){var _=o.shapes[0];if(_.it){var $=_.it[_.it.length-1];$.s&&($.s.k[0]=i,$.s.k[1]=i)}}return o},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var o,i,_=this.textProperty.currentData;this.renderedLetters=createSizedArray(_?_.l.length:0),_.fc?this.layerElement.setAttribute("fill",this.buildColor(_.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),_.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(_.sc)),this.layerElement.setAttribute("stroke-width",_.sw)),this.layerElement.setAttribute("font-size",_.finalSize);var $=this.globalData.fontManager.getFontByName(_.f);if($.fClass)this.layerElement.setAttribute("class",$.fClass);else{this.layerElement.setAttribute("font-family",$.fFamily);var j=_.fWeight,_e=_.fStyle;this.layerElement.setAttribute("font-style",_e),this.layerElement.setAttribute("font-weight",j)}this.layerElement.setAttribute("aria-label",_.t);var et=_.l||[],tt=!!this.globalData.fontManager.chars;i=et.length;var rt,nt=this.mHelper,it="",st=this.data.singleShape,at=0,ot=0,lt=!0,ct=_.tr*.001*_.finalSize;if(st&&!tt&&!_.sz){var ft=this.textContainer,ut="start";switch(_.j){case 1:ut="end";break;case 2:ut="middle";break;default:ut="start";break}ft.setAttribute("text-anchor",ut),ft.setAttribute("letter-spacing",ct);var ht=this.buildTextContents(_.finalText);for(i=ht.length,ot=_.ps?_.ps[1]+_.ascent:0,o=0;o<i;o+=1)rt=this.textSpans[o].span||createNS("tspan"),rt.textContent=ht[o],rt.setAttribute("x",0),rt.setAttribute("y",ot),rt.style.display="inherit",ft.appendChild(rt),this.textSpans[o]||(this.textSpans[o]={span:null,glyph:null}),this.textSpans[o].span=rt,ot+=_.finalLineHeight;this.layerElement.appendChild(ft)}else{var dt=this.textSpans.length,mt;for(o=0;o<i;o+=1){if(this.textSpans[o]||(this.textSpans[o]={span:null,childSpan:null,glyph:null}),!tt||!st||o===0){if(rt=dt>o?this.textSpans[o].span:createNS(tt?"g":"text"),dt<=o){if(rt.setAttribute("stroke-linecap","butt"),rt.setAttribute("stroke-linejoin","round"),rt.setAttribute("stroke-miterlimit","4"),this.textSpans[o].span=rt,tt){var pt=createNS("g");rt.appendChild(pt),this.textSpans[o].childSpan=pt}this.textSpans[o].span=rt,this.layerElement.appendChild(rt)}rt.style.display="inherit"}if(nt.reset(),st&&(et[o].n&&(at=-ct,ot+=_.yOffset,ot+=lt?1:0,lt=!1),this.applyTextPropertiesToMatrix(_,nt,et[o].line,at,ot),at+=et[o].l||0,at+=ct),tt){mt=this.globalData.fontManager.getCharData(_.finalText[o],$.fStyle,this.globalData.fontManager.getFontByName(_.f).fFamily);var yt;if(mt.t===1)yt=new SVGCompElement(mt.data,this.globalData,this);else{var gt=emptyShapeData;mt.data&&mt.data.shapes&&(gt=this.buildShapeData(mt.data,_.finalSize)),yt=new SVGShapeElement(gt,this.globalData,this)}if(this.textSpans[o].glyph){var vt=this.textSpans[o].glyph;this.textSpans[o].childSpan.removeChild(vt.layerElement),vt.destroy()}this.textSpans[o].glyph=yt,yt._debug=!0,yt.prepareFrame(0),yt.renderFrame(),this.textSpans[o].childSpan.appendChild(yt.layerElement),mt.t===1&&this.textSpans[o].childSpan.setAttribute("transform","scale("+_.finalSize/100+","+_.finalSize/100+")")}else st&&rt.setAttribute("transform","translate("+nt.props[12]+","+nt.props[13]+")"),rt.textContent=et[o].val,rt.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}st&&rt&&rt.setAttribute("d",it)}for(;o<this.textSpans.length;)this.textSpans[o].span.style.display="none",o+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var o=this.layerElement.getBBox();this.bbox={top:o.y,left:o.x,width:o.width,height:o.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var o,i=this.textSpans.length,_;for(this.renderedFrame=this.comp.renderedFrame,o=0;o<i;o+=1)_=this.textSpans[o].glyph,_&&(_.prepareFrame(this.comp.renderedFrame-this.data.st),_._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var o,i,_=this.textAnimator.renderedLetters,$=this.textProperty.currentData.l;i=$.length;var j,_e,et;for(o=0;o<i;o+=1)$[o].n||(j=_[o],_e=this.textSpans[o].span,et=this.textSpans[o].glyph,et&&et.renderFrame(),j._mdf.m&&_e.setAttribute("transform",j.m),j._mdf.o&&_e.setAttribute("opacity",j.o),j._mdf.sw&&_e.setAttribute("stroke-width",j.sw),j._mdf.sc&&_e.setAttribute("stroke",j.sc),j._mdf.fc&&_e.setAttribute("fill",j.fc))}};function ISolidElement(o,i,_){this.initElement(o,i,_)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var o=createNS("rect");o.setAttribute("width",this.data.sw),o.setAttribute("height",this.data.sh),o.setAttribute("fill",this.data.sc),this.layerElement.appendChild(o)};function NullElement(o,i,_){this.initFrame(),this.initBaseData(o,i,_),this.initFrame(),this.initTransform(o,i,_),this.initHierarchy()}NullElement.prototype.prepareFrame=function(o){this.prepareProperties(o,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(o){return new NullElement(o,this.globalData,this)},SVGRendererBase.prototype.createShape=function(o){return new SVGShapeElement(o,this.globalData,this)},SVGRendererBase.prototype.createText=function(o){return new SVGTextLottieElement(o,this.globalData,this)},SVGRendererBase.prototype.createImage=function(o){return new IImageElement(o,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(o){return new ISolidElement(o,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(o){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+o.w+" "+o.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",o.w),this.svgElement.setAttribute("height",o.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var i=this.globalData.defs;this.setupGlobalData(o,i),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=o;var _=createNS("clipPath"),$=createNS("rect");$.setAttribute("width",o.w),$.setAttribute("height",o.h),$.setAttribute("x",0),$.setAttribute("y",0);var j=createElementID();_.setAttribute("id",j),_.appendChild($),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+j+")"),i.appendChild(_),this.layers=o.layers,this.elements=createSizedArray(o.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var o,i=this.layers?this.layers.length:0;for(o=0;o<i;o+=1)this.elements[o]&&this.elements[o].destroy&&this.elements[o].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(o){var i=0,_=this.layers.length;for(i=0;i<_;i+=1)if(this.layers[i].ind===o)return i;return-1},SVGRendererBase.prototype.buildItem=function(o){var i=this.elements;if(!(i[o]||this.layers[o].ty===99)){i[o]=!0;var _=this.createItem(this.layers[o]);if(i[o]=_,getExpressionsPlugin()&&(this.layers[o].ty===0&&this.globalData.projectInterface.registerComposition(_),_.initExpressions()),this.appendElementInPos(_,o),this.layers[o].tt){var $="tp"in this.layers[o]?this.findIndexByInd(this.layers[o].tp):o-1;if($===-1)return;if(!this.elements[$]||this.elements[$]===!0)this.buildItem($),this.addPendingElement(_);else{var j=i[$],_e=j.getMatte(this.layers[o].tt);_.setMatte(_e)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var o=this.pendingElements.pop();if(o.checkParenting(),o.data.tt)for(var i=0,_=this.elements.length;i<_;){if(this.elements[i]===o){var $="tp"in o.data?this.findIndexByInd(o.data.tp):i-1,j=this.elements[$],_e=j.getMatte(this.layers[i].tt);o.setMatte(_e);break}i+=1}}},SVGRendererBase.prototype.renderFrame=function(o){if(!(this.renderedFrame===o||this.destroyed)){o===null?o=this.renderedFrame:this.renderedFrame=o,this.globalData.frameNum=o,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=o,this.globalData._mdf=!1;var i,_=this.layers.length;for(this.completeLayers||this.checkLayers(o),i=_-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&this.elements[i].prepareFrame(o-this.layers[i].st);if(this.globalData._mdf)for(i=0;i<_;i+=1)(this.completeLayers||this.elements[i])&&this.elements[i].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(o,i){var _=o.getBaseElement();if(_){for(var $=0,j;$<i;)this.elements[$]&&this.elements[$]!==!0&&this.elements[$].getBaseElement()&&(j=this.elements[$].getBaseElement()),$+=1;j?this.layerElement.insertBefore(_,j):this.layerElement.appendChild(_)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(o,i,_){this.initFrame(),this.initBaseData(o,i,_),this.initTransform(o,i,_),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!i.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(o){if(this._mdf=!1,this.prepareRenderableFrame(o),this.prepareProperties(o,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=o/this.data.sr;else{var i=this.tm.v;i===this.data.op&&(i=this.data.op-1),this.renderedFrame=i}var _,$=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),_=$-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&(this.elements[_].prepareFrame(this.renderedFrame-this.layers[_].st),this.elements[_]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var o,i=this.layers.length;for(o=0;o<i;o+=1)(this.completeLayers||this.elements[o])&&this.elements[o].renderFrame()},ICompElement.prototype.setElements=function(o){this.elements=o},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var o,i=this.layers.length;for(o=0;o<i;o+=1)this.elements[o]&&this.elements[o].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(o,i,_){this.layers=o.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(o,i,_),this.tm=o.tm?PropertyFactory.getProp(this,o.tm,0,i.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(o){return new SVGCompElement(o,this.globalData,this)};function SVGRenderer(o,i){this.animationItem=o,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var _="";if(i&&i.title){var $=createNS("title"),j=createElementID();$.setAttribute("id",j),$.textContent=i.title,this.svgElement.appendChild($),_+=j}if(i&&i.description){var _e=createNS("desc"),et=createElementID();_e.setAttribute("id",et),_e.textContent=i.description,this.svgElement.appendChild(_e),_+=" "+et}_&&this.svgElement.setAttribute("aria-labelledby",_);var tt=createNS("defs");this.svgElement.appendChild(tt);var rt=createNS("g");this.svgElement.appendChild(rt),this.layerElement=rt,this.renderConfig={preserveAspectRatio:i&&i.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:i&&i.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:i&&i.contentVisibility||"visible",progressiveLoad:i&&i.progressiveLoad||!1,hideOnTransparent:!(i&&i.hideOnTransparent===!1),viewBoxOnly:i&&i.viewBoxOnly||!1,viewBoxSize:i&&i.viewBoxSize||!1,className:i&&i.className||"",id:i&&i.id||"",focusable:i&&i.focusable,filterSize:{width:i&&i.filterSize&&i.filterSize.width||"100%",height:i&&i.filterSize&&i.filterSize.height||"100%",x:i&&i.filterSize&&i.filterSize.x||"0%",y:i&&i.filterSize&&i.filterSize.y||"0%"},width:i&&i.width,height:i&&i.height,runExpressions:!i||i.runExpressions===void 0||i.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:tt,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(o){return new SVGCompElement(o,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(i){var _,$=i.length,j="_";for(_=0;_<$;_+=1)j+=i[_].transform.key+"_";var _e=this.sequences[j];return _e||(_e={transforms:[].concat(i),finalTransform:new Matrix,_mdf:!1},this.sequences[j]=_e,this.sequenceList.push(_e)),_e},processSequence:function(i,_){for(var $=0,j=i.transforms.length,_e=_;$<j&&!_;){if(i.transforms[$].transform.mProps._mdf){_e=!0;break}$+=1}if(_e)for(i.finalTransform.reset(),$=j-1;$>=0;$-=1)i.finalTransform.multiply(i.transforms[$].transform.mProps.v);i._mdf=_e},processSequences:function(i){var _,$=this.sequenceList.length;for(_=0;_<$;_+=1)this.processSequence(this.sequenceList[_],i)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var i="__lottie_element_luma_buffer",_=null,$=null,j=null;function _e(){var rt=createNS("svg"),nt=createNS("filter"),it=createNS("feColorMatrix");return nt.setAttribute("id",i),it.setAttribute("type","matrix"),it.setAttribute("color-interpolation-filters","sRGB"),it.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),nt.appendChild(it),rt.appendChild(nt),rt.setAttribute("id",i+"_svg"),featureSupport.svgLumaHidden&&(rt.style.display="none"),rt}function et(){_||(j=_e(),document.body.appendChild(j),_=createTag("canvas"),$=_.getContext("2d"),$.filter="url(#"+i+")",$.fillStyle="rgba(0,0,0,0)",$.fillRect(0,0,1,1))}function tt(rt){return _||et(),_.width=rt.width,_.height=rt.height,$.filter="url(#"+i+")",_}return{load:et,get:tt}};function createCanvas(o,i){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(o,i);var _=createTag("canvas");return _.width=o,_.height=i,_}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(o){var i,_=o.data.ef?o.data.ef.length:0;this.filters=[];var $;for(i=0;i<_;i+=1){$=null;var j=o.data.ef[i].ty;if(registeredEffects[j]){var _e=registeredEffects[j].effect;$=new _e(o.effectsManager.effectElements[i],o)}$&&this.filters.push($)}this.filters.length&&o.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(o){var i,_=this.filters.length;for(i=0;i<_;i+=1)this.filters[i].renderFrame(o)},CVEffects.prototype.getEffects=function(o){var i,_=this.filters.length,$=[];for(i=0;i<_;i+=1)this.filters[i].type===o&&$.push(this.filters[i]);return $};function registerEffect(o,i){registeredEffects[o]={effect:i}}function CVMaskElement(o,i){this.data=o,this.element=i,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var _,$=this.masksProperties.length,j=!1;for(_=0;_<$;_+=1)this.masksProperties[_].mode!=="n"&&(j=!0),this.viewData[_]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[_],3);this.hasMasks=j,j&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var o=this.element.finalTransform.mat,i=this.element.canvasContext,_,$=this.masksProperties.length,j,_e,et;for(i.beginPath(),_=0;_<$;_+=1)if(this.masksProperties[_].mode!=="n"){this.masksProperties[_].inv&&(i.moveTo(0,0),i.lineTo(this.element.globalData.compSize.w,0),i.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),i.lineTo(0,this.element.globalData.compSize.h),i.lineTo(0,0)),et=this.viewData[_].v,j=o.applyToPointArray(et.v[0][0],et.v[0][1],0),i.moveTo(j[0],j[1]);var tt,rt=et._length;for(tt=1;tt<rt;tt+=1)_e=o.applyToTriplePoints(et.o[tt-1],et.i[tt],et.v[tt]),i.bezierCurveTo(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5]);_e=o.applyToTriplePoints(et.o[tt-1],et.i[0],et.v[0]),i.bezierCurveTo(_e[0],_e[1],_e[2],_e[3],_e[4],_e[5])}this.element.globalData.renderer.save(!0),i.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var i=this.globalData.canvasContext,_=assetLoader.createCanvas(i.canvas.width,i.canvas.height);this.buffers.push(_);var $=assetLoader.createCanvas(i.canvas.width,i.canvas.height);this.buffers.push($),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var i=this.globalData;if(i.blendMode!==this.data.bm){i.blendMode=this.data.bm;var _=getBlendMode(this.data.bm);i.canvasContext.globalCompositeOperation=_}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(i){i.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var i=this.buffers[0],_=i.getContext("2d");this.clearCanvas(_),_.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var i=this.buffers[1],_=i.getContext("2d");this.clearCanvas(_),_.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var $=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if($.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var j=assetLoader.getLumaCanvas(this.canvasContext.canvas),_e=j.getContext("2d");_e.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(j,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(i,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(i){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!i)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var _=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(_),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(_),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(o,i,_,$){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var j=4;i.ty==="rc"?j=5:i.ty==="el"?j=6:i.ty==="sr"&&(j=7),this.sh=ShapePropertyFactory.getShapeProp(o,i,j,o);var _e,et=_.length,tt;for(_e=0;_e<et;_e+=1)_[_e].closed||(tt={transforms:$.addTransformSequence(_[_e].transforms),trNodes:[]},this.styledShapes.push(tt),_[_e].elements.push(tt))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(o,i,_){this.shapes=[],this.shapesData=o.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(o,i){var _={data:o,type:o.ty,preTransforms:this.transformsManager.addTransformSequence(i),transforms:[],elements:[],closed:o.hd===!0},$={};if(o.ty==="fl"||o.ty==="st"?($.c=PropertyFactory.getProp(this,o.c,1,255,this),$.c.k||(_.co="rgb("+bmFloor($.c.v[0])+","+bmFloor($.c.v[1])+","+bmFloor($.c.v[2])+")")):(o.ty==="gf"||o.ty==="gs")&&($.s=PropertyFactory.getProp(this,o.s,1,null,this),$.e=PropertyFactory.getProp(this,o.e,1,null,this),$.h=PropertyFactory.getProp(this,o.h||{k:0},0,.01,this),$.a=PropertyFactory.getProp(this,o.a||{k:0},0,degToRads,this),$.g=new GradientProperty(this,o.g,this)),$.o=PropertyFactory.getProp(this,o.o,0,.01,this),o.ty==="st"||o.ty==="gs"){if(_.lc=lineCapEnum[o.lc||2],_.lj=lineJoinEnum[o.lj||2],o.lj==1&&(_.ml=o.ml),$.w=PropertyFactory.getProp(this,o.w,0,null,this),$.w.k||(_.wi=$.w.v),o.d){var j=new DashProperty(this,o.d,"canvas",this);$.d=j,$.d.k||(_.da=$.d.dashArray,_.do=$.d.dashoffset[0])}}else _.r=o.r===2?"evenodd":"nonzero";return this.stylesList.push(_),$.style=_,$},CVShapeElement.prototype.createGroupElement=function(){var o={it:[],prevViewData:[]};return o},CVShapeElement.prototype.createTransformElement=function(o){var i={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,o.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,o,this)}};return i},CVShapeElement.prototype.createShapeElement=function(o){var i=new CVShapeData(this,o,this.stylesList,this.transformsManager);return this.shapes.push(i),this.addShapeToModifiers(i),i},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var o,i=this.itemsData.length;for(o=0;o<i;o+=1)this.prevViewData[o]=this.itemsData[o];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),i=this.dynamicProperties.length,o=0;o<i;o+=1)this.dynamicProperties[o].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(o){var i,_=this.stylesList.length;for(i=0;i<_;i+=1)this.stylesList[i].closed||this.stylesList[i].transforms.push(o)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var o,i=this.stylesList.length;for(o=0;o<i;o+=1)this.stylesList[o].closed||this.stylesList[o].transforms.pop()},CVShapeElement.prototype.closeStyles=function(o){var i,_=o.length;for(i=0;i<_;i+=1)o[i].closed=!0},CVShapeElement.prototype.searchShapes=function(o,i,_,$,j){var _e,et=o.length-1,tt,rt,nt=[],it=[],st,at,ot,lt=[].concat(j);for(_e=et;_e>=0;_e-=1){if(st=this.searchProcessedElement(o[_e]),st?i[_e]=_[st-1]:o[_e]._shouldRender=$,o[_e].ty==="fl"||o[_e].ty==="st"||o[_e].ty==="gf"||o[_e].ty==="gs")st?i[_e].style.closed=!1:i[_e]=this.createStyleElement(o[_e],lt),nt.push(i[_e].style);else if(o[_e].ty==="gr"){if(!st)i[_e]=this.createGroupElement(o[_e]);else for(rt=i[_e].it.length,tt=0;tt<rt;tt+=1)i[_e].prevViewData[tt]=i[_e].it[tt];this.searchShapes(o[_e].it,i[_e].it,i[_e].prevViewData,$,lt)}else o[_e].ty==="tr"?(st||(ot=this.createTransformElement(o[_e]),i[_e]=ot),lt.push(i[_e]),this.addTransformToStyleList(i[_e])):o[_e].ty==="sh"||o[_e].ty==="rc"||o[_e].ty==="el"||o[_e].ty==="sr"?st||(i[_e]=this.createShapeElement(o[_e])):o[_e].ty==="tm"||o[_e].ty==="rd"||o[_e].ty==="pb"||o[_e].ty==="zz"||o[_e].ty==="op"?(st?(at=i[_e],at.closed=!1):(at=ShapeModifiers.getModifier(o[_e].ty),at.init(this,o[_e]),i[_e]=at,this.shapeModifiers.push(at)),it.push(at)):o[_e].ty==="rp"&&(st?(at=i[_e],at.closed=!0):(at=ShapeModifiers.getModifier(o[_e].ty),i[_e]=at,at.init(this,o,_e,i),this.shapeModifiers.push(at),$=!1),it.push(at));this.addProcessedElement(o[_e],_e+1)}for(this.removeTransformFromStyleList(),this.closeStyles(nt),et=it.length,_e=0;_e<et;_e+=1)it[_e].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(o,i){(o._opMdf||i.op._mdf||this._isFirstFrame)&&(i.opacity=o.opacity,i.opacity*=i.op.v,i._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var o,i=this.stylesList.length,_,$,j,_e,et,tt,rt=this.globalData.renderer,nt=this.globalData.canvasContext,it,st;for(o=0;o<i;o+=1)if(st=this.stylesList[o],it=st.type,!((it==="st"||it==="gs")&&st.wi===0||!st.data._shouldRender||st.coOp===0||this.globalData.currentGlobalAlpha===0)){for(rt.save(),et=st.elements,it==="st"||it==="gs"?(rt.ctxStrokeStyle(it==="st"?st.co:st.grd),rt.ctxLineWidth(st.wi),rt.ctxLineCap(st.lc),rt.ctxLineJoin(st.lj),rt.ctxMiterLimit(st.ml||0)):rt.ctxFillStyle(it==="fl"?st.co:st.grd),rt.ctxOpacity(st.coOp),it!=="st"&&it!=="gs"&&nt.beginPath(),rt.ctxTransform(st.preTransforms.finalTransform.props),$=et.length,_=0;_<$;_+=1){for((it==="st"||it==="gs")&&(nt.beginPath(),st.da&&(nt.setLineDash(st.da),nt.lineDashOffset=st.do)),tt=et[_].trNodes,_e=tt.length,j=0;j<_e;j+=1)tt[j].t==="m"?nt.moveTo(tt[j].p[0],tt[j].p[1]):tt[j].t==="c"?nt.bezierCurveTo(tt[j].pts[0],tt[j].pts[1],tt[j].pts[2],tt[j].pts[3],tt[j].pts[4],tt[j].pts[5]):nt.closePath();(it==="st"||it==="gs")&&(rt.ctxStroke(),st.da&&nt.setLineDash(this.dashResetter))}it!=="st"&&it!=="gs"&&this.globalData.renderer.ctxFill(st.r),rt.restore()}},CVShapeElement.prototype.renderShape=function(o,i,_,$){var j,_e=i.length-1,et;for(et=o,j=_e;j>=0;j-=1)i[j].ty==="tr"?(et=_[j].transform,this.renderShapeTransform(o,et)):i[j].ty==="sh"||i[j].ty==="el"||i[j].ty==="rc"||i[j].ty==="sr"?this.renderPath(i[j],_[j]):i[j].ty==="fl"?this.renderFill(i[j],_[j],et):i[j].ty==="st"?this.renderStroke(i[j],_[j],et):i[j].ty==="gf"||i[j].ty==="gs"?this.renderGradientFill(i[j],_[j],et):i[j].ty==="gr"?this.renderShape(et,i[j].it,_[j].it):i[j].ty;$&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(o,i){if(this._isFirstFrame||i._mdf||o.transforms._mdf){var _=o.trNodes,$=i.paths,j,_e,et,tt=$._length;_.length=0;var rt=o.transforms.finalTransform;for(et=0;et<tt;et+=1){var nt=$.shapes[et];if(nt&&nt.v){for(_e=nt._length,j=1;j<_e;j+=1)j===1&&_.push({t:"m",p:rt.applyToPointArray(nt.v[0][0],nt.v[0][1],0)}),_.push({t:"c",pts:rt.applyToTriplePoints(nt.o[j-1],nt.i[j],nt.v[j])});_e===1&&_.push({t:"m",p:rt.applyToPointArray(nt.v[0][0],nt.v[0][1],0)}),nt.c&&_e&&(_.push({t:"c",pts:rt.applyToTriplePoints(nt.o[j-1],nt.i[0],nt.v[0])}),_.push({t:"z"}))}}o.trNodes=_}},CVShapeElement.prototype.renderPath=function(o,i){if(o.hd!==!0&&o._shouldRender){var _,$=i.styledShapes.length;for(_=0;_<$;_+=1)this.renderStyledShape(i.styledShapes[_],i.sh)}},CVShapeElement.prototype.renderFill=function(o,i,_){var $=i.style;(i.c._mdf||this._isFirstFrame)&&($.co="rgb("+bmFloor(i.c.v[0])+","+bmFloor(i.c.v[1])+","+bmFloor(i.c.v[2])+")"),(i.o._mdf||_._opMdf||this._isFirstFrame)&&($.coOp=i.o.v*_.opacity)},CVShapeElement.prototype.renderGradientFill=function(o,i,_){var $=i.style,j;if(!$.grd||i.g._mdf||i.s._mdf||i.e._mdf||o.t!==1&&(i.h._mdf||i.a._mdf)){var _e=this.globalData.canvasContext,et=i.s.v,tt=i.e.v;if(o.t===1)j=_e.createLinearGradient(et[0],et[1],tt[0],tt[1]);else{var rt=Math.sqrt(Math.pow(et[0]-tt[0],2)+Math.pow(et[1]-tt[1],2)),nt=Math.atan2(tt[1]-et[1],tt[0]-et[0]),it=i.h.v;it>=1?it=.99:it<=-1&&(it=-.99);var st=rt*it,at=Math.cos(nt+i.a.v)*st+et[0],ot=Math.sin(nt+i.a.v)*st+et[1];j=_e.createRadialGradient(at,ot,0,et[0],et[1],rt)}var lt,ct=o.g.p,ft=i.g.c,ut=1;for(lt=0;lt<ct;lt+=1)i.g._hasOpacity&&i.g._collapsable&&(ut=i.g.o[lt*2+1]),j.addColorStop(ft[lt*4]/100,"rgba("+ft[lt*4+1]+","+ft[lt*4+2]+","+ft[lt*4+3]+","+ut+")");$.grd=j}$.coOp=i.o.v*_.opacity},CVShapeElement.prototype.renderStroke=function(o,i,_){var $=i.style,j=i.d;j&&(j._mdf||this._isFirstFrame)&&($.da=j.dashArray,$.do=j.dashoffset[0]),(i.c._mdf||this._isFirstFrame)&&($.co="rgb("+bmFloor(i.c.v[0])+","+bmFloor(i.c.v[1])+","+bmFloor(i.c.v[2])+")"),(i.o._mdf||_._opMdf||this._isFirstFrame)&&($.coOp=i.o.v*_.opacity),(i.w._mdf||this._isFirstFrame)&&($.wi=i.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(o,i,_){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var o=this.textProperty.currentData;this.renderedLetters=createSizedArray(o.l?o.l.length:0);var i=!1;o.fc?(i=!0,this.values.fill=this.buildColor(o.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=i;var _=!1;o.sc&&(_=!0,this.values.stroke=this.buildColor(o.sc),this.values.sWidth=o.sw);var $=this.globalData.fontManager.getFontByName(o.f),j,_e,et=o.l,tt=this.mHelper;this.stroke=_,this.values.fValue=o.finalSize+"px "+this.globalData.fontManager.getFontByName(o.f).fFamily,_e=o.finalText.length;var rt,nt,it,st,at,ot,lt,ct,ft,ut,ht=this.data.singleShape,dt=o.tr*.001*o.finalSize,mt=0,pt=0,yt=!0,gt=0;for(j=0;j<_e;j+=1){rt=this.globalData.fontManager.getCharData(o.finalText[j],$.fStyle,this.globalData.fontManager.getFontByName(o.f).fFamily),nt=rt&&rt.data||{},tt.reset(),ht&&et[j].n&&(mt=-dt,pt+=o.yOffset,pt+=yt?1:0,yt=!1),at=nt.shapes?nt.shapes[0].it:[],lt=at.length,tt.scale(o.finalSize/100,o.finalSize/100),ht&&this.applyTextPropertiesToMatrix(o,tt,et[j].line,mt,pt),ft=createSizedArray(lt-1);var vt=0;for(ot=0;ot<lt;ot+=1)if(at[ot].ty==="sh"){for(st=at[ot].ks.k.i.length,ct=at[ot].ks.k,ut=[],it=1;it<st;it+=1)it===1&&ut.push(tt.applyToX(ct.v[0][0],ct.v[0][1],0),tt.applyToY(ct.v[0][0],ct.v[0][1],0)),ut.push(tt.applyToX(ct.o[it-1][0],ct.o[it-1][1],0),tt.applyToY(ct.o[it-1][0],ct.o[it-1][1],0),tt.applyToX(ct.i[it][0],ct.i[it][1],0),tt.applyToY(ct.i[it][0],ct.i[it][1],0),tt.applyToX(ct.v[it][0],ct.v[it][1],0),tt.applyToY(ct.v[it][0],ct.v[it][1],0));ut.push(tt.applyToX(ct.o[it-1][0],ct.o[it-1][1],0),tt.applyToY(ct.o[it-1][0],ct.o[it-1][1],0),tt.applyToX(ct.i[0][0],ct.i[0][1],0),tt.applyToY(ct.i[0][0],ct.i[0][1],0),tt.applyToX(ct.v[0][0],ct.v[0][1],0),tt.applyToY(ct.v[0][0],ct.v[0][1],0)),ft[vt]=ut,vt+=1}ht&&(mt+=et[j].l,mt+=dt),this.textSpans[gt]?this.textSpans[gt].elem=ft:this.textSpans[gt]={elem:ft},gt+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var o=this.canvasContext;o.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var i,_,$,j,_e,et,tt=this.textAnimator.renderedLetters,rt=this.textProperty.currentData.l;_=rt.length;var nt,it=null,st=null,at=null,ot,lt,ct=this.globalData.renderer;for(i=0;i<_;i+=1)if(!rt[i].n){if(nt=tt[i],nt&&(ct.save(),ct.ctxTransform(nt.p),ct.ctxOpacity(nt.o)),this.fill){for(nt&&nt.fc?it!==nt.fc&&(ct.ctxFillStyle(nt.fc),it=nt.fc):it!==this.values.fill&&(it=this.values.fill,ct.ctxFillStyle(this.values.fill)),ot=this.textSpans[i].elem,j=ot.length,this.globalData.canvasContext.beginPath(),$=0;$<j;$+=1)for(lt=ot[$],et=lt.length,this.globalData.canvasContext.moveTo(lt[0],lt[1]),_e=2;_e<et;_e+=6)this.globalData.canvasContext.bezierCurveTo(lt[_e],lt[_e+1],lt[_e+2],lt[_e+3],lt[_e+4],lt[_e+5]);this.globalData.canvasContext.closePath(),ct.ctxFill()}if(this.stroke){for(nt&&nt.sw?at!==nt.sw&&(at=nt.sw,ct.ctxLineWidth(nt.sw)):at!==this.values.sWidth&&(at=this.values.sWidth,ct.ctxLineWidth(this.values.sWidth)),nt&&nt.sc?st!==nt.sc&&(st=nt.sc,ct.ctxStrokeStyle(nt.sc)):st!==this.values.stroke&&(st=this.values.stroke,ct.ctxStrokeStyle(this.values.stroke)),ot=this.textSpans[i].elem,j=ot.length,this.globalData.canvasContext.beginPath(),$=0;$<j;$+=1)for(lt=ot[$],et=lt.length,this.globalData.canvasContext.moveTo(lt[0],lt[1]),_e=2;_e<et;_e+=6)this.globalData.canvasContext.bezierCurveTo(lt[_e],lt[_e+1],lt[_e+2],lt[_e+3],lt[_e+4],lt[_e+5]);this.globalData.canvasContext.closePath(),ct.ctxStroke()}nt&&this.globalData.renderer.restore()}};function CVImageElement(o,i,_){this.assetData=i.getAssetData(o.refId),this.img=i.imageLoader.getAsset(this.assetData),this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var o=createTag("canvas");o.width=this.assetData.w,o.height=this.assetData.h;var i=o.getContext("2d"),_=this.img.width,$=this.img.height,j=_/$,_e=this.assetData.w/this.assetData.h,et,tt,rt=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;j>_e&&rt==="xMidYMid slice"||j<_e&&rt!=="xMidYMid slice"?(tt=$,et=tt*_e):(et=_,tt=et/_e),i.drawImage(this.img,(_-et)/2,($-tt)/2,et,tt,0,0,this.assetData.w,this.assetData.h),this.img=o}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(o,i,_){this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(o){return new CVShapeElement(o,this.globalData,this)},CanvasRendererBase.prototype.createText=function(o){return new CVTextElement(o,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(o){return new CVImageElement(o,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(o){return new CVSolidElement(o,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(o){o[0]===1&&o[1]===0&&o[4]===0&&o[5]===1&&o[12]===0&&o[13]===0||this.canvasContext.transform(o[0],o[1],o[4],o[5],o[12],o[13])},CanvasRendererBase.prototype.ctxOpacity=function(o){this.canvasContext.globalAlpha*=o<0?0:o},CanvasRendererBase.prototype.ctxFillStyle=function(o){this.canvasContext.fillStyle=o},CanvasRendererBase.prototype.ctxStrokeStyle=function(o){this.canvasContext.strokeStyle=o},CanvasRendererBase.prototype.ctxLineWidth=function(o){this.canvasContext.lineWidth=o},CanvasRendererBase.prototype.ctxLineCap=function(o){this.canvasContext.lineCap=o},CanvasRendererBase.prototype.ctxLineJoin=function(o){this.canvasContext.lineJoin=o},CanvasRendererBase.prototype.ctxMiterLimit=function(o){this.canvasContext.miterLimit=o},CanvasRendererBase.prototype.ctxFill=function(o){this.canvasContext.fill(o)},CanvasRendererBase.prototype.ctxFillRect=function(o,i,_,$){this.canvasContext.fillRect(o,i,_,$)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(o){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}o&&(this.globalData.blendMode="source-over"),this.contextData.restore(o)},CanvasRendererBase.prototype.configAnimation=function(o){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var i=this.animationItem.container.style;i.width="100%",i.height="100%";var _="0px 0px 0px";i.transformOrigin=_,i.mozTransformOrigin=_,i.webkitTransformOrigin=_,i["-webkit-transform"]=_,i.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=o,this.layers=o.layers,this.transformCanvas={w:o.w,h:o.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(o,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(o.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(o,i){this.reset();var _,$;o?(_=o,$=i,this.canvasContext.canvas.width=_,this.canvasContext.canvas.height=$):(this.animationItem.wrapper&&this.animationItem.container?(_=this.animationItem.wrapper.offsetWidth,$=this.animationItem.wrapper.offsetHeight):(_=this.canvasContext.canvas.width,$=this.canvasContext.canvas.height),this.canvasContext.canvas.width=_*this.renderConfig.dpr,this.canvasContext.canvas.height=$*this.renderConfig.dpr);var j,_e;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var et=this.renderConfig.preserveAspectRatio.split(" "),tt=et[1]||"meet",rt=et[0]||"xMidYMid",nt=rt.substr(0,4),it=rt.substr(4);j=_/$,_e=this.transformCanvas.w/this.transformCanvas.h,_e>j&&tt==="meet"||_e<j&&tt==="slice"?(this.transformCanvas.sx=_/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=_/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=$/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=$/(this.transformCanvas.h/this.renderConfig.dpr)),nt==="xMid"&&(_e<j&&tt==="meet"||_e>j&&tt==="slice")?this.transformCanvas.tx=(_-this.transformCanvas.w*($/this.transformCanvas.h))/2*this.renderConfig.dpr:nt==="xMax"&&(_e<j&&tt==="meet"||_e>j&&tt==="slice")?this.transformCanvas.tx=(_-this.transformCanvas.w*($/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,it==="YMid"&&(_e>j&&tt==="meet"||_e<j&&tt==="slice")?this.transformCanvas.ty=($-this.transformCanvas.h*(_/this.transformCanvas.w))/2*this.renderConfig.dpr:it==="YMax"&&(_e>j&&tt==="meet"||_e<j&&tt==="slice")?this.transformCanvas.ty=($-this.transformCanvas.h*(_/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=_/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=$/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var o,i=this.layers?this.layers.length:0;for(o=i-1;o>=0;o-=1)this.elements[o]&&this.elements[o].destroy&&this.elements[o].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(o,i){if(!(this.renderedFrame===o&&this.renderConfig.clearCanvas===!0&&!i||this.destroyed||o===-1)){this.renderedFrame=o,this.globalData.frameNum=o-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||i,this.globalData.projectInterface.currentFrame=o;var _,$=this.layers.length;for(this.completeLayers||this.checkLayers(o),_=$-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].prepareFrame(o-this.layers[_].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),_=$-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(o){var i=this.elements;if(!(i[o]||this.layers[o].ty===99)){var _=this.createItem(this.layers[o],this,this.globalData);i[o]=_,_.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var o=this.pendingElements.pop();o.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var o,i=15;for(o=0;o<i;o+=1){var _=new CanvasContext;this.stack[o]=_}this._length=i,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var o=this._length*2,i=0;for(i=this._length;i<o;i+=1)this.stack[i]=new CanvasContext;this._length=o},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(o){this.cArrPos-=1;var i=this.stack[this.cArrPos],_=i.transform,$,j=this.cTr.props;for($=0;$<16;$+=1)j[$]=_[$];if(o){this.nativeContext.restore();var _e=this.stack[this.cArrPos+1];this.appliedFillStyle=_e.fillStyle,this.appliedStrokeStyle=_e.strokeStyle,this.appliedLineWidth=_e.lineWidth,this.appliedLineCap=_e.lineCap,this.appliedLineJoin=_e.lineJoin,this.appliedMiterLimit=_e.miterLimit}this.nativeContext.setTransform(_[0],_[1],_[4],_[5],_[12],_[13]),(o||i.opacity!==-1&&this.currentOpacity!==i.opacity)&&(this.nativeContext.globalAlpha=i.opacity,this.currentOpacity=i.opacity),this.currentFillStyle=i.fillStyle,this.currentStrokeStyle=i.strokeStyle,this.currentLineWidth=i.lineWidth,this.currentLineCap=i.lineCap,this.currentLineJoin=i.lineJoin,this.currentMiterLimit=i.miterLimit},CVContextData.prototype.save=function(o){o&&this.nativeContext.save();var i=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var _=this.stack[this.cArrPos],$;for($=0;$<16;$+=1)_.transform[$]=i[$];this.cArrPos+=1;var j=this.stack[this.cArrPos];j.opacity=_.opacity,j.fillStyle=_.fillStyle,j.strokeStyle=_.strokeStyle,j.lineWidth=_.lineWidth,j.lineCap=_.lineCap,j.lineJoin=_.lineJoin,j.miterLimit=_.miterLimit},CVContextData.prototype.setOpacity=function(o){this.stack[this.cArrPos].opacity=o},CVContextData.prototype.setContext=function(o){this.nativeContext=o},CVContextData.prototype.fillStyle=function(o){this.stack[this.cArrPos].fillStyle!==o&&(this.currentFillStyle=o,this.stack[this.cArrPos].fillStyle=o)},CVContextData.prototype.strokeStyle=function(o){this.stack[this.cArrPos].strokeStyle!==o&&(this.currentStrokeStyle=o,this.stack[this.cArrPos].strokeStyle=o)},CVContextData.prototype.lineWidth=function(o){this.stack[this.cArrPos].lineWidth!==o&&(this.currentLineWidth=o,this.stack[this.cArrPos].lineWidth=o)},CVContextData.prototype.lineCap=function(o){this.stack[this.cArrPos].lineCap!==o&&(this.currentLineCap=o,this.stack[this.cArrPos].lineCap=o)},CVContextData.prototype.lineJoin=function(o){this.stack[this.cArrPos].lineJoin!==o&&(this.currentLineJoin=o,this.stack[this.cArrPos].lineJoin=o)},CVContextData.prototype.miterLimit=function(o){this.stack[this.cArrPos].miterLimit!==o&&(this.currentMiterLimit=o,this.stack[this.cArrPos].miterLimit=o)},CVContextData.prototype.transform=function(o){this.transformMat.cloneFromProps(o);var i=this.cTr;this.transformMat.multiply(i),i.cloneFromProps(this.transformMat.props);var _=i.props;this.nativeContext.setTransform(_[0],_[1],_[4],_[5],_[12],_[13])},CVContextData.prototype.opacity=function(o){var i=this.stack[this.cArrPos].opacity;i*=o<0?0:o,this.stack[this.cArrPos].opacity!==i&&(this.currentOpacity!==o&&(this.nativeContext.globalAlpha=o,this.currentOpacity=o),this.stack[this.cArrPos].opacity=i)},CVContextData.prototype.fill=function(o){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(o)},CVContextData.prototype.fillRect=function(o,i,_,$){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(o,i,_,$)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(o,i,_){this.completeLayers=!1,this.layers=o.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(o,i,_),this.tm=o.tm?PropertyFactory.getProp(this,o.tm,0,i.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var o=this.canvasContext;o.beginPath(),o.moveTo(0,0),o.lineTo(this.data.w,0),o.lineTo(this.data.w,this.data.h),o.lineTo(0,this.data.h),o.lineTo(0,0),o.clip();var i,_=this.layers.length;for(i=_-1;i>=0;i-=1)(this.completeLayers||this.elements[i])&&this.elements[i].renderFrame()},CVCompElement.prototype.destroy=function(){var o,i=this.layers.length;for(o=i-1;o>=0;o-=1)this.elements[o]&&this.elements[o].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(o){return new CVCompElement(o,this.globalData,this)};function CanvasRenderer(o,i){this.animationItem=o,this.renderConfig={clearCanvas:i&&i.clearCanvas!==void 0?i.clearCanvas:!0,context:i&&i.context||null,progressiveLoad:i&&i.progressiveLoad||!1,preserveAspectRatio:i&&i.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:i&&i.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:i&&i.contentVisibility||"visible",className:i&&i.className||"",id:i&&i.id||"",runExpressions:!i||i.runExpressions===void 0||i.runExpressions},this.renderConfig.dpr=i&&i.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=i&&i.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(o){return new CVCompElement(o,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var i=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var _=this.finalTransform.mat.toCSS();i.transform=_,i.webkitTransform=_}this.finalTransform._opMdf&&(i.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(o,i,_){this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var o;this.data.hasMask?(o=createNS("rect"),o.setAttribute("width",this.data.sw),o.setAttribute("height",this.data.sh),o.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(o=createTag("div"),o.style.width=this.data.sw+"px",o.style.height=this.data.sh+"px",o.style.backgroundColor=this.data.sc),this.layerElement.appendChild(o)};function HShapeElement(o,i,_){this.shapes=[],this.shapesData=o.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(o,i,_),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var o;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),o=this.svgElement;else{o=createNS("svg");var i=this.comp.data?this.comp.data:this.globalData.compSize;o.setAttribute("width",i.w),o.setAttribute("height",i.h),o.appendChild(this.shapesContainer),this.layerElement.appendChild(o)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=o},HShapeElement.prototype.getTransformedPoint=function(o,i){var _,$=o.length;for(_=0;_<$;_+=1)i=o[_].mProps.v.applyToPointArray(i[0],i[1],0);return i},HShapeElement.prototype.calculateShapeBoundingBox=function(o,i){var _=o.sh.v,$=o.transformers,j,_e=_._length,et,tt,rt,nt;if(!(_e<=1)){for(j=0;j<_e-1;j+=1)et=this.getTransformedPoint($,_.v[j]),tt=this.getTransformedPoint($,_.o[j]),rt=this.getTransformedPoint($,_.i[j+1]),nt=this.getTransformedPoint($,_.v[j+1]),this.checkBounds(et,tt,rt,nt,i);_.c&&(et=this.getTransformedPoint($,_.v[j]),tt=this.getTransformedPoint($,_.o[j]),rt=this.getTransformedPoint($,_.i[0]),nt=this.getTransformedPoint($,_.v[0]),this.checkBounds(et,tt,rt,nt,i))}},HShapeElement.prototype.checkBounds=function(o,i,_,$,j){this.getBoundsOfCurve(o,i,_,$);var _e=this.shapeBoundingBox;j.x=bmMin(_e.left,j.x),j.xMax=bmMax(_e.right,j.xMax),j.y=bmMin(_e.top,j.y),j.yMax=bmMax(_e.bottom,j.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(o,i,_,$){for(var j=[[o[0],$[0]],[o[1],$[1]]],_e,et,tt,rt,nt,it,st,at=0;at<2;++at)et=6*o[at]-12*i[at]+6*_[at],_e=-3*o[at]+9*i[at]-9*_[at]+3*$[at],tt=3*i[at]-3*o[at],et|=0,_e|=0,tt|=0,_e===0&&et===0||(_e===0?(rt=-tt/et,rt>0&&rt<1&&j[at].push(this.calculateF(rt,o,i,_,$,at))):(nt=et*et-4*tt*_e,nt>=0&&(it=(-et+bmSqrt(nt))/(2*_e),it>0&&it<1&&j[at].push(this.calculateF(it,o,i,_,$,at)),st=(-et-bmSqrt(nt))/(2*_e),st>0&&st<1&&j[at].push(this.calculateF(st,o,i,_,$,at)))));this.shapeBoundingBox.left=bmMin.apply(null,j[0]),this.shapeBoundingBox.top=bmMin.apply(null,j[1]),this.shapeBoundingBox.right=bmMax.apply(null,j[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,j[1])},HShapeElement.prototype.calculateF=function(o,i,_,$,j,_e){return bmPow(1-o,3)*i[_e]+3*bmPow(1-o,2)*o*_[_e]+3*(1-o)*bmPow(o,2)*$[_e]+bmPow(o,3)*j[_e]},HShapeElement.prototype.calculateBoundingBox=function(o,i){var _,$=o.length;for(_=0;_<$;_+=1)o[_]&&o[_].sh?this.calculateShapeBoundingBox(o[_],i):o[_]&&o[_].it?this.calculateBoundingBox(o[_].it,i):o[_]&&o[_].style&&o[_].w&&this.expandStrokeBoundingBox(o[_].w,i)},HShapeElement.prototype.expandStrokeBoundingBox=function(o,i){var _=0;if(o.keyframes){for(var $=0;$<o.keyframes.length;$+=1){var j=o.keyframes[$].s;j>_&&(_=j)}_*=o.mult}else _=o.v*o.mult;i.x-=_,i.xMax+=_,i.y-=_,i.yMax+=_},HShapeElement.prototype.currentBoxContains=function(o){return this.currentBBox.x<=o.x&&this.currentBBox.y<=o.y&&this.currentBBox.width+this.currentBBox.x>=o.x+o.width&&this.currentBBox.height+this.currentBBox.y>=o.y+o.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var o=this.tempBoundingBox,i=999999;if(o.x=i,o.xMax=-i,o.y=i,o.yMax=-i,this.calculateBoundingBox(this.itemsData,o),o.width=o.xMax<o.x?0:o.xMax-o.x,o.height=o.yMax<o.y?0:o.yMax-o.y,this.currentBoxContains(o))return;var _=!1;if(this.currentBBox.w!==o.width&&(this.currentBBox.w=o.width,this.shapeCont.setAttribute("width",o.width),_=!0),this.currentBBox.h!==o.height&&(this.currentBBox.h=o.height,this.shapeCont.setAttribute("height",o.height),_=!0),_||this.currentBBox.x!==o.x||this.currentBBox.y!==o.y){this.currentBBox.w=o.width,this.currentBBox.h=o.height,this.currentBBox.x=o.x,this.currentBBox.y=o.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var $=this.shapeCont.style,j="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";$.transform=j,$.webkitTransform=j}}};function HTextElement(o,i,_){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var o=createNS("g");this.maskedElement.appendChild(o),this.innerElem=o}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var o=this.textProperty.currentData;this.renderedLetters=createSizedArray(o.l?o.l.length:0);var i=this.innerElem.style,_=o.fc?this.buildColor(o.fc):"rgba(0,0,0,0)";i.fill=_,i.color=_,o.sc&&(i.stroke=this.buildColor(o.sc),i.strokeWidth=o.sw+"px");var $=this.globalData.fontManager.getFontByName(o.f);if(!this.globalData.fontManager.chars)if(i.fontSize=o.finalSize+"px",i.lineHeight=o.finalSize+"px",$.fClass)this.innerElem.className=$.fClass;else{i.fontFamily=$.fFamily;var j=o.fWeight,_e=o.fStyle;i.fontStyle=_e,i.fontWeight=j}var et,tt,rt=o.l;tt=rt.length;var nt,it,st,at=this.mHelper,ot,lt="",ct=0;for(et=0;et<tt;et+=1){if(this.globalData.fontManager.chars?(this.textPaths[ct]?nt=this.textPaths[ct]:(nt=createNS("path"),nt.setAttribute("stroke-linecap",lineCapEnum[1]),nt.setAttribute("stroke-linejoin",lineJoinEnum[2]),nt.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[ct]?(it=this.textSpans[ct],st=it.children[0]):(it=createTag("div"),it.style.lineHeight=0,st=createNS("svg"),st.appendChild(nt),styleDiv(it)))):this.isMasked?nt=this.textPaths[ct]?this.textPaths[ct]:createNS("text"):this.textSpans[ct]?(it=this.textSpans[ct],nt=this.textPaths[ct]):(it=createTag("span"),styleDiv(it),nt=createTag("span"),styleDiv(nt),it.appendChild(nt)),this.globalData.fontManager.chars){var ft=this.globalData.fontManager.getCharData(o.finalText[et],$.fStyle,this.globalData.fontManager.getFontByName(o.f).fFamily),ut;if(ft?ut=ft.data:ut=null,at.reset(),ut&&ut.shapes&&ut.shapes.length&&(ot=ut.shapes[0].it,at.scale(o.finalSize/100,o.finalSize/100),lt=this.createPathShape(at,ot),nt.setAttribute("d",lt)),this.isMasked)this.innerElem.appendChild(nt);else{if(this.innerElem.appendChild(it),ut&&ut.shapes){document.body.appendChild(st);var ht=st.getBBox();st.setAttribute("width",ht.width+2),st.setAttribute("height",ht.height+2),st.setAttribute("viewBox",ht.x-1+" "+(ht.y-1)+" "+(ht.width+2)+" "+(ht.height+2));var dt=st.style,mt="translate("+(ht.x-1)+"px,"+(ht.y-1)+"px)";dt.transform=mt,dt.webkitTransform=mt,rt[et].yOffset=ht.y-1}else st.setAttribute("width",1),st.setAttribute("height",1);it.appendChild(st)}}else if(nt.textContent=rt[et].val,nt.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(nt);else{this.innerElem.appendChild(it);var pt=nt.style,yt="translate3d(0,"+-o.finalSize/1.2+"px,0)";pt.transform=yt,pt.webkitTransform=yt}this.isMasked?this.textSpans[ct]=nt:this.textSpans[ct]=it,this.textSpans[ct].style.display="block",this.textPaths[ct]=nt,ct+=1}for(;ct<this.textSpans.length;)this.textSpans[ct].style.display="none",ct+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var o;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),o=this.svgElement.style;var i="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";o.transform=i,o.webkitTransform=i}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var _,$,j=0,_e=this.textAnimator.renderedLetters,et=this.textProperty.currentData.l;$=et.length;var tt,rt,nt;for(_=0;_<$;_+=1)et[_].n?j+=1:(rt=this.textSpans[_],nt=this.textPaths[_],tt=_e[j],j+=1,tt._mdf.m&&(this.isMasked?rt.setAttribute("transform",tt.m):(rt.style.webkitTransform=tt.m,rt.style.transform=tt.m)),rt.style.opacity=tt.o,tt.sw&&tt._mdf.sw&&nt.setAttribute("stroke-width",tt.sw),tt.sc&&tt._mdf.sc&&nt.setAttribute("stroke",tt.sc),tt.fc&&tt._mdf.fc&&(nt.setAttribute("fill",tt.fc),nt.style.color=tt.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var it=this.innerElem.getBBox();this.currentBBox.w!==it.width&&(this.currentBBox.w=it.width,this.svgElement.setAttribute("width",it.width)),this.currentBBox.h!==it.height&&(this.currentBBox.h=it.height,this.svgElement.setAttribute("height",it.height));var st=1;if(this.currentBBox.w!==it.width+st*2||this.currentBBox.h!==it.height+st*2||this.currentBBox.x!==it.x-st||this.currentBBox.y!==it.y-st){this.currentBBox.w=it.width+st*2,this.currentBBox.h=it.height+st*2,this.currentBBox.x=it.x-st,this.currentBBox.y=it.y-st,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),o=this.svgElement.style;var at="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";o.transform=at,o.webkitTransform=at}}}};function HCameraElement(o,i,_){this.initFrame(),this.initBaseData(o,i,_),this.initHierarchy();var $=PropertyFactory.getProp;if(this.pe=$(this,o.pe,0,0,this),o.ks.p.s?(this.px=$(this,o.ks.p.x,1,0,this),this.py=$(this,o.ks.p.y,1,0,this),this.pz=$(this,o.ks.p.z,1,0,this)):this.p=$(this,o.ks.p,1,0,this),o.ks.a&&(this.a=$(this,o.ks.a,1,0,this)),o.ks.or.k.length&&o.ks.or.k[0].to){var j,_e=o.ks.or.k.length;for(j=0;j<_e;j+=1)o.ks.or.k[j].to=null,o.ks.or.k[j].ti=null}this.or=$(this,o.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=$(this,o.ks.rx,0,degToRads,this),this.ry=$(this,o.ks.ry,0,degToRads,this),this.rz=$(this,o.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var o,i=this.comp.threeDElements.length,_,$,j;for(o=0;o<i;o+=1)if(_=this.comp.threeDElements[o],_.type==="3d"){$=_.perspectiveElem.style,j=_.container.style;var _e=this.pe.v+"px",et="0px 0px 0px",tt="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";$.perspective=_e,$.webkitPerspective=_e,j.transformOrigin=et,j.mozTransformOrigin=et,j.webkitTransformOrigin=et,$.transform=tt,$.webkitTransform=tt}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var o=this._isFirstFrame,i,_;if(this.hierarchy)for(_=this.hierarchy.length,i=0;i<_;i+=1)o=this.hierarchy[i].finalTransform.mProp._mdf||o;if(o||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(_=this.hierarchy.length-1,i=_;i>=0;i-=1){var $=this.hierarchy[i].finalTransform.mProp;this.mat.translate(-$.p.v[0],-$.p.v[1],$.p.v[2]),this.mat.rotateX(-$.or.v[0]).rotateY(-$.or.v[1]).rotateZ($.or.v[2]),this.mat.rotateX(-$.rx.v).rotateY(-$.ry.v).rotateZ($.rz.v),this.mat.scale(1/$.s.v[0],1/$.s.v[1],1/$.s.v[2]),this.mat.translate($.a.v[0],$.a.v[1],$.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var j;this.p?j=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:j=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var _e=Math.sqrt(Math.pow(j[0],2)+Math.pow(j[1],2)+Math.pow(j[2],2)),et=[j[0]/_e,j[1]/_e,j[2]/_e],tt=Math.sqrt(et[2]*et[2]+et[0]*et[0]),rt=Math.atan2(et[1],tt),nt=Math.atan2(et[0],-et[2]);this.mat.rotateY(nt).rotateX(-rt)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var it=!this._prevMat.equals(this.mat);if((it||this.pe._mdf)&&this.comp.threeDElements){_=this.comp.threeDElements.length;var st,at,ot;for(i=0;i<_;i+=1)if(st=this.comp.threeDElements[i],st.type==="3d"){if(it){var lt=this.mat.toCSS();ot=st.container.style,ot.transform=lt,ot.webkitTransform=lt}this.pe._mdf&&(at=st.perspectiveElem.style,at.perspective=this.pe.v+"px",at.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(o){this.prepareProperties(o,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(o,i,_){this.assetData=i.getAssetData(o.refId),this.initElement(o,i,_)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var o=this.globalData.getAssetsPath(this.assetData),i=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",o),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(i),i.crossOrigin="anonymous",i.src=o,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(o,i){this.animationItem=o,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:i&&i.className||"",imagePreserveAspectRatio:i&&i.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(i&&i.hideOnTransparent===!1),filterSize:{width:i&&i.filterSize&&i.filterSize.width||"400%",height:i&&i.filterSize&&i.filterSize.height||"400%",x:i&&i.filterSize&&i.filterSize.x||"-100%",y:i&&i.filterSize&&i.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var o=this.pendingElements.pop();o.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(o,i){var _=o.getBaseElement();if(_){var $=this.layers[i];if(!$.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(_,i);else{for(var j=0,_e,et,tt;j<i;)this.elements[j]&&this.elements[j]!==!0&&this.elements[j].getBaseElement&&(et=this.elements[j],tt=this.layers[j].ddd?this.getThreeDContainerByPos(j):et.getBaseElement(),_e=tt||_e),j+=1;_e?(!$.ddd||!this.supports3d)&&this.layerElement.insertBefore(_,_e):(!$.ddd||!this.supports3d)&&this.layerElement.appendChild(_)}else this.addTo3dContainer(_,i)}},HybridRendererBase.prototype.createShape=function(o){return this.supports3d?new HShapeElement(o,this.globalData,this):new SVGShapeElement(o,this.globalData,this)},HybridRendererBase.prototype.createText=function(o){return this.supports3d?new HTextElement(o,this.globalData,this):new SVGTextLottieElement(o,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(o){return this.camera=new HCameraElement(o,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(o){return this.supports3d?new HImageElement(o,this.globalData,this):new IImageElement(o,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(o){return this.supports3d?new HSolidElement(o,this.globalData,this):new ISolidElement(o,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(o){for(var i=0,_=this.threeDElements.length;i<_;){if(this.threeDElements[i].startPos<=o&&this.threeDElements[i].endPos>=o)return this.threeDElements[i].perspectiveElem;i+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(o,i){var _=createTag("div"),$,j;styleDiv(_);var _e=createTag("div");if(styleDiv(_e),i==="3d"){$=_.style,$.width=this.globalData.compSize.w+"px",$.height=this.globalData.compSize.h+"px";var et="50% 50%";$.webkitTransformOrigin=et,$.mozTransformOrigin=et,$.transformOrigin=et,j=_e.style;var tt="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";j.transform=tt,j.webkitTransform=tt}_.appendChild(_e);var rt={container:_e,perspectiveElem:_,startPos:o,endPos:o,type:i};return this.threeDElements.push(rt),rt},HybridRendererBase.prototype.build3dContainers=function(){var o,i=this.layers.length,_,$="";for(o=0;o<i;o+=1)this.layers[o].ddd&&this.layers[o].ty!==3?($!=="3d"&&($="3d",_=this.createThreeDContainer(o,"3d")),_.endPos=Math.max(_.endPos,o)):($!=="2d"&&($="2d",_=this.createThreeDContainer(o,"2d")),_.endPos=Math.max(_.endPos,o));for(i=this.threeDElements.length,o=i-1;o>=0;o-=1)this.resizerElem.appendChild(this.threeDElements[o].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(o,i){for(var _=0,$=this.threeDElements.length;_<$;){if(i<=this.threeDElements[_].endPos){for(var j=this.threeDElements[_].startPos,_e;j<i;)this.elements[j]&&this.elements[j].getBaseElement&&(_e=this.elements[j].getBaseElement()),j+=1;_e?this.threeDElements[_].container.insertBefore(o,_e):this.threeDElements[_].container.appendChild(o);break}_+=1}},HybridRendererBase.prototype.configAnimation=function(o){var i=createTag("div"),_=this.animationItem.wrapper,$=i.style;$.width=o.w+"px",$.height=o.h+"px",this.resizerElem=i,styleDiv(i),$.transformStyle="flat",$.mozTransformStyle="flat",$.webkitTransformStyle="flat",this.renderConfig.className&&i.setAttribute("class",this.renderConfig.className),_.appendChild(i),$.overflow="hidden";var j=createNS("svg");j.setAttribute("width","1"),j.setAttribute("height","1"),styleDiv(j),this.resizerElem.appendChild(j);var _e=createNS("defs");j.appendChild(_e),this.data=o,this.setupGlobalData(o,j),this.globalData.defs=_e,this.layers=o.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var o,i=this.layers?this.layers.length:0;for(o=0;o<i;o+=1)this.elements[o]&&this.elements[o].destroy&&this.elements[o].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var o=this.animationItem.wrapper.offsetWidth,i=this.animationItem.wrapper.offsetHeight,_=o/i,$=this.globalData.compSize.w/this.globalData.compSize.h,j,_e,et,tt;$>_?(j=o/this.globalData.compSize.w,_e=o/this.globalData.compSize.w,et=0,tt=(i-this.globalData.compSize.h*(o/this.globalData.compSize.w))/2):(j=i/this.globalData.compSize.h,_e=i/this.globalData.compSize.h,et=(o-this.globalData.compSize.w*(i/this.globalData.compSize.h))/2,tt=0);var rt=this.resizerElem.style;rt.webkitTransform="matrix3d("+j+",0,0,0,0,"+_e+",0,0,0,0,1,0,"+et+","+tt+",0,1)",rt.transform=rt.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var o=this.globalData.compSize.w,i=this.globalData.compSize.h,_,$=this.threeDElements.length;for(_=0;_<$;_+=1){var j=this.threeDElements[_].perspectiveElem.style;j.webkitPerspective=Math.sqrt(Math.pow(o,2)+Math.pow(i,2))+"px",j.perspective=j.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(o){var i,_=o.length,$=createTag("div");for(i=0;i<_;i+=1)if(o[i].xt){var j=this.createComp(o[i],$,this.globalData.comp,null);j.initExpressions(),this.globalData.projectInterface.registerComposition(j)}};function HCompElement(o,i,_){this.layers=o.layers,this.supports3d=!o.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(o,i,_),this.tm=o.tm?PropertyFactory.getProp(this,o.tm,0,i.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(o,i){for(var _=0,$;_<i;)this.elements[_]&&this.elements[_].getBaseElement&&($=this.elements[_].getBaseElement()),_+=1;$?this.layerElement.insertBefore(o,$):this.layerElement.appendChild(o)},HCompElement.prototype.createComp=function(o){return this.supports3d?new HCompElement(o,this.globalData,this):new SVGCompElement(o,this.globalData,this)};function HybridRenderer(o,i){this.animationItem=o,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:i&&i.className||"",imagePreserveAspectRatio:i&&i.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(i&&i.hideOnTransparent===!1),filterSize:{width:i&&i.filterSize&&i.filterSize.width||"400%",height:i&&i.filterSize&&i.filterSize.height||"400%",x:i&&i.filterSize&&i.filterSize.x||"-100%",y:i&&i.filterSize&&i.filterSize.y||"-100%"},runExpressions:!i||i.runExpressions===void 0||i.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(o){return this.supports3d?new HCompElement(o,this.globalData,this):new SVGCompElement(o,this.globalData,this)};var CompExpressionInterface=function(){return function(o){function i(_){for(var $=0,j=o.layers.length;$<j;){if(o.layers[$].nm===_||o.layers[$].ind===_)return o.elements[$].layerInterface;$+=1}return null}return Object.defineProperty(i,"_name",{value:o.data.nm}),i.layer=i,i.pixelAspect=1,i.height=o.data.h||o.globalData.compSize.h,i.width=o.data.w||o.globalData.compSize.w,i.pixelAspect=1,i.frameDuration=1/o.globalData.frameRate,i.displayStartTime=0,i.numLayers=o.layers.length,i}}();function _typeof$2(o){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$2(o)}function seedRandom(o,i){var _=this,$=256,j=6,_e=52,et="random",tt=i.pow($,j),rt=i.pow(2,_e),nt=rt*2,it=$-1,st;function at(dt,mt,pt){var yt=[];mt=mt===!0?{entropy:!0}:mt||{};var gt=ft(ct(mt.entropy?[dt,ht(o)]:dt===null?ut():dt,3),yt),vt=new ot(yt),St=function(){for(var xt=vt.g(j),wt=tt,Ot=0;xt<rt;)xt=(xt+Ot)*$,wt*=$,Ot=vt.g(1);for(;xt>=nt;)xt/=2,wt/=2,Ot>>>=1;return(xt+Ot)/wt};return St.int32=function(){return vt.g(4)|0},St.quick=function(){return vt.g(4)/4294967296},St.double=St,ft(ht(vt.S),o),(mt.pass||pt||function(At,xt,wt,Ot){return Ot&&(Ot.S&&lt(Ot,vt),At.state=function(){return lt(vt,{})}),wt?(i[et]=At,xt):At})(St,gt,"global"in mt?mt.global:this==i,mt.state)}i["seed"+et]=at;function ot(dt){var mt,pt=dt.length,yt=this,gt=0,vt=yt.i=yt.j=0,St=yt.S=[];for(pt||(dt=[pt++]);gt<$;)St[gt]=gt++;for(gt=0;gt<$;gt++)St[gt]=St[vt=it&vt+dt[gt%pt]+(mt=St[gt])],St[vt]=mt;yt.g=function(At){for(var xt,wt=0,Ot=yt.i,Bt=yt.j,Ft=yt.S;At--;)xt=Ft[Ot=it&Ot+1],wt=wt*$+Ft[it&(Ft[Ot]=Ft[Bt=it&Bt+xt])+(Ft[Bt]=xt)];return yt.i=Ot,yt.j=Bt,wt}}function lt(dt,mt){return mt.i=dt.i,mt.j=dt.j,mt.S=dt.S.slice(),mt}function ct(dt,mt){var pt=[],yt=_typeof$2(dt),gt;if(mt&&yt=="object")for(gt in dt)try{pt.push(ct(dt[gt],mt-1))}catch{}return pt.length?pt:yt=="string"?dt:dt+"\0"}function ft(dt,mt){for(var pt=dt+"",yt,gt=0;gt<pt.length;)mt[it&gt]=it&(yt^=mt[it&gt]*19)+pt.charCodeAt(gt++);return ht(mt)}function ut(){try{var dt=new Uint8Array($);return(_.crypto||_.msCrypto).getRandomValues(dt),ht(dt)}catch{var mt=_.navigator,pt=mt&&mt.plugins;return[+new Date,_,pt,_.screen,ht(o)]}}function ht(dt){return String.fromCharCode.apply(0,dt)}ft(i.random(),o)}function initialize$2(o){seedRandom([],o)}var propTypes={SHAPE:"shape"};function _typeof$1(o){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$1(o)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(o){return o.constructor===Array||o.constructor===Float32Array}function isNumerable(o,i){return o==="number"||i instanceof Number||o==="boolean"||o==="string"}function $bm_neg(o){var i=_typeof$1(o);if(i==="number"||o instanceof Number||i==="boolean")return-o;if($bm_isInstanceOfArray(o)){var _,$=o.length,j=[];for(_=0;_<$;_+=1)j[_]=-o[_];return j}return o.propType?o.v:-o}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(o,i){var _=_typeof$1(o),$=_typeof$1(i);if(isNumerable(_,o)&&isNumerable($,i)||_==="string"||$==="string")return o+i;if($bm_isInstanceOfArray(o)&&isNumerable($,i))return o=o.slice(0),o[0]+=i,o;if(isNumerable(_,o)&&$bm_isInstanceOfArray(i))return i=i.slice(0),i[0]=o+i[0],i;if($bm_isInstanceOfArray(o)&&$bm_isInstanceOfArray(i)){for(var j=0,_e=o.length,et=i.length,tt=[];j<_e||j<et;)(typeof o[j]=="number"||o[j]instanceof Number)&&(typeof i[j]=="number"||i[j]instanceof Number)?tt[j]=o[j]+i[j]:tt[j]=i[j]===void 0?o[j]:o[j]||i[j],j+=1;return tt}return 0}var add=sum;function sub(o,i){var _=_typeof$1(o),$=_typeof$1(i);if(isNumerable(_,o)&&isNumerable($,i))return _==="string"&&(o=parseInt(o,10)),$==="string"&&(i=parseInt(i,10)),o-i;if($bm_isInstanceOfArray(o)&&isNumerable($,i))return o=o.slice(0),o[0]-=i,o;if(isNumerable(_,o)&&$bm_isInstanceOfArray(i))return i=i.slice(0),i[0]=o-i[0],i;if($bm_isInstanceOfArray(o)&&$bm_isInstanceOfArray(i)){for(var j=0,_e=o.length,et=i.length,tt=[];j<_e||j<et;)(typeof o[j]=="number"||o[j]instanceof Number)&&(typeof i[j]=="number"||i[j]instanceof Number)?tt[j]=o[j]-i[j]:tt[j]=i[j]===void 0?o[j]:o[j]||i[j],j+=1;return tt}return 0}function mul(o,i){var _=_typeof$1(o),$=_typeof$1(i),j;if(isNumerable(_,o)&&isNumerable($,i))return o*i;var _e,et;if($bm_isInstanceOfArray(o)&&isNumerable($,i)){for(et=o.length,j=createTypedArray("float32",et),_e=0;_e<et;_e+=1)j[_e]=o[_e]*i;return j}if(isNumerable(_,o)&&$bm_isInstanceOfArray(i)){for(et=i.length,j=createTypedArray("float32",et),_e=0;_e<et;_e+=1)j[_e]=o*i[_e];return j}return 0}function div(o,i){var _=_typeof$1(o),$=_typeof$1(i),j;if(isNumerable(_,o)&&isNumerable($,i))return o/i;var _e,et;if($bm_isInstanceOfArray(o)&&isNumerable($,i)){for(et=o.length,j=createTypedArray("float32",et),_e=0;_e<et;_e+=1)j[_e]=o[_e]/i;return j}if(isNumerable(_,o)&&$bm_isInstanceOfArray(i)){for(et=i.length,j=createTypedArray("float32",et),_e=0;_e<et;_e+=1)j[_e]=o/i[_e];return j}return 0}function mod(o,i){return typeof o=="string"&&(o=parseInt(o,10)),typeof i=="string"&&(i=parseInt(i,10)),o%i}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(o,i,_){if(i>_){var $=_;_=i,i=$}return Math.min(Math.max(o,i),_)}function radiansToDegrees(o){return o/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(o){return o*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(o,i){if(typeof o=="number"||o instanceof Number)return i=i||0,Math.abs(o-i);i||(i=helperLengthArray);var _,$=Math.min(o.length,i.length),j=0;for(_=0;_<$;_+=1)j+=Math.pow(i[_]-o[_],2);return Math.sqrt(j)}function normalize(o){return div(o,length(o))}function rgbToHsl(o){var i=o[0],_=o[1],$=o[2],j=Math.max(i,_,$),_e=Math.min(i,_,$),et,tt,rt=(j+_e)/2;if(j===_e)et=0,tt=0;else{var nt=j-_e;switch(tt=rt>.5?nt/(2-j-_e):nt/(j+_e),j){case i:et=(_-$)/nt+(_<$?6:0);break;case _:et=($-i)/nt+2;break;case $:et=(i-_)/nt+4;break}et/=6}return[et,tt,rt,o[3]]}function hue2rgb(o,i,_){return _<0&&(_+=1),_>1&&(_-=1),_<1/6?o+(i-o)*6*_:_<1/2?i:_<2/3?o+(i-o)*(2/3-_)*6:o}function hslToRgb(o){var i=o[0],_=o[1],$=o[2],j,_e,et;if(_===0)j=$,et=$,_e=$;else{var tt=$<.5?$*(1+_):$+_-$*_,rt=2*$-tt;j=hue2rgb(rt,tt,i+1/3),_e=hue2rgb(rt,tt,i),et=hue2rgb(rt,tt,i-1/3)}return[j,_e,et,o[3]]}function linear(o,i,_,$,j){if(($===void 0||j===void 0)&&($=i,j=_,i=0,_=1),_<i){var _e=_;_=i,i=_e}if(o<=i)return $;if(o>=_)return j;var et=_===i?0:(o-i)/(_-i);if(!$.length)return $+(j-$)*et;var tt,rt=$.length,nt=createTypedArray("float32",rt);for(tt=0;tt<rt;tt+=1)nt[tt]=$[tt]+(j[tt]-$[tt])*et;return nt}function random(o,i){if(i===void 0&&(o===void 0?(o=0,i=1):(i=o,o=void 0)),i.length){var _,$=i.length;o||(o=createTypedArray("float32",$));var j=createTypedArray("float32",$),_e=BMMath.random();for(_=0;_<$;_+=1)j[_]=o[_]+_e*(i[_]-o[_]);return j}o===void 0&&(o=0);var et=BMMath.random();return o+et*(i-o)}function createPath(o,i,_,$){var j,_e=o.length,et=shapePool.newElement();et.setPathData(!!$,_e);var tt=[0,0],rt,nt;for(j=0;j<_e;j+=1)rt=i&&i[j]?i[j]:tt,nt=_&&_[j]?_[j]:tt,et.setTripleAt(o[j][0],o[j][1],nt[0]+o[j][0],nt[1]+o[j][1],rt[0]+o[j][0],rt[1]+o[j][1],j,!0);return et}function initiateExpression(elem,data,property){function noOp(o){return o}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function o(i,_){var $,j,_e=this.pv.length?this.pv.length:1,et=createTypedArray("float32",_e);i=5;var tt=Math.floor(time*i);for($=0,j=0;$<tt;){for(j=0;j<_e;j+=1)et[j]+=-_+_*2*BMMath.random();$+=1}var rt=time*i,nt=rt-Math.floor(rt),it=createTypedArray("float32",_e);if(_e>1){for(j=0;j<_e;j+=1)it[j]=this.pv[j]+et[j]+(-_+_*2*BMMath.random())*nt;return it}return this.pv+et[0]+(-_+_*2*BMMath.random())*nt}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(o,i){return loopIn(o,i,!0)}function loopOutDuration(o,i){return loopOut(o,i,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(o,i){var _=[i[0]-o[0],i[1]-o[1],i[2]-o[2]],$=Math.atan2(_[0],Math.sqrt(_[1]*_[1]+_[2]*_[2]))/degToRads,j=-Math.atan2(_[1],_[2])/degToRads;return[j,$,0]}function easeOut(o,i,_,$,j){return applyEase(easeOutBez,o,i,_,$,j)}function easeIn(o,i,_,$,j){return applyEase(easeInBez,o,i,_,$,j)}function ease(o,i,_,$,j){return applyEase(easeInOutBez,o,i,_,$,j)}function applyEase(o,i,_,$,j,_e){j===void 0?(j=_,_e=$):i=(i-_)/($-_),i>1?i=1:i<0&&(i=0);var et=o(i);if($bm_isInstanceOfArray(j)){var tt,rt=j.length,nt=createTypedArray("float32",rt);for(tt=0;tt<rt;tt+=1)nt[tt]=(_e[tt]-j[tt])*et+j[tt];return nt}return(_e-j)*et+j}function nearestKey(o){var i,_=data.k.length,$,j;if(!data.k.length||typeof data.k[0]=="number")$=0,j=0;else if($=-1,o*=elem.comp.globalData.frameRate,o<data.k[0].t)$=1,j=data.k[0].t;else{for(i=0;i<_-1;i+=1)if(o===data.k[i].t){$=i+1,j=data.k[i].t;break}else if(o>data.k[i].t&&o<data.k[i+1].t){o-data.k[i].t>data.k[i+1].t-o?($=i+2,j=data.k[i+1].t):($=i+1,j=data.k[i].t);break}$===-1&&($=i+1,j=data.k[i].t)}var _e={};return _e.index=$,_e.time=j/elem.comp.globalData.frameRate,_e}function key(o){var i,_,$;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+o);o-=1,i={time:data.k[o].t/elem.comp.globalData.frameRate,value:[]};var j=Object.prototype.hasOwnProperty.call(data.k[o],"s")?data.k[o].s:data.k[o-1].e;for($=j.length,_=0;_<$;_+=1)i[_]=j[_],i.value[_]=j[_];return i}function framesToTime(o,i){return i||(i=elem.comp.globalData.frameRate),o/i}function timeToFrames(o,i){return!o&&o!==0&&(o=time),i||(i=elem.comp.globalData.frameRate),o*i}function seedRandom(o){BMMath.seedrandom(randSeed+o)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(o,i){return typeof value=="string"?i===void 0?value.substring(o):value.substring(o,i):""}function substr(o,i){return typeof value=="string"?i===void 0?value.substr(o):value.substr(o,i):""}function posterizeTime(o){time=o===0?0:Math.floor(time*o)/o,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(o){return value=o,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var o={};o.initExpressions=i,o.resetFrame=ExpressionManager.resetFrame;function i(_){var $=0,j=[];function _e(){$+=1}function et(){$-=1,$===0&&rt()}function tt(nt){j.indexOf(nt)===-1&&j.push(nt)}function rt(){var nt,it=j.length;for(nt=0;nt<it;nt+=1)j[nt].release();j.length=0}_.renderer.compInterface=CompExpressionInterface(_.renderer),_.renderer.globalData.projectInterface.registerComposition(_.renderer),_.renderer.globalData.pushExpression=_e,_.renderer.globalData.popExpression=et,_.renderer.globalData.registerExpressionProperty=tt}return o}(),MaskManagerInterface=function(){function o(_,$){this._mask=_,this._data=$}Object.defineProperty(o.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(o.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var i=function($){var j=createSizedArray($.viewData.length),_e,et=$.viewData.length;for(_e=0;_e<et;_e+=1)j[_e]=new o($.viewData[_e],$.masksProperties[_e]);var tt=function(nt){for(_e=0;_e<et;){if($.masksProperties[_e].nm===nt)return j[_e];_e+=1}return null};return tt};return i}(),ExpressionPropertyInterface=function(){var o={pv:0,v:0,mult:1},i={pv:[0,0,0],v:[0,0,0],mult:1};function _(et,tt,rt){Object.defineProperty(et,"velocity",{get:function(){return tt.getVelocityAtTime(tt.comp.currentFrame)}}),et.numKeys=tt.keyframes?tt.keyframes.length:0,et.key=function(nt){if(!et.numKeys)return 0;var it="";"s"in tt.keyframes[nt-1]?it=tt.keyframes[nt-1].s:"e"in tt.keyframes[nt-2]?it=tt.keyframes[nt-2].e:it=tt.keyframes[nt-2].s;var st=rt==="unidimensional"?new Number(it):Object.assign({},it);return st.time=tt.keyframes[nt-1].t/tt.elem.comp.globalData.frameRate,st.value=rt==="unidimensional"?it[0]:it,st},et.valueAtTime=tt.getValueAtTime,et.speedAtTime=tt.getSpeedAtTime,et.velocityAtTime=tt.getVelocityAtTime,et.propertyGroup=tt.propertyGroup}function $(et){(!et||!("pv"in et))&&(et=o);var tt=1/et.mult,rt=et.pv*tt,nt=new Number(rt);return nt.value=rt,_(nt,et,"unidimensional"),function(){return et.k&&et.getValue(),rt=et.v*tt,nt.value!==rt&&(nt=new Number(rt),nt.value=rt,nt[0]=rt,_(nt,et,"unidimensional")),nt}}function j(et){(!et||!("pv"in et))&&(et=i);var tt=1/et.mult,rt=et.data&&et.data.l||et.pv.length,nt=createTypedArray("float32",rt),it=createTypedArray("float32",rt);return nt.value=it,_(nt,et,"multidimensional"),function(){et.k&&et.getValue();for(var st=0;st<rt;st+=1)it[st]=et.v[st]*tt,nt[st]=it[st];return nt}}function _e(){return o}return function(et){return et?et.propType==="unidimensional"?$(et):j(et):_e}}(),TransformExpressionInterface=function(){return function(o){function i(et){switch(et){case"scale":case"Scale":case"ADBE Scale":case 6:return i.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return i.rotation;case"ADBE Rotate X":return i.xRotation;case"ADBE Rotate Y":return i.yRotation;case"position":case"Position":case"ADBE Position":case 2:return i.position;case"ADBE Position_0":return i.xPosition;case"ADBE Position_1":return i.yPosition;case"ADBE Position_2":return i.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return i.anchorPoint;case"opacity":case"Opacity":case 11:return i.opacity;default:return null}}Object.defineProperty(i,"rotation",{get:ExpressionPropertyInterface(o.r||o.rz)}),Object.defineProperty(i,"zRotation",{get:ExpressionPropertyInterface(o.rz||o.r)}),Object.defineProperty(i,"xRotation",{get:ExpressionPropertyInterface(o.rx)}),Object.defineProperty(i,"yRotation",{get:ExpressionPropertyInterface(o.ry)}),Object.defineProperty(i,"scale",{get:ExpressionPropertyInterface(o.s)});var _,$,j,_e;return o.p?_e=ExpressionPropertyInterface(o.p):(_=ExpressionPropertyInterface(o.px),$=ExpressionPropertyInterface(o.py),o.pz&&(j=ExpressionPropertyInterface(o.pz))),Object.defineProperty(i,"position",{get:function(){return o.p?_e():[_(),$(),j?j():0]}}),Object.defineProperty(i,"xPosition",{get:ExpressionPropertyInterface(o.px)}),Object.defineProperty(i,"yPosition",{get:ExpressionPropertyInterface(o.py)}),Object.defineProperty(i,"zPosition",{get:ExpressionPropertyInterface(o.pz)}),Object.defineProperty(i,"anchorPoint",{get:ExpressionPropertyInterface(o.a)}),Object.defineProperty(i,"opacity",{get:ExpressionPropertyInterface(o.o)}),Object.defineProperty(i,"skew",{get:ExpressionPropertyInterface(o.sk)}),Object.defineProperty(i,"skewAxis",{get:ExpressionPropertyInterface(o.sa)}),Object.defineProperty(i,"orientation",{get:ExpressionPropertyInterface(o.or)}),i}}(),LayerExpressionInterface=function(){function o(nt){var it=new Matrix;if(nt!==void 0){var st=this._elem.finalTransform.mProp.getValueAtTime(nt);st.clone(it)}else{var at=this._elem.finalTransform.mProp;at.applyToMatrix(it)}return it}function i(nt,it){var st=this.getMatrix(it);return st.props[12]=0,st.props[13]=0,st.props[14]=0,this.applyPoint(st,nt)}function _(nt,it){var st=this.getMatrix(it);return this.applyPoint(st,nt)}function $(nt,it){var st=this.getMatrix(it);return st.props[12]=0,st.props[13]=0,st.props[14]=0,this.invertPoint(st,nt)}function j(nt,it){var st=this.getMatrix(it);return this.invertPoint(st,nt)}function _e(nt,it){if(this._elem.hierarchy&&this._elem.hierarchy.length){var st,at=this._elem.hierarchy.length;for(st=0;st<at;st+=1)this._elem.hierarchy[st].finalTransform.mProp.applyToMatrix(nt)}return nt.applyToPointArray(it[0],it[1],it[2]||0)}function et(nt,it){if(this._elem.hierarchy&&this._elem.hierarchy.length){var st,at=this._elem.hierarchy.length;for(st=0;st<at;st+=1)this._elem.hierarchy[st].finalTransform.mProp.applyToMatrix(nt)}return nt.inversePoint(it)}function tt(nt){var it=new Matrix;if(it.reset(),this._elem.finalTransform.mProp.applyToMatrix(it),this._elem.hierarchy&&this._elem.hierarchy.length){var st,at=this._elem.hierarchy.length;for(st=0;st<at;st+=1)this._elem.hierarchy[st].finalTransform.mProp.applyToMatrix(it);return it.inversePoint(nt)}return it.inversePoint(nt)}function rt(){return[1,1,1,1]}return function(nt){var it;function st(ct){ot.mask=new MaskManagerInterface(ct,nt)}function at(ct){ot.effect=ct}function ot(ct){switch(ct){case"ADBE Root Vectors Group":case"Contents":case 2:return ot.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return it;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return ot.effect;case"ADBE Text Properties":return ot.textInterface;default:return null}}ot.getMatrix=o,ot.invertPoint=et,ot.applyPoint=_e,ot.toWorld=_,ot.toWorldVec=i,ot.fromWorld=j,ot.fromWorldVec=$,ot.toComp=_,ot.fromComp=tt,ot.sampleImage=rt,ot.sourceRectAtTime=nt.sourceRectAtTime.bind(nt),ot._elem=nt,it=TransformExpressionInterface(nt.finalTransform.mProp);var lt=getDescriptor(it,"anchorPoint");return Object.defineProperties(ot,{hasParent:{get:function(){return nt.hierarchy.length}},parent:{get:function(){return nt.hierarchy[0].layerInterface}},rotation:getDescriptor(it,"rotation"),scale:getDescriptor(it,"scale"),position:getDescriptor(it,"position"),opacity:getDescriptor(it,"opacity"),anchorPoint:lt,anchor_point:lt,transform:{get:function(){return it}},active:{get:function(){return nt.isInRange}}}),ot.startTime=nt.data.st,ot.index=nt.data.ind,ot.source=nt.data.refId,ot.height=nt.data.ty===0?nt.data.h:100,ot.width=nt.data.ty===0?nt.data.w:100,ot.inPoint=nt.data.ip/nt.comp.globalData.frameRate,ot.outPoint=nt.data.op/nt.comp.globalData.frameRate,ot._name=nt.data.nm,ot.registerMaskInterface=st,ot.registerEffectsInterface=at,ot}}(),propertyGroupFactory=function(){return function(o,i){return function(_){return _=_===void 0?1:_,_<=0?o:i(_-1)}}}(),PropertyInterface=function(){return function(o,i){var _={_name:o};function $(j){return j=j===void 0?1:j,j<=0?_:i(j-1)}return $}}(),EffectsExpressionInterface=function(){var o={createEffectsInterface:i};function i(j,_e){if(j.effectsManager){var et=[],tt=j.data.ef,rt,nt=j.effectsManager.effectElements.length;for(rt=0;rt<nt;rt+=1)et.push(_(tt[rt],j.effectsManager.effectElements[rt],_e,j));var it=j.data.ef||[],st=function(ot){for(rt=0,nt=it.length;rt<nt;){if(ot===it[rt].nm||ot===it[rt].mn||ot===it[rt].ix)return et[rt];rt+=1}return null};return Object.defineProperty(st,"numProperties",{get:function(){return it.length}}),st}return null}function _(j,_e,et,tt){function rt(ot){for(var lt=j.ef,ct=0,ft=lt.length;ct<ft;){if(ot===lt[ct].nm||ot===lt[ct].mn||ot===lt[ct].ix)return lt[ct].ty===5?it[ct]:it[ct]();ct+=1}throw new Error}var nt=propertyGroupFactory(rt,et),it=[],st,at=j.ef.length;for(st=0;st<at;st+=1)j.ef[st].ty===5?it.push(_(j.ef[st],_e.effectElements[st],_e.effectElements[st].propertyGroup,tt)):it.push($(_e.effectElements[st],j.ef[st].ty,tt,nt));return j.mn==="ADBE Color Control"&&Object.defineProperty(rt,"color",{get:function(){return it[0]()}}),Object.defineProperties(rt,{numProperties:{get:function(){return j.np}},_name:{value:j.nm},propertyGroup:{value:nt}}),rt.enabled=j.en!==0,rt.active=rt.enabled,rt}function $(j,_e,et,tt){var rt=ExpressionPropertyInterface(j.p);function nt(){return _e===10?et.comp.compInterface(j.p.v):rt()}return j.p.setGroupProperty&&j.p.setGroupProperty(PropertyInterface("",tt)),nt}return o}(),ShapePathInterface=function(){return function(i,_,$){var j=_.sh;function _e(tt){return tt==="Shape"||tt==="shape"||tt==="Path"||tt==="path"||tt==="ADBE Vector Shape"||tt===2?_e.path:null}var et=propertyGroupFactory(_e,$);return j.setGroupProperty(PropertyInterface("Path",et)),Object.defineProperties(_e,{path:{get:function(){return j.k&&j.getValue(),j}},shape:{get:function(){return j.k&&j.getValue(),j}},_name:{value:i.nm},ix:{value:i.ix},propertyIndex:{value:i.ix},mn:{value:i.mn},propertyGroup:{value:$}}),_e}}(),ShapeExpressionInterface=function(){function o(lt,ct,ft){var ut=[],ht,dt=lt?lt.length:0;for(ht=0;ht<dt;ht+=1)lt[ht].ty==="gr"?ut.push(_(lt[ht],ct[ht],ft)):lt[ht].ty==="fl"?ut.push($(lt[ht],ct[ht],ft)):lt[ht].ty==="st"?ut.push(et(lt[ht],ct[ht],ft)):lt[ht].ty==="tm"?ut.push(tt(lt[ht],ct[ht],ft)):lt[ht].ty==="tr"||(lt[ht].ty==="el"?ut.push(nt(lt[ht],ct[ht],ft)):lt[ht].ty==="sr"?ut.push(it(lt[ht],ct[ht],ft)):lt[ht].ty==="sh"?ut.push(ShapePathInterface(lt[ht],ct[ht],ft)):lt[ht].ty==="rc"?ut.push(st(lt[ht],ct[ht],ft)):lt[ht].ty==="rd"?ut.push(at(lt[ht],ct[ht],ft)):lt[ht].ty==="rp"?ut.push(ot(lt[ht],ct[ht],ft)):lt[ht].ty==="gf"?ut.push(j(lt[ht],ct[ht],ft)):ut.push(_e(lt[ht],ct[ht])));return ut}function i(lt,ct,ft){var ut,ht=function(pt){for(var yt=0,gt=ut.length;yt<gt;){if(ut[yt]._name===pt||ut[yt].mn===pt||ut[yt].propertyIndex===pt||ut[yt].ix===pt||ut[yt].ind===pt)return ut[yt];yt+=1}return typeof pt=="number"?ut[pt-1]:null};ht.propertyGroup=propertyGroupFactory(ht,ft),ut=o(lt.it,ct.it,ht.propertyGroup),ht.numProperties=ut.length;var dt=rt(lt.it[lt.it.length-1],ct.it[ct.it.length-1],ht.propertyGroup);return ht.transform=dt,ht.propertyIndex=lt.cix,ht._name=lt.nm,ht}function _(lt,ct,ft){var ut=function(pt){switch(pt){case"ADBE Vectors Group":case"Contents":case 2:return ut.content;default:return ut.transform}};ut.propertyGroup=propertyGroupFactory(ut,ft);var ht=i(lt,ct,ut.propertyGroup),dt=rt(lt.it[lt.it.length-1],ct.it[ct.it.length-1],ut.propertyGroup);return ut.content=ht,ut.transform=dt,Object.defineProperty(ut,"_name",{get:function(){return lt.nm}}),ut.numProperties=lt.np,ut.propertyIndex=lt.ix,ut.nm=lt.nm,ut.mn=lt.mn,ut}function $(lt,ct,ft){function ut(ht){return ht==="Color"||ht==="color"?ut.color:ht==="Opacity"||ht==="opacity"?ut.opacity:null}return Object.defineProperties(ut,{color:{get:ExpressionPropertyInterface(ct.c)},opacity:{get:ExpressionPropertyInterface(ct.o)},_name:{value:lt.nm},mn:{value:lt.mn}}),ct.c.setGroupProperty(PropertyInterface("Color",ft)),ct.o.setGroupProperty(PropertyInterface("Opacity",ft)),ut}function j(lt,ct,ft){function ut(ht){return ht==="Start Point"||ht==="start point"?ut.startPoint:ht==="End Point"||ht==="end point"?ut.endPoint:ht==="Opacity"||ht==="opacity"?ut.opacity:null}return Object.defineProperties(ut,{startPoint:{get:ExpressionPropertyInterface(ct.s)},endPoint:{get:ExpressionPropertyInterface(ct.e)},opacity:{get:ExpressionPropertyInterface(ct.o)},type:{get:function(){return"a"}},_name:{value:lt.nm},mn:{value:lt.mn}}),ct.s.setGroupProperty(PropertyInterface("Start Point",ft)),ct.e.setGroupProperty(PropertyInterface("End Point",ft)),ct.o.setGroupProperty(PropertyInterface("Opacity",ft)),ut}function _e(){function lt(){return null}return lt}function et(lt,ct,ft){var ut=propertyGroupFactory(gt,ft),ht=propertyGroupFactory(yt,ut);function dt(vt){Object.defineProperty(yt,lt.d[vt].nm,{get:ExpressionPropertyInterface(ct.d.dataProps[vt].p)})}var mt,pt=lt.d?lt.d.length:0,yt={};for(mt=0;mt<pt;mt+=1)dt(mt),ct.d.dataProps[mt].p.setGroupProperty(ht);function gt(vt){return vt==="Color"||vt==="color"?gt.color:vt==="Opacity"||vt==="opacity"?gt.opacity:vt==="Stroke Width"||vt==="stroke width"?gt.strokeWidth:null}return Object.defineProperties(gt,{color:{get:ExpressionPropertyInterface(ct.c)},opacity:{get:ExpressionPropertyInterface(ct.o)},strokeWidth:{get:ExpressionPropertyInterface(ct.w)},dash:{get:function(){return yt}},_name:{value:lt.nm},mn:{value:lt.mn}}),ct.c.setGroupProperty(PropertyInterface("Color",ut)),ct.o.setGroupProperty(PropertyInterface("Opacity",ut)),ct.w.setGroupProperty(PropertyInterface("Stroke Width",ut)),gt}function tt(lt,ct,ft){function ut(dt){return dt===lt.e.ix||dt==="End"||dt==="end"?ut.end:dt===lt.s.ix?ut.start:dt===lt.o.ix?ut.offset:null}var ht=propertyGroupFactory(ut,ft);return ut.propertyIndex=lt.ix,ct.s.setGroupProperty(PropertyInterface("Start",ht)),ct.e.setGroupProperty(PropertyInterface("End",ht)),ct.o.setGroupProperty(PropertyInterface("Offset",ht)),ut.propertyIndex=lt.ix,ut.propertyGroup=ft,Object.defineProperties(ut,{start:{get:ExpressionPropertyInterface(ct.s)},end:{get:ExpressionPropertyInterface(ct.e)},offset:{get:ExpressionPropertyInterface(ct.o)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}function rt(lt,ct,ft){function ut(dt){return lt.a.ix===dt||dt==="Anchor Point"?ut.anchorPoint:lt.o.ix===dt||dt==="Opacity"?ut.opacity:lt.p.ix===dt||dt==="Position"?ut.position:lt.r.ix===dt||dt==="Rotation"||dt==="ADBE Vector Rotation"?ut.rotation:lt.s.ix===dt||dt==="Scale"?ut.scale:lt.sk&&lt.sk.ix===dt||dt==="Skew"?ut.skew:lt.sa&&lt.sa.ix===dt||dt==="Skew Axis"?ut.skewAxis:null}var ht=propertyGroupFactory(ut,ft);return ct.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",ht)),ct.transform.mProps.p.setGroupProperty(PropertyInterface("Position",ht)),ct.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",ht)),ct.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",ht)),ct.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",ht)),ct.transform.mProps.sk&&(ct.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",ht)),ct.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",ht))),ct.transform.op.setGroupProperty(PropertyInterface("Opacity",ht)),Object.defineProperties(ut,{opacity:{get:ExpressionPropertyInterface(ct.transform.mProps.o)},position:{get:ExpressionPropertyInterface(ct.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(ct.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(ct.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(ct.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(ct.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(ct.transform.mProps.sa)},_name:{value:lt.nm}}),ut.ty="tr",ut.mn=lt.mn,ut.propertyGroup=ft,ut}function nt(lt,ct,ft){function ut(mt){return lt.p.ix===mt?ut.position:lt.s.ix===mt?ut.size:null}var ht=propertyGroupFactory(ut,ft);ut.propertyIndex=lt.ix;var dt=ct.sh.ty==="tm"?ct.sh.prop:ct.sh;return dt.s.setGroupProperty(PropertyInterface("Size",ht)),dt.p.setGroupProperty(PropertyInterface("Position",ht)),Object.defineProperties(ut,{size:{get:ExpressionPropertyInterface(dt.s)},position:{get:ExpressionPropertyInterface(dt.p)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}function it(lt,ct,ft){function ut(mt){return lt.p.ix===mt?ut.position:lt.r.ix===mt?ut.rotation:lt.pt.ix===mt?ut.points:lt.or.ix===mt||mt==="ADBE Vector Star Outer Radius"?ut.outerRadius:lt.os.ix===mt?ut.outerRoundness:lt.ir&&(lt.ir.ix===mt||mt==="ADBE Vector Star Inner Radius")?ut.innerRadius:lt.is&&lt.is.ix===mt?ut.innerRoundness:null}var ht=propertyGroupFactory(ut,ft),dt=ct.sh.ty==="tm"?ct.sh.prop:ct.sh;return ut.propertyIndex=lt.ix,dt.or.setGroupProperty(PropertyInterface("Outer Radius",ht)),dt.os.setGroupProperty(PropertyInterface("Outer Roundness",ht)),dt.pt.setGroupProperty(PropertyInterface("Points",ht)),dt.p.setGroupProperty(PropertyInterface("Position",ht)),dt.r.setGroupProperty(PropertyInterface("Rotation",ht)),lt.ir&&(dt.ir.setGroupProperty(PropertyInterface("Inner Radius",ht)),dt.is.setGroupProperty(PropertyInterface("Inner Roundness",ht))),Object.defineProperties(ut,{position:{get:ExpressionPropertyInterface(dt.p)},rotation:{get:ExpressionPropertyInterface(dt.r)},points:{get:ExpressionPropertyInterface(dt.pt)},outerRadius:{get:ExpressionPropertyInterface(dt.or)},outerRoundness:{get:ExpressionPropertyInterface(dt.os)},innerRadius:{get:ExpressionPropertyInterface(dt.ir)},innerRoundness:{get:ExpressionPropertyInterface(dt.is)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}function st(lt,ct,ft){function ut(mt){return lt.p.ix===mt?ut.position:lt.r.ix===mt?ut.roundness:lt.s.ix===mt||mt==="Size"||mt==="ADBE Vector Rect Size"?ut.size:null}var ht=propertyGroupFactory(ut,ft),dt=ct.sh.ty==="tm"?ct.sh.prop:ct.sh;return ut.propertyIndex=lt.ix,dt.p.setGroupProperty(PropertyInterface("Position",ht)),dt.s.setGroupProperty(PropertyInterface("Size",ht)),dt.r.setGroupProperty(PropertyInterface("Rotation",ht)),Object.defineProperties(ut,{position:{get:ExpressionPropertyInterface(dt.p)},roundness:{get:ExpressionPropertyInterface(dt.r)},size:{get:ExpressionPropertyInterface(dt.s)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}function at(lt,ct,ft){function ut(mt){return lt.r.ix===mt||mt==="Round Corners 1"?ut.radius:null}var ht=propertyGroupFactory(ut,ft),dt=ct;return ut.propertyIndex=lt.ix,dt.rd.setGroupProperty(PropertyInterface("Radius",ht)),Object.defineProperties(ut,{radius:{get:ExpressionPropertyInterface(dt.rd)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}function ot(lt,ct,ft){function ut(mt){return lt.c.ix===mt||mt==="Copies"?ut.copies:lt.o.ix===mt||mt==="Offset"?ut.offset:null}var ht=propertyGroupFactory(ut,ft),dt=ct;return ut.propertyIndex=lt.ix,dt.c.setGroupProperty(PropertyInterface("Copies",ht)),dt.o.setGroupProperty(PropertyInterface("Offset",ht)),Object.defineProperties(ut,{copies:{get:ExpressionPropertyInterface(dt.c)},offset:{get:ExpressionPropertyInterface(dt.o)},_name:{value:lt.nm}}),ut.mn=lt.mn,ut}return function(lt,ct,ft){var ut;function ht(mt){if(typeof mt=="number")return mt=mt===void 0?1:mt,mt===0?ft:ut[mt-1];for(var pt=0,yt=ut.length;pt<yt;){if(ut[pt]._name===mt)return ut[pt];pt+=1}return null}function dt(){return ft}return ht.propertyGroup=propertyGroupFactory(ht,dt),ut=o(lt,ct,ht.propertyGroup),ht.numProperties=ut.length,ht._name="Contents",ht}}(),TextExpressionInterface=function(){return function(o){var i;function _($){switch($){case"ADBE Text Document":return _.sourceText;default:return null}}return Object.defineProperty(_,"sourceText",{get:function(){o.textProperty.getValue();var j=o.textProperty.currentData.t;return(!i||j!==i.value)&&(i=new String(j),i.value=j||new String(j),Object.defineProperty(i,"style",{get:function(){return{fillColor:o.textProperty.currentData.fc}}})),i}}),_}}();function _typeof(o){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof(o)}var FootageInterface=function(){var o=function($){var j="",_e=$.getFootageData();function et(){return j="",_e=$.getFootageData(),tt}function tt(rt){if(_e[rt])return j=rt,_e=_e[rt],_typeof(_e)==="object"?tt:_e;var nt=rt.indexOf(j);if(nt!==-1){var it=parseInt(rt.substr(nt+j.length),10);return _e=_e[it],_typeof(_e)==="object"?tt:_e}return""}return et},i=function($){function j(_e){return _e==="Outline"?j.outlineInterface():null}return j._name="Outline",j.outlineInterface=o($),j};return function(_){function $(j){return j==="Data"?$.dataInterface:null}return $._name="Data",$.dataInterface=i(_),$}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(o){return interfaces[o]||null}var expressionHelpers=function(){function o(et,tt,rt){tt.x&&(rt.k=!0,rt.x=!0,rt.initiateExpression=ExpressionManager.initiateExpression,rt.effectsSequence.push(rt.initiateExpression(et,tt,rt).bind(rt)))}function i(et){return et*=this.elem.globalData.frameRate,et-=this.offsetTime,et!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<et?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(et,this._cachingAtTime),this._cachingAtTime.lastFrame=et),this._cachingAtTime.value}function _(et){var tt=-.01,rt=this.getValueAtTime(et),nt=this.getValueAtTime(et+tt),it=0;if(rt.length){var st;for(st=0;st<rt.length;st+=1)it+=Math.pow(nt[st]-rt[st],2);it=Math.sqrt(it)*100}else it=0;return it}function $(et){if(this.vel!==void 0)return this.vel;var tt=-.001,rt=this.getValueAtTime(et),nt=this.getValueAtTime(et+tt),it;if(rt.length){it=createTypedArray("float32",rt.length);var st;for(st=0;st<rt.length;st+=1)it[st]=(nt[st]-rt[st])/tt}else it=(nt-rt)/tt;return it}function j(){return this.pv}function _e(et){this.propertyGroup=et}return{searchExpressions:o,getSpeedAtTime:_,getVelocityAtTime:$,getValueAtTime:i,getStaticValueAtTime:j,setGroupProperty:_e}}();function addPropertyDecorator(){function o(at,ot,lt){if(!this.k||!this.keyframes)return this.pv;at=at?at.toLowerCase():"";var ct=this.comp.renderedFrame,ft=this.keyframes,ut=ft[ft.length-1].t;if(ct<=ut)return this.pv;var ht,dt;lt?(ot?ht=Math.abs(ut-this.elem.comp.globalData.frameRate*ot):ht=Math.max(0,ut-this.elem.data.ip),dt=ut-ht):((!ot||ot>ft.length-1)&&(ot=ft.length-1),dt=ft[ft.length-1-ot].t,ht=ut-dt);var mt,pt,yt;if(at==="pingpong"){var gt=Math.floor((ct-dt)/ht);if(gt%2!==0)return this.getValueAtTime((ht-(ct-dt)%ht+dt)/this.comp.globalData.frameRate,0)}else if(at==="offset"){var vt=this.getValueAtTime(dt/this.comp.globalData.frameRate,0),St=this.getValueAtTime(ut/this.comp.globalData.frameRate,0),At=this.getValueAtTime(((ct-dt)%ht+dt)/this.comp.globalData.frameRate,0),xt=Math.floor((ct-dt)/ht);if(this.pv.length){for(yt=new Array(vt.length),pt=yt.length,mt=0;mt<pt;mt+=1)yt[mt]=(St[mt]-vt[mt])*xt+At[mt];return yt}return(St-vt)*xt+At}else if(at==="continue"){var wt=this.getValueAtTime(ut/this.comp.globalData.frameRate,0),Ot=this.getValueAtTime((ut-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(yt=new Array(wt.length),pt=yt.length,mt=0;mt<pt;mt+=1)yt[mt]=wt[mt]+(wt[mt]-Ot[mt])*((ct-ut)/this.comp.globalData.frameRate)/5e-4;return yt}return wt+(wt-Ot)*((ct-ut)/.001)}return this.getValueAtTime(((ct-dt)%ht+dt)/this.comp.globalData.frameRate,0)}function i(at,ot,lt){if(!this.k)return this.pv;at=at?at.toLowerCase():"";var ct=this.comp.renderedFrame,ft=this.keyframes,ut=ft[0].t;if(ct>=ut)return this.pv;var ht,dt;lt?(ot?ht=Math.abs(this.elem.comp.globalData.frameRate*ot):ht=Math.max(0,this.elem.data.op-ut),dt=ut+ht):((!ot||ot>ft.length-1)&&(ot=ft.length-1),dt=ft[ot].t,ht=dt-ut);var mt,pt,yt;if(at==="pingpong"){var gt=Math.floor((ut-ct)/ht);if(gt%2===0)return this.getValueAtTime(((ut-ct)%ht+ut)/this.comp.globalData.frameRate,0)}else if(at==="offset"){var vt=this.getValueAtTime(ut/this.comp.globalData.frameRate,0),St=this.getValueAtTime(dt/this.comp.globalData.frameRate,0),At=this.getValueAtTime((ht-(ut-ct)%ht+ut)/this.comp.globalData.frameRate,0),xt=Math.floor((ut-ct)/ht)+1;if(this.pv.length){for(yt=new Array(vt.length),pt=yt.length,mt=0;mt<pt;mt+=1)yt[mt]=At[mt]-(St[mt]-vt[mt])*xt;return yt}return At-(St-vt)*xt}else if(at==="continue"){var wt=this.getValueAtTime(ut/this.comp.globalData.frameRate,0),Ot=this.getValueAtTime((ut+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(yt=new Array(wt.length),pt=yt.length,mt=0;mt<pt;mt+=1)yt[mt]=wt[mt]+(wt[mt]-Ot[mt])*(ut-ct)/.001;return yt}return wt+(wt-Ot)*(ut-ct)/.001}return this.getValueAtTime((ht-((ut-ct)%ht+ut))/this.comp.globalData.frameRate,0)}function _(at,ot){if(!this.k)return this.pv;if(at=(at||.4)*.5,ot=Math.floor(ot||5),ot<=1)return this.pv;var lt=this.comp.renderedFrame/this.comp.globalData.frameRate,ct=lt-at,ft=lt+at,ut=ot>1?(ft-ct)/(ot-1):1,ht=0,dt=0,mt;this.pv.length?mt=createTypedArray("float32",this.pv.length):mt=0;for(var pt;ht<ot;){if(pt=this.getValueAtTime(ct+ht*ut),this.pv.length)for(dt=0;dt<this.pv.length;dt+=1)mt[dt]+=pt[dt];else mt+=pt;ht+=1}if(this.pv.length)for(dt=0;dt<this.pv.length;dt+=1)mt[dt]/=ot;else mt/=ot;return mt}function $(at){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var ot=this._transformCachingAtTime.v;if(ot.cloneFromProps(this.pre.props),this.appliedTransformations<1){var lt=this.a.getValueAtTime(at);ot.translate(-lt[0]*this.a.mult,-lt[1]*this.a.mult,lt[2]*this.a.mult)}if(this.appliedTransformations<2){var ct=this.s.getValueAtTime(at);ot.scale(ct[0]*this.s.mult,ct[1]*this.s.mult,ct[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var ft=this.sk.getValueAtTime(at),ut=this.sa.getValueAtTime(at);ot.skewFromAxis(-ft*this.sk.mult,ut*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var ht=this.r.getValueAtTime(at);ot.rotate(-ht*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var dt=this.rz.getValueAtTime(at),mt=this.ry.getValueAtTime(at),pt=this.rx.getValueAtTime(at),yt=this.or.getValueAtTime(at);ot.rotateZ(-dt*this.rz.mult).rotateY(mt*this.ry.mult).rotateX(pt*this.rx.mult).rotateZ(-yt[2]*this.or.mult).rotateY(yt[1]*this.or.mult).rotateX(yt[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var gt=this.px.getValueAtTime(at),vt=this.py.getValueAtTime(at);if(this.data.p.z){var St=this.pz.getValueAtTime(at);ot.translate(gt*this.px.mult,vt*this.py.mult,-St*this.pz.mult)}else ot.translate(gt*this.px.mult,vt*this.py.mult,0)}else{var At=this.p.getValueAtTime(at);ot.translate(At[0]*this.p.mult,At[1]*this.p.mult,-At[2]*this.p.mult)}return ot}function j(){return this.v.clone(new Matrix)}var _e=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(at,ot,lt){var ct=_e(at,ot,lt);return ct.dynamicProperties.length?ct.getValueAtTime=$.bind(ct):ct.getValueAtTime=j.bind(ct),ct.setGroupProperty=expressionHelpers.setGroupProperty,ct};var et=PropertyFactory.getProp;PropertyFactory.getProp=function(at,ot,lt,ct,ft){var ut=et(at,ot,lt,ct,ft);ut.kf?ut.getValueAtTime=expressionHelpers.getValueAtTime.bind(ut):ut.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(ut),ut.setGroupProperty=expressionHelpers.setGroupProperty,ut.loopOut=o,ut.loopIn=i,ut.smooth=_,ut.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(ut),ut.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(ut),ut.numKeys=ot.a===1?ot.k.length:0,ut.propertyIndex=ot.ix;var ht=0;return lt!==0&&(ht=createTypedArray("float32",ot.a===1?ot.k[0].s.length:ot.k.length)),ut._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:ht},expressionHelpers.searchExpressions(at,ot,ut),ut.k&&ft.addDynamicProperty(ut),ut};function tt(at){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),at*=this.elem.globalData.frameRate,at-=this.offsetTime,at!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<at?this._caching.lastIndex:0,this._cachingAtTime.lastTime=at,this.interpolateShape(at,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var rt=ShapePropertyFactory.getConstructorFunction(),nt=ShapePropertyFactory.getKeyframedConstructorFunction();function it(){}it.prototype={vertices:function(ot,lt){this.k&&this.getValue();var ct=this.v;lt!==void 0&&(ct=this.getValueAtTime(lt,0));var ft,ut=ct._length,ht=ct[ot],dt=ct.v,mt=createSizedArray(ut);for(ft=0;ft<ut;ft+=1)ot==="i"||ot==="o"?mt[ft]=[ht[ft][0]-dt[ft][0],ht[ft][1]-dt[ft][1]]:mt[ft]=[ht[ft][0],ht[ft][1]];return mt},points:function(ot){return this.vertices("v",ot)},inTangents:function(ot){return this.vertices("i",ot)},outTangents:function(ot){return this.vertices("o",ot)},isClosed:function(){return this.v.c},pointOnPath:function(ot,lt){var ct=this.v;lt!==void 0&&(ct=this.getValueAtTime(lt,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(ct));for(var ft=this._segmentsLength,ut=ft.lengths,ht=ft.totalLength*ot,dt=0,mt=ut.length,pt=0,yt;dt<mt;){if(pt+ut[dt].addedLength>ht){var gt=dt,vt=ct.c&&dt===mt-1?0:dt+1,St=(ht-pt)/ut[dt].addedLength;yt=bez.getPointInSegment(ct.v[gt],ct.v[vt],ct.o[gt],ct.i[vt],St,ut[dt]);break}else pt+=ut[dt].addedLength;dt+=1}return yt||(yt=ct.c?[ct.v[0][0],ct.v[0][1]]:[ct.v[ct._length-1][0],ct.v[ct._length-1][1]]),yt},vectorOnPath:function(ot,lt,ct){ot==1?ot=this.v.c:ot==0&&(ot=.999);var ft=this.pointOnPath(ot,lt),ut=this.pointOnPath(ot+.001,lt),ht=ut[0]-ft[0],dt=ut[1]-ft[1],mt=Math.sqrt(Math.pow(ht,2)+Math.pow(dt,2));if(mt===0)return[0,0];var pt=ct==="tangent"?[ht/mt,dt/mt]:[-dt/mt,ht/mt];return pt},tangentOnPath:function(ot,lt){return this.vectorOnPath(ot,lt,"tangent")},normalOnPath:function(ot,lt){return this.vectorOnPath(ot,lt,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([it],rt),extendPrototype([it],nt),nt.prototype.getValueAtTime=tt,nt.prototype.initiateExpression=ExpressionManager.initiateExpression;var st=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(at,ot,lt,ct,ft){var ut=st(at,ot,lt,ct,ft);return ut.propertyIndex=ot.ix,ut.lock=!1,lt===3?expressionHelpers.searchExpressions(at,ot.pt,ut):lt===4&&expressionHelpers.searchExpressions(at,ot.ks,ut),ut.k&&at.addDynamicProperty(ut),ut}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function o(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(i,_){var $=this.calculateExpression(_);if(i.t!==$){var j={};return this.copyData(j,i),j.t=$.toString(),j.__complete=!1,j}return i},TextProperty.prototype.searchProperty=function(){var i=this.searchKeyframes(),_=this.searchExpressions();return this.kf=i||_,this.kf},TextProperty.prototype.searchExpressions=o}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function o(i,_){var $=createNS("feMerge");$.setAttribute("result",i);var j,_e;for(_e=0;_e<_.length;_e+=1)j=createNS("feMergeNode"),j.setAttribute("in",_[_e]),$.appendChild(j),$.appendChild(j);return $}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(o,i,_,$,j){this.filterManager=i;var _e=createNS("feColorMatrix");_e.setAttribute("type","matrix"),_e.setAttribute("color-interpolation-filters","linearRGB"),_e.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=_e,_e.setAttribute("result",$+"_tint_1"),o.appendChild(_e),_e=createNS("feColorMatrix"),_e.setAttribute("type","matrix"),_e.setAttribute("color-interpolation-filters","sRGB"),_e.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),_e.setAttribute("result",$+"_tint_2"),o.appendChild(_e),this.matrixFilter=_e;var et=this.createMergeNode($,[j,$+"_tint_1",$+"_tint_2"]);o.appendChild(et)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){var i=this.filterManager.effectElements[0].p.v,_=this.filterManager.effectElements[1].p.v,$=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+$+" 0"),this.matrixFilter.setAttribute("values",_[0]-i[0]+" 0 0 0 "+i[0]+" "+(_[1]-i[1])+" 0 0 0 "+i[1]+" "+(_[2]-i[2])+" 0 0 0 "+i[2]+" 0 0 0 1 0")}};function SVGFillFilter(o,i,_,$){this.filterManager=i;var j=createNS("feColorMatrix");j.setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","sRGB"),j.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),j.setAttribute("result",$),o.appendChild(j),this.matrixFilter=j}SVGFillFilter.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){var i=this.filterManager.effectElements[2].p.v,_=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+i[0]+" 0 0 0 0 "+i[1]+" 0 0 0 0 "+i[2]+" 0 0 0 "+_+" 0")}};function SVGStrokeEffect(o,i,_){this.initialized=!1,this.filterManager=i,this.elem=_,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var o=this.elem.layerElement.children||this.elem.layerElement.childNodes,i,_,$,j;for(this.filterManager.effectElements[1].p.v===1?(j=this.elem.maskManager.masksProperties.length,$=0):($=this.filterManager.effectElements[0].p.v-1,j=$+1),_=createNS("g"),_.setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),_.setAttribute("stroke-dashoffset",1),$;$<j;$+=1)i=createNS("path"),_.appendChild(i),this.paths.push({p:i,m:$});if(this.filterManager.effectElements[10].p.v===3){var _e=createNS("mask"),et=createElementID();_e.setAttribute("id",et),_e.setAttribute("mask-type","alpha"),_e.appendChild(_),this.elem.globalData.defs.appendChild(_e);var tt=createNS("g");for(tt.setAttribute("mask","url("+getLocationHref()+"#"+et+")");o[0];)tt.appendChild(o[0]);this.elem.layerElement.appendChild(tt),this.masker=_e,_.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(o=this.elem.layerElement.children||this.elem.layerElement.childNodes;o.length;)this.elem.layerElement.removeChild(o[0]);this.elem.layerElement.appendChild(_),this.elem.layerElement.removeAttribute("mask"),_.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=_},SVGStrokeEffect.prototype.renderFrame=function(o){this.initialized||this.initialize();var i,_=this.paths.length,$,j;for(i=0;i<_;i+=1)if(this.paths[i].m!==-1&&($=this.elem.maskManager.viewData[this.paths[i].m],j=this.paths[i].p,(o||this.filterManager._mdf||$.prop._mdf)&&j.setAttribute("d",$.lastPath),o||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||$.prop._mdf)){var _e;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var et=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,tt=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,rt=j.getTotalLength();_e="0 0 0 "+rt*et+" ";var nt=rt*(tt-et),it=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,st=Math.floor(nt/it),at;for(at=0;at<st;at+=1)_e+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";_e+="0 "+rt*10+" 0 0"}else _e="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;j.setAttribute("stroke-dasharray",_e)}if((o||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(o||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(o||this.filterManager.effectElements[3].p._mdf)){var ot=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(ot[0]*255)+","+bmFloor(ot[1]*255)+","+bmFloor(ot[2]*255)+")")}};function SVGTritoneFilter(o,i,_,$){this.filterManager=i;var j=createNS("feColorMatrix");j.setAttribute("type","matrix"),j.setAttribute("color-interpolation-filters","linearRGB"),j.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),o.appendChild(j);var _e=createNS("feComponentTransfer");_e.setAttribute("color-interpolation-filters","sRGB"),_e.setAttribute("result",$),this.matrixFilter=_e;var et=createNS("feFuncR");et.setAttribute("type","table"),_e.appendChild(et),this.feFuncR=et;var tt=createNS("feFuncG");tt.setAttribute("type","table"),_e.appendChild(tt),this.feFuncG=tt;var rt=createNS("feFuncB");rt.setAttribute("type","table"),_e.appendChild(rt),this.feFuncB=rt,o.appendChild(_e)}SVGTritoneFilter.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){var i=this.filterManager.effectElements[0].p.v,_=this.filterManager.effectElements[1].p.v,$=this.filterManager.effectElements[2].p.v,j=$[0]+" "+_[0]+" "+i[0],_e=$[1]+" "+_[1]+" "+i[1],et=$[2]+" "+_[2]+" "+i[2];this.feFuncR.setAttribute("tableValues",j),this.feFuncG.setAttribute("tableValues",_e),this.feFuncB.setAttribute("tableValues",et)}};function SVGProLevelsFilter(o,i,_,$){this.filterManager=i;var j=this.filterManager.effectElements,_e=createNS("feComponentTransfer");(j[10].p.k||j[10].p.v!==0||j[11].p.k||j[11].p.v!==1||j[12].p.k||j[12].p.v!==1||j[13].p.k||j[13].p.v!==0||j[14].p.k||j[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",_e)),(j[17].p.k||j[17].p.v!==0||j[18].p.k||j[18].p.v!==1||j[19].p.k||j[19].p.v!==1||j[20].p.k||j[20].p.v!==0||j[21].p.k||j[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",_e)),(j[24].p.k||j[24].p.v!==0||j[25].p.k||j[25].p.v!==1||j[26].p.k||j[26].p.v!==1||j[27].p.k||j[27].p.v!==0||j[28].p.k||j[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",_e)),(j[31].p.k||j[31].p.v!==0||j[32].p.k||j[32].p.v!==1||j[33].p.k||j[33].p.v!==1||j[34].p.k||j[34].p.v!==0||j[35].p.k||j[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",_e)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(_e.setAttribute("color-interpolation-filters","sRGB"),o.appendChild(_e)),(j[3].p.k||j[3].p.v!==0||j[4].p.k||j[4].p.v!==1||j[5].p.k||j[5].p.v!==1||j[6].p.k||j[6].p.v!==0||j[7].p.k||j[7].p.v!==1)&&(_e=createNS("feComponentTransfer"),_e.setAttribute("color-interpolation-filters","sRGB"),_e.setAttribute("result",$),o.appendChild(_e),this.feFuncRComposed=this.createFeFunc("feFuncR",_e),this.feFuncGComposed=this.createFeFunc("feFuncG",_e),this.feFuncBComposed=this.createFeFunc("feFuncB",_e))}SVGProLevelsFilter.prototype.createFeFunc=function(o,i){var _=createNS(o);return _.setAttribute("type","table"),i.appendChild(_),_},SVGProLevelsFilter.prototype.getTableValue=function(o,i,_,$,j){for(var _e=0,et=256,tt,rt=Math.min(o,i),nt=Math.max(o,i),it=Array.call(null,{length:et}),st,at=0,ot=j-$,lt=i-o;_e<=256;)tt=_e/256,tt<=rt?st=lt<0?j:$:tt>=nt?st=lt<0?$:j:st=$+ot*Math.pow((tt-o)/lt,1/_),it[at]=st,at+=1,_e+=256/(et-1);return it.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){var i,_=this.filterManager.effectElements;this.feFuncRComposed&&(o||_[3].p._mdf||_[4].p._mdf||_[5].p._mdf||_[6].p._mdf||_[7].p._mdf)&&(i=this.getTableValue(_[3].p.v,_[4].p.v,_[5].p.v,_[6].p.v,_[7].p.v),this.feFuncRComposed.setAttribute("tableValues",i),this.feFuncGComposed.setAttribute("tableValues",i),this.feFuncBComposed.setAttribute("tableValues",i)),this.feFuncR&&(o||_[10].p._mdf||_[11].p._mdf||_[12].p._mdf||_[13].p._mdf||_[14].p._mdf)&&(i=this.getTableValue(_[10].p.v,_[11].p.v,_[12].p.v,_[13].p.v,_[14].p.v),this.feFuncR.setAttribute("tableValues",i)),this.feFuncG&&(o||_[17].p._mdf||_[18].p._mdf||_[19].p._mdf||_[20].p._mdf||_[21].p._mdf)&&(i=this.getTableValue(_[17].p.v,_[18].p.v,_[19].p.v,_[20].p.v,_[21].p.v),this.feFuncG.setAttribute("tableValues",i)),this.feFuncB&&(o||_[24].p._mdf||_[25].p._mdf||_[26].p._mdf||_[27].p._mdf||_[28].p._mdf)&&(i=this.getTableValue(_[24].p.v,_[25].p.v,_[26].p.v,_[27].p.v,_[28].p.v),this.feFuncB.setAttribute("tableValues",i)),this.feFuncA&&(o||_[31].p._mdf||_[32].p._mdf||_[33].p._mdf||_[34].p._mdf||_[35].p._mdf)&&(i=this.getTableValue(_[31].p.v,_[32].p.v,_[33].p.v,_[34].p.v,_[35].p.v),this.feFuncA.setAttribute("tableValues",i))}};function SVGDropShadowEffect(o,i,_,$,j){var _e=i.container.globalData.renderConfig.filterSize,et=i.data.fs||_e;o.setAttribute("x",et.x||_e.x),o.setAttribute("y",et.y||_e.y),o.setAttribute("width",et.width||_e.width),o.setAttribute("height",et.height||_e.height),this.filterManager=i;var tt=createNS("feGaussianBlur");tt.setAttribute("in","SourceAlpha"),tt.setAttribute("result",$+"_drop_shadow_1"),tt.setAttribute("stdDeviation","0"),this.feGaussianBlur=tt,o.appendChild(tt);var rt=createNS("feOffset");rt.setAttribute("dx","25"),rt.setAttribute("dy","0"),rt.setAttribute("in",$+"_drop_shadow_1"),rt.setAttribute("result",$+"_drop_shadow_2"),this.feOffset=rt,o.appendChild(rt);var nt=createNS("feFlood");nt.setAttribute("flood-color","#00ff00"),nt.setAttribute("flood-opacity","1"),nt.setAttribute("result",$+"_drop_shadow_3"),this.feFlood=nt,o.appendChild(nt);var it=createNS("feComposite");it.setAttribute("in",$+"_drop_shadow_3"),it.setAttribute("in2",$+"_drop_shadow_2"),it.setAttribute("operator","in"),it.setAttribute("result",$+"_drop_shadow_4"),o.appendChild(it);var st=this.createMergeNode($,[$+"_drop_shadow_4",j]);o.appendChild(st)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){if((o||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),o||this.filterManager.effectElements[0].p._mdf){var i=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)))}if((o||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),o||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var _=this.filterManager.effectElements[3].p.v,$=(this.filterManager.effectElements[2].p.v-90)*degToRads,j=_*Math.cos($),_e=_*Math.sin($);this.feOffset.setAttribute("dx",j),this.feOffset.setAttribute("dy",_e)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(o,i,_){this.initialized=!1,this.filterManager=i,this.filterElem=o,this.elem=_,_.matteElement=createNS("g"),_.matteElement.appendChild(_.layerElement),_.matteElement.appendChild(_.transformedElement),_.baseElement=_.matteElement}SVGMatte3Effect.prototype.findSymbol=function(o){for(var i=0,_=_svgMatteSymbols.length;i<_;){if(_svgMatteSymbols[i]===o)return _svgMatteSymbols[i];i+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(o,i){var _=o.layerElement.parentNode;if(_){for(var $=_.children,j=0,_e=$.length;j<_e&&$[j]!==o.layerElement;)j+=1;var et;j<=_e-2&&(et=$[j+1]);var tt=createNS("use");tt.setAttribute("href","#"+i),et?_.insertBefore(tt,et):_.appendChild(tt)}},SVGMatte3Effect.prototype.setElementAsMask=function(o,i){if(!this.findSymbol(i)){var _=createElementID(),$=createNS("mask");$.setAttribute("id",i.layerId),$.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(i);var j=o.globalData.defs;j.appendChild($);var _e=createNS("symbol");_e.setAttribute("id",_),this.replaceInParent(i,_),_e.appendChild(i.layerElement),j.appendChild(_e);var et=createNS("use");et.setAttribute("href","#"+_),$.appendChild(et),i.data.hd=!1,i.show()}o.setMatte(i.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var o=this.filterManager.effectElements[0].p.v,i=this.elem.comp.elements,_=0,$=i.length;_<$;)i[_]&&i[_].data.ind===o&&this.setElementAsMask(this.elem,i[_]),_+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(o,i,_,$){o.setAttribute("x","-100%"),o.setAttribute("y","-100%"),o.setAttribute("width","300%"),o.setAttribute("height","300%"),this.filterManager=i;var j=createNS("feGaussianBlur");j.setAttribute("result",$),o.appendChild(j),this.feGaussianBlur=j}SVGGaussianBlurEffect.prototype.renderFrame=function(o){if(o||this.filterManager._mdf){var i=.3,_=this.filterManager.effectElements[0].p.v*i,$=this.filterManager.effectElements[1].p.v,j=$==3?0:_,_e=$==2?0:_;this.feGaussianBlur.setAttribute("stdDeviation",j+" "+_e);var et=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",et)}};function TransformEffect(){}TransformEffect.prototype.init=function(o){this.effectsManager=o,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(o){if(this._opMdf=!1,this._mdf=!1,o||this.effectsManager._mdf){var i=this.effectsManager.effectElements,_=i[0].p.v,$=i[1].p.v,j=i[2].p.v===1,_e=i[3].p.v,et=j?_e:i[4].p.v,tt=i[5].p.v,rt=i[6].p.v,nt=i[7].p.v;this.matrix.reset(),this.matrix.translate(-_[0],-_[1],_[2]),this.matrix.scale(et*.01,_e*.01,1),this.matrix.rotate(-nt*degToRads),this.matrix.skewFromAxis(-tt*degToRads,(rt+90)*degToRads),this.matrix.translate($[0],$[1],0),this._mdf=!0,this.opacity!==i[8].p.v&&(this.opacity=i[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(o,i){this.init(i)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(o){this.init(o)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})})(lottie$1,lottie$1.exports);var lottieExports=lottie$1.exports;const lottie=getDefaultExportFromCjs$1(lottieExports);function _arrayLikeToArray$m(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=Array(i);_<i;_++)$[_]=o[_];return $}function _arrayWithHoles$e(o){if(Array.isArray(o))return o}function _defineProperty$J(o,i,_){return(i=_toPropertyKey$J(i))in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _iterableToArrayLimit$d(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _nonIterableRest$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys$D(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread2$1(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$D(Object(_),!0).forEach(function($){_defineProperty$J(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$D(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _objectWithoutProperties$j(o,i){if(o==null)return{};var _,$,j=_objectWithoutPropertiesLoose$j(o,i);if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for($=0;$<_e.length;$++)_=_e[$],i.includes(_)||{}.propertyIsEnumerable.call(o,_)&&(j[_]=o[_])}return j}function _objectWithoutPropertiesLoose$j(o,i){if(o==null)return{};var _={};for(var $ in o)if({}.hasOwnProperty.call(o,$)){if(i.includes($))continue;_[$]=o[$]}return _}function _slicedToArray$d(o,i){return _arrayWithHoles$e(o)||_iterableToArrayLimit$d(o,i)||_unsupportedIterableToArray$m(o,i)||_nonIterableRest$e()}function _toPrimitive$J(o,i){if(typeof o!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(typeof $!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _toPropertyKey$J(o){var i=_toPrimitive$J(o,"string");return typeof i=="symbol"?i:i+""}function _unsupportedIterableToArray$m(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$m(o,i);var _={}.toString.call(o).slice(8,-1);return _==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set"?Array.from(o):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?_arrayLikeToArray$m(o,i):void 0}}var _excluded$1$1=["animationData","loop","autoplay","initialSegment","onComplete","onLoopComplete","onEnterFrame","onSegmentStart","onConfigReady","onDataReady","onDataFailed","onLoadedImages","onDOMLoaded","onDestroy","lottieRef","renderer","name","assetsPath","rendererSettings"],useLottie=function o(i,_){var $=i.animationData,j=i.loop,_e=i.autoplay,et=i.initialSegment,tt=i.onComplete,rt=i.onLoopComplete,nt=i.onEnterFrame,it=i.onSegmentStart,st=i.onConfigReady,at=i.onDataReady,ot=i.onDataFailed,lt=i.onLoadedImages,ct=i.onDOMLoaded,ft=i.onDestroy;i.lottieRef,i.renderer,i.name,i.assetsPath,i.rendererSettings;var ut=_objectWithoutProperties$j(i,_excluded$1$1),ht=reactExports.useState(!1),dt=_slicedToArray$d(ht,2),mt=dt[0],pt=dt[1],yt=reactExports.useRef(),gt=reactExports.useRef(null),vt=function(){var Lt;(Lt=yt.current)===null||Lt===void 0||Lt.play()},St=function(){var Lt;(Lt=yt.current)===null||Lt===void 0||Lt.stop()},At=function(){var Lt;(Lt=yt.current)===null||Lt===void 0||Lt.pause()},xt=function(Lt){var Ct;(Ct=yt.current)===null||Ct===void 0||Ct.setSpeed(Lt)},wt=function(Lt,Ct){var kt;(kt=yt.current)===null||kt===void 0||kt.goToAndPlay(Lt,Ct)},Ot=function(Lt,Ct){var kt;(kt=yt.current)===null||kt===void 0||kt.goToAndStop(Lt,Ct)},Bt=function(Lt){var Ct;(Ct=yt.current)===null||Ct===void 0||Ct.setDirection(Lt)},Ft=function(Lt,Ct){var kt;(kt=yt.current)===null||kt===void 0||kt.playSegments(Lt,Ct)},Pt=function(Lt){var Ct;(Ct=yt.current)===null||Ct===void 0||Ct.setSubframe(Lt)},Rt=function(Lt){var Ct;return(Ct=yt.current)===null||Ct===void 0?void 0:Ct.getDuration(Lt)},Et=function(){var Lt;(Lt=yt.current)===null||Lt===void 0||Lt.destroy(),yt.current=void 0},_t=function(){var Lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ct;if(gt.current){(Ct=yt.current)===null||Ct===void 0||Ct.destroy();var kt=_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},i),Lt),{},{container:gt.current});return yt.current=lottie.loadAnimation(kt),pt(!!yt.current),function(){var jt;(jt=yt.current)===null||jt===void 0||jt.destroy(),yt.current=void 0}}};reactExports.useEffect(function(){var Dt=_t();return function(){return Dt==null?void 0:Dt()}},[$,j]),reactExports.useEffect(function(){yt.current&&(yt.current.autoplay=!!_e)},[_e]),reactExports.useEffect(function(){if(yt.current){if(!et){yt.current.resetSegments(!0);return}!Array.isArray(et)||!et.length||((yt.current.currentRawFrame<et[0]||yt.current.currentRawFrame>et[1])&&(yt.current.currentRawFrame=et[0]),yt.current.setSegment(et[0],et[1]))}},[et]),reactExports.useEffect(function(){var Dt=[{name:"complete",handler:tt},{name:"loopComplete",handler:rt},{name:"enterFrame",handler:nt},{name:"segmentStart",handler:it},{name:"config_ready",handler:st},{name:"data_ready",handler:at},{name:"data_failed",handler:ot},{name:"loaded_images",handler:lt},{name:"DOMLoaded",handler:ct},{name:"destroy",handler:ft}],Lt=Dt.filter(function(kt){return kt.handler!=null});if(Lt.length){var Ct=Lt.map(function(kt){var jt;return(jt=yt.current)===null||jt===void 0||jt.addEventListener(kt.name,kt.handler),function(){var Vt;(Vt=yt.current)===null||Vt===void 0||Vt.removeEventListener(kt.name,kt.handler)}});return function(){Ct.forEach(function(kt){return kt()})}}},[tt,rt,nt,it,st,at,ot,lt,ct,ft]);var Mt=React$2.createElement("div",_objectSpread2$1({style:_,ref:gt},ut));return{View:Mt,play:vt,stop:St,pause:At,setSpeed:xt,goToAndStop:Ot,goToAndPlay:wt,setDirection:Bt,playSegments:Ft,setSubframe:Pt,getDuration:Rt,destroy:Et,animationContainerRef:gt,animationLoaded:mt,animationItem:yt.current}};function getContainerVisibility(o){var i=o.getBoundingClientRect(),_=i.top,$=i.height,j=window.innerHeight-_,_e=window.innerHeight+$;return j/_e}function getContainerCursorPosition(o,i,_){var $=o.getBoundingClientRect(),j=$.top,_e=$.left,et=$.width,tt=$.height,rt=(i-_e)/et,nt=(_-j)/tt;return{x:rt,y:nt}}var useInitInteractivity=function o(i){var _=i.wrapperRef,$=i.animationItem,j=i.mode,_e=i.actions;reactExports.useEffect(function(){var et=_.current;if(!(!et||!$||!_e.length)){$.stop();var tt=function(){var it=null,st=function(){var ot=getContainerVisibility(et),lt=_e.find(function(ft){var ut=ft.visibility;return ut&&ot>=ut[0]&&ot<=ut[1]});if(lt){if(lt.type==="seek"&&lt.visibility&&lt.frames.length===2){var ct=lt.frames[0]+Math.ceil((ot-lt.visibility[0])/(lt.visibility[1]-lt.visibility[0])*lt.frames[1]);//! goToAndStop must be relative to the start of the current segment
$.goToAndStop(ct-$.firstFrame-1,!0)}lt.type==="loop"&&(it===null||it!==lt.frames||$.isPaused)&&($.playSegments(lt.frames,!0),it=lt.frames),lt.type==="play"&&$.isPaused&&($.resetSegments(!0),$.play()),lt.type==="stop"&&$.goToAndStop(lt.frames[0]-$.firstFrame-1,!0)}};return document.addEventListener("scroll",st),function(){document.removeEventListener("scroll",st)}},rt=function(){var it=function(lt,ct){var ft=lt,ut=ct;if(ft!==-1&&ut!==-1){var ht=getContainerCursorPosition(et,ft,ut);ft=ht.x,ut=ht.y}var dt=_e.find(function(yt){var gt=yt.position;return gt&&Array.isArray(gt.x)&&Array.isArray(gt.y)?ft>=gt.x[0]&&ft<=gt.x[1]&&ut>=gt.y[0]&&ut<=gt.y[1]:gt&&!Number.isNaN(gt.x)&&!Number.isNaN(gt.y)?ft===gt.x&&ut===gt.y:!1});if(dt){if(dt.type==="seek"&&dt.position&&Array.isArray(dt.position.x)&&Array.isArray(dt.position.y)&&dt.frames.length===2){var mt=(ft-dt.position.x[0])/(dt.position.x[1]-dt.position.x[0]),pt=(ut-dt.position.y[0])/(dt.position.y[1]-dt.position.y[0]);$.playSegments(dt.frames,!0),$.goToAndStop(Math.ceil((mt+pt)/2*(dt.frames[1]-dt.frames[0])),!0)}dt.type==="loop"&&$.playSegments(dt.frames,!0),dt.type==="play"&&($.isPaused&&$.resetSegments(!1),$.playSegments(dt.frames)),dt.type==="stop"&&$.goToAndStop(dt.frames[0],!0)}},st=function(lt){it(lt.clientX,lt.clientY)},at=function(){it(-1,-1)};return et.addEventListener("mousemove",st),et.addEventListener("mouseout",at),function(){et.removeEventListener("mousemove",st),et.removeEventListener("mouseout",at)}};switch(j){case"scroll":return tt();case"cursor":return rt()}}},[j,$])},useLottieInteractivity=function o(i){var _=i.actions,$=i.mode,j=i.lottieObj,_e=j.animationItem,et=j.View,tt=j.animationContainerRef;return useInitInteractivity({actions:_,animationItem:_e,mode:$,wrapperRef:tt}),et},_excluded$j=["style","interactivity"],Lottie=function o(i){var _,$,j,_e=i.style,et=i.interactivity,tt=_objectWithoutProperties$j(i,_excluded$j),rt=useLottie(tt,_e),nt=rt.View,it=rt.play,st=rt.stop,at=rt.pause,ot=rt.setSpeed,lt=rt.goToAndStop,ct=rt.goToAndPlay,ft=rt.setDirection,ut=rt.playSegments,ht=rt.setSubframe,dt=rt.getDuration,mt=rt.destroy,pt=rt.animationContainerRef,yt=rt.animationLoaded,gt=rt.animationItem;return reactExports.useEffect(function(){i.lottieRef&&(i.lottieRef.current={play:it,stop:st,pause:at,setSpeed:ot,goToAndPlay:ct,goToAndStop:lt,setDirection:ft,playSegments:ut,setSubframe:ht,getDuration:dt,destroy:mt,animationContainerRef:pt,animationLoaded:yt,animationItem:gt})},[(_=i.lottieRef)===null||_===void 0?void 0:_.current]),useLottieInteractivity({lottieObj:{View:nt,play:it,stop:st,pause:at,setSpeed:ot,goToAndStop:lt,goToAndPlay:ct,setDirection:ft,playSegments:ut,setSubframe:ht,getDuration:dt,destroy:mt,animationContainerRef:pt,animationLoaded:yt,animationItem:gt},actions:($=et==null?void 0:et.actions)!==null&&$!==void 0?$:[],mode:(j=et==null?void 0:et.mode)!==null&&j!==void 0?j:"scroll"})};function Home(){const o=useReducedMotionPref(),[i,_]=reactExports.useState(null);return reactExports.useEffect(()=>{o||fetch("/lottie/warm-sunrise.json").then($=>$.json()).then(_).catch(()=>_(null))},[o]),jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-warm-gradient opacity-70"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10 grid items-center gap-6 p-6 md:grid-cols-2",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl md:text-5xl font-bold tracking-tight",style:{lineHeight:1.1},children:"    "}),jsxRuntimeExports.jsx("p",{className:"text-muted max-w-prose",children:"          PDF     ."}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-3",children:[jsxRuntimeExports.jsx(Link,{to:"/onboarding",className:"btn btn-primary",children:" "}),jsxRuntimeExports.jsx(Link,{to:"/dashboard",className:"btn btn-secondary",children:" "})]})]}),jsxRuntimeExports.jsx(motion.div,{initial:o?!1:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:o?0:.6},className:"rounded-xl bg-surface/60 p-4 backdrop-blur shadow-soft-warm",children:!o&&i&&jsxRuntimeExports.jsx(Lottie,{animationData:i,loop:!0,autoplay:!0,style:{width:"100%",height:280,opacity:1}})})]})]})}function r(o){var i,_,$="";if(typeof o=="string"||typeof o=="number")$+=o;else if(typeof o=="object")if(Array.isArray(o)){var j=o.length;for(i=0;i<j;i++)o[i]&&(_=r(o[i]))&&($&&($+=" "),$+=_)}else for(_ in o)o[_]&&($&&($+=" "),$+=_);return $}function clsx(){for(var o,i,_=0,$="",j=arguments.length;_<j;_++)(o=arguments[_])&&(i=r(o))&&($&&($+=" "),$+=i);return $}var isArray$f=Array.isArray,isArray_1=isArray$f,freeGlobal$1=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal$1,freeGlobal=_freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$9=freeGlobal||freeSelf||Function("return this")(),_root=root$9,root$8=_root,Symbol$7=root$8.Symbol,_Symbol=Symbol$7,Symbol$6=_Symbol,objectProto$c=Object.prototype,hasOwnProperty$a=objectProto$c.hasOwnProperty,nativeObjectToString$1=objectProto$c.toString,symToStringTag$1=Symbol$6?Symbol$6.toStringTag:void 0;function getRawTag$1(o){var i=hasOwnProperty$a.call(o,symToStringTag$1),_=o[symToStringTag$1];try{o[symToStringTag$1]=void 0;var $=!0}catch{}var j=nativeObjectToString$1.call(o);return $&&(i?o[symToStringTag$1]=_:delete o[symToStringTag$1]),j}var _getRawTag=getRawTag$1,objectProto$b=Object.prototype,nativeObjectToString=objectProto$b.toString;function objectToString$1(o){return nativeObjectToString.call(o)}var _objectToString=objectToString$1,Symbol$5=_Symbol,getRawTag=_getRawTag,objectToString=_objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$5?Symbol$5.toStringTag:void 0;function baseGetTag$9(o){return o==null?o===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(o)?getRawTag(o):objectToString(o)}var _baseGetTag=baseGetTag$9;function isObjectLike$9(o){return o!=null&&typeof o=="object"}var isObjectLike_1=isObjectLike$9,baseGetTag$8=_baseGetTag,isObjectLike$8=isObjectLike_1,symbolTag$1="[object Symbol]";function isSymbol$6(o){return typeof o=="symbol"||isObjectLike$8(o)&&baseGetTag$8(o)==symbolTag$1}var isSymbol_1=isSymbol$6,isArray$e=isArray_1,isSymbol$5=isSymbol_1,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey$3(o,i){if(isArray$e(o))return!1;var _=typeof o;return _=="number"||_=="symbol"||_=="boolean"||o==null||isSymbol$5(o)?!0:reIsPlainProp.test(o)||!reIsDeepProp.test(o)||i!=null&&o in Object(i)}var _isKey=isKey$3;function isObject$7(o){var i=typeof o;return o!=null&&(i=="object"||i=="function")}var isObject_1=isObject$7;const isObject$8=getDefaultExportFromCjs$1(isObject_1);var baseGetTag$7=_baseGetTag,isObject$6=isObject_1,asyncTag="[object AsyncFunction]",funcTag$1="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$2(o){if(!isObject$6(o))return!1;var i=baseGetTag$7(o);return i==funcTag$1||i==genTag||i==asyncTag||i==proxyTag}var isFunction_1=isFunction$2;const isFunction$3=getDefaultExportFromCjs$1(isFunction_1);var root$7=_root,coreJsData$1=root$7["__core-js_shared__"],_coreJsData=coreJsData$1,coreJsData=_coreJsData,maskSrcKey=function(){var o=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function isMasked$1(o){return!!maskSrcKey&&maskSrcKey in o}var _isMasked=isMasked$1,funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource$2(o){if(o!=null){try{return funcToString$2.call(o)}catch{}try{return o+""}catch{}}return""}var _toSource=toSource$2,isFunction$1=isFunction_1,isMasked=_isMasked,isObject$5=isObject_1,toSource$1=_toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$a=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$9=objectProto$a.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$9).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(o){if(!isObject$5(o)||isMasked(o))return!1;var i=isFunction$1(o)?reIsNative:reIsHostCtor;return i.test(toSource$1(o))}var _baseIsNative=baseIsNative$1;function getValue$1(o,i){return o==null?void 0:o[i]}var _getValue=getValue$1,baseIsNative=_baseIsNative,getValue=_getValue;function getNative$7(o,i){var _=getValue(o,i);return baseIsNative(_)?_:void 0}var _getNative=getNative$7,getNative$6=_getNative,nativeCreate$4=getNative$6(Object,"create"),_nativeCreate=nativeCreate$4,nativeCreate$3=_nativeCreate;function hashClear$1(){this.__data__=nativeCreate$3?nativeCreate$3(null):{},this.size=0}var _hashClear=hashClear$1;function hashDelete$1(o){var i=this.has(o)&&delete this.__data__[o];return this.size-=i?1:0,i}var _hashDelete=hashDelete$1,nativeCreate$2=_nativeCreate,HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function hashGet$1(o){var i=this.__data__;if(nativeCreate$2){var _=i[o];return _===HASH_UNDEFINED$2?void 0:_}return hasOwnProperty$8.call(i,o)?i[o]:void 0}var _hashGet=hashGet$1,nativeCreate$1=_nativeCreate,objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function hashHas$1(o){var i=this.__data__;return nativeCreate$1?i[o]!==void 0:hasOwnProperty$7.call(i,o)}var _hashHas=hashHas$1,nativeCreate=_nativeCreate,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet$1(o,i){var _=this.__data__;return this.size+=this.has(o)?0:1,_[o]=nativeCreate&&i===void 0?HASH_UNDEFINED$1:i,this}var _hashSet=hashSet$1,hashClear=_hashClear,hashDelete=_hashDelete,hashGet=_hashGet,hashHas=_hashHas,hashSet=_hashSet;function Hash$1(o){var i=-1,_=o==null?0:o.length;for(this.clear();++i<_;){var $=o[i];this.set($[0],$[1])}}Hash$1.prototype.clear=hashClear;Hash$1.prototype.delete=hashDelete;Hash$1.prototype.get=hashGet;Hash$1.prototype.has=hashHas;Hash$1.prototype.set=hashSet;var _Hash=Hash$1;function listCacheClear$1(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear$1;function eq$3(o,i){return o===i||o!==o&&i!==i}var eq_1=eq$3,eq$2=eq_1;function assocIndexOf$4(o,i){for(var _=o.length;_--;)if(eq$2(o[_][0],i))return _;return-1}var _assocIndexOf=assocIndexOf$4,assocIndexOf$3=_assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete$1(o){var i=this.__data__,_=assocIndexOf$3(i,o);if(_<0)return!1;var $=i.length-1;return _==$?i.pop():splice.call(i,_,1),--this.size,!0}var _listCacheDelete=listCacheDelete$1,assocIndexOf$2=_assocIndexOf;function listCacheGet$1(o){var i=this.__data__,_=assocIndexOf$2(i,o);return _<0?void 0:i[_][1]}var _listCacheGet=listCacheGet$1,assocIndexOf$1=_assocIndexOf;function listCacheHas$1(o){return assocIndexOf$1(this.__data__,o)>-1}var _listCacheHas=listCacheHas$1,assocIndexOf=_assocIndexOf;function listCacheSet$1(o,i){var _=this.__data__,$=assocIndexOf(_,o);return $<0?(++this.size,_.push([o,i])):_[$][1]=i,this}var _listCacheSet=listCacheSet$1,listCacheClear=_listCacheClear,listCacheDelete=_listCacheDelete,listCacheGet=_listCacheGet,listCacheHas=_listCacheHas,listCacheSet=_listCacheSet;function ListCache$4(o){var i=-1,_=o==null?0:o.length;for(this.clear();++i<_;){var $=o[i];this.set($[0],$[1])}}ListCache$4.prototype.clear=listCacheClear;ListCache$4.prototype.delete=listCacheDelete;ListCache$4.prototype.get=listCacheGet;ListCache$4.prototype.has=listCacheHas;ListCache$4.prototype.set=listCacheSet;var _ListCache=ListCache$4,getNative$5=_getNative,root$6=_root,Map$4=getNative$5(root$6,"Map"),_Map=Map$4,Hash=_Hash,ListCache$3=_ListCache,Map$3=_Map;function mapCacheClear$1(){this.size=0,this.__data__={hash:new Hash,map:new(Map$3||ListCache$3),string:new Hash}}var _mapCacheClear=mapCacheClear$1;function isKeyable$1(o){var i=typeof o;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?o!=="__proto__":o===null}var _isKeyable=isKeyable$1,isKeyable=_isKeyable;function getMapData$4(o,i){var _=o.__data__;return isKeyable(i)?_[typeof i=="string"?"string":"hash"]:_.map}var _getMapData=getMapData$4,getMapData$3=_getMapData;function mapCacheDelete$1(o){var i=getMapData$3(this,o).delete(o);return this.size-=i?1:0,i}var _mapCacheDelete=mapCacheDelete$1,getMapData$2=_getMapData;function mapCacheGet$1(o){return getMapData$2(this,o).get(o)}var _mapCacheGet=mapCacheGet$1,getMapData$1=_getMapData;function mapCacheHas$1(o){return getMapData$1(this,o).has(o)}var _mapCacheHas=mapCacheHas$1,getMapData=_getMapData;function mapCacheSet$1(o,i){var _=getMapData(this,o),$=_.size;return _.set(o,i),this.size+=_.size==$?0:1,this}var _mapCacheSet=mapCacheSet$1,mapCacheClear=_mapCacheClear,mapCacheDelete=_mapCacheDelete,mapCacheGet=_mapCacheGet,mapCacheHas=_mapCacheHas,mapCacheSet=_mapCacheSet;function MapCache$3(o){var i=-1,_=o==null?0:o.length;for(this.clear();++i<_;){var $=o[i];this.set($[0],$[1])}}MapCache$3.prototype.clear=mapCacheClear;MapCache$3.prototype.delete=mapCacheDelete;MapCache$3.prototype.get=mapCacheGet;MapCache$3.prototype.has=mapCacheHas;MapCache$3.prototype.set=mapCacheSet;var _MapCache=MapCache$3,MapCache$2=_MapCache,FUNC_ERROR_TEXT$2="Expected a function";function memoize$2(o,i){if(typeof o!="function"||i!=null&&typeof i!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var _=function(){var $=arguments,j=i?i.apply(this,$):$[0],_e=_.cache;if(_e.has(j))return _e.get(j);var et=o.apply(this,$);return _.cache=_e.set(j,et)||_e,et};return _.cache=new(memoize$2.Cache||MapCache$2),_}memoize$2.Cache=MapCache$2;var memoize_1=memoize$2;const memoize$3=getDefaultExportFromCjs$1(memoize_1);var memoize$1=memoize_1,MAX_MEMOIZE_SIZE=500;function memoizeCapped$1(o){var i=memoize$1(o,function($){return _.size===MAX_MEMOIZE_SIZE&&_.clear(),$}),_=i.cache;return i}var _memoizeCapped=memoizeCapped$1,memoizeCapped=_memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath$1=memoizeCapped(function(o){var i=[];return o.charCodeAt(0)===46&&i.push(""),o.replace(rePropName,function(_,$,j,_e){i.push(j?_e.replace(reEscapeChar,"$1"):$||_)}),i}),_stringToPath=stringToPath$1;function arrayMap$3(o,i){for(var _=-1,$=o==null?0:o.length,j=Array($);++_<$;)j[_]=i(o[_],_,o);return j}var _arrayMap=arrayMap$3,Symbol$4=_Symbol,arrayMap$2=_arrayMap,isArray$d=isArray_1,isSymbol$4=isSymbol_1,symbolProto$1=Symbol$4?Symbol$4.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString$1(o){if(typeof o=="string")return o;if(isArray$d(o))return arrayMap$2(o,baseToString$1)+"";if(isSymbol$4(o))return symbolToString?symbolToString.call(o):"";var i=o+"";return i=="0"&&1/o==-1/0?"-0":i}var _baseToString=baseToString$1,baseToString=_baseToString;function toString$3(o){return o==null?"":baseToString(o)}var toString_1=toString$3,isArray$c=isArray_1,isKey$2=_isKey,stringToPath=_stringToPath,toString$2=toString_1;function castPath$2(o,i){return isArray$c(o)?o:isKey$2(o,i)?[o]:stringToPath(toString$2(o))}var _castPath=castPath$2,isSymbol$3=isSymbol_1;function toKey$4(o){if(typeof o=="string"||isSymbol$3(o))return o;var i=o+"";return i=="0"&&1/o==-1/0?"-0":i}var _toKey=toKey$4,castPath$1=_castPath,toKey$3=_toKey;function baseGet$3(o,i){i=castPath$1(i,o);for(var _=0,$=i.length;o!=null&&_<$;)o=o[toKey$3(i[_++])];return _&&_==$?o:void 0}var _baseGet=baseGet$3,baseGet$2=_baseGet;function get$3(o,i,_){var $=o==null?void 0:baseGet$2(o,i);return $===void 0?_:$}var get_1=get$3;const get$4=getDefaultExportFromCjs$1(get_1);function isNil(o){return o==null}var isNil_1=isNil;const isNil$1=getDefaultExportFromCjs$1(isNil_1);var baseGetTag$6=_baseGetTag,isArray$b=isArray_1,isObjectLike$7=isObjectLike_1,stringTag$2="[object String]";function isString$2(o){return typeof o=="string"||!isArray$b(o)&&isObjectLike$7(o)&&baseGetTag$6(o)==stringTag$2}var isString_1=isString$2;const isString$3=getDefaultExportFromCjs$1(isString_1);var reactIs={exports:{}},reactIs_production_min={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=Symbol.for("react.element"),c$1=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),e=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),h=Symbol.for("react.context"),k$1=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),n=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),t=Symbol.for("react.offscreen"),u;u=Symbol.for("react.module.reference");function v(o){if(typeof o=="object"&&o!==null){var i=o.$$typeof;switch(i){case b:switch(o=o.type,o){case d:case f:case e:case m:case n:return o;default:switch(o=o&&o.$$typeof,o){case k$1:case h:case l:case q:case p:case g:return o;default:return i}}case c$1:return i}}}reactIs_production_min.ContextConsumer=h;reactIs_production_min.ContextProvider=g;reactIs_production_min.Element=b;reactIs_production_min.ForwardRef=l;reactIs_production_min.Fragment=d;reactIs_production_min.Lazy=q;reactIs_production_min.Memo=p;reactIs_production_min.Portal=c$1;reactIs_production_min.Profiler=f;reactIs_production_min.StrictMode=e;reactIs_production_min.Suspense=m;reactIs_production_min.SuspenseList=n;reactIs_production_min.isAsyncMode=function(){return!1};reactIs_production_min.isConcurrentMode=function(){return!1};reactIs_production_min.isContextConsumer=function(o){return v(o)===h};reactIs_production_min.isContextProvider=function(o){return v(o)===g};reactIs_production_min.isElement=function(o){return typeof o=="object"&&o!==null&&o.$$typeof===b};reactIs_production_min.isForwardRef=function(o){return v(o)===l};reactIs_production_min.isFragment=function(o){return v(o)===d};reactIs_production_min.isLazy=function(o){return v(o)===q};reactIs_production_min.isMemo=function(o){return v(o)===p};reactIs_production_min.isPortal=function(o){return v(o)===c$1};reactIs_production_min.isProfiler=function(o){return v(o)===f};reactIs_production_min.isStrictMode=function(o){return v(o)===e};reactIs_production_min.isSuspense=function(o){return v(o)===m};reactIs_production_min.isSuspenseList=function(o){return v(o)===n};reactIs_production_min.isValidElementType=function(o){return typeof o=="string"||typeof o=="function"||o===d||o===f||o===e||o===m||o===n||o===t||typeof o=="object"&&o!==null&&(o.$$typeof===q||o.$$typeof===p||o.$$typeof===g||o.$$typeof===h||o.$$typeof===l||o.$$typeof===u||o.getModuleId!==void 0)};reactIs_production_min.typeOf=v;reactIs.exports=reactIs_production_min;var reactIsExports=reactIs.exports,baseGetTag$5=_baseGetTag,isObjectLike$6=isObjectLike_1,numberTag$2="[object Number]";function isNumber$2(o){return typeof o=="number"||isObjectLike$6(o)&&baseGetTag$5(o)==numberTag$2}var isNumber_1=isNumber$2;const isNumber$3=getDefaultExportFromCjs$1(isNumber_1);var isNumber$1=isNumber_1;function isNaN$1(o){return isNumber$1(o)&&o!=+o}var _isNaN=isNaN$1;const isNan=getDefaultExportFromCjs$1(_isNaN);var mathSign=function o(i){return i===0?0:i>0?1:-1},isPercent=function o(i){return isString$3(i)&&i.indexOf("%")===i.length-1},isNumber=function o(i){return isNumber$3(i)&&!isNan(i)},isNumOrStr=function o(i){return isNumber(i)||isString$3(i)},idCounter=0,uniqueId=function o(i){var _=++idCounter;return"".concat(i||"").concat(_)},getPercentValue=function o(i,_){var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!isNumber(i)&&!isString$3(i))return $;var _e;if(isPercent(i)){var et=i.indexOf("%");_e=_*parseFloat(i.slice(0,et))/100}else _e=+i;return isNan(_e)&&(_e=$),j&&_e>_&&(_e=_),_e},getAnyElementOfObject=function o(i){if(!i)return null;var _=Object.keys(i);return _&&_.length?i[_[0]]:null},hasDuplicate=function o(i){if(!Array.isArray(i))return!1;for(var _=i.length,$={},j=0;j<_;j++)if(!$[i[j]])$[i[j]]=!0;else return!0;return!1},interpolateNumber$2=function o(i,_){return isNumber(i)&&isNumber(_)?function($){return i+$*(_-i)}:function(){return _}};function findEntryInArray(o,i,_){return!o||!o.length?null:o.find(function($){return $&&(typeof i=="function"?i($):get$4($,i))===_})}var compareValues=function o(i,_){return isNumber(i)&&isNumber(_)?i-_:isString$3(i)&&isString$3(_)?i.localeCompare(_):i instanceof Date&&_ instanceof Date?i.getTime()-_.getTime():String(i).localeCompare(String(_))};function shallowEqual(o,i){for(var _ in o)if({}.hasOwnProperty.call(o,_)&&(!{}.hasOwnProperty.call(i,_)||o[_]!==i[_]))return!1;for(var $ in i)if({}.hasOwnProperty.call(i,$)&&!{}.hasOwnProperty.call(o,$))return!1;return!0}function _typeof$K(o){"@babel/helpers - typeof";return _typeof$K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$K(o)}var SVGContainerPropKeys=["viewBox","children"],SVGElementPropKeys=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],PolyElementKeys=["points","pathLength"],FilteredElementKeyMap={svg:SVGContainerPropKeys,polygon:PolyElementKeys,polyline:PolyElementKeys},EventKeys=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],adaptEventHandlers=function o(i,_){if(!i||typeof i=="function"||typeof i=="boolean")return null;var $=i;if(reactExports.isValidElement(i)&&($=i.props),!isObject$8($))return null;var j={};return Object.keys($).forEach(function(_e){EventKeys.includes(_e)&&(j[_e]=_||function(et){return $[_e]($,et)})}),j},getEventHandlerOfChild=function o(i,_,$){return function(j){return i(_,$,j),null}},adaptEventsOfChild=function o(i,_,$){if(!isObject$8(i)||_typeof$K(i)!=="object")return null;var j=null;return Object.keys(i).forEach(function(_e){var et=i[_e];EventKeys.includes(_e)&&typeof et=="function"&&(j||(j={}),j[_e]=getEventHandlerOfChild(et,_,$))}),j},_excluded$i=["children"],_excluded2$6=["children"];function _objectWithoutProperties$i(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$i(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$i(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _typeof$J(o){"@babel/helpers - typeof";return _typeof$J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$J(o)}var REACT_BROWSER_EVENT_MAP={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},getDisplayName=function o(i){return typeof i=="string"?i:i?i.displayName||i.name||"Component":""},lastChildren=null,lastResult=null,toArray$1=function o(i){if(i===lastChildren&&Array.isArray(lastResult))return lastResult;var _=[];return reactExports.Children.forEach(i,function($){isNil$1($)||(reactIsExports.isFragment($)?_=_.concat(o($.props.children)):_.push($))}),lastResult=_,lastChildren=i,_};function findAllByType(o,i){var _=[],$=[];return Array.isArray(i)?$=i.map(function(j){return getDisplayName(j)}):$=[getDisplayName(i)],toArray$1(o).forEach(function(j){var _e=get$4(j,"type.displayName")||get$4(j,"type.name");$.indexOf(_e)!==-1&&_.push(j)}),_}function findChildByType(o,i){var _=findAllByType(o,i);return _&&_[0]}var validateWidthHeight=function o(i){if(!i||!i.props)return!1;var _=i.props,$=_.width,j=_.height;return!(!isNumber($)||$<=0||!isNumber(j)||j<=0)},SVG_TAGS=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],isSvgElement=function o(i){return i&&i.type&&isString$3(i.type)&&SVG_TAGS.indexOf(i.type)>=0},hasClipDot=function o(i){return i&&_typeof$J(i)==="object"&&"clipDot"in i},isValidSpreadableProp=function o(i,_,$,j){var _e,et=(_e=FilteredElementKeyMap==null?void 0:FilteredElementKeyMap[j])!==null&&_e!==void 0?_e:[];return _.startsWith("data-")||!isFunction$3(i)&&(j&&et.includes(_)||SVGElementPropKeys.includes(_))||$&&EventKeys.includes(_)},filterProps=function o(i,_,$){if(!i||typeof i=="function"||typeof i=="boolean")return null;var j=i;if(reactExports.isValidElement(i)&&(j=i.props),!isObject$8(j))return null;var _e={};return Object.keys(j).forEach(function(et){var tt;isValidSpreadableProp((tt=j)===null||tt===void 0?void 0:tt[et],et,_,$)&&(_e[et]=j[et])}),_e},isChildrenEqual=function o(i,_){if(i===_)return!0;var $=reactExports.Children.count(i);if($!==reactExports.Children.count(_))return!1;if($===0)return!0;if($===1)return isSingleChildEqual(Array.isArray(i)?i[0]:i,Array.isArray(_)?_[0]:_);for(var j=0;j<$;j++){var _e=i[j],et=_[j];if(Array.isArray(_e)||Array.isArray(et)){if(!o(_e,et))return!1}else if(!isSingleChildEqual(_e,et))return!1}return!0},isSingleChildEqual=function o(i,_){if(isNil$1(i)&&isNil$1(_))return!0;if(!isNil$1(i)&&!isNil$1(_)){var $=i.props||{},j=$.children,_e=_objectWithoutProperties$i($,_excluded$i),et=_.props||{},tt=et.children,rt=_objectWithoutProperties$i(et,_excluded2$6);return j&&tt?shallowEqual(_e,rt)&&isChildrenEqual(j,tt):!j&&!tt?shallowEqual(_e,rt):!1}return!1},renderByOrder=function o(i,_){var $=[],j={};return toArray$1(i).forEach(function(_e,et){if(isSvgElement(_e))$.push(_e);else if(_e){var tt=getDisplayName(_e.type),rt=_[tt]||{},nt=rt.handler,it=rt.once;if(nt&&(!it||!j[tt])){var st=nt(_e,tt,et);$.push(st),j[tt]=!0}}}),$},getReactEventByType=function o(i){var _=i&&i.type;return _&&REACT_BROWSER_EVENT_MAP[_]?REACT_BROWSER_EVENT_MAP[_]:null},parseChildIndex=function o(i,_){return toArray$1(_).indexOf(i)},_excluded$h=["children","width","height","viewBox","className","style","title","desc"];function _extends$u(){return _extends$u=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$u.apply(this,arguments)}function _objectWithoutProperties$h(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$h(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$h(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function Surface(o){var i=o.children,_=o.width,$=o.height,j=o.viewBox,_e=o.className,et=o.style,tt=o.title,rt=o.desc,nt=_objectWithoutProperties$h(o,_excluded$h),it=j||{width:_,height:$,x:0,y:0},st=clsx("recharts-surface",_e);return React$2.createElement("svg",_extends$u({},filterProps(nt,!0,"svg"),{className:st,width:_,height:$,style:et,viewBox:"".concat(it.x," ").concat(it.y," ").concat(it.width," ").concat(it.height)}),React$2.createElement("title",null,tt),React$2.createElement("desc",null,rt),i)}var _excluded$g=["children","className"];function _extends$t(){return _extends$t=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$t.apply(this,arguments)}function _objectWithoutProperties$g(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$g(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$g(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}var Layer=React$2.forwardRef(function(o,i){var _=o.children,$=o.className,j=_objectWithoutProperties$g(o,_excluded$g),_e=clsx("recharts-layer",$);return React$2.createElement("g",_extends$t({className:_e},filterProps(j,!0),{ref:i}),_)}),warn=function o(i,_){for(var $=arguments.length,j=new Array($>2?$-2:0),_e=2;_e<$;_e++)j[_e-2]=arguments[_e]};function baseSlice$1(o,i,_){var $=-1,j=o.length;i<0&&(i=-i>j?0:j+i),_=_>j?j:_,_<0&&(_+=j),j=i>_?0:_-i>>>0,i>>>=0;for(var _e=Array(j);++$<j;)_e[$]=o[$+i];return _e}var _baseSlice=baseSlice$1,baseSlice=_baseSlice;function castSlice$1(o,i,_){var $=o.length;return _=_===void 0?$:_,!i&&_>=$?o:baseSlice(o,i,_)}var _castSlice=castSlice$1,rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsVarRange$1="\\ufe0e\\ufe0f",rsZWJ$1="\\u200d",reHasUnicode=RegExp("["+rsZWJ$1+rsAstralRange$1+rsComboRange$1+rsVarRange$1+"]");function hasUnicode$2(o){return reHasUnicode.test(o)}var _hasUnicode=hasUnicode$2;function asciiToArray$1(o){return o.split("")}var _asciiToArray=asciiToArray$1,rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange+"]",rsCombo="["+rsComboRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeToArray$1(o){return o.match(reUnicode)||[]}var _unicodeToArray=unicodeToArray$1,asciiToArray=_asciiToArray,hasUnicode$1=_hasUnicode,unicodeToArray=_unicodeToArray;function stringToArray$1(o){return hasUnicode$1(o)?unicodeToArray(o):asciiToArray(o)}var _stringToArray=stringToArray$1,castSlice=_castSlice,hasUnicode=_hasUnicode,stringToArray=_stringToArray,toString$1=toString_1;function createCaseFirst$1(o){return function(i){i=toString$1(i);var _=hasUnicode(i)?stringToArray(i):void 0,$=_?_[0]:i.charAt(0),j=_?castSlice(_,1).join(""):i.slice(1);return $[o]()+j}}var _createCaseFirst=createCaseFirst$1,createCaseFirst=_createCaseFirst,upperFirst=createCaseFirst("toUpperCase"),upperFirst_1=upperFirst;const upperFirst$1=getDefaultExportFromCjs$1(upperFirst_1);function constant$3(o){return function(){return o}}const cos=Math.cos,sin=Math.sin,sqrt$1=Math.sqrt,pi$1=Math.PI,tau$1=2*pi$1,pi=Math.PI,tau=2*pi,epsilon=1e-6,tauEpsilon=tau-epsilon;function append(o){this._+=o[0];for(let i=1,_=o.length;i<_;++i)this._+=arguments[i]+o[i]}function appendRound(o){let i=Math.floor(o);if(!(i>=0))throw new Error(`invalid digits: ${o}`);if(i>15)return append;const _=10**i;return function($){this._+=$[0];for(let j=1,_e=$.length;j<_e;++j)this._+=Math.round(arguments[j]*_)/_+$[j]}}class Path{constructor(i){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=i==null?append:appendRound(i)}moveTo(i,_){this._append`M${this._x0=this._x1=+i},${this._y0=this._y1=+_}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(i,_){this._append`L${this._x1=+i},${this._y1=+_}`}quadraticCurveTo(i,_,$,j){this._append`Q${+i},${+_},${this._x1=+$},${this._y1=+j}`}bezierCurveTo(i,_,$,j,_e,et){this._append`C${+i},${+_},${+$},${+j},${this._x1=+_e},${this._y1=+et}`}arcTo(i,_,$,j,_e){if(i=+i,_=+_,$=+$,j=+j,_e=+_e,_e<0)throw new Error(`negative radius: ${_e}`);let et=this._x1,tt=this._y1,rt=$-i,nt=j-_,it=et-i,st=tt-_,at=it*it+st*st;if(this._x1===null)this._append`M${this._x1=i},${this._y1=_}`;else if(at>epsilon)if(!(Math.abs(st*rt-nt*it)>epsilon)||!_e)this._append`L${this._x1=i},${this._y1=_}`;else{let ot=$-et,lt=j-tt,ct=rt*rt+nt*nt,ft=ot*ot+lt*lt,ut=Math.sqrt(ct),ht=Math.sqrt(at),dt=_e*Math.tan((pi-Math.acos((ct+at-ft)/(2*ut*ht)))/2),mt=dt/ht,pt=dt/ut;Math.abs(mt-1)>epsilon&&this._append`L${i+mt*it},${_+mt*st}`,this._append`A${_e},${_e},0,0,${+(st*ot>it*lt)},${this._x1=i+pt*rt},${this._y1=_+pt*nt}`}}arc(i,_,$,j,_e,et){if(i=+i,_=+_,$=+$,et=!!et,$<0)throw new Error(`negative radius: ${$}`);let tt=$*Math.cos(j),rt=$*Math.sin(j),nt=i+tt,it=_+rt,st=1^et,at=et?j-_e:_e-j;this._x1===null?this._append`M${nt},${it}`:(Math.abs(this._x1-nt)>epsilon||Math.abs(this._y1-it)>epsilon)&&this._append`L${nt},${it}`,$&&(at<0&&(at=at%tau+tau),at>tauEpsilon?this._append`A${$},${$},0,1,${st},${i-tt},${_-rt}A${$},${$},0,1,${st},${this._x1=nt},${this._y1=it}`:at>epsilon&&this._append`A${$},${$},0,${+(at>=pi)},${st},${this._x1=i+$*Math.cos(_e)},${this._y1=_+$*Math.sin(_e)}`)}rect(i,_,$,j){this._append`M${this._x0=this._x1=+i},${this._y0=this._y1=+_}h${$=+$}v${+j}h${-$}Z`}toString(){return this._}}function withPath(o){let i=3;return o.digits=function(_){if(!arguments.length)return i;if(_==null)i=null;else{const $=Math.floor(_);if(!($>=0))throw new RangeError(`invalid digits: ${_}`);i=$}return o},()=>new Path(i)}function array(o){return typeof o=="object"&&"length"in o?o:Array.from(o)}function Linear(o){this._context=o}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(o,i){switch(o=+o,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(o,i):this._context.moveTo(o,i);break;case 1:this._point=2;default:this._context.lineTo(o,i);break}}};function curveLinear(o){return new Linear(o)}function x(o){return o[0]}function y(o){return o[1]}function shapeLine(o,i){var _=constant$3(!0),$=null,j=curveLinear,_e=null,et=withPath(tt);o=typeof o=="function"?o:o===void 0?x:constant$3(o),i=typeof i=="function"?i:i===void 0?y:constant$3(i);function tt(rt){var nt,it=(rt=array(rt)).length,st,at=!1,ot;for($==null&&(_e=j(ot=et())),nt=0;nt<=it;++nt)!(nt<it&&_(st=rt[nt],nt,rt))===at&&((at=!at)?_e.lineStart():_e.lineEnd()),at&&_e.point(+o(st,nt,rt),+i(st,nt,rt));if(ot)return _e=null,ot+""||null}return tt.x=function(rt){return arguments.length?(o=typeof rt=="function"?rt:constant$3(+rt),tt):o},tt.y=function(rt){return arguments.length?(i=typeof rt=="function"?rt:constant$3(+rt),tt):i},tt.defined=function(rt){return arguments.length?(_=typeof rt=="function"?rt:constant$3(!!rt),tt):_},tt.curve=function(rt){return arguments.length?(j=rt,$!=null&&(_e=j($)),tt):j},tt.context=function(rt){return arguments.length?(rt==null?$=_e=null:_e=j($=rt),tt):$},tt}function shapeArea(o,i,_){var $=null,j=constant$3(!0),_e=null,et=curveLinear,tt=null,rt=withPath(nt);o=typeof o=="function"?o:o===void 0?x:constant$3(+o),i=typeof i=="function"?i:constant$3(i===void 0?0:+i),_=typeof _=="function"?_:_===void 0?y:constant$3(+_);function nt(st){var at,ot,lt,ct=(st=array(st)).length,ft,ut=!1,ht,dt=new Array(ct),mt=new Array(ct);for(_e==null&&(tt=et(ht=rt())),at=0;at<=ct;++at){if(!(at<ct&&j(ft=st[at],at,st))===ut)if(ut=!ut)ot=at,tt.areaStart(),tt.lineStart();else{for(tt.lineEnd(),tt.lineStart(),lt=at-1;lt>=ot;--lt)tt.point(dt[lt],mt[lt]);tt.lineEnd(),tt.areaEnd()}ut&&(dt[at]=+o(ft,at,st),mt[at]=+i(ft,at,st),tt.point($?+$(ft,at,st):dt[at],_?+_(ft,at,st):mt[at]))}if(ht)return tt=null,ht+""||null}function it(){return shapeLine().defined(j).curve(et).context(_e)}return nt.x=function(st){return arguments.length?(o=typeof st=="function"?st:constant$3(+st),$=null,nt):o},nt.x0=function(st){return arguments.length?(o=typeof st=="function"?st:constant$3(+st),nt):o},nt.x1=function(st){return arguments.length?($=st==null?null:typeof st=="function"?st:constant$3(+st),nt):$},nt.y=function(st){return arguments.length?(i=typeof st=="function"?st:constant$3(+st),_=null,nt):i},nt.y0=function(st){return arguments.length?(i=typeof st=="function"?st:constant$3(+st),nt):i},nt.y1=function(st){return arguments.length?(_=st==null?null:typeof st=="function"?st:constant$3(+st),nt):_},nt.lineX0=nt.lineY0=function(){return it().x(o).y(i)},nt.lineY1=function(){return it().x(o).y(_)},nt.lineX1=function(){return it().x($).y(i)},nt.defined=function(st){return arguments.length?(j=typeof st=="function"?st:constant$3(!!st),nt):j},nt.curve=function(st){return arguments.length?(et=st,_e!=null&&(tt=et(_e)),nt):et},nt.context=function(st){return arguments.length?(st==null?_e=tt=null:tt=et(_e=st),nt):_e},nt}class Bump{constructor(i,_){this._context=i,this._x=_}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(i,_){switch(i=+i,_=+_,this._point){case 0:{this._point=1,this._line?this._context.lineTo(i,_):this._context.moveTo(i,_);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+i)/2,this._y0,this._x0,_,i,_):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+_)/2,i,this._y0,i,_);break}}this._x0=i,this._y0=_}}function bumpX(o){return new Bump(o,!0)}function bumpY(o){return new Bump(o,!1)}const symbolCircle={draw(o,i){const _=sqrt$1(i/pi$1);o.moveTo(_,0),o.arc(0,0,_,0,tau$1)}},symbolCross={draw(o,i){const _=sqrt$1(i/5)/2;o.moveTo(-3*_,-_),o.lineTo(-_,-_),o.lineTo(-_,-3*_),o.lineTo(_,-3*_),o.lineTo(_,-_),o.lineTo(3*_,-_),o.lineTo(3*_,_),o.lineTo(_,_),o.lineTo(_,3*_),o.lineTo(-_,3*_),o.lineTo(-_,_),o.lineTo(-3*_,_),o.closePath()}},tan30=sqrt$1(1/3),tan30_2=tan30*2,symbolDiamond={draw(o,i){const _=sqrt$1(i/tan30_2),$=_*tan30;o.moveTo(0,-_),o.lineTo($,0),o.lineTo(0,_),o.lineTo(-$,0),o.closePath()}},symbolSquare={draw(o,i){const _=sqrt$1(i),$=-_/2;o.rect($,$,_,_)}},ka=.8908130915292852,kr=sin(pi$1/10)/sin(7*pi$1/10),kx=sin(tau$1/10)*kr,ky=-cos(tau$1/10)*kr,symbolStar={draw(o,i){const _=sqrt$1(i*ka),$=kx*_,j=ky*_;o.moveTo(0,-_),o.lineTo($,j);for(let _e=1;_e<5;++_e){const et=tau$1*_e/5,tt=cos(et),rt=sin(et);o.lineTo(rt*_,-tt*_),o.lineTo(tt*$-rt*j,rt*$+tt*j)}o.closePath()}},sqrt3=sqrt$1(3),symbolTriangle={draw(o,i){const _=-sqrt$1(i/(sqrt3*3));o.moveTo(0,_*2),o.lineTo(-sqrt3*_,-_),o.lineTo(sqrt3*_,-_),o.closePath()}},c=-.5,s=sqrt$1(3)/2,k=1/sqrt$1(12),a=(k/2+1)*3,symbolWye={draw(o,i){const _=sqrt$1(i/a),$=_/2,j=_*k,_e=$,et=_*k+_,tt=-_e,rt=et;o.moveTo($,j),o.lineTo(_e,et),o.lineTo(tt,rt),o.lineTo(c*$-s*j,s*$+c*j),o.lineTo(c*_e-s*et,s*_e+c*et),o.lineTo(c*tt-s*rt,s*tt+c*rt),o.lineTo(c*$+s*j,c*j-s*$),o.lineTo(c*_e+s*et,c*et-s*_e),o.lineTo(c*tt+s*rt,c*rt-s*tt),o.closePath()}};function Symbol$3(o,i){let _=null,$=withPath(j);o=typeof o=="function"?o:constant$3(o||symbolCircle),i=typeof i=="function"?i:constant$3(i===void 0?64:+i);function j(){let _e;if(_||(_=_e=$()),o.apply(this,arguments).draw(_,+i.apply(this,arguments)),_e)return _=null,_e+""||null}return j.type=function(_e){return arguments.length?(o=typeof _e=="function"?_e:constant$3(_e),j):o},j.size=function(_e){return arguments.length?(i=typeof _e=="function"?_e:constant$3(+_e),j):i},j.context=function(_e){return arguments.length?(_=_e??null,j):_},j}function noop$6(){}function point$2(o,i,_){o._context.bezierCurveTo((2*o._x0+o._x1)/3,(2*o._y0+o._y1)/3,(o._x0+2*o._x1)/3,(o._y0+2*o._y1)/3,(o._x0+4*o._x1+i)/6,(o._y0+4*o._y1+_)/6)}function Basis(o){this._context=o}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(o,i){switch(o=+o,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(o,i):this._context.moveTo(o,i);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$2(this,o,i);break}this._x0=this._x1,this._x1=o,this._y0=this._y1,this._y1=i}};function curveBasis(o){return new Basis(o)}function BasisClosed(o){this._context=o}BasisClosed.prototype={areaStart:noop$6,areaEnd:noop$6,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(o,i){switch(o=+o,i=+i,this._point){case 0:this._point=1,this._x2=o,this._y2=i;break;case 1:this._point=2,this._x3=o,this._y3=i;break;case 2:this._point=3,this._x4=o,this._y4=i,this._context.moveTo((this._x0+4*this._x1+o)/6,(this._y0+4*this._y1+i)/6);break;default:point$2(this,o,i);break}this._x0=this._x1,this._x1=o,this._y0=this._y1,this._y1=i}};function curveBasisClosed(o){return new BasisClosed(o)}function BasisOpen(o){this._context=o}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(o,i){switch(o=+o,i=+i,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var _=(this._x0+4*this._x1+o)/6,$=(this._y0+4*this._y1+i)/6;this._line?this._context.lineTo(_,$):this._context.moveTo(_,$);break;case 3:this._point=4;default:point$2(this,o,i);break}this._x0=this._x1,this._x1=o,this._y0=this._y1,this._y1=i}};function curveBasisOpen(o){return new BasisOpen(o)}function LinearClosed(o){this._context=o}LinearClosed.prototype={areaStart:noop$6,areaEnd:noop$6,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(o,i){o=+o,i=+i,this._point?this._context.lineTo(o,i):(this._point=1,this._context.moveTo(o,i))}};function curveLinearClosed(o){return new LinearClosed(o)}function sign(o){return o<0?-1:1}function slope3(o,i,_){var $=o._x1-o._x0,j=i-o._x1,_e=(o._y1-o._y0)/($||j<0&&-0),et=(_-o._y1)/(j||$<0&&-0),tt=(_e*j+et*$)/($+j);return(sign(_e)+sign(et))*Math.min(Math.abs(_e),Math.abs(et),.5*Math.abs(tt))||0}function slope2(o,i){var _=o._x1-o._x0;return _?(3*(o._y1-o._y0)/_-i)/2:i}function point$1(o,i,_){var $=o._x0,j=o._y0,_e=o._x1,et=o._y1,tt=(_e-$)/3;o._context.bezierCurveTo($+tt,j+tt*i,_e-tt,et-tt*_,_e,et)}function MonotoneX(o){this._context=o}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$1(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(o,i){var _=NaN;if(o=+o,i=+i,!(o===this._x1&&i===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(o,i):this._context.moveTo(o,i);break;case 1:this._point=2;break;case 2:this._point=3,point$1(this,slope2(this,_=slope3(this,o,i)),_);break;default:point$1(this,this._t0,_=slope3(this,o,i));break}this._x0=this._x1,this._x1=o,this._y0=this._y1,this._y1=i,this._t0=_}}};function MonotoneY(o){this._context=new ReflectContext(o)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(o,i){MonotoneX.prototype.point.call(this,i,o)};function ReflectContext(o){this._context=o}ReflectContext.prototype={moveTo:function(o,i){this._context.moveTo(i,o)},closePath:function(){this._context.closePath()},lineTo:function(o,i){this._context.lineTo(i,o)},bezierCurveTo:function(o,i,_,$,j,_e){this._context.bezierCurveTo(i,o,$,_,_e,j)}};function monotoneX(o){return new MonotoneX(o)}function monotoneY(o){return new MonotoneY(o)}function Natural(o){this._context=o}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var o=this._x,i=this._y,_=o.length;if(_)if(this._line?this._context.lineTo(o[0],i[0]):this._context.moveTo(o[0],i[0]),_===2)this._context.lineTo(o[1],i[1]);else for(var $=controlPoints(o),j=controlPoints(i),_e=0,et=1;et<_;++_e,++et)this._context.bezierCurveTo($[0][_e],j[0][_e],$[1][_e],j[1][_e],o[et],i[et]);(this._line||this._line!==0&&_===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(o,i){this._x.push(+o),this._y.push(+i)}};function controlPoints(o){var i,_=o.length-1,$,j=new Array(_),_e=new Array(_),et=new Array(_);for(j[0]=0,_e[0]=2,et[0]=o[0]+2*o[1],i=1;i<_-1;++i)j[i]=1,_e[i]=4,et[i]=4*o[i]+2*o[i+1];for(j[_-1]=2,_e[_-1]=7,et[_-1]=8*o[_-1]+o[_],i=1;i<_;++i)$=j[i]/_e[i-1],_e[i]-=$,et[i]-=$*et[i-1];for(j[_-1]=et[_-1]/_e[_-1],i=_-2;i>=0;--i)j[i]=(et[i]-j[i+1])/_e[i];for(_e[_-1]=(o[_]+j[_-1])/2,i=0;i<_-1;++i)_e[i]=2*o[i+1]-j[i+1];return[j,_e]}function curveNatural(o){return new Natural(o)}function Step(o,i){this._context=o,this._t=i}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(o,i){switch(o=+o,i=+i,this._point){case 0:this._point=1,this._line?this._context.lineTo(o,i):this._context.moveTo(o,i);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,i),this._context.lineTo(o,i);else{var _=this._x*(1-this._t)+o*this._t;this._context.lineTo(_,this._y),this._context.lineTo(_,i)}break}}this._x=o,this._y=i}};function curveStep(o){return new Step(o,.5)}function stepBefore(o){return new Step(o,0)}function stepAfter(o){return new Step(o,1)}function stackOffsetNone(o,i){if((et=o.length)>1)for(var _=1,$,j,_e=o[i[0]],et,tt=_e.length;_<et;++_)for(j=_e,_e=o[i[_]],$=0;$<tt;++$)_e[$][1]+=_e[$][0]=isNaN(j[$][1])?j[$][0]:j[$][1]}function stackOrderNone(o){for(var i=o.length,_=new Array(i);--i>=0;)_[i]=i;return _}function stackValue(o,i){return o[i]}function stackSeries(o){const i=[];return i.key=o,i}function shapeStack(){var o=constant$3([]),i=stackOrderNone,_=stackOffsetNone,$=stackValue;function j(_e){var et=Array.from(o.apply(this,arguments),stackSeries),tt,rt=et.length,nt=-1,it;for(const st of _e)for(tt=0,++nt;tt<rt;++tt)(et[tt][nt]=[0,+$(st,et[tt].key,nt,_e)]).data=st;for(tt=0,it=array(i(et));tt<rt;++tt)et[it[tt]].index=tt;return _(et,it),et}return j.keys=function(_e){return arguments.length?(o=typeof _e=="function"?_e:constant$3(Array.from(_e)),j):o},j.value=function(_e){return arguments.length?($=typeof _e=="function"?_e:constant$3(+_e),j):$},j.order=function(_e){return arguments.length?(i=_e==null?stackOrderNone:typeof _e=="function"?_e:constant$3(Array.from(_e)),j):i},j.offset=function(_e){return arguments.length?(_=_e??stackOffsetNone,j):_},j}function stackOffsetExpand(o,i){if(($=o.length)>0){for(var _,$,j=0,_e=o[0].length,et;j<_e;++j){for(et=_=0;_<$;++_)et+=o[_][j][1]||0;if(et)for(_=0;_<$;++_)o[_][j][1]/=et}stackOffsetNone(o,i)}}function stackOffsetSilhouette(o,i){if((j=o.length)>0){for(var _=0,$=o[i[0]],j,_e=$.length;_<_e;++_){for(var et=0,tt=0;et<j;++et)tt+=o[et][_][1]||0;$[_][1]+=$[_][0]=-tt/2}stackOffsetNone(o,i)}}function stackOffsetWiggle(o,i){if(!(!((et=o.length)>0)||!((_e=(j=o[i[0]]).length)>0))){for(var _=0,$=1,j,_e,et;$<_e;++$){for(var tt=0,rt=0,nt=0;tt<et;++tt){for(var it=o[i[tt]],st=it[$][1]||0,at=it[$-1][1]||0,ot=(st-at)/2,lt=0;lt<tt;++lt){var ct=o[i[lt]],ft=ct[$][1]||0,ut=ct[$-1][1]||0;ot+=ft-ut}rt+=st,nt+=ot*st}j[$-1][1]+=j[$-1][0]=_,rt&&(_-=nt/rt)}j[$-1][1]+=j[$-1][0]=_,stackOffsetNone(o,i)}}function _typeof$I(o){"@babel/helpers - typeof";return _typeof$I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$I(o)}var _excluded$f=["type","size","sizeType"];function _extends$s(){return _extends$s=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$s.apply(this,arguments)}function ownKeys$C(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$B(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$C(Object(_),!0).forEach(function($){_defineProperty$I(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$C(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$I(o,i,_){return i=_toPropertyKey$I(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$I(o){var i=_toPrimitive$I(o,"string");return _typeof$I(i)=="symbol"?i:i+""}function _toPrimitive$I(o,i){if(_typeof$I(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$I($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _objectWithoutProperties$f(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$f(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$f(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}var symbolFactories={symbolCircle,symbolCross,symbolDiamond,symbolSquare,symbolStar,symbolTriangle,symbolWye},RADIAN$2=Math.PI/180,getSymbolFactory=function o(i){var _="symbol".concat(upperFirst$1(i));return symbolFactories[_]||symbolCircle},calculateAreaSize=function o(i,_,$){if(_==="area")return i;switch($){case"cross":return 5*i*i/9;case"diamond":return .5*i*i/Math.sqrt(3);case"square":return i*i;case"star":{var j=18*RADIAN$2;return 1.25*i*i*(Math.tan(j)-Math.tan(j*2)*Math.pow(Math.tan(j),2))}case"triangle":return Math.sqrt(3)*i*i/4;case"wye":return(21-10*Math.sqrt(3))*i*i/8;default:return Math.PI*i*i/4}},registerSymbol=function o(i,_){symbolFactories["symbol".concat(upperFirst$1(i))]=_},Symbols=function o(i){var _=i.type,$=_===void 0?"circle":_,j=i.size,_e=j===void 0?64:j,et=i.sizeType,tt=et===void 0?"area":et,rt=_objectWithoutProperties$f(i,_excluded$f),nt=_objectSpread$B(_objectSpread$B({},rt),{},{type:$,size:_e,sizeType:tt}),it=function(){var ft=getSymbolFactory($),ut=Symbol$3().type(ft).size(calculateAreaSize(_e,tt,$));return ut()},st=nt.className,at=nt.cx,ot=nt.cy,lt=filterProps(nt,!0);return at===+at&&ot===+ot&&_e===+_e?React$2.createElement("path",_extends$s({},lt,{className:clsx("recharts-symbols",st),transform:"translate(".concat(at,", ").concat(ot,")"),d:it()})):null};Symbols.registerSymbol=registerSymbol;function _typeof$H(o){"@babel/helpers - typeof";return _typeof$H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$H(o)}function _extends$r(){return _extends$r=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$r.apply(this,arguments)}function ownKeys$B(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$A(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$B(Object(_),!0).forEach(function($){_defineProperty$H(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$B(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$l(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$l(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$H($.key),$)}}function _createClass$l(o,i,_){return i&&_defineProperties$l(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$h(o,i,_){return i=_getPrototypeOf$i(i),_possibleConstructorReturn$i(o,_isNativeReflectConstruct$i()?Reflect.construct(i,_||[],_getPrototypeOf$i(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$i(o,i){if(i&&(_typeof$H(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$i(o)}function _assertThisInitialized$i(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$i(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$i=function(){return!!o})()}function _getPrototypeOf$i(o){return _getPrototypeOf$i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$i(o)}function _inherits$i(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$i(o,i)}function _setPrototypeOf$i(o,i){return _setPrototypeOf$i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$i(o,i)}function _defineProperty$H(o,i,_){return i=_toPropertyKey$H(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$H(o){var i=_toPrimitive$H(o,"string");return _typeof$H(i)=="symbol"?i:i+""}function _toPrimitive$H(o,i){if(_typeof$H(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$H($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var SIZE=32,DefaultLegendContent=function(o){function i(){return _classCallCheck$l(this,i),_callSuper$h(this,i,arguments)}return _inherits$i(i,o),_createClass$l(i,[{key:"renderIcon",value:function($){var j=this.props.inactiveColor,_e=SIZE/2,et=SIZE/6,tt=SIZE/3,rt=$.inactive?j:$.color;if($.type==="plainline")return React$2.createElement("line",{strokeWidth:4,fill:"none",stroke:rt,strokeDasharray:$.payload.strokeDasharray,x1:0,y1:_e,x2:SIZE,y2:_e,className:"recharts-legend-icon"});if($.type==="line")return React$2.createElement("path",{strokeWidth:4,fill:"none",stroke:rt,d:"M0,".concat(_e,"h").concat(tt,`
            A`).concat(et,",").concat(et,",0,1,1,").concat(2*tt,",").concat(_e,`
            H`).concat(SIZE,"M").concat(2*tt,",").concat(_e,`
            A`).concat(et,",").concat(et,",0,1,1,").concat(tt,",").concat(_e),className:"recharts-legend-icon"});if($.type==="rect")return React$2.createElement("path",{stroke:"none",fill:rt,d:"M0,".concat(SIZE/8,"h").concat(SIZE,"v").concat(SIZE*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(React$2.isValidElement($.legendIcon)){var nt=_objectSpread$A({},$);return delete nt.legendIcon,React$2.cloneElement($.legendIcon,nt)}return React$2.createElement(Symbols,{fill:rt,cx:_e,cy:_e,size:SIZE,sizeType:"diameter",type:$.type})}},{key:"renderItems",value:function(){var $=this,j=this.props,_e=j.payload,et=j.iconSize,tt=j.layout,rt=j.formatter,nt=j.inactiveColor,it={x:0,y:0,width:SIZE,height:SIZE},st={display:tt==="horizontal"?"inline-block":"block",marginRight:10},at={display:"inline-block",verticalAlign:"middle",marginRight:4};return _e.map(function(ot,lt){var ct=ot.formatter||rt,ft=clsx(_defineProperty$H(_defineProperty$H({"recharts-legend-item":!0},"legend-item-".concat(lt),!0),"inactive",ot.inactive));if(ot.type==="none")return null;var ut=isFunction$3(ot.value)?null:ot.value;warn(!isFunction$3(ot.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var ht=ot.inactive?nt:ot.color;return React$2.createElement("li",_extends$r({className:ft,style:st,key:"legend-item-".concat(lt)},adaptEventsOfChild($.props,ot,lt)),React$2.createElement(Surface,{width:et,height:et,viewBox:it,style:at},$.renderIcon(ot)),React$2.createElement("span",{className:"recharts-legend-item-text",style:{color:ht}},ct?ct(ut,ot,lt):ut))})}},{key:"render",value:function(){var $=this.props,j=$.payload,_e=$.layout,et=$.align;if(!j||!j.length)return null;var tt={padding:0,margin:0,textAlign:_e==="horizontal"?et:"left"};return React$2.createElement("ul",{className:"recharts-default-legend",style:tt},this.renderItems())}}])}(reactExports.PureComponent);_defineProperty$H(DefaultLegendContent,"displayName","Legend");_defineProperty$H(DefaultLegendContent,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var ListCache$2=_ListCache;function stackClear$1(){this.__data__=new ListCache$2,this.size=0}var _stackClear=stackClear$1;function stackDelete$1(o){var i=this.__data__,_=i.delete(o);return this.size=i.size,_}var _stackDelete=stackDelete$1;function stackGet$1(o){return this.__data__.get(o)}var _stackGet=stackGet$1;function stackHas$1(o){return this.__data__.has(o)}var _stackHas=stackHas$1,ListCache$1=_ListCache,Map$2=_Map,MapCache$1=_MapCache,LARGE_ARRAY_SIZE$1=200;function stackSet$1(o,i){var _=this.__data__;if(_ instanceof ListCache$1){var $=_.__data__;if(!Map$2||$.length<LARGE_ARRAY_SIZE$1-1)return $.push([o,i]),this.size=++_.size,this;_=this.__data__=new MapCache$1($)}return _.set(o,i),this.size=_.size,this}var _stackSet=stackSet$1,ListCache=_ListCache,stackClear=_stackClear,stackDelete=_stackDelete,stackGet=_stackGet,stackHas=_stackHas,stackSet=_stackSet;function Stack$2(o){var i=this.__data__=new ListCache(o);this.size=i.size}Stack$2.prototype.clear=stackClear;Stack$2.prototype.delete=stackDelete;Stack$2.prototype.get=stackGet;Stack$2.prototype.has=stackHas;Stack$2.prototype.set=stackSet;var _Stack=Stack$2,HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd$1(o){return this.__data__.set(o,HASH_UNDEFINED),this}var _setCacheAdd=setCacheAdd$1;function setCacheHas$1(o){return this.__data__.has(o)}var _setCacheHas=setCacheHas$1,MapCache=_MapCache,setCacheAdd=_setCacheAdd,setCacheHas=_setCacheHas;function SetCache$2(o){var i=-1,_=o==null?0:o.length;for(this.__data__=new MapCache;++i<_;)this.add(o[i])}SetCache$2.prototype.add=SetCache$2.prototype.push=setCacheAdd;SetCache$2.prototype.has=setCacheHas;var _SetCache=SetCache$2;function arraySome$2(o,i){for(var _=-1,$=o==null?0:o.length;++_<$;)if(i(o[_],_,o))return!0;return!1}var _arraySome=arraySome$2;function cacheHas$2(o,i){return o.has(i)}var _cacheHas=cacheHas$2,SetCache$1=_SetCache,arraySome$1=_arraySome,cacheHas$1=_cacheHas,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays$2(o,i,_,$,j,_e){var et=_&COMPARE_PARTIAL_FLAG$5,tt=o.length,rt=i.length;if(tt!=rt&&!(et&&rt>tt))return!1;var nt=_e.get(o),it=_e.get(i);if(nt&&it)return nt==i&&it==o;var st=-1,at=!0,ot=_&COMPARE_UNORDERED_FLAG$3?new SetCache$1:void 0;for(_e.set(o,i),_e.set(i,o);++st<tt;){var lt=o[st],ct=i[st];if($)var ft=et?$(ct,lt,st,i,o,_e):$(lt,ct,st,o,i,_e);if(ft!==void 0){if(ft)continue;at=!1;break}if(ot){if(!arraySome$1(i,function(ut,ht){if(!cacheHas$1(ot,ht)&&(lt===ut||j(lt,ut,_,$,_e)))return ot.push(ht)})){at=!1;break}}else if(!(lt===ct||j(lt,ct,_,$,_e))){at=!1;break}}return _e.delete(o),_e.delete(i),at}var _equalArrays=equalArrays$2,root$5=_root,Uint8Array$2=root$5.Uint8Array,_Uint8Array=Uint8Array$2;function mapToArray$1(o){var i=-1,_=Array(o.size);return o.forEach(function($,j){_[++i]=[j,$]}),_}var _mapToArray=mapToArray$1;function setToArray$3(o){var i=-1,_=Array(o.size);return o.forEach(function($){_[++i]=$}),_}var _setToArray=setToArray$3,Symbol$2=_Symbol,Uint8Array$1=_Uint8Array,eq$1=eq_1,equalArrays$1=_equalArrays,mapToArray=_mapToArray,setToArray$2=_setToArray,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$2="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag$1(o,i,_,$,j,_e,et){switch(_){case dataViewTag$2:if(o.byteLength!=i.byteLength||o.byteOffset!=i.byteOffset)return!1;o=o.buffer,i=i.buffer;case arrayBufferTag$1:return!(o.byteLength!=i.byteLength||!_e(new Uint8Array$1(o),new Uint8Array$1(i)));case boolTag$2:case dateTag$1:case numberTag$1:return eq$1(+o,+i);case errorTag$1:return o.name==i.name&&o.message==i.message;case regexpTag$1:case stringTag$1:return o==i+"";case mapTag$2:var tt=mapToArray;case setTag$2:var rt=$&COMPARE_PARTIAL_FLAG$4;if(tt||(tt=setToArray$2),o.size!=i.size&&!rt)return!1;var nt=et.get(o);if(nt)return nt==i;$|=COMPARE_UNORDERED_FLAG$2,et.set(o,i);var it=equalArrays$1(tt(o),tt(i),$,j,_e,et);return et.delete(o),it;case symbolTag:if(symbolValueOf)return symbolValueOf.call(o)==symbolValueOf.call(i)}return!1}var _equalByTag=equalByTag$1;function arrayPush$2(o,i){for(var _=-1,$=i.length,j=o.length;++_<$;)o[j+_]=i[_];return o}var _arrayPush=arrayPush$2,arrayPush$1=_arrayPush,isArray$a=isArray_1;function baseGetAllKeys$1(o,i,_){var $=i(o);return isArray$a(o)?$:arrayPush$1($,_(o))}var _baseGetAllKeys=baseGetAllKeys$1;function arrayFilter$1(o,i){for(var _=-1,$=o==null?0:o.length,j=0,_e=[];++_<$;){var et=o[_];i(et,_,o)&&(_e[j++]=et)}return _e}var _arrayFilter=arrayFilter$1;function stubArray$1(){return[]}var stubArray_1=stubArray$1,arrayFilter=_arrayFilter,stubArray=stubArray_1,objectProto$7=Object.prototype,propertyIsEnumerable$1=objectProto$7.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols$1=nativeGetSymbols?function(o){return o==null?[]:(o=Object(o),arrayFilter(nativeGetSymbols(o),function(i){return propertyIsEnumerable$1.call(o,i)}))}:stubArray,_getSymbols=getSymbols$1;function baseTimes$1(o,i){for(var _=-1,$=Array(o);++_<o;)$[_]=i(_);return $}var _baseTimes=baseTimes$1,baseGetTag$4=_baseGetTag,isObjectLike$5=isObjectLike_1,argsTag$2="[object Arguments]";function baseIsArguments$1(o){return isObjectLike$5(o)&&baseGetTag$4(o)==argsTag$2}var _baseIsArguments=baseIsArguments$1,baseIsArguments=_baseIsArguments,isObjectLike$4=isObjectLike_1,objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,isArguments$3=baseIsArguments(function(){return arguments}())?baseIsArguments:function(o){return isObjectLike$4(o)&&hasOwnProperty$6.call(o,"callee")&&!propertyIsEnumerable.call(o,"callee")},isArguments_1=isArguments$3,isBuffer$2={exports:{}};function stubFalse(){return!1}var stubFalse_1=stubFalse;isBuffer$2.exports;(function(o,i){var _=_root,$=stubFalse_1,j=i&&!i.nodeType&&i,_e=j&&!0&&o&&!o.nodeType&&o,et=_e&&_e.exports===j,tt=et?_.Buffer:void 0,rt=tt?tt.isBuffer:void 0,nt=rt||$;o.exports=nt})(isBuffer$2,isBuffer$2.exports);var isBufferExports=isBuffer$2.exports,MAX_SAFE_INTEGER$3=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex$3(o,i){var _=typeof o;return i=i??MAX_SAFE_INTEGER$3,!!i&&(_=="number"||_!="symbol"&&reIsUint.test(o))&&o>-1&&o%1==0&&o<i}var _isIndex=isIndex$3,MAX_SAFE_INTEGER$2=9007199254740991;function isLength$3(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=MAX_SAFE_INTEGER$2}var isLength_1=isLength$3,baseGetTag$3=_baseGetTag,isLength$2=isLength_1,isObjectLike$3=isObjectLike_1,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag$1="[object Map]",numberTag="[object Number]",objectTag$3="[object Object]",regexpTag="[object RegExp]",setTag$1="[object Set]",stringTag="[object String]",weakMapTag$1="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag$1]=typedArrayTags[dataViewTag$1]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag$1]=typedArrayTags[numberTag]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag]=typedArrayTags[setTag$1]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag$1]=!1;function baseIsTypedArray$1(o){return isObjectLike$3(o)&&isLength$2(o.length)&&!!typedArrayTags[baseGetTag$3(o)]}var _baseIsTypedArray=baseIsTypedArray$1;function baseUnary$2(o){return function(i){return o(i)}}var _baseUnary=baseUnary$2,_nodeUtil={exports:{}};_nodeUtil.exports;(function(o,i){var _=_freeGlobal,$=i&&!i.nodeType&&i,j=$&&!0&&o&&!o.nodeType&&o,_e=j&&j.exports===$,et=_e&&_.process,tt=function(){try{var rt=j&&j.require&&j.require("util").types;return rt||et&&et.binding&&et.binding("util")}catch{}}();o.exports=tt})(_nodeUtil,_nodeUtil.exports);var _nodeUtilExports=_nodeUtil.exports,baseIsTypedArray=_baseIsTypedArray,baseUnary$1=_baseUnary,nodeUtil=_nodeUtilExports,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray$4=nodeIsTypedArray?baseUnary$1(nodeIsTypedArray):baseIsTypedArray,isTypedArray_1=isTypedArray$4,baseTimes=_baseTimes,isArguments$2=isArguments_1,isArray$9=isArray_1,isBuffer$1=isBufferExports,isIndex$2=_isIndex,isTypedArray$3=isTypedArray_1,objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function arrayLikeKeys$1(o,i){var _=isArray$9(o),$=!_&&isArguments$2(o),j=!_&&!$&&isBuffer$1(o),_e=!_&&!$&&!j&&isTypedArray$3(o),et=_||$||j||_e,tt=et?baseTimes(o.length,String):[],rt=tt.length;for(var nt in o)(i||hasOwnProperty$5.call(o,nt))&&!(et&&(nt=="length"||j&&(nt=="offset"||nt=="parent")||_e&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||isIndex$2(nt,rt)))&&tt.push(nt);return tt}var _arrayLikeKeys=arrayLikeKeys$1,objectProto$4=Object.prototype;function isPrototype$1(o){var i=o&&o.constructor,_=typeof i=="function"&&i.prototype||objectProto$4;return o===_}var _isPrototype=isPrototype$1;function overArg$2(o,i){return function(_){return o(i(_))}}var _overArg=overArg$2,overArg$1=_overArg,nativeKeys$1=overArg$1(Object.keys,Object),_nativeKeys=nativeKeys$1,isPrototype=_isPrototype,nativeKeys=_nativeKeys,objectProto$3=Object.prototype,hasOwnProperty$4=objectProto$3.hasOwnProperty;function baseKeys$1(o){if(!isPrototype(o))return nativeKeys(o);var i=[];for(var _ in Object(o))hasOwnProperty$4.call(o,_)&&_!="constructor"&&i.push(_);return i}var _baseKeys=baseKeys$1,isFunction=isFunction_1,isLength$1=isLength_1;function isArrayLike$4(o){return o!=null&&isLength$1(o.length)&&!isFunction(o)}var isArrayLike_1=isArrayLike$4,arrayLikeKeys=_arrayLikeKeys,baseKeys=_baseKeys,isArrayLike$3=isArrayLike_1;function keys$4(o){return isArrayLike$3(o)?arrayLikeKeys(o):baseKeys(o)}var keys_1=keys$4,baseGetAllKeys=_baseGetAllKeys,getSymbols=_getSymbols,keys$3=keys_1;function getAllKeys$1(o){return baseGetAllKeys(o,keys$3,getSymbols)}var _getAllKeys=getAllKeys$1,getAllKeys=_getAllKeys,COMPARE_PARTIAL_FLAG$3=1,objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function equalObjects$1(o,i,_,$,j,_e){var et=_&COMPARE_PARTIAL_FLAG$3,tt=getAllKeys(o),rt=tt.length,nt=getAllKeys(i),it=nt.length;if(rt!=it&&!et)return!1;for(var st=rt;st--;){var at=tt[st];if(!(et?at in i:hasOwnProperty$3.call(i,at)))return!1}var ot=_e.get(o),lt=_e.get(i);if(ot&&lt)return ot==i&&lt==o;var ct=!0;_e.set(o,i),_e.set(i,o);for(var ft=et;++st<rt;){at=tt[st];var ut=o[at],ht=i[at];if($)var dt=et?$(ht,ut,at,i,o,_e):$(ut,ht,at,o,i,_e);if(!(dt===void 0?ut===ht||j(ut,ht,_,$,_e):dt)){ct=!1;break}ft||(ft=at=="constructor")}if(ct&&!ft){var mt=o.constructor,pt=i.constructor;mt!=pt&&"constructor"in o&&"constructor"in i&&!(typeof mt=="function"&&mt instanceof mt&&typeof pt=="function"&&pt instanceof pt)&&(ct=!1)}return _e.delete(o),_e.delete(i),ct}var _equalObjects=equalObjects$1,getNative$4=_getNative,root$4=_root,DataView$2=getNative$4(root$4,"DataView"),_DataView=DataView$2,getNative$3=_getNative,root$3=_root,Promise$2=getNative$3(root$3,"Promise"),_Promise=Promise$2,getNative$2=_getNative,root$2=_root,Set$3=getNative$2(root$2,"Set"),_Set=Set$3,getNative$1=_getNative,root$1=_root,WeakMap$2=getNative$1(root$1,"WeakMap"),_WeakMap=WeakMap$2,DataView$1=_DataView,Map$1=_Map,Promise$1=_Promise,Set$2=_Set,WeakMap$1=_WeakMap,baseGetTag$2=_baseGetTag,toSource=_toSource,mapTag="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag="[object Set]",weakMapTag="[object WeakMap]",dataViewTag="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$1),getTag$2=baseGetTag$2;(DataView$1&&getTag$2(new DataView$1(new ArrayBuffer(1)))!=dataViewTag||Map$1&&getTag$2(new Map$1)!=mapTag||Promise$1&&getTag$2(Promise$1.resolve())!=promiseTag||Set$2&&getTag$2(new Set$2)!=setTag||WeakMap$1&&getTag$2(new WeakMap$1)!=weakMapTag)&&(getTag$2=function(o){var i=baseGetTag$2(o),_=i==objectTag$2?o.constructor:void 0,$=_?toSource(_):"";if($)switch($){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return i});var _getTag=getTag$2,Stack$1=_Stack,equalArrays=_equalArrays,equalByTag=_equalByTag,equalObjects=_equalObjects,getTag$1=_getTag,isArray$8=isArray_1,isBuffer=isBufferExports,isTypedArray$2=isTypedArray_1,COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag$1="[object Object]",objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function baseIsEqualDeep$1(o,i,_,$,j,_e){var et=isArray$8(o),tt=isArray$8(i),rt=et?arrayTag:getTag$1(o),nt=tt?arrayTag:getTag$1(i);rt=rt==argsTag?objectTag$1:rt,nt=nt==argsTag?objectTag$1:nt;var it=rt==objectTag$1,st=nt==objectTag$1,at=rt==nt;if(at&&isBuffer(o)){if(!isBuffer(i))return!1;et=!0,it=!1}if(at&&!it)return _e||(_e=new Stack$1),et||isTypedArray$2(o)?equalArrays(o,i,_,$,j,_e):equalByTag(o,i,rt,_,$,j,_e);if(!(_&COMPARE_PARTIAL_FLAG$2)){var ot=it&&hasOwnProperty$2.call(o,"__wrapped__"),lt=st&&hasOwnProperty$2.call(i,"__wrapped__");if(ot||lt){var ct=ot?o.value():o,ft=lt?i.value():i;return _e||(_e=new Stack$1),j(ct,ft,_,$,_e)}}return at?(_e||(_e=new Stack$1),equalObjects(o,i,_,$,j,_e)):!1}var _baseIsEqualDeep=baseIsEqualDeep$1,baseIsEqualDeep=_baseIsEqualDeep,isObjectLike$2=isObjectLike_1;function baseIsEqual$3(o,i,_,$,j){return o===i?!0:o==null||i==null||!isObjectLike$2(o)&&!isObjectLike$2(i)?o!==o&&i!==i:baseIsEqualDeep(o,i,_,$,baseIsEqual$3,j)}var _baseIsEqual=baseIsEqual$3,Stack=_Stack,baseIsEqual$2=_baseIsEqual,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch$1(o,i,_,$){var j=_.length,_e=j,et=!$;if(o==null)return!_e;for(o=Object(o);j--;){var tt=_[j];if(et&&tt[2]?tt[1]!==o[tt[0]]:!(tt[0]in o))return!1}for(;++j<_e;){tt=_[j];var rt=tt[0],nt=o[rt],it=tt[1];if(et&&tt[2]){if(nt===void 0&&!(rt in o))return!1}else{var st=new Stack;if($)var at=$(nt,it,rt,o,i,st);if(!(at===void 0?baseIsEqual$2(it,nt,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,$,st):at))return!1}}return!0}var _baseIsMatch=baseIsMatch$1,isObject$4=isObject_1;function isStrictComparable$2(o){return o===o&&!isObject$4(o)}var _isStrictComparable=isStrictComparable$2,isStrictComparable$1=_isStrictComparable,keys$2=keys_1;function getMatchData$1(o){for(var i=keys$2(o),_=i.length;_--;){var $=i[_],j=o[$];i[_]=[$,j,isStrictComparable$1(j)]}return i}var _getMatchData=getMatchData$1;function matchesStrictComparable$2(o,i){return function(_){return _==null?!1:_[o]===i&&(i!==void 0||o in Object(_))}}var _matchesStrictComparable=matchesStrictComparable$2,baseIsMatch=_baseIsMatch,getMatchData=_getMatchData,matchesStrictComparable$1=_matchesStrictComparable;function baseMatches$1(o){var i=getMatchData(o);return i.length==1&&i[0][2]?matchesStrictComparable$1(i[0][0],i[0][1]):function(_){return _===o||baseIsMatch(_,o,i)}}var _baseMatches=baseMatches$1;function baseHasIn$1(o,i){return o!=null&&i in Object(o)}var _baseHasIn=baseHasIn$1,castPath=_castPath,isArguments$1=isArguments_1,isArray$7=isArray_1,isIndex$1=_isIndex,isLength=isLength_1,toKey$2=_toKey;function hasPath$1(o,i,_){i=castPath(i,o);for(var $=-1,j=i.length,_e=!1;++$<j;){var et=toKey$2(i[$]);if(!(_e=o!=null&&_(o,et)))break;o=o[et]}return _e||++$!=j?_e:(j=o==null?0:o.length,!!j&&isLength(j)&&isIndex$1(et,j)&&(isArray$7(o)||isArguments$1(o)))}var _hasPath=hasPath$1,baseHasIn=_baseHasIn,hasPath=_hasPath;function hasIn$1(o,i){return o!=null&&hasPath(o,i,baseHasIn)}var hasIn_1=hasIn$1,baseIsEqual$1=_baseIsEqual,get$2=get_1,hasIn=hasIn_1,isKey$1=_isKey,isStrictComparable=_isStrictComparable,matchesStrictComparable=_matchesStrictComparable,toKey$1=_toKey,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty$1(o,i){return isKey$1(o)&&isStrictComparable(i)?matchesStrictComparable(toKey$1(o),i):function(_){var $=get$2(_,o);return $===void 0&&$===i?hasIn(_,o):baseIsEqual$1(i,$,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}var _baseMatchesProperty=baseMatchesProperty$1;function identity$b(o){return o}var identity_1=identity$b;function baseProperty$1(o){return function(i){return i==null?void 0:i[o]}}var _baseProperty=baseProperty$1,baseGet$1=_baseGet;function basePropertyDeep$1(o){return function(i){return baseGet$1(i,o)}}var _basePropertyDeep=basePropertyDeep$1,baseProperty=_baseProperty,basePropertyDeep=_basePropertyDeep,isKey=_isKey,toKey=_toKey;function property$1(o){return isKey(o)?baseProperty(toKey(o)):basePropertyDeep(o)}var property_1=property$1,baseMatches=_baseMatches,baseMatchesProperty=_baseMatchesProperty,identity$a=identity_1,isArray$6=isArray_1,property=property_1;function baseIteratee$8(o){return typeof o=="function"?o:o==null?identity$a:typeof o=="object"?isArray$6(o)?baseMatchesProperty(o[0],o[1]):baseMatches(o):property(o)}var _baseIteratee=baseIteratee$8;function baseFindIndex$1(o,i,_,$){for(var j=o.length,_e=_+($?1:-1);$?_e--:++_e<j;)if(i(o[_e],_e,o))return _e;return-1}var _baseFindIndex=baseFindIndex$1;function baseIsNaN$1(o){return o!==o}var _baseIsNaN=baseIsNaN$1;function strictIndexOf$1(o,i,_){for(var $=_-1,j=o.length;++$<j;)if(o[$]===i)return $;return-1}var _strictIndexOf=strictIndexOf$1,baseFindIndex=_baseFindIndex,baseIsNaN=_baseIsNaN,strictIndexOf=_strictIndexOf;function baseIndexOf$1(o,i,_){return i===i?strictIndexOf(o,i,_):baseFindIndex(o,baseIsNaN,_)}var _baseIndexOf=baseIndexOf$1,baseIndexOf=_baseIndexOf;function arrayIncludes$1(o,i){var _=o==null?0:o.length;return!!_&&baseIndexOf(o,i,0)>-1}var _arrayIncludes=arrayIncludes$1;function arrayIncludesWith$1(o,i,_){for(var $=-1,j=o==null?0:o.length;++$<j;)if(_(i,o[$]))return!0;return!1}var _arrayIncludesWith=arrayIncludesWith$1;function noop$5(){}var noop_1=noop$5,Set$1=_Set,noop$4=noop_1,setToArray$1=_setToArray,INFINITY$1=1/0,createSet$1=Set$1&&1/setToArray$1(new Set$1([,-0]))[1]==INFINITY$1?function(o){return new Set$1(o)}:noop$4,_createSet=createSet$1,SetCache=_SetCache,arrayIncludes=_arrayIncludes,arrayIncludesWith=_arrayIncludesWith,cacheHas=_cacheHas,createSet=_createSet,setToArray=_setToArray,LARGE_ARRAY_SIZE=200;function baseUniq$1(o,i,_){var $=-1,j=arrayIncludes,_e=o.length,et=!0,tt=[],rt=tt;if(_)et=!1,j=arrayIncludesWith;else if(_e>=LARGE_ARRAY_SIZE){var nt=i?null:createSet(o);if(nt)return setToArray(nt);et=!1,j=cacheHas,rt=new SetCache}else rt=i?[]:tt;e:for(;++$<_e;){var it=o[$],st=i?i(it):it;if(it=_||it!==0?it:0,et&&st===st){for(var at=rt.length;at--;)if(rt[at]===st)continue e;i&&rt.push(st),tt.push(it)}else j(rt,st,_)||(rt!==tt&&rt.push(st),tt.push(it))}return tt}var _baseUniq=baseUniq$1,baseIteratee$7=_baseIteratee,baseUniq=_baseUniq;function uniqBy(o,i){return o&&o.length?baseUniq(o,baseIteratee$7(i)):[]}var uniqBy_1=uniqBy;const uniqBy$1=getDefaultExportFromCjs$1(uniqBy_1);function getUniqPayload(o,i,_){return i===!0?uniqBy$1(o,_):isFunction$3(i)?uniqBy$1(o,i):o}function _typeof$G(o){"@babel/helpers - typeof";return _typeof$G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$G(o)}var _excluded$e=["ref"];function ownKeys$A(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$z(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$A(Object(_),!0).forEach(function($){_defineProperty$G(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$A(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$k(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$k(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$G($.key),$)}}function _createClass$k(o,i,_){return i&&_defineProperties$k(o.prototype,i),_&&_defineProperties$k(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$g(o,i,_){return i=_getPrototypeOf$h(i),_possibleConstructorReturn$h(o,_isNativeReflectConstruct$h()?Reflect.construct(i,_||[],_getPrototypeOf$h(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$h(o,i){if(i&&(_typeof$G(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$h(o)}function _assertThisInitialized$h(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$h(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$h=function(){return!!o})()}function _getPrototypeOf$h(o){return _getPrototypeOf$h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$h(o)}function _inherits$h(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$h(o,i)}function _setPrototypeOf$h(o,i){return _setPrototypeOf$h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$h(o,i)}function _defineProperty$G(o,i,_){return i=_toPropertyKey$G(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$G(o){var i=_toPrimitive$G(o,"string");return _typeof$G(i)=="symbol"?i:i+""}function _toPrimitive$G(o,i){if(_typeof$G(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$G($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function _objectWithoutProperties$e(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$e(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$e(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function defaultUniqBy$1(o){return o.value}function renderContent$1(o,i){if(React$2.isValidElement(o))return React$2.cloneElement(o,i);if(typeof o=="function")return React$2.createElement(o,i);i.ref;var _=_objectWithoutProperties$e(i,_excluded$e);return React$2.createElement(DefaultLegendContent,_)}var EPS$1=1,Legend=function(o){function i(){var _;_classCallCheck$k(this,i);for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];return _=_callSuper$g(this,i,[].concat(j)),_defineProperty$G(_,"lastBoundingBox",{width:-1,height:-1}),_}return _inherits$h(i,o),_createClass$k(i,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var $=this.wrapperNode.getBoundingClientRect();return $.height=this.wrapperNode.offsetHeight,$.width=this.wrapperNode.offsetWidth,$}return null}},{key:"updateBBox",value:function(){var $=this.props.onBBoxUpdate,j=this.getBBox();j?(Math.abs(j.width-this.lastBoundingBox.width)>EPS$1||Math.abs(j.height-this.lastBoundingBox.height)>EPS$1)&&(this.lastBoundingBox.width=j.width,this.lastBoundingBox.height=j.height,$&&$(j)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,$&&$(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?_objectSpread$z({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function($){var j=this.props,_e=j.layout,et=j.align,tt=j.verticalAlign,rt=j.margin,nt=j.chartWidth,it=j.chartHeight,st,at;if(!$||($.left===void 0||$.left===null)&&($.right===void 0||$.right===null))if(et==="center"&&_e==="vertical"){var ot=this.getBBoxSnapshot();st={left:((nt||0)-ot.width)/2}}else st=et==="right"?{right:rt&&rt.right||0}:{left:rt&&rt.left||0};if(!$||($.top===void 0||$.top===null)&&($.bottom===void 0||$.bottom===null))if(tt==="middle"){var lt=this.getBBoxSnapshot();at={top:((it||0)-lt.height)/2}}else at=tt==="bottom"?{bottom:rt&&rt.bottom||0}:{top:rt&&rt.top||0};return _objectSpread$z(_objectSpread$z({},st),at)}},{key:"render",value:function(){var $=this,j=this.props,_e=j.content,et=j.width,tt=j.height,rt=j.wrapperStyle,nt=j.payloadUniqBy,it=j.payload,st=_objectSpread$z(_objectSpread$z({position:"absolute",width:et||"auto",height:tt||"auto"},this.getDefaultPosition(rt)),rt);return React$2.createElement("div",{className:"recharts-legend-wrapper",style:st,ref:function(ot){$.wrapperNode=ot}},renderContent$1(_e,_objectSpread$z(_objectSpread$z({},this.props),{},{payload:getUniqPayload(it,nt,defaultUniqBy$1)})))}}],[{key:"getWithHeight",value:function($,j){var _e=_objectSpread$z(_objectSpread$z({},this.defaultProps),$.props),et=_e.layout;return et==="vertical"&&isNumber($.props.height)?{height:$.props.height}:et==="horizontal"?{width:$.props.width||j}:null}}])}(reactExports.PureComponent);_defineProperty$G(Legend,"displayName","Legend");_defineProperty$G(Legend,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Symbol$1=_Symbol,isArguments=isArguments_1,isArray$5=isArray_1,spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable$1(o){return isArray$5(o)||isArguments(o)||!!(spreadableSymbol&&o&&o[spreadableSymbol])}var _isFlattenable=isFlattenable$1,arrayPush=_arrayPush,isFlattenable=_isFlattenable;function baseFlatten$2(o,i,_,$,j){var _e=-1,et=o.length;for(_||(_=isFlattenable),j||(j=[]);++_e<et;){var tt=o[_e];i>0&&_(tt)?i>1?baseFlatten$2(tt,i-1,_,$,j):arrayPush(j,tt):$||(j[j.length]=tt)}return j}var _baseFlatten=baseFlatten$2;function createBaseFor$1(o){return function(i,_,$){for(var j=-1,_e=Object(i),et=$(i),tt=et.length;tt--;){var rt=et[o?tt:++j];if(_(_e[rt],rt,_e)===!1)break}return i}}var _createBaseFor=createBaseFor$1,createBaseFor=_createBaseFor,baseFor$1=createBaseFor(),_baseFor=baseFor$1,baseFor=_baseFor,keys$1=keys_1;function baseForOwn$2(o,i){return o&&baseFor(o,i,keys$1)}var _baseForOwn=baseForOwn$2,isArrayLike$2=isArrayLike_1;function createBaseEach$1(o,i){return function(_,$){if(_==null)return _;if(!isArrayLike$2(_))return o(_,$);for(var j=_.length,_e=i?j:-1,et=Object(_);(i?_e--:++_e<j)&&$(et[_e],_e,et)!==!1;);return _}}var _createBaseEach=createBaseEach$1,baseForOwn$1=_baseForOwn,createBaseEach=_createBaseEach,baseEach$3=createBaseEach(baseForOwn$1),_baseEach=baseEach$3,baseEach$2=_baseEach,isArrayLike$1=isArrayLike_1;function baseMap$2(o,i){var _=-1,$=isArrayLike$1(o)?Array(o.length):[];return baseEach$2(o,function(j,_e,et){$[++_]=i(j,_e,et)}),$}var _baseMap=baseMap$2;function baseSortBy$1(o,i){var _=o.length;for(o.sort(i);_--;)o[_]=o[_].value;return o}var _baseSortBy=baseSortBy$1,isSymbol$2=isSymbol_1;function compareAscending$1(o,i){if(o!==i){var _=o!==void 0,$=o===null,j=o===o,_e=isSymbol$2(o),et=i!==void 0,tt=i===null,rt=i===i,nt=isSymbol$2(i);if(!tt&&!nt&&!_e&&o>i||_e&&et&&rt&&!tt&&!nt||$&&et&&rt||!_&&rt||!j)return 1;if(!$&&!_e&&!nt&&o<i||nt&&_&&j&&!$&&!_e||tt&&_&&j||!et&&j||!rt)return-1}return 0}var _compareAscending=compareAscending$1,compareAscending=_compareAscending;function compareMultiple$1(o,i,_){for(var $=-1,j=o.criteria,_e=i.criteria,et=j.length,tt=_.length;++$<et;){var rt=compareAscending(j[$],_e[$]);if(rt){if($>=tt)return rt;var nt=_[$];return rt*(nt=="desc"?-1:1)}}return o.index-i.index}var _compareMultiple=compareMultiple$1,arrayMap$1=_arrayMap,baseGet=_baseGet,baseIteratee$6=_baseIteratee,baseMap$1=_baseMap,baseSortBy=_baseSortBy,baseUnary=_baseUnary,compareMultiple=_compareMultiple,identity$9=identity_1,isArray$4=isArray_1;function baseOrderBy$1(o,i,_){i.length?i=arrayMap$1(i,function(_e){return isArray$4(_e)?function(et){return baseGet(et,_e.length===1?_e[0]:_e)}:_e}):i=[identity$9];var $=-1;i=arrayMap$1(i,baseUnary(baseIteratee$6));var j=baseMap$1(o,function(_e,et,tt){var rt=arrayMap$1(i,function(nt){return nt(_e)});return{criteria:rt,index:++$,value:_e}});return baseSortBy(j,function(_e,et){return compareMultiple(_e,et,_)})}var _baseOrderBy=baseOrderBy$1;function apply$1(o,i,_){switch(_.length){case 0:return o.call(i);case 1:return o.call(i,_[0]);case 2:return o.call(i,_[0],_[1]);case 3:return o.call(i,_[0],_[1],_[2])}return o.apply(i,_)}var _apply=apply$1,apply=_apply,nativeMax$2=Math.max;function overRest$1(o,i,_){return i=nativeMax$2(i===void 0?o.length-1:i,0),function(){for(var $=arguments,j=-1,_e=nativeMax$2($.length-i,0),et=Array(_e);++j<_e;)et[j]=$[i+j];j=-1;for(var tt=Array(i+1);++j<i;)tt[j]=$[j];return tt[i]=_(et),apply(o,this,tt)}}var _overRest=overRest$1;function constant$2(o){return function(){return o}}var constant_1=constant$2,getNative=_getNative,defineProperty$2=function(){try{var o=getNative(Object,"defineProperty");return o({},"",{}),o}catch{}}(),_defineProperty$F=defineProperty$2,constant$1=constant_1,defineProperty$1=_defineProperty$F,identity$8=identity_1,baseSetToString$1=defineProperty$1?function(o,i){return defineProperty$1(o,"toString",{configurable:!0,enumerable:!1,value:constant$1(i),writable:!0})}:identity$8,_baseSetToString=baseSetToString$1,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut$1(o){var i=0,_=0;return function(){var $=nativeNow(),j=HOT_SPAN-($-_);if(_=$,j>0){if(++i>=HOT_COUNT)return arguments[0]}else i=0;return o.apply(void 0,arguments)}}var _shortOut=shortOut$1,baseSetToString=_baseSetToString,shortOut=_shortOut,setToString$1=shortOut(baseSetToString),_setToString=setToString$1,identity$7=identity_1,overRest=_overRest,setToString=_setToString;function baseRest$1(o,i){return setToString(overRest(o,i,identity$7),o+"")}var _baseRest=baseRest$1,eq=eq_1,isArrayLike=isArrayLike_1,isIndex=_isIndex,isObject$3=isObject_1;function isIterateeCall$4(o,i,_){if(!isObject$3(_))return!1;var $=typeof i;return($=="number"?isArrayLike(_)&&isIndex(i,_.length):$=="string"&&i in _)?eq(_[i],o):!1}var _isIterateeCall=isIterateeCall$4,baseFlatten$1=_baseFlatten,baseOrderBy=_baseOrderBy,baseRest=_baseRest,isIterateeCall$3=_isIterateeCall,sortBy=baseRest(function(o,i){if(o==null)return[];var _=i.length;return _>1&&isIterateeCall$3(o,i[0],i[1])?i=[]:_>2&&isIterateeCall$3(i[0],i[1],i[2])&&(i=[i[0]]),baseOrderBy(o,baseFlatten$1(i,1),[])}),sortBy_1=sortBy;const sortBy$1=getDefaultExportFromCjs$1(sortBy_1);function _typeof$F(o){"@babel/helpers - typeof";return _typeof$F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$F(o)}function _extends$q(){return _extends$q=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$q.apply(this,arguments)}function _slicedToArray$c(o,i){return _arrayWithHoles$d(o)||_iterableToArrayLimit$c(o,i)||_unsupportedIterableToArray$l(o,i)||_nonIterableRest$d()}function _nonIterableRest$d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$l(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$l(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$l(o,i)}}function _arrayLikeToArray$l(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$c(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$d(o){if(Array.isArray(o))return o}function ownKeys$z(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$y(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$z(Object(_),!0).forEach(function($){_defineProperty$E(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$z(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$E(o,i,_){return i=_toPropertyKey$F(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$F(o){var i=_toPrimitive$F(o,"string");return _typeof$F(i)=="symbol"?i:i+""}function _toPrimitive$F(o,i){if(_typeof$F(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$F($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function defaultFormatter(o){return Array.isArray(o)&&isNumOrStr(o[0])&&isNumOrStr(o[1])?o.join(" ~ "):o}var DefaultTooltipContent=function o(i){var _=i.separator,$=_===void 0?" : ":_,j=i.contentStyle,_e=j===void 0?{}:j,et=i.itemStyle,tt=et===void 0?{}:et,rt=i.labelStyle,nt=rt===void 0?{}:rt,it=i.payload,st=i.formatter,at=i.itemSorter,ot=i.wrapperClassName,lt=i.labelClassName,ct=i.label,ft=i.labelFormatter,ut=i.accessibilityLayer,ht=ut===void 0?!1:ut,dt=function(){if(it&&it.length){var wt={padding:0,margin:0},Ot=(at?sortBy$1(it,at):it).map(function(Bt,Ft){if(Bt.type==="none")return null;var Pt=_objectSpread$y({display:"block",paddingTop:4,paddingBottom:4,color:Bt.color||"#000"},tt),Rt=Bt.formatter||st||defaultFormatter,Et=Bt.value,_t=Bt.name,Mt=Et,Dt=_t;if(Rt&&Mt!=null&&Dt!=null){var Lt=Rt(Et,_t,Bt,Ft,it);if(Array.isArray(Lt)){var Ct=_slicedToArray$c(Lt,2);Mt=Ct[0],Dt=Ct[1]}else Mt=Lt}return React$2.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Ft),style:Pt},isNumOrStr(Dt)?React$2.createElement("span",{className:"recharts-tooltip-item-name"},Dt):null,isNumOrStr(Dt)?React$2.createElement("span",{className:"recharts-tooltip-item-separator"},$):null,React$2.createElement("span",{className:"recharts-tooltip-item-value"},Mt),React$2.createElement("span",{className:"recharts-tooltip-item-unit"},Bt.unit||""))});return React$2.createElement("ul",{className:"recharts-tooltip-item-list",style:wt},Ot)}return null},mt=_objectSpread$y({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},_e),pt=_objectSpread$y({margin:0},nt),yt=!isNil$1(ct),gt=yt?ct:"",vt=clsx("recharts-default-tooltip",ot),St=clsx("recharts-tooltip-label",lt);yt&&ft&&it!==void 0&&it!==null&&(gt=ft(ct,it));var At=ht?{role:"status","aria-live":"assertive"}:{};return React$2.createElement("div",_extends$q({className:vt,style:mt},At),React$2.createElement("p",{className:St,style:pt},React$2.isValidElement(gt)?gt:"".concat(gt)),dt())};function _typeof$E(o){"@babel/helpers - typeof";return _typeof$E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$E(o)}function _defineProperty$D(o,i,_){return i=_toPropertyKey$E(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$E(o){var i=_toPrimitive$E(o,"string");return _typeof$E(i)=="symbol"?i:i+""}function _toPrimitive$E(o,i){if(_typeof$E(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$E($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var CSS_CLASS_PREFIX="recharts-tooltip-wrapper",TOOLTIP_HIDDEN={visibility:"hidden"};function getTooltipCSSClassName(o){var i=o.coordinate,_=o.translateX,$=o.translateY;return clsx(CSS_CLASS_PREFIX,_defineProperty$D(_defineProperty$D(_defineProperty$D(_defineProperty$D({},"".concat(CSS_CLASS_PREFIX,"-right"),isNumber(_)&&i&&isNumber(i.x)&&_>=i.x),"".concat(CSS_CLASS_PREFIX,"-left"),isNumber(_)&&i&&isNumber(i.x)&&_<i.x),"".concat(CSS_CLASS_PREFIX,"-bottom"),isNumber($)&&i&&isNumber(i.y)&&$>=i.y),"".concat(CSS_CLASS_PREFIX,"-top"),isNumber($)&&i&&isNumber(i.y)&&$<i.y))}function getTooltipTranslateXY(o){var i=o.allowEscapeViewBox,_=o.coordinate,$=o.key,j=o.offsetTopLeft,_e=o.position,et=o.reverseDirection,tt=o.tooltipDimension,rt=o.viewBox,nt=o.viewBoxDimension;if(_e&&isNumber(_e[$]))return _e[$];var it=_[$]-tt-j,st=_[$]+j;if(i[$])return et[$]?it:st;if(et[$]){var at=it,ot=rt[$];return at<ot?Math.max(st,rt[$]):Math.max(it,rt[$])}var lt=st+tt,ct=rt[$]+nt;return lt>ct?Math.max(it,rt[$]):Math.max(st,rt[$])}function getTransformStyle(o){var i=o.translateX,_=o.translateY,$=o.useTranslate3d;return{transform:$?"translate3d(".concat(i,"px, ").concat(_,"px, 0)"):"translate(".concat(i,"px, ").concat(_,"px)")}}function getTooltipTranslate(o){var i=o.allowEscapeViewBox,_=o.coordinate,$=o.offsetTopLeft,j=o.position,_e=o.reverseDirection,et=o.tooltipBox,tt=o.useTranslate3d,rt=o.viewBox,nt,it,st;return et.height>0&&et.width>0&&_?(it=getTooltipTranslateXY({allowEscapeViewBox:i,coordinate:_,key:"x",offsetTopLeft:$,position:j,reverseDirection:_e,tooltipDimension:et.width,viewBox:rt,viewBoxDimension:rt.width}),st=getTooltipTranslateXY({allowEscapeViewBox:i,coordinate:_,key:"y",offsetTopLeft:$,position:j,reverseDirection:_e,tooltipDimension:et.height,viewBox:rt,viewBoxDimension:rt.height}),nt=getTransformStyle({translateX:it,translateY:st,useTranslate3d:tt})):nt=TOOLTIP_HIDDEN,{cssProperties:nt,cssClasses:getTooltipCSSClassName({translateX:it,translateY:st,coordinate:_})}}function _typeof$D(o){"@babel/helpers - typeof";return _typeof$D=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$D(o)}function ownKeys$y(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$x(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$y(Object(_),!0).forEach(function($){_defineProperty$C(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$y(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$j(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$j(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$D($.key),$)}}function _createClass$j(o,i,_){return i&&_defineProperties$j(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$f(o,i,_){return i=_getPrototypeOf$g(i),_possibleConstructorReturn$g(o,_isNativeReflectConstruct$g()?Reflect.construct(i,_||[],_getPrototypeOf$g(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$g(o,i){if(i&&(_typeof$D(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$g(o)}function _assertThisInitialized$g(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$g(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$g=function(){return!!o})()}function _getPrototypeOf$g(o){return _getPrototypeOf$g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$g(o)}function _inherits$g(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$g(o,i)}function _setPrototypeOf$g(o,i){return _setPrototypeOf$g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$g(o,i)}function _defineProperty$C(o,i,_){return i=_toPropertyKey$D(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$D(o){var i=_toPrimitive$D(o,"string");return _typeof$D(i)=="symbol"?i:i+""}function _toPrimitive$D(o,i){if(_typeof$D(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$D($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var EPSILON=1,TooltipBoundingBox=function(o){function i(){var _;_classCallCheck$j(this,i);for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];return _=_callSuper$f(this,i,[].concat(j)),_defineProperty$C(_,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),_defineProperty$C(_,"handleKeyDown",function(et){if(et.key==="Escape"){var tt,rt,nt,it;_.setState({dismissed:!0,dismissedAtCoordinate:{x:(tt=(rt=_.props.coordinate)===null||rt===void 0?void 0:rt.x)!==null&&tt!==void 0?tt:0,y:(nt=(it=_.props.coordinate)===null||it===void 0?void 0:it.y)!==null&&nt!==void 0?nt:0}})}}),_}return _inherits$g(i,o),_createClass$j(i,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var $=this.wrapperNode.getBoundingClientRect();(Math.abs($.width-this.state.lastBoundingBox.width)>EPSILON||Math.abs($.height-this.state.lastBoundingBox.height)>EPSILON)&&this.setState({lastBoundingBox:{width:$.width,height:$.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var $,j;this.props.active&&this.updateBBox(),this.state.dismissed&&((($=this.props.coordinate)===null||$===void 0?void 0:$.x)!==this.state.dismissedAtCoordinate.x||((j=this.props.coordinate)===null||j===void 0?void 0:j.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var $=this,j=this.props,_e=j.active,et=j.allowEscapeViewBox,tt=j.animationDuration,rt=j.animationEasing,nt=j.children,it=j.coordinate,st=j.hasPayload,at=j.isAnimationActive,ot=j.offset,lt=j.position,ct=j.reverseDirection,ft=j.useTranslate3d,ut=j.viewBox,ht=j.wrapperStyle,dt=getTooltipTranslate({allowEscapeViewBox:et,coordinate:it,offsetTopLeft:ot,position:lt,reverseDirection:ct,tooltipBox:this.state.lastBoundingBox,useTranslate3d:ft,viewBox:ut}),mt=dt.cssClasses,pt=dt.cssProperties,yt=_objectSpread$x(_objectSpread$x({transition:at&&_e?"transform ".concat(tt,"ms ").concat(rt):void 0},pt),{},{pointerEvents:"none",visibility:!this.state.dismissed&&_e&&st?"visible":"hidden",position:"absolute",top:0,left:0},ht);return React$2.createElement("div",{tabIndex:-1,className:mt,style:yt,ref:function(vt){$.wrapperNode=vt}},nt)}}])}(reactExports.PureComponent),parseIsSsrByDefault=function o(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Global={isSsr:parseIsSsrByDefault()};function _typeof$C(o){"@babel/helpers - typeof";return _typeof$C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$C(o)}function ownKeys$x(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$w(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$x(Object(_),!0).forEach(function($){_defineProperty$B(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$x(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$i(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$i(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$C($.key),$)}}function _createClass$i(o,i,_){return i&&_defineProperties$i(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$e(o,i,_){return i=_getPrototypeOf$f(i),_possibleConstructorReturn$f(o,_isNativeReflectConstruct$f()?Reflect.construct(i,_||[],_getPrototypeOf$f(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$f(o,i){if(i&&(_typeof$C(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$f(o)}function _assertThisInitialized$f(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$f(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$f=function(){return!!o})()}function _getPrototypeOf$f(o){return _getPrototypeOf$f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$f(o)}function _inherits$f(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$f(o,i)}function _setPrototypeOf$f(o,i){return _setPrototypeOf$f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$f(o,i)}function _defineProperty$B(o,i,_){return i=_toPropertyKey$C(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$C(o){var i=_toPrimitive$C(o,"string");return _typeof$C(i)=="symbol"?i:i+""}function _toPrimitive$C(o,i){if(_typeof$C(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$C($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function defaultUniqBy(o){return o.dataKey}function renderContent(o,i){return React$2.isValidElement(o)?React$2.cloneElement(o,i):typeof o=="function"?React$2.createElement(o,i):React$2.createElement(DefaultTooltipContent,i)}var Tooltip=function(o){function i(){return _classCallCheck$i(this,i),_callSuper$e(this,i,arguments)}return _inherits$f(i,o),_createClass$i(i,[{key:"render",value:function(){var $=this,j=this.props,_e=j.active,et=j.allowEscapeViewBox,tt=j.animationDuration,rt=j.animationEasing,nt=j.content,it=j.coordinate,st=j.filterNull,at=j.isAnimationActive,ot=j.offset,lt=j.payload,ct=j.payloadUniqBy,ft=j.position,ut=j.reverseDirection,ht=j.useTranslate3d,dt=j.viewBox,mt=j.wrapperStyle,pt=lt??[];st&&pt.length&&(pt=getUniqPayload(lt.filter(function(gt){return gt.value!=null&&(gt.hide!==!0||$.props.includeHidden)}),ct,defaultUniqBy));var yt=pt.length>0;return React$2.createElement(TooltipBoundingBox,{allowEscapeViewBox:et,animationDuration:tt,animationEasing:rt,isAnimationActive:at,active:_e,coordinate:it,hasPayload:yt,offset:ot,position:ft,reverseDirection:ut,useTranslate3d:ht,viewBox:dt,wrapperStyle:mt},renderContent(nt,_objectSpread$w(_objectSpread$w({},this.props),{},{payload:pt})))}}])}(reactExports.PureComponent);_defineProperty$B(Tooltip,"displayName","Tooltip");_defineProperty$B(Tooltip,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Global.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var root=_root,now$2=function(){return root.Date.now()},now_1=now$2,reWhitespace=/\s/;function trimmedEndIndex$1(o){for(var i=o.length;i--&&reWhitespace.test(o.charAt(i)););return i}var _trimmedEndIndex=trimmedEndIndex$1,trimmedEndIndex=_trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim$1(o){return o&&o.slice(0,trimmedEndIndex(o)+1).replace(reTrimStart,"")}var _baseTrim=baseTrim$1,baseTrim=_baseTrim,isObject$2=isObject_1,isSymbol$1=isSymbol_1,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$3(o){if(typeof o=="number")return o;if(isSymbol$1(o))return NAN;if(isObject$2(o)){var i=typeof o.valueOf=="function"?o.valueOf():o;o=isObject$2(i)?i+"":i}if(typeof o!="string")return o===0?o:+o;o=baseTrim(o);var _=reIsBinary.test(o);return _||reIsOctal.test(o)?freeParseInt(o.slice(2),_?2:8):reIsBadHex.test(o)?NAN:+o}var toNumber_1=toNumber$3,isObject$1=isObject_1,now$1=now_1,toNumber$2=toNumber_1,FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin=Math.min;function debounce$1(o,i,_){var $,j,_e,et,tt,rt,nt=0,it=!1,st=!1,at=!0;if(typeof o!="function")throw new TypeError(FUNC_ERROR_TEXT$1);i=toNumber$2(i)||0,isObject$1(_)&&(it=!!_.leading,st="maxWait"in _,_e=st?nativeMax$1(toNumber$2(_.maxWait)||0,i):_e,at="trailing"in _?!!_.trailing:at);function ot(yt){var gt=$,vt=j;return $=j=void 0,nt=yt,et=o.apply(vt,gt),et}function lt(yt){return nt=yt,tt=setTimeout(ut,i),it?ot(yt):et}function ct(yt){var gt=yt-rt,vt=yt-nt,St=i-gt;return st?nativeMin(St,_e-vt):St}function ft(yt){var gt=yt-rt,vt=yt-nt;return rt===void 0||gt>=i||gt<0||st&&vt>=_e}function ut(){var yt=now$1();if(ft(yt))return ht(yt);tt=setTimeout(ut,ct(yt))}function ht(yt){return tt=void 0,at&&$?ot(yt):($=j=void 0,et)}function dt(){tt!==void 0&&clearTimeout(tt),nt=0,$=rt=j=tt=void 0}function mt(){return tt===void 0?et:ht(now$1())}function pt(){var yt=now$1(),gt=ft(yt);if($=arguments,j=this,rt=yt,gt){if(tt===void 0)return lt(rt);if(st)return clearTimeout(tt),tt=setTimeout(ut,i),ot(rt)}return tt===void 0&&(tt=setTimeout(ut,i)),et}return pt.cancel=dt,pt.flush=mt,pt}var debounce_1=debounce$1,debounce=debounce_1,isObject=isObject_1,FUNC_ERROR_TEXT="Expected a function";function throttle(o,i,_){var $=!0,j=!0;if(typeof o!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject(_)&&($="leading"in _?!!_.leading:$,j="trailing"in _?!!_.trailing:j),debounce(o,i,{leading:$,maxWait:i,trailing:j})}var throttle_1=throttle;const throttle$1=getDefaultExportFromCjs$1(throttle_1);function _typeof$B(o){"@babel/helpers - typeof";return _typeof$B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$B(o)}function ownKeys$w(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$v(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$w(Object(_),!0).forEach(function($){_defineProperty$A(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$w(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$A(o,i,_){return i=_toPropertyKey$B(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$B(o){var i=_toPrimitive$B(o,"string");return _typeof$B(i)=="symbol"?i:i+""}function _toPrimitive$B(o,i){if(_typeof$B(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$B($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _slicedToArray$b(o,i){return _arrayWithHoles$c(o)||_iterableToArrayLimit$b(o,i)||_unsupportedIterableToArray$k(o,i)||_nonIterableRest$c()}function _nonIterableRest$c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$k(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$k(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$k(o,i)}}function _arrayLikeToArray$k(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$b(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$c(o){if(Array.isArray(o))return o}var ResponsiveContainer=reactExports.forwardRef(function(o,i){var _=o.aspect,$=o.initialDimension,j=$===void 0?{width:-1,height:-1}:$,_e=o.width,et=_e===void 0?"100%":_e,tt=o.height,rt=tt===void 0?"100%":tt,nt=o.minWidth,it=nt===void 0?0:nt,st=o.minHeight,at=o.maxHeight,ot=o.children,lt=o.debounce,ct=lt===void 0?0:lt,ft=o.id,ut=o.className,ht=o.onResize,dt=o.style,mt=dt===void 0?{}:dt,pt=reactExports.useRef(null),yt=reactExports.useRef();yt.current=ht,reactExports.useImperativeHandle(i,function(){return Object.defineProperty(pt.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),pt.current},configurable:!0})});var gt=reactExports.useState({containerWidth:j.width,containerHeight:j.height}),vt=_slicedToArray$b(gt,2),St=vt[0],At=vt[1],xt=reactExports.useCallback(function(Ot,Bt){At(function(Ft){var Pt=Math.round(Ot),Rt=Math.round(Bt);return Ft.containerWidth===Pt&&Ft.containerHeight===Rt?Ft:{containerWidth:Pt,containerHeight:Rt}})},[]);reactExports.useEffect(function(){var Ot=function(_t){var Mt,Dt=_t[0].contentRect,Lt=Dt.width,Ct=Dt.height;xt(Lt,Ct),(Mt=yt.current)===null||Mt===void 0||Mt.call(yt,Lt,Ct)};ct>0&&(Ot=throttle$1(Ot,ct,{trailing:!0,leading:!1}));var Bt=new ResizeObserver(Ot),Ft=pt.current.getBoundingClientRect(),Pt=Ft.width,Rt=Ft.height;return xt(Pt,Rt),Bt.observe(pt.current),function(){Bt.disconnect()}},[xt,ct]);var wt=reactExports.useMemo(function(){var Ot=St.containerWidth,Bt=St.containerHeight;if(Ot<0||Bt<0)return null;warn(isPercent(et)||isPercent(rt),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,et,rt),warn(!_||_>0,"The aspect(%s) must be greater than zero.",_);var Ft=isPercent(et)?Ot:et,Pt=isPercent(rt)?Bt:rt;_&&_>0&&(Ft?Pt=Ft/_:Pt&&(Ft=Pt*_),at&&Pt>at&&(Pt=at)),warn(Ft>0||Pt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ft,Pt,et,rt,it,st,_);var Rt=!Array.isArray(ot)&&getDisplayName(ot.type).endsWith("Chart");return React$2.Children.map(ot,function(Et){return React$2.isValidElement(Et)?reactExports.cloneElement(Et,_objectSpread$v({width:Ft,height:Pt},Rt?{style:_objectSpread$v({height:"100%",width:"100%",maxHeight:Pt,maxWidth:Ft},Et.props.style)}:{})):Et})},[_,ot,rt,at,st,it,St,et]);return React$2.createElement("div",{id:ft?"".concat(ft):void 0,className:clsx("recharts-responsive-container",ut),style:_objectSpread$v(_objectSpread$v({},mt),{},{width:et,height:rt,minWidth:it,minHeight:st,maxHeight:at}),ref:pt},wt)}),Cell=function o(i){return null};Cell.displayName="Cell";function _typeof$A(o){"@babel/helpers - typeof";return _typeof$A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$A(o)}function ownKeys$v(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$u(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$v(Object(_),!0).forEach(function($){_defineProperty$z(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$v(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$z(o,i,_){return i=_toPropertyKey$A(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$A(o){var i=_toPrimitive$A(o,"string");return _typeof$A(i)=="symbol"?i:i+""}function _toPrimitive$A(o,i){if(_typeof$A(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$A($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var stringCache={widthCache:{},cacheCount:0},MAX_CACHE_NUM=2e3,SPAN_STYLE={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MEASUREMENT_SPAN_ID="recharts_measurement_span";function removeInvalidKeys(o){var i=_objectSpread$u({},o);return Object.keys(i).forEach(function(_){i[_]||delete i[_]}),i}var getStringSize=function o(i){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i==null||Global.isSsr)return{width:0,height:0};var $=removeInvalidKeys(_),j=JSON.stringify({text:i,copyStyle:$});if(stringCache.widthCache[j])return stringCache.widthCache[j];try{var _e=document.getElementById(MEASUREMENT_SPAN_ID);_e||(_e=document.createElement("span"),_e.setAttribute("id",MEASUREMENT_SPAN_ID),_e.setAttribute("aria-hidden","true"),document.body.appendChild(_e));var et=_objectSpread$u(_objectSpread$u({},SPAN_STYLE),$);Object.assign(_e.style,et),_e.textContent="".concat(i);var tt=_e.getBoundingClientRect(),rt={width:tt.width,height:tt.height};return stringCache.widthCache[j]=rt,++stringCache.cacheCount>MAX_CACHE_NUM&&(stringCache.cacheCount=0,stringCache.widthCache={}),rt}catch{return{width:0,height:0}}},getOffset=function o(i){return{top:i.top+window.scrollY-document.documentElement.clientTop,left:i.left+window.scrollX-document.documentElement.clientLeft}};function _typeof$z(o){"@babel/helpers - typeof";return _typeof$z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$z(o)}function _slicedToArray$a(o,i){return _arrayWithHoles$b(o)||_iterableToArrayLimit$a(o,i)||_unsupportedIterableToArray$j(o,i)||_nonIterableRest$b()}function _nonIterableRest$b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$j(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$j(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$j(o,i)}}function _arrayLikeToArray$j(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$a(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i===0){if(Object(_)!==_)return;rt=!1}else for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$b(o){if(Array.isArray(o))return o}function _classCallCheck$h(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$h(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$z($.key),$)}}function _createClass$h(o,i,_){return i&&_defineProperties$h(o.prototype,i),_&&_defineProperties$h(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _toPropertyKey$z(o){var i=_toPrimitive$z(o,"string");return _typeof$z(i)=="symbol"?i:i+""}function _toPrimitive$z(o,i){if(_typeof$z(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$z($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var MULTIPLY_OR_DIVIDE_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ADD_OR_SUBTRACT_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CSS_LENGTH_UNIT_REGEX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,NUM_SPLIT_REGEX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CONVERSION_RATES={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FIXED_CSS_LENGTH_UNITS=Object.keys(CONVERSION_RATES),STR_NAN="NaN";function convertToPx(o,i){return o*CONVERSION_RATES[i]}var DecimalCSS=function(){function o(i,_){_classCallCheck$h(this,o),this.num=i,this.unit=_,this.num=i,this.unit=_,Number.isNaN(i)&&(this.unit=""),_!==""&&!CSS_LENGTH_UNIT_REGEX.test(_)&&(this.num=NaN,this.unit=""),FIXED_CSS_LENGTH_UNITS.includes(_)&&(this.num=convertToPx(i,_),this.unit="px")}return _createClass$h(o,[{key:"add",value:function(_){return this.unit!==_.unit?new o(NaN,""):new o(this.num+_.num,this.unit)}},{key:"subtract",value:function(_){return this.unit!==_.unit?new o(NaN,""):new o(this.num-_.num,this.unit)}},{key:"multiply",value:function(_){return this.unit!==""&&_.unit!==""&&this.unit!==_.unit?new o(NaN,""):new o(this.num*_.num,this.unit||_.unit)}},{key:"divide",value:function(_){return this.unit!==""&&_.unit!==""&&this.unit!==_.unit?new o(NaN,""):new o(this.num/_.num,this.unit||_.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(_){var $,j=($=NUM_SPLIT_REGEX.exec(_))!==null&&$!==void 0?$:[],_e=_slicedToArray$a(j,3),et=_e[1],tt=_e[2];return new o(parseFloat(et),tt??"")}}])}();function calculateArithmetic(o){if(o.includes(STR_NAN))return STR_NAN;for(var i=o;i.includes("*")||i.includes("/");){var _,$=(_=MULTIPLY_OR_DIVIDE_REGEX.exec(i))!==null&&_!==void 0?_:[],j=_slicedToArray$a($,4),_e=j[1],et=j[2],tt=j[3],rt=DecimalCSS.parse(_e??""),nt=DecimalCSS.parse(tt??""),it=et==="*"?rt.multiply(nt):rt.divide(nt);if(it.isNaN())return STR_NAN;i=i.replace(MULTIPLY_OR_DIVIDE_REGEX,it.toString())}for(;i.includes("+")||/.-\d+(?:\.\d+)?/.test(i);){var st,at=(st=ADD_OR_SUBTRACT_REGEX.exec(i))!==null&&st!==void 0?st:[],ot=_slicedToArray$a(at,4),lt=ot[1],ct=ot[2],ft=ot[3],ut=DecimalCSS.parse(lt??""),ht=DecimalCSS.parse(ft??""),dt=ct==="+"?ut.add(ht):ut.subtract(ht);if(dt.isNaN())return STR_NAN;i=i.replace(ADD_OR_SUBTRACT_REGEX,dt.toString())}return i}var PARENTHESES_REGEX=/\(([^()]*)\)/;function calculateParentheses(o){for(var i=o;i.includes("(");){var _=PARENTHESES_REGEX.exec(i),$=_slicedToArray$a(_,2),j=$[1];i=i.replace(PARENTHESES_REGEX,calculateArithmetic(j))}return i}function evaluateExpression(o){var i=o.replace(/\s+/g,"");return i=calculateParentheses(i),i=calculateArithmetic(i),i}function safeEvaluateExpression(o){try{return evaluateExpression(o)}catch{return STR_NAN}}function reduceCSSCalc(o){var i=safeEvaluateExpression(o.slice(5,-1));return i===STR_NAN?"":i}var _excluded$d=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],_excluded2$5=["dx","dy","angle","className","breakAll"];function _extends$p(){return _extends$p=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$p.apply(this,arguments)}function _objectWithoutProperties$d(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$d(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$d(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _slicedToArray$9(o,i){return _arrayWithHoles$a(o)||_iterableToArrayLimit$9(o,i)||_unsupportedIterableToArray$i(o,i)||_nonIterableRest$a()}function _nonIterableRest$a(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$i(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$i(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$i(o,i)}}function _arrayLikeToArray$i(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$9(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i===0){if(Object(_)!==_)return;rt=!1}else for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$a(o){if(Array.isArray(o))return o}var BREAKING_SPACES=/[ \f\n\r\t\v\u2028\u2029]+/,calculateWordWidths=function o(i){var _=i.children,$=i.breakAll,j=i.style;try{var _e=[];isNil$1(_)||($?_e=_.toString().split(""):_e=_.toString().split(BREAKING_SPACES));var et=_e.map(function(rt){return{word:rt,width:getStringSize(rt,j).width}}),tt=$?0:getStringSize("",j).width;return{wordsWithComputedWidth:et,spaceWidth:tt}}catch{return null}},calculateWordsByLines=function o(i,_,$,j,_e){var et=i.maxLines,tt=i.children,rt=i.style,nt=i.breakAll,it=isNumber(et),st=tt,at=function(){var Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ft.reduce(function(Pt,Rt){var Et=Rt.word,_t=Rt.width,Mt=Pt[Pt.length-1];if(Mt&&(j==null||_e||Mt.width+_t+$<Number(j)))Mt.words.push(Et),Mt.width+=_t+$;else{var Dt={words:[Et],width:_t};Pt.push(Dt)}return Pt},[])},ot=at(_),lt=function(Ft){return Ft.reduce(function(Pt,Rt){return Pt.width>Rt.width?Pt:Rt})};if(!it)return ot;for(var ct="",ft=function(Ft){var Pt=st.slice(0,Ft),Rt=calculateWordWidths({breakAll:nt,style:rt,children:Pt+ct}).wordsWithComputedWidth,Et=at(Rt),_t=Et.length>et||lt(Et).width>Number(j);return[_t,Et]},ut=0,ht=st.length-1,dt=0,mt;ut<=ht&&dt<=st.length-1;){var pt=Math.floor((ut+ht)/2),yt=pt-1,gt=ft(yt),vt=_slicedToArray$9(gt,2),St=vt[0],At=vt[1],xt=ft(pt),wt=_slicedToArray$9(xt,1),Ot=wt[0];if(!St&&!Ot&&(ut=pt+1),St&&Ot&&(ht=pt-1),!St&&Ot){mt=At;break}dt++}return mt||ot},getWordsWithoutCalculate=function o(i){var _=isNil$1(i)?[]:i.toString().split(BREAKING_SPACES);return[{words:_}]},getWordsByLines=function o(i){var _=i.width,$=i.scaleToFit,j=i.children,_e=i.style,et=i.breakAll,tt=i.maxLines;if((_||$)&&!Global.isSsr){var rt,nt,it=calculateWordWidths({breakAll:et,children:j,style:_e});if(it){var st=it.wordsWithComputedWidth,at=it.spaceWidth;rt=st,nt=at}else return getWordsWithoutCalculate(j);return calculateWordsByLines({breakAll:et,children:j,maxLines:tt,style:_e},rt,nt,_,$)}return getWordsWithoutCalculate(j)},DEFAULT_FILL="#808080",Text=function o(i){var _=i.x,$=_===void 0?0:_,j=i.y,_e=j===void 0?0:j,et=i.lineHeight,tt=et===void 0?"1em":et,rt=i.capHeight,nt=rt===void 0?"0.71em":rt,it=i.scaleToFit,st=it===void 0?!1:it,at=i.textAnchor,ot=at===void 0?"start":at,lt=i.verticalAnchor,ct=lt===void 0?"end":lt,ft=i.fill,ut=ft===void 0?DEFAULT_FILL:ft,ht=_objectWithoutProperties$d(i,_excluded$d),dt=reactExports.useMemo(function(){return getWordsByLines({breakAll:ht.breakAll,children:ht.children,maxLines:ht.maxLines,scaleToFit:st,style:ht.style,width:ht.width})},[ht.breakAll,ht.children,ht.maxLines,st,ht.style,ht.width]),mt=ht.dx,pt=ht.dy,yt=ht.angle,gt=ht.className,vt=ht.breakAll,St=_objectWithoutProperties$d(ht,_excluded2$5);if(!isNumOrStr($)||!isNumOrStr(_e))return null;var At=$+(isNumber(mt)?mt:0),xt=_e+(isNumber(pt)?pt:0),wt;switch(ct){case"start":wt=reduceCSSCalc("calc(".concat(nt,")"));break;case"middle":wt=reduceCSSCalc("calc(".concat((dt.length-1)/2," * -").concat(tt," + (").concat(nt," / 2))"));break;default:wt=reduceCSSCalc("calc(".concat(dt.length-1," * -").concat(tt,")"));break}var Ot=[];if(st){var Bt=dt[0].width,Ft=ht.width;Ot.push("scale(".concat((isNumber(Ft)?Ft/Bt:1)/Bt,")"))}return yt&&Ot.push("rotate(".concat(yt,", ").concat(At,", ").concat(xt,")")),Ot.length&&(St.transform=Ot.join(" ")),React$2.createElement("text",_extends$p({},filterProps(St,!0),{x:At,y:xt,className:clsx("recharts-text",gt),textAnchor:ot,fill:ut.includes("url")?DEFAULT_FILL:ut}),dt.map(function(Pt,Rt){var Et=Pt.words.join(vt?"":" ");return React$2.createElement("tspan",{x:At,dy:Rt===0?wt:tt,key:"".concat(Et,"-").concat(Rt)},Et)}))};function ascending(o,i){return o==null||i==null?NaN:o<i?-1:o>i?1:o>=i?0:NaN}function descending(o,i){return o==null||i==null?NaN:i<o?-1:i>o?1:i>=o?0:NaN}function bisector(o){let i,_,$;o.length!==2?(i=ascending,_=(tt,rt)=>ascending(o(tt),rt),$=(tt,rt)=>o(tt)-rt):(i=o===ascending||o===descending?o:zero$1,_=o,$=o);function j(tt,rt,nt=0,it=tt.length){if(nt<it){if(i(rt,rt)!==0)return it;do{const st=nt+it>>>1;_(tt[st],rt)<0?nt=st+1:it=st}while(nt<it)}return nt}function _e(tt,rt,nt=0,it=tt.length){if(nt<it){if(i(rt,rt)!==0)return it;do{const st=nt+it>>>1;_(tt[st],rt)<=0?nt=st+1:it=st}while(nt<it)}return nt}function et(tt,rt,nt=0,it=tt.length){const st=j(tt,rt,nt,it-1);return st>nt&&$(tt[st-1],rt)>-$(tt[st],rt)?st-1:st}return{left:j,center:et,right:_e}}function zero$1(){return 0}function number$2(o){return o===null?NaN:+o}function*numbers(o,i){for(let _ of o)_!=null&&(_=+_)>=_&&(yield _)}const ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right;bisector(number$2).center;class InternMap extends Map{constructor(i,_=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:_}}),i!=null)for(const[$,j]of i)this.set($,j)}get(i){return super.get(intern_get(this,i))}has(i){return super.has(intern_get(this,i))}set(i,_){return super.set(intern_set(this,i),_)}delete(i){return super.delete(intern_delete(this,i))}}function intern_get({_intern:o,_key:i},_){const $=i(_);return o.has($)?o.get($):_}function intern_set({_intern:o,_key:i},_){const $=i(_);return o.has($)?o.get($):(o.set($,_),_)}function intern_delete({_intern:o,_key:i},_){const $=i(_);return o.has($)&&(_=o.get($),o.delete($)),_}function keyof(o){return o!==null&&typeof o=="object"?o.valueOf():o}function compareDefined(o=ascending){if(o===ascending)return ascendingDefined;if(typeof o!="function")throw new TypeError("compare is not a function");return(i,_)=>{const $=o(i,_);return $||$===0?$:(o(_,_)===0)-(o(i,i)===0)}}function ascendingDefined(o,i){return(o==null||!(o>=o))-(i==null||!(i>=i))||(o<i?-1:o>i?1:0)}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(o,i,_){const $=(i-o)/Math.max(0,_),j=Math.floor(Math.log10($)),_e=$/Math.pow(10,j),et=_e>=e10?10:_e>=e5?5:_e>=e2?2:1;let tt,rt,nt;return j<0?(nt=Math.pow(10,-j)/et,tt=Math.round(o*nt),rt=Math.round(i*nt),tt/nt<o&&++tt,rt/nt>i&&--rt,nt=-nt):(nt=Math.pow(10,j)*et,tt=Math.round(o/nt),rt=Math.round(i/nt),tt*nt<o&&++tt,rt*nt>i&&--rt),rt<tt&&.5<=_&&_<2?tickSpec(o,i,_*2):[tt,rt,nt]}function ticks(o,i,_){if(i=+i,o=+o,_=+_,!(_>0))return[];if(o===i)return[o];const $=i<o,[j,_e,et]=$?tickSpec(i,o,_):tickSpec(o,i,_);if(!(_e>=j))return[];const tt=_e-j+1,rt=new Array(tt);if($)if(et<0)for(let nt=0;nt<tt;++nt)rt[nt]=(_e-nt)/-et;else for(let nt=0;nt<tt;++nt)rt[nt]=(_e-nt)*et;else if(et<0)for(let nt=0;nt<tt;++nt)rt[nt]=(j+nt)/-et;else for(let nt=0;nt<tt;++nt)rt[nt]=(j+nt)*et;return rt}function tickIncrement(o,i,_){return i=+i,o=+o,_=+_,tickSpec(o,i,_)[2]}function tickStep(o,i,_){i=+i,o=+o,_=+_;const $=i<o,j=$?tickIncrement(i,o,_):tickIncrement(o,i,_);return($?-1:1)*(j<0?1/-j:j)}function max$2(o,i){let _;for(const $ of o)$!=null&&(_<$||_===void 0&&$>=$)&&(_=$);return _}function min$2(o,i){let _;for(const $ of o)$!=null&&(_>$||_===void 0&&$>=$)&&(_=$);return _}function quickselect(o,i,_=0,$=1/0,j){if(i=Math.floor(i),_=Math.floor(Math.max(0,_)),$=Math.floor(Math.min(o.length-1,$)),!(_<=i&&i<=$))return o;for(j=j===void 0?ascendingDefined:compareDefined(j);$>_;){if($-_>600){const rt=$-_+1,nt=i-_+1,it=Math.log(rt),st=.5*Math.exp(2*it/3),at=.5*Math.sqrt(it*st*(rt-st)/rt)*(nt-rt/2<0?-1:1),ot=Math.max(_,Math.floor(i-nt*st/rt+at)),lt=Math.min($,Math.floor(i+(rt-nt)*st/rt+at));quickselect(o,i,ot,lt,j)}const _e=o[i];let et=_,tt=$;for(swap(o,_,i),j(o[$],_e)>0&&swap(o,_,$);et<tt;){for(swap(o,et,tt),++et,--tt;j(o[et],_e)<0;)++et;for(;j(o[tt],_e)>0;)--tt}j(o[_],_e)===0?swap(o,_,tt):(++tt,swap(o,tt,$)),tt<=i&&(_=tt+1),i<=tt&&($=tt-1)}return o}function swap(o,i,_){const $=o[i];o[i]=o[_],o[_]=$}function quantile$1(o,i,_){if(o=Float64Array.from(numbers(o)),!(!($=o.length)||isNaN(i=+i))){if(i<=0||$<2)return min$2(o);if(i>=1)return max$2(o);var $,j=($-1)*i,_e=Math.floor(j),et=max$2(quickselect(o,_e).subarray(0,_e+1)),tt=min$2(o.subarray(_e+1));return et+(tt-et)*(j-_e)}}function quantileSorted(o,i,_=number$2){if(!(!($=o.length)||isNaN(i=+i))){if(i<=0||$<2)return+_(o[0],0,o);if(i>=1)return+_(o[$-1],$-1,o);var $,j=($-1)*i,_e=Math.floor(j),et=+_(o[_e],_e,o),tt=+_(o[_e+1],_e+1,o);return et+(tt-et)*(j-_e)}}function range$3(o,i,_){o=+o,i=+i,_=(j=arguments.length)<2?(i=o,o=0,1):j<3?1:+_;for(var $=-1,j=Math.max(0,Math.ceil((i-o)/_))|0,_e=new Array(j);++$<j;)_e[$]=o+$*_;return _e}function initRange(o,i){switch(arguments.length){case 0:break;case 1:this.range(o);break;default:this.range(i).domain(o);break}return this}function initInterpolator(o,i){switch(arguments.length){case 0:break;case 1:{typeof o=="function"?this.interpolator(o):this.range(o);break}default:{this.domain(o),typeof i=="function"?this.interpolator(i):this.range(i);break}}return this}const implicit=Symbol("implicit");function ordinal(){var o=new InternMap,i=[],_=[],$=implicit;function j(_e){let et=o.get(_e);if(et===void 0){if($!==implicit)return $;o.set(_e,et=i.push(_e)-1)}return _[et%_.length]}return j.domain=function(_e){if(!arguments.length)return i.slice();i=[],o=new InternMap;for(const et of _e)o.has(et)||o.set(et,i.push(et)-1);return j},j.range=function(_e){return arguments.length?(_=Array.from(_e),j):_.slice()},j.unknown=function(_e){return arguments.length?($=_e,j):$},j.copy=function(){return ordinal(i,_).unknown($)},initRange.apply(j,arguments),j}function band(){var o=ordinal().unknown(void 0),i=o.domain,_=o.range,$=0,j=1,_e,et,tt=!1,rt=0,nt=0,it=.5;delete o.unknown;function st(){var at=i().length,ot=j<$,lt=ot?j:$,ct=ot?$:j;_e=(ct-lt)/Math.max(1,at-rt+nt*2),tt&&(_e=Math.floor(_e)),lt+=(ct-lt-_e*(at-rt))*it,et=_e*(1-rt),tt&&(lt=Math.round(lt),et=Math.round(et));var ft=range$3(at).map(function(ut){return lt+_e*ut});return _(ot?ft.reverse():ft)}return o.domain=function(at){return arguments.length?(i(at),st()):i()},o.range=function(at){return arguments.length?([$,j]=at,$=+$,j=+j,st()):[$,j]},o.rangeRound=function(at){return[$,j]=at,$=+$,j=+j,tt=!0,st()},o.bandwidth=function(){return et},o.step=function(){return _e},o.round=function(at){return arguments.length?(tt=!!at,st()):tt},o.padding=function(at){return arguments.length?(rt=Math.min(1,nt=+at),st()):rt},o.paddingInner=function(at){return arguments.length?(rt=Math.min(1,at),st()):rt},o.paddingOuter=function(at){return arguments.length?(nt=+at,st()):nt},o.align=function(at){return arguments.length?(it=Math.max(0,Math.min(1,at)),st()):it},o.copy=function(){return band(i(),[$,j]).round(tt).paddingInner(rt).paddingOuter(nt).align(it)},initRange.apply(st(),arguments)}function pointish(o){var i=o.copy;return o.padding=o.paddingOuter,delete o.paddingInner,delete o.paddingOuter,o.copy=function(){return pointish(i())},o}function point(){return pointish(band.apply(null,arguments).paddingInner(1))}function define(o,i,_){o.prototype=i.prototype=_,_.constructor=o}function extend(o,i){var _=Object.create(o.prototype);for(var $ in i)_[$]=i[$];return _}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(o){return Object.assign(new this.constructor,this,o)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(o){var i,_;return o=(o+"").trim().toLowerCase(),(i=reHex.exec(o))?(_=i[1].length,i=parseInt(i[1],16),_===6?rgbn(i):_===3?new Rgb(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):_===8?rgba(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):_===4?rgba(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=reRgbInteger.exec(o))?new Rgb(i[1],i[2],i[3],1):(i=reRgbPercent.exec(o))?new Rgb(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=reRgbaInteger.exec(o))?rgba(i[1],i[2],i[3],i[4]):(i=reRgbaPercent.exec(o))?rgba(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=reHslPercent.exec(o))?hsla(i[1],i[2]/100,i[3]/100,1):(i=reHslaPercent.exec(o))?hsla(i[1],i[2]/100,i[3]/100,i[4]):named.hasOwnProperty(o)?rgbn(named[o]):o==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(o){return new Rgb(o>>16&255,o>>8&255,o&255,1)}function rgba(o,i,_,$){return $<=0&&(o=i=_=NaN),new Rgb(o,i,_,$)}function rgbConvert(o){return o instanceof Color||(o=color(o)),o?(o=o.rgb(),new Rgb(o.r,o.g,o.b,o.opacity)):new Rgb}function rgb$1(o,i,_,$){return arguments.length===1?rgbConvert(o):new Rgb(o,i,_,$??1)}function Rgb(o,i,_,$){this.r=+o,this.g=+i,this.b=+_,this.opacity=+$}define(Rgb,rgb$1,extend(Color,{brighter(o){return o=o==null?brighter:Math.pow(brighter,o),new Rgb(this.r*o,this.g*o,this.b*o,this.opacity)},darker(o){return o=o==null?darker:Math.pow(darker,o),new Rgb(this.r*o,this.g*o,this.b*o,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const o=clampa(this.opacity);return`${o===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${o===1?")":`, ${o})`}`}function clampa(o){return isNaN(o)?1:Math.max(0,Math.min(1,o))}function clampi(o){return Math.max(0,Math.min(255,Math.round(o)||0))}function hex(o){return o=clampi(o),(o<16?"0":"")+o.toString(16)}function hsla(o,i,_,$){return $<=0?o=i=_=NaN:_<=0||_>=1?o=i=NaN:i<=0&&(o=NaN),new Hsl(o,i,_,$)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;o=o.rgb();var i=o.r/255,_=o.g/255,$=o.b/255,j=Math.min(i,_,$),_e=Math.max(i,_,$),et=NaN,tt=_e-j,rt=(_e+j)/2;return tt?(i===_e?et=(_-$)/tt+(_<$)*6:_===_e?et=($-i)/tt+2:et=(i-_)/tt+4,tt/=rt<.5?_e+j:2-_e-j,et*=60):tt=rt>0&&rt<1?0:et,new Hsl(et,tt,rt,o.opacity)}function hsl(o,i,_,$){return arguments.length===1?hslConvert(o):new Hsl(o,i,_,$??1)}function Hsl(o,i,_,$){this.h=+o,this.s=+i,this.l=+_,this.opacity=+$}define(Hsl,hsl,extend(Color,{brighter(o){return o=o==null?brighter:Math.pow(brighter,o),new Hsl(this.h,this.s,this.l*o,this.opacity)},darker(o){return o=o==null?darker:Math.pow(darker,o),new Hsl(this.h,this.s,this.l*o,this.opacity)},rgb(){var o=this.h%360+(this.h<0)*360,i=isNaN(o)||isNaN(this.s)?0:this.s,_=this.l,$=_+(_<.5?_:1-_)*i,j=2*_-$;return new Rgb(hsl2rgb(o>=240?o-240:o+120,j,$),hsl2rgb(o,j,$),hsl2rgb(o<120?o+240:o-120,j,$),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const o=clampa(this.opacity);return`${o===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${o===1?")":`, ${o})`}`}}));function clamph(o){return o=(o||0)%360,o<0?o+360:o}function clampt(o){return Math.max(0,Math.min(1,o||0))}function hsl2rgb(o,i,_){return(o<60?i+(_-i)*o/60:o<180?_:o<240?i+(_-i)*(240-o)/60:i)*255}const constant=o=>()=>o;function linear$1(o,i){return function(_){return o+_*i}}function exponential(o,i,_){return o=Math.pow(o,_),i=Math.pow(i,_)-o,_=1/_,function($){return Math.pow(o+$*i,_)}}function gamma(o){return(o=+o)==1?nogamma:function(i,_){return _-i?exponential(i,_,o):constant(isNaN(i)?_:i)}}function nogamma(o,i){var _=i-o;return _?linear$1(o,_):constant(isNaN(o)?i:o)}const rgb=function o(i){var _=gamma(i);function $(j,_e){var et=_((j=rgb$1(j)).r,(_e=rgb$1(_e)).r),tt=_(j.g,_e.g),rt=_(j.b,_e.b),nt=nogamma(j.opacity,_e.opacity);return function(it){return j.r=et(it),j.g=tt(it),j.b=rt(it),j.opacity=nt(it),j+""}}return $.gamma=o,$}(1);function numberArray(o,i){i||(i=[]);var _=o?Math.min(i.length,o.length):0,$=i.slice(),j;return function(_e){for(j=0;j<_;++j)$[j]=o[j]*(1-_e)+i[j]*_e;return $}}function isNumberArray(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)}function genericArray(o,i){var _=i?i.length:0,$=o?Math.min(_,o.length):0,j=new Array($),_e=new Array(_),et;for(et=0;et<$;++et)j[et]=interpolate(o[et],i[et]);for(;et<_;++et)_e[et]=i[et];return function(tt){for(et=0;et<$;++et)_e[et]=j[et](tt);return _e}}function date$1(o,i){var _=new Date;return o=+o,i=+i,function($){return _.setTime(o*(1-$)+i*$),_}}function interpolateNumber$1(o,i){return o=+o,i=+i,function(_){return o*(1-_)+i*_}}function object(o,i){var _={},$={},j;(o===null||typeof o!="object")&&(o={}),(i===null||typeof i!="object")&&(i={});for(j in i)j in o?_[j]=interpolate(o[j],i[j]):$[j]=i[j];return function(_e){for(j in _)$[j]=_[j](_e);return $}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(o){return function(){return o}}function one(o){return function(i){return o(i)+""}}function string(o,i){var _=reA.lastIndex=reB.lastIndex=0,$,j,_e,et=-1,tt=[],rt=[];for(o=o+"",i=i+"";($=reA.exec(o))&&(j=reB.exec(i));)(_e=j.index)>_&&(_e=i.slice(_,_e),tt[et]?tt[et]+=_e:tt[++et]=_e),($=$[0])===(j=j[0])?tt[et]?tt[et]+=j:tt[++et]=j:(tt[++et]=null,rt.push({i:et,x:interpolateNumber$1($,j)})),_=reB.lastIndex;return _<i.length&&(_e=i.slice(_),tt[et]?tt[et]+=_e:tt[++et]=_e),tt.length<2?rt[0]?one(rt[0].x):zero(i):(i=rt.length,function(nt){for(var it=0,st;it<i;++it)tt[(st=rt[it]).i]=st.x(nt);return tt.join("")})}function interpolate(o,i){var _=typeof i,$;return i==null||_==="boolean"?constant(i):(_==="number"?interpolateNumber$1:_==="string"?($=color(i))?(i=$,rgb):string:i instanceof color?rgb:i instanceof Date?date$1:isNumberArray(i)?numberArray:Array.isArray(i)?genericArray:typeof i.valueOf!="function"&&typeof i.toString!="function"||isNaN(i)?object:interpolateNumber$1)(o,i)}function interpolateRound(o,i){return o=+o,i=+i,function(_){return Math.round(o*(1-_)+i*_)}}function piecewise(o,i){i===void 0&&(i=o,o=interpolate);for(var _=0,$=i.length-1,j=i[0],_e=new Array($<0?0:$);_<$;)_e[_]=o(j,j=i[++_]);return function(et){var tt=Math.max(0,Math.min($-1,Math.floor(et*=$)));return _e[tt](et-tt)}}function constants(o){return function(){return o}}function number$1(o){return+o}var unit=[0,1];function identity$6(o){return o}function normalize(o,i){return(i-=o=+o)?function(_){return(_-o)/i}:constants(isNaN(i)?NaN:.5)}function clamper(o,i){var _;return o>i&&(_=o,o=i,i=_),function($){return Math.max(o,Math.min(i,$))}}function bimap(o,i,_){var $=o[0],j=o[1],_e=i[0],et=i[1];return j<$?($=normalize(j,$),_e=_(et,_e)):($=normalize($,j),_e=_(_e,et)),function(tt){return _e($(tt))}}function polymap(o,i,_){var $=Math.min(o.length,i.length)-1,j=new Array($),_e=new Array($),et=-1;for(o[$]<o[0]&&(o=o.slice().reverse(),i=i.slice().reverse());++et<$;)j[et]=normalize(o[et],o[et+1]),_e[et]=_(i[et],i[et+1]);return function(tt){var rt=bisectRight(o,tt,1,$)-1;return _e[rt](j[rt](tt))}}function copy$2(o,i){return i.domain(o.domain()).range(o.range()).interpolate(o.interpolate()).clamp(o.clamp()).unknown(o.unknown())}function transformer$2(){var o=unit,i=unit,_=interpolate,$,j,_e,et=identity$6,tt,rt,nt;function it(){var at=Math.min(o.length,i.length);return et!==identity$6&&(et=clamper(o[0],o[at-1])),tt=at>2?polymap:bimap,rt=nt=null,st}function st(at){return at==null||isNaN(at=+at)?_e:(rt||(rt=tt(o.map($),i,_)))($(et(at)))}return st.invert=function(at){return et(j((nt||(nt=tt(i,o.map($),interpolateNumber$1)))(at)))},st.domain=function(at){return arguments.length?(o=Array.from(at,number$1),it()):o.slice()},st.range=function(at){return arguments.length?(i=Array.from(at),it()):i.slice()},st.rangeRound=function(at){return i=Array.from(at),_=interpolateRound,it()},st.clamp=function(at){return arguments.length?(et=at?!0:identity$6,it()):et!==identity$6},st.interpolate=function(at){return arguments.length?(_=at,it()):_},st.unknown=function(at){return arguments.length?(_e=at,st):_e},function(at,ot){return $=at,j=ot,it()}}function continuous(){return transformer$2()(identity$6,identity$6)}function formatDecimal(o){return Math.abs(o=Math.round(o))>=1e21?o.toLocaleString("en").replace(/,/g,""):o.toString(10)}function formatDecimalParts(o,i){if((_=(o=i?o.toExponential(i-1):o.toExponential()).indexOf("e"))<0)return null;var _,$=o.slice(0,_);return[$.length>1?$[0]+$.slice(2):$,+o.slice(_+1)]}function exponent(o){return o=formatDecimalParts(Math.abs(o)),o?o[1]:NaN}function formatGroup(o,i){return function(_,$){for(var j=_.length,_e=[],et=0,tt=o[0],rt=0;j>0&&tt>0&&(rt+tt+1>$&&(tt=Math.max(1,$-rt)),_e.push(_.substring(j-=tt,j+tt)),!((rt+=tt+1)>$));)tt=o[et=(et+1)%o.length];return _e.reverse().join(i)}}function formatNumerals(o){return function(i){return i.replace(/[0-9]/g,function(_){return o[+_]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(o){if(!(i=re.exec(o)))throw new Error("invalid format: "+o);var i;return new FormatSpecifier({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(o){this.fill=o.fill===void 0?" ":o.fill+"",this.align=o.align===void 0?">":o.align+"",this.sign=o.sign===void 0?"-":o.sign+"",this.symbol=o.symbol===void 0?"":o.symbol+"",this.zero=!!o.zero,this.width=o.width===void 0?void 0:+o.width,this.comma=!!o.comma,this.precision=o.precision===void 0?void 0:+o.precision,this.trim=!!o.trim,this.type=o.type===void 0?"":o.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(o){e:for(var i=o.length,_=1,$=-1,j;_<i;++_)switch(o[_]){case".":$=j=_;break;case"0":$===0&&($=_),j=_;break;default:if(!+o[_])break e;$>0&&($=0);break}return $>0?o.slice(0,$)+o.slice(j+1):o}var prefixExponent;function formatPrefixAuto(o,i){var _=formatDecimalParts(o,i);if(!_)return o+"";var $=_[0],j=_[1],_e=j-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(j/3)))*3)+1,et=$.length;return _e===et?$:_e>et?$+new Array(_e-et+1).join("0"):_e>0?$.slice(0,_e)+"."+$.slice(_e):"0."+new Array(1-_e).join("0")+formatDecimalParts(o,Math.max(0,i+_e-1))[0]}function formatRounded(o,i){var _=formatDecimalParts(o,i);if(!_)return o+"";var $=_[0],j=_[1];return j<0?"0."+new Array(-j).join("0")+$:$.length>j+1?$.slice(0,j+1)+"."+$.slice(j+1):$+new Array(j-$.length+2).join("0")}const formatTypes={"%":(o,i)=>(o*100).toFixed(i),b:o=>Math.round(o).toString(2),c:o=>o+"",d:formatDecimal,e:(o,i)=>o.toExponential(i),f:(o,i)=>o.toFixed(i),g:(o,i)=>o.toPrecision(i),o:o=>Math.round(o).toString(8),p:(o,i)=>formatRounded(o*100,i),r:formatRounded,s:formatPrefixAuto,X:o=>Math.round(o).toString(16).toUpperCase(),x:o=>Math.round(o).toString(16)};function identity$5(o){return o}var map$3=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(o){var i=o.grouping===void 0||o.thousands===void 0?identity$5:formatGroup(map$3.call(o.grouping,Number),o.thousands+""),_=o.currency===void 0?"":o.currency[0]+"",$=o.currency===void 0?"":o.currency[1]+"",j=o.decimal===void 0?".":o.decimal+"",_e=o.numerals===void 0?identity$5:formatNumerals(map$3.call(o.numerals,String)),et=o.percent===void 0?"%":o.percent+"",tt=o.minus===void 0?"":o.minus+"",rt=o.nan===void 0?"NaN":o.nan+"";function nt(st){st=formatSpecifier(st);var at=st.fill,ot=st.align,lt=st.sign,ct=st.symbol,ft=st.zero,ut=st.width,ht=st.comma,dt=st.precision,mt=st.trim,pt=st.type;pt==="n"?(ht=!0,pt="g"):formatTypes[pt]||(dt===void 0&&(dt=12),mt=!0,pt="g"),(ft||at==="0"&&ot==="=")&&(ft=!0,at="0",ot="=");var yt=ct==="$"?_:ct==="#"&&/[boxX]/.test(pt)?"0"+pt.toLowerCase():"",gt=ct==="$"?$:/[%p]/.test(pt)?et:"",vt=formatTypes[pt],St=/[defgprs%]/.test(pt);dt=dt===void 0?6:/[gprs]/.test(pt)?Math.max(1,Math.min(21,dt)):Math.max(0,Math.min(20,dt));function At(xt){var wt=yt,Ot=gt,Bt,Ft,Pt;if(pt==="c")Ot=vt(xt)+Ot,xt="";else{xt=+xt;var Rt=xt<0||1/xt<0;if(xt=isNaN(xt)?rt:vt(Math.abs(xt),dt),mt&&(xt=formatTrim(xt)),Rt&&+xt==0&&lt!=="+"&&(Rt=!1),wt=(Rt?lt==="("?lt:tt:lt==="-"||lt==="("?"":lt)+wt,Ot=(pt==="s"?prefixes[8+prefixExponent/3]:"")+Ot+(Rt&&lt==="("?")":""),St){for(Bt=-1,Ft=xt.length;++Bt<Ft;)if(Pt=xt.charCodeAt(Bt),48>Pt||Pt>57){Ot=(Pt===46?j+xt.slice(Bt+1):xt.slice(Bt))+Ot,xt=xt.slice(0,Bt);break}}}ht&&!ft&&(xt=i(xt,1/0));var Et=wt.length+xt.length+Ot.length,_t=Et<ut?new Array(ut-Et+1).join(at):"";switch(ht&&ft&&(xt=i(_t+xt,_t.length?ut-Ot.length:1/0),_t=""),ot){case"<":xt=wt+xt+Ot+_t;break;case"=":xt=wt+_t+xt+Ot;break;case"^":xt=_t.slice(0,Et=_t.length>>1)+wt+xt+Ot+_t.slice(Et);break;default:xt=_t+wt+xt+Ot;break}return _e(xt)}return At.toString=function(){return st+""},At}function it(st,at){var ot=nt((st=formatSpecifier(st),st.type="f",st)),lt=Math.max(-8,Math.min(8,Math.floor(exponent(at)/3)))*3,ct=Math.pow(10,-lt),ft=prefixes[8+lt/3];return function(ut){return ot(ct*ut)+ft}}return{format:nt,formatPrefix:it}}var locale$1,format$1,formatPrefix;defaultLocale$1({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$1(o){return locale$1=formatLocale$1(o),format$1=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(o){return Math.max(0,-exponent(Math.abs(o)))}function precisionPrefix(o,i){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(i)/3)))*3-exponent(Math.abs(o)))}function precisionRound(o,i){return o=Math.abs(o),i=Math.abs(i)-o,Math.max(0,exponent(i)-exponent(o))+1}function tickFormat(o,i,_,$){var j=tickStep(o,i,_),_e;switch($=formatSpecifier($??",f"),$.type){case"s":{var et=Math.max(Math.abs(o),Math.abs(i));return $.precision==null&&!isNaN(_e=precisionPrefix(j,et))&&($.precision=_e),formatPrefix($,et)}case"":case"e":case"g":case"p":case"r":{$.precision==null&&!isNaN(_e=precisionRound(j,Math.max(Math.abs(o),Math.abs(i))))&&($.precision=_e-($.type==="e"));break}case"f":case"%":{$.precision==null&&!isNaN(_e=precisionFixed(j))&&($.precision=_e-($.type==="%")*2);break}}return format$1($)}function linearish(o){var i=o.domain;return o.ticks=function(_){var $=i();return ticks($[0],$[$.length-1],_??10)},o.tickFormat=function(_,$){var j=i();return tickFormat(j[0],j[j.length-1],_??10,$)},o.nice=function(_){_==null&&(_=10);var $=i(),j=0,_e=$.length-1,et=$[j],tt=$[_e],rt,nt,it=10;for(tt<et&&(nt=et,et=tt,tt=nt,nt=j,j=_e,_e=nt);it-- >0;){if(nt=tickIncrement(et,tt,_),nt===rt)return $[j]=et,$[_e]=tt,i($);if(nt>0)et=Math.floor(et/nt)*nt,tt=Math.ceil(tt/nt)*nt;else if(nt<0)et=Math.ceil(et*nt)/nt,tt=Math.floor(tt*nt)/nt;else break;rt=nt}return o},o}function linear(){var o=continuous();return o.copy=function(){return copy$2(o,linear())},initRange.apply(o,arguments),linearish(o)}function identity$4(o){var i;function _($){return $==null||isNaN($=+$)?i:$}return _.invert=_,_.domain=_.range=function($){return arguments.length?(o=Array.from($,number$1),_):o.slice()},_.unknown=function($){return arguments.length?(i=$,_):i},_.copy=function(){return identity$4(o).unknown(i)},o=arguments.length?Array.from(o,number$1):[0,1],linearish(_)}function nice(o,i){o=o.slice();var _=0,$=o.length-1,j=o[_],_e=o[$],et;return _e<j&&(et=_,_=$,$=et,et=j,j=_e,_e=et),o[_]=i.floor(j),o[$]=i.ceil(_e),o}function transformLog(o){return Math.log(o)}function transformExp(o){return Math.exp(o)}function transformLogn(o){return-Math.log(-o)}function transformExpn(o){return-Math.exp(-o)}function pow10(o){return isFinite(o)?+("1e"+o):o<0?0:o}function powp(o){return o===10?pow10:o===Math.E?Math.exp:i=>Math.pow(o,i)}function logp(o){return o===Math.E?Math.log:o===10&&Math.log10||o===2&&Math.log2||(o=Math.log(o),i=>Math.log(i)/o)}function reflect(o){return(i,_)=>-o(-i,_)}function loggish(o){const i=o(transformLog,transformExp),_=i.domain;let $=10,j,_e;function et(){return j=logp($),_e=powp($),_()[0]<0?(j=reflect(j),_e=reflect(_e),o(transformLogn,transformExpn)):o(transformLog,transformExp),i}return i.base=function(tt){return arguments.length?($=+tt,et()):$},i.domain=function(tt){return arguments.length?(_(tt),et()):_()},i.ticks=tt=>{const rt=_();let nt=rt[0],it=rt[rt.length-1];const st=it<nt;st&&([nt,it]=[it,nt]);let at=j(nt),ot=j(it),lt,ct;const ft=tt==null?10:+tt;let ut=[];if(!($%1)&&ot-at<ft){if(at=Math.floor(at),ot=Math.ceil(ot),nt>0){for(;at<=ot;++at)for(lt=1;lt<$;++lt)if(ct=at<0?lt/_e(-at):lt*_e(at),!(ct<nt)){if(ct>it)break;ut.push(ct)}}else for(;at<=ot;++at)for(lt=$-1;lt>=1;--lt)if(ct=at>0?lt/_e(-at):lt*_e(at),!(ct<nt)){if(ct>it)break;ut.push(ct)}ut.length*2<ft&&(ut=ticks(nt,it,ft))}else ut=ticks(at,ot,Math.min(ot-at,ft)).map(_e);return st?ut.reverse():ut},i.tickFormat=(tt,rt)=>{if(tt==null&&(tt=10),rt==null&&(rt=$===10?"s":","),typeof rt!="function"&&(!($%1)&&(rt=formatSpecifier(rt)).precision==null&&(rt.trim=!0),rt=format$1(rt)),tt===1/0)return rt;const nt=Math.max(1,$*tt/i.ticks().length);return it=>{let st=it/_e(Math.round(j(it)));return st*$<$-.5&&(st*=$),st<=nt?rt(it):""}},i.nice=()=>_(nice(_(),{floor:tt=>_e(Math.floor(j(tt))),ceil:tt=>_e(Math.ceil(j(tt)))})),i}function log(){const o=loggish(transformer$2()).domain([1,10]);return o.copy=()=>copy$2(o,log()).base(o.base()),initRange.apply(o,arguments),o}function transformSymlog(o){return function(i){return Math.sign(i)*Math.log1p(Math.abs(i/o))}}function transformSymexp(o){return function(i){return Math.sign(i)*Math.expm1(Math.abs(i))*o}}function symlogish(o){var i=1,_=o(transformSymlog(i),transformSymexp(i));return _.constant=function($){return arguments.length?o(transformSymlog(i=+$),transformSymexp(i)):i},linearish(_)}function symlog(){var o=symlogish(transformer$2());return o.copy=function(){return copy$2(o,symlog()).constant(o.constant())},initRange.apply(o,arguments)}function transformPow(o){return function(i){return i<0?-Math.pow(-i,o):Math.pow(i,o)}}function transformSqrt(o){return o<0?-Math.sqrt(-o):Math.sqrt(o)}function transformSquare(o){return o<0?-o*o:o*o}function powish(o){var i=o(identity$6,identity$6),_=1;function $(){return _===1?o(identity$6,identity$6):_===.5?o(transformSqrt,transformSquare):o(transformPow(_),transformPow(1/_))}return i.exponent=function(j){return arguments.length?(_=+j,$()):_},linearish(i)}function pow(){var o=powish(transformer$2());return o.copy=function(){return copy$2(o,pow()).exponent(o.exponent())},initRange.apply(o,arguments),o}function sqrt(){return pow.apply(null,arguments).exponent(.5)}function square(o){return Math.sign(o)*o*o}function unsquare(o){return Math.sign(o)*Math.sqrt(Math.abs(o))}function radial(){var o=continuous(),i=[0,1],_=!1,$;function j(_e){var et=unsquare(o(_e));return isNaN(et)?$:_?Math.round(et):et}return j.invert=function(_e){return o.invert(square(_e))},j.domain=function(_e){return arguments.length?(o.domain(_e),j):o.domain()},j.range=function(_e){return arguments.length?(o.range((i=Array.from(_e,number$1)).map(square)),j):i.slice()},j.rangeRound=function(_e){return j.range(_e).round(!0)},j.round=function(_e){return arguments.length?(_=!!_e,j):_},j.clamp=function(_e){return arguments.length?(o.clamp(_e),j):o.clamp()},j.unknown=function(_e){return arguments.length?($=_e,j):$},j.copy=function(){return radial(o.domain(),i).round(_).clamp(o.clamp()).unknown($)},initRange.apply(j,arguments),linearish(j)}function quantile(){var o=[],i=[],_=[],$;function j(){var et=0,tt=Math.max(1,i.length);for(_=new Array(tt-1);++et<tt;)_[et-1]=quantileSorted(o,et/tt);return _e}function _e(et){return et==null||isNaN(et=+et)?$:i[bisectRight(_,et)]}return _e.invertExtent=function(et){var tt=i.indexOf(et);return tt<0?[NaN,NaN]:[tt>0?_[tt-1]:o[0],tt<_.length?_[tt]:o[o.length-1]]},_e.domain=function(et){if(!arguments.length)return o.slice();o=[];for(let tt of et)tt!=null&&!isNaN(tt=+tt)&&o.push(tt);return o.sort(ascending),j()},_e.range=function(et){return arguments.length?(i=Array.from(et),j()):i.slice()},_e.unknown=function(et){return arguments.length?($=et,_e):$},_e.quantiles=function(){return _.slice()},_e.copy=function(){return quantile().domain(o).range(i).unknown($)},initRange.apply(_e,arguments)}function quantize(){var o=0,i=1,_=1,$=[.5],j=[0,1],_e;function et(rt){return rt!=null&&rt<=rt?j[bisectRight($,rt,0,_)]:_e}function tt(){var rt=-1;for($=new Array(_);++rt<_;)$[rt]=((rt+1)*i-(rt-_)*o)/(_+1);return et}return et.domain=function(rt){return arguments.length?([o,i]=rt,o=+o,i=+i,tt()):[o,i]},et.range=function(rt){return arguments.length?(_=(j=Array.from(rt)).length-1,tt()):j.slice()},et.invertExtent=function(rt){var nt=j.indexOf(rt);return nt<0?[NaN,NaN]:nt<1?[o,$[0]]:nt>=_?[$[_-1],i]:[$[nt-1],$[nt]]},et.unknown=function(rt){return arguments.length&&(_e=rt),et},et.thresholds=function(){return $.slice()},et.copy=function(){return quantize().domain([o,i]).range(j).unknown(_e)},initRange.apply(linearish(et),arguments)}function threshold(){var o=[.5],i=[0,1],_,$=1;function j(_e){return _e!=null&&_e<=_e?i[bisectRight(o,_e,0,$)]:_}return j.domain=function(_e){return arguments.length?(o=Array.from(_e),$=Math.min(o.length,i.length-1),j):o.slice()},j.range=function(_e){return arguments.length?(i=Array.from(_e),$=Math.min(o.length,i.length-1),j):i.slice()},j.invertExtent=function(_e){var et=i.indexOf(_e);return[o[et-1],o[et]]},j.unknown=function(_e){return arguments.length?(_=_e,j):_},j.copy=function(){return threshold().domain(o).range(i).unknown(_)},initRange.apply(j,arguments)}const t0=new Date,t1=new Date;function timeInterval(o,i,_,$){function j(_e){return o(_e=arguments.length===0?new Date:new Date(+_e)),_e}return j.floor=_e=>(o(_e=new Date(+_e)),_e),j.ceil=_e=>(o(_e=new Date(_e-1)),i(_e,1),o(_e),_e),j.round=_e=>{const et=j(_e),tt=j.ceil(_e);return _e-et<tt-_e?et:tt},j.offset=(_e,et)=>(i(_e=new Date(+_e),et==null?1:Math.floor(et)),_e),j.range=(_e,et,tt)=>{const rt=[];if(_e=j.ceil(_e),tt=tt==null?1:Math.floor(tt),!(_e<et)||!(tt>0))return rt;let nt;do rt.push(nt=new Date(+_e)),i(_e,tt),o(_e);while(nt<_e&&_e<et);return rt},j.filter=_e=>timeInterval(et=>{if(et>=et)for(;o(et),!_e(et);)et.setTime(et-1)},(et,tt)=>{if(et>=et)if(tt<0)for(;++tt<=0;)for(;i(et,-1),!_e(et););else for(;--tt>=0;)for(;i(et,1),!_e(et););}),_&&(j.count=(_e,et)=>(t0.setTime(+_e),t1.setTime(+et),o(t0),o(t1),Math.floor(_(t0,t1))),j.every=_e=>(_e=Math.floor(_e),!isFinite(_e)||!(_e>0)?null:_e>1?j.filter($?et=>$(et)%_e===0:et=>j.count(0,et)%_e===0):j)),j}const millisecond=timeInterval(()=>{},(o,i)=>{o.setTime(+o+i)},(o,i)=>i-o);millisecond.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?timeInterval(i=>{i.setTime(Math.floor(i/o)*o)},(i,_)=>{i.setTime(+i+_*o)},(i,_)=>(_-i)/o):millisecond);millisecond.range;const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(o=>{o.setTime(o-o.getMilliseconds())},(o,i)=>{o.setTime(+o+i*durationSecond)},(o,i)=>(i-o)/durationSecond,o=>o.getUTCSeconds());second.range;const timeMinute=timeInterval(o=>{o.setTime(o-o.getMilliseconds()-o.getSeconds()*durationSecond)},(o,i)=>{o.setTime(+o+i*durationMinute)},(o,i)=>(i-o)/durationMinute,o=>o.getMinutes());timeMinute.range;const utcMinute=timeInterval(o=>{o.setUTCSeconds(0,0)},(o,i)=>{o.setTime(+o+i*durationMinute)},(o,i)=>(i-o)/durationMinute,o=>o.getUTCMinutes());utcMinute.range;const timeHour=timeInterval(o=>{o.setTime(o-o.getMilliseconds()-o.getSeconds()*durationSecond-o.getMinutes()*durationMinute)},(o,i)=>{o.setTime(+o+i*durationHour)},(o,i)=>(i-o)/durationHour,o=>o.getHours());timeHour.range;const utcHour=timeInterval(o=>{o.setUTCMinutes(0,0,0)},(o,i)=>{o.setTime(+o+i*durationHour)},(o,i)=>(i-o)/durationHour,o=>o.getUTCHours());utcHour.range;const timeDay=timeInterval(o=>o.setHours(0,0,0,0),(o,i)=>o.setDate(o.getDate()+i),(o,i)=>(i-o-(i.getTimezoneOffset()-o.getTimezoneOffset())*durationMinute)/durationDay,o=>o.getDate()-1);timeDay.range;const utcDay=timeInterval(o=>{o.setUTCHours(0,0,0,0)},(o,i)=>{o.setUTCDate(o.getUTCDate()+i)},(o,i)=>(i-o)/durationDay,o=>o.getUTCDate()-1);utcDay.range;const unixDay=timeInterval(o=>{o.setUTCHours(0,0,0,0)},(o,i)=>{o.setUTCDate(o.getUTCDate()+i)},(o,i)=>(i-o)/durationDay,o=>Math.floor(o/durationDay));unixDay.range;function timeWeekday(o){return timeInterval(i=>{i.setDate(i.getDate()-(i.getDay()+7-o)%7),i.setHours(0,0,0,0)},(i,_)=>{i.setDate(i.getDate()+_*7)},(i,_)=>(_-i-(_.getTimezoneOffset()-i.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(o){return timeInterval(i=>{i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-o)%7),i.setUTCHours(0,0,0,0)},(i,_)=>{i.setUTCDate(i.getUTCDate()+_*7)},(i,_)=>(_-i)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval(o=>{o.setDate(1),o.setHours(0,0,0,0)},(o,i)=>{o.setMonth(o.getMonth()+i)},(o,i)=>i.getMonth()-o.getMonth()+(i.getFullYear()-o.getFullYear())*12,o=>o.getMonth());timeMonth.range;const utcMonth=timeInterval(o=>{o.setUTCDate(1),o.setUTCHours(0,0,0,0)},(o,i)=>{o.setUTCMonth(o.getUTCMonth()+i)},(o,i)=>i.getUTCMonth()-o.getUTCMonth()+(i.getUTCFullYear()-o.getUTCFullYear())*12,o=>o.getUTCMonth());utcMonth.range;const timeYear=timeInterval(o=>{o.setMonth(0,1),o.setHours(0,0,0,0)},(o,i)=>{o.setFullYear(o.getFullYear()+i)},(o,i)=>i.getFullYear()-o.getFullYear(),o=>o.getFullYear());timeYear.every=o=>!isFinite(o=Math.floor(o))||!(o>0)?null:timeInterval(i=>{i.setFullYear(Math.floor(i.getFullYear()/o)*o),i.setMonth(0,1),i.setHours(0,0,0,0)},(i,_)=>{i.setFullYear(i.getFullYear()+_*o)});timeYear.range;const utcYear=timeInterval(o=>{o.setUTCMonth(0,1),o.setUTCHours(0,0,0,0)},(o,i)=>{o.setUTCFullYear(o.getUTCFullYear()+i)},(o,i)=>i.getUTCFullYear()-o.getUTCFullYear(),o=>o.getUTCFullYear());utcYear.every=o=>!isFinite(o=Math.floor(o))||!(o>0)?null:timeInterval(i=>{i.setUTCFullYear(Math.floor(i.getUTCFullYear()/o)*o),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},(i,_)=>{i.setUTCFullYear(i.getUTCFullYear()+_*o)});utcYear.range;function ticker(o,i,_,$,j,_e){const et=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[_e,1,durationMinute],[_e,5,5*durationMinute],[_e,15,15*durationMinute],[_e,30,30*durationMinute],[j,1,durationHour],[j,3,3*durationHour],[j,6,6*durationHour],[j,12,12*durationHour],[$,1,durationDay],[$,2,2*durationDay],[_,1,durationWeek],[i,1,durationMonth],[i,3,3*durationMonth],[o,1,durationYear]];function tt(nt,it,st){const at=it<nt;at&&([nt,it]=[it,nt]);const ot=st&&typeof st.range=="function"?st:rt(nt,it,st),lt=ot?ot.range(nt,+it+1):[];return at?lt.reverse():lt}function rt(nt,it,st){const at=Math.abs(it-nt)/st,ot=bisector(([,,ft])=>ft).right(et,at);if(ot===et.length)return o.every(tickStep(nt/durationYear,it/durationYear,st));if(ot===0)return millisecond.every(Math.max(tickStep(nt,it,st),1));const[lt,ct]=et[at/et[ot-1][2]<et[ot][2]/at?ot-1:ot];return lt.every(ct)}return[tt,rt]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(o){if(0<=o.y&&o.y<100){var i=new Date(-1,o.m,o.d,o.H,o.M,o.S,o.L);return i.setFullYear(o.y),i}return new Date(o.y,o.m,o.d,o.H,o.M,o.S,o.L)}function utcDate(o){if(0<=o.y&&o.y<100){var i=new Date(Date.UTC(-1,o.m,o.d,o.H,o.M,o.S,o.L));return i.setUTCFullYear(o.y),i}return new Date(Date.UTC(o.y,o.m,o.d,o.H,o.M,o.S,o.L))}function newDate(o,i,_){return{y:o,m:i,d:_,H:0,M:0,S:0,L:0}}function formatLocale(o){var i=o.dateTime,_=o.date,$=o.time,j=o.periods,_e=o.days,et=o.shortDays,tt=o.months,rt=o.shortMonths,nt=formatRe(j),it=formatLookup(j),st=formatRe(_e),at=formatLookup(_e),ot=formatRe(et),lt=formatLookup(et),ct=formatRe(tt),ft=formatLookup(tt),ut=formatRe(rt),ht=formatLookup(rt),dt={a:Rt,A:Et,b:_t,B:Mt,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:Dt,q:Lt,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},mt={a:Ct,A:kt,b:jt,B:Vt,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:zt,q:qt,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},pt={a:At,A:xt,b:wt,B:Ot,c:Bt,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:St,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:Ft,X:Pt,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};dt.x=yt(_,dt),dt.X=yt($,dt),dt.c=yt(i,dt),mt.x=yt(_,mt),mt.X=yt($,mt),mt.c=yt(i,mt);function yt(Wt,ir){return function(or){var Qt=[],gr=-1,ar=0,Ar=Wt.length,er,sr,Gt;for(or instanceof Date||(or=new Date(+or));++gr<Ar;)Wt.charCodeAt(gr)===37&&(Qt.push(Wt.slice(ar,gr)),(sr=pads[er=Wt.charAt(++gr)])!=null?er=Wt.charAt(++gr):sr=er==="e"?" ":"0",(Gt=ir[er])&&(er=Gt(or,sr)),Qt.push(er),ar=gr+1);return Qt.push(Wt.slice(ar,gr)),Qt.join("")}}function gt(Wt,ir){return function(or){var Qt=newDate(1900,void 0,1),gr=vt(Qt,Wt,or+="",0),ar,Ar;if(gr!=or.length)return null;if("Q"in Qt)return new Date(Qt.Q);if("s"in Qt)return new Date(Qt.s*1e3+("L"in Qt?Qt.L:0));if(ir&&!("Z"in Qt)&&(Qt.Z=0),"p"in Qt&&(Qt.H=Qt.H%12+Qt.p*12),Qt.m===void 0&&(Qt.m="q"in Qt?Qt.q:0),"V"in Qt){if(Qt.V<1||Qt.V>53)return null;"w"in Qt||(Qt.w=1),"Z"in Qt?(ar=utcDate(newDate(Qt.y,0,1)),Ar=ar.getUTCDay(),ar=Ar>4||Ar===0?utcMonday.ceil(ar):utcMonday(ar),ar=utcDay.offset(ar,(Qt.V-1)*7),Qt.y=ar.getUTCFullYear(),Qt.m=ar.getUTCMonth(),Qt.d=ar.getUTCDate()+(Qt.w+6)%7):(ar=localDate(newDate(Qt.y,0,1)),Ar=ar.getDay(),ar=Ar>4||Ar===0?timeMonday.ceil(ar):timeMonday(ar),ar=timeDay.offset(ar,(Qt.V-1)*7),Qt.y=ar.getFullYear(),Qt.m=ar.getMonth(),Qt.d=ar.getDate()+(Qt.w+6)%7)}else("W"in Qt||"U"in Qt)&&("w"in Qt||(Qt.w="u"in Qt?Qt.u%7:"W"in Qt?1:0),Ar="Z"in Qt?utcDate(newDate(Qt.y,0,1)).getUTCDay():localDate(newDate(Qt.y,0,1)).getDay(),Qt.m=0,Qt.d="W"in Qt?(Qt.w+6)%7+Qt.W*7-(Ar+5)%7:Qt.w+Qt.U*7-(Ar+6)%7);return"Z"in Qt?(Qt.H+=Qt.Z/100|0,Qt.M+=Qt.Z%100,utcDate(Qt)):localDate(Qt)}}function vt(Wt,ir,or,Qt){for(var gr=0,ar=ir.length,Ar=or.length,er,sr;gr<ar;){if(Qt>=Ar)return-1;if(er=ir.charCodeAt(gr++),er===37){if(er=ir.charAt(gr++),sr=pt[er in pads?ir.charAt(gr++):er],!sr||(Qt=sr(Wt,or,Qt))<0)return-1}else if(er!=or.charCodeAt(Qt++))return-1}return Qt}function St(Wt,ir,or){var Qt=nt.exec(ir.slice(or));return Qt?(Wt.p=it.get(Qt[0].toLowerCase()),or+Qt[0].length):-1}function At(Wt,ir,or){var Qt=ot.exec(ir.slice(or));return Qt?(Wt.w=lt.get(Qt[0].toLowerCase()),or+Qt[0].length):-1}function xt(Wt,ir,or){var Qt=st.exec(ir.slice(or));return Qt?(Wt.w=at.get(Qt[0].toLowerCase()),or+Qt[0].length):-1}function wt(Wt,ir,or){var Qt=ut.exec(ir.slice(or));return Qt?(Wt.m=ht.get(Qt[0].toLowerCase()),or+Qt[0].length):-1}function Ot(Wt,ir,or){var Qt=ct.exec(ir.slice(or));return Qt?(Wt.m=ft.get(Qt[0].toLowerCase()),or+Qt[0].length):-1}function Bt(Wt,ir,or){return vt(Wt,i,ir,or)}function Ft(Wt,ir,or){return vt(Wt,_,ir,or)}function Pt(Wt,ir,or){return vt(Wt,$,ir,or)}function Rt(Wt){return et[Wt.getDay()]}function Et(Wt){return _e[Wt.getDay()]}function _t(Wt){return rt[Wt.getMonth()]}function Mt(Wt){return tt[Wt.getMonth()]}function Dt(Wt){return j[+(Wt.getHours()>=12)]}function Lt(Wt){return 1+~~(Wt.getMonth()/3)}function Ct(Wt){return et[Wt.getUTCDay()]}function kt(Wt){return _e[Wt.getUTCDay()]}function jt(Wt){return rt[Wt.getUTCMonth()]}function Vt(Wt){return tt[Wt.getUTCMonth()]}function zt(Wt){return j[+(Wt.getUTCHours()>=12)]}function qt(Wt){return 1+~~(Wt.getUTCMonth()/3)}return{format:function(Wt){var ir=yt(Wt+="",dt);return ir.toString=function(){return Wt},ir},parse:function(Wt){var ir=gt(Wt+="",!1);return ir.toString=function(){return Wt},ir},utcFormat:function(Wt){var ir=yt(Wt+="",mt);return ir.toString=function(){return Wt},ir},utcParse:function(Wt){var ir=gt(Wt+="",!0);return ir.toString=function(){return Wt},ir}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(o,i,_){var $=o<0?"-":"",j=($?-o:o)+"",_e=j.length;return $+(_e<_?new Array(_-_e+1).join(i)+j:j)}function requote(o){return o.replace(requoteRe,"\\$&")}function formatRe(o){return new RegExp("^(?:"+o.map(requote).join("|")+")","i")}function formatLookup(o){return new Map(o.map((i,_)=>[i.toLowerCase(),_]))}function parseWeekdayNumberSunday(o,i,_){var $=numberRe.exec(i.slice(_,_+1));return $?(o.w=+$[0],_+$[0].length):-1}function parseWeekdayNumberMonday(o,i,_){var $=numberRe.exec(i.slice(_,_+1));return $?(o.u=+$[0],_+$[0].length):-1}function parseWeekNumberSunday(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.U=+$[0],_+$[0].length):-1}function parseWeekNumberISO(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.V=+$[0],_+$[0].length):-1}function parseWeekNumberMonday(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.W=+$[0],_+$[0].length):-1}function parseFullYear(o,i,_){var $=numberRe.exec(i.slice(_,_+4));return $?(o.y=+$[0],_+$[0].length):-1}function parseYear(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.y=+$[0]+(+$[0]>68?1900:2e3),_+$[0].length):-1}function parseZone(o,i,_){var $=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(i.slice(_,_+6));return $?(o.Z=$[1]?0:-($[2]+($[3]||"00")),_+$[0].length):-1}function parseQuarter(o,i,_){var $=numberRe.exec(i.slice(_,_+1));return $?(o.q=$[0]*3-3,_+$[0].length):-1}function parseMonthNumber(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.m=$[0]-1,_+$[0].length):-1}function parseDayOfMonth(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.d=+$[0],_+$[0].length):-1}function parseDayOfYear(o,i,_){var $=numberRe.exec(i.slice(_,_+3));return $?(o.m=0,o.d=+$[0],_+$[0].length):-1}function parseHour24(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.H=+$[0],_+$[0].length):-1}function parseMinutes(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.M=+$[0],_+$[0].length):-1}function parseSeconds(o,i,_){var $=numberRe.exec(i.slice(_,_+2));return $?(o.S=+$[0],_+$[0].length):-1}function parseMilliseconds(o,i,_){var $=numberRe.exec(i.slice(_,_+3));return $?(o.L=+$[0],_+$[0].length):-1}function parseMicroseconds(o,i,_){var $=numberRe.exec(i.slice(_,_+6));return $?(o.L=Math.floor($[0]/1e3),_+$[0].length):-1}function parseLiteralPercent(o,i,_){var $=percentRe.exec(i.slice(_,_+1));return $?_+$[0].length:-1}function parseUnixTimestamp(o,i,_){var $=numberRe.exec(i.slice(_));return $?(o.Q=+$[0],_+$[0].length):-1}function parseUnixTimestampSeconds(o,i,_){var $=numberRe.exec(i.slice(_));return $?(o.s=+$[0],_+$[0].length):-1}function formatDayOfMonth(o,i){return pad(o.getDate(),i,2)}function formatHour24(o,i){return pad(o.getHours(),i,2)}function formatHour12(o,i){return pad(o.getHours()%12||12,i,2)}function formatDayOfYear(o,i){return pad(1+timeDay.count(timeYear(o),o),i,3)}function formatMilliseconds(o,i){return pad(o.getMilliseconds(),i,3)}function formatMicroseconds(o,i){return formatMilliseconds(o,i)+"000"}function formatMonthNumber(o,i){return pad(o.getMonth()+1,i,2)}function formatMinutes(o,i){return pad(o.getMinutes(),i,2)}function formatSeconds(o,i){return pad(o.getSeconds(),i,2)}function formatWeekdayNumberMonday(o){var i=o.getDay();return i===0?7:i}function formatWeekNumberSunday(o,i){return pad(timeSunday.count(timeYear(o)-1,o),i,2)}function dISO(o){var i=o.getDay();return i>=4||i===0?timeThursday(o):timeThursday.ceil(o)}function formatWeekNumberISO(o,i){return o=dISO(o),pad(timeThursday.count(timeYear(o),o)+(timeYear(o).getDay()===4),i,2)}function formatWeekdayNumberSunday(o){return o.getDay()}function formatWeekNumberMonday(o,i){return pad(timeMonday.count(timeYear(o)-1,o),i,2)}function formatYear(o,i){return pad(o.getFullYear()%100,i,2)}function formatYearISO(o,i){return o=dISO(o),pad(o.getFullYear()%100,i,2)}function formatFullYear(o,i){return pad(o.getFullYear()%1e4,i,4)}function formatFullYearISO(o,i){var _=o.getDay();return o=_>=4||_===0?timeThursday(o):timeThursday.ceil(o),pad(o.getFullYear()%1e4,i,4)}function formatZone(o){var i=o.getTimezoneOffset();return(i>0?"-":(i*=-1,"+"))+pad(i/60|0,"0",2)+pad(i%60,"0",2)}function formatUTCDayOfMonth(o,i){return pad(o.getUTCDate(),i,2)}function formatUTCHour24(o,i){return pad(o.getUTCHours(),i,2)}function formatUTCHour12(o,i){return pad(o.getUTCHours()%12||12,i,2)}function formatUTCDayOfYear(o,i){return pad(1+utcDay.count(utcYear(o),o),i,3)}function formatUTCMilliseconds(o,i){return pad(o.getUTCMilliseconds(),i,3)}function formatUTCMicroseconds(o,i){return formatUTCMilliseconds(o,i)+"000"}function formatUTCMonthNumber(o,i){return pad(o.getUTCMonth()+1,i,2)}function formatUTCMinutes(o,i){return pad(o.getUTCMinutes(),i,2)}function formatUTCSeconds(o,i){return pad(o.getUTCSeconds(),i,2)}function formatUTCWeekdayNumberMonday(o){var i=o.getUTCDay();return i===0?7:i}function formatUTCWeekNumberSunday(o,i){return pad(utcSunday.count(utcYear(o)-1,o),i,2)}function UTCdISO(o){var i=o.getUTCDay();return i>=4||i===0?utcThursday(o):utcThursday.ceil(o)}function formatUTCWeekNumberISO(o,i){return o=UTCdISO(o),pad(utcThursday.count(utcYear(o),o)+(utcYear(o).getUTCDay()===4),i,2)}function formatUTCWeekdayNumberSunday(o){return o.getUTCDay()}function formatUTCWeekNumberMonday(o,i){return pad(utcMonday.count(utcYear(o)-1,o),i,2)}function formatUTCYear(o,i){return pad(o.getUTCFullYear()%100,i,2)}function formatUTCYearISO(o,i){return o=UTCdISO(o),pad(o.getUTCFullYear()%100,i,2)}function formatUTCFullYear(o,i){return pad(o.getUTCFullYear()%1e4,i,4)}function formatUTCFullYearISO(o,i){var _=o.getUTCDay();return o=_>=4||_===0?utcThursday(o):utcThursday.ceil(o),pad(o.getUTCFullYear()%1e4,i,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(o){return+o}function formatUnixTimestampSeconds(o){return Math.floor(+o/1e3)}var locale,timeFormat,utcFormat;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(o){return locale=formatLocale(o),timeFormat=locale.format,locale.parse,utcFormat=locale.utcFormat,locale.utcParse,locale}function date(o){return new Date(o)}function number(o){return o instanceof Date?+o:+new Date(+o)}function calendar(o,i,_,$,j,_e,et,tt,rt,nt){var it=continuous(),st=it.invert,at=it.domain,ot=nt(".%L"),lt=nt(":%S"),ct=nt("%I:%M"),ft=nt("%I %p"),ut=nt("%a %d"),ht=nt("%b %d"),dt=nt("%B"),mt=nt("%Y");function pt(yt){return(rt(yt)<yt?ot:tt(yt)<yt?lt:et(yt)<yt?ct:_e(yt)<yt?ft:$(yt)<yt?j(yt)<yt?ut:ht:_(yt)<yt?dt:mt)(yt)}return it.invert=function(yt){return new Date(st(yt))},it.domain=function(yt){return arguments.length?at(Array.from(yt,number)):at().map(date)},it.ticks=function(yt){var gt=at();return o(gt[0],gt[gt.length-1],yt??10)},it.tickFormat=function(yt,gt){return gt==null?pt:nt(gt)},it.nice=function(yt){var gt=at();return(!yt||typeof yt.range!="function")&&(yt=i(gt[0],gt[gt.length-1],yt??10)),yt?at(nice(gt,yt)):it},it.copy=function(){return copy$2(it,calendar(o,i,_,$,j,_e,et,tt,rt,nt))},it}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$1(){var o=0,i=1,_,$,j,_e,et=identity$6,tt=!1,rt;function nt(st){return st==null||isNaN(st=+st)?rt:et(j===0?.5:(st=(_e(st)-_)*j,tt?Math.max(0,Math.min(1,st)):st))}nt.domain=function(st){return arguments.length?([o,i]=st,_=_e(o=+o),$=_e(i=+i),j=_===$?0:1/($-_),nt):[o,i]},nt.clamp=function(st){return arguments.length?(tt=!!st,nt):tt},nt.interpolator=function(st){return arguments.length?(et=st,nt):et};function it(st){return function(at){var ot,lt;return arguments.length?([ot,lt]=at,et=st(ot,lt),nt):[et(0),et(1)]}}return nt.range=it(interpolate),nt.rangeRound=it(interpolateRound),nt.unknown=function(st){return arguments.length?(rt=st,nt):rt},function(st){return _e=st,_=st(o),$=st(i),j=_===$?0:1/($-_),nt}}function copy$1(o,i){return i.domain(o.domain()).interpolator(o.interpolator()).clamp(o.clamp()).unknown(o.unknown())}function sequential(){var o=linearish(transformer$1()(identity$6));return o.copy=function(){return copy$1(o,sequential())},initInterpolator.apply(o,arguments)}function sequentialLog(){var o=loggish(transformer$1()).domain([1,10]);return o.copy=function(){return copy$1(o,sequentialLog()).base(o.base())},initInterpolator.apply(o,arguments)}function sequentialSymlog(){var o=symlogish(transformer$1());return o.copy=function(){return copy$1(o,sequentialSymlog()).constant(o.constant())},initInterpolator.apply(o,arguments)}function sequentialPow(){var o=powish(transformer$1());return o.copy=function(){return copy$1(o,sequentialPow()).exponent(o.exponent())},initInterpolator.apply(o,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function sequentialQuantile(){var o=[],i=identity$6;function _($){if($!=null&&!isNaN($=+$))return i((bisectRight(o,$,1)-1)/(o.length-1))}return _.domain=function($){if(!arguments.length)return o.slice();o=[];for(let j of $)j!=null&&!isNaN(j=+j)&&o.push(j);return o.sort(ascending),_},_.interpolator=function($){return arguments.length?(i=$,_):i},_.range=function(){return o.map(($,j)=>i(j/(o.length-1)))},_.quantiles=function($){return Array.from({length:$+1},(j,_e)=>quantile$1(o,_e/$))},_.copy=function(){return sequentialQuantile(i).domain(o)},initInterpolator.apply(_,arguments)}function transformer(){var o=0,i=.5,_=1,$=1,j,_e,et,tt,rt,nt=identity$6,it,st=!1,at;function ot(ct){return isNaN(ct=+ct)?at:(ct=.5+((ct=+it(ct))-_e)*($*ct<$*_e?tt:rt),nt(st?Math.max(0,Math.min(1,ct)):ct))}ot.domain=function(ct){return arguments.length?([o,i,_]=ct,j=it(o=+o),_e=it(i=+i),et=it(_=+_),tt=j===_e?0:.5/(_e-j),rt=_e===et?0:.5/(et-_e),$=_e<j?-1:1,ot):[o,i,_]},ot.clamp=function(ct){return arguments.length?(st=!!ct,ot):st},ot.interpolator=function(ct){return arguments.length?(nt=ct,ot):nt};function lt(ct){return function(ft){var ut,ht,dt;return arguments.length?([ut,ht,dt]=ft,nt=piecewise(ct,[ut,ht,dt]),ot):[nt(0),nt(.5),nt(1)]}}return ot.range=lt(interpolate),ot.rangeRound=lt(interpolateRound),ot.unknown=function(ct){return arguments.length?(at=ct,ot):at},function(ct){return it=ct,j=ct(o),_e=ct(i),et=ct(_),tt=j===_e?0:.5/(_e-j),rt=_e===et?0:.5/(et-_e),$=_e<j?-1:1,ot}}function diverging(){var o=linearish(transformer()(identity$6));return o.copy=function(){return copy$1(o,diverging())},initInterpolator.apply(o,arguments)}function divergingLog(){var o=loggish(transformer()).domain([.1,1,10]);return o.copy=function(){return copy$1(o,divergingLog()).base(o.base())},initInterpolator.apply(o,arguments)}function divergingSymlog(){var o=symlogish(transformer());return o.copy=function(){return copy$1(o,divergingSymlog()).constant(o.constant())},initInterpolator.apply(o,arguments)}function divergingPow(){var o=powish(transformer());return o.copy=function(){return copy$1(o,divergingPow()).exponent(o.exponent())},initInterpolator.apply(o,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}const d3Scales=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:band,scaleDiverging:diverging,scaleDivergingLog:divergingLog,scaleDivergingPow:divergingPow,scaleDivergingSqrt:divergingSqrt,scaleDivergingSymlog:divergingSymlog,scaleIdentity:identity$4,scaleImplicit:implicit,scaleLinear:linear,scaleLog:log,scaleOrdinal:ordinal,scalePoint:point,scalePow:pow,scaleQuantile:quantile,scaleQuantize:quantize,scaleRadial:radial,scaleSequential:sequential,scaleSequentialLog:sequentialLog,scaleSequentialPow:sequentialPow,scaleSequentialQuantile:sequentialQuantile,scaleSequentialSqrt:sequentialSqrt,scaleSequentialSymlog:sequentialSymlog,scaleSqrt:sqrt,scaleSymlog:symlog,scaleThreshold:threshold,scaleTime:time,scaleUtc:utcTime,tickFormat},Symbol.toStringTag,{value:"Module"}));var isSymbol=isSymbol_1;function baseExtremum$4(o,i,_){for(var $=-1,j=o.length;++$<j;){var _e=o[$],et=i(_e);if(et!=null&&(tt===void 0?et===et&&!isSymbol(et):_(et,tt)))var tt=et,rt=_e}return rt}var _baseExtremum=baseExtremum$4;function baseGt$2(o,i){return o>i}var _baseGt=baseGt$2,baseExtremum$3=_baseExtremum,baseGt$1=_baseGt,identity$3=identity_1;function max(o){return o&&o.length?baseExtremum$3(o,identity$3,baseGt$1):void 0}var max_1=max;const max$1=getDefaultExportFromCjs$1(max_1);function baseLt$2(o,i){return o<i}var _baseLt=baseLt$2,baseExtremum$2=_baseExtremum,baseLt$1=_baseLt,identity$2=identity_1;function min(o){return o&&o.length?baseExtremum$2(o,identity$2,baseLt$1):void 0}var min_1=min;const min$1=getDefaultExportFromCjs$1(min_1);var arrayMap=_arrayMap,baseIteratee$5=_baseIteratee,baseMap=_baseMap,isArray$3=isArray_1;function map$2(o,i){var _=isArray$3(o)?arrayMap:baseMap;return _(o,baseIteratee$5(i))}var map_1=map$2,baseFlatten=_baseFlatten,map$1=map_1;function flatMap(o,i){return baseFlatten(map$1(o,i),1)}var flatMap_1=flatMap;const flatMap$1=getDefaultExportFromCjs$1(flatMap_1);var baseIsEqual=_baseIsEqual;function isEqual(o,i){return baseIsEqual(o,i)}var isEqual_1=isEqual;const isEqual$1=getDefaultExportFromCjs$1(isEqual_1);var MAX_DIGITS=1e9,defaults$2={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Decimal,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",exponentOutOfRange=decimalError+"Exponent out of range: ",mathfloor=Math.floor,mathpow=Math.pow,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ONE,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER$1=9007199254740991,MAX_E=mathfloor(MAX_SAFE_INTEGER$1/LOG_BASE),P={};P.absoluteValue=P.abs=function(){var o=new this.constructor(this);return o.s&&(o.s=1),o};P.comparedTo=P.cmp=function(o){var i,_,$,j,_e=this;if(o=new _e.constructor(o),_e.s!==o.s)return _e.s||-o.s;if(_e.e!==o.e)return _e.e>o.e^_e.s<0?1:-1;for($=_e.d.length,j=o.d.length,i=0,_=$<j?$:j;i<_;++i)if(_e.d[i]!==o.d[i])return _e.d[i]>o.d[i]^_e.s<0?1:-1;return $===j?0:$>j^_e.s<0?1:-1};P.decimalPlaces=P.dp=function(){var o=this,i=o.d.length-1,_=(i-o.e)*LOG_BASE;if(i=o.d[i],i)for(;i%10==0;i/=10)_--;return _<0?0:_};P.dividedBy=P.div=function(o){return divide(this,new this.constructor(o))};P.dividedToIntegerBy=P.idiv=function(o){var i=this,_=i.constructor;return round(divide(i,new _(o),0,1),_.precision)};P.equals=P.eq=function(o){return!this.cmp(o)};P.exponent=function(){return getBase10Exponent(this)};P.greaterThan=P.gt=function(o){return this.cmp(o)>0};P.greaterThanOrEqualTo=P.gte=function(o){return this.cmp(o)>=0};P.isInteger=P.isint=function(){return this.e>this.d.length-2};P.isNegative=P.isneg=function(){return this.s<0};P.isPositive=P.ispos=function(){return this.s>0};P.isZero=function(){return this.s===0};P.lessThan=P.lt=function(o){return this.cmp(o)<0};P.lessThanOrEqualTo=P.lte=function(o){return this.cmp(o)<1};P.logarithm=P.log=function(o){var i,_=this,$=_.constructor,j=$.precision,_e=j+5;if(o===void 0)o=new $(10);else if(o=new $(o),o.s<1||o.eq(ONE))throw Error(decimalError+"NaN");if(_.s<1)throw Error(decimalError+(_.s?"NaN":"-Infinity"));return _.eq(ONE)?new $(0):(external=!1,i=divide(ln(_,_e),ln(o,_e),_e),external=!0,round(i,j))};P.minus=P.sub=function(o){var i=this;return o=new i.constructor(o),i.s==o.s?subtract(i,o):add$1(i,(o.s=-o.s,o))};P.modulo=P.mod=function(o){var i,_=this,$=_.constructor,j=$.precision;if(o=new $(o),!o.s)throw Error(decimalError+"NaN");return _.s?(external=!1,i=divide(_,o,0,1).times(o),external=!0,_.minus(i)):round(new $(_),j)};P.naturalExponential=P.exp=function(){return exp(this)};P.naturalLogarithm=P.ln=function(){return ln(this)};P.negated=P.neg=function(){var o=new this.constructor(this);return o.s=-o.s||0,o};P.plus=P.add=function(o){var i=this;return o=new i.constructor(o),i.s==o.s?add$1(i,o):subtract(i,(o.s=-o.s,o))};P.precision=P.sd=function(o){var i,_,$,j=this;if(o!==void 0&&o!==!!o&&o!==1&&o!==0)throw Error(invalidArgument+o);if(i=getBase10Exponent(j)+1,$=j.d.length-1,_=$*LOG_BASE+1,$=j.d[$],$){for(;$%10==0;$/=10)_--;for($=j.d[0];$>=10;$/=10)_++}return o&&i>_?i:_};P.squareRoot=P.sqrt=function(){var o,i,_,$,j,_e,et,tt=this,rt=tt.constructor;if(tt.s<1){if(!tt.s)return new rt(0);throw Error(decimalError+"NaN")}for(o=getBase10Exponent(tt),external=!1,j=Math.sqrt(+tt),j==0||j==1/0?(i=digitsToString(tt.d),(i.length+o)%2==0&&(i+="0"),j=Math.sqrt(i),o=mathfloor((o+1)/2)-(o<0||o%2),j==1/0?i="5e"+o:(i=j.toExponential(),i=i.slice(0,i.indexOf("e")+1)+o),$=new rt(i)):$=new rt(j.toString()),_=rt.precision,j=et=_+3;;)if(_e=$,$=_e.plus(divide(tt,_e,et+2)).times(.5),digitsToString(_e.d).slice(0,et)===(i=digitsToString($.d)).slice(0,et)){if(i=i.slice(et-3,et+1),j==et&&i=="4999"){if(round(_e,_+1,0),_e.times(_e).eq(tt)){$=_e;break}}else if(i!="9999")break;et+=4}return external=!0,round($,_)};P.times=P.mul=function(o){var i,_,$,j,_e,et,tt,rt,nt,it=this,st=it.constructor,at=it.d,ot=(o=new st(o)).d;if(!it.s||!o.s)return new st(0);for(o.s*=it.s,_=it.e+o.e,rt=at.length,nt=ot.length,rt<nt&&(_e=at,at=ot,ot=_e,et=rt,rt=nt,nt=et),_e=[],et=rt+nt,$=et;$--;)_e.push(0);for($=nt;--$>=0;){for(i=0,j=rt+$;j>$;)tt=_e[j]+ot[$]*at[j-$-1]+i,_e[j--]=tt%BASE|0,i=tt/BASE|0;_e[j]=(_e[j]+i)%BASE|0}for(;!_e[--et];)_e.pop();return i?++_:_e.shift(),o.d=_e,o.e=_,external?round(o,st.precision):o};P.toDecimalPlaces=P.todp=function(o,i){var _=this,$=_.constructor;return _=new $(_),o===void 0?_:(checkInt32(o,0,MAX_DIGITS),i===void 0?i=$.rounding:checkInt32(i,0,8),round(_,o+getBase10Exponent(_)+1,i))};P.toExponential=function(o,i){var _,$=this,j=$.constructor;return o===void 0?_=toString($,!0):(checkInt32(o,0,MAX_DIGITS),i===void 0?i=j.rounding:checkInt32(i,0,8),$=round(new j($),o+1,i),_=toString($,!0,o+1)),_};P.toFixed=function(o,i){var _,$,j=this,_e=j.constructor;return o===void 0?toString(j):(checkInt32(o,0,MAX_DIGITS),i===void 0?i=_e.rounding:checkInt32(i,0,8),$=round(new _e(j),o+getBase10Exponent(j)+1,i),_=toString($.abs(),!1,o+getBase10Exponent($)+1),j.isneg()&&!j.isZero()?"-"+_:_)};P.toInteger=P.toint=function(){var o=this,i=o.constructor;return round(new i(o),getBase10Exponent(o)+1,i.rounding)};P.toNumber=function(){return+this};P.toPower=P.pow=function(o){var i,_,$,j,_e,et,tt=this,rt=tt.constructor,nt=12,it=+(o=new rt(o));if(!o.s)return new rt(ONE);if(tt=new rt(tt),!tt.s){if(o.s<1)throw Error(decimalError+"Infinity");return tt}if(tt.eq(ONE))return tt;if($=rt.precision,o.eq(ONE))return round(tt,$);if(i=o.e,_=o.d.length-1,et=i>=_,_e=tt.s,et){if((_=it<0?-it:it)<=MAX_SAFE_INTEGER$1){for(j=new rt(ONE),i=Math.ceil($/LOG_BASE+4),external=!1;_%2&&(j=j.times(tt),truncate(j.d,i)),_=mathfloor(_/2),_!==0;)tt=tt.times(tt),truncate(tt.d,i);return external=!0,o.s<0?new rt(ONE).div(j):round(j,$)}}else if(_e<0)throw Error(decimalError+"NaN");return _e=_e<0&&o.d[Math.max(i,_)]&1?-1:1,tt.s=1,external=!1,j=o.times(ln(tt,$+nt)),external=!0,j=exp(j),j.s=_e,j};P.toPrecision=function(o,i){var _,$,j=this,_e=j.constructor;return o===void 0?(_=getBase10Exponent(j),$=toString(j,_<=_e.toExpNeg||_>=_e.toExpPos)):(checkInt32(o,1,MAX_DIGITS),i===void 0?i=_e.rounding:checkInt32(i,0,8),j=round(new _e(j),o,i),_=getBase10Exponent(j),$=toString(j,o<=_||_<=_e.toExpNeg,o)),$};P.toSignificantDigits=P.tosd=function(o,i){var _=this,$=_.constructor;return o===void 0?(o=$.precision,i=$.rounding):(checkInt32(o,1,MAX_DIGITS),i===void 0?i=$.rounding:checkInt32(i,0,8)),round(new $(_),o,i)};P.toString=P.valueOf=P.val=P.toJSON=P[Symbol.for("nodejs.util.inspect.custom")]=function(){var o=this,i=getBase10Exponent(o),_=o.constructor;return toString(o,i<=_.toExpNeg||i>=_.toExpPos)};function add$1(o,i){var _,$,j,_e,et,tt,rt,nt,it=o.constructor,st=it.precision;if(!o.s||!i.s)return i.s||(i=new it(o)),external?round(i,st):i;if(rt=o.d,nt=i.d,et=o.e,j=i.e,rt=rt.slice(),_e=et-j,_e){for(_e<0?($=rt,_e=-_e,tt=nt.length):($=nt,j=et,tt=rt.length),et=Math.ceil(st/LOG_BASE),tt=et>tt?et+1:tt+1,_e>tt&&(_e=tt,$.length=1),$.reverse();_e--;)$.push(0);$.reverse()}for(tt=rt.length,_e=nt.length,tt-_e<0&&(_e=tt,$=nt,nt=rt,rt=$),_=0;_e;)_=(rt[--_e]=rt[_e]+nt[_e]+_)/BASE|0,rt[_e]%=BASE;for(_&&(rt.unshift(_),++j),tt=rt.length;rt[--tt]==0;)rt.pop();return i.d=rt,i.e=j,external?round(i,st):i}function checkInt32(o,i,_){if(o!==~~o||o<i||o>_)throw Error(invalidArgument+o)}function digitsToString(o){var i,_,$,j=o.length-1,_e="",et=o[0];if(j>0){for(_e+=et,i=1;i<j;i++)$=o[i]+"",_=LOG_BASE-$.length,_&&(_e+=getZeroString(_)),_e+=$;et=o[i],$=et+"",_=LOG_BASE-$.length,_&&(_e+=getZeroString(_))}else if(et===0)return"0";for(;et%10===0;)et/=10;return _e+et}var divide=function(){function o($,j){var _e,et=0,tt=$.length;for($=$.slice();tt--;)_e=$[tt]*j+et,$[tt]=_e%BASE|0,et=_e/BASE|0;return et&&$.unshift(et),$}function i($,j,_e,et){var tt,rt;if(_e!=et)rt=_e>et?1:-1;else for(tt=rt=0;tt<_e;tt++)if($[tt]!=j[tt]){rt=$[tt]>j[tt]?1:-1;break}return rt}function _($,j,_e){for(var et=0;_e--;)$[_e]-=et,et=$[_e]<j[_e]?1:0,$[_e]=et*BASE+$[_e]-j[_e];for(;!$[0]&&$.length>1;)$.shift()}return function($,j,_e,et){var tt,rt,nt,it,st,at,ot,lt,ct,ft,ut,ht,dt,mt,pt,yt,gt,vt,St=$.constructor,At=$.s==j.s?1:-1,xt=$.d,wt=j.d;if(!$.s)return new St($);if(!j.s)throw Error(decimalError+"Division by zero");for(rt=$.e-j.e,gt=wt.length,pt=xt.length,ot=new St(At),lt=ot.d=[],nt=0;wt[nt]==(xt[nt]||0);)++nt;if(wt[nt]>(xt[nt]||0)&&--rt,_e==null?ht=_e=St.precision:et?ht=_e+(getBase10Exponent($)-getBase10Exponent(j))+1:ht=_e,ht<0)return new St(0);if(ht=ht/LOG_BASE+2|0,nt=0,gt==1)for(it=0,wt=wt[0],ht++;(nt<pt||it)&&ht--;nt++)dt=it*BASE+(xt[nt]||0),lt[nt]=dt/wt|0,it=dt%wt|0;else{for(it=BASE/(wt[0]+1)|0,it>1&&(wt=o(wt,it),xt=o(xt,it),gt=wt.length,pt=xt.length),mt=gt,ct=xt.slice(0,gt),ft=ct.length;ft<gt;)ct[ft++]=0;vt=wt.slice(),vt.unshift(0),yt=wt[0],wt[1]>=BASE/2&&++yt;do it=0,tt=i(wt,ct,gt,ft),tt<0?(ut=ct[0],gt!=ft&&(ut=ut*BASE+(ct[1]||0)),it=ut/yt|0,it>1?(it>=BASE&&(it=BASE-1),st=o(wt,it),at=st.length,ft=ct.length,tt=i(st,ct,at,ft),tt==1&&(it--,_(st,gt<at?vt:wt,at))):(it==0&&(tt=it=1),st=wt.slice()),at=st.length,at<ft&&st.unshift(0),_(ct,st,ft),tt==-1&&(ft=ct.length,tt=i(wt,ct,gt,ft),tt<1&&(it++,_(ct,gt<ft?vt:wt,ft))),ft=ct.length):tt===0&&(it++,ct=[0]),lt[nt++]=it,tt&&ct[0]?ct[ft++]=xt[mt]||0:(ct=[xt[mt]],ft=1);while((mt++<pt||ct[0]!==void 0)&&ht--)}return lt[0]||lt.shift(),ot.e=rt,round(ot,et?_e+getBase10Exponent(ot)+1:_e)}}();function exp(o,i){var _,$,j,_e,et,tt,rt=0,nt=0,it=o.constructor,st=it.precision;if(getBase10Exponent(o)>16)throw Error(exponentOutOfRange+getBase10Exponent(o));if(!o.s)return new it(ONE);for(external=!1,tt=st,et=new it(.03125);o.abs().gte(.1);)o=o.times(et),nt+=5;for($=Math.log(mathpow(2,nt))/Math.LN10*2+5|0,tt+=$,_=j=_e=new it(ONE),it.precision=tt;;){if(j=round(j.times(o),tt),_=_.times(++rt),et=_e.plus(divide(j,_,tt)),digitsToString(et.d).slice(0,tt)===digitsToString(_e.d).slice(0,tt)){for(;nt--;)_e=round(_e.times(_e),tt);return it.precision=st,i==null?(external=!0,round(_e,st)):_e}_e=et}}function getBase10Exponent(o){for(var i=o.e*LOG_BASE,_=o.d[0];_>=10;_/=10)i++;return i}function getLn10(o,i,_){if(i>o.LN10.sd())throw external=!0,_&&(o.precision=_),Error(decimalError+"LN10 precision limit exceeded");return round(new o(o.LN10),i)}function getZeroString(o){for(var i="";o--;)i+="0";return i}function ln(o,i){var _,$,j,_e,et,tt,rt,nt,it,st=1,at=10,ot=o,lt=ot.d,ct=ot.constructor,ft=ct.precision;if(ot.s<1)throw Error(decimalError+(ot.s?"NaN":"-Infinity"));if(ot.eq(ONE))return new ct(0);if(i==null?(external=!1,nt=ft):nt=i,ot.eq(10))return i==null&&(external=!0),getLn10(ct,nt);if(nt+=at,ct.precision=nt,_=digitsToString(lt),$=_.charAt(0),_e=getBase10Exponent(ot),Math.abs(_e)<15e14){for(;$<7&&$!=1||$==1&&_.charAt(1)>3;)ot=ot.times(o),_=digitsToString(ot.d),$=_.charAt(0),st++;_e=getBase10Exponent(ot),$>1?(ot=new ct("0."+_),_e++):ot=new ct($+"."+_.slice(1))}else return rt=getLn10(ct,nt+2,ft).times(_e+""),ot=ln(new ct($+"."+_.slice(1)),nt-at).plus(rt),ct.precision=ft,i==null?(external=!0,round(ot,ft)):ot;for(tt=et=ot=divide(ot.minus(ONE),ot.plus(ONE),nt),it=round(ot.times(ot),nt),j=3;;){if(et=round(et.times(it),nt),rt=tt.plus(divide(et,new ct(j),nt)),digitsToString(rt.d).slice(0,nt)===digitsToString(tt.d).slice(0,nt))return tt=tt.times(2),_e!==0&&(tt=tt.plus(getLn10(ct,nt+2,ft).times(_e+""))),tt=divide(tt,new ct(st),nt),ct.precision=ft,i==null?(external=!0,round(tt,ft)):tt;tt=rt,j+=2}}function parseDecimal(o,i){var _,$,j;for((_=i.indexOf("."))>-1&&(i=i.replace(".","")),($=i.search(/e/i))>0?(_<0&&(_=$),_+=+i.slice($+1),i=i.substring(0,$)):_<0&&(_=i.length),$=0;i.charCodeAt($)===48;)++$;for(j=i.length;i.charCodeAt(j-1)===48;)--j;if(i=i.slice($,j),i){if(j-=$,_=_-$-1,o.e=mathfloor(_/LOG_BASE),o.d=[],$=(_+1)%LOG_BASE,_<0&&($+=LOG_BASE),$<j){for($&&o.d.push(+i.slice(0,$)),j-=LOG_BASE;$<j;)o.d.push(+i.slice($,$+=LOG_BASE));i=i.slice($),$=LOG_BASE-i.length}else $-=j;for(;$--;)i+="0";if(o.d.push(+i),external&&(o.e>MAX_E||o.e<-MAX_E))throw Error(exponentOutOfRange+_)}else o.s=0,o.e=0,o.d=[0];return o}function round(o,i,_){var $,j,_e,et,tt,rt,nt,it,st=o.d;for(et=1,_e=st[0];_e>=10;_e/=10)et++;if($=i-et,$<0)$+=LOG_BASE,j=i,nt=st[it=0];else{if(it=Math.ceil(($+1)/LOG_BASE),_e=st.length,it>=_e)return o;for(nt=_e=st[it],et=1;_e>=10;_e/=10)et++;$%=LOG_BASE,j=$-LOG_BASE+et}if(_!==void 0&&(_e=mathpow(10,et-j-1),tt=nt/_e%10|0,rt=i<0||st[it+1]!==void 0||nt%_e,rt=_<4?(tt||rt)&&(_==0||_==(o.s<0?3:2)):tt>5||tt==5&&(_==4||rt||_==6&&($>0?j>0?nt/mathpow(10,et-j):0:st[it-1])%10&1||_==(o.s<0?8:7))),i<1||!st[0])return rt?(_e=getBase10Exponent(o),st.length=1,i=i-_e-1,st[0]=mathpow(10,(LOG_BASE-i%LOG_BASE)%LOG_BASE),o.e=mathfloor(-i/LOG_BASE)||0):(st.length=1,st[0]=o.e=o.s=0),o;if($==0?(st.length=it,_e=1,it--):(st.length=it+1,_e=mathpow(10,LOG_BASE-$),st[it]=j>0?(nt/mathpow(10,et-j)%mathpow(10,j)|0)*_e:0),rt)for(;;)if(it==0){(st[0]+=_e)==BASE&&(st[0]=1,++o.e);break}else{if(st[it]+=_e,st[it]!=BASE)break;st[it--]=0,_e=1}for($=st.length;st[--$]===0;)st.pop();if(external&&(o.e>MAX_E||o.e<-MAX_E))throw Error(exponentOutOfRange+getBase10Exponent(o));return o}function subtract(o,i){var _,$,j,_e,et,tt,rt,nt,it,st,at=o.constructor,ot=at.precision;if(!o.s||!i.s)return i.s?i.s=-i.s:i=new at(o),external?round(i,ot):i;if(rt=o.d,st=i.d,$=i.e,nt=o.e,rt=rt.slice(),et=nt-$,et){for(it=et<0,it?(_=rt,et=-et,tt=st.length):(_=st,$=nt,tt=rt.length),j=Math.max(Math.ceil(ot/LOG_BASE),tt)+2,et>j&&(et=j,_.length=1),_.reverse(),j=et;j--;)_.push(0);_.reverse()}else{for(j=rt.length,tt=st.length,it=j<tt,it&&(tt=j),j=0;j<tt;j++)if(rt[j]!=st[j]){it=rt[j]<st[j];break}et=0}for(it&&(_=rt,rt=st,st=_,i.s=-i.s),tt=rt.length,j=st.length-tt;j>0;--j)rt[tt++]=0;for(j=st.length;j>et;){if(rt[--j]<st[j]){for(_e=j;_e&&rt[--_e]===0;)rt[_e]=BASE-1;--rt[_e],rt[j]+=BASE}rt[j]-=st[j]}for(;rt[--tt]===0;)rt.pop();for(;rt[0]===0;rt.shift())--$;return rt[0]?(i.d=rt,i.e=$,external?round(i,ot):i):new at(0)}function toString(o,i,_){var $,j=getBase10Exponent(o),_e=digitsToString(o.d),et=_e.length;return i?(_&&($=_-et)>0?_e=_e.charAt(0)+"."+_e.slice(1)+getZeroString($):et>1&&(_e=_e.charAt(0)+"."+_e.slice(1)),_e=_e+(j<0?"e":"e+")+j):j<0?(_e="0."+getZeroString(-j-1)+_e,_&&($=_-et)>0&&(_e+=getZeroString($))):j>=et?(_e+=getZeroString(j+1-et),_&&($=_-j-1)>0&&(_e=_e+"."+getZeroString($))):(($=j+1)<et&&(_e=_e.slice(0,$)+"."+_e.slice($)),_&&($=_-et)>0&&(j+1===et&&(_e+="."),_e+=getZeroString($))),o.s<0?"-"+_e:_e}function truncate(o,i){if(o.length>i)return o.length=i,!0}function clone(o){var i,_,$;function j(_e){var et=this;if(!(et instanceof j))return new j(_e);if(et.constructor=j,_e instanceof j){et.s=_e.s,et.e=_e.e,et.d=(_e=_e.d)?_e.slice():_e;return}if(typeof _e=="number"){if(_e*0!==0)throw Error(invalidArgument+_e);if(_e>0)et.s=1;else if(_e<0)_e=-_e,et.s=-1;else{et.s=0,et.e=0,et.d=[0];return}if(_e===~~_e&&_e<1e7){et.e=0,et.d=[_e];return}return parseDecimal(et,_e.toString())}else if(typeof _e!="string")throw Error(invalidArgument+_e);if(_e.charCodeAt(0)===45?(_e=_e.slice(1),et.s=-1):et.s=1,isDecimal.test(_e))parseDecimal(et,_e);else throw Error(invalidArgument+_e)}if(j.prototype=P,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.clone=clone,j.config=j.set=config,o===void 0&&(o={}),o)for($=["precision","rounding","toExpNeg","toExpPos","LN10"],i=0;i<$.length;)o.hasOwnProperty(_=$[i++])||(o[_]=this[_]);return j.config(o),j}function config(o){if(!o||typeof o!="object")throw Error(decimalError+"Object expected");var i,_,$,j=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(i=0;i<j.length;i+=3)if(($=o[_=j[i]])!==void 0)if(mathfloor($)===$&&$>=j[i+1]&&$<=j[i+2])this[_]=$;else throw Error(invalidArgument+_+": "+$);if(($=o[_="LN10"])!==void 0)if($==Math.LN10)this[_]=new this($);else throw Error(invalidArgument+_+": "+$);return this}var Decimal=clone(defaults$2);ONE=new Decimal(1);const Decimal$1=Decimal;function _toConsumableArray$b(o){return _arrayWithoutHoles$b(o)||_iterableToArray$c(o)||_unsupportedIterableToArray$h(o)||_nonIterableSpread$b()}function _nonIterableSpread$b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$h(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$h(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$h(o,i)}}function _iterableToArray$c(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}function _arrayWithoutHoles$b(o){if(Array.isArray(o))return _arrayLikeToArray$h(o)}function _arrayLikeToArray$h(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}var identity$1=function o(i){return i},PLACE_HOLDER={},isPlaceHolder=function o(i){return i===PLACE_HOLDER},curry0=function o(i){return function _(){return arguments.length===0||arguments.length===1&&isPlaceHolder(arguments.length<=0?void 0:arguments[0])?_:i.apply(void 0,arguments)}},curryN=function o(i,_){return i===1?_:curry0(function(){for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];var et=j.filter(function(tt){return tt!==PLACE_HOLDER}).length;return et>=i?_.apply(void 0,j):o(i-et,curry0(function(){for(var tt=arguments.length,rt=new Array(tt),nt=0;nt<tt;nt++)rt[nt]=arguments[nt];var it=j.map(function(st){return isPlaceHolder(st)?rt.shift():st});return _.apply(void 0,_toConsumableArray$b(it).concat(rt))}))})},curry=function o(i){return curryN(i.length,i)},range$2=function o(i,_){for(var $=[],j=i;j<_;++j)$[j-i]=j;return $},map=curry(function(o,i){return Array.isArray(i)?i.map(o):Object.keys(i).map(function(_){return i[_]}).map(o)}),compose=function o(){for(var i=arguments.length,_=new Array(i),$=0;$<i;$++)_[$]=arguments[$];if(!_.length)return identity$1;var j=_.reverse(),_e=j[0],et=j.slice(1);return function(){return et.reduce(function(tt,rt){return rt(tt)},_e.apply(void 0,arguments))}},reverse=function o(i){return Array.isArray(i)?i.reverse():i.split("").reverse.join("")},memoize=function o(i){var _=null,$=null;return function(){for(var j=arguments.length,_e=new Array(j),et=0;et<j;et++)_e[et]=arguments[et];return _&&_e.every(function(tt,rt){return tt===_[rt]})||(_=_e,$=i.apply(void 0,_e)),$}};function getDigitCount(o){var i;return o===0?i=1:i=Math.floor(new Decimal$1(o).abs().log(10).toNumber())+1,i}function rangeStep(o,i,_){for(var $=new Decimal$1(o),j=0,_e=[];$.lt(i)&&j<1e5;)_e.push($.toNumber()),$=$.add(_),j++;return _e}var interpolateNumber=curry(function(o,i,_){var $=+o,j=+i;return $+_*(j-$)}),uninterpolateNumber=curry(function(o,i,_){var $=i-+o;return $=$||1/0,(_-o)/$}),uninterpolateTruncation=curry(function(o,i,_){var $=i-+o;return $=$||1/0,Math.max(0,Math.min(1,(_-o)/$))});const Arithmetic={rangeStep,getDigitCount,interpolateNumber,uninterpolateNumber,uninterpolateTruncation};function _toConsumableArray$a(o){return _arrayWithoutHoles$a(o)||_iterableToArray$b(o)||_unsupportedIterableToArray$g(o)||_nonIterableSpread$a()}function _nonIterableSpread$a(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$b(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}function _arrayWithoutHoles$a(o){if(Array.isArray(o))return _arrayLikeToArray$g(o)}function _slicedToArray$8(o,i){return _arrayWithHoles$9(o)||_iterableToArrayLimit$8(o,i)||_unsupportedIterableToArray$g(o,i)||_nonIterableRest$9()}function _nonIterableRest$9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$g(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$g(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$g(o,i)}}function _arrayLikeToArray$g(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$8(o,i){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(o)))){var _=[],$=!0,j=!1,_e=void 0;try{for(var et=o[Symbol.iterator](),tt;!($=(tt=et.next()).done)&&(_.push(tt.value),!(i&&_.length===i));$=!0);}catch(rt){j=!0,_e=rt}finally{try{!$&&et.return!=null&&et.return()}finally{if(j)throw _e}}return _}}function _arrayWithHoles$9(o){if(Array.isArray(o))return o}function getValidInterval(o){var i=_slicedToArray$8(o,2),_=i[0],$=i[1],j=_,_e=$;return _>$&&(j=$,_e=_),[j,_e]}function getFormatStep(o,i,_){if(o.lte(0))return new Decimal$1(0);var $=Arithmetic.getDigitCount(o.toNumber()),j=new Decimal$1(10).pow($),_e=o.div(j),et=$!==1?.05:.1,tt=new Decimal$1(Math.ceil(_e.div(et).toNumber())).add(_).mul(et),rt=tt.mul(j);return i?rt:new Decimal$1(Math.ceil(rt))}function getTickOfSingleValue(o,i,_){var $=1,j=new Decimal$1(o);if(!j.isint()&&_){var _e=Math.abs(o);_e<1?($=new Decimal$1(10).pow(Arithmetic.getDigitCount(o)-1),j=new Decimal$1(Math.floor(j.div($).toNumber())).mul($)):_e>1&&(j=new Decimal$1(Math.floor(o)))}else o===0?j=new Decimal$1(Math.floor((i-1)/2)):_||(j=new Decimal$1(Math.floor(o)));var et=Math.floor((i-1)/2),tt=compose(map(function(rt){return j.add(new Decimal$1(rt-et).mul($)).toNumber()}),range$2);return tt(0,i)}function calculateStep(o,i,_,$){var j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((i-o)/(_-1)))return{step:new Decimal$1(0),tickMin:new Decimal$1(0),tickMax:new Decimal$1(0)};var _e=getFormatStep(new Decimal$1(i).sub(o).div(_-1),$,j),et;o<=0&&i>=0?et=new Decimal$1(0):(et=new Decimal$1(o).add(i).div(2),et=et.sub(new Decimal$1(et).mod(_e)));var tt=Math.ceil(et.sub(o).div(_e).toNumber()),rt=Math.ceil(new Decimal$1(i).sub(et).div(_e).toNumber()),nt=tt+rt+1;return nt>_?calculateStep(o,i,_,$,j+1):(nt<_&&(rt=i>0?rt+(_-nt):rt,tt=i>0?tt:tt+(_-nt)),{step:_e,tickMin:et.sub(new Decimal$1(tt).mul(_e)),tickMax:et.add(new Decimal$1(rt).mul(_e))})}function getNiceTickValuesFn(o){var i=_slicedToArray$8(o,2),_=i[0],$=i[1],j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,_e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,et=Math.max(j,2),tt=getValidInterval([_,$]),rt=_slicedToArray$8(tt,2),nt=rt[0],it=rt[1];if(nt===-1/0||it===1/0){var st=it===1/0?[nt].concat(_toConsumableArray$a(range$2(0,j-1).map(function(){return 1/0}))):[].concat(_toConsumableArray$a(range$2(0,j-1).map(function(){return-1/0})),[it]);return _>$?reverse(st):st}if(nt===it)return getTickOfSingleValue(nt,j,_e);var at=calculateStep(nt,it,et,_e),ot=at.step,lt=at.tickMin,ct=at.tickMax,ft=Arithmetic.rangeStep(lt,ct.add(new Decimal$1(.1).mul(ot)),ot);return _>$?reverse(ft):ft}function getTickValuesFixedDomainFn(o,i){var _=_slicedToArray$8(o,2),$=_[0],j=_[1],_e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,et=getValidInterval([$,j]),tt=_slicedToArray$8(et,2),rt=tt[0],nt=tt[1];if(rt===-1/0||nt===1/0)return[$,j];if(rt===nt)return[rt];var it=Math.max(i,2),st=getFormatStep(new Decimal$1(nt).sub(rt).div(it-1),_e,0),at=[].concat(_toConsumableArray$a(Arithmetic.rangeStep(new Decimal$1(rt),new Decimal$1(nt).sub(new Decimal$1(.99).mul(st)),st)),[nt]);return $>j?reverse(at):at}var getNiceTickValues=memoize(getNiceTickValuesFn),getTickValuesFixedDomain=memoize(getTickValuesFixedDomainFn),prefix="Invariant failed";function invariant(o,i){if(!o)throw new Error(prefix)}var _excluded$c=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function _typeof$y(o){"@babel/helpers - typeof";return _typeof$y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$y(o)}function _extends$o(){return _extends$o=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$o.apply(this,arguments)}function _slicedToArray$7(o,i){return _arrayWithHoles$8(o)||_iterableToArrayLimit$7(o,i)||_unsupportedIterableToArray$f(o,i)||_nonIterableRest$8()}function _nonIterableRest$8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$f(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$f(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$f(o,i)}}function _arrayLikeToArray$f(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$7(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$8(o){if(Array.isArray(o))return o}function _objectWithoutProperties$c(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$c(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$c(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _classCallCheck$g(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$g(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$y($.key),$)}}function _createClass$g(o,i,_){return i&&_defineProperties$g(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$d(o,i,_){return i=_getPrototypeOf$e(i),_possibleConstructorReturn$e(o,_isNativeReflectConstruct$e()?Reflect.construct(i,_||[],_getPrototypeOf$e(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$e(o,i){if(i&&(_typeof$y(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$e(o)}function _assertThisInitialized$e(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$e(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$e=function(){return!!o})()}function _getPrototypeOf$e(o){return _getPrototypeOf$e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$e(o)}function _inherits$e(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$e(o,i)}function _setPrototypeOf$e(o,i){return _setPrototypeOf$e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$e(o,i)}function _defineProperty$y(o,i,_){return i=_toPropertyKey$y(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$y(o){var i=_toPrimitive$y(o,"string");return _typeof$y(i)=="symbol"?i:i+""}function _toPrimitive$y(o,i){if(_typeof$y(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$y($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var ErrorBar=function(o){function i(){return _classCallCheck$g(this,i),_callSuper$d(this,i,arguments)}return _inherits$e(i,o),_createClass$g(i,[{key:"render",value:function(){var $=this.props,j=$.offset,_e=$.layout,et=$.width,tt=$.dataKey,rt=$.data,nt=$.dataPointFormatter,it=$.xAxis,st=$.yAxis,at=_objectWithoutProperties$c($,_excluded$c),ot=filterProps(at,!1);this.props.direction==="x"&&it.type!=="number"&&invariant(!1);var lt=rt.map(function(ct){var ft=nt(ct,tt),ut=ft.x,ht=ft.y,dt=ft.value,mt=ft.errorVal;if(!mt)return null;var pt=[],yt,gt;if(Array.isArray(mt)){var vt=_slicedToArray$7(mt,2);yt=vt[0],gt=vt[1]}else yt=gt=mt;if(_e==="vertical"){var St=it.scale,At=ht+j,xt=At+et,wt=At-et,Ot=St(dt-yt),Bt=St(dt+gt);pt.push({x1:Bt,y1:xt,x2:Bt,y2:wt}),pt.push({x1:Ot,y1:At,x2:Bt,y2:At}),pt.push({x1:Ot,y1:xt,x2:Ot,y2:wt})}else if(_e==="horizontal"){var Ft=st.scale,Pt=ut+j,Rt=Pt-et,Et=Pt+et,_t=Ft(dt-yt),Mt=Ft(dt+gt);pt.push({x1:Rt,y1:Mt,x2:Et,y2:Mt}),pt.push({x1:Pt,y1:_t,x2:Pt,y2:Mt}),pt.push({x1:Rt,y1:_t,x2:Et,y2:_t})}return React$2.createElement(Layer,_extends$o({className:"recharts-errorBar",key:"bar-".concat(pt.map(function(Dt){return"".concat(Dt.x1,"-").concat(Dt.x2,"-").concat(Dt.y1,"-").concat(Dt.y2)}))},ot),pt.map(function(Dt){return React$2.createElement("line",_extends$o({},Dt,{key:"line-".concat(Dt.x1,"-").concat(Dt.x2,"-").concat(Dt.y1,"-").concat(Dt.y2)}))}))});return React$2.createElement(Layer,{className:"recharts-errorBars"},lt)}}])}(React$2.Component);_defineProperty$y(ErrorBar,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});_defineProperty$y(ErrorBar,"displayName","ErrorBar");function _typeof$x(o){"@babel/helpers - typeof";return _typeof$x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$x(o)}function ownKeys$u(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$t(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$u(Object(_),!0).forEach(function($){_defineProperty$x(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$u(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$x(o,i,_){return i=_toPropertyKey$x(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$x(o){var i=_toPrimitive$x(o,"string");return _typeof$x(i)=="symbol"?i:i+""}function _toPrimitive$x(o,i){if(_typeof$x(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$x($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var getLegendProps=function o(i){var _=i.children,$=i.formattedGraphicalItems,j=i.legendWidth,_e=i.legendContent,et=findChildByType(_,Legend);if(!et)return null;var tt=Legend.defaultProps,rt=tt!==void 0?_objectSpread$t(_objectSpread$t({},tt),et.props):{},nt;return et.props&&et.props.payload?nt=et.props&&et.props.payload:_e==="children"?nt=($||[]).reduce(function(it,st){var at=st.item,ot=st.props,lt=ot.sectors||ot.data||[];return it.concat(lt.map(function(ct){return{type:et.props.iconType||at.props.legendType,value:ct.name,color:ct.fill,payload:ct}}))},[]):nt=($||[]).map(function(it){var st=it.item,at=st.type.defaultProps,ot=at!==void 0?_objectSpread$t(_objectSpread$t({},at),st.props):{},lt=ot.dataKey,ct=ot.name,ft=ot.legendType,ut=ot.hide;return{inactive:ut,dataKey:lt,type:rt.iconType||ft||"square",color:getMainColorOfGraphicItem(st),value:ct||lt,payload:ot}}),_objectSpread$t(_objectSpread$t(_objectSpread$t({},rt),Legend.getWithHeight(et,j)),{},{payload:nt,item:et})};function _typeof$w(o){"@babel/helpers - typeof";return _typeof$w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$w(o)}function _toConsumableArray$9(o){return _arrayWithoutHoles$9(o)||_iterableToArray$a(o)||_unsupportedIterableToArray$e(o)||_nonIterableSpread$9()}function _nonIterableSpread$9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$e(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$e(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$e(o,i)}}function _iterableToArray$a(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$9(o){if(Array.isArray(o))return _arrayLikeToArray$e(o)}function _arrayLikeToArray$e(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function ownKeys$t(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$s(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$t(Object(_),!0).forEach(function($){_defineProperty$w(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$t(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$w(o,i,_){return i=_toPropertyKey$w(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$w(o){var i=_toPrimitive$w(o,"string");return _typeof$w(i)=="symbol"?i:i+""}function _toPrimitive$w(o,i){if(_typeof$w(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$w($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function getValueByDataKey(o,i,_){return isNil$1(o)||isNil$1(i)?_:isNumOrStr(i)?get$4(o,i,_):isFunction$3(i)?i(o):_}function getDomainOfDataByKey(o,i,_,$){var j=flatMap$1(o,function(tt){return getValueByDataKey(tt,i)});if(_==="number"){var _e=j.filter(function(tt){return isNumber(tt)||parseFloat(tt)});return _e.length?[min$1(_e),max$1(_e)]:[1/0,-1/0]}var et=$?j.filter(function(tt){return!isNil$1(tt)}):j;return et.map(function(tt){return isNumOrStr(tt)||tt instanceof Date?tt:""})}var calculateActiveTickIndex=function o(i){var _,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],j=arguments.length>2?arguments[2]:void 0,_e=arguments.length>3?arguments[3]:void 0,et=-1,tt=(_=$==null?void 0:$.length)!==null&&_!==void 0?_:0;if(tt<=1)return 0;if(_e&&_e.axisType==="angleAxis"&&Math.abs(Math.abs(_e.range[1]-_e.range[0])-360)<=1e-6)for(var rt=_e.range,nt=0;nt<tt;nt++){var it=nt>0?j[nt-1].coordinate:j[tt-1].coordinate,st=j[nt].coordinate,at=nt>=tt-1?j[0].coordinate:j[nt+1].coordinate,ot=void 0;if(mathSign(st-it)!==mathSign(at-st)){var lt=[];if(mathSign(at-st)===mathSign(rt[1]-rt[0])){ot=at;var ct=st+rt[1]-rt[0];lt[0]=Math.min(ct,(ct+it)/2),lt[1]=Math.max(ct,(ct+it)/2)}else{ot=it;var ft=at+rt[1]-rt[0];lt[0]=Math.min(st,(ft+st)/2),lt[1]=Math.max(st,(ft+st)/2)}var ut=[Math.min(st,(ot+st)/2),Math.max(st,(ot+st)/2)];if(i>ut[0]&&i<=ut[1]||i>=lt[0]&&i<=lt[1]){et=j[nt].index;break}}else{var ht=Math.min(it,at),dt=Math.max(it,at);if(i>(ht+st)/2&&i<=(dt+st)/2){et=j[nt].index;break}}}else for(var mt=0;mt<tt;mt++)if(mt===0&&i<=($[mt].coordinate+$[mt+1].coordinate)/2||mt>0&&mt<tt-1&&i>($[mt].coordinate+$[mt-1].coordinate)/2&&i<=($[mt].coordinate+$[mt+1].coordinate)/2||mt===tt-1&&i>($[mt].coordinate+$[mt-1].coordinate)/2){et=$[mt].index;break}return et},getMainColorOfGraphicItem=function o(i){var _,$=i,j=$.type.displayName,_e=(_=i.type)!==null&&_!==void 0&&_.defaultProps?_objectSpread$s(_objectSpread$s({},i.type.defaultProps),i.props):i.props,et=_e.stroke,tt=_e.fill,rt;switch(j){case"Line":rt=et;break;case"Area":case"Radar":rt=et&&et!=="none"?et:tt;break;default:rt=tt;break}return rt},getBarSizeList=function o(i){var _=i.barSize,$=i.totalSize,j=i.stackGroups,_e=j===void 0?{}:j;if(!_e)return{};for(var et={},tt=Object.keys(_e),rt=0,nt=tt.length;rt<nt;rt++)for(var it=_e[tt[rt]].stackGroups,st=Object.keys(it),at=0,ot=st.length;at<ot;at++){var lt=it[st[at]],ct=lt.items,ft=lt.cateAxisId,ut=ct.filter(function(gt){return getDisplayName(gt.type).indexOf("Bar")>=0});if(ut&&ut.length){var ht=ut[0].type.defaultProps,dt=ht!==void 0?_objectSpread$s(_objectSpread$s({},ht),ut[0].props):ut[0].props,mt=dt.barSize,pt=dt[ft];et[pt]||(et[pt]=[]);var yt=isNil$1(mt)?_:mt;et[pt].push({item:ut[0],stackList:ut.slice(1),barSize:isNil$1(yt)?void 0:getPercentValue(yt,$,0)})}}return et},getBarPosition=function o(i){var _=i.barGap,$=i.barCategoryGap,j=i.bandSize,_e=i.sizeList,et=_e===void 0?[]:_e,tt=i.maxBarSize,rt=et.length;if(rt<1)return null;var nt=getPercentValue(_,j,0,!0),it,st=[];if(et[0].barSize===+et[0].barSize){var at=!1,ot=j/rt,lt=et.reduce(function(mt,pt){return mt+pt.barSize||0},0);lt+=(rt-1)*nt,lt>=j&&(lt-=(rt-1)*nt,nt=0),lt>=j&&ot>0&&(at=!0,ot*=.9,lt=rt*ot);var ct=(j-lt)/2>>0,ft={offset:ct-nt,size:0};it=et.reduce(function(mt,pt){var yt={item:pt.item,position:{offset:ft.offset+ft.size+nt,size:at?ot:pt.barSize}},gt=[].concat(_toConsumableArray$9(mt),[yt]);return ft=gt[gt.length-1].position,pt.stackList&&pt.stackList.length&&pt.stackList.forEach(function(vt){gt.push({item:vt,position:ft})}),gt},st)}else{var ut=getPercentValue($,j,0,!0);j-2*ut-(rt-1)*nt<=0&&(nt=0);var ht=(j-2*ut-(rt-1)*nt)/rt;ht>1&&(ht>>=0);var dt=tt===+tt?Math.min(ht,tt):ht;it=et.reduce(function(mt,pt,yt){var gt=[].concat(_toConsumableArray$9(mt),[{item:pt.item,position:{offset:ut+(ht+nt)*yt+(ht-dt)/2,size:dt}}]);return pt.stackList&&pt.stackList.length&&pt.stackList.forEach(function(vt){gt.push({item:vt,position:gt[gt.length-1].position})}),gt},st)}return it},appendOffsetOfLegend=function o(i,_,$,j){var _e=$.children,et=$.width,tt=$.margin,rt=et-(tt.left||0)-(tt.right||0),nt=getLegendProps({children:_e,legendWidth:rt});if(nt){var it=j||{},st=it.width,at=it.height,ot=nt.align,lt=nt.verticalAlign,ct=nt.layout;if((ct==="vertical"||ct==="horizontal"&&lt==="middle")&&ot!=="center"&&isNumber(i[ot]))return _objectSpread$s(_objectSpread$s({},i),{},_defineProperty$w({},ot,i[ot]+(st||0)));if((ct==="horizontal"||ct==="vertical"&&ot==="center")&&lt!=="middle"&&isNumber(i[lt]))return _objectSpread$s(_objectSpread$s({},i),{},_defineProperty$w({},lt,i[lt]+(at||0)))}return i},isErrorBarRelevantForAxis=function o(i,_,$){return isNil$1(_)?!0:i==="horizontal"?_==="yAxis":i==="vertical"||$==="x"?_==="xAxis":$==="y"?_==="yAxis":!0},getDomainOfErrorBars=function o(i,_,$,j,_e){var et=_.props.children,tt=findAllByType(et,ErrorBar).filter(function(nt){return isErrorBarRelevantForAxis(j,_e,nt.props.direction)});if(tt&&tt.length){var rt=tt.map(function(nt){return nt.props.dataKey});return i.reduce(function(nt,it){var st=getValueByDataKey(it,$);if(isNil$1(st))return nt;var at=Array.isArray(st)?[min$1(st),max$1(st)]:[st,st],ot=rt.reduce(function(lt,ct){var ft=getValueByDataKey(it,ct,0),ut=at[0]-Math.abs(Array.isArray(ft)?ft[0]:ft),ht=at[1]+Math.abs(Array.isArray(ft)?ft[1]:ft);return[Math.min(ut,lt[0]),Math.max(ht,lt[1])]},[1/0,-1/0]);return[Math.min(ot[0],nt[0]),Math.max(ot[1],nt[1])]},[1/0,-1/0])}return null},parseErrorBarsOfAxis=function o(i,_,$,j,_e){var et=_.map(function(tt){return getDomainOfErrorBars(i,tt,$,_e,j)}).filter(function(tt){return!isNil$1(tt)});return et&&et.length?et.reduce(function(tt,rt){return[Math.min(tt[0],rt[0]),Math.max(tt[1],rt[1])]},[1/0,-1/0]):null},getDomainOfItemsWithSameAxis=function o(i,_,$,j,_e){var et=_.map(function(rt){var nt=rt.props.dataKey;return $==="number"&&nt&&getDomainOfErrorBars(i,rt,nt,j)||getDomainOfDataByKey(i,nt,$,_e)});if($==="number")return et.reduce(function(rt,nt){return[Math.min(rt[0],nt[0]),Math.max(rt[1],nt[1])]},[1/0,-1/0]);var tt={};return et.reduce(function(rt,nt){for(var it=0,st=nt.length;it<st;it++)tt[nt[it]]||(tt[nt[it]]=!0,rt.push(nt[it]));return rt},[])},isCategoricalAxis=function o(i,_){return i==="horizontal"&&_==="xAxis"||i==="vertical"&&_==="yAxis"||i==="centric"&&_==="angleAxis"||i==="radial"&&_==="radiusAxis"},getTicksOfAxis=function o(i,_,$){if(!i)return null;var j=i.scale,_e=i.duplicateDomain,et=i.type,tt=i.range,rt=i.realScaleType==="scaleBand"?j.bandwidth()/2:2,nt=(_||$)&&et==="category"&&j.bandwidth?j.bandwidth()/rt:0;if(nt=i.axisType==="angleAxis"&&(tt==null?void 0:tt.length)>=2?mathSign(tt[0]-tt[1])*2*nt:nt,_&&(i.ticks||i.niceTicks)){var it=(i.ticks||i.niceTicks).map(function(st){var at=_e?_e.indexOf(st):st;return{coordinate:j(at)+nt,value:st,offset:nt}});return it.filter(function(st){return!isNan(st.coordinate)})}return i.isCategorical&&i.categoricalDomain?i.categoricalDomain.map(function(st,at){return{coordinate:j(st)+nt,value:st,index:at,offset:nt}}):j.ticks&&!$?j.ticks(i.tickCount).map(function(st){return{coordinate:j(st)+nt,value:st,offset:nt}}):j.domain().map(function(st,at){return{coordinate:j(st)+nt,value:_e?_e[st]:st,index:at,offset:nt}})},handlerWeakMap=new WeakMap,combineEventHandlers=function o(i,_){if(typeof _!="function")return i;handlerWeakMap.has(i)||handlerWeakMap.set(i,new WeakMap);var $=handlerWeakMap.get(i);if($.has(_))return $.get(_);var j=function(){i.apply(void 0,arguments),_.apply(void 0,arguments)};return $.set(_,j),j},parseScale=function o(i,_,$){var j=i.scale,_e=i.type,et=i.layout,tt=i.axisType;if(j==="auto")return et==="radial"&&tt==="radiusAxis"?{scale:band(),realScaleType:"band"}:et==="radial"&&tt==="angleAxis"?{scale:linear(),realScaleType:"linear"}:_e==="category"&&_&&(_.indexOf("LineChart")>=0||_.indexOf("AreaChart")>=0||_.indexOf("ComposedChart")>=0&&!$)?{scale:point(),realScaleType:"point"}:_e==="category"?{scale:band(),realScaleType:"band"}:{scale:linear(),realScaleType:"linear"};if(isString$3(j)){var rt="scale".concat(upperFirst$1(j));return{scale:(d3Scales[rt]||point)(),realScaleType:d3Scales[rt]?rt:"point"}}return isFunction$3(j)?{scale:j}:{scale:point(),realScaleType:"point"}},EPS=1e-4,checkDomainOfScale=function o(i){var _=i.domain();if(!(!_||_.length<=2)){var $=_.length,j=i.range(),_e=Math.min(j[0],j[1])-EPS,et=Math.max(j[0],j[1])+EPS,tt=i(_[0]),rt=i(_[$-1]);(tt<_e||tt>et||rt<_e||rt>et)&&i.domain([_[0],_[$-1]])}},findPositionOfBar=function o(i,_){if(!i)return null;for(var $=0,j=i.length;$<j;$++)if(i[$].item===_)return i[$].position;return null},truncateByDomain=function o(i,_){if(!_||_.length!==2||!isNumber(_[0])||!isNumber(_[1]))return i;var $=Math.min(_[0],_[1]),j=Math.max(_[0],_[1]),_e=[i[0],i[1]];return(!isNumber(i[0])||i[0]<$)&&(_e[0]=$),(!isNumber(i[1])||i[1]>j)&&(_e[1]=j),_e[0]>j&&(_e[0]=j),_e[1]<$&&(_e[1]=$),_e},offsetSign=function o(i){var _=i.length;if(!(_<=0))for(var $=0,j=i[0].length;$<j;++$)for(var _e=0,et=0,tt=0;tt<_;++tt){var rt=isNan(i[tt][$][1])?i[tt][$][0]:i[tt][$][1];rt>=0?(i[tt][$][0]=_e,i[tt][$][1]=_e+rt,_e=i[tt][$][1]):(i[tt][$][0]=et,i[tt][$][1]=et+rt,et=i[tt][$][1])}},offsetPositive=function o(i){var _=i.length;if(!(_<=0))for(var $=0,j=i[0].length;$<j;++$)for(var _e=0,et=0;et<_;++et){var tt=isNan(i[et][$][1])?i[et][$][0]:i[et][$][1];tt>=0?(i[et][$][0]=_e,i[et][$][1]=_e+tt,_e=i[et][$][1]):(i[et][$][0]=0,i[et][$][1]=0)}},STACK_OFFSET_MAP={sign:offsetSign,expand:stackOffsetExpand,none:stackOffsetNone,silhouette:stackOffsetSilhouette,wiggle:stackOffsetWiggle,positive:offsetPositive},getStackedData=function o(i,_,$){var j=_.map(function(tt){return tt.props.dataKey}),_e=STACK_OFFSET_MAP[$],et=shapeStack().keys(j).value(function(tt,rt){return+getValueByDataKey(tt,rt,0)}).order(stackOrderNone).offset(_e);return et(i)},getStackGroupsByAxisId=function o(i,_,$,j,_e,et){if(!i)return null;var tt=et?_.reverse():_,rt={},nt=tt.reduce(function(st,at){var ot,lt=(ot=at.type)!==null&&ot!==void 0&&ot.defaultProps?_objectSpread$s(_objectSpread$s({},at.type.defaultProps),at.props):at.props,ct=lt.stackId,ft=lt.hide;if(ft)return st;var ut=lt[$],ht=st[ut]||{hasStack:!1,stackGroups:{}};if(isNumOrStr(ct)){var dt=ht.stackGroups[ct]||{numericAxisId:$,cateAxisId:j,items:[]};dt.items.push(at),ht.hasStack=!0,ht.stackGroups[ct]=dt}else ht.stackGroups[uniqueId("_stackId_")]={numericAxisId:$,cateAxisId:j,items:[at]};return _objectSpread$s(_objectSpread$s({},st),{},_defineProperty$w({},ut,ht))},rt),it={};return Object.keys(nt).reduce(function(st,at){var ot=nt[at];if(ot.hasStack){var lt={};ot.stackGroups=Object.keys(ot.stackGroups).reduce(function(ct,ft){var ut=ot.stackGroups[ft];return _objectSpread$s(_objectSpread$s({},ct),{},_defineProperty$w({},ft,{numericAxisId:$,cateAxisId:j,items:ut.items,stackedData:getStackedData(i,ut.items,_e)}))},lt)}return _objectSpread$s(_objectSpread$s({},st),{},_defineProperty$w({},at,ot))},it)},getTicksOfScale=function o(i,_){var $=_.realScaleType,j=_.type,_e=_.tickCount,et=_.originalDomain,tt=_.allowDecimals,rt=$||_.scale;if(rt!=="auto"&&rt!=="linear")return null;if(_e&&j==="number"&&et&&(et[0]==="auto"||et[1]==="auto")){var nt=i.domain();if(!nt.length)return null;var it=getNiceTickValues(nt,_e,tt);return i.domain([min$1(it),max$1(it)]),{niceTicks:it}}if(_e&&j==="number"){var st=i.domain(),at=getTickValuesFixedDomain(st,_e,tt);return{niceTicks:at}}return null};function getCateCoordinateOfLine(o){var i=o.axis,_=o.ticks,$=o.bandSize,j=o.entry,_e=o.index,et=o.dataKey;if(i.type==="category"){if(!i.allowDuplicatedCategory&&i.dataKey&&!isNil$1(j[i.dataKey])){var tt=findEntryInArray(_,"value",j[i.dataKey]);if(tt)return tt.coordinate+$/2}return _[_e]?_[_e].coordinate+$/2:null}var rt=getValueByDataKey(j,isNil$1(et)?i.dataKey:et);return isNil$1(rt)?null:i.scale(rt)}var getCateCoordinateOfBar=function o(i){var _=i.axis,$=i.ticks,j=i.offset,_e=i.bandSize,et=i.entry,tt=i.index;if(_.type==="category")return $[tt]?$[tt].coordinate+j:null;var rt=getValueByDataKey(et,_.dataKey,_.domain[tt]);return isNil$1(rt)?null:_.scale(rt)-_e/2+j},getBaseValueOfBar=function o(i){var _=i.numericAxis,$=_.scale.domain();if(_.type==="number"){var j=Math.min($[0],$[1]),_e=Math.max($[0],$[1]);return j<=0&&_e>=0?0:_e<0?_e:j}return $[0]},getStackedDataOfItem=function o(i,_){var $,j=($=i.type)!==null&&$!==void 0&&$.defaultProps?_objectSpread$s(_objectSpread$s({},i.type.defaultProps),i.props):i.props,_e=j.stackId;if(isNumOrStr(_e)){var et=_[_e];if(et){var tt=et.items.indexOf(i);return tt>=0?et.stackedData[tt]:null}}return null},getDomainOfSingle=function o(i){return i.reduce(function(_,$){return[min$1($.concat([_[0]]).filter(isNumber)),max$1($.concat([_[1]]).filter(isNumber))]},[1/0,-1/0])},getDomainOfStackGroups=function o(i,_,$){return Object.keys(i).reduce(function(j,_e){var et=i[_e],tt=et.stackedData,rt=tt.reduce(function(nt,it){var st=getDomainOfSingle(it.slice(_,$+1));return[Math.min(nt[0],st[0]),Math.max(nt[1],st[1])]},[1/0,-1/0]);return[Math.min(rt[0],j[0]),Math.max(rt[1],j[1])]},[1/0,-1/0]).map(function(j){return j===1/0||j===-1/0?0:j})},MIN_VALUE_REG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MAX_VALUE_REG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,parseSpecifiedDomain=function o(i,_,$){if(isFunction$3(i))return i(_,$);if(!Array.isArray(i))return _;var j=[];if(isNumber(i[0]))j[0]=$?i[0]:Math.min(i[0],_[0]);else if(MIN_VALUE_REG.test(i[0])){var _e=+MIN_VALUE_REG.exec(i[0])[1];j[0]=_[0]-_e}else isFunction$3(i[0])?j[0]=i[0](_[0]):j[0]=_[0];if(isNumber(i[1]))j[1]=$?i[1]:Math.max(i[1],_[1]);else if(MAX_VALUE_REG.test(i[1])){var et=+MAX_VALUE_REG.exec(i[1])[1];j[1]=_[1]+et}else isFunction$3(i[1])?j[1]=i[1](_[1]):j[1]=_[1];return j},getBandSizeOfAxis=function o(i,_,$){if(i&&i.scale&&i.scale.bandwidth){var j=i.scale.bandwidth();if(!$||j>0)return j}if(i&&_&&_.length>=2){for(var _e=sortBy$1(_,function(st){return st.coordinate}),et=1/0,tt=1,rt=_e.length;tt<rt;tt++){var nt=_e[tt],it=_e[tt-1];et=Math.min((nt.coordinate||0)-(it.coordinate||0),et)}return et===1/0?0:et}return $?void 0:0},parseDomainOfCategoryAxis=function o(i,_,$){return!i||!i.length||isEqual$1(i,get$4($,"type.defaultProps.domain"))?_:i},getTooltipItem=function o(i,_){var $=i.type.defaultProps?_objectSpread$s(_objectSpread$s({},i.type.defaultProps),i.props):i.props,j=$.dataKey,_e=$.name,et=$.unit,tt=$.formatter,rt=$.tooltipType,nt=$.chartType,it=$.hide;return _objectSpread$s(_objectSpread$s({},filterProps(i,!1)),{},{dataKey:j,unit:et,formatter:tt,name:_e||j,color:getMainColorOfGraphicItem(i),value:getValueByDataKey(_,j),type:rt,payload:_,chartType:nt,hide:it})};function _typeof$v(o){"@babel/helpers - typeof";return _typeof$v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$v(o)}function ownKeys$s(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$r(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$s(Object(_),!0).forEach(function($){_defineProperty$v(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$s(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$v(o,i,_){return i=_toPropertyKey$v(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$v(o){var i=_toPrimitive$v(o,"string");return _typeof$v(i)=="symbol"?i:i+""}function _toPrimitive$v(o,i){if(_typeof$v(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$v($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _slicedToArray$6(o,i){return _arrayWithHoles$7(o)||_iterableToArrayLimit$6(o,i)||_unsupportedIterableToArray$d(o,i)||_nonIterableRest$7()}function _nonIterableRest$7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$d(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$d(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$d(o,i)}}function _arrayLikeToArray$d(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$6(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$7(o){if(Array.isArray(o))return o}var RADIAN$1=Math.PI/180,radianToDegree=function o(i){return i*180/Math.PI},polarToCartesian=function o(i,_,$,j){return{x:i+Math.cos(-RADIAN$1*j)*$,y:_+Math.sin(-RADIAN$1*j)*$}},getMaxRadius=function o(i,_){var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(i-($.left||0)-($.right||0)),Math.abs(_-($.top||0)-($.bottom||0)))/2},formatAxisMap$1=function o(i,_,$,j,_e){var et=i.width,tt=i.height,rt=i.startAngle,nt=i.endAngle,it=getPercentValue(i.cx,et,et/2),st=getPercentValue(i.cy,tt,tt/2),at=getMaxRadius(et,tt,$),ot=getPercentValue(i.innerRadius,at,0),lt=getPercentValue(i.outerRadius,at,at*.8),ct=Object.keys(_);return ct.reduce(function(ft,ut){var ht=_[ut],dt=ht.domain,mt=ht.reversed,pt;if(isNil$1(ht.range))j==="angleAxis"?pt=[rt,nt]:j==="radiusAxis"&&(pt=[ot,lt]),mt&&(pt=[pt[1],pt[0]]);else{pt=ht.range;var yt=pt,gt=_slicedToArray$6(yt,2);rt=gt[0],nt=gt[1]}var vt=parseScale(ht,_e),St=vt.realScaleType,At=vt.scale;At.domain(dt).range(pt),checkDomainOfScale(At);var xt=getTicksOfScale(At,_objectSpread$r(_objectSpread$r({},ht),{},{realScaleType:St})),wt=_objectSpread$r(_objectSpread$r(_objectSpread$r({},ht),xt),{},{range:pt,radius:lt,realScaleType:St,scale:At,cx:it,cy:st,innerRadius:ot,outerRadius:lt,startAngle:rt,endAngle:nt});return _objectSpread$r(_objectSpread$r({},ft),{},_defineProperty$v({},ut,wt))},{})},distanceBetweenPoints=function o(i,_){var $=i.x,j=i.y,_e=_.x,et=_.y;return Math.sqrt(Math.pow($-_e,2)+Math.pow(j-et,2))},getAngleOfPoint=function o(i,_){var $=i.x,j=i.y,_e=_.cx,et=_.cy,tt=distanceBetweenPoints({x:$,y:j},{x:_e,y:et});if(tt<=0)return{radius:tt};var rt=($-_e)/tt,nt=Math.acos(rt);return j>et&&(nt=2*Math.PI-nt),{radius:tt,angle:radianToDegree(nt),angleInRadian:nt}},formatAngleOfSector=function o(i){var _=i.startAngle,$=i.endAngle,j=Math.floor(_/360),_e=Math.floor($/360),et=Math.min(j,_e);return{startAngle:_-et*360,endAngle:$-et*360}},reverseFormatAngleOfSetor=function o(i,_){var $=_.startAngle,j=_.endAngle,_e=Math.floor($/360),et=Math.floor(j/360),tt=Math.min(_e,et);return i+tt*360},inRangeOfSector=function o(i,_){var $=i.x,j=i.y,_e=getAngleOfPoint({x:$,y:j},_),et=_e.radius,tt=_e.angle,rt=_.innerRadius,nt=_.outerRadius;if(et<rt||et>nt)return!1;if(et===0)return!0;var it=formatAngleOfSector(_),st=it.startAngle,at=it.endAngle,ot=tt,lt;if(st<=at){for(;ot>at;)ot-=360;for(;ot<st;)ot+=360;lt=ot>=st&&ot<=at}else{for(;ot>st;)ot-=360;for(;ot<at;)ot+=360;lt=ot>=at&&ot<=st}return lt?_objectSpread$r(_objectSpread$r({},_),{},{radius:et,angle:reverseFormatAngleOfSetor(ot,_)}):null},getTickClassName=function o(i){return!reactExports.isValidElement(i)&&!isFunction$3(i)&&typeof i!="boolean"?i.className:""};function _typeof$u(o){"@babel/helpers - typeof";return _typeof$u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$u(o)}var _excluded$b=["offset"];function _toConsumableArray$8(o){return _arrayWithoutHoles$8(o)||_iterableToArray$9(o)||_unsupportedIterableToArray$c(o)||_nonIterableSpread$8()}function _nonIterableSpread$8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$c(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$c(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$c(o,i)}}function _iterableToArray$9(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$8(o){if(Array.isArray(o))return _arrayLikeToArray$c(o)}function _arrayLikeToArray$c(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _objectWithoutProperties$b(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$b(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$b(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function ownKeys$r(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$q(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$r(Object(_),!0).forEach(function($){_defineProperty$u(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$r(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$u(o,i,_){return i=_toPropertyKey$u(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$u(o){var i=_toPrimitive$u(o,"string");return _typeof$u(i)=="symbol"?i:i+""}function _toPrimitive$u(o,i){if(_typeof$u(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$u($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _extends$n(){return _extends$n=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$n.apply(this,arguments)}var getLabel=function o(i){var _=i.value,$=i.formatter,j=isNil$1(i.children)?_:i.children;return isFunction$3($)?$(j):j},getDeltaAngle$1=function o(i,_){var $=mathSign(_-i),j=Math.min(Math.abs(_-i),360);return $*j},renderRadialLabel=function o(i,_,$){var j=i.position,_e=i.viewBox,et=i.offset,tt=i.className,rt=_e,nt=rt.cx,it=rt.cy,st=rt.innerRadius,at=rt.outerRadius,ot=rt.startAngle,lt=rt.endAngle,ct=rt.clockWise,ft=(st+at)/2,ut=getDeltaAngle$1(ot,lt),ht=ut>=0?1:-1,dt,mt;j==="insideStart"?(dt=ot+ht*et,mt=ct):j==="insideEnd"?(dt=lt-ht*et,mt=!ct):j==="end"&&(dt=lt+ht*et,mt=ct),mt=ut<=0?mt:!mt;var pt=polarToCartesian(nt,it,ft,dt),yt=polarToCartesian(nt,it,ft,dt+(mt?1:-1)*359),gt="M".concat(pt.x,",").concat(pt.y,`
    A`).concat(ft,",").concat(ft,",0,1,").concat(mt?0:1,`,
    `).concat(yt.x,",").concat(yt.y),vt=isNil$1(i.id)?uniqueId("recharts-radial-line-"):i.id;return React$2.createElement("text",_extends$n({},$,{dominantBaseline:"central",className:clsx("recharts-radial-bar-label",tt)}),React$2.createElement("defs",null,React$2.createElement("path",{id:vt,d:gt})),React$2.createElement("textPath",{xlinkHref:"#".concat(vt)},_))},getAttrsOfPolarLabel=function o(i){var _=i.viewBox,$=i.offset,j=i.position,_e=_,et=_e.cx,tt=_e.cy,rt=_e.innerRadius,nt=_e.outerRadius,it=_e.startAngle,st=_e.endAngle,at=(it+st)/2;if(j==="outside"){var ot=polarToCartesian(et,tt,nt+$,at),lt=ot.x,ct=ot.y;return{x:lt,y:ct,textAnchor:lt>=et?"start":"end",verticalAnchor:"middle"}}if(j==="center")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"middle"};if(j==="centerTop")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"start"};if(j==="centerBottom")return{x:et,y:tt,textAnchor:"middle",verticalAnchor:"end"};var ft=(rt+nt)/2,ut=polarToCartesian(et,tt,ft,at),ht=ut.x,dt=ut.y;return{x:ht,y:dt,textAnchor:"middle",verticalAnchor:"middle"}},getAttrsOfCartesianLabel=function o(i){var _=i.viewBox,$=i.parentViewBox,j=i.offset,_e=i.position,et=_,tt=et.x,rt=et.y,nt=et.width,it=et.height,st=it>=0?1:-1,at=st*j,ot=st>0?"end":"start",lt=st>0?"start":"end",ct=nt>=0?1:-1,ft=ct*j,ut=ct>0?"end":"start",ht=ct>0?"start":"end";if(_e==="top"){var dt={x:tt+nt/2,y:rt-st*j,textAnchor:"middle",verticalAnchor:ot};return _objectSpread$q(_objectSpread$q({},dt),$?{height:Math.max(rt-$.y,0),width:nt}:{})}if(_e==="bottom"){var mt={x:tt+nt/2,y:rt+it+at,textAnchor:"middle",verticalAnchor:lt};return _objectSpread$q(_objectSpread$q({},mt),$?{height:Math.max($.y+$.height-(rt+it),0),width:nt}:{})}if(_e==="left"){var pt={x:tt-ft,y:rt+it/2,textAnchor:ut,verticalAnchor:"middle"};return _objectSpread$q(_objectSpread$q({},pt),$?{width:Math.max(pt.x-$.x,0),height:it}:{})}if(_e==="right"){var yt={x:tt+nt+ft,y:rt+it/2,textAnchor:ht,verticalAnchor:"middle"};return _objectSpread$q(_objectSpread$q({},yt),$?{width:Math.max($.x+$.width-yt.x,0),height:it}:{})}var gt=$?{width:nt,height:it}:{};return _e==="insideLeft"?_objectSpread$q({x:tt+ft,y:rt+it/2,textAnchor:ht,verticalAnchor:"middle"},gt):_e==="insideRight"?_objectSpread$q({x:tt+nt-ft,y:rt+it/2,textAnchor:ut,verticalAnchor:"middle"},gt):_e==="insideTop"?_objectSpread$q({x:tt+nt/2,y:rt+at,textAnchor:"middle",verticalAnchor:lt},gt):_e==="insideBottom"?_objectSpread$q({x:tt+nt/2,y:rt+it-at,textAnchor:"middle",verticalAnchor:ot},gt):_e==="insideTopLeft"?_objectSpread$q({x:tt+ft,y:rt+at,textAnchor:ht,verticalAnchor:lt},gt):_e==="insideTopRight"?_objectSpread$q({x:tt+nt-ft,y:rt+at,textAnchor:ut,verticalAnchor:lt},gt):_e==="insideBottomLeft"?_objectSpread$q({x:tt+ft,y:rt+it-at,textAnchor:ht,verticalAnchor:ot},gt):_e==="insideBottomRight"?_objectSpread$q({x:tt+nt-ft,y:rt+it-at,textAnchor:ut,verticalAnchor:ot},gt):isObject$8(_e)&&(isNumber(_e.x)||isPercent(_e.x))&&(isNumber(_e.y)||isPercent(_e.y))?_objectSpread$q({x:tt+getPercentValue(_e.x,nt),y:rt+getPercentValue(_e.y,it),textAnchor:"end",verticalAnchor:"end"},gt):_objectSpread$q({x:tt+nt/2,y:rt+it/2,textAnchor:"middle",verticalAnchor:"middle"},gt)},isPolar=function o(i){return"cx"in i&&isNumber(i.cx)};function Label(o){var i=o.offset,_=i===void 0?5:i,$=_objectWithoutProperties$b(o,_excluded$b),j=_objectSpread$q({offset:_},$),_e=j.viewBox,et=j.position,tt=j.value,rt=j.children,nt=j.content,it=j.className,st=it===void 0?"":it,at=j.textBreakAll;if(!_e||isNil$1(tt)&&isNil$1(rt)&&!reactExports.isValidElement(nt)&&!isFunction$3(nt))return null;if(reactExports.isValidElement(nt))return reactExports.cloneElement(nt,j);var ot;if(isFunction$3(nt)){if(ot=reactExports.createElement(nt,j),reactExports.isValidElement(ot))return ot}else ot=getLabel(j);var lt=isPolar(_e),ct=filterProps(j,!0);if(lt&&(et==="insideStart"||et==="insideEnd"||et==="end"))return renderRadialLabel(j,ot,ct);var ft=lt?getAttrsOfPolarLabel(j):getAttrsOfCartesianLabel(j);return React$2.createElement(Text,_extends$n({className:clsx("recharts-label",st)},ct,ft,{breakAll:at}),ot)}Label.displayName="Label";var parseViewBox=function o(i){var _=i.cx,$=i.cy,j=i.angle,_e=i.startAngle,et=i.endAngle,tt=i.r,rt=i.radius,nt=i.innerRadius,it=i.outerRadius,st=i.x,at=i.y,ot=i.top,lt=i.left,ct=i.width,ft=i.height,ut=i.clockWise,ht=i.labelViewBox;if(ht)return ht;if(isNumber(ct)&&isNumber(ft)){if(isNumber(st)&&isNumber(at))return{x:st,y:at,width:ct,height:ft};if(isNumber(ot)&&isNumber(lt))return{x:ot,y:lt,width:ct,height:ft}}return isNumber(st)&&isNumber(at)?{x:st,y:at,width:0,height:0}:isNumber(_)&&isNumber($)?{cx:_,cy:$,startAngle:_e||j||0,endAngle:et||j||0,innerRadius:nt||0,outerRadius:it||rt||tt||0,clockWise:ut}:i.viewBox?i.viewBox:{}},parseLabel=function o(i,_){return i?i===!0?React$2.createElement(Label,{key:"label-implicit",viewBox:_}):isNumOrStr(i)?React$2.createElement(Label,{key:"label-implicit",viewBox:_,value:i}):reactExports.isValidElement(i)?i.type===Label?reactExports.cloneElement(i,{key:"label-implicit",viewBox:_}):React$2.createElement(Label,{key:"label-implicit",content:i,viewBox:_}):isFunction$3(i)?React$2.createElement(Label,{key:"label-implicit",content:i,viewBox:_}):isObject$8(i)?React$2.createElement(Label,_extends$n({viewBox:_},i,{key:"label-implicit"})):null:null},renderCallByParent$1=function o(i,_){var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!i||!i.children&&$&&!i.label)return null;var j=i.children,_e=parseViewBox(i),et=findAllByType(j,Label).map(function(rt,nt){return reactExports.cloneElement(rt,{viewBox:_||_e,key:"label-".concat(nt)})});if(!$)return et;var tt=parseLabel(i.label,_||_e);return[tt].concat(_toConsumableArray$8(et))};Label.parseViewBox=parseViewBox;Label.renderCallByParent=renderCallByParent$1;function last(o){var i=o==null?0:o.length;return i?o[i-1]:void 0}var last_1=last;const last$1=getDefaultExportFromCjs$1(last_1);function _typeof$t(o){"@babel/helpers - typeof";return _typeof$t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$t(o)}var _excluded$a=["valueAccessor"],_excluded2$4=["data","dataKey","clockWise","id","textBreakAll"];function _toConsumableArray$7(o){return _arrayWithoutHoles$7(o)||_iterableToArray$8(o)||_unsupportedIterableToArray$b(o)||_nonIterableSpread$7()}function _nonIterableSpread$7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$b(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$b(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$b(o,i)}}function _iterableToArray$8(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$7(o){if(Array.isArray(o))return _arrayLikeToArray$b(o)}function _arrayLikeToArray$b(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _extends$m(){return _extends$m=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$m.apply(this,arguments)}function ownKeys$q(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$p(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$q(Object(_),!0).forEach(function($){_defineProperty$t(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$q(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$t(o,i,_){return i=_toPropertyKey$t(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$t(o){var i=_toPrimitive$t(o,"string");return _typeof$t(i)=="symbol"?i:i+""}function _toPrimitive$t(o,i){if(_typeof$t(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$t($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _objectWithoutProperties$a(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$a(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$a(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}var defaultAccessor=function o(i){return Array.isArray(i.value)?last$1(i.value):i.value};function LabelList(o){var i=o.valueAccessor,_=i===void 0?defaultAccessor:i,$=_objectWithoutProperties$a(o,_excluded$a),j=$.data,_e=$.dataKey,et=$.clockWise,tt=$.id,rt=$.textBreakAll,nt=_objectWithoutProperties$a($,_excluded2$4);return!j||!j.length?null:React$2.createElement(Layer,{className:"recharts-label-list"},j.map(function(it,st){var at=isNil$1(_e)?_(it,st):getValueByDataKey(it&&it.payload,_e),ot=isNil$1(tt)?{}:{id:"".concat(tt,"-").concat(st)};return React$2.createElement(Label,_extends$m({},filterProps(it,!0),nt,ot,{parentViewBox:it.parentViewBox,value:at,textBreakAll:rt,viewBox:Label.parseViewBox(isNil$1(et)?it:_objectSpread$p(_objectSpread$p({},it),{},{clockWise:et})),key:"label-".concat(st),index:st}))}))}LabelList.displayName="LabelList";function parseLabelList(o,i){return o?o===!0?React$2.createElement(LabelList,{key:"labelList-implicit",data:i}):React$2.isValidElement(o)||isFunction$3(o)?React$2.createElement(LabelList,{key:"labelList-implicit",data:i,content:o}):isObject$8(o)?React$2.createElement(LabelList,_extends$m({data:i},o,{key:"labelList-implicit"})):null:null}function renderCallByParent(o,i){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!o||!o.children&&_&&!o.label)return null;var $=o.children,j=findAllByType($,LabelList).map(function(et,tt){return reactExports.cloneElement(et,{data:i,key:"labelList-".concat(tt)})});if(!_)return j;var _e=parseLabelList(o.label,i);return[_e].concat(_toConsumableArray$7(j))}LabelList.renderCallByParent=renderCallByParent;function _typeof$s(o){"@babel/helpers - typeof";return _typeof$s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$s(o)}function _extends$l(){return _extends$l=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$l.apply(this,arguments)}function ownKeys$p(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$o(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$p(Object(_),!0).forEach(function($){_defineProperty$s(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$p(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$s(o,i,_){return i=_toPropertyKey$s(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$s(o){var i=_toPrimitive$s(o,"string");return _typeof$s(i)=="symbol"?i:i+""}function _toPrimitive$s(o,i){if(_typeof$s(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$s($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var getDeltaAngle=function o(i,_){var $=mathSign(_-i),j=Math.min(Math.abs(_-i),359.999);return $*j},getTangentCircle=function o(i){var _=i.cx,$=i.cy,j=i.radius,_e=i.angle,et=i.sign,tt=i.isExternal,rt=i.cornerRadius,nt=i.cornerIsExternal,it=rt*(tt?1:-1)+j,st=Math.asin(rt/it)/RADIAN$1,at=nt?_e:_e+et*st,ot=polarToCartesian(_,$,it,at),lt=polarToCartesian(_,$,j,at),ct=nt?_e-et*st:_e,ft=polarToCartesian(_,$,it*Math.cos(st*RADIAN$1),ct);return{center:ot,circleTangency:lt,lineTangency:ft,theta:st}},getSectorPath=function o(i){var _=i.cx,$=i.cy,j=i.innerRadius,_e=i.outerRadius,et=i.startAngle,tt=i.endAngle,rt=getDeltaAngle(et,tt),nt=et+rt,it=polarToCartesian(_,$,_e,et),st=polarToCartesian(_,$,_e,nt),at="M ".concat(it.x,",").concat(it.y,`
    A `).concat(_e,",").concat(_e,`,0,
    `).concat(+(Math.abs(rt)>180),",").concat(+(et>nt),`,
    `).concat(st.x,",").concat(st.y,`
  `);if(j>0){var ot=polarToCartesian(_,$,j,et),lt=polarToCartesian(_,$,j,nt);at+="L ".concat(lt.x,",").concat(lt.y,`
            A `).concat(j,",").concat(j,`,0,
            `).concat(+(Math.abs(rt)>180),",").concat(+(et<=nt),`,
            `).concat(ot.x,",").concat(ot.y," Z")}else at+="L ".concat(_,",").concat($," Z");return at},getSectorWithCorner=function o(i){var _=i.cx,$=i.cy,j=i.innerRadius,_e=i.outerRadius,et=i.cornerRadius,tt=i.forceCornerRadius,rt=i.cornerIsExternal,nt=i.startAngle,it=i.endAngle,st=mathSign(it-nt),at=getTangentCircle({cx:_,cy:$,radius:_e,angle:nt,sign:st,cornerRadius:et,cornerIsExternal:rt}),ot=at.circleTangency,lt=at.lineTangency,ct=at.theta,ft=getTangentCircle({cx:_,cy:$,radius:_e,angle:it,sign:-st,cornerRadius:et,cornerIsExternal:rt}),ut=ft.circleTangency,ht=ft.lineTangency,dt=ft.theta,mt=rt?Math.abs(nt-it):Math.abs(nt-it)-ct-dt;if(mt<0)return tt?"M ".concat(lt.x,",").concat(lt.y,`
        a`).concat(et,",").concat(et,",0,0,1,").concat(et*2,`,0
        a`).concat(et,",").concat(et,",0,0,1,").concat(-et*2,`,0
      `):getSectorPath({cx:_,cy:$,innerRadius:j,outerRadius:_e,startAngle:nt,endAngle:it});var pt="M ".concat(lt.x,",").concat(lt.y,`
    A`).concat(et,",").concat(et,",0,0,").concat(+(st<0),",").concat(ot.x,",").concat(ot.y,`
    A`).concat(_e,",").concat(_e,",0,").concat(+(mt>180),",").concat(+(st<0),",").concat(ut.x,",").concat(ut.y,`
    A`).concat(et,",").concat(et,",0,0,").concat(+(st<0),",").concat(ht.x,",").concat(ht.y,`
  `);if(j>0){var yt=getTangentCircle({cx:_,cy:$,radius:j,angle:nt,sign:st,isExternal:!0,cornerRadius:et,cornerIsExternal:rt}),gt=yt.circleTangency,vt=yt.lineTangency,St=yt.theta,At=getTangentCircle({cx:_,cy:$,radius:j,angle:it,sign:-st,isExternal:!0,cornerRadius:et,cornerIsExternal:rt}),xt=At.circleTangency,wt=At.lineTangency,Ot=At.theta,Bt=rt?Math.abs(nt-it):Math.abs(nt-it)-St-Ot;if(Bt<0&&et===0)return"".concat(pt,"L").concat(_,",").concat($,"Z");pt+="L".concat(wt.x,",").concat(wt.y,`
      A`).concat(et,",").concat(et,",0,0,").concat(+(st<0),",").concat(xt.x,",").concat(xt.y,`
      A`).concat(j,",").concat(j,",0,").concat(+(Bt>180),",").concat(+(st>0),",").concat(gt.x,",").concat(gt.y,`
      A`).concat(et,",").concat(et,",0,0,").concat(+(st<0),",").concat(vt.x,",").concat(vt.y,"Z")}else pt+="L".concat(_,",").concat($,"Z");return pt},defaultProps$2={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Sector=function o(i){var _=_objectSpread$o(_objectSpread$o({},defaultProps$2),i),$=_.cx,j=_.cy,_e=_.innerRadius,et=_.outerRadius,tt=_.cornerRadius,rt=_.forceCornerRadius,nt=_.cornerIsExternal,it=_.startAngle,st=_.endAngle,at=_.className;if(et<_e||it===st)return null;var ot=clsx("recharts-sector",at),lt=et-_e,ct=getPercentValue(tt,lt,0,!0),ft;return ct>0&&Math.abs(it-st)<360?ft=getSectorWithCorner({cx:$,cy:j,innerRadius:_e,outerRadius:et,cornerRadius:Math.min(ct,lt/2),forceCornerRadius:rt,cornerIsExternal:nt,startAngle:it,endAngle:st}):ft=getSectorPath({cx:$,cy:j,innerRadius:_e,outerRadius:et,startAngle:it,endAngle:st}),React$2.createElement("path",_extends$l({},filterProps(_,!0),{className:ot,d:ft,role:"img"}))};function _typeof$r(o){"@babel/helpers - typeof";return _typeof$r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$r(o)}function _extends$k(){return _extends$k=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$k.apply(this,arguments)}function ownKeys$o(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$n(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$o(Object(_),!0).forEach(function($){_defineProperty$r(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$o(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$r(o,i,_){return i=_toPropertyKey$r(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$r(o){var i=_toPrimitive$r(o,"string");return _typeof$r(i)=="symbol"?i:i+""}function _toPrimitive$r(o,i){if(_typeof$r(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$r($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var CURVE_FACTORIES={curveBasisClosed,curveBasisOpen,curveBasis,curveBumpX:bumpX,curveBumpY:bumpY,curveLinearClosed,curveLinear,curveMonotoneX:monotoneX,curveMonotoneY:monotoneY,curveNatural,curveStep,curveStepAfter:stepAfter,curveStepBefore:stepBefore},defined=function o(i){return i.x===+i.x&&i.y===+i.y},getX=function o(i){return i.x},getY=function o(i){return i.y},getCurveFactory=function o(i,_){if(isFunction$3(i))return i;var $="curve".concat(upperFirst$1(i));return($==="curveMonotone"||$==="curveBump")&&_?CURVE_FACTORIES["".concat($).concat(_==="vertical"?"Y":"X")]:CURVE_FACTORIES[$]||curveLinear},getPath$2=function o(i){var _=i.type,$=_===void 0?"linear":_,j=i.points,_e=j===void 0?[]:j,et=i.baseLine,tt=i.layout,rt=i.connectNulls,nt=rt===void 0?!1:rt,it=getCurveFactory($,tt),st=nt?_e.filter(function(ct){return defined(ct)}):_e,at;if(Array.isArray(et)){var ot=nt?et.filter(function(ct){return defined(ct)}):et,lt=st.map(function(ct,ft){return _objectSpread$n(_objectSpread$n({},ct),{},{base:ot[ft]})});return tt==="vertical"?at=shapeArea().y(getY).x1(getX).x0(function(ct){return ct.base.x}):at=shapeArea().x(getX).y1(getY).y0(function(ct){return ct.base.y}),at.defined(defined).curve(it),at(lt)}return tt==="vertical"&&isNumber(et)?at=shapeArea().y(getY).x1(getX).x0(et):isNumber(et)?at=shapeArea().x(getX).y1(getY).y0(et):at=shapeLine().x(getX).y(getY),at.defined(defined).curve(it),at(st)},Curve=function o(i){var _=i.className,$=i.points,j=i.path,_e=i.pathRef;if((!$||!$.length)&&!j)return null;var et=$&&$.length?getPath$2(i):j;return React$2.createElement("path",_extends$k({},filterProps(i,!1),adaptEventHandlers(i),{className:clsx("recharts-curve",_),d:et,ref:_e}))},propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function o($,j,_e,et,tt,rt){if(rt!==ReactPropTypesSecret){var nt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw nt.name="Invariant Violation",nt}}o.isRequired=o;function i(){return o}var _={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:i,element:o,elementType:o,instanceOf:i,node:o,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return _.PropTypes=_,_};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs$1(propTypesExports);var getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty$1=Object.prototype.hasOwnProperty;function combineComparators(o,i){return function($,j,_e){return o($,j,_e)&&i($,j,_e)}}function createIsCircular(o){return function(_,$,j){if(!_||!$||typeof _!="object"||typeof $!="object")return o(_,$,j);var _e=j.cache,et=_e.get(_),tt=_e.get($);if(et&&tt)return et===$&&tt===_;_e.set(_,$),_e.set($,_);var rt=o(_,$,j);return _e.delete(_),_e.delete($),rt}}function getStrictProperties(o){return getOwnPropertyNames(o).concat(getOwnPropertySymbols(o))}var hasOwn=Object.hasOwn||function(o,i){return hasOwnProperty$1.call(o,i)};function sameValueZeroEqual(o,i){return o===i||!o&&!i&&o!==o&&i!==i}var PREACT_VNODE="__v",PREACT_OWNER="__o",REACT_OWNER="_owner",getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,keys=Object.keys;function areArraysEqual(o,i,_){var $=o.length;if(i.length!==$)return!1;for(;$-- >0;)if(!_.equals(o[$],i[$],$,$,o,i,_))return!1;return!0}function areDatesEqual(o,i){return sameValueZeroEqual(o.getTime(),i.getTime())}function areErrorsEqual(o,i){return o.name===i.name&&o.message===i.message&&o.cause===i.cause&&o.stack===i.stack}function areFunctionsEqual(o,i){return o===i}function areMapsEqual(o,i,_){var $=o.size;if($!==i.size)return!1;if(!$)return!0;for(var j=new Array($),_e=o.entries(),et,tt,rt=0;(et=_e.next())&&!et.done;){for(var nt=i.entries(),it=!1,st=0;(tt=nt.next())&&!tt.done;){if(j[st]){st++;continue}var at=et.value,ot=tt.value;if(_.equals(at[0],ot[0],rt,st,o,i,_)&&_.equals(at[1],ot[1],at[0],ot[0],o,i,_)){it=j[st]=!0;break}st++}if(!it)return!1;rt++}return!0}var areNumbersEqual=sameValueZeroEqual;function areObjectsEqual(o,i,_){var $=keys(o),j=$.length;if(keys(i).length!==j)return!1;for(;j-- >0;)if(!isPropertyEqual(o,i,_,$[j]))return!1;return!0}function areObjectsEqualStrict(o,i,_){var $=getStrictProperties(o),j=$.length;if(getStrictProperties(i).length!==j)return!1;for(var _e,et,tt;j-- >0;)if(_e=$[j],!isPropertyEqual(o,i,_,_e)||(et=getOwnPropertyDescriptor(o,_e),tt=getOwnPropertyDescriptor(i,_e),(et||tt)&&(!et||!tt||et.configurable!==tt.configurable||et.enumerable!==tt.enumerable||et.writable!==tt.writable)))return!1;return!0}function arePrimitiveWrappersEqual(o,i){return sameValueZeroEqual(o.valueOf(),i.valueOf())}function areRegExpsEqual(o,i){return o.source===i.source&&o.flags===i.flags}function areSetsEqual(o,i,_){var $=o.size;if($!==i.size)return!1;if(!$)return!0;for(var j=new Array($),_e=o.values(),et,tt;(et=_e.next())&&!et.done;){for(var rt=i.values(),nt=!1,it=0;(tt=rt.next())&&!tt.done;){if(!j[it]&&_.equals(et.value,tt.value,et.value,tt.value,o,i,_)){nt=j[it]=!0;break}it++}if(!nt)return!1}return!0}function areTypedArraysEqual(o,i){var _=o.length;if(i.length!==_)return!1;for(;_-- >0;)if(o[_]!==i[_])return!1;return!0}function areUrlsEqual(o,i){return o.hostname===i.hostname&&o.pathname===i.pathname&&o.protocol===i.protocol&&o.port===i.port&&o.hash===i.hash&&o.username===i.username&&o.password===i.password}function isPropertyEqual(o,i,_,$){return($===REACT_OWNER||$===PREACT_OWNER||$===PREACT_VNODE)&&(o.$$typeof||i.$$typeof)?!0:hasOwn(i,$)&&_.equals(o[$],i[$],$,$,o,i,_)}var ARGUMENTS_TAG="[object Arguments]",BOOLEAN_TAG="[object Boolean]",DATE_TAG="[object Date]",ERROR_TAG="[object Error]",MAP_TAG="[object Map]",NUMBER_TAG="[object Number]",OBJECT_TAG="[object Object]",REG_EXP_TAG="[object RegExp]",SET_TAG="[object Set]",STRING_TAG="[object String]",URL_TAG="[object URL]",isArray$2=Array.isArray,isTypedArray$1=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,assign=Object.assign,getTag=Object.prototype.toString.call.bind(Object.prototype.toString);function createEqualityComparator(o){var i=o.areArraysEqual,_=o.areDatesEqual,$=o.areErrorsEqual,j=o.areFunctionsEqual,_e=o.areMapsEqual,et=o.areNumbersEqual,tt=o.areObjectsEqual,rt=o.arePrimitiveWrappersEqual,nt=o.areRegExpsEqual,it=o.areSetsEqual,st=o.areTypedArraysEqual,at=o.areUrlsEqual;return function(lt,ct,ft){if(lt===ct)return!0;if(lt==null||ct==null)return!1;var ut=typeof lt;if(ut!==typeof ct)return!1;if(ut!=="object")return ut==="number"?et(lt,ct,ft):ut==="function"?j(lt,ct,ft):!1;var ht=lt.constructor;if(ht!==ct.constructor)return!1;if(ht===Object)return tt(lt,ct,ft);if(isArray$2(lt))return i(lt,ct,ft);if(isTypedArray$1!=null&&isTypedArray$1(lt))return st(lt,ct,ft);if(ht===Date)return _(lt,ct,ft);if(ht===RegExp)return nt(lt,ct,ft);if(ht===Map)return _e(lt,ct,ft);if(ht===Set)return it(lt,ct,ft);var dt=getTag(lt);return dt===DATE_TAG?_(lt,ct,ft):dt===REG_EXP_TAG?nt(lt,ct,ft):dt===MAP_TAG?_e(lt,ct,ft):dt===SET_TAG?it(lt,ct,ft):dt===OBJECT_TAG?typeof lt.then!="function"&&typeof ct.then!="function"&&tt(lt,ct,ft):dt===URL_TAG?at(lt,ct,ft):dt===ERROR_TAG?$(lt,ct,ft):dt===ARGUMENTS_TAG?tt(lt,ct,ft):dt===BOOLEAN_TAG||dt===NUMBER_TAG||dt===STRING_TAG?rt(lt,ct,ft):!1}}function createEqualityComparatorConfig(o){var i=o.circular,_=o.createCustomConfig,$=o.strict,j={areArraysEqual:$?areObjectsEqualStrict:areArraysEqual,areDatesEqual,areErrorsEqual,areFunctionsEqual,areMapsEqual:$?combineComparators(areMapsEqual,areObjectsEqualStrict):areMapsEqual,areNumbersEqual,areObjectsEqual:$?areObjectsEqualStrict:areObjectsEqual,arePrimitiveWrappersEqual,areRegExpsEqual,areSetsEqual:$?combineComparators(areSetsEqual,areObjectsEqualStrict):areSetsEqual,areTypedArraysEqual:$?areObjectsEqualStrict:areTypedArraysEqual,areUrlsEqual};if(_&&(j=assign({},j,_(j))),i){var _e=createIsCircular(j.areArraysEqual),et=createIsCircular(j.areMapsEqual),tt=createIsCircular(j.areObjectsEqual),rt=createIsCircular(j.areSetsEqual);j=assign({},j,{areArraysEqual:_e,areMapsEqual:et,areObjectsEqual:tt,areSetsEqual:rt})}return j}function createInternalEqualityComparator(o){return function(i,_,$,j,_e,et,tt){return o(i,_,tt)}}function createIsEqual(o){var i=o.circular,_=o.comparator,$=o.createState,j=o.equals,_e=o.strict;if($)return function(rt,nt){var it=$(),st=it.cache,at=st===void 0?i?new WeakMap:void 0:st,ot=it.meta;return _(rt,nt,{cache:at,equals:j,meta:ot,strict:_e})};if(i)return function(rt,nt){return _(rt,nt,{cache:new WeakMap,equals:j,meta:void 0,strict:_e})};var et={cache:void 0,equals:j,meta:void 0,strict:_e};return function(rt,nt){return _(rt,nt,et)}}var deepEqual=createCustomEqual();createCustomEqual({strict:!0});createCustomEqual({circular:!0});createCustomEqual({circular:!0,strict:!0});createCustomEqual({createInternalComparator:function(){return sameValueZeroEqual}});createCustomEqual({strict:!0,createInternalComparator:function(){return sameValueZeroEqual}});createCustomEqual({circular:!0,createInternalComparator:function(){return sameValueZeroEqual}});createCustomEqual({circular:!0,createInternalComparator:function(){return sameValueZeroEqual},strict:!0});function createCustomEqual(o){o===void 0&&(o={});var i=o.circular,_=i===void 0?!1:i,$=o.createInternalComparator,j=o.createState,_e=o.strict,et=_e===void 0?!1:_e,tt=createEqualityComparatorConfig(o),rt=createEqualityComparator(tt),nt=$?$(rt):createInternalEqualityComparator(rt);return createIsEqual({circular:_,comparator:rt,createState:j,equals:nt,strict:et})}function safeRequestAnimationFrame(o){typeof requestAnimationFrame<"u"&&requestAnimationFrame(o)}function setRafTimeout(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=-1,$=function j(_e){_<0&&(_=_e),_e-_>i?(o(_e),_=-1):safeRequestAnimationFrame(j)};requestAnimationFrame($)}function _typeof$q(o){"@babel/helpers - typeof";return _typeof$q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$q(o)}function _toArray(o){return _arrayWithHoles$6(o)||_iterableToArray$7(o)||_unsupportedIterableToArray$a(o)||_nonIterableRest$6()}function _nonIterableRest$6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$a(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$a(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$a(o,i)}}function _arrayLikeToArray$a(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArray$7(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithHoles$6(o){if(Array.isArray(o))return o}function createAnimateManager(){var o={},i=function(){return null},_=!1,$=function j(_e){if(!_){if(Array.isArray(_e)){if(!_e.length)return;var et=_e,tt=_toArray(et),rt=tt[0],nt=tt.slice(1);if(typeof rt=="number"){setRafTimeout(j.bind(null,nt),rt);return}j(rt),setRafTimeout(j.bind(null,nt));return}_typeof$q(_e)==="object"&&(o=_e,i(o)),typeof _e=="function"&&_e()}};return{stop:function(){_=!0},start:function(_e){_=!1,$(_e)},subscribe:function(_e){return i=_e,function(){i=function(){return null}}}}}function _typeof$p(o){"@babel/helpers - typeof";return _typeof$p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$p(o)}function ownKeys$n(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$m(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$n(Object(_),!0).forEach(function($){_defineProperty$q(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$n(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$q(o,i,_){return i=_toPropertyKey$q(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$q(o){var i=_toPrimitive$q(o,"string");return _typeof$p(i)==="symbol"?i:String(i)}function _toPrimitive$q(o,i){if(_typeof$p(o)!=="object"||o===null)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$p($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var getIntersectionKeys=function o(i,_){return[Object.keys(i),Object.keys(_)].reduce(function($,j){return $.filter(function(_e){return j.includes(_e)})})},identity=function o(i){return i},getDashCase=function o(i){return i.replace(/([A-Z])/g,function(_){return"-".concat(_.toLowerCase())})},mapObject=function o(i,_){return Object.keys(_).reduce(function($,j){return _objectSpread$m(_objectSpread$m({},$),{},_defineProperty$q({},j,i(j,_[j])))},{})},getTransitionVal=function o(i,_,$){return i.map(function(j){return"".concat(getDashCase(j)," ").concat(_,"ms ").concat($)}).join(",")};function _slicedToArray$5(o,i){return _arrayWithHoles$5(o)||_iterableToArrayLimit$5(o,i)||_unsupportedIterableToArray$9(o,i)||_nonIterableRest$5()}function _nonIterableRest$5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$5(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$5(o){if(Array.isArray(o))return o}function _toConsumableArray$6(o){return _arrayWithoutHoles$6(o)||_iterableToArray$6(o)||_unsupportedIterableToArray$9(o)||_nonIterableSpread$6()}function _nonIterableSpread$6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$9(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$9(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$9(o,i)}}function _iterableToArray$6(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$6(o){if(Array.isArray(o))return _arrayLikeToArray$9(o)}function _arrayLikeToArray$9(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}var ACCURACY=1e-4,cubicBezierFactor=function o(i,_){return[0,3*i,3*_-6*i,3*i-3*_+1]},multyTime=function o(i,_){return i.map(function($,j){return $*Math.pow(_,j)}).reduce(function($,j){return $+j})},cubicBezier=function o(i,_){return function($){var j=cubicBezierFactor(i,_);return multyTime(j,$)}},derivativeCubicBezier=function o(i,_){return function($){var j=cubicBezierFactor(i,_),_e=[].concat(_toConsumableArray$6(j.map(function(et,tt){return et*tt}).slice(1)),[0]);return multyTime(_e,$)}},configBezier=function o(){for(var i=arguments.length,_=new Array(i),$=0;$<i;$++)_[$]=arguments[$];var j=_[0],_e=_[1],et=_[2],tt=_[3];if(_.length===1)switch(_[0]){case"linear":j=0,_e=0,et=1,tt=1;break;case"ease":j=.25,_e=.1,et=.25,tt=1;break;case"ease-in":j=.42,_e=0,et=1,tt=1;break;case"ease-out":j=.42,_e=0,et=.58,tt=1;break;case"ease-in-out":j=0,_e=0,et=.58,tt=1;break;default:{var rt=_[0].split("(");if(rt[0]==="cubic-bezier"&&rt[1].split(")")[0].split(",").length===4){var nt=rt[1].split(")")[0].split(",").map(function(ft){return parseFloat(ft)}),it=_slicedToArray$5(nt,4);j=it[0],_e=it[1],et=it[2],tt=it[3]}}}var st=cubicBezier(j,et),at=cubicBezier(_e,tt),ot=derivativeCubicBezier(j,et),lt=function(ut){return ut>1?1:ut<0?0:ut},ct=function(ut){for(var ht=ut>1?1:ut,dt=ht,mt=0;mt<8;++mt){var pt=st(dt)-ht,yt=ot(dt);if(Math.abs(pt-ht)<ACCURACY||yt<ACCURACY)return at(dt);dt=lt(dt-pt/yt)}return at(dt)};return ct.isStepper=!1,ct},configSpring=function o(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=i.stiff,$=_===void 0?100:_,j=i.damping,_e=j===void 0?8:j,et=i.dt,tt=et===void 0?17:et,rt=function(it,st,at){var ot=-(it-st)*$,lt=at*_e,ct=at+(ot-lt)*tt/1e3,ft=at*tt/1e3+it;return Math.abs(ft-st)<ACCURACY&&Math.abs(ct)<ACCURACY?[st,0]:[ft,ct]};return rt.isStepper=!0,rt.dt=tt,rt},configEasing=function o(){for(var i=arguments.length,_=new Array(i),$=0;$<i;$++)_[$]=arguments[$];var j=_[0];if(typeof j=="string")switch(j){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return configBezier(j);case"spring":return configSpring();default:if(j.split("(")[0]==="cubic-bezier")return configBezier(j)}return typeof j=="function"?j:null};function _typeof$o(o){"@babel/helpers - typeof";return _typeof$o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$o(o)}function _toConsumableArray$5(o){return _arrayWithoutHoles$5(o)||_iterableToArray$5(o)||_unsupportedIterableToArray$8(o)||_nonIterableSpread$5()}function _nonIterableSpread$5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$5(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$5(o){if(Array.isArray(o))return _arrayLikeToArray$8(o)}function ownKeys$m(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$l(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$m(Object(_),!0).forEach(function($){_defineProperty$p(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$m(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$p(o,i,_){return i=_toPropertyKey$p(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$p(o){var i=_toPrimitive$p(o,"string");return _typeof$o(i)==="symbol"?i:String(i)}function _toPrimitive$p(o,i){if(_typeof$o(o)!=="object"||o===null)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$o($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _slicedToArray$4(o,i){return _arrayWithHoles$4(o)||_iterableToArrayLimit$4(o,i)||_unsupportedIterableToArray$8(o,i)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$8(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$8(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$8(o,i)}}function _arrayLikeToArray$8(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$4(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$4(o){if(Array.isArray(o))return o}var alpha=function o(i,_,$){return i+(_-i)*$},needContinue=function o(i){var _=i.from,$=i.to;return _!==$},calStepperVals=function o(i,_,$){var j=mapObject(function(_e,et){if(needContinue(et)){var tt=i(et.from,et.to,et.velocity),rt=_slicedToArray$4(tt,2),nt=rt[0],it=rt[1];return _objectSpread$l(_objectSpread$l({},et),{},{from:nt,velocity:it})}return et},_);return $<1?mapObject(function(_e,et){return needContinue(et)?_objectSpread$l(_objectSpread$l({},et),{},{velocity:alpha(et.velocity,j[_e].velocity,$),from:alpha(et.from,j[_e].from,$)}):et},_):o(i,j,$-1)};const configUpdate=function(o,i,_,$,j){var _e=getIntersectionKeys(o,i),et=_e.reduce(function(ft,ut){return _objectSpread$l(_objectSpread$l({},ft),{},_defineProperty$p({},ut,[o[ut],i[ut]]))},{}),tt=_e.reduce(function(ft,ut){return _objectSpread$l(_objectSpread$l({},ft),{},_defineProperty$p({},ut,{from:o[ut],velocity:0,to:i[ut]}))},{}),rt=-1,nt,it,st=function(){return null},at=function(){return mapObject(function(ut,ht){return ht.from},tt)},ot=function(){return!Object.values(tt).filter(needContinue).length},lt=function(ut){nt||(nt=ut);var ht=ut-nt,dt=ht/_.dt;tt=calStepperVals(_,tt,dt),j(_objectSpread$l(_objectSpread$l(_objectSpread$l({},o),i),at())),nt=ut,ot()||(rt=requestAnimationFrame(st))},ct=function(ut){it||(it=ut);var ht=(ut-it)/$,dt=mapObject(function(pt,yt){return alpha.apply(void 0,_toConsumableArray$5(yt).concat([_(ht)]))},et);if(j(_objectSpread$l(_objectSpread$l(_objectSpread$l({},o),i),dt)),ht<1)rt=requestAnimationFrame(st);else{var mt=mapObject(function(pt,yt){return alpha.apply(void 0,_toConsumableArray$5(yt).concat([_(1)]))},et);j(_objectSpread$l(_objectSpread$l(_objectSpread$l({},o),i),mt))}};return st=_.isStepper?lt:ct,function(){return requestAnimationFrame(st),function(){cancelAnimationFrame(rt)}}};function _typeof$n(o){"@babel/helpers - typeof";return _typeof$n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$n(o)}var _excluded$9=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function _objectWithoutProperties$9(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$9(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$9(o,i){if(o==null)return{};var _={},$=Object.keys(o),j,_e;for(_e=0;_e<$.length;_e++)j=$[_e],!(i.indexOf(j)>=0)&&(_[j]=o[j]);return _}function _toConsumableArray$4(o){return _arrayWithoutHoles$4(o)||_iterableToArray$4(o)||_unsupportedIterableToArray$7(o)||_nonIterableSpread$4()}function _nonIterableSpread$4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$7(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$7(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$7(o,i)}}function _iterableToArray$4(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$4(o){if(Array.isArray(o))return _arrayLikeToArray$7(o)}function _arrayLikeToArray$7(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function ownKeys$l(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$k(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$l(Object(_),!0).forEach(function($){_defineProperty$o(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$l(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$o(o,i,_){return i=_toPropertyKey$o(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _classCallCheck$f(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$f(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$o($.key),$)}}function _createClass$f(o,i,_){return i&&_defineProperties$f(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _toPropertyKey$o(o){var i=_toPrimitive$o(o,"string");return _typeof$n(i)==="symbol"?i:String(i)}function _toPrimitive$o(o,i){if(_typeof$n(o)!=="object"||o===null)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$n($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _inherits$d(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$d(o,i)}function _setPrototypeOf$d(o,i){return _setPrototypeOf$d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$d(o,i)}function _createSuper(o){var i=_isNativeReflectConstruct$d();return function(){var $=_getPrototypeOf$d(o),j;if(i){var _e=_getPrototypeOf$d(this).constructor;j=Reflect.construct($,arguments,_e)}else j=$.apply(this,arguments);return _possibleConstructorReturn$d(this,j)}}function _possibleConstructorReturn$d(o,i){if(i&&(_typeof$n(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$d(o)}function _assertThisInitialized$d(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _getPrototypeOf$d(o){return _getPrototypeOf$d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$d(o)}var Animate=function(o){_inherits$d(_,o);var i=_createSuper(_);function _($,j){var _e;_classCallCheck$f(this,_),_e=i.call(this,$,j);var et=_e.props,tt=et.isActive,rt=et.attributeName,nt=et.from,it=et.to,st=et.steps,at=et.children,ot=et.duration;if(_e.handleStyleChange=_e.handleStyleChange.bind(_assertThisInitialized$d(_e)),_e.changeStyle=_e.changeStyle.bind(_assertThisInitialized$d(_e)),!tt||ot<=0)return _e.state={style:{}},typeof at=="function"&&(_e.state={style:it}),_possibleConstructorReturn$d(_e);if(st&&st.length)_e.state={style:st[0].style};else if(nt){if(typeof at=="function")return _e.state={style:nt},_possibleConstructorReturn$d(_e);_e.state={style:rt?_defineProperty$o({},rt,nt):nt}}else _e.state={style:{}};return _e}return _createClass$f(_,[{key:"componentDidMount",value:function(){var j=this.props,_e=j.isActive,et=j.canBegin;this.mounted=!0,!(!_e||!et)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(j){var _e=this.props,et=_e.isActive,tt=_e.canBegin,rt=_e.attributeName,nt=_e.shouldReAnimate,it=_e.to,st=_e.from,at=this.state.style;if(tt){if(!et){var ot={style:rt?_defineProperty$o({},rt,it):it};this.state&&at&&(rt&&at[rt]!==it||!rt&&at!==it)&&this.setState(ot);return}if(!(deepEqual(j.to,it)&&j.canBegin&&j.isActive)){var lt=!j.canBegin||!j.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var ct=lt||nt?st:j.to;if(this.state&&at){var ft={style:rt?_defineProperty$o({},rt,ct):ct};(rt&&at[rt]!==ct||!rt&&at!==ct)&&this.setState(ft)}this.runAnimation(_objectSpread$k(_objectSpread$k({},this.props),{},{from:ct,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var j=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),j&&j()}},{key:"handleStyleChange",value:function(j){this.changeStyle(j)}},{key:"changeStyle",value:function(j){this.mounted&&this.setState({style:j})}},{key:"runJSAnimation",value:function(j){var _e=this,et=j.from,tt=j.to,rt=j.duration,nt=j.easing,it=j.begin,st=j.onAnimationEnd,at=j.onAnimationStart,ot=configUpdate(et,tt,configEasing(nt),rt,this.changeStyle),lt=function(){_e.stopJSAnimation=ot()};this.manager.start([at,it,lt,rt,st])}},{key:"runStepAnimation",value:function(j){var _e=this,et=j.steps,tt=j.begin,rt=j.onAnimationStart,nt=et[0],it=nt.style,st=nt.duration,at=st===void 0?0:st,ot=function(ct,ft,ut){if(ut===0)return ct;var ht=ft.duration,dt=ft.easing,mt=dt===void 0?"ease":dt,pt=ft.style,yt=ft.properties,gt=ft.onAnimationEnd,vt=ut>0?et[ut-1]:ft,St=yt||Object.keys(pt);if(typeof mt=="function"||mt==="spring")return[].concat(_toConsumableArray$4(ct),[_e.runJSAnimation.bind(_e,{from:vt.style,to:pt,duration:ht,easing:mt}),ht]);var At=getTransitionVal(St,ht,mt),xt=_objectSpread$k(_objectSpread$k(_objectSpread$k({},vt.style),pt),{},{transition:At});return[].concat(_toConsumableArray$4(ct),[xt,ht,gt]).filter(identity)};return this.manager.start([rt].concat(_toConsumableArray$4(et.reduce(ot,[it,Math.max(at,tt)])),[j.onAnimationEnd]))}},{key:"runAnimation",value:function(j){this.manager||(this.manager=createAnimateManager());var _e=j.begin,et=j.duration,tt=j.attributeName,rt=j.to,nt=j.easing,it=j.onAnimationStart,st=j.onAnimationEnd,at=j.steps,ot=j.children,lt=this.manager;if(this.unSubscribe=lt.subscribe(this.handleStyleChange),typeof nt=="function"||typeof ot=="function"||nt==="spring"){this.runJSAnimation(j);return}if(at.length>1){this.runStepAnimation(j);return}var ct=tt?_defineProperty$o({},tt,rt):rt,ft=getTransitionVal(Object.keys(ct),et,nt);lt.start([it,_e,_objectSpread$k(_objectSpread$k({},ct),{},{transition:ft}),et,st])}},{key:"render",value:function(){var j=this.props,_e=j.children;j.begin;var et=j.duration;j.attributeName,j.easing;var tt=j.isActive;j.steps,j.from,j.to,j.canBegin,j.onAnimationEnd,j.shouldReAnimate,j.onAnimationReStart;var rt=_objectWithoutProperties$9(j,_excluded$9),nt=reactExports.Children.count(_e),it=this.state.style;if(typeof _e=="function")return _e(it);if(!tt||nt===0||et<=0)return _e;var st=function(ot){var lt=ot.props,ct=lt.style,ft=ct===void 0?{}:ct,ut=lt.className,ht=reactExports.cloneElement(ot,_objectSpread$k(_objectSpread$k({},rt),{},{style:_objectSpread$k(_objectSpread$k({},ft),it),className:ut}));return ht};return nt===1?st(reactExports.Children.only(_e)):React$2.createElement("div",null,reactExports.Children.map(_e,function(at){return st(at)}))}}]),_}(reactExports.PureComponent);Animate.displayName="Animate";Animate.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function o(){},onAnimationStart:function o(){}};Animate.propTypes={from:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),to:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),attributeName:PropTypes.string,duration:PropTypes.number,begin:PropTypes.number,easing:PropTypes.oneOfType([PropTypes.string,PropTypes.func]),steps:PropTypes.arrayOf(PropTypes.shape({duration:PropTypes.number.isRequired,style:PropTypes.object.isRequired,easing:PropTypes.oneOfType([PropTypes.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),PropTypes.func]),properties:PropTypes.arrayOf("string"),onAnimationEnd:PropTypes.func})),children:PropTypes.oneOfType([PropTypes.node,PropTypes.func]),isActive:PropTypes.bool,canBegin:PropTypes.bool,onAnimationEnd:PropTypes.func,shouldReAnimate:PropTypes.bool,onAnimationStart:PropTypes.func,onAnimationReStart:PropTypes.func};function _typeof$m(o){"@babel/helpers - typeof";return _typeof$m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$m(o)}function _extends$j(){return _extends$j=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$j.apply(this,arguments)}function _slicedToArray$3(o,i){return _arrayWithHoles$3(o)||_iterableToArrayLimit$3(o,i)||_unsupportedIterableToArray$6(o,i)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$6(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$6(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$6(o,i)}}function _arrayLikeToArray$6(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$3(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$3(o){if(Array.isArray(o))return o}function ownKeys$k(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$j(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$k(Object(_),!0).forEach(function($){_defineProperty$n(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$k(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$n(o,i,_){return i=_toPropertyKey$n(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$n(o){var i=_toPrimitive$n(o,"string");return _typeof$m(i)=="symbol"?i:i+""}function _toPrimitive$n(o,i){if(_typeof$m(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$m($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var getRectanglePath=function o(i,_,$,j,_e){var et=Math.min(Math.abs($)/2,Math.abs(j)/2),tt=j>=0?1:-1,rt=$>=0?1:-1,nt=j>=0&&$>=0||j<0&&$<0?1:0,it;if(et>0&&_e instanceof Array){for(var st=[0,0,0,0],at=0,ot=4;at<ot;at++)st[at]=_e[at]>et?et:_e[at];it="M".concat(i,",").concat(_+tt*st[0]),st[0]>0&&(it+="A ".concat(st[0],",").concat(st[0],",0,0,").concat(nt,",").concat(i+rt*st[0],",").concat(_)),it+="L ".concat(i+$-rt*st[1],",").concat(_),st[1]>0&&(it+="A ".concat(st[1],",").concat(st[1],",0,0,").concat(nt,`,
        `).concat(i+$,",").concat(_+tt*st[1])),it+="L ".concat(i+$,",").concat(_+j-tt*st[2]),st[2]>0&&(it+="A ".concat(st[2],",").concat(st[2],",0,0,").concat(nt,`,
        `).concat(i+$-rt*st[2],",").concat(_+j)),it+="L ".concat(i+rt*st[3],",").concat(_+j),st[3]>0&&(it+="A ".concat(st[3],",").concat(st[3],",0,0,").concat(nt,`,
        `).concat(i,",").concat(_+j-tt*st[3])),it+="Z"}else if(et>0&&_e===+_e&&_e>0){var lt=Math.min(et,_e);it="M ".concat(i,",").concat(_+tt*lt,`
            A `).concat(lt,",").concat(lt,",0,0,").concat(nt,",").concat(i+rt*lt,",").concat(_,`
            L `).concat(i+$-rt*lt,",").concat(_,`
            A `).concat(lt,",").concat(lt,",0,0,").concat(nt,",").concat(i+$,",").concat(_+tt*lt,`
            L `).concat(i+$,",").concat(_+j-tt*lt,`
            A `).concat(lt,",").concat(lt,",0,0,").concat(nt,",").concat(i+$-rt*lt,",").concat(_+j,`
            L `).concat(i+rt*lt,",").concat(_+j,`
            A `).concat(lt,",").concat(lt,",0,0,").concat(nt,",").concat(i,",").concat(_+j-tt*lt," Z")}else it="M ".concat(i,",").concat(_," h ").concat($," v ").concat(j," h ").concat(-$," Z");return it},isInRectangle=function o(i,_){if(!i||!_)return!1;var $=i.x,j=i.y,_e=_.x,et=_.y,tt=_.width,rt=_.height;if(Math.abs(tt)>0&&Math.abs(rt)>0){var nt=Math.min(_e,_e+tt),it=Math.max(_e,_e+tt),st=Math.min(et,et+rt),at=Math.max(et,et+rt);return $>=nt&&$<=it&&j>=st&&j<=at}return!1},defaultProps$1={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rectangle=function o(i){var _=_objectSpread$j(_objectSpread$j({},defaultProps$1),i),$=reactExports.useRef(),j=reactExports.useState(-1),_e=_slicedToArray$3(j,2),et=_e[0],tt=_e[1];reactExports.useEffect(function(){if($.current&&$.current.getTotalLength)try{var mt=$.current.getTotalLength();mt&&tt(mt)}catch{}},[]);var rt=_.x,nt=_.y,it=_.width,st=_.height,at=_.radius,ot=_.className,lt=_.animationEasing,ct=_.animationDuration,ft=_.animationBegin,ut=_.isAnimationActive,ht=_.isUpdateAnimationActive;if(rt!==+rt||nt!==+nt||it!==+it||st!==+st||it===0||st===0)return null;var dt=clsx("recharts-rectangle",ot);return ht?React$2.createElement(Animate,{canBegin:et>0,from:{width:it,height:st,x:rt,y:nt},to:{width:it,height:st,x:rt,y:nt},duration:ct,animationEasing:lt,isActive:ht},function(mt){var pt=mt.width,yt=mt.height,gt=mt.x,vt=mt.y;return React$2.createElement(Animate,{canBegin:et>0,from:"0px ".concat(et===-1?1:et,"px"),to:"".concat(et,"px 0px"),attributeName:"strokeDasharray",begin:ft,duration:ct,isActive:ut,easing:lt},React$2.createElement("path",_extends$j({},filterProps(_,!0),{className:dt,d:getRectanglePath(gt,vt,pt,yt,at),ref:$})))}):React$2.createElement("path",_extends$j({},filterProps(_,!0),{className:dt,d:getRectanglePath(rt,nt,it,st,at)}))},_excluded$8=["points","className","baseLinePoints","connectNulls"];function _extends$i(){return _extends$i=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$i.apply(this,arguments)}function _objectWithoutProperties$8(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$8(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$8(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _toConsumableArray$3(o){return _arrayWithoutHoles$3(o)||_iterableToArray$3(o)||_unsupportedIterableToArray$5(o)||_nonIterableSpread$3()}function _nonIterableSpread$3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$5(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$5(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$5(o,i)}}function _iterableToArray$3(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$3(o){if(Array.isArray(o))return _arrayLikeToArray$5(o)}function _arrayLikeToArray$5(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}var isValidatePoint=function o(i){return i&&i.x===+i.x&&i.y===+i.y},getParsedPoints=function o(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_=[[]];return i.forEach(function($){isValidatePoint($)?_[_.length-1].push($):_[_.length-1].length>0&&_.push([])}),isValidatePoint(i[0])&&_[_.length-1].push(i[0]),_[_.length-1].length<=0&&(_=_.slice(0,-1)),_},getSinglePolygonPath=function o(i,_){var $=getParsedPoints(i);_&&($=[$.reduce(function(_e,et){return[].concat(_toConsumableArray$3(_e),_toConsumableArray$3(et))},[])]);var j=$.map(function(_e){return _e.reduce(function(et,tt,rt){return"".concat(et).concat(rt===0?"M":"L").concat(tt.x,",").concat(tt.y)},"")}).join("");return $.length===1?"".concat(j,"Z"):j},getRanglePath=function o(i,_,$){var j=getSinglePolygonPath(i,$);return"".concat(j.slice(-1)==="Z"?j.slice(0,-1):j,"L").concat(getSinglePolygonPath(_.reverse(),$).slice(1))},Polygon=function o(i){var _=i.points,$=i.className,j=i.baseLinePoints,_e=i.connectNulls,et=_objectWithoutProperties$8(i,_excluded$8);if(!_||!_.length)return null;var tt=clsx("recharts-polygon",$);if(j&&j.length){var rt=et.stroke&&et.stroke!=="none",nt=getRanglePath(_,j,_e);return React$2.createElement("g",{className:tt},React$2.createElement("path",_extends$i({},filterProps(et,!0),{fill:nt.slice(-1)==="Z"?et.fill:"none",stroke:"none",d:nt})),rt?React$2.createElement("path",_extends$i({},filterProps(et,!0),{fill:"none",d:getSinglePolygonPath(_,_e)})):null,rt?React$2.createElement("path",_extends$i({},filterProps(et,!0),{fill:"none",d:getSinglePolygonPath(j,_e)})):null)}var it=getSinglePolygonPath(_,_e);return React$2.createElement("path",_extends$i({},filterProps(et,!0),{fill:it.slice(-1)==="Z"?et.fill:"none",className:tt,d:it}))};function _extends$h(){return _extends$h=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$h.apply(this,arguments)}var Dot=function o(i){var _=i.cx,$=i.cy,j=i.r,_e=i.className,et=clsx("recharts-dot",_e);return _===+_&&$===+$&&j===+j?React$2.createElement("circle",_extends$h({},filterProps(i,!1),adaptEventHandlers(i),{className:et,cx:_,cy:$,r:j})):null};function _typeof$l(o){"@babel/helpers - typeof";return _typeof$l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$l(o)}var _excluded$7=["x","y","top","left","width","height","className"];function _extends$g(){return _extends$g=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$g.apply(this,arguments)}function ownKeys$j(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$i(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$j(Object(_),!0).forEach(function($){_defineProperty$m(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$j(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$m(o,i,_){return i=_toPropertyKey$m(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$m(o){var i=_toPrimitive$m(o,"string");return _typeof$l(i)=="symbol"?i:i+""}function _toPrimitive$m(o,i){if(_typeof$l(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$l($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _objectWithoutProperties$7(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$7(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$7(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}var getPath$1=function o(i,_,$,j,_e,et){return"M".concat(i,",").concat(_e,"v").concat(j,"M").concat(et,",").concat(_,"h").concat($)},Cross=function o(i){var _=i.x,$=_===void 0?0:_,j=i.y,_e=j===void 0?0:j,et=i.top,tt=et===void 0?0:et,rt=i.left,nt=rt===void 0?0:rt,it=i.width,st=it===void 0?0:it,at=i.height,ot=at===void 0?0:at,lt=i.className,ct=_objectWithoutProperties$7(i,_excluded$7),ft=_objectSpread$i({x:$,y:_e,top:tt,left:nt,width:st,height:ot},ct);return!isNumber($)||!isNumber(_e)||!isNumber(st)||!isNumber(ot)||!isNumber(tt)||!isNumber(nt)?null:React$2.createElement("path",_extends$g({},filterProps(ft,!0),{className:clsx("recharts-cross",lt),d:getPath$1($,_e,st,ot,tt,nt)}))},baseExtremum$1=_baseExtremum,baseGt=_baseGt,baseIteratee$4=_baseIteratee;function maxBy(o,i){return o&&o.length?baseExtremum$1(o,baseIteratee$4(i),baseGt):void 0}var maxBy_1=maxBy;const maxBy$1=getDefaultExportFromCjs$1(maxBy_1);var baseExtremum=_baseExtremum,baseIteratee$3=_baseIteratee,baseLt=_baseLt;function minBy(o,i){return o&&o.length?baseExtremum(o,baseIteratee$3(i),baseLt):void 0}var minBy_1=minBy;const minBy$1=getDefaultExportFromCjs$1(minBy_1);var _excluded$6=["cx","cy","angle","ticks","axisLine"],_excluded2$3=["ticks","tick","angle","tickFormatter","stroke"];function _typeof$k(o){"@babel/helpers - typeof";return _typeof$k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$k(o)}function _extends$f(){return _extends$f=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$f.apply(this,arguments)}function ownKeys$i(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$h(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$i(Object(_),!0).forEach(function($){_defineProperty$l(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$i(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _objectWithoutProperties$6(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$6(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$6(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _classCallCheck$e(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$e(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$l($.key),$)}}function _createClass$e(o,i,_){return i&&_defineProperties$e(o.prototype,i),_&&_defineProperties$e(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$c(o,i,_){return i=_getPrototypeOf$c(i),_possibleConstructorReturn$c(o,_isNativeReflectConstruct$c()?Reflect.construct(i,_||[],_getPrototypeOf$c(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$c(o,i){if(i&&(_typeof$k(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$c(o)}function _assertThisInitialized$c(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$c(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$c=function(){return!!o})()}function _getPrototypeOf$c(o){return _getPrototypeOf$c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$c(o)}function _inherits$c(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$c(o,i)}function _setPrototypeOf$c(o,i){return _setPrototypeOf$c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$c(o,i)}function _defineProperty$l(o,i,_){return i=_toPropertyKey$l(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$l(o){var i=_toPrimitive$l(o,"string");return _typeof$k(i)=="symbol"?i:i+""}function _toPrimitive$l(o,i){if(_typeof$k(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$k($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var PolarRadiusAxis=function(o){function i(){return _classCallCheck$e(this,i),_callSuper$c(this,i,arguments)}return _inherits$c(i,o),_createClass$e(i,[{key:"getTickValueCoord",value:function($){var j=$.coordinate,_e=this.props,et=_e.angle,tt=_e.cx,rt=_e.cy;return polarToCartesian(tt,rt,j,et)}},{key:"getTickTextAnchor",value:function(){var $=this.props.orientation,j;switch($){case"left":j="end";break;case"right":j="start";break;default:j="middle";break}return j}},{key:"getViewBox",value:function(){var $=this.props,j=$.cx,_e=$.cy,et=$.angle,tt=$.ticks,rt=maxBy$1(tt,function(it){return it.coordinate||0}),nt=minBy$1(tt,function(it){return it.coordinate||0});return{cx:j,cy:_e,startAngle:et,endAngle:et,innerRadius:nt.coordinate||0,outerRadius:rt.coordinate||0}}},{key:"renderAxisLine",value:function(){var $=this.props,j=$.cx,_e=$.cy,et=$.angle,tt=$.ticks,rt=$.axisLine,nt=_objectWithoutProperties$6($,_excluded$6),it=tt.reduce(function(lt,ct){return[Math.min(lt[0],ct.coordinate),Math.max(lt[1],ct.coordinate)]},[1/0,-1/0]),st=polarToCartesian(j,_e,it[0],et),at=polarToCartesian(j,_e,it[1],et),ot=_objectSpread$h(_objectSpread$h(_objectSpread$h({},filterProps(nt,!1)),{},{fill:"none"},filterProps(rt,!1)),{},{x1:st.x,y1:st.y,x2:at.x,y2:at.y});return React$2.createElement("line",_extends$f({className:"recharts-polar-radius-axis-line"},ot))}},{key:"renderTicks",value:function(){var $=this,j=this.props,_e=j.ticks,et=j.tick,tt=j.angle,rt=j.tickFormatter,nt=j.stroke,it=_objectWithoutProperties$6(j,_excluded2$3),st=this.getTickTextAnchor(),at=filterProps(it,!1),ot=filterProps(et,!1),lt=_e.map(function(ct,ft){var ut=$.getTickValueCoord(ct),ht=_objectSpread$h(_objectSpread$h(_objectSpread$h(_objectSpread$h({textAnchor:st,transform:"rotate(".concat(90-tt,", ").concat(ut.x,", ").concat(ut.y,")")},at),{},{stroke:"none",fill:nt},ot),{},{index:ft},ut),{},{payload:ct});return React$2.createElement(Layer,_extends$f({className:clsx("recharts-polar-radius-axis-tick",getTickClassName(et)),key:"tick-".concat(ct.coordinate)},adaptEventsOfChild($.props,ct,ft)),i.renderTickItem(et,ht,rt?rt(ct.value,ft):ct.value))});return React$2.createElement(Layer,{className:"recharts-polar-radius-axis-ticks"},lt)}},{key:"render",value:function(){var $=this.props,j=$.ticks,_e=$.axisLine,et=$.tick;return!j||!j.length?null:React$2.createElement(Layer,{className:clsx("recharts-polar-radius-axis",this.props.className)},_e&&this.renderAxisLine(),et&&this.renderTicks(),Label.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function($,j,_e){var et;return React$2.isValidElement($)?et=React$2.cloneElement($,j):isFunction$3($)?et=$(j):et=React$2.createElement(Text,_extends$f({},j,{className:"recharts-polar-radius-axis-tick-value"}),_e),et}}])}(reactExports.PureComponent);_defineProperty$l(PolarRadiusAxis,"displayName","PolarRadiusAxis");_defineProperty$l(PolarRadiusAxis,"axisType","radiusAxis");_defineProperty$l(PolarRadiusAxis,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function _typeof$j(o){"@babel/helpers - typeof";return _typeof$j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$j(o)}function _extends$e(){return _extends$e=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$e.apply(this,arguments)}function ownKeys$h(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$g(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$h(Object(_),!0).forEach(function($){_defineProperty$k(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$h(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$d(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$d(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$k($.key),$)}}function _createClass$d(o,i,_){return i&&_defineProperties$d(o.prototype,i),_&&_defineProperties$d(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$b(o,i,_){return i=_getPrototypeOf$b(i),_possibleConstructorReturn$b(o,_isNativeReflectConstruct$b()?Reflect.construct(i,_||[],_getPrototypeOf$b(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$b(o,i){if(i&&(_typeof$j(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$b(o)}function _assertThisInitialized$b(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$b(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$b=function(){return!!o})()}function _getPrototypeOf$b(o){return _getPrototypeOf$b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$b(o)}function _inherits$b(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$b(o,i)}function _setPrototypeOf$b(o,i){return _setPrototypeOf$b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$b(o,i)}function _defineProperty$k(o,i,_){return i=_toPropertyKey$k(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$k(o){var i=_toPrimitive$k(o,"string");return _typeof$j(i)=="symbol"?i:i+""}function _toPrimitive$k(o,i){if(_typeof$j(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$j($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var RADIAN=Math.PI/180,eps=1e-5,PolarAngleAxis=function(o){function i(){return _classCallCheck$d(this,i),_callSuper$b(this,i,arguments)}return _inherits$b(i,o),_createClass$d(i,[{key:"getTickLineCoord",value:function($){var j=this.props,_e=j.cx,et=j.cy,tt=j.radius,rt=j.orientation,nt=j.tickSize,it=nt||8,st=polarToCartesian(_e,et,tt,$.coordinate),at=polarToCartesian(_e,et,tt+(rt==="inner"?-1:1)*it,$.coordinate);return{x1:st.x,y1:st.y,x2:at.x,y2:at.y}}},{key:"getTickTextAnchor",value:function($){var j=this.props.orientation,_e=Math.cos(-$.coordinate*RADIAN),et;return _e>eps?et=j==="outer"?"start":"end":_e<-1e-5?et=j==="outer"?"end":"start":et="middle",et}},{key:"renderAxisLine",value:function(){var $=this.props,j=$.cx,_e=$.cy,et=$.radius,tt=$.axisLine,rt=$.axisLineType,nt=_objectSpread$g(_objectSpread$g({},filterProps(this.props,!1)),{},{fill:"none"},filterProps(tt,!1));if(rt==="circle")return React$2.createElement(Dot,_extends$e({className:"recharts-polar-angle-axis-line"},nt,{cx:j,cy:_e,r:et}));var it=this.props.ticks,st=it.map(function(at){return polarToCartesian(j,_e,et,at.coordinate)});return React$2.createElement(Polygon,_extends$e({className:"recharts-polar-angle-axis-line"},nt,{points:st}))}},{key:"renderTicks",value:function(){var $=this,j=this.props,_e=j.ticks,et=j.tick,tt=j.tickLine,rt=j.tickFormatter,nt=j.stroke,it=filterProps(this.props,!1),st=filterProps(et,!1),at=_objectSpread$g(_objectSpread$g({},it),{},{fill:"none"},filterProps(tt,!1)),ot=_e.map(function(lt,ct){var ft=$.getTickLineCoord(lt),ut=$.getTickTextAnchor(lt),ht=_objectSpread$g(_objectSpread$g(_objectSpread$g({textAnchor:ut},it),{},{stroke:"none",fill:nt},st),{},{index:ct,payload:lt,x:ft.x2,y:ft.y2});return React$2.createElement(Layer,_extends$e({className:clsx("recharts-polar-angle-axis-tick",getTickClassName(et)),key:"tick-".concat(lt.coordinate)},adaptEventsOfChild($.props,lt,ct)),tt&&React$2.createElement("line",_extends$e({className:"recharts-polar-angle-axis-tick-line"},at,ft)),et&&i.renderTickItem(et,ht,rt?rt(lt.value,ct):lt.value))});return React$2.createElement(Layer,{className:"recharts-polar-angle-axis-ticks"},ot)}},{key:"render",value:function(){var $=this.props,j=$.ticks,_e=$.radius,et=$.axisLine;return _e<=0||!j||!j.length?null:React$2.createElement(Layer,{className:clsx("recharts-polar-angle-axis",this.props.className)},et&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function($,j,_e){var et;return React$2.isValidElement($)?et=React$2.cloneElement($,j):isFunction$3($)?et=$(j):et=React$2.createElement(Text,_extends$e({},j,{className:"recharts-polar-angle-axis-tick-value"}),_e),et}}])}(reactExports.PureComponent);_defineProperty$k(PolarAngleAxis,"displayName","PolarAngleAxis");_defineProperty$k(PolarAngleAxis,"axisType","angleAxis");_defineProperty$k(PolarAngleAxis,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var overArg=_overArg,getPrototype$1=overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$1,baseGetTag$1=_baseGetTag,getPrototype=_getPrototype,isObjectLike$1=isObjectLike_1,objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(o){if(!isObjectLike$1(o)||baseGetTag$1(o)!=objectTag)return!1;var i=getPrototype(o);if(i===null)return!0;var _=hasOwnProperty.call(i,"constructor")&&i.constructor;return typeof _=="function"&&_ instanceof _&&funcToString.call(_)==objectCtorString}var isPlainObject_1=isPlainObject$1;const isPlainObject$2=getDefaultExportFromCjs$1(isPlainObject_1);var baseGetTag=_baseGetTag,isObjectLike=isObjectLike_1,boolTag="[object Boolean]";function isBoolean(o){return o===!0||o===!1||isObjectLike(o)&&baseGetTag(o)==boolTag}var isBoolean_1=isBoolean;const isBoolean$1=getDefaultExportFromCjs$1(isBoolean_1);function _typeof$i(o){"@babel/helpers - typeof";return _typeof$i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$i(o)}function _extends$d(){return _extends$d=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$d.apply(this,arguments)}function _slicedToArray$2(o,i){return _arrayWithHoles$2(o)||_iterableToArrayLimit$2(o,i)||_unsupportedIterableToArray$4(o,i)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$4(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$4(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$4(o,i)}}function _arrayLikeToArray$4(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$2(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$2(o){if(Array.isArray(o))return o}function ownKeys$g(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$f(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$g(Object(_),!0).forEach(function($){_defineProperty$j(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$g(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$j(o,i,_){return i=_toPropertyKey$j(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$j(o){var i=_toPrimitive$j(o,"string");return _typeof$i(i)=="symbol"?i:i+""}function _toPrimitive$j(o,i){if(_typeof$i(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$i($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var getTrapezoidPath=function o(i,_,$,j,_e){var et=$-j,tt;return tt="M ".concat(i,",").concat(_),tt+="L ".concat(i+$,",").concat(_),tt+="L ".concat(i+$-et/2,",").concat(_+_e),tt+="L ".concat(i+$-et/2-j,",").concat(_+_e),tt+="L ".concat(i,",").concat(_," Z"),tt},defaultProps={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Trapezoid=function o(i){var _=_objectSpread$f(_objectSpread$f({},defaultProps),i),$=reactExports.useRef(),j=reactExports.useState(-1),_e=_slicedToArray$2(j,2),et=_e[0],tt=_e[1];reactExports.useEffect(function(){if($.current&&$.current.getTotalLength)try{var dt=$.current.getTotalLength();dt&&tt(dt)}catch{}},[]);var rt=_.x,nt=_.y,it=_.upperWidth,st=_.lowerWidth,at=_.height,ot=_.className,lt=_.animationEasing,ct=_.animationDuration,ft=_.animationBegin,ut=_.isUpdateAnimationActive;if(rt!==+rt||nt!==+nt||it!==+it||st!==+st||at!==+at||it===0&&st===0||at===0)return null;var ht=clsx("recharts-trapezoid",ot);return ut?React$2.createElement(Animate,{canBegin:et>0,from:{upperWidth:0,lowerWidth:0,height:at,x:rt,y:nt},to:{upperWidth:it,lowerWidth:st,height:at,x:rt,y:nt},duration:ct,animationEasing:lt,isActive:ut},function(dt){var mt=dt.upperWidth,pt=dt.lowerWidth,yt=dt.height,gt=dt.x,vt=dt.y;return React$2.createElement(Animate,{canBegin:et>0,from:"0px ".concat(et===-1?1:et,"px"),to:"".concat(et,"px 0px"),attributeName:"strokeDasharray",begin:ft,duration:ct,easing:lt},React$2.createElement("path",_extends$d({},filterProps(_,!0),{className:ht,d:getTrapezoidPath(gt,vt,mt,pt,yt),ref:$})))}):React$2.createElement("g",null,React$2.createElement("path",_extends$d({},filterProps(_,!0),{className:ht,d:getTrapezoidPath(rt,nt,it,st,at)})))},_excluded$5=["option","shapeType","propTransformer","activeClassName","isActive"];function _typeof$h(o){"@babel/helpers - typeof";return _typeof$h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$h(o)}function _objectWithoutProperties$5(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$5(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$5(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function ownKeys$f(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$e(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$f(Object(_),!0).forEach(function($){_defineProperty$i(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$f(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$i(o,i,_){return i=_toPropertyKey$i(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$i(o){var i=_toPrimitive$i(o,"string");return _typeof$h(i)=="symbol"?i:i+""}function _toPrimitive$i(o,i){if(_typeof$h(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$h($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function defaultPropTransformer(o,i){return _objectSpread$e(_objectSpread$e({},i),o)}function isSymbolsProps(o,i){return o==="symbols"}function ShapeSelector(o){var i=o.shapeType,_=o.elementProps;switch(i){case"rectangle":return React$2.createElement(Rectangle,_);case"trapezoid":return React$2.createElement(Trapezoid,_);case"sector":return React$2.createElement(Sector,_);case"symbols":if(isSymbolsProps(i))return React$2.createElement(Symbols,_);break;default:return null}}function getPropsFromShapeOption(o){return reactExports.isValidElement(o)?o.props:o}function Shape(o){var i=o.option,_=o.shapeType,$=o.propTransformer,j=$===void 0?defaultPropTransformer:$,_e=o.activeClassName,et=_e===void 0?"recharts-active-shape":_e,tt=o.isActive,rt=_objectWithoutProperties$5(o,_excluded$5),nt;if(reactExports.isValidElement(i))nt=reactExports.cloneElement(i,_objectSpread$e(_objectSpread$e({},rt),getPropsFromShapeOption(i)));else if(isFunction$3(i))nt=i(rt);else if(isPlainObject$2(i)&&!isBoolean$1(i)){var it=j(i,rt);nt=React$2.createElement(ShapeSelector,{shapeType:_,elementProps:it})}else{var st=rt;nt=React$2.createElement(ShapeSelector,{shapeType:_,elementProps:st})}return tt?React$2.createElement(Layer,{className:et},nt):nt}function isFunnel(o,i){return i!=null&&"trapezoids"in o.props}function isPie(o,i){return i!=null&&"sectors"in o.props}function isScatter(o,i){return i!=null&&"points"in o.props}function compareFunnel(o,i){var _,$,j=o.x===(i==null||(_=i.labelViewBox)===null||_===void 0?void 0:_.x)||o.x===i.x,_e=o.y===(i==null||($=i.labelViewBox)===null||$===void 0?void 0:$.y)||o.y===i.y;return j&&_e}function comparePie(o,i){var _=o.endAngle===i.endAngle,$=o.startAngle===i.startAngle;return _&&$}function compareScatter(o,i){var _=o.x===i.x,$=o.y===i.y,j=o.z===i.z;return _&&$&&j}function getComparisonFn(o,i){var _;return isFunnel(o,i)?_=compareFunnel:isPie(o,i)?_=comparePie:isScatter(o,i)&&(_=compareScatter),_}function getShapeDataKey(o,i){var _;return isFunnel(o,i)?_="trapezoids":isPie(o,i)?_="sectors":isScatter(o,i)&&(_="points"),_}function getActiveShapeTooltipPayload(o,i){if(isFunnel(o,i)){var _;return(_=i.tooltipPayload)===null||_===void 0||(_=_[0])===null||_===void 0||(_=_.payload)===null||_===void 0?void 0:_.payload}if(isPie(o,i)){var $;return($=i.tooltipPayload)===null||$===void 0||($=$[0])===null||$===void 0||($=$.payload)===null||$===void 0?void 0:$.payload}return isScatter(o,i)?i.payload:{}}function getActiveShapeIndexForTooltip(o){var i=o.activeTooltipItem,_=o.graphicalItem,$=o.itemData,j=getShapeDataKey(_,i),_e=getActiveShapeTooltipPayload(_,i),et=$.filter(function(rt,nt){var it=isEqual$1(_e,rt),st=_.props[j].filter(function(lt){var ct=getComparisonFn(_,i);return ct(lt,i)}),at=_.props[j].indexOf(st[st.length-1]),ot=nt===at;return it&&ot}),tt=$.indexOf(et[et.length-1]);return tt}var _Pie;function _typeof$g(o){"@babel/helpers - typeof";return _typeof$g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$g(o)}function _extends$c(){return _extends$c=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$c.apply(this,arguments)}function ownKeys$e(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$d(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$e(Object(_),!0).forEach(function($){_defineProperty$h(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$e(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$c(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$c(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$h($.key),$)}}function _createClass$c(o,i,_){return i&&_defineProperties$c(o.prototype,i),_&&_defineProperties$c(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$a(o,i,_){return i=_getPrototypeOf$a(i),_possibleConstructorReturn$a(o,_isNativeReflectConstruct$a()?Reflect.construct(i,_||[],_getPrototypeOf$a(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$a(o,i){if(i&&(_typeof$g(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$a(o)}function _assertThisInitialized$a(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$a(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$a=function(){return!!o})()}function _getPrototypeOf$a(o){return _getPrototypeOf$a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$a(o)}function _inherits$a(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$a(o,i)}function _setPrototypeOf$a(o,i){return _setPrototypeOf$a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$a(o,i)}function _defineProperty$h(o,i,_){return i=_toPropertyKey$h(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$h(o){var i=_toPrimitive$h(o,"string");return _typeof$g(i)=="symbol"?i:i+""}function _toPrimitive$h(o,i){if(_typeof$g(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$g($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var Pie=function(o){function i(_){var $;return _classCallCheck$c(this,i),$=_callSuper$a(this,i,[_]),_defineProperty$h($,"pieRef",null),_defineProperty$h($,"sectorRefs",[]),_defineProperty$h($,"id",uniqueId("recharts-pie-")),_defineProperty$h($,"handleAnimationEnd",function(){var j=$.props.onAnimationEnd;$.setState({isAnimationFinished:!0}),isFunction$3(j)&&j()}),_defineProperty$h($,"handleAnimationStart",function(){var j=$.props.onAnimationStart;$.setState({isAnimationFinished:!1}),isFunction$3(j)&&j()}),$.state={isAnimationFinished:!_.isAnimationActive,prevIsAnimationActive:_.isAnimationActive,prevAnimationId:_.animationId,sectorToFocus:0},$}return _inherits$a(i,o),_createClass$c(i,[{key:"isActiveIndex",value:function($){var j=this.props.activeIndex;return Array.isArray(j)?j.indexOf($)!==-1:$===j}},{key:"hasActiveIndex",value:function(){var $=this.props.activeIndex;return Array.isArray($)?$.length!==0:$||$===0}},{key:"renderLabels",value:function($){var j=this.props.isAnimationActive;if(j&&!this.state.isAnimationFinished)return null;var _e=this.props,et=_e.label,tt=_e.labelLine,rt=_e.dataKey,nt=_e.valueKey,it=filterProps(this.props,!1),st=filterProps(et,!1),at=filterProps(tt,!1),ot=et&&et.offsetRadius||20,lt=$.map(function(ct,ft){var ut=(ct.startAngle+ct.endAngle)/2,ht=polarToCartesian(ct.cx,ct.cy,ct.outerRadius+ot,ut),dt=_objectSpread$d(_objectSpread$d(_objectSpread$d(_objectSpread$d({},it),ct),{},{stroke:"none"},st),{},{index:ft,textAnchor:i.getTextAnchor(ht.x,ct.cx)},ht),mt=_objectSpread$d(_objectSpread$d(_objectSpread$d(_objectSpread$d({},it),ct),{},{fill:"none",stroke:ct.fill},at),{},{index:ft,points:[polarToCartesian(ct.cx,ct.cy,ct.outerRadius,ut),ht]}),pt=rt;return isNil$1(rt)&&isNil$1(nt)?pt="value":isNil$1(rt)&&(pt=nt),React$2.createElement(Layer,{key:"label-".concat(ct.startAngle,"-").concat(ct.endAngle,"-").concat(ct.midAngle,"-").concat(ft)},tt&&i.renderLabelLineItem(tt,mt,"line"),i.renderLabelItem(et,dt,getValueByDataKey(ct,pt)))});return React$2.createElement(Layer,{className:"recharts-pie-labels"},lt)}},{key:"renderSectorsStatically",value:function($){var j=this,_e=this.props,et=_e.activeShape,tt=_e.blendStroke,rt=_e.inactiveShape;return $.map(function(nt,it){if((nt==null?void 0:nt.startAngle)===0&&(nt==null?void 0:nt.endAngle)===0&&$.length!==1)return null;var st=j.isActiveIndex(it),at=rt&&j.hasActiveIndex()?rt:null,ot=st?et:at,lt=_objectSpread$d(_objectSpread$d({},nt),{},{stroke:tt?nt.fill:nt.stroke,tabIndex:-1});return React$2.createElement(Layer,_extends$c({ref:function(ft){ft&&!j.sectorRefs.includes(ft)&&j.sectorRefs.push(ft)},tabIndex:-1,className:"recharts-pie-sector"},adaptEventsOfChild(j.props,nt,it),{key:"sector-".concat(nt==null?void 0:nt.startAngle,"-").concat(nt==null?void 0:nt.endAngle,"-").concat(nt.midAngle,"-").concat(it)}),React$2.createElement(Shape,_extends$c({option:ot,isActive:st,shapeType:"sector"},lt)))})}},{key:"renderSectorsWithAnimation",value:function(){var $=this,j=this.props,_e=j.sectors,et=j.isAnimationActive,tt=j.animationBegin,rt=j.animationDuration,nt=j.animationEasing,it=j.animationId,st=this.state,at=st.prevSectors,ot=st.prevIsAnimationActive;return React$2.createElement(Animate,{begin:tt,duration:rt,isActive:et,easing:nt,from:{t:0},to:{t:1},key:"pie-".concat(it,"-").concat(ot),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(lt){var ct=lt.t,ft=[],ut=_e&&_e[0],ht=ut.startAngle;return _e.forEach(function(dt,mt){var pt=at&&at[mt],yt=mt>0?get$4(dt,"paddingAngle",0):0;if(pt){var gt=interpolateNumber$2(pt.endAngle-pt.startAngle,dt.endAngle-dt.startAngle),vt=_objectSpread$d(_objectSpread$d({},dt),{},{startAngle:ht+yt,endAngle:ht+gt(ct)+yt});ft.push(vt),ht=vt.endAngle}else{var St=dt.endAngle,At=dt.startAngle,xt=interpolateNumber$2(0,St-At),wt=xt(ct),Ot=_objectSpread$d(_objectSpread$d({},dt),{},{startAngle:ht+yt,endAngle:ht+wt+yt});ft.push(Ot),ht=Ot.endAngle}}),React$2.createElement(Layer,null,$.renderSectorsStatically(ft))})}},{key:"attachKeyboardHandlers",value:function($){var j=this;$.onkeydown=function(_e){if(!_e.altKey)switch(_e.key){case"ArrowLeft":{var et=++j.state.sectorToFocus%j.sectorRefs.length;j.sectorRefs[et].focus(),j.setState({sectorToFocus:et});break}case"ArrowRight":{var tt=--j.state.sectorToFocus<0?j.sectorRefs.length-1:j.state.sectorToFocus%j.sectorRefs.length;j.sectorRefs[tt].focus(),j.setState({sectorToFocus:tt});break}case"Escape":{j.sectorRefs[j.state.sectorToFocus].blur(),j.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var $=this.props,j=$.sectors,_e=$.isAnimationActive,et=this.state.prevSectors;return _e&&j&&j.length&&(!et||!isEqual$1(et,j))?this.renderSectorsWithAnimation():this.renderSectorsStatically(j)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var $=this,j=this.props,_e=j.hide,et=j.sectors,tt=j.className,rt=j.label,nt=j.cx,it=j.cy,st=j.innerRadius,at=j.outerRadius,ot=j.isAnimationActive,lt=this.state.isAnimationFinished;if(_e||!et||!et.length||!isNumber(nt)||!isNumber(it)||!isNumber(st)||!isNumber(at))return null;var ct=clsx("recharts-pie",tt);return React$2.createElement(Layer,{tabIndex:this.props.rootTabIndex,className:ct,ref:function(ut){$.pieRef=ut}},this.renderSectors(),rt&&this.renderLabels(et),Label.renderCallByParent(this.props,null,!1),(!ot||lt)&&LabelList.renderCallByParent(this.props,et,!1))}}],[{key:"getDerivedStateFromProps",value:function($,j){return j.prevIsAnimationActive!==$.isAnimationActive?{prevIsAnimationActive:$.isAnimationActive,prevAnimationId:$.animationId,curSectors:$.sectors,prevSectors:[],isAnimationFinished:!0}:$.isAnimationActive&&$.animationId!==j.prevAnimationId?{prevAnimationId:$.animationId,curSectors:$.sectors,prevSectors:j.curSectors,isAnimationFinished:!0}:$.sectors!==j.curSectors?{curSectors:$.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function($,j){return $>j?"start":$<j?"end":"middle"}},{key:"renderLabelLineItem",value:function($,j,_e){if(React$2.isValidElement($))return React$2.cloneElement($,j);if(isFunction$3($))return $(j);var et=clsx("recharts-pie-label-line",typeof $!="boolean"?$.className:"");return React$2.createElement(Curve,_extends$c({},j,{key:_e,type:"linear",className:et}))}},{key:"renderLabelItem",value:function($,j,_e){if(React$2.isValidElement($))return React$2.cloneElement($,j);var et=_e;if(isFunction$3($)&&(et=$(j),React$2.isValidElement(et)))return et;var tt=clsx("recharts-pie-label-text",typeof $!="boolean"&&!isFunction$3($)?$.className:"");return React$2.createElement(Text,_extends$c({},j,{alignmentBaseline:"middle",className:tt}),et)}}])}(reactExports.PureComponent);_Pie=Pie;_defineProperty$h(Pie,"displayName","Pie");_defineProperty$h(Pie,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Global.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});_defineProperty$h(Pie,"parseDeltaAngle",function(o,i){var _=mathSign(i-o),$=Math.min(Math.abs(i-o),360);return _*$});_defineProperty$h(Pie,"getRealPieData",function(o){var i=o.data,_=o.children,$=filterProps(o,!1),j=findAllByType(_,Cell);return i&&i.length?i.map(function(_e,et){return _objectSpread$d(_objectSpread$d(_objectSpread$d({payload:_e},$),_e),j&&j[et]&&j[et].props)}):j&&j.length?j.map(function(_e){return _objectSpread$d(_objectSpread$d({},$),_e.props)}):[]});_defineProperty$h(Pie,"parseCoordinateOfPie",function(o,i){var _=i.top,$=i.left,j=i.width,_e=i.height,et=getMaxRadius(j,_e),tt=$+getPercentValue(o.cx,j,j/2),rt=_+getPercentValue(o.cy,_e,_e/2),nt=getPercentValue(o.innerRadius,et,0),it=getPercentValue(o.outerRadius,et,et*.8),st=o.maxRadius||Math.sqrt(j*j+_e*_e)/2;return{cx:tt,cy:rt,innerRadius:nt,outerRadius:it,maxRadius:st}});_defineProperty$h(Pie,"getComposedData",function(o){var i=o.item,_=o.offset,$=i.type.defaultProps!==void 0?_objectSpread$d(_objectSpread$d({},i.type.defaultProps),i.props):i.props,j=_Pie.getRealPieData($);if(!j||!j.length)return null;var _e=$.cornerRadius,et=$.startAngle,tt=$.endAngle,rt=$.paddingAngle,nt=$.dataKey,it=$.nameKey,st=$.valueKey,at=$.tooltipType,ot=Math.abs($.minAngle),lt=_Pie.parseCoordinateOfPie($,_),ct=_Pie.parseDeltaAngle(et,tt),ft=Math.abs(ct),ut=nt;isNil$1(nt)&&isNil$1(st)?(warn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),ut="value"):isNil$1(nt)&&(warn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),ut=st);var ht=j.filter(function(vt){return getValueByDataKey(vt,ut,0)!==0}).length,dt=(ft>=360?ht:ht-1)*rt,mt=ft-ht*ot-dt,pt=j.reduce(function(vt,St){var At=getValueByDataKey(St,ut,0);return vt+(isNumber(At)?At:0)},0),yt;if(pt>0){var gt;yt=j.map(function(vt,St){var At=getValueByDataKey(vt,ut,0),xt=getValueByDataKey(vt,it,St),wt=(isNumber(At)?At:0)/pt,Ot;St?Ot=gt.endAngle+mathSign(ct)*rt*(At!==0?1:0):Ot=et;var Bt=Ot+mathSign(ct)*((At!==0?ot:0)+wt*mt),Ft=(Ot+Bt)/2,Pt=(lt.innerRadius+lt.outerRadius)/2,Rt=[{name:xt,value:At,payload:vt,dataKey:ut,type:at}],Et=polarToCartesian(lt.cx,lt.cy,Pt,Ft);return gt=_objectSpread$d(_objectSpread$d(_objectSpread$d({percent:wt,cornerRadius:_e,name:xt,tooltipPayload:Rt,midAngle:Ft,middleRadius:Pt,tooltipPosition:Et},vt),lt),{},{value:getValueByDataKey(vt,ut),startAngle:Ot,endAngle:Bt,payload:vt,paddingAngle:mathSign(ct)*rt}),gt})}return _objectSpread$d(_objectSpread$d({},lt),{},{sectors:yt,data:j})});var nativeCeil=Math.ceil,nativeMax=Math.max;function baseRange$1(o,i,_,$){for(var j=-1,_e=nativeMax(nativeCeil((i-o)/(_||1)),0),et=Array(_e);_e--;)et[$?_e:++j]=o,o+=_;return et}var _baseRange=baseRange$1,toNumber$1=toNumber_1,INFINITY=1/0,MAX_INTEGER=17976931348623157e292;function toFinite$1(o){if(!o)return o===0?o:0;if(o=toNumber$1(o),o===INFINITY||o===-1/0){var i=o<0?-1:1;return i*MAX_INTEGER}return o===o?o:0}var toFinite_1=toFinite$1,baseRange=_baseRange,isIterateeCall$2=_isIterateeCall,toFinite=toFinite_1;function createRange$1(o){return function(i,_,$){return $&&typeof $!="number"&&isIterateeCall$2(i,_,$)&&(_=$=void 0),i=toFinite(i),_===void 0?(_=i,i=0):_=toFinite(_),$=$===void 0?i<_?1:-1:toFinite($),baseRange(i,_,$,o)}}var _createRange=createRange$1,createRange=_createRange,range=createRange(),range_1=range;const range$1=getDefaultExportFromCjs$1(range_1);function _typeof$f(o){"@babel/helpers - typeof";return _typeof$f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$f(o)}function ownKeys$d(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$c(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$d(Object(_),!0).forEach(function($){_defineProperty$g(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$d(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$g(o,i,_){return i=_toPropertyKey$g(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$g(o){var i=_toPrimitive$g(o,"string");return _typeof$f(i)=="symbol"?i:i+""}function _toPrimitive$g(o,i){if(_typeof$f(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$f($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var PREFIX_LIST=["Webkit","Moz","O","ms"],generatePrefixStyle=function o(i,_){var $=i.replace(/(\w)/,function(_e){return _e.toUpperCase()}),j=PREFIX_LIST.reduce(function(_e,et){return _objectSpread$c(_objectSpread$c({},_e),{},_defineProperty$g({},et+$,_))},{});return j[i]=_,j};function _typeof$e(o){"@babel/helpers - typeof";return _typeof$e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$e(o)}function _extends$b(){return _extends$b=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$b.apply(this,arguments)}function ownKeys$c(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$b(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$c(Object(_),!0).forEach(function($){_defineProperty$f(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$c(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$b(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$b(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$f($.key),$)}}function _createClass$b(o,i,_){return i&&_defineProperties$b(o.prototype,i),_&&_defineProperties$b(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$9(o,i,_){return i=_getPrototypeOf$9(i),_possibleConstructorReturn$9(o,_isNativeReflectConstruct$9()?Reflect.construct(i,_||[],_getPrototypeOf$9(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$9(o,i){if(i&&(_typeof$e(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$9(o)}function _assertThisInitialized$9(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$9(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$9=function(){return!!o})()}function _getPrototypeOf$9(o){return _getPrototypeOf$9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$9(o)}function _inherits$9(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$9(o,i)}function _setPrototypeOf$9(o,i){return _setPrototypeOf$9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$9(o,i)}function _defineProperty$f(o,i,_){return i=_toPropertyKey$f(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$f(o){var i=_toPrimitive$f(o,"string");return _typeof$e(i)=="symbol"?i:i+""}function _toPrimitive$f(o,i){if(_typeof$e(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$e($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var createScale=function o(i){var _=i.data,$=i.startIndex,j=i.endIndex,_e=i.x,et=i.width,tt=i.travellerWidth;if(!_||!_.length)return{};var rt=_.length,nt=point().domain(range$1(0,rt)).range([_e,_e+et-tt]),it=nt.domain().map(function(st){return nt(st)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:nt($),endX:nt(j),scale:nt,scaleValues:it}},isTouch=function o(i){return i.changedTouches&&!!i.changedTouches.length},Brush=function(o){function i(_){var $;return _classCallCheck$b(this,i),$=_callSuper$9(this,i,[_]),_defineProperty$f($,"handleDrag",function(j){$.leaveTimer&&(clearTimeout($.leaveTimer),$.leaveTimer=null),$.state.isTravellerMoving?$.handleTravellerMove(j):$.state.isSlideMoving&&$.handleSlideDrag(j)}),_defineProperty$f($,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&$.handleDrag(j.changedTouches[0])}),_defineProperty$f($,"handleDragEnd",function(){$.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var j=$.props,_e=j.endIndex,et=j.onDragEnd,tt=j.startIndex;et==null||et({endIndex:_e,startIndex:tt})}),$.detachDragEndListener()}),_defineProperty$f($,"handleLeaveWrapper",function(){($.state.isTravellerMoving||$.state.isSlideMoving)&&($.leaveTimer=window.setTimeout($.handleDragEnd,$.props.leaveTimeOut))}),_defineProperty$f($,"handleEnterSlideOrTraveller",function(){$.setState({isTextActive:!0})}),_defineProperty$f($,"handleLeaveSlideOrTraveller",function(){$.setState({isTextActive:!1})}),_defineProperty$f($,"handleSlideDragStart",function(j){var _e=isTouch(j)?j.changedTouches[0]:j;$.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:_e.pageX}),$.attachDragEndListener()}),$.travellerDragStartHandlers={startX:$.handleTravellerDragStart.bind($,"startX"),endX:$.handleTravellerDragStart.bind($,"endX")},$.state={},$}return _inherits$9(i,o),_createClass$b(i,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function($){var j=$.startX,_e=$.endX,et=this.state.scaleValues,tt=this.props,rt=tt.gap,nt=tt.data,it=nt.length-1,st=Math.min(j,_e),at=Math.max(j,_e),ot=i.getIndexInRange(et,st),lt=i.getIndexInRange(et,at);return{startIndex:ot-ot%rt,endIndex:lt===it?it:lt-lt%rt}}},{key:"getTextOfTick",value:function($){var j=this.props,_e=j.data,et=j.tickFormatter,tt=j.dataKey,rt=getValueByDataKey(_e[$],tt,$);return isFunction$3(et)?et(rt,$):rt}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function($){var j=this.state,_e=j.slideMoveStartX,et=j.startX,tt=j.endX,rt=this.props,nt=rt.x,it=rt.width,st=rt.travellerWidth,at=rt.startIndex,ot=rt.endIndex,lt=rt.onChange,ct=$.pageX-_e;ct>0?ct=Math.min(ct,nt+it-st-tt,nt+it-st-et):ct<0&&(ct=Math.max(ct,nt-et,nt-tt));var ft=this.getIndex({startX:et+ct,endX:tt+ct});(ft.startIndex!==at||ft.endIndex!==ot)&&lt&&lt(ft),this.setState({startX:et+ct,endX:tt+ct,slideMoveStartX:$.pageX})}},{key:"handleTravellerDragStart",value:function($,j){var _e=isTouch(j)?j.changedTouches[0]:j;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:$,brushMoveStartX:_e.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function($){var j=this.state,_e=j.brushMoveStartX,et=j.movingTravellerId,tt=j.endX,rt=j.startX,nt=this.state[et],it=this.props,st=it.x,at=it.width,ot=it.travellerWidth,lt=it.onChange,ct=it.gap,ft=it.data,ut={startX:this.state.startX,endX:this.state.endX},ht=$.pageX-_e;ht>0?ht=Math.min(ht,st+at-ot-nt):ht<0&&(ht=Math.max(ht,st-nt)),ut[et]=nt+ht;var dt=this.getIndex(ut),mt=dt.startIndex,pt=dt.endIndex,yt=function(){var vt=ft.length-1;return et==="startX"&&(tt>rt?mt%ct===0:pt%ct===0)||tt<rt&&pt===vt||et==="endX"&&(tt>rt?pt%ct===0:mt%ct===0)||tt>rt&&pt===vt};this.setState(_defineProperty$f(_defineProperty$f({},et,nt+ht),"brushMoveStartX",$.pageX),function(){lt&&yt()&&lt(dt)})}},{key:"handleTravellerMoveKeyboard",value:function($,j){var _e=this,et=this.state,tt=et.scaleValues,rt=et.startX,nt=et.endX,it=this.state[j],st=tt.indexOf(it);if(st!==-1){var at=st+$;if(!(at===-1||at>=tt.length)){var ot=tt[at];j==="startX"&&ot>=nt||j==="endX"&&ot<=rt||this.setState(_defineProperty$f({},j,ot),function(){_e.props.onChange(_e.getIndex({startX:_e.state.startX,endX:_e.state.endX}))})}}}},{key:"renderBackground",value:function(){var $=this.props,j=$.x,_e=$.y,et=$.width,tt=$.height,rt=$.fill,nt=$.stroke;return React$2.createElement("rect",{stroke:nt,fill:rt,x:j,y:_e,width:et,height:tt})}},{key:"renderPanorama",value:function(){var $=this.props,j=$.x,_e=$.y,et=$.width,tt=$.height,rt=$.data,nt=$.children,it=$.padding,st=reactExports.Children.only(nt);return st?React$2.cloneElement(st,{x:j,y:_e,width:et,height:tt,margin:it,compact:!0,data:rt}):null}},{key:"renderTravellerLayer",value:function($,j){var _e,et,tt=this,rt=this.props,nt=rt.y,it=rt.travellerWidth,st=rt.height,at=rt.traveller,ot=rt.ariaLabel,lt=rt.data,ct=rt.startIndex,ft=rt.endIndex,ut=Math.max($,this.props.x),ht=_objectSpread$b(_objectSpread$b({},filterProps(this.props,!1)),{},{x:ut,y:nt,width:it,height:st}),dt=ot||"Min value: ".concat((_e=lt[ct])===null||_e===void 0?void 0:_e.name,", Max value: ").concat((et=lt[ft])===null||et===void 0?void 0:et.name);return React$2.createElement(Layer,{tabIndex:0,role:"slider","aria-label":dt,"aria-valuenow":$,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[j],onTouchStart:this.travellerDragStartHandlers[j],onKeyDown:function(pt){["ArrowLeft","ArrowRight"].includes(pt.key)&&(pt.preventDefault(),pt.stopPropagation(),tt.handleTravellerMoveKeyboard(pt.key==="ArrowRight"?1:-1,j))},onFocus:function(){tt.setState({isTravellerFocused:!0})},onBlur:function(){tt.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},i.renderTraveller(at,ht))}},{key:"renderSlide",value:function($,j){var _e=this.props,et=_e.y,tt=_e.height,rt=_e.stroke,nt=_e.travellerWidth,it=Math.min($,j)+nt,st=Math.max(Math.abs(j-$)-nt,0);return React$2.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:rt,fillOpacity:.2,x:it,y:et,width:st,height:tt})}},{key:"renderText",value:function(){var $=this.props,j=$.startIndex,_e=$.endIndex,et=$.y,tt=$.height,rt=$.travellerWidth,nt=$.stroke,it=this.state,st=it.startX,at=it.endX,ot=5,lt={pointerEvents:"none",fill:nt};return React$2.createElement(Layer,{className:"recharts-brush-texts"},React$2.createElement(Text,_extends$b({textAnchor:"end",verticalAnchor:"middle",x:Math.min(st,at)-ot,y:et+tt/2},lt),this.getTextOfTick(j)),React$2.createElement(Text,_extends$b({textAnchor:"start",verticalAnchor:"middle",x:Math.max(st,at)+rt+ot,y:et+tt/2},lt),this.getTextOfTick(_e)))}},{key:"render",value:function(){var $=this.props,j=$.data,_e=$.className,et=$.children,tt=$.x,rt=$.y,nt=$.width,it=$.height,st=$.alwaysShowText,at=this.state,ot=at.startX,lt=at.endX,ct=at.isTextActive,ft=at.isSlideMoving,ut=at.isTravellerMoving,ht=at.isTravellerFocused;if(!j||!j.length||!isNumber(tt)||!isNumber(rt)||!isNumber(nt)||!isNumber(it)||nt<=0||it<=0)return null;var dt=clsx("recharts-brush",_e),mt=React$2.Children.count(et)===1,pt=generatePrefixStyle("userSelect","none");return React$2.createElement(Layer,{className:dt,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:pt},this.renderBackground(),mt&&this.renderPanorama(),this.renderSlide(ot,lt),this.renderTravellerLayer(ot,"startX"),this.renderTravellerLayer(lt,"endX"),(ct||ft||ut||ht||st)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function($){var j=$.x,_e=$.y,et=$.width,tt=$.height,rt=$.stroke,nt=Math.floor(_e+tt/2)-1;return React$2.createElement(React$2.Fragment,null,React$2.createElement("rect",{x:j,y:_e,width:et,height:tt,fill:rt,stroke:"none"}),React$2.createElement("line",{x1:j+1,y1:nt,x2:j+et-1,y2:nt,fill:"none",stroke:"#fff"}),React$2.createElement("line",{x1:j+1,y1:nt+2,x2:j+et-1,y2:nt+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function($,j){var _e;return React$2.isValidElement($)?_e=React$2.cloneElement($,j):isFunction$3($)?_e=$(j):_e=i.renderDefaultTraveller(j),_e}},{key:"getDerivedStateFromProps",value:function($,j){var _e=$.data,et=$.width,tt=$.x,rt=$.travellerWidth,nt=$.updateId,it=$.startIndex,st=$.endIndex;if(_e!==j.prevData||nt!==j.prevUpdateId)return _objectSpread$b({prevData:_e,prevTravellerWidth:rt,prevUpdateId:nt,prevX:tt,prevWidth:et},_e&&_e.length?createScale({data:_e,width:et,x:tt,travellerWidth:rt,startIndex:it,endIndex:st}):{scale:null,scaleValues:null});if(j.scale&&(et!==j.prevWidth||tt!==j.prevX||rt!==j.prevTravellerWidth)){j.scale.range([tt,tt+et-rt]);var at=j.scale.domain().map(function(ot){return j.scale(ot)});return{prevData:_e,prevTravellerWidth:rt,prevUpdateId:nt,prevX:tt,prevWidth:et,startX:j.scale($.startIndex),endX:j.scale($.endIndex),scaleValues:at}}return null}},{key:"getIndexInRange",value:function($,j){for(var _e=$.length,et=0,tt=_e-1;tt-et>1;){var rt=Math.floor((et+tt)/2);$[rt]>j?tt=rt:et=rt}return j>=$[tt]?tt:et}}])}(reactExports.PureComponent);_defineProperty$f(Brush,"displayName","Brush");_defineProperty$f(Brush,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var baseEach$1=_baseEach;function baseSome$1(o,i){var _;return baseEach$1(o,function($,j,_e){return _=i($,j,_e),!_}),!!_}var _baseSome=baseSome$1,arraySome=_arraySome,baseIteratee$2=_baseIteratee,baseSome=_baseSome,isArray$1=isArray_1,isIterateeCall$1=_isIterateeCall;function some(o,i,_){var $=isArray$1(o)?arraySome:baseSome;return _&&isIterateeCall$1(o,i,_)&&(i=void 0),$(o,baseIteratee$2(i))}var some_1=some;const some$1=getDefaultExportFromCjs$1(some_1);var ifOverflowMatches=function o(i,_){var $=i.alwaysShow,j=i.ifOverflow;return $&&(j="extendDomain"),j===_},defineProperty=_defineProperty$F;function baseAssignValue$1(o,i,_){i=="__proto__"&&defineProperty?defineProperty(o,i,{configurable:!0,enumerable:!0,value:_,writable:!0}):o[i]=_}var _baseAssignValue=baseAssignValue$1,baseAssignValue=_baseAssignValue,baseForOwn=_baseForOwn,baseIteratee$1=_baseIteratee;function mapValues(o,i){var _={};return i=baseIteratee$1(i),baseForOwn(o,function($,j,_e){baseAssignValue(_,j,i($,j,_e))}),_}var mapValues_1=mapValues;const mapValues$1=getDefaultExportFromCjs$1(mapValues_1);function arrayEvery$1(o,i){for(var _=-1,$=o==null?0:o.length;++_<$;)if(!i(o[_],_,o))return!1;return!0}var _arrayEvery=arrayEvery$1,baseEach=_baseEach;function baseEvery$1(o,i){var _=!0;return baseEach(o,function($,j,_e){return _=!!i($,j,_e),_}),_}var _baseEvery=baseEvery$1,arrayEvery=_arrayEvery,baseEvery=_baseEvery,baseIteratee=_baseIteratee,isArray=isArray_1,isIterateeCall=_isIterateeCall;function every(o,i,_){var $=isArray(o)?arrayEvery:baseEvery;return _&&isIterateeCall(o,i,_)&&(i=void 0),$(o,baseIteratee(i))}var every_1=every;const every$1=getDefaultExportFromCjs$1(every_1);var _excluded$4=["x","y"];function _typeof$d(o){"@babel/helpers - typeof";return _typeof$d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$d(o)}function _extends$a(){return _extends$a=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$a.apply(this,arguments)}function ownKeys$b(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$a(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$b(Object(_),!0).forEach(function($){_defineProperty$e(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$b(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$e(o,i,_){return i=_toPropertyKey$e(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$e(o){var i=_toPrimitive$e(o,"string");return _typeof$d(i)=="symbol"?i:i+""}function _toPrimitive$e(o,i){if(_typeof$d(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$d($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _objectWithoutProperties$4(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$4(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$4(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function typeguardBarRectangleProps(o,i){var _=o.x,$=o.y,j=_objectWithoutProperties$4(o,_excluded$4),_e="".concat(_),et=parseInt(_e,10),tt="".concat($),rt=parseInt(tt,10),nt="".concat(i.height||j.height),it=parseInt(nt,10),st="".concat(i.width||j.width),at=parseInt(st,10);return _objectSpread$a(_objectSpread$a(_objectSpread$a(_objectSpread$a(_objectSpread$a({},i),j),et?{x:et}:{}),rt?{y:rt}:{}),{},{height:it,width:at,name:i.name,radius:i.radius})}function BarRectangle(o){return React$2.createElement(Shape,_extends$a({shapeType:"rectangle",propTransformer:typeguardBarRectangleProps,activeClassName:"recharts-active-bar"},o))}var minPointSizeCallback=function o(i){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function($,j){if(typeof i=="number")return i;var _e=typeof $=="number";return _e?i($,j):(_e||invariant(!1),_)}},_excluded$3=["value","background"],_Bar;function _typeof$c(o){"@babel/helpers - typeof";return _typeof$c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$c(o)}function _objectWithoutProperties$3(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$3(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$3(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _extends$9(){return _extends$9=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$9.apply(this,arguments)}function ownKeys$a(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$9(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$a(Object(_),!0).forEach(function($){_defineProperty$d(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$a(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$a(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$d($.key),$)}}function _createClass$a(o,i,_){return i&&_defineProperties$a(o.prototype,i),_&&_defineProperties$a(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$8(o,i,_){return i=_getPrototypeOf$8(i),_possibleConstructorReturn$8(o,_isNativeReflectConstruct$8()?Reflect.construct(i,_||[],_getPrototypeOf$8(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$8(o,i){if(i&&(_typeof$c(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$8(o)}function _assertThisInitialized$8(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$8(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$8=function(){return!!o})()}function _getPrototypeOf$8(o){return _getPrototypeOf$8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$8(o)}function _inherits$8(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$8(o,i)}function _setPrototypeOf$8(o,i){return _setPrototypeOf$8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$8(o,i)}function _defineProperty$d(o,i,_){return i=_toPropertyKey$d(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$d(o){var i=_toPrimitive$d(o,"string");return _typeof$c(i)=="symbol"?i:i+""}function _toPrimitive$d(o,i){if(_typeof$c(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$c($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var Bar=function(o){function i(){var _;_classCallCheck$a(this,i);for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];return _=_callSuper$8(this,i,[].concat(j)),_defineProperty$d(_,"state",{isAnimationFinished:!1}),_defineProperty$d(_,"id",uniqueId("recharts-bar-")),_defineProperty$d(_,"handleAnimationEnd",function(){var et=_.props.onAnimationEnd;_.setState({isAnimationFinished:!0}),et&&et()}),_defineProperty$d(_,"handleAnimationStart",function(){var et=_.props.onAnimationStart;_.setState({isAnimationFinished:!1}),et&&et()}),_}return _inherits$8(i,o),_createClass$a(i,[{key:"renderRectanglesStatically",value:function($){var j=this,_e=this.props,et=_e.shape,tt=_e.dataKey,rt=_e.activeIndex,nt=_e.activeBar,it=filterProps(this.props,!1);return $&&$.map(function(st,at){var ot=at===rt,lt=ot?nt:et,ct=_objectSpread$9(_objectSpread$9(_objectSpread$9({},it),st),{},{isActive:ot,option:lt,index:at,dataKey:tt,onAnimationStart:j.handleAnimationStart,onAnimationEnd:j.handleAnimationEnd});return React$2.createElement(Layer,_extends$9({className:"recharts-bar-rectangle"},adaptEventsOfChild(j.props,st,at),{key:"rectangle-".concat(st==null?void 0:st.x,"-").concat(st==null?void 0:st.y,"-").concat(st==null?void 0:st.value,"-").concat(at)}),React$2.createElement(BarRectangle,ct))})}},{key:"renderRectanglesWithAnimation",value:function(){var $=this,j=this.props,_e=j.data,et=j.layout,tt=j.isAnimationActive,rt=j.animationBegin,nt=j.animationDuration,it=j.animationEasing,st=j.animationId,at=this.state.prevData;return React$2.createElement(Animate,{begin:rt,duration:nt,isActive:tt,easing:it,from:{t:0},to:{t:1},key:"bar-".concat(st),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ot){var lt=ot.t,ct=_e.map(function(ft,ut){var ht=at&&at[ut];if(ht){var dt=interpolateNumber$2(ht.x,ft.x),mt=interpolateNumber$2(ht.y,ft.y),pt=interpolateNumber$2(ht.width,ft.width),yt=interpolateNumber$2(ht.height,ft.height);return _objectSpread$9(_objectSpread$9({},ft),{},{x:dt(lt),y:mt(lt),width:pt(lt),height:yt(lt)})}if(et==="horizontal"){var gt=interpolateNumber$2(0,ft.height),vt=gt(lt);return _objectSpread$9(_objectSpread$9({},ft),{},{y:ft.y+ft.height-vt,height:vt})}var St=interpolateNumber$2(0,ft.width),At=St(lt);return _objectSpread$9(_objectSpread$9({},ft),{},{width:At})});return React$2.createElement(Layer,null,$.renderRectanglesStatically(ct))})}},{key:"renderRectangles",value:function(){var $=this.props,j=$.data,_e=$.isAnimationActive,et=this.state.prevData;return _e&&j&&j.length&&(!et||!isEqual$1(et,j))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(j)}},{key:"renderBackground",value:function(){var $=this,j=this.props,_e=j.data,et=j.dataKey,tt=j.activeIndex,rt=filterProps(this.props.background,!1);return _e.map(function(nt,it){nt.value;var st=nt.background,at=_objectWithoutProperties$3(nt,_excluded$3);if(!st)return null;var ot=_objectSpread$9(_objectSpread$9(_objectSpread$9(_objectSpread$9(_objectSpread$9({},at),{},{fill:"#eee"},st),rt),adaptEventsOfChild($.props,nt,it)),{},{onAnimationStart:$.handleAnimationStart,onAnimationEnd:$.handleAnimationEnd,dataKey:et,index:it,className:"recharts-bar-background-rectangle"});return React$2.createElement(BarRectangle,_extends$9({key:"background-bar-".concat(it),option:$.props.background,isActive:it===tt},ot))})}},{key:"renderErrorBar",value:function($,j){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var _e=this.props,et=_e.data,tt=_e.xAxis,rt=_e.yAxis,nt=_e.layout,it=_e.children,st=findAllByType(it,ErrorBar);if(!st)return null;var at=nt==="vertical"?et[0].height/2:et[0].width/2,ot=function(ft,ut){var ht=Array.isArray(ft.value)?ft.value[1]:ft.value;return{x:ft.x,y:ft.y,value:ht,errorVal:getValueByDataKey(ft,ut)}},lt={clipPath:$?"url(#clipPath-".concat(j,")"):null};return React$2.createElement(Layer,lt,st.map(function(ct){return React$2.cloneElement(ct,{key:"error-bar-".concat(j,"-").concat(ct.props.dataKey),data:et,xAxis:tt,yAxis:rt,layout:nt,offset:at,dataPointFormatter:ot})}))}},{key:"render",value:function(){var $=this.props,j=$.hide,_e=$.data,et=$.className,tt=$.xAxis,rt=$.yAxis,nt=$.left,it=$.top,st=$.width,at=$.height,ot=$.isAnimationActive,lt=$.background,ct=$.id;if(j||!_e||!_e.length)return null;var ft=this.state.isAnimationFinished,ut=clsx("recharts-bar",et),ht=tt&&tt.allowDataOverflow,dt=rt&&rt.allowDataOverflow,mt=ht||dt,pt=isNil$1(ct)?this.id:ct;return React$2.createElement(Layer,{className:ut},ht||dt?React$2.createElement("defs",null,React$2.createElement("clipPath",{id:"clipPath-".concat(pt)},React$2.createElement("rect",{x:ht?nt:nt-st/2,y:dt?it:it-at/2,width:ht?st:st*2,height:dt?at:at*2}))):null,React$2.createElement(Layer,{className:"recharts-bar-rectangles",clipPath:mt?"url(#clipPath-".concat(pt,")"):null},lt?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(mt,pt),(!ot||ft)&&LabelList.renderCallByParent(this.props,_e))}}],[{key:"getDerivedStateFromProps",value:function($,j){return $.animationId!==j.prevAnimationId?{prevAnimationId:$.animationId,curData:$.data,prevData:j.curData}:$.data!==j.curData?{curData:$.data}:null}}])}(reactExports.PureComponent);_Bar=Bar;_defineProperty$d(Bar,"displayName","Bar");_defineProperty$d(Bar,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Global.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});_defineProperty$d(Bar,"getComposedData",function(o){var i=o.props,_=o.item,$=o.barPosition,j=o.bandSize,_e=o.xAxis,et=o.yAxis,tt=o.xAxisTicks,rt=o.yAxisTicks,nt=o.stackedData,it=o.dataStartIndex,st=o.displayedData,at=o.offset,ot=findPositionOfBar($,_);if(!ot)return null;var lt=i.layout,ct=_.type.defaultProps,ft=ct!==void 0?_objectSpread$9(_objectSpread$9({},ct),_.props):_.props,ut=ft.dataKey,ht=ft.children,dt=ft.minPointSize,mt=lt==="horizontal"?et:_e,pt=nt?mt.scale.domain():null,yt=getBaseValueOfBar({numericAxis:mt}),gt=findAllByType(ht,Cell),vt=st.map(function(St,At){var xt,wt,Ot,Bt,Ft,Pt;nt?xt=truncateByDomain(nt[it+At],pt):(xt=getValueByDataKey(St,ut),Array.isArray(xt)||(xt=[yt,xt]));var Rt=minPointSizeCallback(dt,_Bar.defaultProps.minPointSize)(xt[1],At);if(lt==="horizontal"){var Et,_t=[et.scale(xt[0]),et.scale(xt[1])],Mt=_t[0],Dt=_t[1];wt=getCateCoordinateOfBar({axis:_e,ticks:tt,bandSize:j,offset:ot.offset,entry:St,index:At}),Ot=(Et=Dt??Mt)!==null&&Et!==void 0?Et:void 0,Bt=ot.size;var Lt=Mt-Dt;if(Ft=Number.isNaN(Lt)?0:Lt,Pt={x:wt,y:et.y,width:Bt,height:et.height},Math.abs(Rt)>0&&Math.abs(Ft)<Math.abs(Rt)){var Ct=mathSign(Ft||Rt)*(Math.abs(Rt)-Math.abs(Ft));Ot-=Ct,Ft+=Ct}}else{var kt=[_e.scale(xt[0]),_e.scale(xt[1])],jt=kt[0],Vt=kt[1];if(wt=jt,Ot=getCateCoordinateOfBar({axis:et,ticks:rt,bandSize:j,offset:ot.offset,entry:St,index:At}),Bt=Vt-jt,Ft=ot.size,Pt={x:_e.x,y:Ot,width:_e.width,height:Ft},Math.abs(Rt)>0&&Math.abs(Bt)<Math.abs(Rt)){var zt=mathSign(Bt||Rt)*(Math.abs(Rt)-Math.abs(Bt));Bt+=zt}}return _objectSpread$9(_objectSpread$9(_objectSpread$9({},St),{},{x:wt,y:Ot,width:Bt,height:Ft,value:nt?xt:xt[1],payload:St,background:Pt},gt&&gt[At]&&gt[At].props),{},{tooltipPayload:[getTooltipItem(_,St)],tooltipPosition:{x:wt+Bt/2,y:Ot+Ft/2}})});return _objectSpread$9({data:vt,layout:lt},at)});function _typeof$b(o){"@babel/helpers - typeof";return _typeof$b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$b(o)}function _classCallCheck$9(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$c($.key),$)}}function _createClass$9(o,i,_){return i&&_defineProperties$9(o.prototype,i),_&&_defineProperties$9(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function ownKeys$9(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$8(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$9(Object(_),!0).forEach(function($){_defineProperty$c(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$9(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$c(o,i,_){return i=_toPropertyKey$c(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$c(o){var i=_toPrimitive$c(o,"string");return _typeof$b(i)=="symbol"?i:i+""}function _toPrimitive$c(o,i){if(_typeof$b(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$b($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var formatAxisMap=function o(i,_,$,j,_e){var et=i.width,tt=i.height,rt=i.layout,nt=i.children,it=Object.keys(_),st={left:$.left,leftMirror:$.left,right:et-$.right,rightMirror:et-$.right,top:$.top,topMirror:$.top,bottom:tt-$.bottom,bottomMirror:tt-$.bottom},at=!!findChildByType(nt,Bar);return it.reduce(function(ot,lt){var ct=_[lt],ft=ct.orientation,ut=ct.domain,ht=ct.padding,dt=ht===void 0?{}:ht,mt=ct.mirror,pt=ct.reversed,yt="".concat(ft).concat(mt?"Mirror":""),gt,vt,St,At,xt;if(ct.type==="number"&&(ct.padding==="gap"||ct.padding==="no-gap")){var wt=ut[1]-ut[0],Ot=1/0,Bt=ct.categoricalDomain.sort(compareValues);if(Bt.forEach(function(kt,jt){jt>0&&(Ot=Math.min((kt||0)-(Bt[jt-1]||0),Ot))}),Number.isFinite(Ot)){var Ft=Ot/wt,Pt=ct.layout==="vertical"?$.height:$.width;if(ct.padding==="gap"&&(gt=Ft*Pt/2),ct.padding==="no-gap"){var Rt=getPercentValue(i.barCategoryGap,Ft*Pt),Et=Ft*Pt/2;gt=Et-Rt-(Et-Rt)/Pt*Rt}}}j==="xAxis"?vt=[$.left+(dt.left||0)+(gt||0),$.left+$.width-(dt.right||0)-(gt||0)]:j==="yAxis"?vt=rt==="horizontal"?[$.top+$.height-(dt.bottom||0),$.top+(dt.top||0)]:[$.top+(dt.top||0)+(gt||0),$.top+$.height-(dt.bottom||0)-(gt||0)]:vt=ct.range,pt&&(vt=[vt[1],vt[0]]);var _t=parseScale(ct,_e,at),Mt=_t.scale,Dt=_t.realScaleType;Mt.domain(ut).range(vt),checkDomainOfScale(Mt);var Lt=getTicksOfScale(Mt,_objectSpread$8(_objectSpread$8({},ct),{},{realScaleType:Dt}));j==="xAxis"?(xt=ft==="top"&&!mt||ft==="bottom"&&mt,St=$.left,At=st[yt]-xt*ct.height):j==="yAxis"&&(xt=ft==="left"&&!mt||ft==="right"&&mt,St=st[yt]-xt*ct.width,At=$.top);var Ct=_objectSpread$8(_objectSpread$8(_objectSpread$8({},ct),Lt),{},{realScaleType:Dt,x:St,y:At,scale:Mt,width:j==="xAxis"?$.width:ct.width,height:j==="yAxis"?$.height:ct.height});return Ct.bandSize=getBandSizeOfAxis(Ct,Lt),!ct.hide&&j==="xAxis"?st[yt]+=(xt?-1:1)*Ct.height:ct.hide||(st[yt]+=(xt?-1:1)*Ct.width),_objectSpread$8(_objectSpread$8({},ot),{},_defineProperty$c({},lt,Ct))},{})},rectWithPoints=function o(i,_){var $=i.x,j=i.y,_e=_.x,et=_.y;return{x:Math.min($,_e),y:Math.min(j,et),width:Math.abs(_e-$),height:Math.abs(et-j)}},rectWithCoords=function o(i){var _=i.x1,$=i.y1,j=i.x2,_e=i.y2;return rectWithPoints({x:_,y:$},{x:j,y:_e})},ScaleHelper=function(){function o(i){_classCallCheck$9(this,o),this.scale=i}return _createClass$9(o,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(_){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},j=$.bandAware,_e=$.position;if(_!==void 0){if(_e)switch(_e){case"start":return this.scale(_);case"middle":{var et=this.bandwidth?this.bandwidth()/2:0;return this.scale(_)+et}case"end":{var tt=this.bandwidth?this.bandwidth():0;return this.scale(_)+tt}default:return this.scale(_)}if(j){var rt=this.bandwidth?this.bandwidth()/2:0;return this.scale(_)+rt}return this.scale(_)}}},{key:"isInRange",value:function(_){var $=this.range(),j=$[0],_e=$[$.length-1];return j<=_e?_>=j&&_<=_e:_>=_e&&_<=j}}],[{key:"create",value:function(_){return new o(_)}}])}();_defineProperty$c(ScaleHelper,"EPS",1e-4);var createLabeledScales=function o(i){var _=Object.keys(i).reduce(function($,j){return _objectSpread$8(_objectSpread$8({},$),{},_defineProperty$c({},j,ScaleHelper.create(i[j])))},{});return _objectSpread$8(_objectSpread$8({},_),{},{apply:function(j){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},et=_e.bandAware,tt=_e.position;return mapValues$1(j,function(rt,nt){return _[nt].apply(rt,{bandAware:et,position:tt})})},isInRange:function(j){return every$1(j,function(_e,et){return _[et].isInRange(_e)})}})};function normalizeAngle(o){return(o%180+180)%180}var getAngledRectangleWidth=function o(i){var _=i.width,$=i.height,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_e=normalizeAngle(j),et=_e*Math.PI/180,tt=Math.atan($/_),rt=et>tt&&et<Math.PI-tt?$/Math.sin(et):_/Math.cos(et);return Math.abs(rt)},calculateViewBox=memoize$3(function(o){return{x:o.left,y:o.top,width:o.width,height:o.height}},function(o){return["l",o.left,"t",o.top,"w",o.width,"h",o.height].join("")}),XAxisContext=reactExports.createContext(void 0),YAxisContext=reactExports.createContext(void 0),ViewBoxContext=reactExports.createContext(void 0),OffsetContext=reactExports.createContext({}),ClipPathIdContext=reactExports.createContext(void 0),ChartHeightContext=reactExports.createContext(0),ChartWidthContext=reactExports.createContext(0),ChartLayoutContextProvider=function o(i){var _=i.state,$=_.xAxisMap,j=_.yAxisMap,_e=_.offset,et=i.clipPathId,tt=i.children,rt=i.width,nt=i.height,it=calculateViewBox(_e);return React$2.createElement(XAxisContext.Provider,{value:$},React$2.createElement(YAxisContext.Provider,{value:j},React$2.createElement(OffsetContext.Provider,{value:_e},React$2.createElement(ViewBoxContext.Provider,{value:it},React$2.createElement(ClipPathIdContext.Provider,{value:et},React$2.createElement(ChartHeightContext.Provider,{value:nt},React$2.createElement(ChartWidthContext.Provider,{value:rt},tt)))))))},useClipPathId=function o(){return reactExports.useContext(ClipPathIdContext)},useXAxisOrThrow=function o(i){var _=reactExports.useContext(XAxisContext);_==null&&invariant(!1);var $=_[i];return $==null&&invariant(!1),$},useYAxisOrThrow=function o(i){var _=reactExports.useContext(YAxisContext);_==null&&invariant(!1);var $=_[i];return $==null&&invariant(!1),$},useViewBox=function o(){var i=reactExports.useContext(ViewBoxContext);return i},useChartWidth=function o(){return reactExports.useContext(ChartWidthContext)},useChartHeight=function o(){return reactExports.useContext(ChartHeightContext)};function _typeof$a(o){"@babel/helpers - typeof";return _typeof$a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$a(o)}function _classCallCheck$8(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$b($.key),$)}}function _createClass$8(o,i,_){return i&&_defineProperties$8(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$7(o,i,_){return i=_getPrototypeOf$7(i),_possibleConstructorReturn$7(o,_isNativeReflectConstruct$7()?Reflect.construct(i,_||[],_getPrototypeOf$7(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$7(o,i){if(i&&(_typeof$a(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$7(o)}function _assertThisInitialized$7(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$7(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$7=function(){return!!o})()}function _getPrototypeOf$7(o){return _getPrototypeOf$7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$7(o)}function _inherits$7(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$7(o,i)}function _setPrototypeOf$7(o,i){return _setPrototypeOf$7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$7(o,i)}function ownKeys$8(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$7(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$8(Object(_),!0).forEach(function($){_defineProperty$b(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$8(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$b(o,i,_){return i=_toPropertyKey$b(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$b(o){var i=_toPrimitive$b(o,"string");return _typeof$a(i)=="symbol"?i:i+""}function _toPrimitive$b(o,i){if(_typeof$a(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$a($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function _slicedToArray$1(o,i){return _arrayWithHoles$1(o)||_iterableToArrayLimit$1(o,i)||_unsupportedIterableToArray$3(o,i)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$3(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$3(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$3(o,i)}}function _arrayLikeToArray$3(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _iterableToArrayLimit$1(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles$1(o){if(Array.isArray(o))return o}function _extends$8(){return _extends$8=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$8.apply(this,arguments)}var renderLine=function o(i,_){var $;return React$2.isValidElement(i)?$=React$2.cloneElement(i,_):isFunction$3(i)?$=i(_):$=React$2.createElement("line",_extends$8({},_,{className:"recharts-reference-line-line"})),$},getEndPoints=function o(i,_,$,j,_e,et,tt,rt,nt){var it=_e.x,st=_e.y,at=_e.width,ot=_e.height;if($){var lt=nt.y,ct=i.y.apply(lt,{position:et});if(ifOverflowMatches(nt,"discard")&&!i.y.isInRange(ct))return null;var ft=[{x:it+at,y:ct},{x:it,y:ct}];return rt==="left"?ft.reverse():ft}if(_){var ut=nt.x,ht=i.x.apply(ut,{position:et});if(ifOverflowMatches(nt,"discard")&&!i.x.isInRange(ht))return null;var dt=[{x:ht,y:st+ot},{x:ht,y:st}];return tt==="top"?dt.reverse():dt}if(j){var mt=nt.segment,pt=mt.map(function(yt){return i.apply(yt,{position:et})});return ifOverflowMatches(nt,"discard")&&some$1(pt,function(yt){return!i.isInRange(yt)})?null:pt}return null};function ReferenceLineImpl(o){var i=o.x,_=o.y,$=o.segment,j=o.xAxisId,_e=o.yAxisId,et=o.shape,tt=o.className,rt=o.alwaysShow,nt=useClipPathId(),it=useXAxisOrThrow(j),st=useYAxisOrThrow(_e),at=useViewBox();if(!nt||!at)return null;warn(rt===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var ot=createLabeledScales({x:it.scale,y:st.scale}),lt=isNumOrStr(i),ct=isNumOrStr(_),ft=$&&$.length===2,ut=getEndPoints(ot,lt,ct,ft,at,o.position,it.orientation,st.orientation,o);if(!ut)return null;var ht=_slicedToArray$1(ut,2),dt=ht[0],mt=dt.x,pt=dt.y,yt=ht[1],gt=yt.x,vt=yt.y,St=ifOverflowMatches(o,"hidden")?"url(#".concat(nt,")"):void 0,At=_objectSpread$7(_objectSpread$7({clipPath:St},filterProps(o,!0)),{},{x1:mt,y1:pt,x2:gt,y2:vt});return React$2.createElement(Layer,{className:clsx("recharts-reference-line",tt)},renderLine(et,At),Label.renderCallByParent(o,rectWithCoords({x1:mt,y1:pt,x2:gt,y2:vt})))}var ReferenceLine=function(o){function i(){return _classCallCheck$8(this,i),_callSuper$7(this,i,arguments)}return _inherits$7(i,o),_createClass$8(i,[{key:"render",value:function(){return React$2.createElement(ReferenceLineImpl,this.props)}}])}(React$2.Component);_defineProperty$b(ReferenceLine,"displayName","ReferenceLine");_defineProperty$b(ReferenceLine,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function _extends$7(){return _extends$7=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$7.apply(this,arguments)}function _typeof$9(o){"@babel/helpers - typeof";return _typeof$9=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$9(o)}function ownKeys$7(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$6(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$7(Object(_),!0).forEach(function($){_defineProperty$a(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$7(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$7(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$a($.key),$)}}function _createClass$7(o,i,_){return i&&_defineProperties$7(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$6(o,i,_){return i=_getPrototypeOf$6(i),_possibleConstructorReturn$6(o,_isNativeReflectConstruct$6()?Reflect.construct(i,_||[],_getPrototypeOf$6(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$6(o,i){if(i&&(_typeof$9(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$6(o)}function _assertThisInitialized$6(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$6(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$6=function(){return!!o})()}function _getPrototypeOf$6(o){return _getPrototypeOf$6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$6(o)}function _inherits$6(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$6(o,i)}function _setPrototypeOf$6(o,i){return _setPrototypeOf$6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$6(o,i)}function _defineProperty$a(o,i,_){return i=_toPropertyKey$a(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$a(o){var i=_toPrimitive$a(o,"string");return _typeof$9(i)=="symbol"?i:i+""}function _toPrimitive$a(o,i){if(_typeof$9(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$9($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var getCoordinate=function o(i){var _=i.x,$=i.y,j=i.xAxis,_e=i.yAxis,et=createLabeledScales({x:j.scale,y:_e.scale}),tt=et.apply({x:_,y:$},{bandAware:!0});return ifOverflowMatches(i,"discard")&&!et.isInRange(tt)?null:tt},ReferenceDot=function(o){function i(){return _classCallCheck$7(this,i),_callSuper$6(this,i,arguments)}return _inherits$6(i,o),_createClass$7(i,[{key:"render",value:function(){var $=this.props,j=$.x,_e=$.y,et=$.r,tt=$.alwaysShow,rt=$.clipPathId,nt=isNumOrStr(j),it=isNumOrStr(_e);if(warn(tt===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!nt||!it)return null;var st=getCoordinate(this.props);if(!st)return null;var at=st.x,ot=st.y,lt=this.props,ct=lt.shape,ft=lt.className,ut=ifOverflowMatches(this.props,"hidden")?"url(#".concat(rt,")"):void 0,ht=_objectSpread$6(_objectSpread$6({clipPath:ut},filterProps(this.props,!0)),{},{cx:at,cy:ot});return React$2.createElement(Layer,{className:clsx("recharts-reference-dot",ft)},i.renderDot(ct,ht),Label.renderCallByParent(this.props,{x:at-et,y:ot-et,width:2*et,height:2*et}))}}])}(React$2.Component);_defineProperty$a(ReferenceDot,"displayName","ReferenceDot");_defineProperty$a(ReferenceDot,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});_defineProperty$a(ReferenceDot,"renderDot",function(o,i){var _;return React$2.isValidElement(o)?_=React$2.cloneElement(o,i):isFunction$3(o)?_=o(i):_=React$2.createElement(Dot,_extends$7({},i,{cx:i.cx,cy:i.cy,className:"recharts-reference-dot-dot"})),_});function _extends$6(){return _extends$6=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$6.apply(this,arguments)}function _typeof$8(o){"@babel/helpers - typeof";return _typeof$8=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$8(o)}function ownKeys$6(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$5(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$6(Object(_),!0).forEach(function($){_defineProperty$9(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$6(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _classCallCheck$6(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$9($.key),$)}}function _createClass$6(o,i,_){return i&&_defineProperties$6(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$5(o,i,_){return i=_getPrototypeOf$5(i),_possibleConstructorReturn$5(o,_isNativeReflectConstruct$5()?Reflect.construct(i,_||[],_getPrototypeOf$5(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$5(o,i){if(i&&(_typeof$8(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$5(o)}function _assertThisInitialized$5(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$5(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$5=function(){return!!o})()}function _getPrototypeOf$5(o){return _getPrototypeOf$5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$5(o)}function _inherits$5(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$5(o,i)}function _setPrototypeOf$5(o,i){return _setPrototypeOf$5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$5(o,i)}function _defineProperty$9(o,i,_){return i=_toPropertyKey$9(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$9(o){var i=_toPrimitive$9(o,"string");return _typeof$8(i)=="symbol"?i:i+""}function _toPrimitive$9(o,i){if(_typeof$8(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$8($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var getRect=function o(i,_,$,j,_e){var et=_e.x1,tt=_e.x2,rt=_e.y1,nt=_e.y2,it=_e.xAxis,st=_e.yAxis;if(!it||!st)return null;var at=createLabeledScales({x:it.scale,y:st.scale}),ot={x:i?at.x.apply(et,{position:"start"}):at.x.rangeMin,y:$?at.y.apply(rt,{position:"start"}):at.y.rangeMin},lt={x:_?at.x.apply(tt,{position:"end"}):at.x.rangeMax,y:j?at.y.apply(nt,{position:"end"}):at.y.rangeMax};return ifOverflowMatches(_e,"discard")&&(!at.isInRange(ot)||!at.isInRange(lt))?null:rectWithPoints(ot,lt)},ReferenceArea=function(o){function i(){return _classCallCheck$6(this,i),_callSuper$5(this,i,arguments)}return _inherits$5(i,o),_createClass$6(i,[{key:"render",value:function(){var $=this.props,j=$.x1,_e=$.x2,et=$.y1,tt=$.y2,rt=$.className,nt=$.alwaysShow,it=$.clipPathId;warn(nt===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var st=isNumOrStr(j),at=isNumOrStr(_e),ot=isNumOrStr(et),lt=isNumOrStr(tt),ct=this.props.shape;if(!st&&!at&&!ot&&!lt&&!ct)return null;var ft=getRect(st,at,ot,lt,this.props);if(!ft&&!ct)return null;var ut=ifOverflowMatches(this.props,"hidden")?"url(#".concat(it,")"):void 0;return React$2.createElement(Layer,{className:clsx("recharts-reference-area",rt)},i.renderRect(ct,_objectSpread$5(_objectSpread$5({clipPath:ut},filterProps(this.props,!0)),ft)),Label.renderCallByParent(this.props,ft))}}])}(React$2.Component);_defineProperty$9(ReferenceArea,"displayName","ReferenceArea");_defineProperty$9(ReferenceArea,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});_defineProperty$9(ReferenceArea,"renderRect",function(o,i){var _;return React$2.isValidElement(o)?_=React$2.cloneElement(o,i):isFunction$3(o)?_=o(i):_=React$2.createElement(Rectangle,_extends$6({},i,{className:"recharts-reference-area-rect"})),_});function getEveryNthWithCondition(o,i,_){if(i<1)return[];if(i===1&&_===void 0)return o;for(var $=[],j=0;j<o.length;j+=i)$.push(o[j]);return $}function getAngledTickWidth(o,i,_){var $={width:o.width+i.width,height:o.height+i.height};return getAngledRectangleWidth($,_)}function getTickBoundaries(o,i,_){var $=_==="width",j=o.x,_e=o.y,et=o.width,tt=o.height;return i===1?{start:$?j:_e,end:$?j+et:_e+tt}:{start:$?j+et:_e+tt,end:$?j:_e}}function isVisible(o,i,_,$,j){if(o*i<o*$||o*i>o*j)return!1;var _e=_();return o*(i-o*_e/2-$)>=0&&o*(i+o*_e/2-j)<=0}function getNumberIntervalTicks(o,i){return getEveryNthWithCondition(o,i+1)}function getEquidistantTicks(o,i,_,$,j){for(var _e=($||[]).slice(),et=i.start,tt=i.end,rt=0,nt=1,it=et,st=function(){var lt=$==null?void 0:$[rt];if(lt===void 0)return{v:getEveryNthWithCondition($,nt)};var ct=rt,ft,ut=function(){return ft===void 0&&(ft=_(lt,ct)),ft},ht=lt.coordinate,dt=rt===0||isVisible(o,ht,ut,it,tt);dt||(rt=0,it=et,nt+=1),dt&&(it=ht+o*(ut()/2+j),rt+=nt)},at;nt<=_e.length;)if(at=st(),at)return at.v;return[]}function _typeof$7(o){"@babel/helpers - typeof";return _typeof$7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$7(o)}function ownKeys$5(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$4(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$5(Object(_),!0).forEach(function($){_defineProperty$8(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$5(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$8(o,i,_){return i=_toPropertyKey$8(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$8(o){var i=_toPrimitive$8(o,"string");return _typeof$7(i)=="symbol"?i:i+""}function _toPrimitive$8(o,i){if(_typeof$7(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$7($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function getTicksEnd(o,i,_,$,j){for(var _e=($||[]).slice(),et=_e.length,tt=i.start,rt=i.end,nt=function(at){var ot=_e[at],lt,ct=function(){return lt===void 0&&(lt=_(ot,at)),lt};if(at===et-1){var ft=o*(ot.coordinate+o*ct()/2-rt);_e[at]=ot=_objectSpread$4(_objectSpread$4({},ot),{},{tickCoord:ft>0?ot.coordinate-ft*o:ot.coordinate})}else _e[at]=ot=_objectSpread$4(_objectSpread$4({},ot),{},{tickCoord:ot.coordinate});var ut=isVisible(o,ot.tickCoord,ct,tt,rt);ut&&(rt=ot.tickCoord-o*(ct()/2+j),_e[at]=_objectSpread$4(_objectSpread$4({},ot),{},{isShow:!0}))},it=et-1;it>=0;it--)nt(it);return _e}function getTicksStart(o,i,_,$,j,_e){var et=($||[]).slice(),tt=et.length,rt=i.start,nt=i.end;if(_e){var it=$[tt-1],st=_(it,tt-1),at=o*(it.coordinate+o*st/2-nt);et[tt-1]=it=_objectSpread$4(_objectSpread$4({},it),{},{tickCoord:at>0?it.coordinate-at*o:it.coordinate});var ot=isVisible(o,it.tickCoord,function(){return st},rt,nt);ot&&(nt=it.tickCoord-o*(st/2+j),et[tt-1]=_objectSpread$4(_objectSpread$4({},it),{},{isShow:!0}))}for(var lt=_e?tt-1:tt,ct=function(ht){var dt=et[ht],mt,pt=function(){return mt===void 0&&(mt=_(dt,ht)),mt};if(ht===0){var yt=o*(dt.coordinate-o*pt()/2-rt);et[ht]=dt=_objectSpread$4(_objectSpread$4({},dt),{},{tickCoord:yt<0?dt.coordinate-yt*o:dt.coordinate})}else et[ht]=dt=_objectSpread$4(_objectSpread$4({},dt),{},{tickCoord:dt.coordinate});var gt=isVisible(o,dt.tickCoord,pt,rt,nt);gt&&(rt=dt.tickCoord+o*(pt()/2+j),et[ht]=_objectSpread$4(_objectSpread$4({},dt),{},{isShow:!0}))},ft=0;ft<lt;ft++)ct(ft);return et}function getTicks(o,i,_){var $=o.tick,j=o.ticks,_e=o.viewBox,et=o.minTickGap,tt=o.orientation,rt=o.interval,nt=o.tickFormatter,it=o.unit,st=o.angle;if(!j||!j.length||!$)return[];if(isNumber(rt)||Global.isSsr)return getNumberIntervalTicks(j,typeof rt=="number"&&isNumber(rt)?rt:0);var at=[],ot=tt==="top"||tt==="bottom"?"width":"height",lt=it&&ot==="width"?getStringSize(it,{fontSize:i,letterSpacing:_}):{width:0,height:0},ct=function(dt,mt){var pt=isFunction$3(nt)?nt(dt.value,mt):dt.value;return ot==="width"?getAngledTickWidth(getStringSize(pt,{fontSize:i,letterSpacing:_}),lt,st):getStringSize(pt,{fontSize:i,letterSpacing:_})[ot]},ft=j.length>=2?mathSign(j[1].coordinate-j[0].coordinate):1,ut=getTickBoundaries(_e,ft,ot);return rt==="equidistantPreserveStart"?getEquidistantTicks(ft,ut,ct,j,et):(rt==="preserveStart"||rt==="preserveStartEnd"?at=getTicksStart(ft,ut,ct,j,et,rt==="preserveStartEnd"):at=getTicksEnd(ft,ut,ct,j,et),at.filter(function(ht){return ht.isShow}))}var _excluded$2=["viewBox"],_excluded2$2=["viewBox"],_excluded3=["ticks"];function _typeof$6(o){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$6(o)}function _extends$5(){return _extends$5=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$5.apply(this,arguments)}function ownKeys$4(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$3(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$4(Object(_),!0).forEach(function($){_defineProperty$7(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$4(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _objectWithoutProperties$2(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$2(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$2(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _classCallCheck$5(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$7($.key),$)}}function _createClass$5(o,i,_){return i&&_defineProperties$5(o.prototype,i),_&&_defineProperties$5(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$4(o,i,_){return i=_getPrototypeOf$4(i),_possibleConstructorReturn$4(o,_isNativeReflectConstruct$4()?Reflect.construct(i,_||[],_getPrototypeOf$4(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$4(o,i){if(i&&(_typeof$6(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$4(o)}function _assertThisInitialized$4(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$4(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$4=function(){return!!o})()}function _getPrototypeOf$4(o){return _getPrototypeOf$4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$4(o)}function _inherits$4(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$4(o,i)}function _setPrototypeOf$4(o,i){return _setPrototypeOf$4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$4(o,i)}function _defineProperty$7(o,i,_){return i=_toPropertyKey$7(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$7(o){var i=_toPrimitive$7(o,"string");return _typeof$6(i)=="symbol"?i:i+""}function _toPrimitive$7(o,i){if(_typeof$6(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$6($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var CartesianAxis=function(o){function i(_){var $;return _classCallCheck$5(this,i),$=_callSuper$4(this,i,[_]),$.state={fontSize:"",letterSpacing:""},$}return _inherits$4(i,o),_createClass$5(i,[{key:"shouldComponentUpdate",value:function($,j){var _e=$.viewBox,et=_objectWithoutProperties$2($,_excluded$2),tt=this.props,rt=tt.viewBox,nt=_objectWithoutProperties$2(tt,_excluded2$2);return!shallowEqual(_e,rt)||!shallowEqual(et,nt)||!shallowEqual(j,this.state)}},{key:"componentDidMount",value:function(){var $=this.layerReference;if($){var j=$.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];j&&this.setState({fontSize:window.getComputedStyle(j).fontSize,letterSpacing:window.getComputedStyle(j).letterSpacing})}}},{key:"getTickLineCoord",value:function($){var j=this.props,_e=j.x,et=j.y,tt=j.width,rt=j.height,nt=j.orientation,it=j.tickSize,st=j.mirror,at=j.tickMargin,ot,lt,ct,ft,ut,ht,dt=st?-1:1,mt=$.tickSize||it,pt=isNumber($.tickCoord)?$.tickCoord:$.coordinate;switch(nt){case"top":ot=lt=$.coordinate,ft=et+ +!st*rt,ct=ft-dt*mt,ht=ct-dt*at,ut=pt;break;case"left":ct=ft=$.coordinate,lt=_e+ +!st*tt,ot=lt-dt*mt,ut=ot-dt*at,ht=pt;break;case"right":ct=ft=$.coordinate,lt=_e+ +st*tt,ot=lt+dt*mt,ut=ot+dt*at,ht=pt;break;default:ot=lt=$.coordinate,ft=et+ +st*rt,ct=ft+dt*mt,ht=ct+dt*at,ut=pt;break}return{line:{x1:ot,y1:ct,x2:lt,y2:ft},tick:{x:ut,y:ht}}}},{key:"getTickTextAnchor",value:function(){var $=this.props,j=$.orientation,_e=$.mirror,et;switch(j){case"left":et=_e?"start":"end";break;case"right":et=_e?"end":"start";break;default:et="middle";break}return et}},{key:"getTickVerticalAnchor",value:function(){var $=this.props,j=$.orientation,_e=$.mirror,et="end";switch(j){case"left":case"right":et="middle";break;case"top":et=_e?"start":"end";break;default:et=_e?"end":"start";break}return et}},{key:"renderAxisLine",value:function(){var $=this.props,j=$.x,_e=$.y,et=$.width,tt=$.height,rt=$.orientation,nt=$.mirror,it=$.axisLine,st=_objectSpread$3(_objectSpread$3(_objectSpread$3({},filterProps(this.props,!1)),filterProps(it,!1)),{},{fill:"none"});if(rt==="top"||rt==="bottom"){var at=+(rt==="top"&&!nt||rt==="bottom"&&nt);st=_objectSpread$3(_objectSpread$3({},st),{},{x1:j,y1:_e+at*tt,x2:j+et,y2:_e+at*tt})}else{var ot=+(rt==="left"&&!nt||rt==="right"&&nt);st=_objectSpread$3(_objectSpread$3({},st),{},{x1:j+ot*et,y1:_e,x2:j+ot*et,y2:_e+tt})}return React$2.createElement("line",_extends$5({},st,{className:clsx("recharts-cartesian-axis-line",get$4(it,"className"))}))}},{key:"renderTicks",value:function($,j,_e){var et=this,tt=this.props,rt=tt.tickLine,nt=tt.stroke,it=tt.tick,st=tt.tickFormatter,at=tt.unit,ot=getTicks(_objectSpread$3(_objectSpread$3({},this.props),{},{ticks:$}),j,_e),lt=this.getTickTextAnchor(),ct=this.getTickVerticalAnchor(),ft=filterProps(this.props,!1),ut=filterProps(it,!1),ht=_objectSpread$3(_objectSpread$3({},ft),{},{fill:"none"},filterProps(rt,!1)),dt=ot.map(function(mt,pt){var yt=et.getTickLineCoord(mt),gt=yt.line,vt=yt.tick,St=_objectSpread$3(_objectSpread$3(_objectSpread$3(_objectSpread$3({textAnchor:lt,verticalAnchor:ct},ft),{},{stroke:"none",fill:nt},ut),vt),{},{index:pt,payload:mt,visibleTicksCount:ot.length,tickFormatter:st});return React$2.createElement(Layer,_extends$5({className:"recharts-cartesian-axis-tick",key:"tick-".concat(mt.value,"-").concat(mt.coordinate,"-").concat(mt.tickCoord)},adaptEventsOfChild(et.props,mt,pt)),rt&&React$2.createElement("line",_extends$5({},ht,gt,{className:clsx("recharts-cartesian-axis-tick-line",get$4(rt,"className"))})),it&&i.renderTickItem(it,St,"".concat(isFunction$3(st)?st(mt.value,pt):mt.value).concat(at||"")))});return React$2.createElement("g",{className:"recharts-cartesian-axis-ticks"},dt)}},{key:"render",value:function(){var $=this,j=this.props,_e=j.axisLine,et=j.width,tt=j.height,rt=j.ticksGenerator,nt=j.className,it=j.hide;if(it)return null;var st=this.props,at=st.ticks,ot=_objectWithoutProperties$2(st,_excluded3),lt=at;return isFunction$3(rt)&&(lt=at&&at.length>0?rt(this.props):rt(ot)),et<=0||tt<=0||!lt||!lt.length?null:React$2.createElement(Layer,{className:clsx("recharts-cartesian-axis",nt),ref:function(ft){$.layerReference=ft}},_e&&this.renderAxisLine(),this.renderTicks(lt,this.state.fontSize,this.state.letterSpacing),Label.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function($,j,_e){var et;return React$2.isValidElement($)?et=React$2.cloneElement($,j):isFunction$3($)?et=$(j):et=React$2.createElement(Text,_extends$5({},j,{className:"recharts-cartesian-axis-tick-value"}),_e),et}}])}(reactExports.Component);_defineProperty$7(CartesianAxis,"displayName","CartesianAxis");_defineProperty$7(CartesianAxis,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var _excluded$1=["type","layout","connectNulls","ref"],_excluded2$1=["key"];function _typeof$5(o){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$5(o)}function _objectWithoutProperties$1(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose$1(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose$1(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$4.apply(this,arguments)}function ownKeys$3(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$2(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$3(Object(_),!0).forEach(function($){_defineProperty$6(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$3(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _toConsumableArray$2(o){return _arrayWithoutHoles$2(o)||_iterableToArray$2(o)||_unsupportedIterableToArray$2(o)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$2(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$2(o,i)}}function _iterableToArray$2(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$2(o){if(Array.isArray(o))return _arrayLikeToArray$2(o)}function _arrayLikeToArray$2(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function _classCallCheck$4(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$6($.key),$)}}function _createClass$4(o,i,_){return i&&_defineProperties$4(o.prototype,i),_&&_defineProperties$4(o,_),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$3(o,i,_){return i=_getPrototypeOf$3(i),_possibleConstructorReturn$3(o,_isNativeReflectConstruct$3()?Reflect.construct(i,_||[],_getPrototypeOf$3(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$3(o,i){if(i&&(_typeof$5(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(o)}function _assertThisInitialized$3(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$3(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$3=function(){return!!o})()}function _getPrototypeOf$3(o){return _getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$3(o)}function _inherits$3(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$3(o,i)}function _setPrototypeOf$3(o,i){return _setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$3(o,i)}function _defineProperty$6(o,i,_){return i=_toPropertyKey$6(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$6(o){var i=_toPrimitive$6(o,"string");return _typeof$5(i)=="symbol"?i:i+""}function _toPrimitive$6(o,i){if(_typeof$5(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$5($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var Line=function(o){function i(){var _;_classCallCheck$4(this,i);for(var $=arguments.length,j=new Array($),_e=0;_e<$;_e++)j[_e]=arguments[_e];return _=_callSuper$3(this,i,[].concat(j)),_defineProperty$6(_,"state",{isAnimationFinished:!0,totalLength:0}),_defineProperty$6(_,"generateSimpleStrokeDasharray",function(et,tt){return"".concat(tt,"px ").concat(et-tt,"px")}),_defineProperty$6(_,"getStrokeDasharray",function(et,tt,rt){var nt=rt.reduce(function(ut,ht){return ut+ht});if(!nt)return _.generateSimpleStrokeDasharray(tt,et);for(var it=Math.floor(et/nt),st=et%nt,at=tt-et,ot=[],lt=0,ct=0;lt<rt.length;ct+=rt[lt],++lt)if(ct+rt[lt]>st){ot=[].concat(_toConsumableArray$2(rt.slice(0,lt)),[st-ct]);break}var ft=ot.length%2===0?[0,at]:[at];return[].concat(_toConsumableArray$2(i.repeat(rt,it)),_toConsumableArray$2(ot),ft).map(function(ut){return"".concat(ut,"px")}).join(", ")}),_defineProperty$6(_,"id",uniqueId("recharts-line-")),_defineProperty$6(_,"pathRef",function(et){_.mainCurve=et}),_defineProperty$6(_,"handleAnimationEnd",function(){_.setState({isAnimationFinished:!0}),_.props.onAnimationEnd&&_.props.onAnimationEnd()}),_defineProperty$6(_,"handleAnimationStart",function(){_.setState({isAnimationFinished:!1}),_.props.onAnimationStart&&_.props.onAnimationStart()}),_}return _inherits$3(i,o),_createClass$4(i,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var $=this.getTotalLength();this.setState({totalLength:$})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var $=this.getTotalLength();$!==this.state.totalLength&&this.setState({totalLength:$})}}},{key:"getTotalLength",value:function(){var $=this.mainCurve;try{return $&&$.getTotalLength&&$.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function($,j){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var _e=this.props,et=_e.points,tt=_e.xAxis,rt=_e.yAxis,nt=_e.layout,it=_e.children,st=findAllByType(it,ErrorBar);if(!st)return null;var at=function(ct,ft){return{x:ct.x,y:ct.y,value:ct.value,errorVal:getValueByDataKey(ct.payload,ft)}},ot={clipPath:$?"url(#clipPath-".concat(j,")"):null};return React$2.createElement(Layer,ot,st.map(function(lt){return React$2.cloneElement(lt,{key:"bar-".concat(lt.props.dataKey),data:et,xAxis:tt,yAxis:rt,layout:nt,dataPointFormatter:at})}))}},{key:"renderDots",value:function($,j,_e){var et=this.props.isAnimationActive;if(et&&!this.state.isAnimationFinished)return null;var tt=this.props,rt=tt.dot,nt=tt.points,it=tt.dataKey,st=filterProps(this.props,!1),at=filterProps(rt,!0),ot=nt.map(function(ct,ft){var ut=_objectSpread$2(_objectSpread$2(_objectSpread$2({key:"dot-".concat(ft),r:3},st),at),{},{index:ft,cx:ct.x,cy:ct.y,value:ct.value,dataKey:it,payload:ct.payload,points:nt});return i.renderDotItem(rt,ut)}),lt={clipPath:$?"url(#clipPath-".concat(j?"":"dots-").concat(_e,")"):null};return React$2.createElement(Layer,_extends$4({className:"recharts-line-dots",key:"dots"},lt),ot)}},{key:"renderCurveStatically",value:function($,j,_e,et){var tt=this.props,rt=tt.type,nt=tt.layout,it=tt.connectNulls;tt.ref;var st=_objectWithoutProperties$1(tt,_excluded$1),at=_objectSpread$2(_objectSpread$2(_objectSpread$2({},filterProps(st,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:j?"url(#clipPath-".concat(_e,")"):null,points:$},et),{},{type:rt,layout:nt,connectNulls:it});return React$2.createElement(Curve,_extends$4({},at,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function($,j){var _e=this,et=this.props,tt=et.points,rt=et.strokeDasharray,nt=et.isAnimationActive,it=et.animationBegin,st=et.animationDuration,at=et.animationEasing,ot=et.animationId,lt=et.animateNewValues,ct=et.width,ft=et.height,ut=this.state,ht=ut.prevPoints,dt=ut.totalLength;return React$2.createElement(Animate,{begin:it,duration:st,isActive:nt,easing:at,from:{t:0},to:{t:1},key:"line-".concat(ot),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(mt){var pt=mt.t;if(ht){var yt=ht.length/tt.length,gt=tt.map(function(wt,Ot){var Bt=Math.floor(Ot*yt);if(ht[Bt]){var Ft=ht[Bt],Pt=interpolateNumber$2(Ft.x,wt.x),Rt=interpolateNumber$2(Ft.y,wt.y);return _objectSpread$2(_objectSpread$2({},wt),{},{x:Pt(pt),y:Rt(pt)})}if(lt){var Et=interpolateNumber$2(ct*2,wt.x),_t=interpolateNumber$2(ft/2,wt.y);return _objectSpread$2(_objectSpread$2({},wt),{},{x:Et(pt),y:_t(pt)})}return _objectSpread$2(_objectSpread$2({},wt),{},{x:wt.x,y:wt.y})});return _e.renderCurveStatically(gt,$,j)}var vt=interpolateNumber$2(0,dt),St=vt(pt),At;if(rt){var xt="".concat(rt).split(/[,\s]+/gim).map(function(wt){return parseFloat(wt)});At=_e.getStrokeDasharray(St,dt,xt)}else At=_e.generateSimpleStrokeDasharray(dt,St);return _e.renderCurveStatically(tt,$,j,{strokeDasharray:At})})}},{key:"renderCurve",value:function($,j){var _e=this.props,et=_e.points,tt=_e.isAnimationActive,rt=this.state,nt=rt.prevPoints,it=rt.totalLength;return tt&&et&&et.length&&(!nt&&it>0||!isEqual$1(nt,et))?this.renderCurveWithAnimation($,j):this.renderCurveStatically(et,$,j)}},{key:"render",value:function(){var $,j=this.props,_e=j.hide,et=j.dot,tt=j.points,rt=j.className,nt=j.xAxis,it=j.yAxis,st=j.top,at=j.left,ot=j.width,lt=j.height,ct=j.isAnimationActive,ft=j.id;if(_e||!tt||!tt.length)return null;var ut=this.state.isAnimationFinished,ht=tt.length===1,dt=clsx("recharts-line",rt),mt=nt&&nt.allowDataOverflow,pt=it&&it.allowDataOverflow,yt=mt||pt,gt=isNil$1(ft)?this.id:ft,vt=($=filterProps(et,!1))!==null&&$!==void 0?$:{r:3,strokeWidth:2},St=vt.r,At=St===void 0?3:St,xt=vt.strokeWidth,wt=xt===void 0?2:xt,Ot=hasClipDot(et)?et:{},Bt=Ot.clipDot,Ft=Bt===void 0?!0:Bt,Pt=At*2+wt;return React$2.createElement(Layer,{className:dt},mt||pt?React$2.createElement("defs",null,React$2.createElement("clipPath",{id:"clipPath-".concat(gt)},React$2.createElement("rect",{x:mt?at:at-ot/2,y:pt?st:st-lt/2,width:mt?ot:ot*2,height:pt?lt:lt*2})),!Ft&&React$2.createElement("clipPath",{id:"clipPath-dots-".concat(gt)},React$2.createElement("rect",{x:at-Pt/2,y:st-Pt/2,width:ot+Pt,height:lt+Pt}))):null,!ht&&this.renderCurve(yt,gt),this.renderErrorBar(yt,gt),(ht||et)&&this.renderDots(yt,Ft,gt),(!ct||ut)&&LabelList.renderCallByParent(this.props,tt))}}],[{key:"getDerivedStateFromProps",value:function($,j){return $.animationId!==j.prevAnimationId?{prevAnimationId:$.animationId,curPoints:$.points,prevPoints:j.curPoints}:$.points!==j.curPoints?{curPoints:$.points}:null}},{key:"repeat",value:function($,j){for(var _e=$.length%2!==0?[].concat(_toConsumableArray$2($),[0]):$,et=[],tt=0;tt<j;++tt)et=[].concat(_toConsumableArray$2(et),_toConsumableArray$2(_e));return et}},{key:"renderDotItem",value:function($,j){var _e;if(React$2.isValidElement($))_e=React$2.cloneElement($,j);else if(isFunction$3($))_e=$(j);else{var et=j.key,tt=_objectWithoutProperties$1(j,_excluded2$1),rt=clsx("recharts-line-dot",typeof $!="boolean"?$.className:"");_e=React$2.createElement(Dot,_extends$4({key:et},tt,{className:rt}))}return _e}}])}(reactExports.PureComponent);_defineProperty$6(Line,"displayName","Line");_defineProperty$6(Line,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Global.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});_defineProperty$6(Line,"getComposedData",function(o){var i=o.props,_=o.xAxis,$=o.yAxis,j=o.xAxisTicks,_e=o.yAxisTicks,et=o.dataKey,tt=o.bandSize,rt=o.displayedData,nt=o.offset,it=i.layout,st=rt.map(function(at,ot){var lt=getValueByDataKey(at,et);return it==="horizontal"?{x:getCateCoordinateOfLine({axis:_,ticks:j,bandSize:tt,entry:at,index:ot}),y:isNil$1(lt)?null:$.scale(lt),value:lt,payload:at}:{x:isNil$1(lt)?null:_.scale(lt),y:getCateCoordinateOfLine({axis:$,ticks:_e,bandSize:tt,entry:at,index:ot}),value:lt,payload:at}});return _objectSpread$2({points:st,layout:it},nt)});function _typeof$4(o){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$4(o)}function _classCallCheck$3(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$5($.key),$)}}function _createClass$3(o,i,_){return i&&_defineProperties$3(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$2(o,i,_){return i=_getPrototypeOf$2(i),_possibleConstructorReturn$2(o,_isNativeReflectConstruct$2()?Reflect.construct(i,_||[],_getPrototypeOf$2(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$2(o,i){if(i&&(_typeof$4(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(o)}function _assertThisInitialized$2(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$2(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$2=function(){return!!o})()}function _getPrototypeOf$2(o){return _getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$2(o)}function _inherits$2(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$2(o,i)}function _setPrototypeOf$2(o,i){return _setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$2(o,i)}function _defineProperty$5(o,i,_){return i=_toPropertyKey$5(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$5(o){var i=_toPrimitive$5(o,"string");return _typeof$4(i)=="symbol"?i:i+""}function _toPrimitive$5(o,i){if(_typeof$4(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$4($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$3.apply(this,arguments)}function XAxisImpl(o){var i=o.xAxisId,_=useChartWidth(),$=useChartHeight(),j=useXAxisOrThrow(i);return j==null?null:React$2.createElement(CartesianAxis,_extends$3({},j,{className:clsx("recharts-".concat(j.axisType," ").concat(j.axisType),j.className),viewBox:{x:0,y:0,width:_,height:$},ticksGenerator:function(et){return getTicksOfAxis(et,!0)}}))}var XAxis=function(o){function i(){return _classCallCheck$3(this,i),_callSuper$2(this,i,arguments)}return _inherits$2(i,o),_createClass$3(i,[{key:"render",value:function(){return React$2.createElement(XAxisImpl,this.props)}}])}(React$2.Component);_defineProperty$5(XAxis,"displayName","XAxis");_defineProperty$5(XAxis,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function _typeof$3(o){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$3(o)}function _classCallCheck$2(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$4($.key),$)}}function _createClass$2(o,i,_){return i&&_defineProperties$2(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper$1(o,i,_){return i=_getPrototypeOf$1(i),_possibleConstructorReturn$1(o,_isNativeReflectConstruct$1()?Reflect.construct(i,_||[],_getPrototypeOf$1(o).constructor):i.apply(o,_))}function _possibleConstructorReturn$1(o,i){if(i&&(_typeof$3(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(o)}function _assertThisInitialized$1(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct$1(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$1=function(){return!!o})()}function _getPrototypeOf$1(o){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf$1(o)}function _inherits$1(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf$1(o,i)}function _setPrototypeOf$1(o,i){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf$1(o,i)}function _defineProperty$4(o,i,_){return i=_toPropertyKey$4(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$4(o){var i=_toPrimitive$4(o,"string");return _typeof$3(i)=="symbol"?i:i+""}function _toPrimitive$4(o,i){if(_typeof$3(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$3($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$2.apply(this,arguments)}var YAxisImpl=function o(i){var _=i.yAxisId,$=useChartWidth(),j=useChartHeight(),_e=useYAxisOrThrow(_);return _e==null?null:React$2.createElement(CartesianAxis,_extends$2({},_e,{className:clsx("recharts-".concat(_e.axisType," ").concat(_e.axisType),_e.className),viewBox:{x:0,y:0,width:$,height:j},ticksGenerator:function(tt){return getTicksOfAxis(tt,!0)}}))},YAxis=function(o){function i(){return _classCallCheck$2(this,i),_callSuper$1(this,i,arguments)}return _inherits$1(i,o),_createClass$2(i,[{key:"render",value:function(){return React$2.createElement(YAxisImpl,this.props)}}])}(React$2.Component);_defineProperty$4(YAxis,"displayName","YAxis");_defineProperty$4(YAxis,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function _toConsumableArray$1(o){return _arrayWithoutHoles$1(o)||_iterableToArray$1(o)||_unsupportedIterableToArray$1(o)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray$1(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray$1(o,i)}}function _iterableToArray$1(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles$1(o){if(Array.isArray(o))return _arrayLikeToArray$1(o)}function _arrayLikeToArray$1(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}var detectReferenceElementsDomain=function o(i,_,$,j,_e){var et=findAllByType(i,ReferenceLine),tt=findAllByType(i,ReferenceDot),rt=[].concat(_toConsumableArray$1(et),_toConsumableArray$1(tt)),nt=findAllByType(i,ReferenceArea),it="".concat(j,"Id"),st=j[0],at=_;if(rt.length&&(at=rt.reduce(function(ct,ft){if(ft.props[it]===$&&ifOverflowMatches(ft.props,"extendDomain")&&isNumber(ft.props[st])){var ut=ft.props[st];return[Math.min(ct[0],ut),Math.max(ct[1],ut)]}return ct},at)),nt.length){var ot="".concat(st,"1"),lt="".concat(st,"2");at=nt.reduce(function(ct,ft){if(ft.props[it]===$&&ifOverflowMatches(ft.props,"extendDomain")&&isNumber(ft.props[ot])&&isNumber(ft.props[lt])){var ut=ft.props[ot],ht=ft.props[lt];return[Math.min(ct[0],ut,ht),Math.max(ct[1],ut,ht)]}return ct},at)}return _e&&_e.length&&(at=_e.reduce(function(ct,ft){return isNumber(ft)?[Math.min(ct[0],ft),Math.max(ct[1],ft)]:ct},at)),at},eventemitter3$1={exports:{}};(function(o){var i=Object.prototype.hasOwnProperty,_="~";function $(){}Object.create&&($.prototype=Object.create(null),new $().__proto__||(_=!1));function j(rt,nt,it){this.fn=rt,this.context=nt,this.once=it||!1}function _e(rt,nt,it,st,at){if(typeof it!="function")throw new TypeError("The listener must be a function");var ot=new j(it,st||rt,at),lt=_?_+nt:nt;return rt._events[lt]?rt._events[lt].fn?rt._events[lt]=[rt._events[lt],ot]:rt._events[lt].push(ot):(rt._events[lt]=ot,rt._eventsCount++),rt}function et(rt,nt){--rt._eventsCount===0?rt._events=new $:delete rt._events[nt]}function tt(){this._events=new $,this._eventsCount=0}tt.prototype.eventNames=function(){var nt=[],it,st;if(this._eventsCount===0)return nt;for(st in it=this._events)i.call(it,st)&&nt.push(_?st.slice(1):st);return Object.getOwnPropertySymbols?nt.concat(Object.getOwnPropertySymbols(it)):nt},tt.prototype.listeners=function(nt){var it=_?_+nt:nt,st=this._events[it];if(!st)return[];if(st.fn)return[st.fn];for(var at=0,ot=st.length,lt=new Array(ot);at<ot;at++)lt[at]=st[at].fn;return lt},tt.prototype.listenerCount=function(nt){var it=_?_+nt:nt,st=this._events[it];return st?st.fn?1:st.length:0},tt.prototype.emit=function(nt,it,st,at,ot,lt){var ct=_?_+nt:nt;if(!this._events[ct])return!1;var ft=this._events[ct],ut=arguments.length,ht,dt;if(ft.fn){switch(ft.once&&this.removeListener(nt,ft.fn,void 0,!0),ut){case 1:return ft.fn.call(ft.context),!0;case 2:return ft.fn.call(ft.context,it),!0;case 3:return ft.fn.call(ft.context,it,st),!0;case 4:return ft.fn.call(ft.context,it,st,at),!0;case 5:return ft.fn.call(ft.context,it,st,at,ot),!0;case 6:return ft.fn.call(ft.context,it,st,at,ot,lt),!0}for(dt=1,ht=new Array(ut-1);dt<ut;dt++)ht[dt-1]=arguments[dt];ft.fn.apply(ft.context,ht)}else{var mt=ft.length,pt;for(dt=0;dt<mt;dt++)switch(ft[dt].once&&this.removeListener(nt,ft[dt].fn,void 0,!0),ut){case 1:ft[dt].fn.call(ft[dt].context);break;case 2:ft[dt].fn.call(ft[dt].context,it);break;case 3:ft[dt].fn.call(ft[dt].context,it,st);break;case 4:ft[dt].fn.call(ft[dt].context,it,st,at);break;default:if(!ht)for(pt=1,ht=new Array(ut-1);pt<ut;pt++)ht[pt-1]=arguments[pt];ft[dt].fn.apply(ft[dt].context,ht)}}return!0},tt.prototype.on=function(nt,it,st){return _e(this,nt,it,st,!1)},tt.prototype.once=function(nt,it,st){return _e(this,nt,it,st,!0)},tt.prototype.removeListener=function(nt,it,st,at){var ot=_?_+nt:nt;if(!this._events[ot])return this;if(!it)return et(this,ot),this;var lt=this._events[ot];if(lt.fn)lt.fn===it&&(!at||lt.once)&&(!st||lt.context===st)&&et(this,ot);else{for(var ct=0,ft=[],ut=lt.length;ct<ut;ct++)(lt[ct].fn!==it||at&&!lt[ct].once||st&&lt[ct].context!==st)&&ft.push(lt[ct]);ft.length?this._events[ot]=ft.length===1?ft[0]:ft:et(this,ot)}return this},tt.prototype.removeAllListeners=function(nt){var it;return nt?(it=_?_+nt:nt,this._events[it]&&et(this,it)):(this._events=new $,this._eventsCount=0),this},tt.prototype.off=tt.prototype.removeListener,tt.prototype.addListener=tt.prototype.on,tt.prefixed=_,tt.EventEmitter=tt,o.exports=tt})(eventemitter3$1);var eventemitter3Exports$1=eventemitter3$1.exports;const EventEmitter$2=getDefaultExportFromCjs$1(eventemitter3Exports$1);var eventCenter=new EventEmitter$2,SYNC_EVENT="recharts.syncMouseEvents";function _typeof$2(o){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$2(o)}function _classCallCheck$1(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$3($.key),$)}}function _createClass$1(o,i,_){return i&&_defineProperties$1(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _defineProperty$3(o,i,_){return i=_toPropertyKey$3(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$3(o){var i=_toPrimitive$3(o,"string");return _typeof$2(i)=="symbol"?i:i+""}function _toPrimitive$3(o,i){if(_typeof$2(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$2($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var AccessibilityManager=function(){function o(){_classCallCheck$1(this,o),_defineProperty$3(this,"activeIndex",0),_defineProperty$3(this,"coordinateList",[]),_defineProperty$3(this,"layout","horizontal")}return _createClass$1(o,[{key:"setDetails",value:function(_){var $,j=_.coordinateList,_e=j===void 0?null:j,et=_.container,tt=et===void 0?null:et,rt=_.layout,nt=rt===void 0?null:rt,it=_.offset,st=it===void 0?null:it,at=_.mouseHandlerCallback,ot=at===void 0?null:at;this.coordinateList=($=_e??this.coordinateList)!==null&&$!==void 0?$:[],this.container=tt??this.container,this.layout=nt??this.layout,this.offset=st??this.offset,this.mouseHandlerCallback=ot??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(_){if(this.coordinateList.length!==0)switch(_.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(_){this.activeIndex=_}},{key:"spoofMouse",value:function(){var _,$;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var j=this.container.getBoundingClientRect(),_e=j.x,et=j.y,tt=j.height,rt=this.coordinateList[this.activeIndex].coordinate,nt=((_=window)===null||_===void 0?void 0:_.scrollX)||0,it=(($=window)===null||$===void 0?void 0:$.scrollY)||0,st=_e+rt+nt,at=et+this.offset.top+tt/2+it;this.mouseHandlerCallback({pageX:st,pageY:at})}}}])}();function isDomainSpecifiedByUser(o,i,_){if(_==="number"&&i===!0&&Array.isArray(o)){var $=o==null?void 0:o[0],j=o==null?void 0:o[1];if($&&j&&isNumber($)&&isNumber(j))return!0}return!1}function getCursorRectangle(o,i,_,$){var j=$/2;return{stroke:"none",fill:"#ccc",x:o==="horizontal"?i.x-j:_.left+.5,y:o==="horizontal"?_.top+.5:i.y-j,width:o==="horizontal"?$:_.width-1,height:o==="horizontal"?_.height-1:$}}function getRadialCursorPoints(o){var i=o.cx,_=o.cy,$=o.radius,j=o.startAngle,_e=o.endAngle,et=polarToCartesian(i,_,$,j),tt=polarToCartesian(i,_,$,_e);return{points:[et,tt],cx:i,cy:_,radius:$,startAngle:j,endAngle:_e}}function getCursorPoints(o,i,_){var $,j,_e,et;if(o==="horizontal")$=i.x,_e=$,j=_.top,et=_.top+_.height;else if(o==="vertical")j=i.y,et=j,$=_.left,_e=_.left+_.width;else if(i.cx!=null&&i.cy!=null)if(o==="centric"){var tt=i.cx,rt=i.cy,nt=i.innerRadius,it=i.outerRadius,st=i.angle,at=polarToCartesian(tt,rt,nt,st),ot=polarToCartesian(tt,rt,it,st);$=at.x,j=at.y,_e=ot.x,et=ot.y}else return getRadialCursorPoints(i);return[{x:$,y:j},{x:_e,y:et}]}function _typeof$1(o){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof$1(o)}function ownKeys$2(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread$1(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$2(Object(_),!0).forEach(function($){_defineProperty$2(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$2(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$2(o,i,_){return i=_toPropertyKey$2(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$2(o){var i=_toPrimitive$2(o,"string");return _typeof$1(i)=="symbol"?i:i+""}function _toPrimitive$2(o,i){if(_typeof$1(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof$1($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function Cursor(o){var i,_,$=o.element,j=o.tooltipEventType,_e=o.isActive,et=o.activeCoordinate,tt=o.activePayload,rt=o.offset,nt=o.activeTooltipIndex,it=o.tooltipAxisBandSize,st=o.layout,at=o.chartName,ot=(i=$.props.cursor)!==null&&i!==void 0?i:(_=$.type.defaultProps)===null||_===void 0?void 0:_.cursor;if(!$||!ot||!_e||!et||at!=="ScatterChart"&&j!=="axis")return null;var lt,ct=Curve;if(at==="ScatterChart")lt=et,ct=Cross;else if(at==="BarChart")lt=getCursorRectangle(st,et,rt,it),ct=Rectangle;else if(st==="radial"){var ft=getRadialCursorPoints(et),ut=ft.cx,ht=ft.cy,dt=ft.radius,mt=ft.startAngle,pt=ft.endAngle;lt={cx:ut,cy:ht,startAngle:mt,endAngle:pt,innerRadius:dt,outerRadius:dt},ct=Sector}else lt={points:getCursorPoints(st,et,rt)},ct=Curve;var yt=_objectSpread$1(_objectSpread$1(_objectSpread$1(_objectSpread$1({stroke:"#ccc",pointerEvents:"none"},rt),lt),filterProps(ot,!1)),{},{payload:tt,payloadIndex:nt,className:clsx("recharts-tooltip-cursor",ot.className)});return reactExports.isValidElement(ot)?reactExports.cloneElement(ot,yt):reactExports.createElement(ct,yt)}var _excluded=["item"],_excluded2=["children","className","width","height","style","compact","title","desc"];function _typeof(o){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_typeof(o)}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)Object.prototype.hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends$1.apply(this,arguments)}function _slicedToArray(o,i){return _arrayWithHoles(o)||_iterableToArrayLimit(o,i)||_unsupportedIterableToArray(o,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit(o,i){var _=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(_!=null){var $,j,_e,et,tt=[],rt=!0,nt=!1;try{if(_e=(_=_.call(o)).next,i!==0)for(;!(rt=($=_e.call(_)).done)&&(tt.push($.value),tt.length!==i);rt=!0);}catch(it){nt=!0,j=it}finally{try{if(!rt&&_.return!=null&&(et=_.return(),Object(et)!==et))return}finally{if(nt)throw j}}return tt}}function _arrayWithHoles(o){if(Array.isArray(o))return o}function _objectWithoutProperties(o,i){if(o==null)return{};var _=_objectWithoutPropertiesLoose(o,i),$,j;if(Object.getOwnPropertySymbols){var _e=Object.getOwnPropertySymbols(o);for(j=0;j<_e.length;j++)$=_e[j],!(i.indexOf($)>=0)&&Object.prototype.propertyIsEnumerable.call(o,$)&&(_[$]=o[$])}return _}function _objectWithoutPropertiesLoose(o,i){if(o==null)return{};var _={};for(var $ in o)if(Object.prototype.hasOwnProperty.call(o,$)){if(i.indexOf($)>=0)continue;_[$]=o[$]}return _}function _classCallCheck(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(o,i){for(var _=0;_<i.length;_++){var $=i[_];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(o,_toPropertyKey$1($.key),$)}}function _createClass(o,i,_){return i&&_defineProperties(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o}function _callSuper(o,i,_){return i=_getPrototypeOf(i),_possibleConstructorReturn(o,_isNativeReflectConstruct()?Reflect.construct(i,_||[],_getPrototypeOf(o).constructor):i.apply(o,_))}function _possibleConstructorReturn(o,i){if(i&&(_typeof(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(o)}function _assertThisInitialized(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _isNativeReflectConstruct(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!o})()}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_){return _.__proto__||Object.getPrototypeOf(_)},_getPrototypeOf(o)}function _inherits(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(i&&i.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),i&&_setPrototypeOf(o,i)}function _setPrototypeOf(o,i){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function($,j){return $.__proto__=j,$},_setPrototypeOf(o,i)}function _toConsumableArray(o){return _arrayWithoutHoles(o)||_iterableToArray(o)||_unsupportedIterableToArray(o)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(o,i){if(o){if(typeof o=="string")return _arrayLikeToArray(o,i);var _=Object.prototype.toString.call(o).slice(8,-1);if(_==="Object"&&o.constructor&&(_=o.constructor.name),_==="Map"||_==="Set")return Array.from(o);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _arrayLikeToArray(o,i)}}function _iterableToArray(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function _arrayWithoutHoles(o){if(Array.isArray(o))return _arrayLikeToArray(o)}function _arrayLikeToArray(o,i){(i==null||i>o.length)&&(i=o.length);for(var _=0,$=new Array(i);_<i;_++)$[_]=o[_];return $}function ownKeys$1(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys$1(Object(_),!0).forEach(function($){_defineProperty$1(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys$1(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _defineProperty$1(o,i,_){return i=_toPropertyKey$1(i),i in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _toPropertyKey$1(o){var i=_toPrimitive$1(o,"string");return _typeof(i)=="symbol"?i:i+""}function _toPrimitive$1(o,i){if(_typeof(o)!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(_typeof($)!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}var ORIENT_MAP={xAxis:["bottom","top"],yAxis:["left","right"]},FULL_WIDTH_AND_HEIGHT={width:"100%",height:"100%"},originCoordinate={x:0,y:0};function renderAsIs(o){return o}var calculateTooltipPos=function o(i,_){return _==="horizontal"?i.x:_==="vertical"?i.y:_==="centric"?i.angle:i.radius},getActiveCoordinate=function o(i,_,$,j){var _e=_.find(function(it){return it&&it.index===$});if(_e){if(i==="horizontal")return{x:_e.coordinate,y:j.y};if(i==="vertical")return{x:j.x,y:_e.coordinate};if(i==="centric"){var et=_e.coordinate,tt=j.radius;return _objectSpread(_objectSpread(_objectSpread({},j),polarToCartesian(j.cx,j.cy,tt,et)),{},{angle:et,radius:tt})}var rt=_e.coordinate,nt=j.angle;return _objectSpread(_objectSpread(_objectSpread({},j),polarToCartesian(j.cx,j.cy,rt,nt)),{},{angle:nt,radius:rt})}return originCoordinate},getDisplayedData=function o(i,_){var $=_.graphicalItems,j=_.dataStartIndex,_e=_.dataEndIndex,et=($??[]).reduce(function(tt,rt){var nt=rt.props.data;return nt&&nt.length?[].concat(_toConsumableArray(tt),_toConsumableArray(nt)):tt},[]);return et.length>0?et:i&&i.length&&isNumber(j)&&isNumber(_e)?i.slice(j,_e+1):[]};function getDefaultDomainByAxisType(o){return o==="number"?[0,"auto"]:void 0}var getTooltipContent=function o(i,_,$,j){var _e=i.graphicalItems,et=i.tooltipAxis,tt=getDisplayedData(_,i);return $<0||!_e||!_e.length||$>=tt.length?null:_e.reduce(function(rt,nt){var it,st=(it=nt.props.data)!==null&&it!==void 0?it:_;st&&i.dataStartIndex+i.dataEndIndex!==0&&i.dataEndIndex-i.dataStartIndex>=$&&(st=st.slice(i.dataStartIndex,i.dataEndIndex+1));var at;if(et.dataKey&&!et.allowDuplicatedCategory){var ot=st===void 0?tt:st;at=findEntryInArray(ot,et.dataKey,j)}else at=st&&st[$]||tt[$];return at?[].concat(_toConsumableArray(rt),[getTooltipItem(nt,at)]):rt},[])},getTooltipData=function o(i,_,$,j){var _e=j||{x:i.chartX,y:i.chartY},et=calculateTooltipPos(_e,$),tt=i.orderedTooltipTicks,rt=i.tooltipAxis,nt=i.tooltipTicks,it=calculateActiveTickIndex(et,tt,nt,rt);if(it>=0&&nt){var st=nt[it]&&nt[it].value,at=getTooltipContent(i,_,it,st),ot=getActiveCoordinate($,tt,it,_e);return{activeTooltipIndex:it,activeLabel:st,activePayload:at,activeCoordinate:ot}}return null},getAxisMapByAxes=function o(i,_){var $=_.axes,j=_.graphicalItems,_e=_.axisType,et=_.axisIdKey,tt=_.stackGroups,rt=_.dataStartIndex,nt=_.dataEndIndex,it=i.layout,st=i.children,at=i.stackOffset,ot=isCategoricalAxis(it,_e);return $.reduce(function(lt,ct){var ft,ut=ct.type.defaultProps!==void 0?_objectSpread(_objectSpread({},ct.type.defaultProps),ct.props):ct.props,ht=ut.type,dt=ut.dataKey,mt=ut.allowDataOverflow,pt=ut.allowDuplicatedCategory,yt=ut.scale,gt=ut.ticks,vt=ut.includeHidden,St=ut[et];if(lt[St])return lt;var At=getDisplayedData(i.data,{graphicalItems:j.filter(function(Lt){var Ct,kt=et in Lt.props?Lt.props[et]:(Ct=Lt.type.defaultProps)===null||Ct===void 0?void 0:Ct[et];return kt===St}),dataStartIndex:rt,dataEndIndex:nt}),xt=At.length,wt,Ot,Bt;isDomainSpecifiedByUser(ut.domain,mt,ht)&&(wt=parseSpecifiedDomain(ut.domain,null,mt),ot&&(ht==="number"||yt!=="auto")&&(Bt=getDomainOfDataByKey(At,dt,"category")));var Ft=getDefaultDomainByAxisType(ht);if(!wt||wt.length===0){var Pt,Rt=(Pt=ut.domain)!==null&&Pt!==void 0?Pt:Ft;if(dt){if(wt=getDomainOfDataByKey(At,dt,ht),ht==="category"&&ot){var Et=hasDuplicate(wt);pt&&Et?(Ot=wt,wt=range$1(0,xt)):pt||(wt=parseDomainOfCategoryAxis(Rt,wt,ct).reduce(function(Lt,Ct){return Lt.indexOf(Ct)>=0?Lt:[].concat(_toConsumableArray(Lt),[Ct])},[]))}else if(ht==="category")pt?wt=wt.filter(function(Lt){return Lt!==""&&!isNil$1(Lt)}):wt=parseDomainOfCategoryAxis(Rt,wt,ct).reduce(function(Lt,Ct){return Lt.indexOf(Ct)>=0||Ct===""||isNil$1(Ct)?Lt:[].concat(_toConsumableArray(Lt),[Ct])},[]);else if(ht==="number"){var _t=parseErrorBarsOfAxis(At,j.filter(function(Lt){var Ct,kt,jt=et in Lt.props?Lt.props[et]:(Ct=Lt.type.defaultProps)===null||Ct===void 0?void 0:Ct[et],Vt="hide"in Lt.props?Lt.props.hide:(kt=Lt.type.defaultProps)===null||kt===void 0?void 0:kt.hide;return jt===St&&(vt||!Vt)}),dt,_e,it);_t&&(wt=_t)}ot&&(ht==="number"||yt!=="auto")&&(Bt=getDomainOfDataByKey(At,dt,"category"))}else ot?wt=range$1(0,xt):tt&&tt[St]&&tt[St].hasStack&&ht==="number"?wt=at==="expand"?[0,1]:getDomainOfStackGroups(tt[St].stackGroups,rt,nt):wt=getDomainOfItemsWithSameAxis(At,j.filter(function(Lt){var Ct=et in Lt.props?Lt.props[et]:Lt.type.defaultProps[et],kt="hide"in Lt.props?Lt.props.hide:Lt.type.defaultProps.hide;return Ct===St&&(vt||!kt)}),ht,it,!0);if(ht==="number")wt=detectReferenceElementsDomain(st,wt,St,_e,gt),Rt&&(wt=parseSpecifiedDomain(Rt,wt,mt));else if(ht==="category"&&Rt){var Mt=Rt,Dt=wt.every(function(Lt){return Mt.indexOf(Lt)>=0});Dt&&(wt=Mt)}}return _objectSpread(_objectSpread({},lt),{},_defineProperty$1({},St,_objectSpread(_objectSpread({},ut),{},{axisType:_e,domain:wt,categoricalDomain:Bt,duplicateDomain:Ot,originalDomain:(ft=ut.domain)!==null&&ft!==void 0?ft:Ft,isCategorical:ot,layout:it})))},{})},getAxisMapByItems=function o(i,_){var $=_.graphicalItems,j=_.Axis,_e=_.axisType,et=_.axisIdKey,tt=_.stackGroups,rt=_.dataStartIndex,nt=_.dataEndIndex,it=i.layout,st=i.children,at=getDisplayedData(i.data,{graphicalItems:$,dataStartIndex:rt,dataEndIndex:nt}),ot=at.length,lt=isCategoricalAxis(it,_e),ct=-1;return $.reduce(function(ft,ut){var ht=ut.type.defaultProps!==void 0?_objectSpread(_objectSpread({},ut.type.defaultProps),ut.props):ut.props,dt=ht[et],mt=getDefaultDomainByAxisType("number");if(!ft[dt]){ct++;var pt;return lt?pt=range$1(0,ot):tt&&tt[dt]&&tt[dt].hasStack?(pt=getDomainOfStackGroups(tt[dt].stackGroups,rt,nt),pt=detectReferenceElementsDomain(st,pt,dt,_e)):(pt=parseSpecifiedDomain(mt,getDomainOfItemsWithSameAxis(at,$.filter(function(yt){var gt,vt,St=et in yt.props?yt.props[et]:(gt=yt.type.defaultProps)===null||gt===void 0?void 0:gt[et],At="hide"in yt.props?yt.props.hide:(vt=yt.type.defaultProps)===null||vt===void 0?void 0:vt.hide;return St===dt&&!At}),"number",it),j.defaultProps.allowDataOverflow),pt=detectReferenceElementsDomain(st,pt,dt,_e)),_objectSpread(_objectSpread({},ft),{},_defineProperty$1({},dt,_objectSpread(_objectSpread({axisType:_e},j.defaultProps),{},{hide:!0,orientation:get$4(ORIENT_MAP,"".concat(_e,".").concat(ct%2),null),domain:pt,originalDomain:mt,isCategorical:lt,layout:it})))}return ft},{})},getAxisMap=function o(i,_){var $=_.axisType,j=$===void 0?"xAxis":$,_e=_.AxisComp,et=_.graphicalItems,tt=_.stackGroups,rt=_.dataStartIndex,nt=_.dataEndIndex,it=i.children,st="".concat(j,"Id"),at=findAllByType(it,_e),ot={};return at&&at.length?ot=getAxisMapByAxes(i,{axes:at,graphicalItems:et,axisType:j,axisIdKey:st,stackGroups:tt,dataStartIndex:rt,dataEndIndex:nt}):et&&et.length&&(ot=getAxisMapByItems(i,{Axis:_e,graphicalItems:et,axisType:j,axisIdKey:st,stackGroups:tt,dataStartIndex:rt,dataEndIndex:nt})),ot},tooltipTicksGenerator=function o(i){var _=getAnyElementOfObject(i),$=getTicksOfAxis(_,!1,!0);return{tooltipTicks:$,orderedTooltipTicks:sortBy$1($,function(j){return j.coordinate}),tooltipAxis:_,tooltipAxisBandSize:getBandSizeOfAxis(_,$)}},createDefaultState=function o(i){var _=i.children,$=i.defaultShowTooltip,j=findChildByType(_,Brush),_e=0,et=0;return i.data&&i.data.length!==0&&(et=i.data.length-1),j&&j.props&&(j.props.startIndex>=0&&(_e=j.props.startIndex),j.props.endIndex>=0&&(et=j.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:_e,dataEndIndex:et,activeTooltipIndex:-1,isTooltipActive:!!$}},hasGraphicalBarItem=function o(i){return!i||!i.length?!1:i.some(function(_){var $=getDisplayName(_&&_.type);return $&&$.indexOf("Bar")>=0})},getAxisNameByLayout=function o(i){return i==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:i==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:i==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},calculateOffset$1=function o(i,_){var $=i.props,j=i.graphicalItems,_e=i.xAxisMap,et=_e===void 0?{}:_e,tt=i.yAxisMap,rt=tt===void 0?{}:tt,nt=$.width,it=$.height,st=$.children,at=$.margin||{},ot=findChildByType(st,Brush),lt=findChildByType(st,Legend),ct=Object.keys(rt).reduce(function(pt,yt){var gt=rt[yt],vt=gt.orientation;return!gt.mirror&&!gt.hide?_objectSpread(_objectSpread({},pt),{},_defineProperty$1({},vt,pt[vt]+gt.width)):pt},{left:at.left||0,right:at.right||0}),ft=Object.keys(et).reduce(function(pt,yt){var gt=et[yt],vt=gt.orientation;return!gt.mirror&&!gt.hide?_objectSpread(_objectSpread({},pt),{},_defineProperty$1({},vt,get$4(pt,"".concat(vt))+gt.height)):pt},{top:at.top||0,bottom:at.bottom||0}),ut=_objectSpread(_objectSpread({},ft),ct),ht=ut.bottom;ot&&(ut.bottom+=ot.props.height||Brush.defaultProps.height),lt&&_&&(ut=appendOffsetOfLegend(ut,j,$,_));var dt=nt-ut.left-ut.right,mt=it-ut.top-ut.bottom;return _objectSpread(_objectSpread({brushBottom:ht},ut),{},{width:Math.max(dt,0),height:Math.max(mt,0)})},getCartesianAxisSize=function o(i,_){if(_==="xAxis")return i[_].width;if(_==="yAxis")return i[_].height},generateCategoricalChart=function o(i){var _=i.chartName,$=i.GraphicalChild,j=i.defaultTooltipEventType,_e=j===void 0?"axis":j,et=i.validateTooltipEventTypes,tt=et===void 0?["axis"]:et,rt=i.axisComponents,nt=i.legendContent,it=i.formatAxisMap,st=i.defaultProps,at=function(ut,ht){var dt=ht.graphicalItems,mt=ht.stackGroups,pt=ht.offset,yt=ht.updateId,gt=ht.dataStartIndex,vt=ht.dataEndIndex,St=ut.barSize,At=ut.layout,xt=ut.barGap,wt=ut.barCategoryGap,Ot=ut.maxBarSize,Bt=getAxisNameByLayout(At),Ft=Bt.numericAxisName,Pt=Bt.cateAxisName,Rt=hasGraphicalBarItem(dt),Et=[];return dt.forEach(function(_t,Mt){var Dt=getDisplayedData(ut.data,{graphicalItems:[_t],dataStartIndex:gt,dataEndIndex:vt}),Lt=_t.type.defaultProps!==void 0?_objectSpread(_objectSpread({},_t.type.defaultProps),_t.props):_t.props,Ct=Lt.dataKey,kt=Lt.maxBarSize,jt=Lt["".concat(Ft,"Id")],Vt=Lt["".concat(Pt,"Id")],zt={},qt=rt.reduce(function(dr,xr){var Mr=ht["".concat(xr.axisType,"Map")],Or=Lt["".concat(xr.axisType,"Id")];Mr&&Mr[Or]||xr.axisType==="zAxis"||invariant(!1);var fr=Mr[Or];return _objectSpread(_objectSpread({},dr),{},_defineProperty$1(_defineProperty$1({},xr.axisType,fr),"".concat(xr.axisType,"Ticks"),getTicksOfAxis(fr)))},zt),Wt=qt[Pt],ir=qt["".concat(Pt,"Ticks")],or=mt&&mt[jt]&&mt[jt].hasStack&&getStackedDataOfItem(_t,mt[jt].stackGroups),Qt=getDisplayName(_t.type).indexOf("Bar")>=0,gr=getBandSizeOfAxis(Wt,ir),ar=[],Ar=Rt&&getBarSizeList({barSize:St,stackGroups:mt,totalSize:getCartesianAxisSize(qt,Pt)});if(Qt){var er,sr,Gt=isNil$1(kt)?Ot:kt,Jt=(er=(sr=getBandSizeOfAxis(Wt,ir,!0))!==null&&sr!==void 0?sr:Gt)!==null&&er!==void 0?er:0;ar=getBarPosition({barGap:xt,barCategoryGap:wt,bandSize:Jt!==gr?Jt:gr,sizeList:Ar[Vt],maxBarSize:Gt}),Jt!==gr&&(ar=ar.map(function(dr){return _objectSpread(_objectSpread({},dr),{},{position:_objectSpread(_objectSpread({},dr.position),{},{offset:dr.position.offset-Jt/2})})}))}var lr=_t&&_t.type&&_t.type.getComposedData;lr&&Et.push({props:_objectSpread(_objectSpread({},lr(_objectSpread(_objectSpread({},qt),{},{displayedData:Dt,props:ut,dataKey:Ct,item:_t,bandSize:gr,barPosition:ar,offset:pt,stackedData:or,layout:At,dataStartIndex:gt,dataEndIndex:vt}))),{},_defineProperty$1(_defineProperty$1(_defineProperty$1({key:_t.key||"item-".concat(Mt)},Ft,qt[Ft]),Pt,qt[Pt]),"animationId",yt)),childIndex:parseChildIndex(_t,ut.children),item:_t})}),Et},ot=function(ut,ht){var dt=ut.props,mt=ut.dataStartIndex,pt=ut.dataEndIndex,yt=ut.updateId;if(!validateWidthHeight({props:dt}))return null;var gt=dt.children,vt=dt.layout,St=dt.stackOffset,At=dt.data,xt=dt.reverseStackOrder,wt=getAxisNameByLayout(vt),Ot=wt.numericAxisName,Bt=wt.cateAxisName,Ft=findAllByType(gt,$),Pt=getStackGroupsByAxisId(At,Ft,"".concat(Ot,"Id"),"".concat(Bt,"Id"),St,xt),Rt=rt.reduce(function(Lt,Ct){var kt="".concat(Ct.axisType,"Map");return _objectSpread(_objectSpread({},Lt),{},_defineProperty$1({},kt,getAxisMap(dt,_objectSpread(_objectSpread({},Ct),{},{graphicalItems:Ft,stackGroups:Ct.axisType===Ot&&Pt,dataStartIndex:mt,dataEndIndex:pt}))))},{}),Et=calculateOffset$1(_objectSpread(_objectSpread({},Rt),{},{props:dt,graphicalItems:Ft}),ht==null?void 0:ht.legendBBox);Object.keys(Rt).forEach(function(Lt){Rt[Lt]=it(dt,Rt[Lt],Et,Lt.replace("Map",""),_)});var _t=Rt["".concat(Bt,"Map")],Mt=tooltipTicksGenerator(_t),Dt=at(dt,_objectSpread(_objectSpread({},Rt),{},{dataStartIndex:mt,dataEndIndex:pt,updateId:yt,graphicalItems:Ft,stackGroups:Pt,offset:Et}));return _objectSpread(_objectSpread({formattedGraphicalItems:Dt,graphicalItems:Ft,offset:Et,stackGroups:Pt},Mt),Rt)},lt=function(ft){function ut(ht){var dt,mt,pt;return _classCallCheck(this,ut),pt=_callSuper(this,ut,[ht]),_defineProperty$1(pt,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),_defineProperty$1(pt,"accessibilityManager",new AccessibilityManager),_defineProperty$1(pt,"handleLegendBBoxUpdate",function(yt){if(yt){var gt=pt.state,vt=gt.dataStartIndex,St=gt.dataEndIndex,At=gt.updateId;pt.setState(_objectSpread({legendBBox:yt},ot({props:pt.props,dataStartIndex:vt,dataEndIndex:St,updateId:At},_objectSpread(_objectSpread({},pt.state),{},{legendBBox:yt}))))}}),_defineProperty$1(pt,"handleReceiveSyncEvent",function(yt,gt,vt){if(pt.props.syncId===yt){if(vt===pt.eventEmitterSymbol&&typeof pt.props.syncMethod!="function")return;pt.applySyncEvent(gt)}}),_defineProperty$1(pt,"handleBrushChange",function(yt){var gt=yt.startIndex,vt=yt.endIndex;if(gt!==pt.state.dataStartIndex||vt!==pt.state.dataEndIndex){var St=pt.state.updateId;pt.setState(function(){return _objectSpread({dataStartIndex:gt,dataEndIndex:vt},ot({props:pt.props,dataStartIndex:gt,dataEndIndex:vt,updateId:St},pt.state))}),pt.triggerSyncEvent({dataStartIndex:gt,dataEndIndex:vt})}}),_defineProperty$1(pt,"handleMouseEnter",function(yt){var gt=pt.getMouseInfo(yt);if(gt){var vt=_objectSpread(_objectSpread({},gt),{},{isTooltipActive:!0});pt.setState(vt),pt.triggerSyncEvent(vt);var St=pt.props.onMouseEnter;isFunction$3(St)&&St(vt,yt)}}),_defineProperty$1(pt,"triggeredAfterMouseMove",function(yt){var gt=pt.getMouseInfo(yt),vt=gt?_objectSpread(_objectSpread({},gt),{},{isTooltipActive:!0}):{isTooltipActive:!1};pt.setState(vt),pt.triggerSyncEvent(vt);var St=pt.props.onMouseMove;isFunction$3(St)&&St(vt,yt)}),_defineProperty$1(pt,"handleItemMouseEnter",function(yt){pt.setState(function(){return{isTooltipActive:!0,activeItem:yt,activePayload:yt.tooltipPayload,activeCoordinate:yt.tooltipPosition||{x:yt.cx,y:yt.cy}}})}),_defineProperty$1(pt,"handleItemMouseLeave",function(){pt.setState(function(){return{isTooltipActive:!1}})}),_defineProperty$1(pt,"handleMouseMove",function(yt){yt.persist(),pt.throttleTriggeredAfterMouseMove(yt)}),_defineProperty$1(pt,"handleMouseLeave",function(yt){pt.throttleTriggeredAfterMouseMove.cancel();var gt={isTooltipActive:!1};pt.setState(gt),pt.triggerSyncEvent(gt);var vt=pt.props.onMouseLeave;isFunction$3(vt)&&vt(gt,yt)}),_defineProperty$1(pt,"handleOuterEvent",function(yt){var gt=getReactEventByType(yt),vt=get$4(pt.props,"".concat(gt));if(gt&&isFunction$3(vt)){var St,At;/.*touch.*/i.test(gt)?At=pt.getMouseInfo(yt.changedTouches[0]):At=pt.getMouseInfo(yt),vt((St=At)!==null&&St!==void 0?St:{},yt)}}),_defineProperty$1(pt,"handleClick",function(yt){var gt=pt.getMouseInfo(yt);if(gt){var vt=_objectSpread(_objectSpread({},gt),{},{isTooltipActive:!0});pt.setState(vt),pt.triggerSyncEvent(vt);var St=pt.props.onClick;isFunction$3(St)&&St(vt,yt)}}),_defineProperty$1(pt,"handleMouseDown",function(yt){var gt=pt.props.onMouseDown;if(isFunction$3(gt)){var vt=pt.getMouseInfo(yt);gt(vt,yt)}}),_defineProperty$1(pt,"handleMouseUp",function(yt){var gt=pt.props.onMouseUp;if(isFunction$3(gt)){var vt=pt.getMouseInfo(yt);gt(vt,yt)}}),_defineProperty$1(pt,"handleTouchMove",function(yt){yt.changedTouches!=null&&yt.changedTouches.length>0&&pt.throttleTriggeredAfterMouseMove(yt.changedTouches[0])}),_defineProperty$1(pt,"handleTouchStart",function(yt){yt.changedTouches!=null&&yt.changedTouches.length>0&&pt.handleMouseDown(yt.changedTouches[0])}),_defineProperty$1(pt,"handleTouchEnd",function(yt){yt.changedTouches!=null&&yt.changedTouches.length>0&&pt.handleMouseUp(yt.changedTouches[0])}),_defineProperty$1(pt,"handleDoubleClick",function(yt){var gt=pt.props.onDoubleClick;if(isFunction$3(gt)){var vt=pt.getMouseInfo(yt);gt(vt,yt)}}),_defineProperty$1(pt,"handleContextMenu",function(yt){var gt=pt.props.onContextMenu;if(isFunction$3(gt)){var vt=pt.getMouseInfo(yt);gt(vt,yt)}}),_defineProperty$1(pt,"triggerSyncEvent",function(yt){pt.props.syncId!==void 0&&eventCenter.emit(SYNC_EVENT,pt.props.syncId,yt,pt.eventEmitterSymbol)}),_defineProperty$1(pt,"applySyncEvent",function(yt){var gt=pt.props,vt=gt.layout,St=gt.syncMethod,At=pt.state.updateId,xt=yt.dataStartIndex,wt=yt.dataEndIndex;if(yt.dataStartIndex!==void 0||yt.dataEndIndex!==void 0)pt.setState(_objectSpread({dataStartIndex:xt,dataEndIndex:wt},ot({props:pt.props,dataStartIndex:xt,dataEndIndex:wt,updateId:At},pt.state)));else if(yt.activeTooltipIndex!==void 0){var Ot=yt.chartX,Bt=yt.chartY,Ft=yt.activeTooltipIndex,Pt=pt.state,Rt=Pt.offset,Et=Pt.tooltipTicks;if(!Rt)return;if(typeof St=="function")Ft=St(Et,yt);else if(St==="value"){Ft=-1;for(var _t=0;_t<Et.length;_t++)if(Et[_t].value===yt.activeLabel){Ft=_t;break}}var Mt=_objectSpread(_objectSpread({},Rt),{},{x:Rt.left,y:Rt.top}),Dt=Math.min(Ot,Mt.x+Mt.width),Lt=Math.min(Bt,Mt.y+Mt.height),Ct=Et[Ft]&&Et[Ft].value,kt=getTooltipContent(pt.state,pt.props.data,Ft),jt=Et[Ft]?{x:vt==="horizontal"?Et[Ft].coordinate:Dt,y:vt==="horizontal"?Lt:Et[Ft].coordinate}:originCoordinate;pt.setState(_objectSpread(_objectSpread({},yt),{},{activeLabel:Ct,activeCoordinate:jt,activePayload:kt,activeTooltipIndex:Ft}))}else pt.setState(yt)}),_defineProperty$1(pt,"renderCursor",function(yt){var gt,vt=pt.state,St=vt.isTooltipActive,At=vt.activeCoordinate,xt=vt.activePayload,wt=vt.offset,Ot=vt.activeTooltipIndex,Bt=vt.tooltipAxisBandSize,Ft=pt.getTooltipEventType(),Pt=(gt=yt.props.active)!==null&&gt!==void 0?gt:St,Rt=pt.props.layout,Et=yt.key||"_recharts-cursor";return React$2.createElement(Cursor,{key:Et,activeCoordinate:At,activePayload:xt,activeTooltipIndex:Ot,chartName:_,element:yt,isActive:Pt,layout:Rt,offset:wt,tooltipAxisBandSize:Bt,tooltipEventType:Ft})}),_defineProperty$1(pt,"renderPolarAxis",function(yt,gt,vt){var St=get$4(yt,"type.axisType"),At=get$4(pt.state,"".concat(St,"Map")),xt=yt.type.defaultProps,wt=xt!==void 0?_objectSpread(_objectSpread({},xt),yt.props):yt.props,Ot=At&&At[wt["".concat(St,"Id")]];return reactExports.cloneElement(yt,_objectSpread(_objectSpread({},Ot),{},{className:clsx(St,Ot.className),key:yt.key||"".concat(gt,"-").concat(vt),ticks:getTicksOfAxis(Ot,!0)}))}),_defineProperty$1(pt,"renderPolarGrid",function(yt){var gt=yt.props,vt=gt.radialLines,St=gt.polarAngles,At=gt.polarRadius,xt=pt.state,wt=xt.radiusAxisMap,Ot=xt.angleAxisMap,Bt=getAnyElementOfObject(wt),Ft=getAnyElementOfObject(Ot),Pt=Ft.cx,Rt=Ft.cy,Et=Ft.innerRadius,_t=Ft.outerRadius;return reactExports.cloneElement(yt,{polarAngles:Array.isArray(St)?St:getTicksOfAxis(Ft,!0).map(function(Mt){return Mt.coordinate}),polarRadius:Array.isArray(At)?At:getTicksOfAxis(Bt,!0).map(function(Mt){return Mt.coordinate}),cx:Pt,cy:Rt,innerRadius:Et,outerRadius:_t,key:yt.key||"polar-grid",radialLines:vt})}),_defineProperty$1(pt,"renderLegend",function(){var yt=pt.state.formattedGraphicalItems,gt=pt.props,vt=gt.children,St=gt.width,At=gt.height,xt=pt.props.margin||{},wt=St-(xt.left||0)-(xt.right||0),Ot=getLegendProps({children:vt,formattedGraphicalItems:yt,legendWidth:wt,legendContent:nt});if(!Ot)return null;var Bt=Ot.item,Ft=_objectWithoutProperties(Ot,_excluded);return reactExports.cloneElement(Bt,_objectSpread(_objectSpread({},Ft),{},{chartWidth:St,chartHeight:At,margin:xt,onBBoxUpdate:pt.handleLegendBBoxUpdate}))}),_defineProperty$1(pt,"renderTooltip",function(){var yt,gt=pt.props,vt=gt.children,St=gt.accessibilityLayer,At=findChildByType(vt,Tooltip);if(!At)return null;var xt=pt.state,wt=xt.isTooltipActive,Ot=xt.activeCoordinate,Bt=xt.activePayload,Ft=xt.activeLabel,Pt=xt.offset,Rt=(yt=At.props.active)!==null&&yt!==void 0?yt:wt;return reactExports.cloneElement(At,{viewBox:_objectSpread(_objectSpread({},Pt),{},{x:Pt.left,y:Pt.top}),active:Rt,label:Ft,payload:Rt?Bt:[],coordinate:Ot,accessibilityLayer:St})}),_defineProperty$1(pt,"renderBrush",function(yt){var gt=pt.props,vt=gt.margin,St=gt.data,At=pt.state,xt=At.offset,wt=At.dataStartIndex,Ot=At.dataEndIndex,Bt=At.updateId;return reactExports.cloneElement(yt,{key:yt.key||"_recharts-brush",onChange:combineEventHandlers(pt.handleBrushChange,yt.props.onChange),data:St,x:isNumber(yt.props.x)?yt.props.x:xt.left,y:isNumber(yt.props.y)?yt.props.y:xt.top+xt.height+xt.brushBottom-(vt.bottom||0),width:isNumber(yt.props.width)?yt.props.width:xt.width,startIndex:wt,endIndex:Ot,updateId:"brush-".concat(Bt)})}),_defineProperty$1(pt,"renderReferenceElement",function(yt,gt,vt){if(!yt)return null;var St=pt,At=St.clipPathId,xt=pt.state,wt=xt.xAxisMap,Ot=xt.yAxisMap,Bt=xt.offset,Ft=yt.type.defaultProps||{},Pt=yt.props,Rt=Pt.xAxisId,Et=Rt===void 0?Ft.xAxisId:Rt,_t=Pt.yAxisId,Mt=_t===void 0?Ft.yAxisId:_t;return reactExports.cloneElement(yt,{key:yt.key||"".concat(gt,"-").concat(vt),xAxis:wt[Et],yAxis:Ot[Mt],viewBox:{x:Bt.left,y:Bt.top,width:Bt.width,height:Bt.height},clipPathId:At})}),_defineProperty$1(pt,"renderActivePoints",function(yt){var gt=yt.item,vt=yt.activePoint,St=yt.basePoint,At=yt.childIndex,xt=yt.isRange,wt=[],Ot=gt.props.key,Bt=gt.item.type.defaultProps!==void 0?_objectSpread(_objectSpread({},gt.item.type.defaultProps),gt.item.props):gt.item.props,Ft=Bt.activeDot,Pt=Bt.dataKey,Rt=_objectSpread(_objectSpread({index:At,dataKey:Pt,cx:vt.x,cy:vt.y,r:4,fill:getMainColorOfGraphicItem(gt.item),strokeWidth:2,stroke:"#fff",payload:vt.payload,value:vt.value},filterProps(Ft,!1)),adaptEventHandlers(Ft));return wt.push(ut.renderActiveDot(Ft,Rt,"".concat(Ot,"-activePoint-").concat(At))),St?wt.push(ut.renderActiveDot(Ft,_objectSpread(_objectSpread({},Rt),{},{cx:St.x,cy:St.y}),"".concat(Ot,"-basePoint-").concat(At))):xt&&wt.push(null),wt}),_defineProperty$1(pt,"renderGraphicChild",function(yt,gt,vt){var St=pt.filterFormatItem(yt,gt,vt);if(!St)return null;var At=pt.getTooltipEventType(),xt=pt.state,wt=xt.isTooltipActive,Ot=xt.tooltipAxis,Bt=xt.activeTooltipIndex,Ft=xt.activeLabel,Pt=pt.props.children,Rt=findChildByType(Pt,Tooltip),Et=St.props,_t=Et.points,Mt=Et.isRange,Dt=Et.baseLine,Lt=St.item.type.defaultProps!==void 0?_objectSpread(_objectSpread({},St.item.type.defaultProps),St.item.props):St.item.props,Ct=Lt.activeDot,kt=Lt.hide,jt=Lt.activeBar,Vt=Lt.activeShape,zt=!!(!kt&&wt&&Rt&&(Ct||jt||Vt)),qt={};At!=="axis"&&Rt&&Rt.props.trigger==="click"?qt={onClick:combineEventHandlers(pt.handleItemMouseEnter,yt.props.onClick)}:At!=="axis"&&(qt={onMouseLeave:combineEventHandlers(pt.handleItemMouseLeave,yt.props.onMouseLeave),onMouseEnter:combineEventHandlers(pt.handleItemMouseEnter,yt.props.onMouseEnter)});var Wt=reactExports.cloneElement(yt,_objectSpread(_objectSpread({},St.props),qt));function ir(xr){return typeof Ot.dataKey=="function"?Ot.dataKey(xr.payload):null}if(zt)if(Bt>=0){var or,Qt;if(Ot.dataKey&&!Ot.allowDuplicatedCategory){var gr=typeof Ot.dataKey=="function"?ir:"payload.".concat(Ot.dataKey.toString());or=findEntryInArray(_t,gr,Ft),Qt=Mt&&Dt&&findEntryInArray(Dt,gr,Ft)}else or=_t==null?void 0:_t[Bt],Qt=Mt&&Dt&&Dt[Bt];if(Vt||jt){var ar=yt.props.activeIndex!==void 0?yt.props.activeIndex:Bt;return[reactExports.cloneElement(yt,_objectSpread(_objectSpread(_objectSpread({},St.props),qt),{},{activeIndex:ar})),null,null]}if(!isNil$1(or))return[Wt].concat(_toConsumableArray(pt.renderActivePoints({item:St,activePoint:or,basePoint:Qt,childIndex:Bt,isRange:Mt})))}else{var Ar,er=(Ar=pt.getItemByXY(pt.state.activeCoordinate))!==null&&Ar!==void 0?Ar:{graphicalItem:Wt},sr=er.graphicalItem,Gt=sr.item,Jt=Gt===void 0?yt:Gt,lr=sr.childIndex,dr=_objectSpread(_objectSpread(_objectSpread({},St.props),qt),{},{activeIndex:lr});return[reactExports.cloneElement(Jt,dr),null,null]}return Mt?[Wt,null,null]:[Wt,null]}),_defineProperty$1(pt,"renderCustomized",function(yt,gt,vt){return reactExports.cloneElement(yt,_objectSpread(_objectSpread({key:"recharts-customized-".concat(vt)},pt.props),pt.state))}),_defineProperty$1(pt,"renderMap",{CartesianGrid:{handler:renderAsIs,once:!0},ReferenceArea:{handler:pt.renderReferenceElement},ReferenceLine:{handler:renderAsIs},ReferenceDot:{handler:pt.renderReferenceElement},XAxis:{handler:renderAsIs},YAxis:{handler:renderAsIs},Brush:{handler:pt.renderBrush,once:!0},Bar:{handler:pt.renderGraphicChild},Line:{handler:pt.renderGraphicChild},Area:{handler:pt.renderGraphicChild},Radar:{handler:pt.renderGraphicChild},RadialBar:{handler:pt.renderGraphicChild},Scatter:{handler:pt.renderGraphicChild},Pie:{handler:pt.renderGraphicChild},Funnel:{handler:pt.renderGraphicChild},Tooltip:{handler:pt.renderCursor,once:!0},PolarGrid:{handler:pt.renderPolarGrid,once:!0},PolarAngleAxis:{handler:pt.renderPolarAxis},PolarRadiusAxis:{handler:pt.renderPolarAxis},Customized:{handler:pt.renderCustomized}}),pt.clipPathId="".concat((dt=ht.id)!==null&&dt!==void 0?dt:uniqueId("recharts"),"-clip"),pt.throttleTriggeredAfterMouseMove=throttle$1(pt.triggeredAfterMouseMove,(mt=ht.throttleDelay)!==null&&mt!==void 0?mt:1e3/60),pt.state={},pt}return _inherits(ut,ft),_createClass(ut,[{key:"componentDidMount",value:function(){var dt,mt;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(dt=this.props.margin.left)!==null&&dt!==void 0?dt:0,top:(mt=this.props.margin.top)!==null&&mt!==void 0?mt:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var dt=this.props,mt=dt.children,pt=dt.data,yt=dt.height,gt=dt.layout,vt=findChildByType(mt,Tooltip);if(vt){var St=vt.props.defaultIndex;if(!(typeof St!="number"||St<0||St>this.state.tooltipTicks.length-1)){var At=this.state.tooltipTicks[St]&&this.state.tooltipTicks[St].value,xt=getTooltipContent(this.state,pt,St,At),wt=this.state.tooltipTicks[St].coordinate,Ot=(this.state.offset.top+yt)/2,Bt=gt==="horizontal",Ft=Bt?{x:wt,y:Ot}:{y:wt,x:Ot},Pt=this.state.formattedGraphicalItems.find(function(Et){var _t=Et.item;return _t.type.name==="Scatter"});Pt&&(Ft=_objectSpread(_objectSpread({},Ft),Pt.props.points[St].tooltipPosition),xt=Pt.props.points[St].tooltipPayload);var Rt={activeTooltipIndex:St,isTooltipActive:!0,activeLabel:At,activePayload:xt,activeCoordinate:Ft};this.setState(Rt),this.renderCursor(vt),this.accessibilityManager.setIndex(St)}}}},{key:"getSnapshotBeforeUpdate",value:function(dt,mt){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==mt.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==dt.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==dt.margin){var pt,yt;this.accessibilityManager.setDetails({offset:{left:(pt=this.props.margin.left)!==null&&pt!==void 0?pt:0,top:(yt=this.props.margin.top)!==null&&yt!==void 0?yt:0}})}return null}},{key:"componentDidUpdate",value:function(dt){isChildrenEqual([findChildByType(dt.children,Tooltip)],[findChildByType(this.props.children,Tooltip)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var dt=findChildByType(this.props.children,Tooltip);if(dt&&typeof dt.props.shared=="boolean"){var mt=dt.props.shared?"axis":"item";return tt.indexOf(mt)>=0?mt:_e}return _e}},{key:"getMouseInfo",value:function(dt){if(!this.container)return null;var mt=this.container,pt=mt.getBoundingClientRect(),yt=getOffset(pt),gt={chartX:Math.round(dt.pageX-yt.left),chartY:Math.round(dt.pageY-yt.top)},vt=pt.width/mt.offsetWidth||1,St=this.inRange(gt.chartX,gt.chartY,vt);if(!St)return null;var At=this.state,xt=At.xAxisMap,wt=At.yAxisMap,Ot=this.getTooltipEventType(),Bt=getTooltipData(this.state,this.props.data,this.props.layout,St);if(Ot!=="axis"&&xt&&wt){var Ft=getAnyElementOfObject(xt).scale,Pt=getAnyElementOfObject(wt).scale,Rt=Ft&&Ft.invert?Ft.invert(gt.chartX):null,Et=Pt&&Pt.invert?Pt.invert(gt.chartY):null;return _objectSpread(_objectSpread({},gt),{},{xValue:Rt,yValue:Et},Bt)}return Bt?_objectSpread(_objectSpread({},gt),Bt):null}},{key:"inRange",value:function(dt,mt){var pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,yt=this.props.layout,gt=dt/pt,vt=mt/pt;if(yt==="horizontal"||yt==="vertical"){var St=this.state.offset,At=gt>=St.left&&gt<=St.left+St.width&&vt>=St.top&&vt<=St.top+St.height;return At?{x:gt,y:vt}:null}var xt=this.state,wt=xt.angleAxisMap,Ot=xt.radiusAxisMap;if(wt&&Ot){var Bt=getAnyElementOfObject(wt);return inRangeOfSector({x:gt,y:vt},Bt)}return null}},{key:"parseEventsOfWrapper",value:function(){var dt=this.props.children,mt=this.getTooltipEventType(),pt=findChildByType(dt,Tooltip),yt={};pt&&mt==="axis"&&(pt.props.trigger==="click"?yt={onClick:this.handleClick}:yt={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var gt=adaptEventHandlers(this.props,this.handleOuterEvent);return _objectSpread(_objectSpread({},gt),yt)}},{key:"addListener",value:function(){eventCenter.on(SYNC_EVENT,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){eventCenter.removeListener(SYNC_EVENT,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(dt,mt,pt){for(var yt=this.state.formattedGraphicalItems,gt=0,vt=yt.length;gt<vt;gt++){var St=yt[gt];if(St.item===dt||St.props.key===dt.key||mt===getDisplayName(St.item.type)&&pt===St.childIndex)return St}return null}},{key:"renderClipPath",value:function(){var dt=this.clipPathId,mt=this.state.offset,pt=mt.left,yt=mt.top,gt=mt.height,vt=mt.width;return React$2.createElement("defs",null,React$2.createElement("clipPath",{id:dt},React$2.createElement("rect",{x:pt,y:yt,height:gt,width:vt})))}},{key:"getXScales",value:function(){var dt=this.state.xAxisMap;return dt?Object.entries(dt).reduce(function(mt,pt){var yt=_slicedToArray(pt,2),gt=yt[0],vt=yt[1];return _objectSpread(_objectSpread({},mt),{},_defineProperty$1({},gt,vt.scale))},{}):null}},{key:"getYScales",value:function(){var dt=this.state.yAxisMap;return dt?Object.entries(dt).reduce(function(mt,pt){var yt=_slicedToArray(pt,2),gt=yt[0],vt=yt[1];return _objectSpread(_objectSpread({},mt),{},_defineProperty$1({},gt,vt.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(dt){var mt;return(mt=this.state.xAxisMap)===null||mt===void 0||(mt=mt[dt])===null||mt===void 0?void 0:mt.scale}},{key:"getYScaleByAxisId",value:function(dt){var mt;return(mt=this.state.yAxisMap)===null||mt===void 0||(mt=mt[dt])===null||mt===void 0?void 0:mt.scale}},{key:"getItemByXY",value:function(dt){var mt=this.state,pt=mt.formattedGraphicalItems,yt=mt.activeItem;if(pt&&pt.length)for(var gt=0,vt=pt.length;gt<vt;gt++){var St=pt[gt],At=St.props,xt=St.item,wt=xt.type.defaultProps!==void 0?_objectSpread(_objectSpread({},xt.type.defaultProps),xt.props):xt.props,Ot=getDisplayName(xt.type);if(Ot==="Bar"){var Bt=(At.data||[]).find(function(Et){return isInRectangle(dt,Et)});if(Bt)return{graphicalItem:St,payload:Bt}}else if(Ot==="RadialBar"){var Ft=(At.data||[]).find(function(Et){return inRangeOfSector(dt,Et)});if(Ft)return{graphicalItem:St,payload:Ft}}else if(isFunnel(St,yt)||isPie(St,yt)||isScatter(St,yt)){var Pt=getActiveShapeIndexForTooltip({graphicalItem:St,activeTooltipItem:yt,itemData:wt.data}),Rt=wt.activeIndex===void 0?Pt:wt.activeIndex;return{graphicalItem:_objectSpread(_objectSpread({},St),{},{childIndex:Rt}),payload:isScatter(St,yt)?wt.data[Pt]:St.props.data[Pt]}}}return null}},{key:"render",value:function(){var dt=this;if(!validateWidthHeight(this))return null;var mt=this.props,pt=mt.children,yt=mt.className,gt=mt.width,vt=mt.height,St=mt.style,At=mt.compact,xt=mt.title,wt=mt.desc,Ot=_objectWithoutProperties(mt,_excluded2),Bt=filterProps(Ot,!1);if(At)return React$2.createElement(ChartLayoutContextProvider,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},React$2.createElement(Surface,_extends$1({},Bt,{width:gt,height:vt,title:xt,desc:wt}),this.renderClipPath(),renderByOrder(pt,this.renderMap)));if(this.props.accessibilityLayer){var Ft,Pt;Bt.tabIndex=(Ft=this.props.tabIndex)!==null&&Ft!==void 0?Ft:0,Bt.role=(Pt=this.props.role)!==null&&Pt!==void 0?Pt:"application",Bt.onKeyDown=function(Et){dt.accessibilityManager.keyboardEvent(Et)},Bt.onFocus=function(){dt.accessibilityManager.focus()}}var Rt=this.parseEventsOfWrapper();return React$2.createElement(ChartLayoutContextProvider,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},React$2.createElement("div",_extends$1({className:clsx("recharts-wrapper",yt),style:_objectSpread({position:"relative",cursor:"default",width:gt,height:vt},St)},Rt,{ref:function(_t){dt.container=_t}}),React$2.createElement(Surface,_extends$1({},Bt,{width:gt,height:vt,title:xt,desc:wt,style:FULL_WIDTH_AND_HEIGHT}),this.renderClipPath(),renderByOrder(pt,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(reactExports.Component);_defineProperty$1(lt,"displayName",_),_defineProperty$1(lt,"defaultProps",_objectSpread({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},st)),_defineProperty$1(lt,"getDerivedStateFromProps",function(ft,ut){var ht=ft.dataKey,dt=ft.data,mt=ft.children,pt=ft.width,yt=ft.height,gt=ft.layout,vt=ft.stackOffset,St=ft.margin,At=ut.dataStartIndex,xt=ut.dataEndIndex;if(ut.updateId===void 0){var wt=createDefaultState(ft);return _objectSpread(_objectSpread(_objectSpread({},wt),{},{updateId:0},ot(_objectSpread(_objectSpread({props:ft},wt),{},{updateId:0}),ut)),{},{prevDataKey:ht,prevData:dt,prevWidth:pt,prevHeight:yt,prevLayout:gt,prevStackOffset:vt,prevMargin:St,prevChildren:mt})}if(ht!==ut.prevDataKey||dt!==ut.prevData||pt!==ut.prevWidth||yt!==ut.prevHeight||gt!==ut.prevLayout||vt!==ut.prevStackOffset||!shallowEqual(St,ut.prevMargin)){var Ot=createDefaultState(ft),Bt={chartX:ut.chartX,chartY:ut.chartY,isTooltipActive:ut.isTooltipActive},Ft=_objectSpread(_objectSpread({},getTooltipData(ut,dt,gt)),{},{updateId:ut.updateId+1}),Pt=_objectSpread(_objectSpread(_objectSpread({},Ot),Bt),Ft);return _objectSpread(_objectSpread(_objectSpread({},Pt),ot(_objectSpread({props:ft},Pt),ut)),{},{prevDataKey:ht,prevData:dt,prevWidth:pt,prevHeight:yt,prevLayout:gt,prevStackOffset:vt,prevMargin:St,prevChildren:mt})}if(!isChildrenEqual(mt,ut.prevChildren)){var Rt,Et,_t,Mt,Dt=findChildByType(mt,Brush),Lt=Dt&&(Rt=(Et=Dt.props)===null||Et===void 0?void 0:Et.startIndex)!==null&&Rt!==void 0?Rt:At,Ct=Dt&&(_t=(Mt=Dt.props)===null||Mt===void 0?void 0:Mt.endIndex)!==null&&_t!==void 0?_t:xt,kt=Lt!==At||Ct!==xt,jt=!isNil$1(dt),Vt=jt&&!kt?ut.updateId:ut.updateId+1;return _objectSpread(_objectSpread({updateId:Vt},ot(_objectSpread(_objectSpread({props:ft},ut),{},{updateId:Vt,dataStartIndex:Lt,dataEndIndex:Ct}),ut)),{},{prevChildren:mt,dataStartIndex:Lt,dataEndIndex:Ct})}return null}),_defineProperty$1(lt,"renderActiveDot",function(ft,ut,ht){var dt;return reactExports.isValidElement(ft)?dt=reactExports.cloneElement(ft,ut):isFunction$3(ft)?dt=ft(ut):dt=React$2.createElement(Dot,ut),React$2.createElement(Layer,{className:"recharts-active-dot",key:ht},dt)});var ct=reactExports.forwardRef(function(ut,ht){return React$2.createElement(lt,_extends$1({},ut,{ref:ht}))});return ct.displayName=lt.displayName,ct},LineChart=generateCategoricalChart({chartName:"LineChart",GraphicalChild:Line,axisComponents:[{axisType:"xAxis",AxisComp:XAxis},{axisType:"yAxis",AxisComp:YAxis}],formatAxisMap}),BarChart=generateCategoricalChart({chartName:"BarChart",GraphicalChild:Bar,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:XAxis},{axisType:"yAxis",AxisComp:YAxis}],formatAxisMap}),PieChart=generateCategoricalChart({chartName:"PieChart",GraphicalChild:Pie,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:PolarAngleAxis},{axisType:"radiusAxis",AxisComp:PolarRadiusAxis}],formatAxisMap:formatAxisMap$1,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const COLORS=["#059669","#D97706","#0891B2"];function Dashboard(){const o=reactExports.useMemo(()=>[{name:" 1",progress:20},{name:" 2",progress:35},{name:" 3",progress:55},{name:" 4",progress:72}],[]),i=reactExports.useMemo(()=>[{name:"",score:82},{name:"",score:76},{name:"",score:91}],[]),_=reactExports.useMemo(()=>[{name:"",value:12},{name:" ",value:7},{name:" ",value:5}],[]);return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold",children:" "}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("div",{className:"h-40",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(LineChart,{data:o,margin:{left:-10,right:0,top:10,bottom:0},children:[jsxRuntimeExports.jsx(XAxis,{dataKey:"name",hide:!0}),jsxRuntimeExports.jsx(YAxis,{hide:!0,domain:[0,100]}),jsxRuntimeExports.jsx(Tooltip,{}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"progress",stroke:"#059669",strokeWidth:2,dot:!1})]})})})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("div",{className:"h-40",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(BarChart,{data:i,margin:{left:-20,right:0,top:10,bottom:0},children:[jsxRuntimeExports.jsx(XAxis,{dataKey:"name"}),jsxRuntimeExports.jsx(YAxis,{domain:[0,100]}),jsxRuntimeExports.jsx(Tooltip,{}),jsxRuntimeExports.jsx(Bar,{dataKey:"score",fill:"#D97706",radius:[8,8,0,0]})]})})})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("div",{className:"h-40",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsx(PieChart,{children:jsxRuntimeExports.jsx(Pie,{data:_,dataKey:"value",nameKey:"name",innerRadius:40,outerRadius:60,paddingAngle:4,children:_.map(($,j)=>jsxRuntimeExports.jsx(Cell,{fill:COLORS[j%COLORS.length]},j))})})})})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-3 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-sm",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-border/60 text-muted",children:[jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""})]})}),jsxRuntimeExports.jsx("tbody",{children:[{s:"",t:" ",d:"2025-10-01"},{s:"",t:" ",d:"2025-10-05"}].map(($,j)=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-border/40 hover:bg-warm-gradient",children:[jsxRuntimeExports.jsx("td",{className:"p-2",children:$.s}),jsxRuntimeExports.jsx("td",{className:"p-2",children:$.t}),jsxRuntimeExports.jsx("td",{className:"p-2",children:$.d}),jsxRuntimeExports.jsx("td",{className:"p-2",children:jsxRuntimeExports.jsx(Link,{to:"/quiz/demo",className:"btn btn-secondary",children:""})})]},j))})]})})]})]})}function Subject(){const{subjectId:o}=useParams();return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold",children:[": ",o]}),jsxRuntimeExports.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4].map(i=>jsxRuntimeExports.jsxs(Link,{to:`/sections/${i}`,className:"rounded-xl bg-surface p-4 shadow-soft-warm hover:bg-warm-gradient",children:[" ",i]},i))})]})}function Section(){const{sectionId:o}=useParams();return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold",children:[": ",o]}),jsxRuntimeExports.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(i=>jsxRuntimeExports.jsxs(Link,{to:`/lessons/${o}-${i}`,className:"rounded-xl bg-surface p-4 shadow-soft-warm hover:bg-warm-gradient",children:[" ",i]},i))})]})}const isFiniteNumber=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},isSafeInteger=Number.isSafeInteger||function(o){return typeof o=="number"&&Math.abs(o)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;let ErrorTypes=function(o){return o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError",o}({}),ErrorDetails=function(o){return o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",o.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",o.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",o.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",o.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",o.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",o.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_PARSING_ERROR="levelParsingError",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.FRAG_GAP="fragGap",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.ASSET_LIST_LOAD_ERROR="assetListLoadError",o.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",o.ASSET_LIST_PARSING_ERROR="assetListParsingError",o.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.ATTACH_MEDIA_ERROR="attachMediaError",o.UNKNOWN="unknown",o}({}),Events=function(o){return o.MEDIA_ATTACHING="hlsMediaAttaching",o.MEDIA_ATTACHED="hlsMediaAttached",o.MEDIA_DETACHING="hlsMediaDetaching",o.MEDIA_DETACHED="hlsMediaDetached",o.MEDIA_ENDED="hlsMediaEnded",o.STALL_RESOLVED="hlsStallResolved",o.BUFFER_RESET="hlsBufferReset",o.BUFFER_CODECS="hlsBufferCodecs",o.BUFFER_CREATED="hlsBufferCreated",o.BUFFER_APPENDING="hlsBufferAppending",o.BUFFER_APPENDED="hlsBufferAppended",o.BUFFER_EOS="hlsBufferEos",o.BUFFERED_TO_END="hlsBufferedToEnd",o.BUFFER_FLUSHING="hlsBufferFlushing",o.BUFFER_FLUSHED="hlsBufferFlushed",o.MANIFEST_LOADING="hlsManifestLoading",o.MANIFEST_LOADED="hlsManifestLoaded",o.MANIFEST_PARSED="hlsManifestParsed",o.LEVEL_SWITCHING="hlsLevelSwitching",o.LEVEL_SWITCHED="hlsLevelSwitched",o.LEVEL_LOADING="hlsLevelLoading",o.LEVEL_LOADED="hlsLevelLoaded",o.LEVEL_UPDATED="hlsLevelUpdated",o.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",o.LEVELS_UPDATED="hlsLevelsUpdated",o.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",o.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",o.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",o.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",o.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",o.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",o.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",o.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",o.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",o.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",o.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",o.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",o.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",o.CUES_PARSED="hlsCuesParsed",o.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",o.INIT_PTS_FOUND="hlsInitPtsFound",o.FRAG_LOADING="hlsFragLoading",o.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",o.FRAG_LOADED="hlsFragLoaded",o.FRAG_DECRYPTED="hlsFragDecrypted",o.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",o.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",o.FRAG_PARSING_METADATA="hlsFragParsingMetadata",o.FRAG_PARSED="hlsFragParsed",o.FRAG_BUFFERED="hlsFragBuffered",o.FRAG_CHANGED="hlsFragChanged",o.FPS_DROP="hlsFpsDrop",o.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",o.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",o.ERROR="hlsError",o.DESTROYING="hlsDestroying",o.KEY_LOADING="hlsKeyLoading",o.KEY_LOADED="hlsKeyLoaded",o.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",o.BACK_BUFFER_REACHED="hlsBackBufferReached",o.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",o.ASSET_LIST_LOADING="hlsAssetListLoading",o.ASSET_LIST_LOADED="hlsAssetListLoaded",o.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",o.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",o.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",o.INTERSTITIAL_STARTED="hlsInterstitialStarted",o.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",o.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",o.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",o.INTERSTITIAL_ENDED="hlsInterstitialEnded",o.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",o.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",o.EVENT_CUE_ENTER="hlsEventCueEnter",o}({});var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class EWMA{constructor(i,_=0,$=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=i,this.alpha_=i?Math.exp(Math.log(.5)/i):0,this.estimate_=_,this.totalWeight_=$}sample(i,_){const $=Math.pow(this.alpha_,i);this.estimate_=_*(1-$)+$*this.estimate_,this.totalWeight_+=i}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const i=1-Math.pow(this.alpha_,this.totalWeight_);if(i)return this.estimate_/i}return this.estimate_}}class EwmaBandWidthEstimator{constructor(i,_,$,j=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=$,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(i),this.fast_=new EWMA(_),this.defaultTTFB_=j,this.ttfb_=new EWMA(i)}update(i,_){const{slow_:$,fast_:j,ttfb_:_e}=this;$.halfLife!==i&&(this.slow_=new EWMA(i,$.getEstimate(),$.getTotalWeight())),j.halfLife!==_&&(this.fast_=new EWMA(_,j.getEstimate(),j.getTotalWeight())),_e.halfLife!==i&&(this.ttfb_=new EWMA(i,_e.getEstimate(),_e.getTotalWeight()))}sample(i,_){i=Math.max(i,this.minDelayMs_);const $=8*_,j=i/1e3,_e=$/j;this.fast_.sample(j,_e),this.slow_.sample(j,_e)}sampleTTFB(i){const _=i/1e3,$=Math.sqrt(2)*Math.exp(-Math.pow(_,2)/2);this.ttfb_.sample($,Math.max(i,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function _defineProperty(o,i,_){return(i=_toPropertyKey(i))in o?Object.defineProperty(o,i,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[i]=_,o}function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var _=arguments[i];for(var $ in _)({}).hasOwnProperty.call(_,$)&&(o[$]=_[$])}return o},_extends.apply(null,arguments)}function ownKeys(o,i){var _=Object.keys(o);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(o);i&&($=$.filter(function(j){return Object.getOwnPropertyDescriptor(o,j).enumerable})),_.push.apply(_,$)}return _}function _objectSpread2(o){for(var i=1;i<arguments.length;i++){var _=arguments[i]!=null?arguments[i]:{};i%2?ownKeys(Object(_),!0).forEach(function($){_defineProperty(o,$,_[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(_)):ownKeys(Object(_)).forEach(function($){Object.defineProperty(o,$,Object.getOwnPropertyDescriptor(_,$))})}return o}function _toPrimitive(o,i){if(typeof o!="object"||!o)return o;var _=o[Symbol.toPrimitive];if(_!==void 0){var $=_.call(o,i);if(typeof $!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(o)}function _toPropertyKey(o){var i=_toPrimitive(o,"string");return typeof i=="symbol"?i:i+""}let Logger$1=class{constructor(i,_){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const $=`[${i}]:`;this.trace=noop$3,this.debug=_.debug.bind(null,$),this.log=_.log.bind(null,$),this.warn=_.warn.bind(null,$),this.info=_.info.bind(null,$),this.error=_.error.bind(null,$)}};const noop$3=function o(){},fakeLogger={trace:noop$3,debug:noop$3,log:noop$3,warn:noop$3,info:noop$3,error:noop$3};function createLogger(){return _extends({},fakeLogger)}function consolePrintFn(o,i){const _=self.console[o];return _?_.bind(self.console,`${i?"["+i+"] ":""}[${o}] >`):noop$3}function getLoggerFn(o,i,_){return i[o]?i[o].bind(i):consolePrintFn(o,_)}const exportedLogger=createLogger();function enableLogs(o,i,_){const $=createLogger();if(typeof console=="object"&&o===!0||typeof o=="object"){const j=["debug","log","info","warn","error"];j.forEach(_e=>{$[_e]=getLoggerFn(_e,o,_)});try{$.log(`Debug logs enabled for "${i}" in hls.js version 1.6.12`)}catch{return createLogger()}j.forEach(_e=>{exportedLogger[_e]=getLoggerFn(_e,o)})}else _extends(exportedLogger,$);return $}const logger=exportedLogger;function getMediaSource(o=!0){return typeof self>"u"?void 0:(o||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function isManagedMediaSource(o){return typeof self<"u"&&o===self.ManagedMediaSource}function isCompatibleTrackChange(o,i){const _=Object.keys(o),$=Object.keys(i),j=_.length,_e=$.length;return!j||!_e||j===_e&&!_.some(et=>$.indexOf(et)===-1)}function utf8ArrayToStr(o,i=!1){if(typeof TextDecoder<"u"){const nt=new TextDecoder("utf-8").decode(o);if(i){const it=nt.indexOf("\0");return it!==-1?nt.substring(0,it):nt}return nt.replace(/\0/g,"")}const _=o.length;let $,j,_e,et="",tt=0;for(;tt<_;){if($=o[tt++],$===0&&i)return et;if($===0||$===3)continue;switch($>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:et+=String.fromCharCode($);break;case 12:case 13:j=o[tt++],et+=String.fromCharCode(($&31)<<6|j&63);break;case 14:j=o[tt++],_e=o[tt++],et+=String.fromCharCode(($&15)<<12|(j&63)<<6|(_e&63)<<0);break}}return et}function arrayToHex(o){let i="";for(let _=0;_<o.length;_++){let $=o[_].toString(16);$.length<2&&($="0"+$),i+=$}return i}function hexToArrayBuffer(o){return Uint8Array.from(o.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var urlToolkit={exports:{}},hasRequiredUrlToolkit;function requireUrlToolkit(){return hasRequiredUrlToolkit||(hasRequiredUrlToolkit=1,function(o,i){(function(_){var $=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,j=/^(?=([^\/?#]*))\1([^]*)$/,_e=/(?:\/|^)\.(?=\/)/g,et=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,tt={buildAbsoluteURL:function(rt,nt,it){if(it=it||{},rt=rt.trim(),nt=nt.trim(),!nt){if(!it.alwaysNormalize)return rt;var st=tt.parseURL(rt);if(!st)throw new Error("Error trying to parse base URL.");return st.path=tt.normalizePath(st.path),tt.buildURLFromParts(st)}var at=tt.parseURL(nt);if(!at)throw new Error("Error trying to parse relative URL.");if(at.scheme)return it.alwaysNormalize?(at.path=tt.normalizePath(at.path),tt.buildURLFromParts(at)):nt;var ot=tt.parseURL(rt);if(!ot)throw new Error("Error trying to parse base URL.");if(!ot.netLoc&&ot.path&&ot.path[0]!=="/"){var lt=j.exec(ot.path);ot.netLoc=lt[1],ot.path=lt[2]}ot.netLoc&&!ot.path&&(ot.path="/");var ct={scheme:ot.scheme,netLoc:at.netLoc,path:null,params:at.params,query:at.query,fragment:at.fragment};if(!at.netLoc&&(ct.netLoc=ot.netLoc,at.path[0]!=="/"))if(!at.path)ct.path=ot.path,at.params||(ct.params=ot.params,at.query||(ct.query=ot.query));else{var ft=ot.path,ut=ft.substring(0,ft.lastIndexOf("/")+1)+at.path;ct.path=tt.normalizePath(ut)}return ct.path===null&&(ct.path=it.alwaysNormalize?tt.normalizePath(at.path):at.path),tt.buildURLFromParts(ct)},parseURL:function(rt){var nt=$.exec(rt);return nt?{scheme:nt[1]||"",netLoc:nt[2]||"",path:nt[3]||"",params:nt[4]||"",query:nt[5]||"",fragment:nt[6]||""}:null},normalizePath:function(rt){for(rt=rt.split("").reverse().join("").replace(_e,"");rt.length!==(rt=rt.replace(et,"")).length;);return rt.split("").reverse().join("")},buildURLFromParts:function(rt){return rt.scheme+rt.netLoc+rt.path+rt.params+rt.query+rt.fragment}};o.exports=tt})()}(urlToolkit)),urlToolkit.exports}var urlToolkitExports=requireUrlToolkit();class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(i){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof i=="string"&&(i={url:i}),this.base=i,makeEnumerable(this,"stats")}setByteRange(i,_){const $=i.split("@",2);let j;$.length===1?j=(_==null?void 0:_.byteRangeEndOffset)||0:j=parseInt($[1]),this._byteRange=[j,parseInt($[0])+j]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(i){this._streams=i}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new LoadStats),this._stats}set stats(i){this._stats=i}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(i){this._url=i}clearElementaryStreamInfo(){const{elementaryStreams:i}=this;i[ElementaryStreamTypes.AUDIO]=null,i[ElementaryStreamTypes.VIDEO]=null,i[ElementaryStreamTypes.AUDIOVIDEO]=null}}function isMediaFragment(o){return o.sn!=="initSegment"}class Fragment extends BaseSegment{constructor(i,_){super(_),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=i}get byteLength(){if(this.hasStats){const i=this.stats.total;if(i)return i}if(this.byteRange.length){const i=this.byteRange[0],_=this.byteRange[1];if(isFiniteNumber(i)&&isFiniteNumber(_))return _-i}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(i){this._bitrate=i}get decryptdata(){const{levelkeys:i}=this;if(!i&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const _=this.levelkeys.identity;if(_)this._decryptdata=_.getDecryptData(this.sn);else{const $=Object.keys(this.levelkeys);if($.length===1){const j=this._decryptdata=this.levelkeys[$[0]]||null;if(j)return j.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const i=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+i*1e3}get encrypted(){var i;if((i=this._decryptdata)!=null&&i.encrypted)return!0;if(this.levelkeys){var _;const $=Object.keys(this.levelkeys),j=$.length;if(j>1||j===1&&(_=this.levelkeys[$[0]])!=null&&_.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(i){if(!isFiniteNumber(i)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=i}get ref(){return isMediaFragment(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(i){this.setStart(this.start+i)}setStart(i){this.start=i,this._ref&&(this._ref.start=i)}setDuration(i){this.duration=i,this._ref&&(this._ref.duration=i)}setKeyFormat(i){if(this.levelkeys){const _=this.levelkeys[i];_&&!this._decryptdata&&(this._decryptdata=_.getDecryptData(this.sn))}}abortRequests(){var i,_;(i=this.loader)==null||i.abort(),(_=this.keyLoader)==null||_.abort()}setElementaryStreamInfo(i,_,$,j,_e,et=!1){const{elementaryStreams:tt}=this,rt=tt[i];if(!rt){tt[i]={startPTS:_,endPTS:$,startDTS:j,endDTS:_e,partial:et};return}rt.startPTS=Math.min(rt.startPTS,_),rt.endPTS=Math.max(rt.endPTS,$),rt.startDTS=Math.min(rt.startDTS,j),rt.endDTS=Math.max(rt.endDTS,_e)}}class Part extends BaseSegment{constructor(i,_,$,j,_e){super($),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=i.decimalFloatingPoint("DURATION"),this.gap=i.bool("GAP"),this.independent=i.bool("INDEPENDENT"),this.relurl=i.enumeratedString("URI"),this.fragment=_,this.index=j;const et=i.enumeratedString("BYTERANGE");et&&this.setByteRange(et,_e),_e&&(this.fragOffset=_e.fragOffset+_e.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:i}=this;return!!(i.audio||i.video||i.audiovideo)}}function getOwnPropertyDescriptorFromPrototypeChain(o,i){const _=Object.getPrototypeOf(o);if(_){const $=Object.getOwnPropertyDescriptor(_,i);return $||getOwnPropertyDescriptorFromPrototypeChain(_,i)}}function makeEnumerable(o,i){const _=getOwnPropertyDescriptorFromPrototypeChain(o,i);_&&(_.enumerable=!0,Object.defineProperty(o,i,_))}const UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(o){return String.fromCharCode.apply(null,o)}function readUint16(o,i){const _=o[i]<<8|o[i+1];return _<0?65536+_:_}function readUint32(o,i){const _=readSint32(o,i);return _<0?4294967296+_:_}function readUint64(o,i){let _=readUint32(o,i);return _*=Math.pow(2,32),_+=readUint32(o,i+4),_}function readSint32(o,i){return o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3]}function hasMoofData(o){const i=o.byteLength;for(let _=0;_<i;){const $=readUint32(o,_);if($>8&&o[_+4]===109&&o[_+5]===111&&o[_+6]===111&&o[_+7]===102)return!0;_=$>1?_+$:i}return!1}function findBox(o,i){const _=[];if(!i.length)return _;const $=o.byteLength;for(let j=0;j<$;){const _e=readUint32(o,j),et=bin2str(o.subarray(j+4,j+8)),tt=_e>1?j+_e:$;if(et===i[0])if(i.length===1)_.push(o.subarray(j+8,tt));else{const rt=findBox(o.subarray(j+8,tt),i.slice(1));rt.length&&push.apply(_,rt)}j=tt}return _}function parseSegmentIndex(o){const i=[],_=o[0];let $=8;const j=readUint32(o,$);$+=4;let _e=0,et=0;_===0?(_e=readUint32(o,$),et=readUint32(o,$+4),$+=8):(_e=readUint64(o,$),et=readUint64(o,$+8),$+=16),$+=2;let tt=o.length+et;const rt=readUint16(o,$);$+=2;for(let nt=0;nt<rt;nt++){let it=$;const st=readUint32(o,it);it+=4;const at=st&2147483647;if((st&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const lt=readUint32(o,it);it+=4,i.push({referenceSize:at,subsegmentDuration:lt,info:{duration:lt/j,start:tt,end:tt+at-1}}),tt+=at,it+=4,$=it}return{earliestPresentationTime:_e,timescale:j,version:_,referencesCount:rt,references:i}}function parseInitSegment(o){const i=[],_=findBox(o,["moov","trak"]);for(let j=0;j<_.length;j++){const _e=_[j],et=findBox(_e,["tkhd"])[0];if(et){let tt=et[0];const rt=readUint32(et,tt===0?12:20),nt=findBox(_e,["mdia","mdhd"])[0];if(nt){tt=nt[0];const it=readUint32(nt,tt===0?12:20),st=findBox(_e,["mdia","hdlr"])[0];if(st){const at=bin2str(st.subarray(8,12)),ot={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[at],lt=findBox(_e,["mdia","minf","stbl","stsd"])[0],ct=parseStsd(lt);ot?(i[rt]={timescale:it,type:ot,stsd:ct},i[ot]=_objectSpread2({timescale:it,id:rt},ct)):i[rt]={timescale:it,type:at,stsd:ct}}}}}return findBox(o,["moov","mvex","trex"]).forEach(j=>{const _e=readUint32(j,4),et=i[_e];et&&(et.default={duration:readUint32(j,12),flags:readUint32(j,20)})}),i}function parseStsd(o){const i=o.subarray(8),_=i.subarray(86),$=bin2str(i.subarray(4,8));let j=$,_e;const et=$==="enca"||$==="encv";if(et){const nt=findBox(i,[$])[0].subarray($==="enca"?28:78);findBox(nt,["sinf"]).forEach(st=>{const at=findBox(st,["schm"])[0];if(at){const ot=bin2str(at.subarray(4,8));if(ot==="cbcs"||ot==="cenc"){const lt=findBox(st,["frma"])[0];lt&&(j=bin2str(lt))}}})}const tt=j;switch(j){case"avc1":case"avc2":case"avc3":case"avc4":{const rt=findBox(_,["avcC"])[0];rt&&rt.length>3&&(j+="."+toHex(rt[1])+toHex(rt[2])+toHex(rt[3]),_e=parseSupplementalDoViCodec(tt==="avc1"?"dva1":"dvav",_));break}case"mp4a":{const rt=findBox(i,[$])[0],nt=findBox(rt.subarray(28),["esds"])[0];if(nt&&nt.length>7){let it=4;if(nt[it++]!==3)break;it=skipBERInteger(nt,it),it+=2;const st=nt[it++];if(st&128&&(it+=2),st&64&&(it+=nt[it++]),nt[it++]!==4)break;it=skipBERInteger(nt,it);const at=nt[it++];if(at===64)j+="."+toHex(at);else break;if(it+=12,nt[it++]!==5)break;it=skipBERInteger(nt,it);const ot=nt[it++];let lt=(ot&248)>>3;lt===31&&(lt+=1+((ot&7)<<3)+((nt[it]&224)>>5)),j+="."+lt}break}case"hvc1":case"hev1":{const rt=findBox(_,["hvcC"])[0];if(rt&&rt.length>12){const nt=rt[1],it=["","A","B","C"][nt>>6],st=nt&31,at=readUint32(rt,2),ot=(nt&32)>>5?"H":"L",lt=rt[12],ct=rt.subarray(6,12);j+="."+it+st,j+="."+reverse32BitInt(at).toString(16).toUpperCase(),j+="."+ot+lt;let ft="";for(let ut=ct.length;ut--;){const ht=ct[ut];(ht||ft)&&(ft="."+ht.toString(16).toUpperCase()+ft)}j+=ft}_e=parseSupplementalDoViCodec(tt=="hev1"?"dvhe":"dvh1",_);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{j=parseSupplementalDoViCodec(j,_)||j;break}case"vp09":{const rt=findBox(_,["vpcC"])[0];if(rt&&rt.length>6){const nt=rt[4],it=rt[5],st=rt[6]>>4&15;j+="."+addLeadingZero(nt)+"."+addLeadingZero(it)+"."+addLeadingZero(st)}break}case"av01":{const rt=findBox(_,["av1C"])[0];if(rt&&rt.length>2){const nt=rt[1]>>>5,it=rt[1]&31,st=rt[2]>>>7?"H":"M",at=(rt[2]&64)>>6,ot=(rt[2]&32)>>5,lt=nt===2&&at?ot?12:10:at?10:8,ct=(rt[2]&16)>>4,ft=(rt[2]&8)>>3,ut=(rt[2]&4)>>2,ht=rt[2]&3;j+="."+nt+"."+addLeadingZero(it)+st+"."+addLeadingZero(lt)+"."+ct+"."+ft+ut+ht+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+0,_e=parseSupplementalDoViCodec("dav1",_)}break}}return{codec:j,encrypted:et,supplemental:_e}}function parseSupplementalDoViCodec(o,i){const _=findBox(i,["dvvC"]),$=_.length?_[0]:findBox(i,["dvcC"])[0];if($){const j=$[2]>>1&127,_e=$[2]<<5&32|$[3]>>3&31;return o+"."+addLeadingZero(j)+"."+addLeadingZero(_e)}}function reverse32BitInt(o){let i=0;for(let _=0;_<32;_++)i|=(o>>_&1)<<31-_;return i>>>0}function skipBERInteger(o,i){const _=i+5;for(;o[i++]&128&&i<_;);return i}function toHex(o){return("0"+o.toString(16).toUpperCase()).slice(-2)}function addLeadingZero(o){return(o<10?"0":"")+o}function patchEncyptionData(o,i){if(!o||!i)return;const _=i.keyId;_&&i.isCommonEncryption&&findBox(o,["moov","trak"]).forEach(j=>{const et=findBox(j,["mdia","minf","stbl","stsd"])[0].subarray(8);let tt=findBox(et,["enca"]);const rt=tt.length>0;rt||(tt=findBox(et,["encv"])),tt.forEach(nt=>{const it=rt?nt.subarray(28):nt.subarray(78);findBox(it,["sinf"]).forEach(at=>{const ot=parseSinf(at);if(ot){const lt=ot.subarray(8,24);lt.some(ct=>ct!==0)||(logger.log(`[eme] Patching keyId in 'enc${rt?"a":"v"}>sinf>>tenc' box: ${arrayToHex(lt)} -> ${arrayToHex(_)}`),ot.set(_,8))}})})})}function parseSinf(o){const i=findBox(o,["schm"])[0];if(i){const _=bin2str(i.subarray(4,8));if(_==="cbcs"||_==="cenc")return findBox(o,["schi","tenc"])[0]}return null}function getSampleData(o,i,_){const $={},j=findBox(o,["moof","traf"]);for(let _e=0;_e<j.length;_e++){const et=j[_e],tt=findBox(et,["tfhd"])[0],rt=readUint32(tt,4),nt=i[rt];if(!nt)continue;$[rt]||($[rt]={start:NaN,duration:0,sampleCount:0,timescale:nt.timescale,type:nt.type});const it=$[rt],st=findBox(et,["tfdt"])[0];if(st){const dt=st[0];let mt=readUint32(st,4);dt===1&&(mt===UINT32_MAX$1?_.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(mt*=UINT32_MAX$1+1,mt+=readUint32(st,8))),isFiniteNumber(mt)&&(!isFiniteNumber(it.start)||mt<it.start)&&(it.start=mt)}const at=nt.default,ot=readUint32(tt,0)|(at==null?void 0:at.flags);let lt=(at==null?void 0:at.duration)||0;ot&8&&(ot&2?lt=readUint32(tt,12):lt=readUint32(tt,8));const ct=findBox(et,["trun"]);let ft=it.start||0,ut=0,ht=lt;for(let dt=0;dt<ct.length;dt++){const mt=ct[dt],pt=readUint32(mt,4),yt=it.sampleCount;it.sampleCount+=pt;const gt=mt[3]&1,vt=mt[3]&4,St=mt[2]&1,At=mt[2]&2,xt=mt[2]&4,wt=mt[2]&8;let Ot=8,Bt=pt;for(gt&&(Ot+=4),vt&&pt&&(!(mt[Ot+1]&1)&&it.keyFrameIndex===void 0&&(it.keyFrameIndex=yt),Ot+=4,St?(ht=readUint32(mt,Ot),Ot+=4):ht=lt,At&&(Ot+=4),wt&&(Ot+=4),ft+=ht,ut+=ht,Bt--);Bt--;)St?(ht=readUint32(mt,Ot),Ot+=4):ht=lt,At&&(Ot+=4),xt&&(mt[Ot+1]&1||it.keyFrameIndex===void 0&&(it.keyFrameIndex=it.sampleCount-(Bt+1),it.keyFrameStart=ft),Ot+=4),wt&&(Ot+=4),ft+=ht,ut+=ht;!ut&&lt&&(ut+=lt*pt)}it.duration+=ut}if(!Object.keys($).some(_e=>$[_e].duration)){let _e=1/0,et=0;const tt=findBox(o,["sidx"]);for(let rt=0;rt<tt.length;rt++){const nt=parseSegmentIndex(tt[rt]);if(nt!=null&&nt.references){_e=Math.min(_e,nt.earliestPresentationTime/nt.timescale);const it=nt.references.reduce((st,at)=>st+at.info.duration||0,0);et=Math.max(et,it+nt.earliestPresentationTime/nt.timescale)}}et&&isFiniteNumber(et)&&Object.keys($).forEach(rt=>{$[rt].duration||($[rt].duration=et*$[rt].timescale-$[rt].start)})}return $}function segmentValidRange(o){const i={valid:null,remainder:null},_=findBox(o,["moof"]);if(_.length<2)return i.remainder=o,i;const $=_[_.length-1];return i.valid=o.slice(0,$.byteOffset-8),i.remainder=o.slice($.byteOffset-8),i}function appendUint8Array(o,i){const _=new Uint8Array(o.length+i.length);return _.set(o),_.set(i,o.length),_}function parseSamples(o,i){const _=[],$=i.samples,j=i.timescale,_e=i.id;let et=!1;return findBox($,["moof"]).map(rt=>{const nt=rt.byteOffset-8;findBox(rt,["traf"]).map(st=>{const at=findBox(st,["tfdt"]).map(ot=>{const lt=ot[0];let ct=readUint32(ot,4);return lt===1&&(ct*=Math.pow(2,32),ct+=readUint32(ot,8)),ct/j})[0];return at!==void 0&&(o=at),findBox(st,["tfhd"]).map(ot=>{const lt=readUint32(ot,4),ct=readUint32(ot,0)&16777215,ft=(ct&1)!==0,ut=(ct&2)!==0,ht=(ct&8)!==0;let dt=0;const mt=(ct&16)!==0;let pt=0;const yt=(ct&32)!==0;let gt=8;lt===_e&&(ft&&(gt+=8),ut&&(gt+=4),ht&&(dt=readUint32(ot,gt),gt+=4),mt&&(pt=readUint32(ot,gt),gt+=4),yt&&(gt+=4),i.type==="video"&&(et=isHEVC(i.codec)),findBox(st,["trun"]).map(vt=>{const St=vt[0],At=readUint32(vt,0)&16777215,xt=(At&1)!==0;let wt=0;const Ot=(At&4)!==0,Bt=(At&256)!==0;let Ft=0;const Pt=(At&512)!==0;let Rt=0;const Et=(At&1024)!==0,_t=(At&2048)!==0;let Mt=0;const Dt=readUint32(vt,4);let Lt=8;xt&&(wt=readUint32(vt,Lt),Lt+=4),Ot&&(Lt+=4);let Ct=wt+nt;for(let kt=0;kt<Dt;kt++){if(Bt?(Ft=readUint32(vt,Lt),Lt+=4):Ft=dt,Pt?(Rt=readUint32(vt,Lt),Lt+=4):Rt=pt,Et&&(Lt+=4),_t&&(St===0?Mt=readUint32(vt,Lt):Mt=readSint32(vt,Lt),Lt+=4),i.type===ElementaryStreamTypes.VIDEO){let jt=0;for(;jt<Rt;){const Vt=readUint32($,Ct);if(Ct+=4,isSEIMessage(et,$[Ct])){const zt=$.subarray(Ct,Ct+Vt);parseSEIMessageFromNALu(zt,et?2:1,o+Mt/j,_)}Ct+=Vt,jt+=Vt+4}}o+=Ft/j}}))})})}),_}function isHEVC(o){if(!o)return!1;const i=o.substring(0,4);return i==="hvc1"||i==="hev1"||i==="dvh1"||i==="dvhe"}function isSEIMessage(o,i){if(o){const _=i>>1&63;return _===39||_===40}else return(i&31)===6}function parseSEIMessageFromNALu(o,i,_,$){const j=discardEPB(o);let _e=0;_e+=i;let et=0,tt=0,rt=0;for(;_e<j.length;){et=0;do{if(_e>=j.length)break;rt=j[_e++],et+=rt}while(rt===255);tt=0;do{if(_e>=j.length)break;rt=j[_e++],tt+=rt}while(rt===255);const nt=j.length-_e;let it=_e;if(tt<nt)_e+=tt;else if(tt>nt){logger.error(`Malformed SEI payload. ${tt} is too small, only ${nt} bytes left to parse.`);break}if(et===4){if(j[it++]===181){const at=readUint16(j,it);if(it+=2,at===49){const ot=readUint32(j,it);if(it+=4,ot===1195456820){const lt=j[it++];if(lt===3){const ct=j[it++],ft=31&ct,ut=64&ct,ht=ut?2+ft*3:0,dt=new Uint8Array(ht);if(ut){dt[0]=ct;for(let mt=1;mt<ht;mt++)dt[mt]=j[it++]}$.push({type:lt,payloadType:et,pts:_,bytes:dt})}}}}}else if(et===5&&tt>16){const st=[];for(let lt=0;lt<16;lt++){const ct=j[it++].toString(16);st.push(ct.length==1?"0"+ct:ct),(lt===3||lt===5||lt===7||lt===9)&&st.push("-")}const at=tt-16,ot=new Uint8Array(at);for(let lt=0;lt<at;lt++)ot[lt]=j[it++];$.push({payloadType:et,pts:_,uuid:st.join(""),userData:utf8ArrayToStr(ot),userDataBytes:ot})}}}function discardEPB(o){const i=o.byteLength,_=[];let $=1;for(;$<i-2;)o[$]===0&&o[$+1]===0&&o[$+2]===3?(_.push($+2),$+=2):$++;if(_.length===0)return o;const j=i-_.length,_e=new Uint8Array(j);let et=0;for($=0;$<j;et++,$++)et===_[0]&&(et++,_.shift()),_e[$]=o[et];return _e}function parseEmsg(o){const i=o[0];let _="",$="",j=0,_e=0,et=0,tt=0,rt=0,nt=0;if(i===0){for(;bin2str(o.subarray(nt,nt+1))!=="\0";)_+=bin2str(o.subarray(nt,nt+1)),nt+=1;for(_+=bin2str(o.subarray(nt,nt+1)),nt+=1;bin2str(o.subarray(nt,nt+1))!=="\0";)$+=bin2str(o.subarray(nt,nt+1)),nt+=1;$+=bin2str(o.subarray(nt,nt+1)),nt+=1,j=readUint32(o,12),_e=readUint32(o,16),tt=readUint32(o,20),rt=readUint32(o,24),nt=28}else if(i===1){nt+=4,j=readUint32(o,nt),nt+=4;const st=readUint32(o,nt);nt+=4;const at=readUint32(o,nt);for(nt+=4,et=2**32*st+at,isSafeInteger(et)||(et=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),tt=readUint32(o,nt),nt+=4,rt=readUint32(o,nt),nt+=4;bin2str(o.subarray(nt,nt+1))!=="\0";)_+=bin2str(o.subarray(nt,nt+1)),nt+=1;for(_+=bin2str(o.subarray(nt,nt+1)),nt+=1;bin2str(o.subarray(nt,nt+1))!=="\0";)$+=bin2str(o.subarray(nt,nt+1)),nt+=1;$+=bin2str(o.subarray(nt,nt+1)),nt+=1}const it=o.subarray(nt,o.byteLength);return{schemeIdUri:_,value:$,timeScale:j,presentationTime:et,presentationTimeDelta:_e,eventDuration:tt,id:rt,payload:it}}function mp4Box(o,...i){const _=i.length;let $=8,j=_;for(;j--;)$+=i[j].byteLength;const _e=new Uint8Array($);for(_e[0]=$>>24&255,_e[1]=$>>16&255,_e[2]=$>>8&255,_e[3]=$&255,_e.set(o,4),j=0,$=8;j<_;j++)_e.set(i[j],$),$+=i[j].byteLength;return _e}function mp4pssh(o,i,_){if(o.byteLength!==16)throw new RangeError("Invalid system id");let $,j;$=0,j=new Uint8Array;let _e;$>0?(_e=new Uint8Array(4),i.length>0&&new DataView(_e.buffer).setUint32(0,i.length,!1)):_e=new Uint8Array;const et=new Uint8Array(4);return _.byteLength>0&&new DataView(et.buffer).setUint32(0,_.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([$,0,0,0]),o,_e,j,et,_)}function parseMultiPssh(o){const i=[];if(o instanceof ArrayBuffer){const _=o.byteLength;let $=0;for(;$+32<_;){const j=new DataView(o,$),_e=parsePssh(j);i.push(_e),$+=_e.size}}return i}function parsePssh(o){const i=o.getUint32(0),_=o.byteOffset,$=o.byteLength;if($<i)return{offset:_,size:$};if(o.getUint32(4)!==1886614376)return{offset:_,size:i};const _e=o.getUint32(8)>>>24;if(_e!==0&&_e!==1)return{offset:_,size:i};const et=o.buffer,tt=arrayToHex(new Uint8Array(et,_+12,16));let rt=null,nt=null,it=0;if(_e===0)it=28;else{const at=o.getUint32(28);if(!at||$<32+at*16)return{offset:_,size:i};rt=[];for(let ot=0;ot<at;ot++)rt.push(new Uint8Array(et,_+32+ot*16,16));it=32+at*16}if(!it)return{offset:_,size:i};const st=o.getUint32(it);return i-32<st?{offset:_,size:i}:(nt=new Uint8Array(et,_+it+4,st),{version:_e,systemId:tt,kids:rt,data:nt,offset:_,size:i})}const userAgentHevcSupportIsInaccurate=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),sampleEntryCodesISO={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function isCodecType(o,i){const _=sampleEntryCodesISO[i];return!!_&&!!_[o.slice(0,4)]}function areCodecsMediaSourceSupported(o,i,_=!0){return!o.split(",").some($=>!isCodecMediaSourceSupported($,i,_))}function isCodecMediaSourceSupported(o,i,_=!0){var $;const j=getMediaSource(_);return($=j==null?void 0:j.isTypeSupported(mimeTypeForCodec(o,i)))!=null?$:!1}function mimeTypeForCodec(o,i){return`${i}/mp4;codecs=${o}`}function videoCodecPreferenceValue(o){if(o){const i=o.substring(0,4);return sampleEntryCodesISO.video[i]}return 2}function codecsSetSelectionPreferenceValue(o){const i=userAgentHevcSupportIsInaccurate();return o.split(",").reduce((_,$)=>{const _e=i&&isHEVC($)?9:sampleEntryCodesISO.video[$];return _e?(_e*2+_)/(_?3:2):(sampleEntryCodesISO.audio[$]+_)/(_?2:1)},0)}const CODEC_COMPATIBLE_NAMES={};function getCodecCompatibleNameLower(o,i=!0){if(CODEC_COMPATIBLE_NAMES[o])return CODEC_COMPATIBLE_NAMES[o];const _={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[o];for(let j=0;j<_.length;j++){var $;if(isCodecMediaSourceSupported(_[j],"audio",i))return CODEC_COMPATIBLE_NAMES[o]=_[j],_[j];if(_[j]==="mp3"&&($=getMediaSource(i))!=null&&$.isTypeSupported("audio/mpeg"))return""}return o}const AUDIO_CODEC_REGEXP=/flac|opus|mp4a\.40\.34/i;function getCodecCompatibleName(o,i=!0){return o.replace(AUDIO_CODEC_REGEXP,_=>getCodecCompatibleNameLower(_.toLowerCase(),i))}function replaceVideoCodec(o,i){const _=[];if(o){const $=o.split(",");for(let j=0;j<$.length;j++)isCodecType($[j],"video")||_.push($[j])}return i&&_.push(i),_.join(",")}function pickMostCompleteCodecName(o,i){if(o&&(o.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(o)!==-1)&&(isCodecSupportedAsType(o,"audio")||isCodecSupportedAsType(o,"video")))return o;if(i){const _=i.split(",");if(_.length>1){if(o){for(let $=_.length;$--;)if(_[$].substring(0,4)===o.substring(0,4))return _[$]}return _[0]}}return i||o}function isCodecSupportedAsType(o,i){return isCodecType(o,i)&&isCodecMediaSourceSupported(o,i)}function convertAVC1ToAVCOTI(o){const i=o.split(",");for(let _=0;_<i.length;_++){const $=i[_].split(".");$.length>2&&$[0]==="avc1"&&(i[_]=`avc1.${parseInt($[1]).toString(16)}${("000"+parseInt($[2]).toString(16)).slice(-4)}`)}return i.join(",")}function fillInMissingAV01Params(o){if(o.startsWith("av01.")){const i=o.split("."),_=["0","111","01","01","01","0"];for(let $=i.length;$>4&&$<10;$++)i[$]=_[$-4];return i.join(".")}return o}function getM2TSSupportedAudioTypes(o){const i=getMediaSource(o)||{isTypeSupported:()=>!1};return{mpeg:i.isTypeSupported("audio/mpeg"),mp3:i.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:i.isTypeSupported('audio/mp4; codecs="ac-3"')}}function getCodecsForMimeType(o){return o.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const supportedResult={supported:!0,powerEfficient:!0,smooth:!0},unsupportedResult={supported:!1,smooth:!1,powerEfficient:!1},SUPPORTED_INFO_DEFAULT={supported:!0,configurations:[],decodingInfoResults:[supportedResult]};function getUnsupportedResult(o,i){return{supported:!1,configurations:i,decodingInfoResults:[unsupportedResult],error:o}}function requiresMediaCapabilitiesDecodingInfo(o,i,_,$,j,_e){const et=o.videoCodec,tt=o.audioCodec?o.audioGroups:null,rt=_e==null?void 0:_e.audioCodec,nt=_e==null?void 0:_e.channels,it=nt?parseInt(nt):rt?1/0:2;let st=null;if(tt!=null&&tt.length)try{tt.length===1&&tt[0]?st=i.groups[tt[0]].channels:st=tt.reduce((at,ot)=>{if(ot){const lt=i.groups[ot];if(!lt)throw new Error(`Audio track group ${ot} not found`);Object.keys(lt.channels).forEach(ct=>{at[ct]=(at[ct]||0)+lt.channels[ct]})}return at},{2:0})}catch{return!0}return et!==void 0&&(et.split(",").some(at=>isHEVC(at))||o.width>1920&&o.height>1088||o.height>1920&&o.width>1088||o.frameRate>Math.max($,30)||o.videoRange!=="SDR"&&o.videoRange!==_||o.bitrate>Math.max(j,8e6))||!!st&&isFiniteNumber(it)&&Object.keys(st).some(at=>parseInt(at)>it)}function getMediaDecodingInfoPromise(o,i,_,$={}){const j=o.videoCodec;if(!j&&!o.audioCodec||!_)return Promise.resolve(SUPPORTED_INFO_DEFAULT);const _e=[],et=makeVideoConfigurations(o),tt=et.length,rt=makeAudioConfigurations(o,i,tt>0),nt=rt.length;for(let it=tt||1*nt||1;it--;){const st={type:"media-source"};if(tt&&(st.video=et[it%tt]),nt){st.audio=rt[it%nt];const at=st.audio.bitrate;st.video&&at&&(st.video.bitrate-=at)}_e.push(st)}if(j){const it=navigator.userAgent;if(j.split(",").some(st=>isHEVC(st))&&userAgentHevcSupportIsInaccurate())return Promise.resolve(getUnsupportedResult(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${it})`),_e))}return Promise.all(_e.map(it=>{const st=getMediaDecodingInfoKey(it);return $[st]||($[st]=_.decodingInfo(it))})).then(it=>({supported:!it.some(st=>!st.supported),configurations:_e,decodingInfoResults:it})).catch(it=>({supported:!1,configurations:_e,decodingInfoResults:[],error:it}))}function makeVideoConfigurations(o){var i;const _=(i=o.videoCodec)==null?void 0:i.split(","),$=getVariantDecodingBitrate(o),j=o.width||640,_e=o.height||480,et=o.frameRate||30,tt=o.videoRange.toLowerCase();return _?_.map(rt=>{const nt={contentType:mimeTypeForCodec(fillInMissingAV01Params(rt),"video"),width:j,height:_e,bitrate:$,framerate:et};return tt!=="sdr"&&(nt.transferFunction=tt),nt}):[]}function makeAudioConfigurations(o,i,_){var $;const j=($=o.audioCodec)==null?void 0:$.split(","),_e=getVariantDecodingBitrate(o);return j&&o.audioGroups?o.audioGroups.reduce((et,tt)=>{var rt;const nt=tt?(rt=i.groups[tt])==null?void 0:rt.tracks:null;return nt?nt.reduce((it,st)=>{if(st.groupId===tt){const at=parseFloat(st.channels||"");j.forEach(ot=>{const lt={contentType:mimeTypeForCodec(ot,"audio"),bitrate:_?estimatedAudioBitrate(ot,_e):_e};at&&(lt.channels=""+at),it.push(lt)})}return it},et):et},[]):[]}function estimatedAudioBitrate(o,i){if(i<=1)return 1;let _=128e3;return o==="ec-3"?_=768e3:o==="ac-3"&&(_=64e4),Math.min(i/2,_)}function getVariantDecodingBitrate(o){return Math.ceil(Math.max(o.bitrate*.9,o.averageBitrate)/1e3)*1e3||1}function getMediaDecodingInfoKey(o){let i="";const{audio:_,video:$}=o;if($){const j=getCodecsForMimeType($.contentType);i+=`${j}_r${$.height}x${$.width}f${Math.ceil($.framerate)}${$.transferFunction||"sd"}_${Math.ceil($.bitrate/1e5)}`}if(_){const j=getCodecsForMimeType(_.contentType);i+=`${$?"_":""}${j}_c${_.channels}`}return i}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];function isHdcpLevel(o){return HdcpLevels.indexOf(o)>-1}const VideoRangeValues=["SDR","PQ","HLG"];function isVideoRange(o){return!!o&&VideoRangeValues.indexOf(o)>-1}var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(o){const{canSkipUntil:i,canSkipDateRanges:_,age:$}=o,j=$<i/2;return i&&j?_?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(i,_,$){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=i,this.part=_,this.skip=$}addDirectives(i){const _=new self.URL(i);return this.msn!==void 0&&_.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&_.searchParams.set("_HLS_part",this.part.toString()),this.skip&&_.searchParams.set("_HLS_skip",this.skip),_.href}}class Level{constructor(i){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[i.url],this._attrs=[i.attrs],this.bitrate=i.bitrate,i.details&&(this.details=i.details),this.id=i.id||0,this.name=i.name,this.width=i.width||0,this.height=i.height||0,this.frameRate=i.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=i.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=i.audioCodec,this.videoCodec=i.videoCodec,this.codecSet=[i.videoCodec,i.audioCodec].filter($=>!!$).map($=>$.substring(0,4)).join(","),"supplemental"in i){var _;this.supplemental=i.supplemental;const $=(_=i.supplemental)==null?void 0:_.videoCodec;$&&$!==i.videoCodec&&(this.codecSet+=`,${$.substring(0,4)}`)}this.addGroupId("audio",i.attrs.AUDIO),this.addGroupId("text",i.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(i){return hasGroup(this._audioGroups,i)}hasSubtitleGroup(i){return hasGroup(this._subtitleGroups,i)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(i,_){if(_){if(i==="audio"){let $=this._audioGroups;$||($=this._audioGroups=[]),$.indexOf(_)===-1&&$.push(_)}else if(i==="text"){let $=this._subtitleGroups;$||($=this._subtitleGroups=[]),$.indexOf(_)===-1&&$.push(_)}}}get urlId(){return 0}set urlId(i){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var i;return(i=this.audioGroups)==null?void 0:i[0]}get textGroupId(){var i;return(i=this.subtitleGroups)==null?void 0:i[0]}addFallback(){}}function hasGroup(o,i){return!i||!o?!1:o.indexOf(i)!==-1}function isHdrSupported(){if(typeof matchMedia=="function"){const o=matchMedia("(dynamic-range: high)"),i=matchMedia("bad query");if(o.media!==i.media)return o.matches===!0}return!1}function getVideoSelectionOptions(o,i){let _=!1,$=[];if(o&&(_=o!=="SDR",$=[o]),i){$=i.allowedVideoRanges||VideoRangeValues.slice(0);const j=$.join("")!=="SDR"&&!i.videoCodec;_=i.preferHDR!==void 0?i.preferHDR:j&&isHdrSupported(),_||($=["SDR"])}return{preferHDR:_,allowedVideoRanges:$}}const omitCircularRefsReplacer=o=>{const i=new WeakSet;return(_,$)=>{if(o&&($=o(_,$)),typeof $=="object"&&$!==null){if(i.has($))return;i.add($)}return $}},stringify=(o,i)=>JSON.stringify(o,omitCircularRefsReplacer(i));function getStartCodecTier(o,i,_,$,j){const _e=Object.keys(o),et=$==null?void 0:$.channels,tt=$==null?void 0:$.audioCodec,rt=j==null?void 0:j.videoCodec,nt=et&&parseInt(et)===2;let it=!1,st=!1,at=1/0,ot=1/0,lt=1/0,ct=1/0,ft=0,ut=[];const{preferHDR:ht,allowedVideoRanges:dt}=getVideoSelectionOptions(i,j);for(let vt=_e.length;vt--;){const St=o[_e[vt]];it||(it=St.channels[2]>0),at=Math.min(at,St.minHeight),ot=Math.min(ot,St.minFramerate),lt=Math.min(lt,St.minBitrate),dt.filter(xt=>St.videoRanges[xt]>0).length>0&&(st=!0)}at=isFiniteNumber(at)?at:0,ot=isFiniteNumber(ot)?ot:0;const mt=Math.max(1080,at),pt=Math.max(30,ot);lt=isFiniteNumber(lt)?lt:_,_=Math.max(lt,_),st||(i=void 0);const yt=_e.length>1;return{codecSet:_e.reduce((vt,St)=>{const At=o[St];if(St===vt)return vt;if(ut=st?dt.filter(xt=>At.videoRanges[xt]>0):[],yt){if(At.minBitrate>_)return logStartCodecCandidateIgnored(St,`min bitrate of ${At.minBitrate} > current estimate of ${_}`),vt;if(!At.hasDefaultAudio)return logStartCodecCandidateIgnored(St,"no renditions with default or auto-select sound found"),vt;if(tt&&St.indexOf(tt.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(St,`audio codec preference "${tt}" not found`),vt;if(et&&!nt){if(!At.channels[et])return logStartCodecCandidateIgnored(St,`no renditions with ${et} channel sound found (channels options: ${Object.keys(At.channels)})`),vt}else if((!tt||nt)&&it&&At.channels[2]===0)return logStartCodecCandidateIgnored(St,"no renditions with stereo sound found"),vt;if(At.minHeight>mt)return logStartCodecCandidateIgnored(St,`min resolution of ${At.minHeight} > maximum of ${mt}`),vt;if(At.minFramerate>pt)return logStartCodecCandidateIgnored(St,`min framerate of ${At.minFramerate} > maximum of ${pt}`),vt;if(!ut.some(xt=>At.videoRanges[xt]>0))return logStartCodecCandidateIgnored(St,`no variants with VIDEO-RANGE of ${stringify(ut)} found`),vt;if(rt&&St.indexOf(rt.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(St,`video codec preference "${rt}" not found`),vt;if(At.maxScore<ft)return logStartCodecCandidateIgnored(St,`max score of ${At.maxScore} < selected max of ${ft}`),vt}return vt&&(codecsSetSelectionPreferenceValue(St)>=codecsSetSelectionPreferenceValue(vt)||At.fragmentError>o[vt].fragmentError)?vt:(ct=At.minIndex,ft=At.maxScore,St)},void 0),videoRanges:ut,preferHDR:ht,minFramerate:ot,minBitrate:lt,minIndex:ct}}function logStartCodecCandidateIgnored(o,i){logger.log(`[abr] start candidates with "${o}" ignored because ${i}`)}function getAudioTracksByGroup(o){return o.reduce((i,_)=>{let $=i.groups[_.groupId];$||($=i.groups[_.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),$.tracks.push(_);const j=_.channels||"2";return $.channels[j]=($.channels[j]||0)+1,$.hasDefault=$.hasDefault||_.default,$.hasAutoSelect=$.hasAutoSelect||_.autoselect,$.hasDefault&&(i.hasDefaultAudio=!0),$.hasAutoSelect&&(i.hasAutoSelectAudio=!0),i},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function getCodecTiers(o,i,_,$){return o.slice(_,$+1).reduce((j,_e,et)=>{if(!_e.codecSet)return j;const tt=_e.audioGroups;let rt=j[_e.codecSet];rt||(j[_e.codecSet]=rt={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:et,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!tt,fragmentError:0}),rt.minBitrate=Math.min(rt.minBitrate,_e.bitrate);const nt=Math.min(_e.height,_e.width);return rt.minHeight=Math.min(rt.minHeight,nt),rt.minFramerate=Math.min(rt.minFramerate,_e.frameRate),rt.minIndex=Math.min(rt.minIndex,et),rt.maxScore=Math.max(rt.maxScore,_e.score),rt.fragmentError+=_e.fragmentError,rt.videoRanges[_e.videoRange]=(rt.videoRanges[_e.videoRange]||0)+1,tt&&tt.forEach(it=>{if(!it)return;const st=i.groups[it];st&&(rt.hasDefaultAudio=rt.hasDefaultAudio||i.hasDefaultAudio?st.hasDefault:st.hasAutoSelect||!i.hasDefaultAudio&&!i.hasAutoSelectAudio,Object.keys(st.channels).forEach(at=>{rt.channels[at]=(rt.channels[at]||0)+st.channels[at]}))}),j},{})}function getBasicSelectionOption(o){if(!o)return o;const{lang:i,assocLang:_,characteristics:$,channels:j,audioCodec:_e}=o;return{lang:i,assocLang:_,characteristics:$,channels:j,audioCodec:_e}}function findMatchingOption(o,i,_){if("attrs"in o){const $=i.indexOf(o);if($!==-1)return $}for(let $=0;$<i.length;$++){const j=i[$];if(matchesOption(o,j,_))return $}return-1}function matchesOption(o,i,_){const{groupId:$,name:j,lang:_e,assocLang:et,default:tt}=o,rt=o.forced;return($===void 0||i.groupId===$)&&(j===void 0||i.name===j)&&(_e===void 0||languagesMatch(_e,i.lang))&&(_e===void 0||i.assocLang===et)&&(tt===void 0||i.default===tt)&&(rt===void 0||i.forced===rt)&&(!("characteristics"in o)||characteristicsMatch(o.characteristics||"",i.characteristics))&&(_===void 0||_(o,i))}function languagesMatch(o,i="--"){return o.length===i.length?o===i:o.startsWith(i)||i.startsWith(o)}function characteristicsMatch(o,i=""){const _=o.split(","),$=i.split(",");return _.length===$.length&&!_.some(j=>$.indexOf(j)===-1)}function audioMatchPredicate(o,i){const{audioCodec:_,channels:$}=o;return(_===void 0||(i.audioCodec||"").substring(0,4)===_.substring(0,4))&&($===void 0||$===(i.channels||"2"))}function findClosestLevelWithAudioGroup(o,i,_,$,j){const _e=i[$],tt=i.reduce((at,ot,lt)=>{const ct=ot.uri;return(at[ct]||(at[ct]=[])).push(lt),at},{})[_e.uri];tt.length>1&&($=Math.max.apply(Math,tt));const rt=_e.videoRange,nt=_e.frameRate,it=_e.codecSet.substring(0,4),st=searchDownAndUpList(i,$,at=>{if(at.videoRange!==rt||at.frameRate!==nt||at.codecSet.substring(0,4)!==it)return!1;const ot=at.audioGroups,lt=_.filter(ct=>!ot||ot.indexOf(ct.groupId)!==-1);return findMatchingOption(o,lt,j)>-1});return st>-1?st:searchDownAndUpList(i,$,at=>{const ot=at.audioGroups,lt=_.filter(ct=>!ot||ot.indexOf(ct.groupId)!==-1);return findMatchingOption(o,lt,j)>-1})}function searchDownAndUpList(o,i,_){for(let $=i;$>-1;$--)if(_(o[$]))return $;for(let $=i+1;$<o.length;$++)if(_(o[$]))return $;return-1}function useAlternateAudio(o,i){var _;return!!o&&o!==((_=i.loadLevelObj)==null?void 0:_.uri)}class AbrController extends Logger$1{constructor(i){super("abr",i.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=_=>{var $;const{fragCurrent:j,partCurrent:_e,hls:et}=this,{autoLevelEnabled:tt,media:rt}=et;if(!j||!rt)return;const nt=performance.now(),it=_e?_e.stats:j.stats,st=_e?_e.duration:j.duration,at=nt-it.loading.start,ot=et.minAutoLevel,lt=j.level,ct=this._nextAutoLevel;if(it.aborted||it.loaded&&it.loaded===it.total||lt<=ot){this.clearTimer(),this._nextAutoLevel=-1;return}if(!tt)return;const ft=ct>-1&&ct!==lt,ut=!!_||ft;if(!ut&&(rt.paused||!rt.playbackRate||!rt.readyState))return;const ht=et.mainForwardBufferInfo;if(!ut&&ht===null)return;const dt=this.bwEstimator.getEstimateTTFB(),mt=Math.abs(rt.playbackRate);if(at<=Math.max(dt,1e3*(st/(mt*2))))return;const pt=ht?ht.len/mt:0,yt=it.loading.first?it.loading.first-it.loading.start:-1,gt=it.loaded&&yt>-1,vt=this.getBwEstimate(),St=et.levels,At=St[lt],xt=Math.max(it.loaded,Math.round(st*(j.bitrate||At.averageBitrate)/8));let wt=gt?at-yt:at;wt<1&&gt&&(wt=Math.min(at,it.loaded*8/vt));const Ot=gt?it.loaded*1e3/wt:0,Bt=dt/1e3,Ft=Ot?(xt-it.loaded)/Ot:xt*8/vt+Bt;if(Ft<=pt)return;const Pt=Ot?Ot*8:vt,Rt=(($=(_==null?void 0:_.details)||this.hls.latestLevelDetails)==null?void 0:$.live)===!0,Et=this.hls.config.abrBandWidthUpFactor;let _t=Number.POSITIVE_INFINITY,Mt;for(Mt=lt-1;Mt>ot;Mt--){const kt=St[Mt].maxBitrate,jt=!St[Mt].details||Rt;if(_t=this.getTimeToLoadFrag(Bt,Pt,st*kt,jt),_t<Math.min(pt,st+Bt))break}if(_t>=Ft||_t>st*10)return;gt?this.bwEstimator.sample(at-Math.min(dt,yt),it.loaded):this.bwEstimator.sampleTTFB(at);const Dt=St[Mt].maxBitrate;this.getBwEstimate()*Et>Dt&&this.resetEstimator(Dt);const Lt=this.findBestLevel(Dt,ot,Mt,0,pt,1,1);Lt>-1&&(Mt=Lt),this.warn(`Fragment ${j.sn}${_e?" part "+_e.index:""} of level ${lt} is loading too slowly;
      Fragment duration: ${j.duration.toFixed(3)}
      Time to underbuffer: ${pt.toFixed(3)} s
      Estimated load time for current fragment: ${Ft.toFixed(3)} s
      Estimated load time for down switch fragment: ${_t.toFixed(3)} s
      TTFB estimate: ${yt|0} ms
      Current BW estimate: ${isFiniteNumber(vt)?vt|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${Mt} @ ${Dt|0} bps`),et.nextLoadLevel=et.nextAutoLevel=Mt,this.clearTimer();const Ct=()=>{if(this.clearTimer(),this.fragCurrent===j&&this.hls.loadLevel===Mt&&Mt>0){const kt=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${Mt>0?"and switching down":""}
      Fragment duration: ${j.duration.toFixed(3)} s
      Time to underbuffer: ${kt.toFixed(3)} s`),j.abortRequests(),this.fragCurrent=this.partCurrent=null,Mt>ot){let jt=this.findBestLevel(this.hls.levels[ot].bitrate,ot,Mt,0,kt,1,1);jt===-1&&(jt=ot),this.hls.nextLoadLevel=this.hls.nextAutoLevel=jt,this.resetEstimator(this.hls.levels[jt].bitrate)}}};ft||Ft>_t*2?Ct():this.timer=self.setInterval(Ct,_t*1e3),et.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:j,part:_e,stats:it})},this.hls=i,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(i){i&&(this.log(`setting initial bwe to ${i}`),this.hls.config.abrEwmaDefaultEstimate=i),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const i=this.hls.config;return new EwmaBandWidthEstimator(i.abrEwmaSlowVoD,i.abrEwmaFastVoD,i.abrEwmaDefaultEstimate)}registerListeners(){const{hls:i}=this;i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.FRAG_LOADING,this.onFragLoading,this),i.on(Events.FRAG_LOADED,this.onFragLoaded,this),i.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.on(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:i}=this;i&&(i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.FRAG_LOADING,this.onFragLoading,this),i.off(Events.FRAG_LOADED,this.onFragLoaded,this),i.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.off(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),i.off(Events.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(i,_){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(i,_){const $=_.frag;if(!this.ignoreFragment($)){if(!$.bitrateTest){var j;this.fragCurrent=$,this.partCurrent=(j=_.part)!=null?j:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(i,_){this.clearTimer()}onError(i,_){if(!_.fatal)switch(_.details){case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ErrorDetails.FRAG_LOAD_TIMEOUT:{const $=_.frag,{fragCurrent:j,partCurrent:_e}=this;if($&&j&&$.sn===j.sn&&$.level===j.level){const et=performance.now(),tt=_e?_e.stats:$.stats,rt=et-tt.loading.start,nt=tt.loading.first?tt.loading.first-tt.loading.start:-1;if(tt.loaded&&nt>-1){const st=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(rt-Math.min(st,nt),tt.loaded)}else this.bwEstimator.sampleTTFB(rt)}break}}}getTimeToLoadFrag(i,_,$,j){const _e=i+$/_,et=j?i+this.lastLevelLoadSec:0;return _e+et}onLevelLoaded(i,_){const $=this.hls.config,{loading:j}=_.stats,_e=j.end-j.first;isFiniteNumber(_e)&&(this.lastLevelLoadSec=_e/1e3),_.details.live?this.bwEstimator.update($.abrEwmaSlowLive,$.abrEwmaFastLive):this.bwEstimator.update($.abrEwmaSlowVoD,$.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(_.levelInfo)}onFragLoaded(i,{frag:_,part:$}){const j=$?$.stats:_.stats;if(_.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(j.loading.first-j.loading.start),!this.ignoreFragment(_)){if(this.clearTimer(),_.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const _e=$?$.duration:_.duration,et=this.hls.levels[_.level],tt=(et.loaded?et.loaded.bytes:0)+j.loaded,rt=(et.loaded?et.loaded.duration:0)+_e;et.loaded={bytes:tt,duration:rt},et.realBitrate=Math.round(8*tt/rt)}if(_.bitrateTest){const _e={stats:j,frag:_,part:$,id:_.type};this.onFragBuffered(Events.FRAG_BUFFERED,_e),_.bitrateTest=!1}else this.lastLoadedFragLevel=_.level}}onFragBuffered(i,_){const{frag:$,part:j}=_,_e=j!=null&&j.stats.loaded?j.stats:$.stats;if(_e.aborted||this.ignoreFragment($))return;const et=_e.parsing.end-_e.loading.start-Math.min(_e.loading.first-_e.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(et,_e.loaded),_e.bwEstimate=this.getBwEstimate(),$.bitrateTest?this.bitrateTestDelay=et/1e3:this.bitrateTestDelay=0}ignoreFragment(i){return i.type!==PlaylistLevelType.MAIN||i.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:i,minAutoLevel:_}=this.hls,$=this.getBwEstimate(),j=this.hls.config.maxStarvationDelay,_e=this.findBestLevel($,_,i,0,j,1,1);if(_e>-1)return _e;const et=this.hls.firstLevel,tt=Math.min(Math.max(et,_),i);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${et} clamped to ${tt}`),tt}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const i=this.forcedAutoLevel,$=this.bwEstimator.canEstimate(),j=this.lastLoadedFragLevel>-1;if(i!==-1&&(!$||!j||this.nextAutoLevelKey===this.getAutoLevelKey()))return i;const _e=$&&j?this.getNextABRAutoLevel():this.firstAutoLevel;if(i!==-1){const et=this.hls.levels;if(et.length>Math.max(i,_e)&&et[i].loadError<=et[_e].loadError)return i}return this._nextAutoLevel=_e,this.nextAutoLevelKey=this.getAutoLevelKey(),_e}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:i,partCurrent:_,hls:$}=this;if($.levels.length<=1)return $.loadLevel;const{maxAutoLevel:j,config:_e,minAutoLevel:et}=$,tt=_?_.duration:i?i.duration:0,rt=this.getBwEstimate(),nt=this.getStarvationDelay();let it=_e.abrBandWidthFactor,st=_e.abrBandWidthUpFactor;if(nt){const ft=this.findBestLevel(rt,et,j,nt,0,it,st);if(ft>=0)return this.rebufferNotice=-1,ft}let at=tt?Math.min(tt,_e.maxStarvationDelay):_e.maxStarvationDelay;if(!nt){const ft=this.bitrateTestDelay;ft&&(at=(tt?Math.min(tt,_e.maxLoadingDelay):_e.maxLoadingDelay)-ft,this.info(`bitrate test took ${Math.round(1e3*ft)}ms, set first fragment max fetchDuration to ${Math.round(1e3*at)} ms`),it=st=1)}const ot=this.findBestLevel(rt,et,j,nt,at,it,st);if(this.rebufferNotice!==ot&&(this.rebufferNotice=ot,this.info(`${nt?"rebuffering expected":"buffer is empty"}, optimal quality level ${ot}`)),ot>-1)return ot;const lt=$.levels[et],ct=$.loadLevelObj;return ct&&(lt==null?void 0:lt.bitrate)<ct.bitrate?et:$.loadLevel}getStarvationDelay(){const i=this.hls,_=i.media;if(!_)return 1/0;const $=_&&_.playbackRate!==0?Math.abs(_.playbackRate):1,j=i.mainForwardBufferInfo;return(j?j.len:0)/$}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(i,_,$,j,_e,et,tt){var rt;const nt=j+_e,it=this.lastLoadedFragLevel,st=it===-1?this.hls.firstLevel:it,{fragCurrent:at,partCurrent:ot}=this,{levels:lt,allAudioTracks:ct,loadLevel:ft,config:ut}=this.hls;if(lt.length===1)return 0;const ht=lt[st],dt=!!((rt=this.hls.latestLevelDetails)!=null&&rt.live),mt=ft===-1||it===-1;let pt,yt="SDR",gt=(ht==null?void 0:ht.frameRate)||0;const{audioPreference:vt,videoPreference:St}=ut,At=this.audioTracksByGroup||(this.audioTracksByGroup=getAudioTracksByGroup(ct));let xt=-1;if(mt){if(this.firstSelection!==-1)return this.firstSelection;const Pt=this.codecTiers||(this.codecTiers=getCodecTiers(lt,At,_,$)),Rt=getStartCodecTier(Pt,yt,i,vt,St),{codecSet:Et,videoRanges:_t,minFramerate:Mt,minBitrate:Dt,minIndex:Lt,preferHDR:Ct}=Rt;xt=Lt,pt=Et,yt=Ct?_t[_t.length-1]:_t[0],gt=Mt,i=Math.max(i,Dt),this.log(`picked start tier ${stringify(Rt)}`)}else pt=ht==null?void 0:ht.codecSet,yt=ht==null?void 0:ht.videoRange;const wt=ot?ot.duration:at?at.duration:0,Ot=this.bwEstimator.getEstimateTTFB()/1e3,Bt=[];for(let Pt=$;Pt>=_;Pt--){var Ft;const Rt=lt[Pt],Et=Pt>st;if(!Rt)continue;if(ut.useMediaCapabilities&&!Rt.supportedResult&&!Rt.supportedPromise){const jt=navigator.mediaCapabilities;typeof(jt==null?void 0:jt.decodingInfo)=="function"&&requiresMediaCapabilitiesDecodingInfo(Rt,At,yt,gt,i,vt)?(Rt.supportedPromise=getMediaDecodingInfoPromise(Rt,At,jt,this.supportedCache),Rt.supportedPromise.then(Vt=>{if(!this.hls)return;Rt.supportedResult=Vt;const zt=this.hls.levels,qt=zt.indexOf(Rt);Vt.error?this.warn(`MediaCapabilities decodingInfo error: "${Vt.error}" for level ${qt} ${stringify(Vt)}`):Vt.supported?Vt.decodingInfoResults.some(Wt=>Wt.smooth===!1||Wt.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${qt} not smooth or powerEfficient: ${stringify(Vt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${qt} ${stringify(Vt)}`),qt>-1&&zt.length>1&&(this.log(`Removing unsupported level ${qt}`),this.hls.removeLevel(qt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(Vt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${Vt}`)})):Rt.supportedResult=SUPPORTED_INFO_DEFAULT}if((pt&&Rt.codecSet!==pt||yt&&Rt.videoRange!==yt||Et&&gt>Rt.frameRate||!Et&&gt>0&&gt<Rt.frameRate||(Ft=Rt.supportedResult)!=null&&(Ft=Ft.decodingInfoResults)!=null&&Ft.some(jt=>jt.smooth===!1))&&(!mt||Pt!==xt)){Bt.push(Pt);continue}const _t=Rt.details,Mt=(ot?_t==null?void 0:_t.partTarget:_t==null?void 0:_t.averagetargetduration)||wt;let Dt;Et?Dt=tt*i:Dt=et*i;const Lt=wt&&j>=wt*2&&_e===0?Rt.averageBitrate:Rt.maxBitrate,Ct=this.getTimeToLoadFrag(Ot,Dt,Lt*Mt,_t===void 0);if(Dt>=Lt&&(Pt===it||Rt.loadError===0&&Rt.fragmentError===0)&&(Ct<=Ot||!isFiniteNumber(Ct)||dt&&!this.bitrateTestDelay||Ct<nt)){const jt=this.forcedAutoLevel;return Pt!==ft&&(jt===-1||jt!==ft)&&(Bt.length&&this.trace(`Skipped level(s) ${Bt.join(",")} of ${$} max with CODECS and VIDEO-RANGE:"${lt[Bt[0]].codecs}" ${lt[Bt[0]].videoRange}; not compatible with "${pt}" ${yt}`),this.info(`switch candidate:${st}->${Pt} adjustedbw(${Math.round(Dt)})-bitrate=${Math.round(Dt-Lt)} ttfb:${Ot.toFixed(1)} avgDuration:${Mt.toFixed(1)} maxFetchDuration:${nt.toFixed(1)} fetchDuration:${Ct.toFixed(1)} firstSelection:${mt} codecSet:${Rt.codecSet} videoRange:${Rt.videoRange} hls.loadLevel:${ft}`)),mt&&(this.firstSelection=Pt),Pt}}return-1}set nextAutoLevel(i){const _=this.deriveNextAutoLevel(i);this._nextAutoLevel!==_&&(this.nextAutoLevelKey="",this._nextAutoLevel=_)}deriveNextAutoLevel(i){const{maxAutoLevel:_,minAutoLevel:$}=this.hls;return Math.min(Math.max(i,$),_)}}const BinarySearch={search:function(o,i){let _=0,$=o.length-1,j=null,_e=null;for(;_<=$;){j=(_+$)/2|0,_e=o[j];const et=i(_e);if(et>0)_=j+1;else if(et<0)$=j-1;else return _e}return null}};function findFragmentByPDT(o,i,_){if(i===null||!Array.isArray(o)||!o.length||!isFiniteNumber(i))return null;const $=o[0].programDateTime;if(i<($||0))return null;const j=o[o.length-1].endProgramDateTime;if(i>=(j||0))return null;for(let _e=0;_e<o.length;++_e){const et=o[_e];if(pdtWithinToleranceTest(i,_,et))return et}return null}function findFragmentByPTS(o,i,_=0,$=0,j=.005){let _e=null;if(o){_e=i[1+o.sn-i[0].sn]||null;const tt=o.endDTS-_;tt>0&&tt<15e-7&&(_+=15e-7),_e&&o.level!==_e.level&&_e.end<=o.end&&(_e=i[2+o.sn-i[0].sn]||null)}else _===0&&i[0].start===0&&(_e=i[0]);if(_e&&((!o||o.level===_e.level)&&fragmentWithinToleranceTest(_,$,_e)===0||fragmentWithinFastStartSwitch(_e,o,Math.min(j,$))))return _e;const et=BinarySearch.search(i,fragmentWithinToleranceTest.bind(null,_,$));return et&&(et!==o||!_e)?et:_e}function fragmentWithinFastStartSwitch(o,i,_){if(i&&i.start===0&&i.level<o.level&&(i.endPTS||0)>0){const $=i.tagList.reduce((j,_e)=>(_e[0]==="INF"&&(j+=parseFloat(_e[1])),j),_);return o.start<=$}return!1}function fragmentWithinToleranceTest(o=0,i=0,_){if(_.start<=o&&_.start+_.duration>o)return 0;const $=Math.min(i,_.duration+(_.deltaPTS?_.deltaPTS:0));return _.start+_.duration-$<=o?1:_.start-$>o&&_.start?-1:0}function pdtWithinToleranceTest(o,i,_){const $=Math.min(i,_.duration+(_.deltaPTS?_.deltaPTS:0))*1e3;return(_.endProgramDateTime||0)-$>o}function findNearestWithCC(o,i,_){if(o&&o.startCC<=i&&o.endCC>=i){let $=o.fragments;const{fragmentHint:j}=o;j&&($=$.concat(j));let _e;return BinarySearch.search($,et=>et.cc<i?1:et.cc>i?-1:(_e=et,et.end<=_?1:et.start>_?-1:0)),_e||null}return null}function isTimeoutError(o){switch(o.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function isKeyError(o){return o.details.startsWith("key")}function isUnusableKeyError(o){return isKeyError(o)&&!!o.frag&&!o.frag.decryptdata}function getRetryConfig(o,i){const _=isTimeoutError(i);return o.default[`${_?"timeout":"error"}Retry`]}function getRetryDelay(o,i){const _=o.backoff==="linear"?1:Math.pow(2,i);return Math.min(_*o.retryDelayMs,o.maxRetryDelayMs)}function getLoaderConfigWithoutReties(o){return _objectSpread2(_objectSpread2({},o),{errorRetry:null,timeoutRetry:null})}function shouldRetry(o,i,_,$){if(!o)return!1;const j=$==null?void 0:$.code,_e=i<o.maxNumRetry&&(retryForHttpStatus(j)||!!_);return o.shouldRetry?o.shouldRetry(o,i,_,$,_e):_e}function retryForHttpStatus(o){return offlineHttpStatus(o)||!!o&&(o<400||o>499)}function offlineHttpStatus(o){return o===0&&navigator.onLine===!1}var NetworkErrorAction={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class ErrorController extends Logger$1{constructor(i){super("error-controller",i.logger),this.hls=void 0,this.playlistError=0,this.hls=i,this.registerListeners()}registerListeners(){const i=this.hls;i.on(Events.ERROR,this.onError,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const i=this.hls;i&&(i.off(Events.ERROR,this.onError,this),i.off(Events.ERROR,this.onErrorOut,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(i){}stopLoad(){this.playlistError=0}getVariantLevelIndex(i){return(i==null?void 0:i.type)===PlaylistLevelType.MAIN?i.level:this.getVariantIndex()}getVariantIndex(){var i;const _=this.hls,$=_.currentLevel;return(i=_.loadLevelObj)!=null&&i.details||$===-1?_.loadLevel:$}variantHasKey(i,_){if(i){var $;if(($=i.details)!=null&&$.hasKey(_))return!0;const j=i.audioGroups;if(j)return this.hls.allAudioTracks.filter(et=>j.indexOf(et.groupId)>=0).some(et=>{var tt;return(tt=et.details)==null?void 0:tt.hasKey(_)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(i,_){var $;if(_.fatal)return;const j=this.hls,_e=_.context;switch(_.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:_.errorAction=this.getFragRetryOrSwitchAction(_);return;case ErrorDetails.FRAG_PARSING_ERROR:if(($=_.frag)!=null&&$.gap){_.errorAction=createDoNothingErrorAction();return}case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:{_.errorAction=this.getFragRetryOrSwitchAction(_),_.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var et;const rt=_.parent===PlaylistLevelType.MAIN?_.level:j.loadLevel;_.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((et=_.context)!=null&&(et=et.levelDetails)!=null&&et.live)?_.errorAction=this.getPlaylistRetryOrSwitchAction(_,rt):(_.levelRetry=!1,_.errorAction=this.getLevelSwitchAction(_,rt))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(_e==null?void 0:_e.level)=="number"&&(_.errorAction=this.getPlaylistRetryOrSwitchAction(_,_e.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(_e){const rt=j.loadLevelObj;if(rt&&(_e.type===PlaylistContextType.AUDIO_TRACK&&rt.hasAudioGroup(_e.groupId)||_e.type===PlaylistContextType.SUBTITLE_TRACK&&rt.hasSubtitleGroup(_e.groupId))){_.errorAction=this.getPlaylistRetryOrSwitchAction(_,j.loadLevel),_.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,_.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:_.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP};return;case ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED:case ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case ErrorDetails.KEY_SYSTEM_NO_SESSION:_.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingKey};return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(!_.errorAction){var tt;_.errorAction=this.getLevelSwitchAction(_,(tt=_.level)!=null?tt:j.loadLevel)}return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:_.errorAction=createDoNothingErrorAction();return}_.type===ErrorTypes.KEY_SYSTEM_ERROR&&(_.levelRetry=!1,_.errorAction=createDoNothingErrorAction())}getPlaylistRetryOrSwitchAction(i,_){const $=this.hls,j=getRetryConfig($.config.playlistLoadPolicy,i),_e=this.playlistError++;if(shouldRetry(j,_e,isTimeoutError(i),i.response))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:j,retryCount:_e};const tt=this.getLevelSwitchAction(i,_);return j&&(tt.retryConfig=j,tt.retryCount=_e),tt}getFragRetryOrSwitchAction(i){const _=this.hls,$=this.getVariantLevelIndex(i.frag),j=_.levels[$],{fragLoadPolicy:_e,keyLoadPolicy:et}=_.config,tt=getRetryConfig(isKeyError(i)?et:_e,i),rt=_.levels.reduce((it,st)=>it+st.fragmentError,0);if(j&&(i.details!==ErrorDetails.FRAG_GAP&&j.fragmentError++,!isUnusableKeyError(i)&&shouldRetry(tt,rt,isTimeoutError(i),i.response)))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:tt,retryCount:rt};const nt=this.getLevelSwitchAction(i,$);return tt&&(nt.retryConfig=tt,nt.retryCount=rt),nt}getLevelSwitchAction(i,_){const $=this.hls;_==null&&(_=$.loadLevel);const j=this.hls.levels[_];if(j){var _e,et;const nt=i.details;j.loadError++,nt===ErrorDetails.BUFFER_APPEND_ERROR&&j.fragmentError++;let it=-1;const{levels:st,loadLevel:at,minAutoLevel:ot,maxAutoLevel:lt}=$;!$.autoLevelEnabled&&!$.config.preserveManualLevelOnError&&($.loadLevel=-1);const ct=(_e=i.frag)==null?void 0:_e.type,ut=(ct===PlaylistLevelType.AUDIO&&nt===ErrorDetails.FRAG_PARSING_ERROR||i.sourceBufferName==="audio"&&(nt===ErrorDetails.BUFFER_ADD_CODEC_ERROR||nt===ErrorDetails.BUFFER_APPEND_ERROR))&&st.some(({audioCodec:yt})=>j.audioCodec!==yt),dt=i.sourceBufferName==="video"&&(nt===ErrorDetails.BUFFER_ADD_CODEC_ERROR||nt===ErrorDetails.BUFFER_APPEND_ERROR)&&st.some(({codecSet:yt,audioCodec:gt})=>j.codecSet!==yt&&j.audioCodec===gt),{type:mt,groupId:pt}=(et=i.context)!=null?et:{};for(let yt=st.length;yt--;){const gt=(yt+at)%st.length;if(gt!==at&&gt>=ot&&gt<=lt&&st[gt].loadError===0){var tt,rt;const vt=st[gt];if(nt===ErrorDetails.FRAG_GAP&&ct===PlaylistLevelType.MAIN&&i.frag){const St=st[gt].details;if(St){const At=findFragmentByPTS(i.frag,St.fragments,i.frag.start);if(At!=null&&At.gap)continue}}else{if(mt===PlaylistContextType.AUDIO_TRACK&&vt.hasAudioGroup(pt)||mt===PlaylistContextType.SUBTITLE_TRACK&&vt.hasSubtitleGroup(pt))continue;if(ct===PlaylistLevelType.AUDIO&&(tt=j.audioGroups)!=null&&tt.some(St=>vt.hasAudioGroup(St))||ct===PlaylistLevelType.SUBTITLE&&(rt=j.subtitleGroups)!=null&&rt.some(St=>vt.hasSubtitleGroup(St))||ut&&j.audioCodec===vt.audioCodec||dt&&j.codecSet===vt.codecSet||!ut&&j.codecSet!==vt.codecSet)continue}it=gt;break}}if(it>-1&&$.loadLevel!==it)return i.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:it}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(i,_){var $;switch(($=_.errorAction)==null?void 0:$.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(_),!_.errorAction.resolved&&_.details!==ErrorDetails.FRAG_GAP?_.fatal=!0:/MediaSource readyState: ended/.test(_.error.message)&&(this.warn(`MediaSource ended after "${_.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(_.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(i){const _=this.hls,$=i.errorAction;if(!$)return;const{flags:j}=$,_e=$.nextAutoLevel;switch(j){case ErrorActionFlags.None:this.switchLevel(i,_e);break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:{const rt=this.getVariantLevelIndex(i.frag),nt=_.levels[rt],it=nt==null?void 0:nt.attrs["HDCP-LEVEL"];if($.hdcpLevel=it,it==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(it){_.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(it)-1],$.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${_.maxHdcpLevel}" or lower`);break}}case ErrorActionFlags.MoveAllAlternatesMatchingKey:{const rt=i.decryptdata;if(rt){const nt=this.hls.levels,it=nt.length;for(let at=it;at--;)if(this.variantHasKey(nt[at],rt)){var et,tt;this.log(`Banned key found in level ${at} (${nt[at].bitrate}bps) or audio group "${(et=nt[at].audioGroups)==null?void 0:et.join(",")}" (${(tt=i.frag)==null?void 0:tt.type} fragment) ${arrayToHex(rt.keyId||[])}`),nt[at].fragmentError++,nt[at].loadError++,this.log(`Removing level ${at} with key error (${i.error})`),this.hls.removeLevel(at)}const st=i.frag;if(this.hls.levels.length<it)$.resolved=!0;else if(st&&st.type!==PlaylistLevelType.MAIN){const at=st.decryptdata;at&&!rt.matches(at)&&($.resolved=!0)}}break}}$.resolved||this.switchLevel(i,_e)}switchLevel(i,_){if(_!==void 0&&i.errorAction&&(this.warn(`switching to level ${_} after ${i.details}`),this.hls.nextAutoLevel=_,i.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,i.details===ErrorDetails.BUFFER_ADD_CODEC_ERROR&&i.mimeType&&i.sourceBufferName!=="audiovideo")){const $=getCodecsForMimeType(i.mimeType),j=this.hls.levels;for(let _e=j.length;_e--;)j[_e][`${i.sourceBufferName}Codec`]===$&&(this.log(`Removing level ${_e} for ${i.details} ("${$}" not supported)`),this.hls.removeLevel(_e))}}}function createDoNothingErrorAction(o){const i={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return o&&(i.resolved=!0),i}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(i){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=i,this._registerListeners()}_registerListeners(){const{hls:i}=this;i&&(i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),i.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(Events.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:i}=this;i&&(i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),i.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(Events.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(i,_){const $=this.activePartLists[_];if($)for(let j=$.length;j--;){const _e=$[j];if(!_e)break;if(_e.start<=i&&i<=_e.end&&_e.loaded)return _e}return this.getBufferedFrag(i,_)}getBufferedFrag(i,_){return this.getFragAtPos(i,_,!0)}getFragAtPos(i,_,$){const{fragments:j}=this,_e=Object.keys(j);for(let et=_e.length;et--;){const tt=j[_e[et]];if((tt==null?void 0:tt.body.type)===_&&(!$||tt.buffered)){const rt=tt.body;if(rt.start<=i&&i<=rt.end)return rt}}return null}detectEvictedFragments(i,_,$,j,_e){this.timeRanges&&(this.timeRanges[i]=_);const et=(j==null?void 0:j.fragment.sn)||-1;Object.keys(this.fragments).forEach(tt=>{const rt=this.fragments[tt];if(!rt||et>=rt.body.sn)return;if(!rt.buffered&&(!rt.loaded||_e)){rt.body.type===$&&this.removeFragment(rt.body);return}const nt=rt.range[i];if(nt){if(nt.time.length===0){this.removeFragment(rt.body);return}nt.time.some(it=>{const st=!this.isTimeBuffered(it.startPTS,it.endPTS,_);return st&&this.removeFragment(rt.body),st})}})}detectPartialFragments(i){const _=this.timeRanges;if(!_||i.frag.sn==="initSegment")return;const $=i.frag,j=getFragmentKey($),_e=this.fragments[j];if(!_e||_e.buffered&&$.gap)return;const et=!$.relurl;Object.keys(_).forEach(tt=>{const rt=$.elementaryStreams[tt];if(!rt)return;const nt=_[tt],it=et||rt.partial===!0;_e.range[tt]=this.getBufferedTimes($,i.part,it,nt)}),_e.loaded=null,Object.keys(_e.range).length?(_e.buffered=!0,(_e.body.endList=$.endList||_e.body.endList)&&(this.endListFragments[_e.body.type]=_e),isPartial(_e)||this.removeParts($.sn-1,$.type)):this.removeFragment(_e.body)}removeParts(i,_){const $=this.activePartLists[_];$&&(this.activePartLists[_]=filterParts($,j=>j.fragment.sn>=i))}fragBuffered(i,_){const $=getFragmentKey(i);let j=this.fragments[$];!j&&_&&(j=this.fragments[$]={body:i,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},i.gap&&(this.hasGaps=!0)),j&&(j.loaded=null,j.buffered=!0)}getBufferedTimes(i,_,$,j){const _e={time:[],partial:$},et=i.start,tt=i.end,rt=i.minEndPTS||tt,nt=i.maxStartPTS||et;for(let it=0;it<j.length;it++){const st=j.start(it)-this.bufferPadding,at=j.end(it)+this.bufferPadding;if(nt>=st&&rt<=at){_e.time.push({startPTS:Math.max(et,j.start(it)),endPTS:Math.min(tt,j.end(it))});break}else if(et<at&&tt>st){const ot=Math.max(et,j.start(it)),lt=Math.min(tt,j.end(it));lt>ot&&(_e.partial=!0,_e.time.push({startPTS:ot,endPTS:lt}))}else if(tt<=st)break}return _e}getPartialFragment(i){let _=null,$,j,_e,et=0;const{bufferPadding:tt,fragments:rt}=this;return Object.keys(rt).forEach(nt=>{const it=rt[nt];it&&isPartial(it)&&(j=it.body.start-tt,_e=it.body.end+tt,i>=j&&i<=_e&&($=Math.min(i-j,_e-i),et<=$&&(_=it.body,et=$)))}),_}isEndListAppended(i){const _=this.endListFragments[i];return _!==void 0&&(_.buffered||isPartial(_))}getState(i){const _=getFragmentKey(i),$=this.fragments[_];return $?$.buffered?isPartial($)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(i,_,$){let j,_e;for(let et=0;et<$.length;et++){if(j=$.start(et)-this.bufferPadding,_e=$.end(et)+this.bufferPadding,i>=j&&_<=_e)return!0;if(_<=j)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(i,_){if(_.frag.sn==="initSegment"||_.frag.bitrateTest)return;const $=_.frag,j=_.part?null:_,_e=getFragmentKey($);this.fragments[_e]={body:$,appendedPTS:null,loaded:j,buffered:!1,range:Object.create(null)}}onBufferAppended(i,_){const{frag:$,part:j,timeRanges:_e,type:et}=_;if($.sn==="initSegment")return;const tt=$.type;if(j){let nt=this.activePartLists[tt];nt||(this.activePartLists[tt]=nt=[]),nt.push(j)}this.timeRanges=_e;const rt=_e[et];this.detectEvictedFragments(et,rt,tt,j)}onFragBuffered(i,_){this.detectPartialFragments(_)}hasFragment(i){const _=getFragmentKey(i);return!!this.fragments[_]}hasFragments(i){const{fragments:_}=this,$=Object.keys(_);if(!i)return $.length>0;for(let j=$.length;j--;){const _e=_[$[j]];if((_e==null?void 0:_e.body.type)===i)return!0}return!1}hasParts(i){var _;return!!((_=this.activePartLists[i])!=null&&_.length)}removeFragmentsInRange(i,_,$,j,_e){j&&!this.hasGaps||Object.keys(this.fragments).forEach(et=>{const tt=this.fragments[et];if(!tt)return;const rt=tt.body;rt.type!==$||j&&!rt.gap||rt.start<_&&rt.end>i&&(tt.buffered||_e)&&this.removeFragment(rt)})}removeFragment(i){const _=getFragmentKey(i);i.clearElementaryStreamInfo();const $=this.activePartLists[i.type];if($){const j=i.sn;this.activePartLists[i.type]=filterParts($,_e=>_e.fragment.sn!==j)}delete this.fragments[_],i.endList&&delete this.endListFragments[i.type]}removeAllFragments(){var i;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const _=(i=this.hls)==null||(i=i.latestLevelDetails)==null?void 0:i.partList;_&&_.forEach($=>$.clearElementaryStreamInfo())}}function isPartial(o){var i,_,$;return o.buffered&&!!(o.body.gap||(i=o.range.video)!=null&&i.partial||(_=o.range.audio)!=null&&_.partial||($=o.range.audiovideo)!=null&&$.partial)}function getFragmentKey(o){return`${o.type}_${o.level}_${o.sn}`}function filterParts(o,i){return o.filter(_=>{const $=i(_);return $||_.clearElementaryStreamInfo(),$})}var DecrypterAesMode={cbc:0,ctr:1};class AESCrypto{constructor(i,_,$){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=i,this.aesIV=_,this.aesMode=$}decrypt(i,_){switch(this.aesMode){case DecrypterAesMode.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},_,i);case DecrypterAesMode.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},_,i);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function removePadding(o){const i=o.byteLength,_=i&&new DataView(o.buffer).getUint8(i-1);return _?o.slice(0,i-_):o}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(i){const _=new DataView(i),$=new Uint32Array(4);for(let j=0;j<4;j++)$[j]=_.getUint32(j*4);return $}initTable(){const i=this.sBox,_=this.invSBox,$=this.subMix,j=$[0],_e=$[1],et=$[2],tt=$[3],rt=this.invSubMix,nt=rt[0],it=rt[1],st=rt[2],at=rt[3],ot=new Uint32Array(256);let lt=0,ct=0,ft=0;for(ft=0;ft<256;ft++)ft<128?ot[ft]=ft<<1:ot[ft]=ft<<1^283;for(ft=0;ft<256;ft++){let ut=ct^ct<<1^ct<<2^ct<<3^ct<<4;ut=ut>>>8^ut&255^99,i[lt]=ut,_[ut]=lt;const ht=ot[lt],dt=ot[ht],mt=ot[dt];let pt=ot[ut]*257^ut*16843008;j[lt]=pt<<24|pt>>>8,_e[lt]=pt<<16|pt>>>16,et[lt]=pt<<8|pt>>>24,tt[lt]=pt,pt=mt*16843009^dt*65537^ht*257^lt*16843008,nt[ut]=pt<<24|pt>>>8,it[ut]=pt<<16|pt>>>16,st[ut]=pt<<8|pt>>>24,at[ut]=pt,lt?(lt=ht^ot[ot[ot[mt^ht]]],ct^=ot[ot[ct]]):lt=ct=1}}expandKey(i){const _=this.uint8ArrayToUint32Array_(i);let $=!0,j=0;for(;j<_.length&&$;)$=_[j]===this.key[j],j++;if($)return;this.key=_;const _e=this.keySize=_.length;if(_e!==4&&_e!==6&&_e!==8)throw new Error("Invalid aes key size="+_e);const et=this.ksRows=(_e+6+1)*4;let tt,rt;const nt=this.keySchedule=new Uint32Array(et),it=this.invKeySchedule=new Uint32Array(et),st=this.sBox,at=this.rcon,ot=this.invSubMix,lt=ot[0],ct=ot[1],ft=ot[2],ut=ot[3];let ht,dt;for(tt=0;tt<et;tt++){if(tt<_e){ht=nt[tt]=_[tt];continue}dt=ht,tt%_e===0?(dt=dt<<8|dt>>>24,dt=st[dt>>>24]<<24|st[dt>>>16&255]<<16|st[dt>>>8&255]<<8|st[dt&255],dt^=at[tt/_e|0]<<24):_e>6&&tt%_e===4&&(dt=st[dt>>>24]<<24|st[dt>>>16&255]<<16|st[dt>>>8&255]<<8|st[dt&255]),nt[tt]=ht=(nt[tt-_e]^dt)>>>0}for(rt=0;rt<et;rt++)tt=et-rt,rt&3?dt=nt[tt]:dt=nt[tt-4],rt<4||tt<=4?it[rt]=dt:it[rt]=lt[st[dt>>>24]]^ct[st[dt>>>16&255]]^ft[st[dt>>>8&255]]^ut[st[dt&255]],it[rt]=it[rt]>>>0}networkToHostOrderSwap(i){return i<<24|(i&65280)<<8|(i&16711680)>>8|i>>>24}decrypt(i,_,$){const j=this.keySize+6,_e=this.invKeySchedule,et=this.invSBox,tt=this.invSubMix,rt=tt[0],nt=tt[1],it=tt[2],st=tt[3],at=this.uint8ArrayToUint32Array_($);let ot=at[0],lt=at[1],ct=at[2],ft=at[3];const ut=new Int32Array(i),ht=new Int32Array(ut.length);let dt,mt,pt,yt,gt,vt,St,At,xt,wt,Ot,Bt,Ft,Pt;const Rt=this.networkToHostOrderSwap;for(;_<ut.length;){for(xt=Rt(ut[_]),wt=Rt(ut[_+1]),Ot=Rt(ut[_+2]),Bt=Rt(ut[_+3]),gt=xt^_e[0],vt=Bt^_e[1],St=Ot^_e[2],At=wt^_e[3],Ft=4,Pt=1;Pt<j;Pt++)dt=rt[gt>>>24]^nt[vt>>16&255]^it[St>>8&255]^st[At&255]^_e[Ft],mt=rt[vt>>>24]^nt[St>>16&255]^it[At>>8&255]^st[gt&255]^_e[Ft+1],pt=rt[St>>>24]^nt[At>>16&255]^it[gt>>8&255]^st[vt&255]^_e[Ft+2],yt=rt[At>>>24]^nt[gt>>16&255]^it[vt>>8&255]^st[St&255]^_e[Ft+3],gt=dt,vt=mt,St=pt,At=yt,Ft=Ft+4;dt=et[gt>>>24]<<24^et[vt>>16&255]<<16^et[St>>8&255]<<8^et[At&255]^_e[Ft],mt=et[vt>>>24]<<24^et[St>>16&255]<<16^et[At>>8&255]<<8^et[gt&255]^_e[Ft+1],pt=et[St>>>24]<<24^et[At>>16&255]<<16^et[gt>>8&255]<<8^et[vt&255]^_e[Ft+2],yt=et[At>>>24]<<24^et[gt>>16&255]<<16^et[vt>>8&255]<<8^et[St&255]^_e[Ft+3],ht[_]=Rt(dt^ot),ht[_+1]=Rt(yt^lt),ht[_+2]=Rt(pt^ct),ht[_+3]=Rt(mt^ft),ot=xt,lt=wt,ct=Ot,ft=Bt,_=_+4}return ht.buffer}}class FastAESKey{constructor(i,_,$){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=i,this.key=_,this.aesMode=$}expandKey(){const i=getSubtleAlgoName(this.aesMode);return this.subtle.importKey("raw",this.key,{name:i},!1,["encrypt","decrypt"])}}function getSubtleAlgoName(o){switch(o){case DecrypterAesMode.cbc:return"AES-CBC";case DecrypterAesMode.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${o}`)}}const CHUNK_SIZE=16;class Decrypter{constructor(i,{removePKCS7Padding:_=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=i.enableSoftwareAES,this.removePKCS7Padding=_,_)try{const $=self.crypto;$&&(this.subtle=$.subtle||$.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:i,remainderData:_}=this;if(!i||_)return this.reset(),null;const $=new Uint8Array(i);return this.reset(),this.removePKCS7Padding?removePadding($):$}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(i,_,$,j){return this.useSoftware?new Promise((_e,et)=>{const tt=ArrayBuffer.isView(i)?i:new Uint8Array(i);this.softwareDecrypt(tt,_,$,j);const rt=this.flush();rt?_e(rt.buffer):et(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(i),_,$,j)}softwareDecrypt(i,_,$,j){const{currentIV:_e,currentResult:et,remainderData:tt}=this;if(j!==DecrypterAesMode.cbc||_.byteLength!==16)return logger.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),tt&&(i=appendUint8Array(tt,i),this.remainderData=null);const rt=this.getValidChunk(i);if(!rt.length)return null;_e&&($=_e);let nt=this.softwareDecrypter;nt||(nt=this.softwareDecrypter=new AESDecryptor),nt.expandKey(_);const it=et;return this.currentResult=nt.decrypt(rt.buffer,0,$),this.currentIV=rt.slice(-16).buffer,it||null}webCryptoDecrypt(i,_,$,j){if(this.key!==_||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(i,_,$,j));this.key=_,this.fastAesKey=new FastAESKey(this.subtle,_,j)}return this.fastAesKey.expandKey().then(_e=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(this.subtle,new Uint8Array($),j).decrypt(i.buffer,_e)):Promise.reject(new Error("web crypto not initialized"))).catch(_e=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${_e.name}: ${_e.message}`),this.onWebCryptoError(i,_,$,j)))}onWebCryptoError(i,_,$,j){const _e=this.enableSoftwareAES;if(_e){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(i,_,$,j);const et=this.flush();if(et)return et.buffer}throw new Error("WebCrypto"+(_e?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(i){let _=i;const $=i.length-i.length%CHUNK_SIZE;return $!==i.length&&(_=i.slice(0,$),this.remainderData=i.slice($)),_}logOnce(i){this.logEnabled&&(logger.log(`[decrypter]: ${i}`),this.logEnabled=!1)}}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(i,_){const $=i.url;if(!$)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,error:new Error(`Fragment does not have a ${$?"part list":"url"}`),networkDetails:null}));this.abort();const j=this.config,_e=j.fLoader,et=j.loader;return new Promise((tt,rt)=>{if(this.loader&&this.loader.destroy(),i.gap)if(i.tagList.some(lt=>lt[0]==="GAP")){rt(createGapLoadError(i));return}else i.gap=!1;const nt=this.loader=_e?new _e(j):new et(j),it=createLoaderContext(i);i.loader=nt;const st=getLoaderConfigWithoutReties(j.fragLoadPolicy.default),at={loadPolicy:st,timeout:st.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:i.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};i.stats=nt.stats;const ot={onSuccess:(lt,ct,ft,ut)=>{this.resetLoader(i,nt);let ht=lt.data;ft.resetIV&&i.decryptdata&&(i.decryptdata.iv=new Uint8Array(ht.slice(0,16)),ht=ht.slice(16)),tt({frag:i,part:null,payload:ht,networkDetails:ut})},onError:(lt,ct,ft,ut)=>{this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,response:_objectSpread2({url:$,data:void 0},lt),error:new Error(`HTTP Error ${lt.code} ${lt.text}`),networkDetails:ft,stats:ut}))},onAbort:(lt,ct,ft)=>{this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,error:new Error("Aborted"),networkDetails:ft,stats:lt}))},onTimeout:(lt,ct,ft)=>{this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,error:new Error(`Timeout after ${at.timeout}ms`),networkDetails:ft,stats:lt}))}};_&&(ot.onProgress=(lt,ct,ft,ut)=>_({frag:i,part:null,payload:ft,networkDetails:ut})),nt.load(it,at,ot)})}loadPart(i,_,$){this.abort();const j=this.config,_e=j.fLoader,et=j.loader;return new Promise((tt,rt)=>{if(this.loader&&this.loader.destroy(),i.gap||_.gap){rt(createGapLoadError(i,_));return}const nt=this.loader=_e?new _e(j):new et(j),it=createLoaderContext(i,_);i.loader=nt;const st=getLoaderConfigWithoutReties(j.fragLoadPolicy.default),at={loadPolicy:st,timeout:st.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};_.stats=nt.stats,nt.load(it,at,{onSuccess:(ot,lt,ct,ft)=>{this.resetLoader(i,nt),this.updateStatsFromPart(i,_);const ut={frag:i,part:_,payload:ot.data,networkDetails:ft};$(ut),tt(ut)},onError:(ot,lt,ct,ft)=>{this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:i,part:_,response:_objectSpread2({url:it.url,data:void 0},ot),error:new Error(`HTTP Error ${ot.code} ${ot.text}`),networkDetails:ct,stats:ft}))},onAbort:(ot,lt,ct)=>{i.stats.aborted=_.stats.aborted,this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:i,part:_,error:new Error("Aborted"),networkDetails:ct,stats:ot}))},onTimeout:(ot,lt,ct)=>{this.resetLoader(i,nt),rt(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:i,part:_,error:new Error(`Timeout after ${at.timeout}ms`),networkDetails:ct,stats:ot}))}})})}updateStatsFromPart(i,_){const $=i.stats,j=_.stats,_e=j.total;if($.loaded+=j.loaded,_e){const rt=Math.round(i.duration/_.duration),nt=Math.min(Math.round($.loaded/_e),rt),st=(rt-nt)*Math.round($.loaded/nt);$.total=$.loaded+st}else $.total=Math.max($.loaded,$.total);const et=$.loading,tt=j.loading;et.start?et.first+=tt.first-tt.start:(et.start=tt.start,et.first=tt.first),et.end=tt.end}resetLoader(i,_){i.loader=null,this.loader===_&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),_.destroy()}}function createLoaderContext(o,i=null){const _=i||o,$={frag:o,part:i,responseType:"arraybuffer",url:_.url,headers:{},rangeStart:0,rangeEnd:0},j=_.byteRangeStartOffset,_e=_.byteRangeEndOffset;if(isFiniteNumber(j)&&isFiniteNumber(_e)){var et;let tt=j,rt=_e;if(o.sn==="initSegment"&&isMethodFullSegmentAesCbc((et=o.decryptdata)==null?void 0:et.method)){const nt=_e-j;nt%16&&(rt=_e+(16-nt%16)),j!==0&&($.resetIV=!0,tt=j-16)}$.rangeStart=tt,$.rangeEnd=rt}return $}function createGapLoadError(o,i){const _=new Error(`GAP ${o.gap?"tag":"attribute"} found`),$={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:o,error:_,networkDetails:null};return i&&($.part=i),(i||o).stats.aborted=!0,new LoadError($)}function isMethodFullSegmentAesCbc(o){return o==="AES-128"||o==="AES-256"}class LoadError extends Error{constructor(i){super(i.error.message),this.data=void 0,this.data=i}}class TaskLoop extends Logger$1{constructor(i,_){super(i,_),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(i){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,i),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class ChunkMetadata{constructor(i,_,$,j=0,_e=-1,et=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=i,this.sn=_,this.id=$,this.size=j,this.part=_e,this.partial=et}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(i,_){if(i){const $=BufferHelper.getBuffered(i);for(let j=$.length;j--;)if(_>=$.start(j)&&_<=$.end(j))return!0}return!1}static bufferedRanges(i){if(i){const _=BufferHelper.getBuffered(i);return BufferHelper.timeRangesToArray(_)}return[]}static timeRangesToArray(i){const _=[];for(let $=0;$<i.length;$++)_.push({start:i.start($),end:i.end($)});return _}static bufferInfo(i,_,$){if(i){const j=BufferHelper.bufferedRanges(i);if(j.length)return BufferHelper.bufferedInfo(j,_,$)}return{len:0,start:_,end:_,bufferedIndex:-1}}static bufferedInfo(i,_,$){_=Math.max(0,_),i.length>1&&i.sort((it,st)=>it.start-st.start||st.end-it.end);let j=-1,_e=[];if($)for(let it=0;it<i.length;it++){_>=i[it].start&&_<=i[it].end&&(j=it);const st=_e.length;if(st){const at=_e[st-1].end;i[it].start-at<$?i[it].end>at&&(_e[st-1].end=i[it].end):_e.push(i[it])}else _e.push(i[it])}else _e=i;let et=0,tt,rt=_,nt=_;for(let it=0;it<_e.length;it++){const st=_e[it].start,at=_e[it].end;if(j===-1&&_>=st&&_<=at&&(j=it),_+$>=st&&_<at)rt=st,nt=at,et=nt-_;else if(_+$<st){tt=st;break}}return{len:et,start:rt||0,end:nt||0,nextStart:tt,buffered:i,bufferedIndex:j}}static getBuffered(i){try{return i.buffered||noopBuffered}catch(_){return logger.log("failed to get media.buffered",_),noopBuffered}}}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(o){return VARIABLE_REPLACEMENT_REGEX.test(o)}function substituteVariables(o,i){if(o.variableList!==null||o.hasVariableRefs){const _=o.variableList;return i.replace(VARIABLE_REPLACEMENT_REGEX,$=>{const j=$.substring(2,$.length-1),_e=_==null?void 0:_[j];return _e===void 0?(o.playlistParsingError||(o.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${j}"`)),$):_e})}return i}function addVariableDefinition(o,i,_){let $=o.variableList;$||(o.variableList=$={});let j,_e;if("QUERYPARAM"in i){j=i.QUERYPARAM;try{const et=new self.URL(_).searchParams;if(et.has(j))_e=et.get(j);else throw new Error(`"${j}" does not match any query parameter in URI: "${_}"`)}catch(et){o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${et.message}`))}}else j=i.NAME,_e=i.VALUE;j in $?o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${j}"`)):$[j]=_e||""}function importVariableDefinition(o,i,_){const $=i.IMPORT;if(_&&$ in _){let j=o.variableList;j||(o.variableList=j={}),j[$]=_[$]}else o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${$}"`))}const DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(i,_){typeof i=="string"&&(i=AttrList.parseAttrList(i,_)),_extends(this,i)}get clientAttrs(){return Object.keys(this).filter(i=>i.substring(0,2)==="X-")}decimalInteger(i){const _=parseInt(this[i],10);return _>Number.MAX_SAFE_INTEGER?1/0:_}hexadecimalInteger(i){if(this[i]){let _=(this[i]||"0x").slice(2);_=(_.length&1?"0":"")+_;const $=new Uint8Array(_.length/2);for(let j=0;j<_.length/2;j++)$[j]=parseInt(_.slice(j*2,j*2+2),16);return $}return null}hexadecimalIntegerAsNumber(i){const _=parseInt(this[i],16);return _>Number.MAX_SAFE_INTEGER?1/0:_}decimalFloatingPoint(i){return parseFloat(this[i])}optionalFloat(i,_){const $=this[i];return $?parseFloat($):_}enumeratedString(i){return this[i]}enumeratedStringList(i,_){const $=this[i];return($?$.split(/[ ,]+/):[]).reduce((j,_e)=>(j[_e.toLowerCase()]=!0,j),_)}bool(i){return this[i]==="YES"}decimalResolution(i){const _=DECIMAL_RESOLUTION_REGEX.exec(this[i]);if(_!==null)return{width:parseInt(_[1],10),height:parseInt(_[2],10)}}static parseAttrList(i,_){let $;const j={},_e='"';for(ATTR_LIST_REGEX.lastIndex=0;($=ATTR_LIST_REGEX.exec(i))!==null;){const et=$[1].trim();let tt=$[2];const rt=tt.indexOf(_e)===0&&tt.lastIndexOf(_e)===tt.length-1;let nt=!1;if(rt)tt=tt.slice(1,-1);else switch(et){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":nt=!0}if(_&&(rt||nt))tt=substituteVariables(_,tt);else if(!nt&&!rt)switch(et){case"CLOSED-CAPTIONS":if(tt==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":logger.warn(`${i}: attribute ${et} is missing quotes`)}j[et]=tt}return j}}const CLASS_INTERSTITIAL="com.apple.hls.interstitial";function isDateRangeCueAttribute(o){return o!=="ID"&&o!=="CLASS"&&o!=="CUE"&&o!=="START-DATE"&&o!=="DURATION"&&o!=="END-DATE"&&o!=="END-ON-NEXT"}function isSCTE35Attribute(o){return o==="SCTE35-OUT"||o==="SCTE35-IN"||o==="SCTE35-CMD"}class DateRange{constructor(i,_,$=0){var j;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(_==null?void 0:_.tagAnchor)||null,this.tagOrder=(j=_==null?void 0:_.tagOrder)!=null?j:$,_){const _e=_.attr;for(const et in _e)if(Object.prototype.hasOwnProperty.call(i,et)&&i[et]!==_e[et]){logger.warn(`DATERANGE tag attribute: "${et}" does not match for tags with ID: "${i.ID}"`),this._badValueForSameId=et;break}i=_extends(new AttrList({}),_e,i)}if(this.attr=i,_?(this._startDate=_._startDate,this._cue=_._cue,this._endDate=_._endDate,this._dateAtEnd=_._dateAtEnd):this._startDate=new Date(i["START-DATE"]),"END-DATE"in this.attr){const _e=(_==null?void 0:_.endDate)||new Date(this.attr["END-DATE"]);isFiniteNumber(_e.getTime())&&(this._endDate=_e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const i=this._cue;return i===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):i}get startTime(){const{tagAnchor:i}=this;return i===null||i.programDateTime===null?(logger.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${i}`),NaN):i.start+(this.startDate.getTime()-i.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const i=this._endDate||this._dateAtEnd;if(i)return i;const _=this.duration;return _!==null?this._dateAtEnd=new Date(this._startDate.getTime()+_*1e3):null}get duration(){if("DURATION"in this.attr){const i=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(i))return i}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===CLASS_INTERSTITIAL}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(i){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=i}reloaded(i){if(!i){this.advanced=!0,this.updated=!0;return}const _=this.lastPartSn-i.lastPartSn,$=this.lastPartIndex-i.lastPartIndex;this.updated=this.endSN!==i.endSN||!!$||!!_||!this.live,this.advanced=this.endSN>i.endSN||_>0||_===0&&$>0,this.updated||this.advanced?this.misses=Math.floor(i.misses*.6):this.misses=i.misses+1}hasKey(i){return this.encryptedFragments.some(_=>{let $=_.decryptdata;return $||(_.setKeyFormat(i.keyFormat),$=_.decryptdata),!!$&&i.matches($)})}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const i=this.driftEndTime-this.driftStartTime;return i>0?(this.driftEnd-this.driftStart)*1e3/i:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var i;return(i=this.partList)!=null&&i.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var i;return(i=this.partList)!=null&&i.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const i=this.partList;if(i){const _=this.lastPartIndex;if(_!==-1){for(let $=i.length;$--;)if(i[$].index>_)return i[$].index;return _}}return 0}get lastPartSn(){var i;return(i=this.partList)!=null&&i.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const i=this.partEnd-this.fragmentStart;return this.age>Math.max(i,this.totalduration)+this.levelTargetDuration}return!1}}function arrayValuesMatch(o,i){return o.length===i.length?!o.some((_,$)=>_!==i[$]):!1}function optionalArrayValuesMatch(o,i){return!o&&!i?!0:!o||!i?!1:arrayValuesMatch(o,i)}function isFullSegmentEncryption(o){return o==="AES-128"||o==="AES-256"||o==="AES-256-CTR"}function getAesModeFromFullSegmentMethod(o){switch(o){case"AES-128":case"AES-256":return DecrypterAesMode.cbc;case"AES-256-CTR":return DecrypterAesMode.ctr;default:throw new Error(`invalid full segment method ${o}`)}}function base64Decode(o){return Uint8Array.from(atob(o),i=>i.charCodeAt(0))}function strToUtf8array(o){return Uint8Array.from(unescape(encodeURIComponent(o)),i=>i.charCodeAt(0))}function getKeyIdBytes(o){const i=strToUtf8array(o).subarray(0,16),_=new Uint8Array(16);return _.set(i,16-i.length),_}function changeEndianness(o){const i=function($,j,_e){const et=$[j];$[j]=$[_e],$[_e]=et};i(o,0,3),i(o,1,2),i(o,4,5),i(o,6,7)}function convertDataUriToArrayBytes(o){const i=o.split(":");let _=null;if(i[0]==="data"&&i.length===2){const $=i[1].split(";"),j=$[$.length-1].split(",");if(j.length===2){const _e=j[0]==="base64",et=j[1];_e?($.splice(-1,1),_=base64Decode(et)):_=getKeyIdBytes(et)}}return _}const optionalSelf=typeof self<"u"?self:void 0;var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(o){switch(o){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}function keySystemDomainToKeySystemFormat(o){switch(o){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(o){const{drmSystems:i,widevineLicenseUrl:_}=o,$=i?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(j=>!!i[j]):[];return!$[KeySystems.WIDEVINE]&&_&&$.push(KeySystems.WIDEVINE),$}const requestMediaKeySystemAccess=function(o){return optionalSelf!=null&&(o=optionalSelf.navigator)!=null&&o.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(o,i,_,$){let j;switch(o){case KeySystems.FAIRPLAY:j=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:j=["cenc"];break;case KeySystems.CLEARKEY:j=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${o}`)}return createMediaKeySystemConfigurations(j,i,_,$)}function createMediaKeySystemConfigurations(o,i,_,$){return[{initDataTypes:o,persistentState:$.persistentState||"optional",distinctiveIdentifier:$.distinctiveIdentifier||"optional",sessionTypes:$.sessionTypes||[$.sessionType||"temporary"],audioCapabilities:i.map(_e=>({contentType:`audio/mp4; codecs=${_e}`,robustness:$.audioRobustness||"",encryptionScheme:$.audioEncryptionScheme||null})),videoCapabilities:_.map(_e=>({contentType:`video/mp4; codecs=${_e}`,robustness:$.videoRobustness||"",encryptionScheme:$.videoEncryptionScheme||null}))}]}function isPersistentSessionType(o){var i;return!!o&&(o.sessionType==="persistent-license"||!!((i=o.sessionTypes)!=null&&i.some(_=>_==="persistent-license")))}function parsePlayReadyWRM(o){const i=new Uint16Array(o.buffer,o.byteOffset,o.byteLength/2),_=String.fromCharCode.apply(null,Array.from(i)),$=_.substring(_.indexOf("<"),_.length),et=new DOMParser().parseFromString($,"text/xml").getElementsByTagName("KID")[0];if(et){const tt=et.childNodes[0]?et.childNodes[0].nodeValue:et.getAttribute("VALUE");if(tt){const rt=base64Decode(tt).subarray(0,16);return changeEndianness(rt),rt}}return null}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}static setKeyIdForUri(i,_){keyUriToKeyIdMap[i]=_}constructor(i,_,$,j=[1],_e=null,et){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=i,this.uri=_,this.keyFormat=$,this.keyFormatVersions=j,this.iv=_e,this.encrypted=i?i!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!isFullSegmentEncryption(i),et!=null&&et.startsWith("0x")&&(this.keyId=new Uint8Array(hexToArrayBuffer(et)))}matches(i){return i.uri===this.uri&&i.method===this.method&&i.encrypted===this.encrypted&&i.keyFormat===this.keyFormat&&arrayValuesMatch(i.keyFormatVersions,this.keyFormatVersions)&&optionalArrayValuesMatch(i.iv,this.iv)&&optionalArrayValuesMatch(i.keyId,this.keyId)}isSupported(){if(this.method){if(isFullSegmentEncryption(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(i){if(!this.encrypted||!this.uri)return null;if(isFullSegmentEncryption(this.method)){let j=this.iv;return j||(typeof i!="number"&&(logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),i=0),j=createInitializationVector(i)),new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,j)}if(this.pssh&&this.keyId)return this;const _=convertDataUriToArrayBytes(this.uri);if(_)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:if(this.pssh=_,!this.keyId){const j=parseMultiPssh(_.buffer);if(j.length){var $;const _e=j[0];this.keyId=($=_e.kids)!=null&&$.length?_e.kids[0]:null}}if(!this.keyId){const j=_.length-22;this.keyId=_.subarray(j,j+16)}break;case KeySystemFormats.PLAYREADY:{const j=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(j,null,_),this.keyId=parsePlayReadyWRM(_);break}default:{let j=_.subarray(0,16);if(j.length!==16){const _e=new Uint8Array(16);_e.set(j,16-j.length),j=_e}this.keyId=j;break}}if(!this.keyId||this.keyId.byteLength!==16){let j=keyUriToKeyIdMap[this.uri];if(!j){const _e=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;j=new Uint8Array(16),new DataView(j.buffer,12,4).setUint32(0,_e),LevelKey.setKeyIdForUri(this.uri,j)}this.keyId=j}return this}}function createInitializationVector(o){const i=new Uint8Array(16);for(let _=12;_<16;_++)i[_]=o>>8*(15-_)&255;return i}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(i,_){for(let $=0;$<i.length;$++){const j=i[$];if(j.id===_)return j}}static resolve(i,_){return urlToolkitExports.buildAbsoluteURL(_,i,{alwaysNormalize:!0})}static isMediaPlaylist(i){return IS_MEDIA_PLAYLIST.test(i)}static parseMasterPlaylist(i,_){const $=hasVariableReferences(i),j={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:$},_e=[];if(MASTER_PLAYLIST_REGEX.lastIndex=0,!i.startsWith("#EXTM3U"))return j.playlistParsingError=new Error("no EXTM3U delimiter"),j;let et;for(;(et=MASTER_PLAYLIST_REGEX.exec(i))!=null;)if(et[1]){var tt;const nt=new AttrList(et[1],j),it=substituteVariables(j,et[2]),st={attrs:nt,bitrate:nt.decimalInteger("BANDWIDTH")||nt.decimalInteger("AVERAGE-BANDWIDTH"),name:nt.NAME,url:M3U8Parser.resolve(it,_)},at=nt.decimalResolution("RESOLUTION");at&&(st.width=at.width,st.height=at.height),setCodecs(nt.CODECS,st);const ot=nt["SUPPLEMENTAL-CODECS"];ot&&(st.supplemental={},setCodecs(ot,st.supplemental)),(tt=st.unknownCodecs)!=null&&tt.length||_e.push(st),j.levels.push(st)}else if(et[3]){const nt=et[3],it=et[4];switch(nt){case"SESSION-DATA":{const st=new AttrList(it,j),at=st["DATA-ID"];at&&(j.sessionData===null&&(j.sessionData={}),j.sessionData[at]=st);break}case"SESSION-KEY":{const st=parseKey(it,_,j);st.encrypted&&st.isSupported()?(j.sessionKeys===null&&(j.sessionKeys=[]),j.sessionKeys.push(st)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${it}"`);break}case"DEFINE":{{const st=new AttrList(it,j);addVariableDefinition(j,st,_)}break}case"CONTENT-STEERING":{const st=new AttrList(it,j);j.contentSteering={uri:M3U8Parser.resolve(st["SERVER-URI"],_),pathwayId:st["PATHWAY-ID"]||"."};break}case"START":{j.startTimeOffset=parseStartTimeOffset(it);break}}}const rt=_e.length>0&&_e.length<j.levels.length;return j.levels=rt?_e:j.levels,j.levels.length===0&&(j.playlistParsingError=new Error("no levels found in manifest")),j}static parseMasterPlaylistMedia(i,_,$){let j;const _e={},et=$.levels,tt={AUDIO:et.map(nt=>({id:nt.attrs.AUDIO,audioCodec:nt.audioCodec})),SUBTITLES:et.map(nt=>({id:nt.attrs.SUBTITLES,textCodec:nt.textCodec})),"CLOSED-CAPTIONS":[]};let rt=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(j=MASTER_PLAYLIST_MEDIA_REGEX.exec(i))!==null;){const nt=new AttrList(j[1],$),it=nt.TYPE;if(it){const st=tt[it],at=_e[it]||[];_e[it]=at;const ot=nt.LANGUAGE,lt=nt["ASSOC-LANGUAGE"],ct=nt.CHANNELS,ft=nt.CHARACTERISTICS,ut=nt["INSTREAM-ID"],ht={attrs:nt,bitrate:0,id:rt++,groupId:nt["GROUP-ID"]||"",name:nt.NAME||ot||"",type:it,default:nt.bool("DEFAULT"),autoselect:nt.bool("AUTOSELECT"),forced:nt.bool("FORCED"),lang:ot,url:nt.URI?M3U8Parser.resolve(nt.URI,_):""};if(lt&&(ht.assocLang=lt),ct&&(ht.channels=ct),ft&&(ht.characteristics=ft),ut&&(ht.instreamId=ut),st!=null&&st.length){const dt=M3U8Parser.findGroup(st,ht.groupId)||st[0];assignCodec(ht,dt,"audioCodec"),assignCodec(ht,dt,"textCodec")}at.push(ht)}}return _e}static parseLevelPlaylist(i,_,$,j,_e,et){var tt;const rt={url:_},nt=new LevelDetails(_),it=nt.fragments,st=[];let at=null,ot=0,lt=0,ct=0,ft=0,ut=0,ht=null,dt=new Fragment(j,rt),mt,pt,yt,gt=-1,vt=!1,St=null,At;if(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,nt.m3u8=i,nt.hasVariableRefs=hasVariableReferences(i),((tt=LEVEL_PLAYLIST_REGEX_FAST.exec(i))==null?void 0:tt[0])!=="#EXTM3U")return nt.playlistParsingError=new Error("Missing format identifier #EXTM3U"),nt;for(;(mt=LEVEL_PLAYLIST_REGEX_FAST.exec(i))!==null;){vt&&(vt=!1,dt=new Fragment(j,rt),dt.playlistOffset=ct,dt.setStart(ct),dt.sn=ot,dt.cc=ft,ut&&(dt.bitrate=ut),dt.level=$,at&&(dt.initSegment=at,at.rawProgramDateTime&&(dt.rawProgramDateTime=at.rawProgramDateTime,at.rawProgramDateTime=null),St&&(dt.setByteRange(St),St=null)));const Bt=mt[1];if(Bt){dt.duration=parseFloat(Bt);const Ft=(" "+mt[2]).slice(1);dt.title=Ft||null,dt.tagList.push(Ft?["INF",Bt,Ft]:["INF",Bt])}else if(mt[3]){if(isFiniteNumber(dt.duration)){dt.playlistOffset=ct,dt.setStart(ct),yt&&setFragLevelKeys(dt,yt,nt),dt.sn=ot,dt.level=$,dt.cc=ft,it.push(dt);const Ft=(" "+mt[3]).slice(1);dt.relurl=substituteVariables(nt,Ft),assignProgramDateTime(dt,ht,st),ht=dt,ct+=dt.duration,ot++,lt=0,vt=!0}}else{if(mt=mt[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!mt){logger.warn("No matches on slow regex match for level playlist!");continue}for(pt=1;pt<mt.length&&mt[pt]===void 0;pt++);const Ft=(" "+mt[pt]).slice(1),Pt=(" "+mt[pt+1]).slice(1),Rt=mt[pt+2]?(" "+mt[pt+2]).slice(1):null;switch(Ft){case"BYTERANGE":ht?dt.setByteRange(Pt,ht):dt.setByteRange(Pt);break;case"PROGRAM-DATE-TIME":dt.rawProgramDateTime=Pt,dt.tagList.push(["PROGRAM-DATE-TIME",Pt]),gt===-1&&(gt=it.length);break;case"PLAYLIST-TYPE":nt.type&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt),nt.type=Pt.toUpperCase();break;case"MEDIA-SEQUENCE":nt.startSN!==0?assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt):it.length>0&&assignMustAppearBeforeSegmentsError(nt,Ft,mt),ot=nt.startSN=parseInt(Pt);break;case"SKIP":{nt.skippedSegments&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt);const Et=new AttrList(Pt,nt),_t=Et.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(_t)){nt.skippedSegments+=_t;for(let Dt=_t;Dt--;)it.push(null);ot+=_t}const Mt=Et.enumeratedString("RECENTLY-REMOVED-DATERANGES");Mt&&(nt.recentlyRemovedDateranges=(nt.recentlyRemovedDateranges||[]).concat(Mt.split("	")));break}case"TARGETDURATION":nt.targetduration!==0&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt),nt.targetduration=Math.max(parseInt(Pt),1);break;case"VERSION":nt.version!==null&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt),nt.version=parseInt(Pt);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":nt.live||assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt),nt.live=!1;break;case"#":(Pt||Rt)&&dt.tagList.push(Rt?[Pt,Rt]:[Pt]);break;case"DISCONTINUITY":ft++,dt.tagList.push(["DIS"]);break;case"GAP":dt.gap=!0,dt.tagList.push([Ft]);break;case"BITRATE":dt.tagList.push([Ft,Pt]),ut=parseInt(Pt)*1e3,isFiniteNumber(ut)?dt.bitrate=ut:ut=0;break;case"DATERANGE":{const Et=new AttrList(Pt,nt),_t=new DateRange(Et,nt.dateRanges[Et.ID],nt.dateRangeTagCount);nt.dateRangeTagCount++,_t.isValid||nt.skippedSegments?nt.dateRanges[_t.id]=_t:logger.warn(`Ignoring invalid DATERANGE tag: "${Pt}"`),dt.tagList.push(["EXT-X-DATERANGE",Pt]);break}case"DEFINE":{{const Et=new AttrList(Pt,nt);"IMPORT"in Et?importVariableDefinition(nt,Et,et):addVariableDefinition(nt,Et,_)}break}case"DISCONTINUITY-SEQUENCE":nt.startCC!==0?assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt):it.length>0&&assignMustAppearBeforeSegmentsError(nt,Ft,mt),nt.startCC=ft=parseInt(Pt);break;case"KEY":{const Et=parseKey(Pt,_,nt);if(Et.isSupported()){if(Et.method==="NONE"){yt=void 0;break}yt||(yt={});const _t=yt[Et.keyFormat];_t!=null&&_t.matches(Et)||(_t&&(yt=_extends({},yt)),yt[Et.keyFormat]=Et)}else logger.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${Pt}"`);break}case"START":nt.startTimeOffset=parseStartTimeOffset(Pt);break;case"MAP":{const Et=new AttrList(Pt,nt);if(dt.duration){const _t=new Fragment(j,rt);setInitSegment(_t,Et,$,yt),at=_t,dt.initSegment=at,at.rawProgramDateTime&&!dt.rawProgramDateTime&&(dt.rawProgramDateTime=at.rawProgramDateTime)}else{const _t=dt.byteRangeEndOffset;if(_t){const Mt=dt.byteRangeStartOffset;St=`${_t-Mt}@${Mt}`}else St=null;setInitSegment(dt,Et,$,yt),at=dt,vt=!0}at.cc=ft;break}case"SERVER-CONTROL":{At&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt),At=new AttrList(Pt),nt.canBlockReload=At.bool("CAN-BLOCK-RELOAD"),nt.canSkipUntil=At.optionalFloat("CAN-SKIP-UNTIL",0),nt.canSkipDateRanges=nt.canSkipUntil>0&&At.bool("CAN-SKIP-DATERANGES"),nt.partHoldBack=At.optionalFloat("PART-HOLD-BACK",0),nt.holdBack=At.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{nt.partTarget&&assignMultipleMediaPlaylistTagOccuranceError(nt,Ft,mt);const Et=new AttrList(Pt);nt.partTarget=Et.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Et=nt.partList;Et||(Et=nt.partList=[]);const _t=lt>0?Et[Et.length-1]:void 0,Mt=lt++,Dt=new AttrList(Pt,nt),Lt=new Part(Dt,dt,rt,Mt,_t);Et.push(Lt),dt.duration+=Lt.duration;break}case"PRELOAD-HINT":{const Et=new AttrList(Pt,nt);nt.preloadHint=Et;break}case"RENDITION-REPORT":{const Et=new AttrList(Pt,nt);nt.renditionReports=nt.renditionReports||[],nt.renditionReports.push(Et);break}default:logger.warn(`line parsed but not handled: ${mt}`);break}}}ht&&!ht.relurl?(it.pop(),ct-=ht.duration,nt.partList&&(nt.fragmentHint=ht)):nt.partList&&(assignProgramDateTime(dt,ht,st),dt.cc=ft,nt.fragmentHint=dt,yt&&setFragLevelKeys(dt,yt,nt)),nt.targetduration||(nt.playlistParsingError=new Error("Missing Target Duration"));const xt=it.length,wt=it[0],Ot=it[xt-1];if(ct+=nt.skippedSegments*nt.targetduration,ct>0&&xt&&Ot){nt.averagetargetduration=ct/xt;const Bt=Ot.sn;nt.endSN=Bt!=="initSegment"?Bt:0,nt.live||(Ot.endList=!0),gt>0&&(backfillProgramDateTimes(it,gt),wt&&st.unshift(wt))}return nt.fragmentHint&&(ct+=nt.fragmentHint.duration),nt.totalduration=ct,st.length&&nt.dateRangeTagCount&&wt&&mapDateRanges(st,nt),nt.endCC=ft,nt}}function mapDateRanges(o,i){let _=o.length;if(!_)if(i.hasProgramDateTime){const tt=i.fragments[i.fragments.length-1];o.push(tt),_++}else return;const $=o[_-1],j=i.live?1/0:i.totalduration,_e=Object.keys(i.dateRanges);for(let tt=_e.length;tt--;){const rt=i.dateRanges[_e[tt]],nt=rt.startDate.getTime();rt.tagAnchor=$.ref;for(let it=_;it--;){var et;if(((et=o[it])==null?void 0:et.sn)<i.startSN)break;const st=findFragmentWithStartDate(i,nt,o,it,j);if(st!==-1){rt.tagAnchor=i.fragments[st].ref;break}}}}function findFragmentWithStartDate(o,i,_,$,j){const _e=_[$];if(_e){const tt=_e.programDateTime;if(i>=tt||$===0){var et;const rt=(((et=_[$+1])==null?void 0:et.start)||j)-_e.start;if(i<=tt+rt*1e3){const nt=_[$].sn-o.startSN;if(nt<0)return-1;const it=o.fragments;if(it.length>_.length){const at=(_[$+1]||it[it.length-1]).sn-o.startSN;for(let ot=at;ot>nt;ot--){const lt=it[ot].programDateTime;if(i>=lt&&i<lt+it[ot].duration*1e3)return ot}}return nt}}}return-1}function parseKey(o,i,_){var $,j;const _e=new AttrList(o,_),et=($=_e.METHOD)!=null?$:"",tt=_e.URI,rt=_e.hexadecimalInteger("IV"),nt=_e.KEYFORMATVERSIONS,it=(j=_e.KEYFORMAT)!=null?j:"identity";tt&&_e.IV&&!rt&&logger.error(`Invalid IV: ${_e.IV}`);const st=tt?M3U8Parser.resolve(tt,i):"",at=(nt||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(et,st,it,at,rt,_e.KEYID)}function parseStartTimeOffset(o){const _=new AttrList(o).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(_)?_:null}function setCodecs(o,i){let _=(o||"").split(/[ ,]+/).filter($=>$);["video","audio","text"].forEach($=>{const j=_.filter(_e=>isCodecType(_e,$));j.length&&(i[`${$}Codec`]=j.map(_e=>_e.split("/")[0]).join(","),_=_.filter(_e=>j.indexOf(_e)===-1))}),i.unknownCodecs=_}function assignCodec(o,i,_){const $=i[_];$&&(o[_]=$)}function backfillProgramDateTimes(o,i){let _=o[i];for(let $=i;$--;){const j=o[$];if(!j)return;j.programDateTime=_.programDateTime-j.duration*1e3,_=j}}function assignProgramDateTime(o,i,_){o.rawProgramDateTime?_.push(o):i!=null&&i.programDateTime&&(o.programDateTime=i.endProgramDateTime)}function setInitSegment(o,i,_,$){o.relurl=i.URI,i.BYTERANGE&&o.setByteRange(i.BYTERANGE),o.level=_,o.sn="initSegment",$&&(o.levelkeys=$),o.initSegment=null}function setFragLevelKeys(o,i,_){o.levelkeys=i;const{encryptedFragments:$}=_;(!$.length||$[$.length-1].levelkeys!==i)&&Object.keys(i).some(j=>i[j].isCommonEncryption)&&$.push(o)}function assignMultipleMediaPlaylistTagOccuranceError(o,i,_){o.playlistParsingError=new Error(`#EXT-X-${i} must not appear more than once (${_[0]})`)}function assignMustAppearBeforeSegmentsError(o,i,_){o.playlistParsingError=new Error(`#EXT-X-${i} must appear before the first Media Segment (${_[0]})`)}function updateFromToPTS(o,i){const _=i.startPTS;if(isFiniteNumber(_)){let $=0,j;i.sn>o.sn?($=_-o.start,j=o):($=o.start-_,j=i),j.duration!==$&&j.setDuration($)}else i.sn>o.sn?o.cc===i.cc&&o.minEndPTS?i.setStart(o.start+(o.minEndPTS-o.start)):i.setStart(o.start+o.duration):i.setStart(Math.max(o.start-i.duration,0))}function updateFragPTSDTS(o,i,_,$,j,_e,et){$-_<=0&&(et.warn("Fragment should have a positive duration",i),$=_+i.duration,_e=j+i.duration);let rt=_,nt=$;const it=i.startPTS,st=i.endPTS;if(isFiniteNumber(it)){const ut=Math.abs(it-_);o&&ut>o.totalduration?et.warn(`media timestamps and playlist times differ by ${ut}s for level ${i.level} ${o.url}`):isFiniteNumber(i.deltaPTS)?i.deltaPTS=Math.max(ut,i.deltaPTS):i.deltaPTS=ut,rt=Math.max(_,it),_=Math.min(_,it),j=i.startDTS!==void 0?Math.min(j,i.startDTS):j,nt=Math.min($,st),$=Math.max($,st),_e=i.endDTS!==void 0?Math.max(_e,i.endDTS):_e}const at=_-i.start;i.start!==0&&i.setStart(_),i.setDuration($-i.start),i.startPTS=_,i.maxStartPTS=rt,i.startDTS=j,i.endPTS=$,i.minEndPTS=nt,i.endDTS=_e;const ot=i.sn;if(!o||ot<o.startSN||ot>o.endSN)return 0;let lt;const ct=ot-o.startSN,ft=o.fragments;for(ft[ct]=i,lt=ct;lt>0;lt--)updateFromToPTS(ft[lt],ft[lt-1]);for(lt=ct;lt<ft.length-1;lt++)updateFromToPTS(ft[lt],ft[lt+1]);return o.fragmentHint&&updateFromToPTS(ft[ft.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,at}function mergeDetails(o,i,_){if(o===i)return;let $=null;const j=o.fragments;for(let it=j.length-1;it>=0;it--){const st=j[it].initSegment;if(st){$=st;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;let _e;mapFragmentIntersection(o,i,(it,st,at,ot)=>{if((!i.startCC||i.skippedSegments)&&st.cc!==it.cc){const lt=it.cc-st.cc;for(let ct=at;ct<ot.length;ct++)ot[ct].cc+=lt;i.endCC=ot[ot.length-1].cc}isFiniteNumber(it.startPTS)&&isFiniteNumber(it.endPTS)&&(st.setStart(st.startPTS=it.startPTS),st.startDTS=it.startDTS,st.maxStartPTS=it.maxStartPTS,st.endPTS=it.endPTS,st.endDTS=it.endDTS,st.minEndPTS=it.minEndPTS,st.setDuration(it.endPTS-it.startPTS),st.duration&&(_e=st),i.PTSKnown=i.alignedSliding=!0),it.hasStreams&&(st.elementaryStreams=it.elementaryStreams),st.loader=it.loader,it.hasStats&&(st.stats=it.stats),it.initSegment&&(st.initSegment=it.initSegment,$=it.initSegment)});const et=i.fragments,tt=i.fragmentHint?et.concat(i.fragmentHint):et;if($&&tt.forEach(it=>{var st;it&&(!it.initSegment||it.initSegment.relurl===((st=$)==null?void 0:st.relurl))&&(it.initSegment=$)}),i.skippedSegments){if(i.deltaUpdateFailed=et.some(it=>!it),i.deltaUpdateFailed){_.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let it=i.skippedSegments;it--;)et.shift();i.startSN=et[0].sn}else{i.canSkipDateRanges&&(i.dateRanges=mergeDateRanges(o.dateRanges,i,_));const it=o.fragments.filter(st=>st.rawProgramDateTime);if(o.hasProgramDateTime&&!i.hasProgramDateTime)for(let st=1;st<tt.length;st++)tt[st].programDateTime===null&&assignProgramDateTime(tt[st],tt[st-1],it);mapDateRanges(it,i)}i.endCC=et[et.length-1].cc}if(!i.startCC){var rt;const it=getFragmentWithSN(o,i.startSN-1);i.startCC=(rt=it==null?void 0:it.cc)!=null?rt:et[0].cc}mapPartIntersection(o.partList,i.partList,(it,st)=>{st.elementaryStreams=it.elementaryStreams,st.stats=it.stats}),_e?updateFragPTSDTS(i,_e,_e.startPTS,_e.endPTS,_e.startDTS,_e.endDTS,_):adjustSliding(o,i),et.length&&(i.totalduration=i.edge-et[0].start),i.driftStartTime=o.driftStartTime,i.driftStart=o.driftStart;const nt=i.advancedDateTime;if(i.advanced&&nt){const it=i.edge;i.driftStart||(i.driftStartTime=nt,i.driftStart=it),i.driftEndTime=nt,i.driftEnd=it}else i.driftEndTime=o.driftEndTime,i.driftEnd=o.driftEnd,i.advancedDateTime=o.advancedDateTime;i.requestScheduled===-1&&(i.requestScheduled=o.requestScheduled)}function mergeDateRanges(o,i,_){const{dateRanges:$,recentlyRemovedDateranges:j}=i,_e=_extends({},o);j&&j.forEach(rt=>{delete _e[rt]});const tt=Object.keys(_e).length;return tt?(Object.keys($).forEach(rt=>{const nt=_e[rt],it=new DateRange($[rt].attr,nt);it.isValid?(_e[rt]=it,nt||(it.tagOrder+=tt)):_.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${stringify($[rt].attr)}"`)}),_e):$}function mapPartIntersection(o,i,_){if(o&&i){let $=0;for(let j=0,_e=o.length;j<=_e;j++){const et=o[j],tt=i[j+$];et&&tt&&et.index===tt.index&&et.fragment.sn===tt.fragment.sn?_(et,tt):$--}}}function mapFragmentIntersection(o,i,_){const $=i.skippedSegments,j=Math.max(o.startSN,i.startSN)-i.startSN,_e=(o.fragmentHint?1:0)+($?i.endSN:Math.min(o.endSN,i.endSN))-i.startSN,et=i.startSN-o.startSN,tt=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,rt=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments;for(let nt=j;nt<=_e;nt++){const it=rt[et+nt];let st=tt[nt];if($&&!st&&it&&(st=i.fragments[nt]=it),it&&st){_(it,st,nt,tt);const at=it.relurl,ot=st.relurl;if(at&&notEqualAfterStrippingQueries(at,ot)){i.playlistParsingError=getSequenceError(`media sequence mismatch ${st.sn}:`,o,i,it,st);return}else if(it.cc!==st.cc){i.playlistParsingError=getSequenceError(`discontinuity sequence mismatch (${it.cc}!=${st.cc})`,o,i,it,st);return}}}}function getSequenceError(o,i,_,$,j){return new Error(`${o} ${j.url}
Playlist starting @${i.startSN}
${i.m3u8}

Playlist starting @${_.startSN}
${_.m3u8}`)}function adjustSliding(o,i,_=!0){const $=i.startSN+i.skippedSegments-o.startSN,j=o.fragments,_e=$>=0;let et=0;if(_e&&$<j.length)et=j[$].start;else if(_e&&i.startSN===o.endSN+1)et=o.fragmentEnd;else if(_e&&_)et=o.fragmentStart+$*i.levelTargetDuration;else if(!i.skippedSegments&&i.fragmentStart===0)et=o.fragmentStart;else return;addSliding(i,et)}function addSliding(o,i){if(i){const _=o.fragments;for(let $=o.skippedSegments;$<_.length;$++)_[$].addStart(i);o.fragmentHint&&o.fragmentHint.addStart(i)}}function computeReloadInterval(o,i=1/0){let _=1e3*o.targetduration;if(o.updated){const $=o.fragments;if($.length&&_*4>i){const _e=$[$.length-1].duration*1e3;_e<_&&(_=_e)}}else _/=2;return Math.round(_)}function getFragmentWithSN(o,i,_){if(!o)return null;let $=o.fragments[i-o.startSN];return $||($=o.fragmentHint,$&&$.sn===i)?$:i<o.startSN&&_&&_.sn===i?_:null}function getPartWith(o,i,_){return o?findPart(o.partList,i,_):null}function findPart(o,i,_){if(o)for(let $=o.length;$--;){const j=o[$];if(j.index===_&&j.fragment.sn===i)return j}return null}function reassignFragmentLevelIndexes(o){o.forEach((i,_)=>{var $;($=i.details)==null||$.fragments.forEach(j=>{j.level=_,j.initSegment&&(j.initSegment.level=_)})})}function notEqualAfterStrippingQueries(o,i){return o!==i&&i?stripQuery(o)!==stripQuery(i):!1}function stripQuery(o){return o.replace(/\?[^?]*$/,"")}function findFirstFragWithCC(o,i){for(let $=0,j=o.length;$<j;$++){var _;if(((_=o[$])==null?void 0:_.cc)===i)return o[$]}return null}function shouldAlignOnDiscontinuities(o,i){return!!(o&&i.startCC<o.endCC&&i.endCC>o.startCC)}function adjustFragmentStart(o,i){const _=o.start+i;o.startPTS=_,o.setStart(_),o.endPTS=_+o.duration}function adjustSlidingStart(o,i){const _=i.fragments;for(let $=0,j=_.length;$<j;$++)adjustFragmentStart(_[$],o);i.fragmentHint&&adjustFragmentStart(i.fragmentHint,o),i.alignedSliding=!0}function alignStream(o,i){o&&(alignDiscontinuities(i,o),i.alignedSliding||alignMediaPlaylistByPDT(i,o),!i.alignedSliding&&!i.skippedSegments&&adjustSliding(o,i,!1))}function alignDiscontinuities(o,i){if(!shouldAlignOnDiscontinuities(i,o))return;const _=Math.min(i.endCC,o.endCC),$=findFirstFragWithCC(i.fragments,_),j=findFirstFragWithCC(o.fragments,_);if(!$||!j)return;logger.log(`Aligning playlist at start of dicontinuity sequence ${_}`);const _e=$.start-j.start;adjustSlidingStart(_e,o)}function alignMediaPlaylistByPDT(o,i){if(!o.hasProgramDateTime||!i.hasProgramDateTime)return;const _=o.fragments,$=i.fragments;if(!_.length||!$.length)return;let j,_e;const et=Math.min(i.endCC,o.endCC);i.startCC<et&&o.startCC<et&&(j=findFirstFragWithCC($,et),_e=findFirstFragWithCC(_,et)),(!j||!_e)&&(j=$[Math.floor($.length/2)],_e=findFirstFragWithCC(_,j.cc)||_[Math.floor(_.length/2)]);const tt=j.programDateTime,rt=_e.programDateTime;if(!tt||!rt)return;const nt=(rt-tt)/1e3-(_e.start-j.start);adjustSlidingStart(nt,o)}function addEventListener$1(o,i,_){removeEventListener(o,i,_),o.addEventListener(i,_)}function removeEventListener(o,i,_){o.removeEventListener(i,_)}const TimeRanges={toString:function(o){let i="";const _=o.length;for(let $=0;$<_;$++)i+=`[${o.start($).toFixed(3)}-${o.end($).toFixed(3)}]`;return i}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(i,_,$,j,_e){super(j,i.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:et,fragCurrent:tt,media:rt,mediaBuffer:nt,state:it}=this,st=rt?rt.currentTime:0,at=BufferHelper.bufferInfo(nt||rt,st,et.maxBufferHole),ot=!at.len;if(this.log(`Media seeking to ${isFiniteNumber(st)?st.toFixed(3):st}, state: ${it}, ${ot?"out of":"in"} buffer`),this.state===State.ENDED)this.resetLoadingState();else if(tt){const lt=et.maxFragLookUpTolerance,ct=tt.start-lt,ft=tt.start+tt.duration+lt;if(ot||ft<at.start||ct>at.end){const ut=st>ft;(st<ct||ut)&&(ut&&tt.loader&&(this.log(`Cancelling fragment load for seek (sn: ${tt.sn})`),tt.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(rt){this.fragmentTracker.removeFragmentsInRange(st,1/0,this.playlistType,!0);const lt=this.lastCurrentTime;if(st>lt&&(this.lastCurrentTime=st),!this.loadingParts){const ct=Math.max(at.end,st),ft=this.shouldLoadParts(this.getLevelDetails(),ct);ft&&(this.log(`LL-Part loading ON after seeking to ${st.toFixed(2)} with buffer @${ct.toFixed(2)}`),this.loadingParts=ft)}}this.hls.hasEnoughToStart||(this.log(`Setting ${ot?"startPosition":"nextLoadPosition"} to ${st} for seek without enough to start`),this.nextLoadPosition=st,ot&&(this.startPosition=st)),ot&&this.state===State.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=_e,this.hls=i,this.fragmentLoader=new FragmentLoader(i.config),this.keyLoader=$,this.fragmentTracker=_,this.config=i.config,this.decrypter=new Decrypter(i.config)}registerListeners(){const{hls:i}=this;i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:i}=this;i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(Events.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(i){}stopLoad(){if(this.state===State.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const i=this.fragCurrent;i!=null&&i.loader&&(i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}get startPositionValue(){const{nextLoadPosition:i,startPosition:_}=this;return _===-1&&i?i:_}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(i,_){if(_.live||!this.media)return!1;const $=i.end||0,j=this.config.timelineOffset||0;if($<=j)return!1;const _e=i.buffered;this.config.maxBufferHole&&_e&&_e.length>1&&(i=BufferHelper.bufferedInfo(_e,i.start,0));const et=i.nextStart;if(et&&et>j&&et<_.edge||this.media.currentTime<i.start)return!1;const rt=_.partList;if(rt!=null&&rt.length){const it=rt[rt.length-1];return BufferHelper.isBuffered(this.media,it.start+it.duration/2)}const nt=_.fragments[_.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(nt)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const i=this.config.timelineOffset;if(i){var _;return((_=this.getLevelDetails())==null?void 0:_.appliedTimelineOffset)||i}return 0}onMediaAttached(i,_){const $=this.media=this.mediaBuffer=_.media;addEventListener$1($,"seeking",this.onMediaSeeking),addEventListener$1($,"ended",this.onMediaEnded);const j=this.config;this.levels&&j.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(j.startPosition)}onMediaDetaching(i,_){const $=!!_.transferMedia,j=this.media;if(j!==null){if(j.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),removeEventListener(j,"seeking",this.onMediaSeeking),removeEventListener(j,"ended",this.onMediaEnded),this.keyLoader&&!$&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,$){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(i,_){}onManifestLoaded(i,_){this.startTimeOffset=_.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(i,_,$){this.startFragRequested=!0,this._loadFragForPlayback(i,_,$)}_loadFragForPlayback(i,_,$){const j=_e=>{const et=_e.frag;if(this.fragContextChanged(et)){this.warn(`${et.type} sn: ${et.sn}${_e.part?" part: "+_e.part.index:""} of ${this.fragInfo(et,!1,_e.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(et);return}et.stats.chunkCount++,this._handleFragmentLoadProgress(_e)};this._doFragLoad(i,_,$,j).then(_e=>{if(!_e)return;const et=this.state,tt=_e.frag;if(this.fragContextChanged(tt)){(et===State.FRAG_LOADING||!this.fragCurrent&&et===State.PARSING)&&(this.fragmentTracker.removeFragment(tt),this.state=State.IDLE);return}"payload"in _e&&(this.log(`Loaded ${tt.type} sn: ${tt.sn} of ${this.playlistLabel()} ${tt.level}`),this.hls.trigger(Events.FRAG_LOADED,_e)),this._handleFragmentLoadComplete(_e)}).catch(_e=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(`Frag error: ${(_e==null?void 0:_e.message)||_e}`),this.resetFragmentLoading(i))})}clearTrackerIfNeeded(i){var _;const{fragmentTracker:$}=this;if($.getState(i)===FragmentState.APPENDING){const _e=i.type,et=this.getFwdBufferInfo(this.mediaBuffer,_e),tt=Math.max(i.duration,et?et.len:this.config.maxBufferLength),rt=this.backtrackFragment;((rt?i.sn-rt.sn:0)===1||this.reduceMaxBufferLength(tt,i.duration))&&$.removeFragment(i)}else((_=this.mediaBuffer)==null?void 0:_.buffered.length)===0?$.removeAllFragments():$.hasParts(i.type)&&($.detectPartialFragments({frag:i,part:null,stats:i.stats,id:i.type}),$.getState(i)===FragmentState.PARTIAL&&$.removeFragment(i))}checkLiveUpdate(i){if(i.updated&&!i.live){const _=i.fragments[i.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:_,part:null,stats:_.stats,id:_.type})}i.fragments[0]||(i.deltaUpdateFailed=!0)}waitForLive(i){const _=i.details;return(_==null?void 0:_.live)&&_.type!=="EVENT"&&(this.levelLastLoaded!==i||_.expired)}flushMainBuffer(i,_,$=null){if(!(i-_))return;const j={startOffset:i,endOffset:_,type:$};this.hls.trigger(Events.BUFFER_FLUSHING,j)}_loadInitSegment(i,_){this._doFragLoad(i,_).then($=>{const j=$==null?void 0:$.frag;if(!j||this.fragContextChanged(j)||!this.levels)throw new Error("init load aborted");return $}).then($=>{const{hls:j}=this,{frag:_e,payload:et}=$,tt=_e.decryptdata;if(et&&et.byteLength>0&&tt!=null&&tt.key&&tt.iv&&isFullSegmentEncryption(tt.method)){const rt=self.performance.now();return this.decrypter.decrypt(new Uint8Array(et),tt.key.buffer,tt.iv.buffer,getAesModeFromFullSegmentMethod(tt.method)).catch(nt=>{throw j.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:nt,reason:nt.message,frag:_e}),nt}).then(nt=>{const it=self.performance.now();return j.trigger(Events.FRAG_DECRYPTED,{frag:_e,payload:nt,stats:{tstart:rt,tdecrypt:it}}),$.payload=nt,this.completeInitSegmentLoad($)})}return this.completeInitSegmentLoad($)}).catch($=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn($),this.resetFragmentLoading(i))})}completeInitSegmentLoad(i){const{levels:_}=this;if(!_)throw new Error("init load aborted, missing levels");const $=i.frag.stats;this.state!==State.STOPPED&&(this.state=State.IDLE),i.frag.data=new Uint8Array(i.payload),$.parsing.start=$.buffering.start=self.performance.now(),$.parsing.end=$.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(i,_){var $,j;const _e=i.tracks;if(_e&&!_.encrypted&&(($=_e.audio)!=null&&$.encrypted||(j=_e.video)!=null&&j.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const et=this.media,tt=new Error(`Encrypted track with no key in ${this.fragInfo(_)} (media ${et?"attached mediaKeys: "+et.mediaKeys:"detached"})`);return this.warn(tt.message),!et||et.mediaKeys?!1:(this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!1,error:tt,frag:_}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(i){const{fragCurrent:_}=this;return!i||!_||i.sn!==_.sn||i.level!==_.level}fragBufferedComplete(i,_){const $=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${i.type} sn: ${i.sn}${_?" part: "+_.index:""} of ${this.fragInfo(i,!1,_)} > buffer:${$?TimeRanges.toString(BufferHelper.getBuffered($)):"(detached)"})`),isMediaFragment(i)){var j;if(i.type!==PlaylistLevelType.SUBTITLE){const et=i.elementaryStreams;if(!Object.keys(et).some(tt=>!!et[tt])){this.state=State.IDLE;return}}const _e=(j=this.levels)==null?void 0:j[i.level];_e!=null&&_e.fragmentError&&(this.log(`Resetting level fragment error count of ${_e.fragmentError} on frag buffered`),_e.fragmentError=0)}this.state=State.IDLE}_handleFragmentLoadComplete(i){const{transmuxer:_}=this;if(!_)return;const{frag:$,part:j,partsLoaded:_e}=i,et=!_e||_e.length===0||_e.some(rt=>!rt),tt=new ChunkMetadata($.level,$.sn,$.stats.chunkCount+1,0,j?j.index:-1,!et);_.flush(tt)}_handleFragmentLoadProgress(i){}_doFragLoad(i,_,$=null,j){var _e;this.fragCurrent=i;const et=_.details;if(!this.levels||!et)throw new Error(`frag load aborted, missing level${et?"":" detail"}s`);let tt=null;if(i.encrypted&&!((_e=i.decryptdata)!=null&&_e.key)){if(this.log(`Loading key for ${i.sn} of [${et.startSN}-${et.endSN}], ${this.playlistLabel()} ${i.level}`),this.state=State.KEY_LOADING,this.fragCurrent=i,tt=this.keyLoader.load(i).then(at=>{if(!this.fragContextChanged(at.frag))return this.hls.trigger(Events.KEY_LOADED,at),this.state===State.KEY_LOADING&&(this.state=State.IDLE),at}),this.hls.trigger(Events.KEY_LOADING,{frag:i}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else i.encrypted||(tt=this.keyLoader.loadClear(i,et.encryptedFragments,this.startFragRequested),tt&&this.log("[eme] blocking frag load until media-keys acquired"));const rt=this.fragPrevious;if(isMediaFragment(i)&&(!rt||i.sn!==rt.sn)){const at=this.shouldLoadParts(_.details,i.end);at!==this.loadingParts&&(this.log(`LL-Part loading ${at?"ON":"OFF"} loading sn ${rt==null?void 0:rt.sn}->${i.sn}`),this.loadingParts=at)}if($=Math.max(i.start,$||0),this.loadingParts&&isMediaFragment(i)){const at=et.partList;if(at&&j){$>et.fragmentEnd&&et.fragmentHint&&(i=et.fragmentHint);const ot=this.getNextPart(at,i,$);if(ot>-1){const lt=at[ot];i=this.fragCurrent=lt.fragment,this.log(`Loading ${i.type} sn: ${i.sn} part: ${lt.index} (${ot}/${at.length-1}) of ${this.fragInfo(i,!1,lt)}) cc: ${i.cc} [${et.startSN}-${et.endSN}], target: ${parseFloat($.toFixed(3))}`),this.nextLoadPosition=lt.start+lt.duration,this.state=State.FRAG_LOADING;let ct;return tt?ct=tt.then(ft=>!ft||this.fragContextChanged(ft.frag)?null:this.doFragPartsLoad(i,lt,_,j)).catch(ft=>this.handleFragLoadError(ft)):ct=this.doFragPartsLoad(i,lt,_,j).catch(ft=>this.handleFragLoadError(ft)),this.hls.trigger(Events.FRAG_LOADING,{frag:i,part:lt,targetBufferTime:$}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):ct}else if(!i.url||this.loadedEndOfParts(at,$))return Promise.resolve(null)}}if(isMediaFragment(i)&&this.loadingParts){var nt;this.log(`LL-Part loading OFF after next part miss @${$.toFixed(2)} Check buffer at sn: ${i.sn} loaded parts: ${(nt=et.partList)==null?void 0:nt.filter(at=>at.loaded).map(at=>`[${at.start}-${at.end}]`)}`),this.loadingParts=!1}else if(!i.url)return Promise.resolve(null);this.log(`Loading ${i.type} sn: ${i.sn} of ${this.fragInfo(i,!1)}) cc: ${i.cc} ${"["+et.startSN+"-"+et.endSN+"]"}, target: ${parseFloat($.toFixed(3))}`),isFiniteNumber(i.sn)&&!this.bitrateTest&&(this.nextLoadPosition=i.start+i.duration),this.state=State.FRAG_LOADING;const it=this.config.progressive;let st;return it&&tt?st=tt.then(at=>!at||this.fragContextChanged(at.frag)?null:this.fragmentLoader.load(i,j)).catch(at=>this.handleFragLoadError(at)):st=Promise.all([this.fragmentLoader.load(i,it?j:void 0),tt]).then(([at])=>(!it&&j&&j(at),at)).catch(at=>this.handleFragLoadError(at)),this.hls.trigger(Events.FRAG_LOADING,{frag:i,targetBufferTime:$}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):st}doFragPartsLoad(i,_,$,j){return new Promise((_e,et)=>{var tt;const rt=[],nt=(tt=$.details)==null?void 0:tt.partList,it=st=>{this.fragmentLoader.loadPart(i,st,j).then(at=>{rt[st.index]=at;const ot=at.part;this.hls.trigger(Events.FRAG_LOADED,at);const lt=getPartWith($.details,i.sn,st.index+1)||findPart(nt,i.sn,st.index+1);if(lt)it(lt);else return _e({frag:i,part:ot,partsLoaded:rt})}).catch(et)};it(_)})}handleFragLoadError(i){if("data"in i){const _=i.data;_.frag&&_.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(_.frag,_.part):_.frag&&_.type===ErrorTypes.KEY_SYSTEM_ERROR?(_.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(_.frag)):this.hls.trigger(Events.ERROR,_)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:i,error:i,fatal:!0});return null}_handleTransmuxerFlush(i){const _=this.getCurrentContext(i);if(!_||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:$,part:j,level:_e}=_,et=self.performance.now();$.stats.parsing.end=et,j&&(j.stats.parsing.end=et);const tt=this.getLevelDetails(),nt=tt&&$.sn>tt.endSN||this.shouldLoadParts(tt,$.end);nt!==this.loadingParts&&(this.log(`LL-Part loading ${nt?"ON":"OFF"} after parsing segment ending @${$.end.toFixed(2)}`),this.loadingParts=nt),this.updateLevelTiming($,j,_e,i.partial)}shouldLoadParts(i,_){if(this.config.lowLatencyMode){if(!i)return this.loadingParts;if(i.partList){var $;const _e=i.partList[0];if(_e.fragment.type===PlaylistLevelType.SUBTITLE)return!1;const et=_e.end+((($=i.fragmentHint)==null?void 0:$.duration)||0);if(_>=et){var j;if((this.hls.hasEnoughToStart?((j=this.media)==null?void 0:j.currentTime)||this.lastCurrentTime:this.getLoadPosition())>_e.start-_e.fragment.duration)return!0}}}return!1}getCurrentContext(i){const{levels:_,fragCurrent:$}=this,{level:j,sn:_e,part:et}=i;if(!(_!=null&&_[j]))return this.warn(`Levels object was unset while buffering fragment ${_e} of ${this.playlistLabel()} ${j}. The current chunk will not be buffered.`),null;const tt=_[j],rt=tt.details,nt=et>-1?getPartWith(rt,_e,et):null,it=nt?nt.fragment:getFragmentWithSN(rt,_e,$);return it?($&&$!==it&&(it.stats=$.stats),{frag:it,part:nt,level:tt}):null}bufferFragmentData(i,_,$,j,_e){if(this.state!==State.PARSING)return;const{data1:et,data2:tt}=i;let rt=et;if(tt&&(rt=appendUint8Array(et,tt)),!rt.length)return;const nt=this.initPTS[_.cc],it=nt?-nt.baseTime/nt.timescale:void 0,st={type:i.type,frag:_,part:$,chunkMeta:j,offset:it,parent:_.type,data:rt};if(this.hls.trigger(Events.BUFFER_APPENDING,st),i.dropped&&i.independent&&!$){if(_e)return;this.flushBufferGap(_)}}flushBufferGap(i){const _=this.media;if(!_)return;if(!BufferHelper.isBuffered(_,_.currentTime)){this.flushMainBuffer(0,i.start);return}const $=_.currentTime,j=BufferHelper.bufferInfo(_,$,0),_e=i.duration,et=Math.min(this.config.maxFragLookUpTolerance*2,_e*.25),tt=Math.max(Math.min(i.start-et,j.end-et),$+et);i.start-tt>et&&this.flushMainBuffer(tt,i.start)}getFwdBufferInfo(i,_){var $;const j=this.getLoadPosition();if(!isFiniteNumber(j))return null;const et=this.lastCurrentTime>j||($=this.media)!=null&&$.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(i,j,_,et)}getFwdBufferInfoAtPos(i,_,$,j){const _e=BufferHelper.bufferInfo(i,_,j);if(_e.len===0&&_e.nextStart!==void 0){const et=this.fragmentTracker.getBufferedFrag(_,$);if(et&&(_e.nextStart<=et.end||et.gap)){const tt=Math.max(Math.min(_e.nextStart,et.end)-_,j);return BufferHelper.bufferInfo(i,_,tt)}}return _e}getMaxBufferLength(i){const{config:_}=this;let $;return i?$=Math.max(8*_.maxBufferSize/i,_.maxBufferLength):$=_.maxBufferLength,Math.min($,_.maxMaxBufferLength)}reduceMaxBufferLength(i,_){const $=this.config,j=Math.max(Math.min(i-_,$.maxBufferLength),_),_e=Math.max(i-_*3,$.maxMaxBufferLength/2,j);return _e>=j?($.maxMaxBufferLength=_e,this.warn(`Reduce max buffer length to ${_e}s`),!0):!1}getAppendedFrag(i,_=PlaylistLevelType.MAIN){const $=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(i,_):null;return $&&"fragment"in $?$.fragment:$}getNextFragment(i,_){const $=_.fragments,j=$.length;if(!j)return null;const{config:_e}=this,et=$[0].start,tt=_e.lowLatencyMode&&!!_.partList;let rt=null;if(_.live){const st=_e.initialLiveManifestSize;if(j<st)return this.warn(`Not enough fragments to start playback (have: ${j}, need: ${st})`),null;if(!_.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||i<et){var nt;tt&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),rt=this.getInitialLiveFragment(_);const at=this.hls.startPosition,ot=this.hls.liveSyncPosition,lt=rt?(at!==-1&&at>=et?at:ot)||rt.start:i;this.log(`Setting startPosition to ${lt} to match start frag at live edge. mainStart: ${at} liveSyncPosition: ${ot} frag.start: ${(nt=rt)==null?void 0:nt.start}`),this.startPosition=this.nextLoadPosition=lt}}else i<=et&&(rt=$[0]);if(!rt){const st=this.loadingParts?_.partEnd:_.fragmentEnd;rt=this.getFragmentAtPosition(i,st,_)}let it=this.filterReplacedPrimary(rt,_);if(!it&&rt){const st=rt.sn-_.startSN;it=this.filterReplacedPrimary($[st+1]||null,_)}return this.mapToInitFragWhenRequired(it)}isLoopLoading(i,_){const $=this.fragmentTracker.getState(i);return($===FragmentState.OK||$===FragmentState.PARTIAL&&!!i.gap)&&this.nextLoadPosition>_}getNextFragmentLoopLoading(i,_,$,j,_e){let et=null;if(i.gap&&(et=this.getNextFragment(this.nextLoadPosition,_),et&&!et.gap&&$.nextStart)){const tt=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,$.nextStart,j,0);if(tt!==null&&$.len+tt.len>=_e){const rt=et.sn;return this.loopSn!==rt&&(this.log(`buffer full after gaps in "${j}" playlist starting at sn: ${rt}`),this.loopSn=rt),null}}return this.loopSn=void 0,et}get primaryPrefetch(){if(interstitialsEnabled(this.config)){var i;if((i=this.hls.interstitialsManager)==null||(i=i.playingItem)==null?void 0:i.event)return!0}return!1}filterReplacedPrimary(i,_){if(!i)return i;if(interstitialsEnabled(this.config)&&i.type!==PlaylistLevelType.SUBTITLE){const $=this.hls.interstitialsManager,j=$==null?void 0:$.bufferingItem;if(j){const et=j.event;if(et){if(et.appendInPlace||Math.abs(i.start-j.start)>1||j.start===0)return null}else if(i.end<=j.start&&(_==null?void 0:_.live)===!1||i.start>j.end&&j.nextEvent&&(j.nextEvent.appendInPlace||i.start-j.end>1))return null}const _e=$==null?void 0:$.playerQueue;if(_e)for(let et=_e.length;et--;){const tt=_e[et].interstitial;if(tt.appendInPlace&&i.start>=tt.startTime&&i.end<=tt.resumeTime)return null}}return i}mapToInitFragWhenRequired(i){return i!=null&&i.initSegment&&!i.initSegment.data&&!this.bitrateTest?i.initSegment:i}getNextPart(i,_,$){let j=-1,_e=!1,et=!0;for(let tt=0,rt=i.length;tt<rt;tt++){const nt=i[tt];if(et=et&&!nt.independent,j>-1&&$<nt.start)break;const it=nt.loaded;it?j=-1:(_e||(nt.independent||et)&&nt.fragment===_)&&(nt.fragment!==_&&this.warn(`Need buffer at ${$} but next unloaded part starts at ${nt.start}`),j=tt),_e=it}return j}loadedEndOfParts(i,_){let $;for(let j=i.length;j--;){if($=i[j],!$.loaded)return!1;if(_>$.start)return!0}return!1}getInitialLiveFragment(i){const _=i.fragments,$=this.fragPrevious;let j=null;if($){if(i.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${$.programDateTime}`),j=findFragmentByPDT(_,$.endProgramDateTime,this.config.maxFragLookUpTolerance)),!j){const _e=$.sn+1;if(_e>=i.startSN&&_e<=i.endSN){const et=_[_e-i.startSN];$.cc===et.cc&&(j=et,this.log(`Live playlist, switching playlist, load frag with next SN: ${j.sn}`))}j||(j=findNearestWithCC(i,$.cc,$.end),j&&this.log(`Live playlist, switching playlist, load frag with same CC: ${j.sn}`))}}else{const _e=this.hls.liveSyncPosition;_e!==null&&(j=this.getFragmentAtPosition(_e,this.bitrateTest?i.fragmentEnd:i.edge,i))}return j}getFragmentAtPosition(i,_,$){const{config:j}=this;let{fragPrevious:_e}=this,{fragments:et,endSN:tt}=$;const{fragmentHint:rt}=$,{maxFragLookUpTolerance:nt}=j,it=$.partList,st=!!(this.loadingParts&&it!=null&&it.length&&rt);st&&!this.bitrateTest&&it[it.length-1].fragment.sn===rt.sn&&(et=et.concat(rt),tt=rt.sn);let at;if(i<_){var ot;const ct=i<this.lastCurrentTime||i>_-nt||(ot=this.media)!=null&&ot.paused||!this.startFragRequested?0:nt;at=findFragmentByPTS(_e,et,i,ct)}else at=et[et.length-1];if(at){const lt=at.sn-$.startSN,ct=this.fragmentTracker.getState(at);if((ct===FragmentState.OK||ct===FragmentState.PARTIAL&&at.gap)&&(_e=at),_e&&at.sn===_e.sn&&(!st||it[0].fragment.sn>at.sn||!$.live)&&at.level===_e.level){const ut=et[lt+1];at.sn<tt&&this.fragmentTracker.getState(ut)!==FragmentState.OK?at=ut:at=null}}return at}alignPlaylists(i,_,$){const j=i.fragments.length;if(!j)return this.warn("No fragments in live playlist"),0;const _e=i.fragmentStart,et=!_,tt=i.alignedSliding&&isFiniteNumber(_e);if(et||!tt&&!_e){alignStream($,i);const rt=i.fragmentStart;return this.log(`Live playlist sliding: ${rt.toFixed(2)} start-sn: ${_?_.startSN:"na"}->${i.startSN} fragments: ${j}`),rt}return _e}waitForCdnTuneIn(i){return i.live&&i.canBlockReload&&i.partTarget&&i.tuneInGoal>Math.max(i.partHoldBack,i.partTarget*3)}setStartPosition(i,_){let $=this.startPosition;$<_&&($=-1);const j=this.timelineOffset;if($===-1){const _e=this.startTimeOffset!==null,et=_e?this.startTimeOffset:i.startTimeOffset;et!==null&&isFiniteNumber(et)?($=_+et,et<0&&($+=i.edge),$=Math.min(Math.max(_,$),_+i.totalduration),this.log(`Setting startPosition to ${$} for start time offset ${et} found in ${_e?"multivariant":"media"} playlist`),this.startPosition=$):i.live?($=this.hls.liveSyncPosition||_,this.log(`Setting startPosition to -1 to start at live edge ${$}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=$=0),this.lastCurrentTime=$+j}this.nextLoadPosition=$+j}getLoadPosition(){var i;const{media:_}=this;let $=0;return(i=this.hls)!=null&&i.hasEnoughToStart&&_?$=_.currentTime:this.nextLoadPosition>=0&&($=this.nextLoadPosition),$}handleFragLoadAborted(i,_){this.transmuxer&&i.type===this.playlistType&&isMediaFragment(i)&&i.stats.aborted&&(this.log(`Fragment ${i.sn}${_?" part "+_.index:""} of ${this.playlistLabel()} ${i.level} was aborted`),this.resetFragmentLoading(i))}resetFragmentLoading(i){(!this.fragCurrent||!this.fragContextChanged(i)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(i,_){var $;if(_.chunkMeta&&!_.frag){const ut=this.getCurrentContext(_.chunkMeta);ut&&(_.frag=ut.frag)}const j=_.frag;if(!j||j.type!==i||!this.levels)return;if(this.fragContextChanged(j)){var _e;this.warn(`Frag load error must match current frag to retry ${j.url} > ${(_e=this.fragCurrent)==null?void 0:_e.url}`);return}const et=_.details===ErrorDetails.FRAG_GAP;et&&this.fragmentTracker.fragBuffered(j,!0);const tt=_.errorAction;if(!tt){this.state=State.ERROR;return}const{action:rt,flags:nt,retryCount:it=0,retryConfig:st}=tt,at=!!st,ot=at&&rt===NetworkErrorAction.RetryRequest,lt=at&&!tt.resolved&&nt===ErrorActionFlags.MoveAllAlternatesMatchingHost,ct=($=this.hls.latestLevelDetails)==null?void 0:$.live;if(!ot&&lt&&isMediaFragment(j)&&!j.endList&&ct&&!isUnusableKeyError(_))this.resetFragmentErrors(i),this.treatAsGap(j),tt.resolved=!0;else if((ot||lt)&&it<st.maxNumRetry){var ft;const ut=offlineHttpStatus((ft=_.response)==null?void 0:ft.code),ht=getRetryDelay(st,it);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+ht,this.state=State.FRAG_LOADING_WAITING_RETRY,tt.resolved=!0,ut){this.log("Waiting for connection (offline)"),this.retryDate=1/0,_.reason="offline";return}this.warn(`Fragment ${j.sn} of ${i} ${j.level} errored with ${_.details}, retrying loading ${it+1}/${st.maxNumRetry} in ${ht}ms`)}else if(st)if(this.resetFragmentErrors(i),it<st.maxNumRetry)!et&&rt!==NetworkErrorAction.RemoveAlternatePermanently&&(tt.resolved=!0);else{this.warn(`${_.details} reached or exceeded max retry (${it})`);return}else rt===NetworkErrorAction.SendAlternateToPenaltyBox?this.state=State.WAITING_LEVEL:this.state=State.ERROR;this.tickImmediate()}checkRetryDate(){const i=self.performance.now(),_=this.retryDate,$=_===1/0;(!_||i>=_||$&&!offlineHttpStatus(0))&&($&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=State.IDLE)}reduceLengthAndFlushBuffer(i){if(this.state===State.PARSING||this.state===State.PARSED){const _=i.frag,$=i.parent,j=this.getFwdBufferInfo(this.mediaBuffer,$),_e=j&&j.len>.5;_e&&this.reduceMaxBufferLength(j.len,(_==null?void 0:_.duration)||10);const et=!_e;return et&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${$} buffer`),_&&(this.fragmentTracker.removeFragment(_),this.nextLoadPosition=_.start),this.resetLoadingState(),et}return!1}resetFragmentErrors(i){i===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(i,_,$){if(!i)return;const j=BufferHelper.getBuffered(i);this.fragmentTracker.detectEvictedFragments(_,j,$),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==State.STOPPED&&(this.state=State.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const i=this.levelLastLoaded,_=i?i.details:null;_!=null&&_.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(_,_.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(i){this.log(`Loading context changed while buffering sn ${i.sn} of ${this.playlistLabel()} ${i.level===-1?"<removed>":i.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(i=0){this.fragmentTracker.removeFragmentsInRange(i,1/0,this.playlistType,!1,!0)}updateLevelTiming(i,_,$,j){const _e=$.details;if(!_e){this.warn("level.details undefined");return}if(!Object.keys(i.elementaryStreams).reduce((rt,nt)=>{const it=i.elementaryStreams[nt];if(it){const st=it.endPTS-it.startPTS;if(st<=0)return this.warn(`Could not parse fragment ${i.sn} ${nt} duration reliably (${st})`),rt||!1;const at=j?0:updateFragPTSDTS(_e,i,it.startPTS,it.endPTS,it.startDTS,it.endDTS,this);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:_e,level:$,drift:at,type:nt,frag:i,start:it.startPTS,end:it.endPTS}),!0}return rt},!1)){var tt;if($.fragmentError===0&&this.treatAsGap(i,$),((tt=this.transmuxer)==null?void 0:tt.error)===null){const rt=new Error(`Found no media in fragment ${i.sn} of ${this.playlistLabel()} ${i.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(rt.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:rt,frag:i,reason:`Found no media in msn ${i.sn} of ${this.playlistLabel()} "${$.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=State.PARSED,this.log(`Parsed ${i.type} sn: ${i.sn}${_?" part: "+_.index:""} of ${this.fragInfo(i,!1,_)})`),this.hls.trigger(Events.FRAG_PARSED,{frag:i,part:_})}playlistLabel(){return this.playlistType===PlaylistLevelType.MAIN?"level":"track"}fragInfo(i,_=!0,$){var j,_e;return`${this.playlistLabel()} ${i.level} (${$?"part":"frag"}:[${((j=_&&!$?i.startPTS:($||i).start)!=null?j:NaN).toFixed(3)}-${((_e=_&&!$?i.endPTS:($||i).end)!=null?_e:NaN).toFixed(3)}]${$&&i.type==="main"?"INDEPENDENT="+($.independent?"YES":"NO"):""}`}treatAsGap(i,_){_&&_.fragmentError++,i.gap=!0,this.fragmentTracker.removeFragment(i),this.fragmentTracker.fragBuffered(i,!0)}resetTransmuxer(){var i;(i=this.transmuxer)==null||i.reset()}recoverWorkerError(i){i.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(i){const _=this._state;_!==i&&(this._state=i,this.log(`${_}->${i}`))}get state(){return this._state}}function interstitialsEnabled(o){return!!o.interstitialsController&&o.enableInterstitialPlayback!==!1}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(i){this.chunks.push(i),this.dataLength+=i.length}flush(){const{chunks:i,dataLength:_}=this;let $;if(i.length)i.length===1?$=i[0]:$=concatUint8Arrays(i,_);else return new Uint8Array(0);return this.reset(),$}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(o,i){const _=new Uint8Array(i);let $=0;for(let j=0;j<o.length;j++){const _e=o[j];_.set(_e,$),$+=_e.length}return _}var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(o){var i=Object.prototype.hasOwnProperty,_="~";function $(){}Object.create&&($.prototype=Object.create(null),new $().__proto__||(_=!1));function j(rt,nt,it){this.fn=rt,this.context=nt,this.once=it||!1}function _e(rt,nt,it,st,at){if(typeof it!="function")throw new TypeError("The listener must be a function");var ot=new j(it,st||rt,at),lt=_?_+nt:nt;return rt._events[lt]?rt._events[lt].fn?rt._events[lt]=[rt._events[lt],ot]:rt._events[lt].push(ot):(rt._events[lt]=ot,rt._eventsCount++),rt}function et(rt,nt){--rt._eventsCount===0?rt._events=new $:delete rt._events[nt]}function tt(){this._events=new $,this._eventsCount=0}tt.prototype.eventNames=function(){var nt=[],it,st;if(this._eventsCount===0)return nt;for(st in it=this._events)i.call(it,st)&&nt.push(_?st.slice(1):st);return Object.getOwnPropertySymbols?nt.concat(Object.getOwnPropertySymbols(it)):nt},tt.prototype.listeners=function(nt){var it=_?_+nt:nt,st=this._events[it];if(!st)return[];if(st.fn)return[st.fn];for(var at=0,ot=st.length,lt=new Array(ot);at<ot;at++)lt[at]=st[at].fn;return lt},tt.prototype.listenerCount=function(nt){var it=_?_+nt:nt,st=this._events[it];return st?st.fn?1:st.length:0},tt.prototype.emit=function(nt,it,st,at,ot,lt){var ct=_?_+nt:nt;if(!this._events[ct])return!1;var ft=this._events[ct],ut=arguments.length,ht,dt;if(ft.fn){switch(ft.once&&this.removeListener(nt,ft.fn,void 0,!0),ut){case 1:return ft.fn.call(ft.context),!0;case 2:return ft.fn.call(ft.context,it),!0;case 3:return ft.fn.call(ft.context,it,st),!0;case 4:return ft.fn.call(ft.context,it,st,at),!0;case 5:return ft.fn.call(ft.context,it,st,at,ot),!0;case 6:return ft.fn.call(ft.context,it,st,at,ot,lt),!0}for(dt=1,ht=new Array(ut-1);dt<ut;dt++)ht[dt-1]=arguments[dt];ft.fn.apply(ft.context,ht)}else{var mt=ft.length,pt;for(dt=0;dt<mt;dt++)switch(ft[dt].once&&this.removeListener(nt,ft[dt].fn,void 0,!0),ut){case 1:ft[dt].fn.call(ft[dt].context);break;case 2:ft[dt].fn.call(ft[dt].context,it);break;case 3:ft[dt].fn.call(ft[dt].context,it,st);break;case 4:ft[dt].fn.call(ft[dt].context,it,st,at);break;default:if(!ht)for(pt=1,ht=new Array(ut-1);pt<ut;pt++)ht[pt-1]=arguments[pt];ft[dt].fn.apply(ft[dt].context,ht)}}return!0},tt.prototype.on=function(nt,it,st){return _e(this,nt,it,st,!1)},tt.prototype.once=function(nt,it,st){return _e(this,nt,it,st,!0)},tt.prototype.removeListener=function(nt,it,st,at){var ot=_?_+nt:nt;if(!this._events[ot])return this;if(!it)return et(this,ot),this;var lt=this._events[ot];if(lt.fn)lt.fn===it&&(!at||lt.once)&&(!st||lt.context===st)&&et(this,ot);else{for(var ct=0,ft=[],ut=lt.length;ct<ut;ct++)(lt[ct].fn!==it||at&&!lt[ct].once||st&&lt[ct].context!==st)&&ft.push(lt[ct]);ft.length?this._events[ot]=ft.length===1?ft[0]:ft:et(this,ot)}return this},tt.prototype.removeAllListeners=function(nt){var it;return nt?(it=_?_+nt:nt,this._events[it]&&et(this,it)):(this._events=new $,this._eventsCount=0),this},tt.prototype.off=tt.prototype.removeListener,tt.prototype.addListener=tt.prototype.on,tt.prefixed=_,tt.EventEmitter=tt,o.exports=tt}(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3(),EventEmitter$1=getDefaultExportFromCjs(eventemitter3Exports);const version$4="1.6.12",workerStore={};function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const o=workerStore[version$4];if(o)return o.clientCount++,o;const i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),_=self.URL.createObjectURL(i),j={worker:new self.Worker(_),objectURL:_,clientCount:1};return workerStore[version$4]=j,j}function loadWorker(o){const i=workerStore[o];if(i)return i.clientCount++,i;const _=new self.URL(o,self.location.href).href,j={worker:new self.Worker(_),scriptURL:_,clientCount:1};return workerStore[o]=j,j}function removeWorkerFromStore(o){const i=workerStore[o||version$4];if(i&&i.clientCount--===1){const{worker:$,objectURL:j}=i;delete workerStore[o||version$4],j&&self.URL.revokeObjectURL(j),$.terminate()}}function isId3Footer(o,i){return i+10<=o.length&&o[i]===51&&o[i+1]===68&&o[i+2]===73&&o[i+3]<255&&o[i+4]<255&&o[i+6]<128&&o[i+7]<128&&o[i+8]<128&&o[i+9]<128}function isId3Header(o,i){return i+10<=o.length&&o[i]===73&&o[i+1]===68&&o[i+2]===51&&o[i+3]<255&&o[i+4]<255&&o[i+6]<128&&o[i+7]<128&&o[i+8]<128&&o[i+9]<128}function readId3Size(o,i){let _=0;return _=(o[i]&127)<<21,_|=(o[i+1]&127)<<14,_|=(o[i+2]&127)<<7,_|=o[i+3]&127,_}function getId3Data(o,i){const _=i;let $=0;for(;isId3Header(o,i);){$+=10;const j=readId3Size(o,i+6);$+=j,isId3Footer(o,i+10)&&($+=10),i+=$}if($>0)return o.subarray(_,_+$)}function getAudioConfig(o,i,_,$){const j=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],_e=i[_+2],et=_e>>2&15;if(et>12){const ot=new Error(`invalid ADTS sampling index:${et}`);o.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,error:ot,reason:ot.message});return}const tt=(_e>>6&3)+1,rt=i[_+3]>>6&3|(_e&1)<<2,nt="mp4a.40."+tt,it=j[et];let st=et;(tt===5||tt===29)&&(st-=3);const at=[tt<<3|(st&14)>>1,(st&1)<<7|rt<<3];return logger.log(`manifest codec:${$}, parsed codec:${nt}, channels:${rt}, rate:${it} (ADTS object type:${tt} sampling index:${et})`),{config:at,samplerate:it,channelCount:rt,codec:nt,parsedCodec:nt,manifestCodec:$}}function isHeaderPattern$1(o,i){return o[i]===255&&(o[i+1]&246)===240}function getHeaderLength(o,i){return o[i+1]&1?7:9}function getFullFrameLength(o,i){return(o[i+3]&3)<<11|o[i+4]<<3|(o[i+5]&224)>>>5}function canGetFrameLength(o,i){return i+5<o.length}function isHeader$1(o,i){return i+1<o.length&&isHeaderPattern$1(o,i)}function canParse$1(o,i){return canGetFrameLength(o,i)&&isHeaderPattern$1(o,i)&&getFullFrameLength(o,i)<=o.length-i}function probe$1(o,i){if(isHeader$1(o,i)){const _=getHeaderLength(o,i);if(i+_>=o.length)return!1;const $=getFullFrameLength(o,i);if($<=_)return!1;const j=i+$;return j===o.length||isHeader$1(o,j)}return!1}function initTrackConfig(o,i,_,$,j){if(!o.samplerate){const _e=getAudioConfig(i,_,$,j);if(!_e)return;_extends(o,_e)}}function getFrameDuration(o){return 1024*9e4/o}function parseFrameHeader(o,i){const _=getHeaderLength(o,i);if(i+_<=o.length){const $=getFullFrameLength(o,i)-_;if($>0)return{headerLength:_,frameLength:$}}}function appendFrame$2(o,i,_,$,j){const _e=getFrameDuration(o.samplerate),et=$+j*_e,tt=parseFrameHeader(i,_);let rt;if(tt){const{frameLength:st,headerLength:at}=tt,ot=at+st,lt=Math.max(0,_+ot-i.length);lt?(rt=new Uint8Array(ot-at),rt.set(i.subarray(_+at,i.length),0)):rt=i.subarray(_+at,_+ot);const ct={unit:rt,pts:et};return lt||o.samples.push(ct),{sample:ct,length:ot,missing:lt}}const nt=i.length-_;return rt=new Uint8Array(nt),rt.set(i.subarray(_,i.length),0),{sample:{unit:rt,pts:et},length:nt,missing:-1}}function canParseId3(o,i){return isId3Header(o,i)&&readId3Size(o,i+6)+10<=o.length-i}function toArrayBuffer(o){return o instanceof ArrayBuffer?o:o.byteOffset==0&&o.byteLength==o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer}function toUint8(o,i=0,_=1/0){return view(o,i,_,Uint8Array)}function view(o,i,_,$){const j=unsafeGetArrayBuffer(o);let _e=1;"BYTES_PER_ELEMENT"in $&&(_e=$.BYTES_PER_ELEMENT);const et=isArrayBufferView(o)?o.byteOffset:0,tt=(et+o.byteLength)/_e,rt=(et+i)/_e,nt=Math.floor(Math.max(0,Math.min(rt,tt))),it=Math.floor(Math.min(nt+Math.max(_,0),tt));return new $(j,nt,it-nt)}function unsafeGetArrayBuffer(o){return o instanceof ArrayBuffer?o:o.buffer}function isArrayBufferView(o){return o&&o.buffer instanceof ArrayBuffer&&o.byteLength!==void 0&&o.byteOffset!==void 0}function decodeId3ImageFrame(o){const i={key:o.type,description:"",data:"",mimeType:null,pictureType:null},_=3;if(o.size<2)return;if(o.data[0]!==_){console.log("Ignore frame with unrecognized character encoding");return}const $=o.data.subarray(1).indexOf(0);if($===-1)return;const j=utf8ArrayToStr(toUint8(o.data,1,$)),_e=o.data[2+$],et=o.data.subarray(3+$).indexOf(0);if(et===-1)return;const tt=utf8ArrayToStr(toUint8(o.data,3+$,et));let rt;return j==="-->"?rt=utf8ArrayToStr(toUint8(o.data,4+$+et)):rt=toArrayBuffer(o.data.subarray(4+$+et)),i.mimeType=j,i.pictureType=_e,i.description=tt,i.data=rt,i}function decodeId3PrivFrame(o){if(o.size<2)return;const i=utf8ArrayToStr(o.data,!0),_=new Uint8Array(o.data.subarray(i.length+1));return{key:o.type,info:i,data:_.buffer}}function decodeId3TextFrame(o){if(o.size<2)return;if(o.type==="TXXX"){let _=1;const $=utf8ArrayToStr(o.data.subarray(_),!0);_+=$.length+1;const j=utf8ArrayToStr(o.data.subarray(_));return{key:o.type,info:$,data:j}}const i=utf8ArrayToStr(o.data.subarray(1));return{key:o.type,info:"",data:i}}function decodeId3UrlFrame(o){if(o.type==="WXXX"){if(o.size<2)return;let _=1;const $=utf8ArrayToStr(o.data.subarray(_),!0);_+=$.length+1;const j=utf8ArrayToStr(o.data.subarray(_));return{key:o.type,info:$,data:j}}const i=utf8ArrayToStr(o.data);return{key:o.type,info:"",data:i}}function decodeId3Frame(o){return o.type==="PRIV"?decodeId3PrivFrame(o):o.type[0]==="W"?decodeId3UrlFrame(o):o.type==="APIC"?decodeId3ImageFrame(o):decodeId3TextFrame(o)}function getId3FrameData(o){const i=String.fromCharCode(o[0],o[1],o[2],o[3]),_=readId3Size(o,4),$=10;return{type:i,size:_,data:o.subarray($,$+_)}}const HEADER_FOOTER_SIZE=10,FRAME_SIZE=10;function getId3Frames(o){let i=0;const _=[];for(;isId3Header(o,i);){const $=readId3Size(o,i+6);o[i+5]>>6&1&&(i+=HEADER_FOOTER_SIZE),i+=HEADER_FOOTER_SIZE;const j=i+$;for(;i+FRAME_SIZE<j;){const _e=getId3FrameData(o.subarray(i)),et=decodeId3Frame(_e);et&&_.push(et),i+=_e.size+HEADER_FOOTER_SIZE}isId3Footer(o,i)&&(i+=HEADER_FOOTER_SIZE)}return _}function isId3TimestampFrame(o){return o&&o.key==="PRIV"&&o.info==="com.apple.streaming.transportStreamTimestamp"}function readId3Timestamp(o){if(o.data.byteLength===8){const i=new Uint8Array(o.data),_=i[3]&1;let $=(i[4]<<23)+(i[5]<<15)+(i[6]<<7)+i[7];return $/=45,_&&($+=4772185884e-2),Math.round($)}}function getId3Timestamp(o){const i=getId3Frames(o);for(let _=0;_<i.length;_++){const $=i[_];if(isId3TimestampFrame($))return readId3Timestamp($)}}let MetadataSchema=function(o){return o.audioId3="org.id3",o.dateRange="com.apple.quicktime.HLS",o.emsg="https://aomedia.org/emsg/ID3",o.misbklv="urn:misb:KLV:bin:1910.1",o}({});function dummyTrack(o="",i=9e4){return{type:o,id:-1,pid:-1,inputTimeScale:i,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(i,_,$,j){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(i){this.initPTS=i,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(i,_){return!1}appendFrame(i,_,$){}demux(i,_){this.cachedData&&(i=appendUint8Array(this.cachedData,i),this.cachedData=null);let $=getId3Data(i,0),j=$?$.length:0,_e;const et=this._audioTrack,tt=this._id3Track,rt=$?getId3Timestamp($):void 0,nt=i.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(rt))&&(this.basePTS=initPTSFn(rt,_,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),$&&$.length>0&&tt.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:$,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});j<nt;){if(this.canParse(i,j)){const it=this.appendFrame(et,i,j);it?(this.frameIndex++,this.lastPTS=it.sample.pts,j+=it.length,_e=j):j=nt}else canParseId3(i,j)?($=getId3Data(i,j),tt.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:$,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),j+=$.length,_e=j):j++;if(j===nt&&_e!==nt){const it=i.slice(_e);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,it):this.cachedData=it}}return{audioTrack:et,videoTrack:dummyTrack(),id3Track:tt,textTrack:dummyTrack()}}demuxSampleAes(i,_,$){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(i){const _=this.cachedData;return _&&(this.cachedData=null,this.demux(_,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const initPTSFn=(o,i,_)=>{if(isFiniteNumber(o))return o*90;const $=_?_.baseTime*9e4/_.timescale:0;return i*9e4+$};let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame$1(o,i,_,$,j){if(_+24>i.length)return;const _e=parseHeader(i,_);if(_e&&_+_e.frameLength<=i.length){const et=_e.samplesPerFrame*9e4/_e.sampleRate,tt=$+j*et,rt={unit:i.subarray(_,_+_e.frameLength),pts:tt,dts:tt};return o.config=[],o.channelCount=_e.channelCount,o.samplerate=_e.sampleRate,o.samples.push(rt),{sample:rt,length:_e.frameLength,missing:0}}}function parseHeader(o,i){const _=o[i+1]>>3&3,$=o[i+1]>>1&3,j=o[i+2]>>4&15,_e=o[i+2]>>2&3;if(_!==1&&j!==0&&j!==15&&_e!==3){const et=o[i+2]>>1&1,tt=o[i+3]>>6,rt=_===3?3-$:$===3?3:4,nt=BitratesMap[rt*14+j-1]*1e3,st=SamplingRateMap[(_===3?0:_===2?1:2)*3+_e],at=tt===3?1:2,ot=SamplesCoefficients[_][$],lt=BytesInSlot[$],ct=ot*8*lt,ft=Math.floor(ot*nt/st+et)*lt;if(chromeVersion$1===null){const dt=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=dt?parseInt(dt[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&$===2&&nt>=224e3&&tt===0&&(o[i+3]=o[i+3]|128),{sampleRate:st,channelCount:at,frameLength:ft,samplesPerFrame:ct}}}function isHeaderPattern(o,i){return o[i]===255&&(o[i+1]&224)===224&&(o[i+1]&6)!==0}function isHeader(o,i){return i+1<o.length&&isHeaderPattern(o,i)}function canParse(o,i){return isHeaderPattern(o,i)&&4<=o.length-i}function probe(o,i){if(i+1<o.length&&isHeaderPattern(o,i)){const $=parseHeader(o,i);let j=4;$!=null&&$.frameLength&&(j=$.frameLength);const _e=i+j;return _e===o.length||isHeader(o,_e)}return!1}class AACDemuxer extends BaseAudioDemuxer{constructor(i,_){super(),this.observer=void 0,this.config=void 0,this.observer=i,this.config=_}resetInitSegment(i,_,$,j){super.resetInitSegment(i,_,$,j),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:_,duration:j,inputTimeScale:9e4,dropped:0}}static probe(i,_){if(!i)return!1;const $=getId3Data(i,0);let j=($==null?void 0:$.length)||0;if(probe(i,j))return!1;for(let _e=i.length;j<_e;j++)if(probe$1(i,j))return _.log("ADTS sync word found !"),!0;return!1}canParse(i,_){return canParse$1(i,_)}appendFrame(i,_,$){initTrackConfig(i,this.observer,_,$,i.manifestCodec);const j=appendFrame$2(i,_,$,this.basePTS,this.frameIndex);if(j&&j.missing===0)return j}}const getAudioBSID=(o,i)=>{let _=0,$=5;i+=$;const j=new Uint32Array(1),_e=new Uint32Array(1),et=new Uint8Array(1);for(;$>0;){et[0]=o[i];const tt=Math.min($,8),rt=8-tt;_e[0]=4278190080>>>24+rt<<rt,j[0]=(et[0]&_e[0])>>rt,_=_?_<<tt|j[0]:j[0],i+=1,$-=tt}return _};class AC3Demuxer extends BaseAudioDemuxer{constructor(i){super(),this.observer=void 0,this.observer=i}resetInitSegment(i,_,$,j){super.resetInitSegment(i,_,$,j),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:_,duration:j,inputTimeScale:9e4,dropped:0}}canParse(i,_){return _+64<i.length}appendFrame(i,_,$){const j=appendFrame(i,_,$,this.basePTS,this.frameIndex);if(j!==-1)return{sample:i.samples[i.samples.length-1],length:j,missing:0}}static probe(i){if(!i)return!1;const _=getId3Data(i,0);if(!_)return!1;const $=_.length;return i[$]===11&&i[$+1]===119&&getId3Timestamp(_)!==void 0&&getAudioBSID(i,$)<16}}function appendFrame(o,i,_,$,j){if(_+8>i.length||i[_]!==11||i[_+1]!==119)return-1;const _e=i[_+4]>>6;if(_e>=3)return-1;const tt=[48e3,44100,32e3][_e],rt=i[_+4]&63,it=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][rt*3+_e]*2;if(_+it>i.length)return-1;const st=i[_+6]>>5;let at=0;st===2?at+=2:(st&1&&st!==1&&(at+=2),st&4&&(at+=2));const ot=(i[_+6]<<8|i[_+7])>>12-at&1,ct=[2,1,2,3,3,4,4,5][st]+ot,ft=i[_+5]>>3,ut=i[_+5]&7,ht=new Uint8Array([_e<<6|ft<<1|ut>>2,(ut&3)<<6|st<<3|ot<<2|rt>>4,rt<<4&224]),dt=1536/tt*9e4,mt=$+j*dt,pt=i.subarray(_,_+it);return o.config=ht,o.channelCount=ct,o.samplerate=tt,o.samples.push({unit:pt,pts:mt}),it}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(i,_,$,j){super.resetInitSegment(i,_,$,j),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:_,duration:j,inputTimeScale:9e4,dropped:0}}static probe(i){if(!i)return!1;const _=getId3Data(i,0);let $=(_==null?void 0:_.length)||0;if(_&&i[$]===11&&i[$+1]===119&&getId3Timestamp(_)!==void 0&&getAudioBSID(i,$)<=16)return!1;for(let j=i.length;$<j;$++)if(probe(i,$))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(i,_){return canParse(i,_)}appendFrame(i,_,$){if(this.basePTS!==null)return appendFrame$1(i,_,$,this.basePTS,this.frameIndex)}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(i,_){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=_}resetTimeStamp(){}resetInitSegment(i,_,$,j){const _e=this.videoTrack=dummyTrack("video",1),et=this.audioTrack=dummyTrack("audio",1),tt=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(i!=null&&i.byteLength))return;const rt=parseInitSegment(i);if(rt.video){const{id:nt,timescale:it,codec:st,supplemental:at}=rt.video;_e.id=nt,_e.timescale=tt.timescale=it,_e.codec=st,_e.supplemental=at}if(rt.audio){const{id:nt,timescale:it,codec:st}=rt.audio;et.id=nt,et.timescale=it,et.codec=st}tt.id=RemuxerTrackIdConfig.text,_e.sampleDuration=0,_e.duration=et.duration=j}resetContiguity(){this.remainderData=null}static probe(i){return hasMoofData(i)}demux(i,_){this.timeOffset=_;let $=i;const j=this.videoTrack,_e=this.txtTrack;if(this.config.progressive){this.remainderData&&($=appendUint8Array(this.remainderData,i));const tt=segmentValidRange($);this.remainderData=tt.remainder,j.samples=tt.valid||new Uint8Array}else j.samples=$;const et=this.extractID3Track(j,_);return _e.samples=parseSamples(_,j),{videoTrack:j,audioTrack:this.audioTrack,id3Track:et,textTrack:this.txtTrack}}flush(){const i=this.timeOffset,_=this.videoTrack,$=this.txtTrack;_.samples=this.remainderData||new Uint8Array,this.remainderData=null;const j=this.extractID3Track(_,this.timeOffset);return $.samples=parseSamples(i,_),{videoTrack:_,audioTrack:dummyTrack(),id3Track:j,textTrack:dummyTrack()}}extractID3Track(i,_){const $=this.id3Track;if(i.samples.length){const j=findBox(i.samples,["emsg"]);j&&j.forEach(_e=>{const et=parseEmsg(_e);if(emsgSchemePattern.test(et.schemeIdUri)){const tt=getEmsgStartTime(et,_);let rt=et.eventDuration===4294967295?Number.POSITIVE_INFINITY:et.eventDuration/et.timeScale;rt<=.001&&(rt=Number.POSITIVE_INFINITY);const nt=et.payload;$.samples.push({data:nt,len:nt.byteLength,dts:tt,pts:tt,type:MetadataSchema.emsg,duration:rt})}else if(this.config.enableEmsgKLVMetadata&&et.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const tt=getEmsgStartTime(et,_);$.samples.push({data:et.payload,len:et.payload.byteLength,dts:tt,pts:tt,type:MetadataSchema.misbklv,duration:Number.POSITIVE_INFINITY})}})}return $}demuxSampleAes(i,_,$){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function getEmsgStartTime(o,i){return isFiniteNumber(o.presentationTime)?o.presentationTime/o.timeScale:i+o.presentationTimeDelta/o.timeScale}class SampleAesDecrypter{constructor(i,_,$){this.keyData=void 0,this.decrypter=void 0,this.keyData=$,this.decrypter=new Decrypter(_,{removePKCS7Padding:!1})}decryptBuffer(i){return this.decrypter.decrypt(i,this.keyData.key.buffer,this.keyData.iv.buffer,DecrypterAesMode.cbc)}decryptAacSample(i,_,$){const j=i[_].unit;if(j.length<=16)return;const _e=j.subarray(16,j.length-j.length%16),et=_e.buffer.slice(_e.byteOffset,_e.byteOffset+_e.length);this.decryptBuffer(et).then(tt=>{const rt=new Uint8Array(tt);j.set(rt,16),this.decrypter.isSync()||this.decryptAacSamples(i,_+1,$)}).catch($)}decryptAacSamples(i,_,$){for(;;_++){if(_>=i.length){$();return}if(!(i[_].unit.length<32)&&(this.decryptAacSample(i,_,$),!this.decrypter.isSync()))return}}getAvcEncryptedData(i){const _=Math.floor((i.length-48)/160)*16+16,$=new Int8Array(_);let j=0;for(let _e=32;_e<i.length-16;_e+=160,j+=16)$.set(i.subarray(_e,_e+16),j);return $}getAvcDecryptedUnit(i,_){const $=new Uint8Array(_);let j=0;for(let _e=32;_e<i.length-16;_e+=160,j+=16)i.set($.subarray(j,j+16),_e);return i}decryptAvcSample(i,_,$,j,_e){const et=discardEPB(_e.data),tt=this.getAvcEncryptedData(et);this.decryptBuffer(tt.buffer).then(rt=>{_e.data=this.getAvcDecryptedUnit(et,rt),this.decrypter.isSync()||this.decryptAvcSamples(i,_,$+1,j)}).catch(j)}decryptAvcSamples(i,_,$,j){if(i instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;_++,$=0){if(_>=i.length){j();return}const _e=i[_].units;for(;!($>=_e.length);$++){const et=_e[$];if(!(et.data.length<=48||et.type!==1&&et.type!==5)&&(this.decryptAvcSample(i,_,$,j,et),!this.decrypter.isSync()))return}}}}class BaseVideoParser{constructor(){this.VideoSample=null}createVideoSample(i,_,$){return{key:i,frame:!1,pts:_,dts:$,units:[],length:0}}getLastNalUnit(i){var _;let $=this.VideoSample,j;if((!$||$.units.length===0)&&($=i[i.length-1]),(_=$)!=null&&_.units){const _e=$.units;j=_e[_e.length-1]}return j}pushAccessUnit(i,_){if(i.units.length&&i.frame){if(i.pts===void 0){const $=_.samples,j=$.length;if(j){const _e=$[j-1];i.pts=_e.pts,i.dts=_e.dts}else{_.dropped++;return}}_.samples.push(i)}}parseNALu(i,_,$){const j=_.byteLength;let _e=i.naluState||0;const et=_e,tt=[];let rt=0,nt,it,st,at=-1,ot=0;for(_e===-1&&(at=0,ot=this.getNALuType(_,0),_e=0,rt=1);rt<j;){if(nt=_[rt++],!_e){_e=nt?0:1;continue}if(_e===1){_e=nt?0:2;continue}if(!nt)_e=3;else if(nt===1){if(it=rt-_e-1,at>=0){const lt={data:_.subarray(at,it),type:ot};tt.push(lt)}else{const lt=this.getLastNalUnit(i.samples);lt&&(et&&rt<=4-et&&lt.state&&(lt.data=lt.data.subarray(0,lt.data.byteLength-et)),it>0&&(lt.data=appendUint8Array(lt.data,_.subarray(0,it)),lt.state=0))}rt<j?(st=this.getNALuType(_,rt),at=rt,ot=st,_e=0):_e=-1}else _e=0}if(at>=0&&_e>=0){const lt={data:_.subarray(at,j),type:ot,state:_e};tt.push(lt)}if(tt.length===0){const lt=this.getLastNalUnit(i.samples);lt&&(lt.data=appendUint8Array(lt.data,_))}return i.naluState=_e,tt}}class ExpGolomb{constructor(i){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=i,this.bytesAvailable=i.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const i=this.data,_=this.bytesAvailable,$=i.byteLength-_,j=new Uint8Array(4),_e=Math.min(4,_);if(_e===0)throw new Error("no bytes available");j.set(i.subarray($,$+_e)),this.word=new DataView(j.buffer).getUint32(0),this.bitsAvailable=_e*8,this.bytesAvailable-=_e}skipBits(i){let _;i=Math.min(i,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>i?(this.word<<=i,this.bitsAvailable-=i):(i-=this.bitsAvailable,_=i>>3,i-=_<<3,this.bytesAvailable-=_,this.loadWord(),this.word<<=i,this.bitsAvailable-=i)}readBits(i){let _=Math.min(this.bitsAvailable,i);const $=this.word>>>32-_;if(i>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=_,this.bitsAvailable>0)this.word<<=_;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return _=i-_,_>0&&this.bitsAvailable?$<<_|this.readBits(_):$}skipLZ(){let i;for(i=0;i<this.bitsAvailable;++i)if(this.word&2147483648>>>i)return this.word<<=i,this.bitsAvailable-=i,i;return this.loadWord(),i+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const i=this.skipLZ();return this.readBits(i+1)-1}readEG(){const i=this.readUEG();return 1&i?1+i>>>1:-1*(i>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class AvcVideoParser extends BaseVideoParser{parsePES(i,_,$,j){const _e=this.parseNALu(i,$.data,j);let et=this.VideoSample,tt,rt=!1;$.data=null,et&&_e.length&&!i.audFound&&(this.pushAccessUnit(et,i),et=this.VideoSample=this.createVideoSample(!1,$.pts,$.dts)),_e.forEach(nt=>{var it,st;switch(nt.type){case 1:{let ct=!1;tt=!0;const ft=nt.data;if(rt&&ft.length>4){const ut=this.readSliceType(ft);(ut===2||ut===4||ut===7||ut===9)&&(ct=!0)}if(ct){var at;(at=et)!=null&&at.frame&&!et.key&&(this.pushAccessUnit(et,i),et=this.VideoSample=null)}et||(et=this.VideoSample=this.createVideoSample(!0,$.pts,$.dts)),et.frame=!0,et.key=ct;break}case 5:tt=!0,(it=et)!=null&&it.frame&&!et.key&&(this.pushAccessUnit(et,i),et=this.VideoSample=null),et||(et=this.VideoSample=this.createVideoSample(!0,$.pts,$.dts)),et.key=!0,et.frame=!0;break;case 6:{tt=!0,parseSEIMessageFromNALu(nt.data,1,$.pts,_.samples);break}case 7:{var ot,lt;tt=!0,rt=!0;const ct=nt.data,ft=this.readSPS(ct);if(!i.sps||i.width!==ft.width||i.height!==ft.height||((ot=i.pixelRatio)==null?void 0:ot[0])!==ft.pixelRatio[0]||((lt=i.pixelRatio)==null?void 0:lt[1])!==ft.pixelRatio[1]){i.width=ft.width,i.height=ft.height,i.pixelRatio=ft.pixelRatio,i.sps=[ct];const ut=ct.subarray(1,4);let ht="avc1.";for(let dt=0;dt<3;dt++){let mt=ut[dt].toString(16);mt.length<2&&(mt="0"+mt),ht+=mt}i.codec=ht}break}case 8:tt=!0,i.pps=[nt.data];break;case 9:tt=!0,i.audFound=!0,(st=et)!=null&&st.frame&&(this.pushAccessUnit(et,i),et=null),et||(et=this.VideoSample=this.createVideoSample(!1,$.pts,$.dts));break;case 12:tt=!0;break;default:tt=!1;break}et&&tt&&et.units.push(nt)}),j&&et&&(this.pushAccessUnit(et,i),this.VideoSample=null)}getNALuType(i,_){return i[_]&31}readSliceType(i){const _=new ExpGolomb(i);return _.readUByte(),_.readUEG(),_.readUEG()}skipScalingList(i,_){let $=8,j=8,_e;for(let et=0;et<i;et++)j!==0&&(_e=_.readEG(),j=($+_e+256)%256),$=j===0?$:j}readSPS(i){const _=new ExpGolomb(i);let $=0,j=0,_e=0,et=0,tt,rt,nt;const it=_.readUByte.bind(_),st=_.readBits.bind(_),at=_.readUEG.bind(_),ot=_.readBoolean.bind(_),lt=_.skipBits.bind(_),ct=_.skipEG.bind(_),ft=_.skipUEG.bind(_),ut=this.skipScalingList.bind(this);it();const ht=it();if(st(5),lt(3),it(),ft(),ht===100||ht===110||ht===122||ht===244||ht===44||ht===83||ht===86||ht===118||ht===128){const vt=at();if(vt===3&&lt(1),ft(),ft(),lt(1),ot())for(rt=vt!==3?8:12,nt=0;nt<rt;nt++)ot()&&(nt<6?ut(16,_):ut(64,_))}ft();const dt=at();if(dt===0)at();else if(dt===1)for(lt(1),ct(),ct(),tt=at(),nt=0;nt<tt;nt++)ct();ft(),lt(1);const mt=at(),pt=at(),yt=st(1);yt===0&&lt(1),lt(1),ot()&&($=at(),j=at(),_e=at(),et=at());let gt=[1,1];if(ot()&&ot())switch(it()){case 1:gt=[1,1];break;case 2:gt=[12,11];break;case 3:gt=[10,11];break;case 4:gt=[16,11];break;case 5:gt=[40,33];break;case 6:gt=[24,11];break;case 7:gt=[20,11];break;case 8:gt=[32,11];break;case 9:gt=[80,33];break;case 10:gt=[18,11];break;case 11:gt=[15,11];break;case 12:gt=[64,33];break;case 13:gt=[160,99];break;case 14:gt=[4,3];break;case 15:gt=[3,2];break;case 16:gt=[2,1];break;case 255:{gt=[it()<<8|it(),it()<<8|it()];break}}return{width:Math.ceil((mt+1)*16-$*2-j*2),height:(2-yt)*(pt+1)*16-(yt?2:4)*(_e+et),pixelRatio:gt}}}class HevcVideoParser extends BaseVideoParser{constructor(...i){super(...i),this.initVPS=null}parsePES(i,_,$,j){const _e=this.parseNALu(i,$.data,j);let et=this.VideoSample,tt,rt=!1;$.data=null,et&&_e.length&&!i.audFound&&(this.pushAccessUnit(et,i),et=this.VideoSample=this.createVideoSample(!1,$.pts,$.dts)),_e.forEach(nt=>{var it,st;switch(nt.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:et||(et=this.VideoSample=this.createVideoSample(!1,$.pts,$.dts)),et.frame=!0,tt=!0;break;case 16:case 17:case 18:case 21:if(tt=!0,rt){var at;(at=et)!=null&&at.frame&&!et.key&&(this.pushAccessUnit(et,i),et=this.VideoSample=null)}et||(et=this.VideoSample=this.createVideoSample(!0,$.pts,$.dts)),et.key=!0,et.frame=!0;break;case 19:case 20:tt=!0,(it=et)!=null&&it.frame&&!et.key&&(this.pushAccessUnit(et,i),et=this.VideoSample=null),et||(et=this.VideoSample=this.createVideoSample(!0,$.pts,$.dts)),et.key=!0,et.frame=!0;break;case 39:tt=!0,parseSEIMessageFromNALu(nt.data,2,$.pts,_.samples);break;case 32:tt=!0,i.vps||(typeof i.params!="object"&&(i.params={}),i.params=_extends(i.params,this.readVPS(nt.data)),this.initVPS=nt.data),i.vps=[nt.data];break;case 33:if(tt=!0,rt=!0,i.vps!==void 0&&i.vps[0]!==this.initVPS&&i.sps!==void 0&&!this.matchSPS(i.sps[0],nt.data)&&(this.initVPS=i.vps[0],i.sps=i.pps=void 0),!i.sps){const ot=this.readSPS(nt.data);i.width=ot.width,i.height=ot.height,i.pixelRatio=ot.pixelRatio,i.codec=ot.codecString,i.sps=[],typeof i.params!="object"&&(i.params={});for(const lt in ot.params)i.params[lt]=ot.params[lt]}this.pushParameterSet(i.sps,nt.data,i.vps),et||(et=this.VideoSample=this.createVideoSample(!0,$.pts,$.dts)),et.key=!0;break;case 34:if(tt=!0,typeof i.params=="object"){if(!i.pps){i.pps=[];const ot=this.readPPS(nt.data);for(const lt in ot)i.params[lt]=ot[lt]}this.pushParameterSet(i.pps,nt.data,i.vps)}break;case 35:tt=!0,i.audFound=!0,(st=et)!=null&&st.frame&&(this.pushAccessUnit(et,i),et=null),et||(et=this.VideoSample=this.createVideoSample(!1,$.pts,$.dts));break;default:tt=!1;break}et&&tt&&et.units.push(nt)}),j&&et&&(this.pushAccessUnit(et,i),this.VideoSample=null)}pushParameterSet(i,_,$){($&&$[0]===this.initVPS||!$&&!i.length)&&i.push(_)}getNALuType(i,_){return(i[_]&126)>>>1}ebsp2rbsp(i){const _=new Uint8Array(i.byteLength);let $=0;for(let j=0;j<i.byteLength;j++)j>=2&&i[j]===3&&i[j-1]===0&&i[j-2]===0||(_[$]=i[j],$++);return new Uint8Array(_.buffer,0,$)}pushAccessUnit(i,_){super.pushAccessUnit(i,_),this.initVPS&&(this.initVPS=null)}readVPS(i){const _=new ExpGolomb(i);_.readUByte(),_.readUByte(),_.readBits(4),_.skipBits(2),_.readBits(6);const $=_.readBits(3),j=_.readBoolean();return{numTemporalLayers:$+1,temporalIdNested:j}}readSPS(i){const _=new ExpGolomb(this.ebsp2rbsp(i));_.readUByte(),_.readUByte(),_.readBits(4);const $=_.readBits(3);_.readBoolean();const j=_.readBits(2),_e=_.readBoolean(),et=_.readBits(5),tt=_.readUByte(),rt=_.readUByte(),nt=_.readUByte(),it=_.readUByte(),st=_.readUByte(),at=_.readUByte(),ot=_.readUByte(),lt=_.readUByte(),ct=_.readUByte(),ft=_.readUByte(),ut=_.readUByte(),ht=[],dt=[];for(let er=0;er<$;er++)ht.push(_.readBoolean()),dt.push(_.readBoolean());if($>0)for(let er=$;er<8;er++)_.readBits(2);for(let er=0;er<$;er++)ht[er]&&(_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte(),_.readUByte()),dt[er]&&_.readUByte();_.readUEG();const mt=_.readUEG();mt==3&&_.skipBits(1);const pt=_.readUEG(),yt=_.readUEG(),gt=_.readBoolean();let vt=0,St=0,At=0,xt=0;gt&&(vt+=_.readUEG(),St+=_.readUEG(),At+=_.readUEG(),xt+=_.readUEG());const wt=_.readUEG(),Ot=_.readUEG(),Bt=_.readUEG(),Ft=_.readBoolean();for(let er=Ft?0:$;er<=$;er++)_.skipUEG(),_.skipUEG(),_.skipUEG();if(_.skipUEG(),_.skipUEG(),_.skipUEG(),_.skipUEG(),_.skipUEG(),_.skipUEG(),_.readBoolean()&&_.readBoolean())for(let sr=0;sr<4;sr++)for(let Gt=0;Gt<(sr===3?2:6);Gt++)if(!_.readBoolean())_.readUEG();else{const lr=Math.min(64,1<<4+(sr<<1));sr>1&&_.readEG();for(let dr=0;dr<lr;dr++)_.readEG()}_.readBoolean(),_.readBoolean(),_.readBoolean()&&(_.readUByte(),_.skipUEG(),_.skipUEG(),_.readBoolean());const Et=_.readUEG();let _t=0;for(let er=0;er<Et;er++){let sr=!1;if(er!==0&&(sr=_.readBoolean()),sr){er===Et&&_.readUEG(),_.readBoolean(),_.readUEG();let Gt=0;for(let Jt=0;Jt<=_t;Jt++){const lr=_.readBoolean();let dr=!1;lr||(dr=_.readBoolean()),(lr||dr)&&Gt++}_t=Gt}else{const Gt=_.readUEG(),Jt=_.readUEG();_t=Gt+Jt;for(let lr=0;lr<Gt;lr++)_.readUEG(),_.readBoolean();for(let lr=0;lr<Jt;lr++)_.readUEG(),_.readBoolean()}}if(_.readBoolean()){const er=_.readUEG();for(let sr=0;sr<er;sr++){for(let Gt=0;Gt<Bt+4;Gt++)_.readBits(1);_.readBits(1)}}let Dt=0,Lt=1,Ct=1,kt=!0,jt=1,Vt=0;_.readBoolean(),_.readBoolean();let zt=!1;if(_.readBoolean()){if(_.readBoolean()){const xr=_.readUByte(),Mr=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Or=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];xr>0&&xr<16?(Lt=Mr[xr-1],Ct=Or[xr-1]):xr===255&&(Lt=_.readBits(16),Ct=_.readBits(16))}if(_.readBoolean()&&_.readBoolean(),_.readBoolean()&&(_.readBits(3),_.readBoolean(),_.readBoolean()&&(_.readUByte(),_.readUByte(),_.readUByte())),_.readBoolean()&&(_.readUEG(),_.readUEG()),_.readBoolean(),_.readBoolean(),_.readBoolean(),zt=_.readBoolean(),zt&&(_.skipUEG(),_.skipUEG(),_.skipUEG(),_.skipUEG()),_.readBoolean()&&(jt=_.readBits(32),Vt=_.readBits(32),_.readBoolean()&&_.readUEG(),_.readBoolean())){const Or=_.readBoolean(),fr=_.readBoolean();let Hr=!1;(Or||fr)&&(Hr=_.readBoolean(),Hr&&(_.readUByte(),_.readBits(5),_.readBoolean(),_.readBits(5)),_.readBits(4),_.readBits(4),Hr&&_.readBits(4),_.readBits(5),_.readBits(5),_.readBits(5));for(let Gr=0;Gr<=$;Gr++){kt=_.readBoolean();const dn=kt||_.readBoolean();let nn=!1;dn?_.readEG():nn=_.readBoolean();const vn=nn?1:_.readUEG()+1;if(Or)for(let Jr=0;Jr<vn;Jr++)_.readUEG(),_.readUEG(),Hr&&(_.readUEG(),_.readUEG()),_.skipBits(1);if(fr)for(let Jr=0;Jr<vn;Jr++)_.readUEG(),_.readUEG(),Hr&&(_.readUEG(),_.readUEG()),_.skipBits(1)}}_.readBoolean()&&(_.readBoolean(),_.readBoolean(),_.readBoolean(),Dt=_.readUEG())}let Wt=pt,ir=yt;if(gt){let er=1,sr=1;mt===1?er=sr=2:mt==2&&(er=2),Wt=pt-er*St-er*vt,ir=yt-sr*xt-sr*At}const or=j?["A","B","C"][j]:"",Qt=tt<<24|rt<<16|nt<<8|it;let gr=0;for(let er=0;er<32;er++)gr=(gr|(Qt>>er&1)<<31-er)>>>0;let ar=gr.toString(16);return et===1&&ar==="2"&&(ar="6"),{codecString:`hvc1.${or}${et}.${ar}.${_e?"H":"L"}${ut}.B0`,params:{general_tier_flag:_e,general_profile_idc:et,general_profile_space:j,general_profile_compatibility_flags:[tt,rt,nt,it],general_constraint_indicator_flags:[st,at,ot,lt,ct,ft],general_level_idc:ut,bit_depth:wt+8,bit_depth_luma_minus8:wt,bit_depth_chroma_minus8:Ot,min_spatial_segmentation_idc:Dt,chroma_format_idc:mt,frame_rate:{fixed:kt,fps:Vt/jt}},width:Wt,height:ir,pixelRatio:[Lt,Ct]}}readPPS(i){const _=new ExpGolomb(this.ebsp2rbsp(i));_.readUByte(),_.readUByte(),_.skipUEG(),_.skipUEG(),_.skipBits(2),_.skipBits(3),_.skipBits(2),_.skipUEG(),_.skipUEG(),_.skipEG(),_.skipBits(2),_.readBoolean()&&_.skipUEG(),_.skipEG(),_.skipEG(),_.skipBits(4);const j=_.readBoolean(),_e=_.readBoolean();let et=1;return _e&&j?et=0:_e?et=3:j&&(et=2),{parallelismType:et}}matchSPS(i,_){return String.fromCharCode.apply(null,i).substr(3)===String.fromCharCode.apply(null,_).substr(3)}}const PACKET_LENGTH=188;class TSDemuxer{constructor(i,_,$,j){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=i,this.config=_,this.typeSupported=$,this.logger=j,this.videoParser=null}static probe(i,_){const $=TSDemuxer.syncOffset(i);return $>0&&_.warn(`MPEG2-TS detected but first sync word found @ offset ${$}`),$!==-1}static syncOffset(i){const _=i.length;let $=Math.min(PACKET_LENGTH*5,_-PACKET_LENGTH)+1,j=0;for(;j<$;){let _e=!1,et=-1,tt=0;for(let rt=j;rt<_;rt+=PACKET_LENGTH)if(i[rt]===71&&(_-rt===PACKET_LENGTH||i[rt+PACKET_LENGTH]===71)){if(tt++,et===-1&&(et=rt,et!==0&&($=Math.min(et+PACKET_LENGTH*99,i.length-PACKET_LENGTH)+1)),_e||(_e=parsePID(i,rt)===0),_e&&tt>1&&(et===0&&tt>2||rt+PACKET_LENGTH>$))return et}else{if(tt)return-1;break}j++}return-1}static createTrack(i,_){return{container:i==="video"||i==="audio"?"video/mp2t":void 0,type:i,id:RemuxerTrackIdConfig[i],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:i==="audio"?_:void 0}}resetInitSegment(i,_,$,j){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=TSDemuxer.createTrack("video"),this._videoTrack.duration=j,this._audioTrack=TSDemuxer.createTrack("audio",j),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=_,this.videoCodec=$}resetTimeStamp(){}resetContiguity(){const{_audioTrack:i,_videoTrack:_,_id3Track:$}=this;i&&(i.pesData=null),_&&(_.pesData=null),$&&($.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(i,_,$=!1,j=!1){$||(this.sampleAes=null);let _e;const et=this._videoTrack,tt=this._audioTrack,rt=this._id3Track,nt=this._txtTrack;let it=et.pid,st=et.pesData,at=tt.pid,ot=rt.pid,lt=tt.pesData,ct=rt.pesData,ft=null,ut=this.pmtParsed,ht=this._pmtId,dt=i.length;if(this.remainderData&&(i=appendUint8Array(this.remainderData,i),dt=i.length,this.remainderData=null),dt<PACKET_LENGTH&&!j)return this.remainderData=i,{audioTrack:tt,videoTrack:et,id3Track:rt,textTrack:nt};const mt=Math.max(0,TSDemuxer.syncOffset(i));dt-=(dt-mt)%PACKET_LENGTH,dt<i.byteLength&&!j&&(this.remainderData=new Uint8Array(i.buffer,dt,i.buffer.byteLength-dt));let pt=0;for(let gt=mt;gt<dt;gt+=PACKET_LENGTH)if(i[gt]===71){const vt=!!(i[gt+1]&64),St=parsePID(i,gt),At=(i[gt+3]&48)>>4;let xt;if(At>1){if(xt=gt+5+i[gt+4],xt===gt+PACKET_LENGTH)continue}else xt=gt+4;switch(St){case it:vt&&(st&&(_e=parsePES(st,this.logger))&&(this.readyVideoParser(et.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(et,nt,_e,!1)),st={data:[],size:0}),st&&(st.data.push(i.subarray(xt,gt+PACKET_LENGTH)),st.size+=gt+PACKET_LENGTH-xt);break;case at:if(vt){if(lt&&(_e=parsePES(lt,this.logger)))switch(tt.segmentCodec){case"aac":this.parseAACPES(tt,_e);break;case"mp3":this.parseMPEGPES(tt,_e);break;case"ac3":this.parseAC3PES(tt,_e);break}lt={data:[],size:0}}lt&&(lt.data.push(i.subarray(xt,gt+PACKET_LENGTH)),lt.size+=gt+PACKET_LENGTH-xt);break;case ot:vt&&(ct&&(_e=parsePES(ct,this.logger))&&this.parseID3PES(rt,_e),ct={data:[],size:0}),ct&&(ct.data.push(i.subarray(xt,gt+PACKET_LENGTH)),ct.size+=gt+PACKET_LENGTH-xt);break;case 0:vt&&(xt+=i[xt]+1),ht=this._pmtId=parsePAT(i,xt);break;case ht:{vt&&(xt+=i[xt]+1);const wt=parsePMT(i,xt,this.typeSupported,$,this.observer,this.logger);it=wt.videoPid,it>0&&(et.pid=it,et.segmentCodec=wt.segmentVideoCodec),at=wt.audioPid,at>0&&(tt.pid=at,tt.segmentCodec=wt.segmentAudioCodec),ot=wt.id3Pid,ot>0&&(rt.pid=ot),ft!==null&&!ut&&(this.logger.warn(`MPEG-TS PMT found at ${gt} after unknown PID '${ft}'. Backtracking to sync byte @${mt} to parse all TS packets.`),ft=null,gt=mt-188),ut=this.pmtParsed=!0;break}case 17:case 8191:break;default:ft=St;break}}else pt++;pt>0&&emitParsingError(this.observer,new Error(`Found ${pt} TS packet/s that do not start with 0x47`),void 0,this.logger),et.pesData=st,tt.pesData=lt,rt.pesData=ct;const yt={audioTrack:tt,videoTrack:et,id3Track:rt,textTrack:nt};return j&&this.extractRemainingSamples(yt),yt}flush(){const{remainderData:i}=this;this.remainderData=null;let _;return i?_=this.demux(i,-1,!1,!0):_={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(_),this.sampleAes?this.decrypt(_,this.sampleAes):_}extractRemainingSamples(i){const{audioTrack:_,videoTrack:$,id3Track:j,textTrack:_e}=i,et=$.pesData,tt=_.pesData,rt=j.pesData;let nt;if(et&&(nt=parsePES(et,this.logger))?(this.readyVideoParser($.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES($,_e,nt,!0),$.pesData=null)):$.pesData=et,tt&&(nt=parsePES(tt,this.logger))){switch(_.segmentCodec){case"aac":this.parseAACPES(_,nt);break;case"mp3":this.parseMPEGPES(_,nt);break;case"ac3":this.parseAC3PES(_,nt);break}_.pesData=null}else tt!=null&&tt.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),_.pesData=tt;rt&&(nt=parsePES(rt,this.logger))?(this.parseID3PES(j,nt),j.pesData=null):j.pesData=rt}demuxSampleAes(i,_,$){const j=this.demux(i,$,!0,!this.config.progressive),_e=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,_);return this.decrypt(j,_e)}readyVideoParser(i){this.videoParser===null&&(i==="avc"?this.videoParser=new AvcVideoParser:i==="hevc"&&(this.videoParser=new HevcVideoParser))}decrypt(i,_){return new Promise($=>{const{audioTrack:j,videoTrack:_e}=i;j.samples&&j.segmentCodec==="aac"?_.decryptAacSamples(j.samples,0,()=>{_e.samples?_.decryptAvcSamples(_e.samples,0,0,()=>{$(i)}):$(i)}):_e.samples&&_.decryptAvcSamples(_e.samples,0,0,()=>{$(i)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(i,_){let $=0;const j=this.aacOverFlow;let _e=_.data;if(j){this.aacOverFlow=null;const st=j.missing,at=j.sample.unit.byteLength;if(st===-1)_e=appendUint8Array(j.sample.unit,_e);else{const ot=at-st;j.sample.unit.set(_e.subarray(0,st),ot),i.samples.push(j.sample),$=j.missing}}let et,tt;for(et=$,tt=_e.length;et<tt-1&&!isHeader$1(_e,et);et++);if(et!==$){let st;const at=et<tt-1;if(at?st=`AAC PES did not start with ADTS header,offset:${et}`:st="No ADTS header found in AAC PES",emitParsingError(this.observer,new Error(st),at,this.logger),!at)return}initTrackConfig(i,this.observer,_e,et,this.audioCodec);let rt;if(_.pts!==void 0)rt=_.pts;else if(j){const st=getFrameDuration(i.samplerate);rt=j.sample.pts+st}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let nt=0,it;for(;et<tt;)if(it=appendFrame$2(i,_e,et,rt,nt),et+=it.length,it.missing){this.aacOverFlow=it;break}else for(nt++;et<tt-1&&!isHeader$1(_e,et);et++);}parseMPEGPES(i,_){const $=_.data,j=$.length;let _e=0,et=0;const tt=_.pts;if(tt===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;et<j;)if(isHeader($,et)){const rt=appendFrame$1(i,$,et,tt,_e);if(rt)et+=rt.length,_e++;else break}else et++}parseAC3PES(i,_){{const $=_.data,j=_.pts;if(j===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const _e=$.length;let et=0,tt=0,rt;for(;tt<_e&&(rt=appendFrame(i,$,tt,j,et++))>0;)tt+=rt}}parseID3PES(i,_){if(_.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const $=_extends({},_,{type:this._videoTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});i.samples.push($)}}function parsePID(o,i){return((o[i+1]&31)<<8)+o[i+2]}function parsePAT(o,i){return(o[i+10]&31)<<8|o[i+11]}function parsePMT(o,i,_,$,j,_e){const et={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},tt=(o[i+1]&15)<<8|o[i+2],rt=i+3+tt-4,nt=(o[i+10]&15)<<8|o[i+11];for(i+=12+nt;i<rt;){const it=parsePID(o,i),st=(o[i+3]&15)<<8|o[i+4];switch(o[i]){case 207:if(!$){logEncryptedSamplesFoundInUnencryptedStream("ADTS AAC",_e);break}case 15:et.audioPid===-1&&(et.audioPid=it);break;case 21:et.id3Pid===-1&&(et.id3Pid=it);break;case 219:if(!$){logEncryptedSamplesFoundInUnencryptedStream("H.264",_e);break}case 27:et.videoPid===-1&&(et.videoPid=it);break;case 3:case 4:!_.mpeg&&!_.mp3?_e.log("MPEG audio found, not supported in this browser"):et.audioPid===-1&&(et.audioPid=it,et.segmentAudioCodec="mp3");break;case 193:if(!$){logEncryptedSamplesFoundInUnencryptedStream("AC-3",_e);break}case 129:_.ac3?et.audioPid===-1&&(et.audioPid=it,et.segmentAudioCodec="ac3"):_e.log("AC-3 audio found, not supported in this browser");break;case 6:if(et.audioPid===-1&&st>0){let at=i+5,ot=st;for(;ot>2;){switch(o[at]){case 106:_.ac3!==!0?_e.log("AC-3 audio found, not supported in this browser for now"):(et.audioPid=it,et.segmentAudioCodec="ac3");break}const ct=o[at+1]+2;at+=ct,ot-=ct}}break;case 194:case 135:return emitParsingError(j,new Error("Unsupported EC-3 in M2TS found"),void 0,_e),et;case 36:et.videoPid===-1&&(et.videoPid=it,et.segmentVideoCodec="hevc",_e.log("HEVC in M2TS found"));break}i+=st+5}return et}function emitParsingError(o,i,_,$){$.warn(`parsing error: ${i.message}`),o.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:_,error:i,reason:i.message})}function logEncryptedSamplesFoundInUnencryptedStream(o,i){i.log(`${o} with AES-128-CBC encryption found in unencrypted stream`)}function parsePES(o,i){let _=0,$,j,_e,et,tt;const rt=o.data;if(!o||o.size===0)return null;for(;rt[0].length<19&&rt.length>1;)rt[0]=appendUint8Array(rt[0],rt[1]),rt.splice(1,1);if($=rt[0],($[0]<<16)+($[1]<<8)+$[2]===1){if(j=($[4]<<8)+$[5],j&&j>o.size-6)return null;const it=$[7];it&192&&(et=($[9]&14)*536870912+($[10]&255)*4194304+($[11]&254)*16384+($[12]&255)*128+($[13]&254)/2,it&64?(tt=($[14]&14)*536870912+($[15]&255)*4194304+($[16]&254)*16384+($[17]&255)*128+($[18]&254)/2,et-tt>60*9e4&&(i.warn(`${Math.round((et-tt)/9e4)}s delta between PTS and DTS, align them`),et=tt)):tt=et),_e=$[8];let st=_e+9;if(o.size<=st)return null;o.size-=st;const at=new Uint8Array(o.size);for(let ot=0,lt=rt.length;ot<lt;ot++){$=rt[ot];let ct=$.byteLength;if(st)if(st>ct){st-=ct;continue}else $=$.subarray(st),ct-=st,st=0;at.set($,_),_+=ct}return j&&(j-=_e+3),{data:at,pts:et,dts:tt,len:j}}return null}class AAC{static getSilentFrame(i,_){switch(i){case"mp4a.40.2":if(_===1)return new Uint8Array([0,200,0,128,35,128]);if(_===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(_===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(_===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(_===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(_===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(_===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(_===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(_===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let i;for(i in MP4.types)MP4.types.hasOwnProperty(i)&&(MP4.types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);const _=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),$=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:_,audio:$};const j=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),_e=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=_e,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const et=new Uint8Array([105,115,111,109]),tt=new Uint8Array([97,118,99,49]),rt=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,et,rt,et,tt),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,j))}static box(i,..._){let $=8,j=_.length;const _e=j;for(;j--;)$+=_[j].byteLength;const et=new Uint8Array($);for(et[0]=$>>24&255,et[1]=$>>16&255,et[2]=$>>8&255,et[3]=$&255,et.set(i,4),j=0,$=8;j<_e;j++)et.set(_[j],$),$+=_[j].byteLength;return et}static hdlr(i){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[i])}static mdat(i){return MP4.box(MP4.types.mdat,i)}static mdhd(i,_){_*=i;const $=Math.floor(_/(UINT32_MAX+1)),j=Math.floor(_%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,$>>24,$>>16&255,$>>8&255,$&255,j>>24,j>>16&255,j>>8&255,j&255,85,196,0,0]))}static mdia(i){return MP4.box(MP4.types.mdia,MP4.mdhd(i.timescale||0,i.duration||0),MP4.hdlr(i.type),MP4.minf(i))}static mfhd(i){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]))}static minf(i){return i.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(i)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(i))}static moof(i,_,$){return MP4.box(MP4.types.moof,MP4.mfhd(i),MP4.traf($,_))}static moov(i){let _=i.length;const $=[];for(;_--;)$[_]=MP4.trak(i[_]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(i[0].timescale||0,i[0].duration||0)].concat($).concat(MP4.mvex(i)))}static mvex(i){let _=i.length;const $=[];for(;_--;)$[_]=MP4.trex(i[_]);return MP4.box.apply(null,[MP4.types.mvex,...$])}static mvhd(i,_){_*=i;const $=Math.floor(_/(UINT32_MAX+1)),j=Math.floor(_%(UINT32_MAX+1)),_e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,i&255,$>>24,$>>16&255,$>>8&255,$&255,j>>24,j>>16&255,j>>8&255,j&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,_e)}static sdtp(i){const _=i.samples||[],$=new Uint8Array(4+_.length);let j,_e;for(j=0;j<_.length;j++)_e=_[j].flags,$[j+4]=_e.dependsOn<<4|_e.isDependedOn<<2|_e.hasRedundancy;return MP4.box(MP4.types.sdtp,$)}static stbl(i){return MP4.box(MP4.types.stbl,MP4.stsd(i),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(i){let _=[],$=[],j,_e,et;for(j=0;j<i.sps.length;j++)_e=i.sps[j],et=_e.byteLength,_.push(et>>>8&255),_.push(et&255),_=_.concat(Array.prototype.slice.call(_e));for(j=0;j<i.pps.length;j++)_e=i.pps[j],et=_e.byteLength,$.push(et>>>8&255),$.push(et&255),$=$.concat(Array.prototype.slice.call(_e));const tt=MP4.box(MP4.types.avcC,new Uint8Array([1,_[3],_[4],_[5],255,224|i.sps.length].concat(_).concat([i.pps.length]).concat($))),rt=i.width,nt=i.height,it=i.pixelRatio[0],st=i.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,rt>>8&255,rt&255,nt>>8&255,nt&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),tt,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([it>>24,it>>16&255,it>>8&255,it&255,st>>24,st>>16&255,st>>8&255,st&255])))}static esds(i){const _=i.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,..._,6,1,2])}static audioStsd(i){const _=i.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i.channelCount||0,0,16,0,0,0,0,_>>8&255,_&255,0,0])}static mp4a(i){return MP4.box(MP4.types.mp4a,MP4.audioStsd(i),MP4.box(MP4.types.esds,MP4.esds(i)))}static mp3(i){return MP4.box(MP4.types[".mp3"],MP4.audioStsd(i))}static ac3(i){return MP4.box(MP4.types["ac-3"],MP4.audioStsd(i),MP4.box(MP4.types.dac3,i.config))}static stsd(i){const{segmentCodec:_}=i;if(i.type==="audio"){if(_==="aac")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(i));if(_==="ac3"&&i.config)return MP4.box(MP4.types.stsd,MP4.STSD,MP4.ac3(i));if(_==="mp3"&&i.codec==="mp3")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(i))}else if(i.pps&&i.sps){if(_==="avc")return MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(i));if(_==="hevc"&&i.vps)return MP4.box(MP4.types.stsd,MP4.STSD,MP4.hvc1(i))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${i.type} segment codec (${_}/${i.codec})`)}static tkhd(i){const _=i.id,$=(i.duration||0)*(i.timescale||0),j=i.width||0,_e=i.height||0,et=Math.floor($/(UINT32_MAX+1)),tt=Math.floor($%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,_>>24&255,_>>16&255,_>>8&255,_&255,0,0,0,0,et>>24,et>>16&255,et>>8&255,et&255,tt>>24,tt>>16&255,tt>>8&255,tt&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,j>>8&255,j&255,0,0,_e>>8&255,_e&255,0,0]))}static traf(i,_){const $=MP4.sdtp(i),j=i.id,_e=Math.floor(_/(UINT32_MAX+1)),et=Math.floor(_%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,j>>24,j>>16&255,j>>8&255,j&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,_e>>24,_e>>16&255,_e>>8&255,_e&255,et>>24,et>>16&255,et>>8&255,et&255])),MP4.trun(i,$.length+16+20+8+16+8+8),$)}static trak(i){return i.duration=i.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(i),MP4.mdia(i))}static trex(i){const _=i.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,_>>24,_>>16&255,_>>8&255,_&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(i,_){const $=i.samples||[],j=$.length,_e=12+16*j,et=new Uint8Array(_e);let tt,rt,nt,it,st,at;for(_+=8+_e,et.set([i.type==="video"?1:0,0,15,1,j>>>24&255,j>>>16&255,j>>>8&255,j&255,_>>>24&255,_>>>16&255,_>>>8&255,_&255],0),tt=0;tt<j;tt++)rt=$[tt],nt=rt.duration,it=rt.size,st=rt.flags,at=rt.cts,et.set([nt>>>24&255,nt>>>16&255,nt>>>8&255,nt&255,it>>>24&255,it>>>16&255,it>>>8&255,it&255,st.isLeading<<2|st.dependsOn,st.isDependedOn<<6|st.hasRedundancy<<4|st.paddingValue<<1|st.isNonSync,st.degradPrio&61440,st.degradPrio&15,at>>>24&255,at>>>16&255,at>>>8&255,at&255],12+16*tt);return MP4.box(MP4.types.trun,et)}static initSegment(i){MP4.types||MP4.init();const _=MP4.moov(i);return appendUint8Array(MP4.FTYP,_)}static hvc1(i){const _=i.params,$=[i.vps,i.sps,i.pps],j=4,_e=new Uint8Array([1,_.general_profile_space<<6|(_.general_tier_flag?32:0)|_.general_profile_idc,_.general_profile_compatibility_flags[0],_.general_profile_compatibility_flags[1],_.general_profile_compatibility_flags[2],_.general_profile_compatibility_flags[3],_.general_constraint_indicator_flags[0],_.general_constraint_indicator_flags[1],_.general_constraint_indicator_flags[2],_.general_constraint_indicator_flags[3],_.general_constraint_indicator_flags[4],_.general_constraint_indicator_flags[5],_.general_level_idc,240|_.min_spatial_segmentation_idc>>8,255&_.min_spatial_segmentation_idc,252|_.parallelismType,252|_.chroma_format_idc,248|_.bit_depth_luma_minus8,248|_.bit_depth_chroma_minus8,0,parseInt(_.frame_rate.fps),j-1|_.temporal_id_nested<<2|_.num_temporal_layers<<3|(_.frame_rate.fixed?64:0),$.length]);let et=_e.length;for(let lt=0;lt<$.length;lt+=1){et+=3;for(let ct=0;ct<$[lt].length;ct+=1)et+=2+$[lt][ct].length}const tt=new Uint8Array(et);tt.set(_e,0),et=_e.length;const rt=$.length-1;for(let lt=0;lt<$.length;lt+=1){tt.set(new Uint8Array([32+lt|(lt===rt?128:0),0,$[lt].length]),et),et+=3;for(let ct=0;ct<$[lt].length;ct+=1)tt.set(new Uint8Array([$[lt][ct].length>>8,$[lt][ct].length&255]),et),et+=2,tt.set($[lt][ct],et),et+=$[lt][ct].length}const nt=MP4.box(MP4.types.hvcC,tt),it=i.width,st=i.height,at=i.pixelRatio[0],ot=i.pixelRatio[1];return MP4.box(MP4.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,it>>8&255,it&255,st>>8&255,st&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),nt,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([at>>24,at>>16&255,at>>8&255,at&255,ot>>24,ot>>16&255,ot>>8&255,ot&255])))}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(o,i,_=1,$=!1){const j=o*i*_;return $?Math.round(j):j}function toTimescaleFromScale(o,i,_=1,$=!1){return toTimescaleFromBase(o,i,1/_,$)}function toMsFromMpegTsClock(o,i=!1){return toTimescaleFromBase(o,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,i)}function toMpegTsClockFromTimescale(o,i=1){return toTimescaleFromBase(o,MPEG_TS_CLOCK_FREQ_HZ,1/i)}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152,AC3_SAMPLES_PER_FRAME=1536;let chromeVersion=null,safariWebkitVersion=null;function createMp4Sample(o,i,_,$){return{duration:i,size:_,cts:$,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:o?2:1,isNonSync:o?0:1}}}class MP4Remuxer extends Logger$1{constructor(i,_,$,j){if(super("mp4-remuxer",j),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=i,this.config=_,this.typeSupported=$,this.ISGenerated=!1,chromeVersion===null){const et=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=et?parseInt(et[1]):0}if(safariWebkitVersion===null){const _e=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=_e?parseInt(_e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(i){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=i}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(i){let _=!1;const $=i[0].pts,j=i.reduce((_e,et)=>{let tt=et.pts,rt=tt-_e;return rt<-4294967296&&(_=!0,tt=normalizePts(tt,$),rt=tt-_e),rt>0?_e:tt},$);return _&&this.debug("PTS rollover detected"),j}remux(i,_,$,j,_e,et,tt,rt){let nt,it,st,at,ot,lt,ct=_e,ft=_e;const ut=i.pid>-1,ht=_.pid>-1,dt=_.samples.length,mt=i.samples.length>0,pt=tt&&dt>0||dt>1;if((!ut||mt)&&(!ht||pt)||this.ISGenerated||tt){if(this.ISGenerated){var gt,vt,St,At;const Bt=this.videoTrackConfig;(Bt&&(_.width!==Bt.width||_.height!==Bt.height||((gt=_.pixelRatio)==null?void 0:gt[0])!==((vt=Bt.pixelRatio)==null?void 0:vt[0])||((St=_.pixelRatio)==null?void 0:St[1])!==((At=Bt.pixelRatio)==null?void 0:At[1]))||!Bt&&pt||this.nextAudioTs===null&&mt)&&this.resetInitSegment()}this.ISGenerated||(st=this.generateIS(i,_,_e,et));const xt=this.isVideoContiguous;let wt=-1,Ot;if(pt&&(wt=findKeyframeIndex(_.samples),!xt&&this.config.forceKeyFrameOnDiscontinuity))if(lt=!0,wt>0){this.warn(`Dropped ${wt} out of ${dt} video samples due to a missing keyframe`);const Bt=this.getVideoStartPts(_.samples);_.samples=_.samples.slice(wt),_.dropped+=wt,ft+=(_.samples[0].pts-Bt)/_.inputTimeScale,Ot=ft}else wt===-1&&(this.warn(`No keyframe found out of ${dt} video samples`),lt=!1);if(this.ISGenerated){if(mt&&pt){const Bt=this.getVideoStartPts(_.samples),Pt=(normalizePts(i.samples[0].pts,Bt)-Bt)/_.inputTimeScale;ct+=Math.max(0,Pt),ft+=Math.max(0,-Pt)}if(mt){if(i.samplerate||(this.warn("regenerate InitSegment as audio detected"),st=this.generateIS(i,_,_e,et)),it=this.remuxAudio(i,ct,this.isAudioContiguous,et,ht||pt||rt===PlaylistLevelType.AUDIO?ft:void 0),pt){const Bt=it?it.endPTS-it.startPTS:0;_.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),st=this.generateIS(i,_,_e,et)),nt=this.remuxVideo(_,ft,xt,Bt)}}else pt&&(nt=this.remuxVideo(_,ft,xt,0));nt&&(nt.firstKeyFrame=wt,nt.independent=wt!==-1,nt.firstKeyFramePTS=Ot)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&($.samples.length&&(ot=flushTextTrackMetadataCueSamples($,_e,this._initPTS,this._initDTS)),j.samples.length&&(at=flushTextTrackUserdataCueSamples(j,_e,this._initPTS))),{audio:it,video:nt,initSegment:st,independent:lt,text:at,id3:ot}}generateIS(i,_,$,j){const _e=i.samples,et=_.samples,tt=this.typeSupported,rt={},nt=this._initPTS;let it=!nt||j,st="audio/mp4",at,ot,lt,ct=-1;if(it&&(at=ot=1/0),i.config&&_e.length){switch(i.timescale=i.samplerate,i.segmentCodec){case"mp3":tt.mpeg?(st="audio/mpeg",i.codec=""):tt.mp3&&(i.codec="mp3");break;case"ac3":i.codec="ac-3";break}rt.audio={id:"audio",container:st,codec:i.codec,initSegment:i.segmentCodec==="mp3"&&tt.mpeg?new Uint8Array(0):MP4.initSegment([i]),metadata:{channelCount:i.channelCount}},it&&(ct=i.id,lt=i.inputTimeScale,!nt||lt!==nt.timescale?at=ot=_e[0].pts-Math.round(lt*$):it=!1)}if(_.sps&&_.pps&&et.length){if(_.timescale=_.inputTimeScale,rt.video={id:"main",container:"video/mp4",codec:_.codec,initSegment:MP4.initSegment([_]),metadata:{width:_.width,height:_.height}},it)if(ct=_.id,lt=_.inputTimeScale,!nt||lt!==nt.timescale){const ft=this.getVideoStartPts(et),ut=Math.round(lt*$);ot=Math.min(ot,normalizePts(et[0].dts,ft)-ut),at=Math.min(at,ft-ut)}else it=!1;this.videoTrackConfig={width:_.width,height:_.height,pixelRatio:_.pixelRatio}}if(Object.keys(rt).length)return this.ISGenerated=!0,it?(nt&&this.warn(`Timestamps at playlist time: ${j?"":"~"}${$} ${at/lt} != initPTS: ${nt.baseTime/nt.timescale} (${nt.baseTime}/${nt.timescale}) trackId: ${nt.trackId}`),this.log(`Found initPTS at playlist time: ${$} offset: ${at/lt} (${at}/${lt}) trackId: ${ct}`),this._initPTS={baseTime:at,timescale:lt,trackId:ct},this._initDTS={baseTime:ot,timescale:lt,trackId:ct}):at=lt=void 0,{tracks:rt,initPTS:at,timescale:lt,trackId:ct}}remuxVideo(i,_,$,j){const _e=i.inputTimeScale,et=i.samples,tt=[],rt=et.length,nt=this._initPTS,it=nt.baseTime*_e/nt.timescale;let st=this.nextVideoTs,at=8,ot=this.videoSampleDuration,lt,ct,ft=Number.POSITIVE_INFINITY,ut=Number.NEGATIVE_INFINITY,ht=!1;if(!$||st===null){const Dt=it+_*_e,Lt=et[0].pts-normalizePts(et[0].dts,et[0].pts);chromeVersion&&st!==null&&Math.abs(Dt-Lt-(st+it))<15e3?$=!0:st=Dt-Lt-it}const dt=st+it;for(let Dt=0;Dt<rt;Dt++){const Lt=et[Dt];Lt.pts=normalizePts(Lt.pts,dt),Lt.dts=normalizePts(Lt.dts,dt),Lt.dts<et[Dt>0?Dt-1:Dt].dts&&(ht=!0)}ht&&et.sort(function(Dt,Lt){const Ct=Dt.dts-Lt.dts,kt=Dt.pts-Lt.pts;return Ct||kt}),lt=et[0].dts,ct=et[et.length-1].dts;const mt=ct-lt,pt=mt?Math.round(mt/(rt-1)):ot||i.inputTimeScale/30;if($){const Dt=lt-dt,Lt=Dt>pt,Ct=Dt<-1;if((Lt||Ct)&&(Lt?this.warn(`${(i.segmentCodec||"").toUpperCase()}: ${toMsFromMpegTsClock(Dt,!0)} ms (${Dt}dts) hole between fragments detected at ${_.toFixed(3)}`):this.warn(`${(i.segmentCodec||"").toUpperCase()}: ${toMsFromMpegTsClock(-Dt,!0)} ms (${Dt}dts) overlapping between fragments detected at ${_.toFixed(3)}`),!Ct||dt>=et[0].pts||chromeVersion)){lt=dt;const kt=et[0].pts-Dt;if(Lt)et[0].dts=lt,et[0].pts=kt;else{let jt=!0;for(let Vt=0;Vt<et.length&&!(et[Vt].dts>kt&&jt);Vt++){const zt=et[Vt].pts;if(et[Vt].dts-=Dt,et[Vt].pts-=Dt,Vt<et.length-1){const qt=et[Vt+1].pts,Wt=et[Vt].pts,ir=qt<=Wt,or=qt<=zt;jt=ir==or}}}this.log(`Video: Initial PTS/DTS adjusted: ${toMsFromMpegTsClock(kt,!0)}/${toMsFromMpegTsClock(lt,!0)}, delta: ${toMsFromMpegTsClock(Dt,!0)} ms`)}}lt=Math.max(0,lt);let yt=0,gt=0,vt=lt;for(let Dt=0;Dt<rt;Dt++){const Lt=et[Dt],Ct=Lt.units,kt=Ct.length;let jt=0;for(let Vt=0;Vt<kt;Vt++)jt+=Ct[Vt].data.length;gt+=jt,yt+=kt,Lt.length=jt,Lt.dts<vt?(Lt.dts=vt,vt+=pt/4|0||1):vt=Lt.dts,ft=Math.min(Lt.pts,ft),ut=Math.max(Lt.pts,ut)}ct=et[rt-1].dts;const St=gt+4*yt+8;let At;try{At=new Uint8Array(St)}catch(Dt){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:Dt,bytes:St,reason:`fail allocating video mdat ${St}`});return}const xt=new DataView(At.buffer);xt.setUint32(0,St),At.set(MP4.types.mdat,4);let wt=!1,Ot=Number.POSITIVE_INFINITY,Bt=Number.POSITIVE_INFINITY,Ft=Number.NEGATIVE_INFINITY,Pt=Number.NEGATIVE_INFINITY;for(let Dt=0;Dt<rt;Dt++){const Lt=et[Dt],Ct=Lt.units;let kt=0;for(let zt=0,qt=Ct.length;zt<qt;zt++){const Wt=Ct[zt],ir=Wt.data,or=Wt.data.byteLength;xt.setUint32(at,or),at+=4,At.set(ir,at),at+=or,kt+=4+or}let jt;if(Dt<rt-1)ot=et[Dt+1].dts-Lt.dts,jt=et[Dt+1].pts-Lt.pts;else{const zt=this.config,qt=Dt>0?Lt.dts-et[Dt-1].dts:pt;if(jt=Dt>0?Lt.pts-et[Dt-1].pts:pt,zt.stretchShortVideoTrack&&this.nextAudioTs!==null){const Wt=Math.floor(zt.maxBufferHole*_e),ir=(j?ft+j*_e:this.nextAudioTs+it)-Lt.pts;ir>Wt?(ot=ir-qt,ot<0?ot=qt:wt=!0,this.log(`It is approximately ${ir/90} ms to the next segment; using duration ${ot/90} ms for the last video frame.`)):ot=qt}else ot=qt}const Vt=Math.round(Lt.pts-Lt.dts);Ot=Math.min(Ot,ot),Ft=Math.max(Ft,ot),Bt=Math.min(Bt,jt),Pt=Math.max(Pt,jt),tt.push(createMp4Sample(Lt.key,ot,kt,Vt))}if(tt.length){if(chromeVersion){if(chromeVersion<70){const Dt=tt[0].flags;Dt.dependsOn=2,Dt.isNonSync=0}}else if(safariWebkitVersion&&Pt-Bt<Ft-Ot&&pt/Ft<.025&&tt[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Dt=lt;for(let Lt=0,Ct=tt.length;Lt<Ct;Lt++){const kt=Dt+tt[Lt].duration,jt=Dt+tt[Lt].cts;if(Lt<Ct-1){const Vt=kt+tt[Lt+1].cts;tt[Lt].duration=Vt-jt}else tt[Lt].duration=Lt?tt[Lt-1].duration:pt;tt[Lt].cts=0,Dt=kt}}}ot=wt||!ot?pt:ot;const Rt=ct+ot;this.nextVideoTs=st=Rt-it,this.videoSampleDuration=ot,this.isVideoContiguous=!0;const Mt={data1:MP4.moof(i.sequenceNumber++,lt,_extends(i,{samples:tt})),data2:At,startPTS:(ft-it)/_e,endPTS:(ut+ot-it)/_e,startDTS:(lt-it)/_e,endDTS:st/_e,type:"video",hasAudio:!1,hasVideo:!0,nb:tt.length,dropped:i.dropped};return i.samples=[],i.dropped=0,Mt}getSamplesPerFrame(i){switch(i.segmentCodec){case"mp3":return MPEG_AUDIO_SAMPLE_PER_FRAME;case"ac3":return AC3_SAMPLES_PER_FRAME;default:return AAC_SAMPLES_PER_FRAME}}remuxAudio(i,_,$,j,_e){const et=i.inputTimeScale,tt=i.samplerate?i.samplerate:et,rt=et/tt,nt=this.getSamplesPerFrame(i),it=nt*rt,st=this._initPTS,at=i.segmentCodec==="mp3"&&this.typeSupported.mpeg,ot=[],lt=_e!==void 0;let ct=i.samples,ft=at?0:8,ut=this.nextAudioTs||-1;const ht=st.baseTime*et/st.timescale,dt=ht+_*et;if(this.isAudioContiguous=$=$||ct.length&&ut>0&&(j&&Math.abs(dt-(ut+ht))<9e3||Math.abs(normalizePts(ct[0].pts,dt)-(ut+ht))<20*it),ct.forEach(function(Pt){Pt.pts=normalizePts(Pt.pts,dt)}),!$||ut<0){if(ct=ct.filter(Pt=>Pt.pts>=0),!ct.length)return;_e===0?ut=0:j&&!lt?ut=Math.max(0,dt-ht):ut=ct[0].pts-ht}if(i.segmentCodec==="aac"){const Pt=this.config.maxAudioFramesDrift;for(let Rt=0,Et=ut+ht;Rt<ct.length;Rt++){const _t=ct[Rt],Mt=_t.pts,Dt=Mt-Et,Lt=Math.abs(1e3*Dt/et);if(Dt<=-Pt*it&&lt)Rt===0&&(this.warn(`Audio frame @ ${(Mt/et).toFixed(3)}s overlaps marker by ${Math.round(1e3*Dt/et)} ms.`),this.nextAudioTs=ut=Mt-ht,Et=Mt);else if(Dt>=Pt*it&&Lt<MAX_SILENT_FRAME_DURATION&&lt){let Ct=Math.round(Dt/it);for(Et=Mt-Ct*it;Et<0&&Ct&&it;)Ct--,Et+=it;Rt===0&&(this.nextAudioTs=ut=Et-ht),this.warn(`Injecting ${Ct} audio frames @ ${((Et-ht)/et).toFixed(3)}s due to ${Math.round(1e3*Dt/et)} ms gap.`);for(let kt=0;kt<Ct;kt++){let jt=AAC.getSilentFrame(i.parsedCodec||i.manifestCodec||i.codec,i.channelCount);jt||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),jt=_t.unit.subarray()),ct.splice(Rt,0,{unit:jt,pts:Et}),Et+=it,Rt++}}_t.pts=Et,Et+=it}}let mt=null,pt=null,yt,gt=0,vt=ct.length;for(;vt--;)gt+=ct[vt].unit.byteLength;for(let Pt=0,Rt=ct.length;Pt<Rt;Pt++){const Et=ct[Pt],_t=Et.unit;let Mt=Et.pts;if(pt!==null){const Lt=ot[Pt-1];Lt.duration=Math.round((Mt-pt)/rt)}else if($&&i.segmentCodec==="aac"&&(Mt=ut+ht),mt=Mt,gt>0){gt+=ft;try{yt=new Uint8Array(gt)}catch(Lt){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:Lt,bytes:gt,reason:`fail allocating audio mdat ${gt}`});return}at||(new DataView(yt.buffer).setUint32(0,gt),yt.set(MP4.types.mdat,4))}else return;yt.set(_t,ft);const Dt=_t.byteLength;ft+=Dt,ot.push(createMp4Sample(!0,nt,Dt,0)),pt=Mt}const St=ot.length;if(!St)return;const At=ot[ot.length-1];ut=pt-ht,this.nextAudioTs=ut+rt*At.duration;const xt=at?new Uint8Array(0):MP4.moof(i.sequenceNumber++,mt/rt,_extends({},i,{samples:ot}));i.samples=[];const wt=(mt-ht)/et,Ot=ut/et,Ft={data1:xt,data2:yt,startPTS:wt,endPTS:Ot,startDTS:wt,endDTS:Ot,type:"audio",hasAudio:!0,hasVideo:!1,nb:St};return this.isAudioContiguous=!0,Ft}}function normalizePts(o,i){let _;if(i===null)return o;for(i<o?_=-8589934592:_=8589934592;Math.abs(o-i)>4294967296;)o+=_;return o}function findKeyframeIndex(o){for(let i=0;i<o.length;i++)if(o[i].key)return i;return-1}function flushTextTrackMetadataCueSamples(o,i,_,$){const j=o.samples.length;if(!j)return;const _e=o.inputTimeScale;for(let tt=0;tt<j;tt++){const rt=o.samples[tt];rt.pts=normalizePts(rt.pts-_.baseTime*_e/_.timescale,i*_e)/_e,rt.dts=normalizePts(rt.dts-$.baseTime*_e/$.timescale,i*_e)/_e}const et=o.samples;return o.samples=[],{samples:et}}function flushTextTrackUserdataCueSamples(o,i,_){const $=o.samples.length;if(!$)return;const j=o.inputTimeScale;for(let et=0;et<$;et++){const tt=o.samples[et];tt.pts=normalizePts(tt.pts-_.baseTime*j/_.timescale,i*j)/j}o.samples.sort((et,tt)=>et.pts-tt.pts);const _e=o.samples;return o.samples=[],{samples:_e}}class PassThroughRemuxer extends Logger$1{constructor(i,_,$,j){super("passthrough-remuxer",j),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(i){this.lastEndTime=null;const _=this.initPTS;_&&i&&_.baseTime===i.baseTime&&_.timescale===i.timescale||(this.initPTS=i)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(i,_,$,j){this.audioCodec=_,this.videoCodec=$,this.generateInitSegment(i,j),this.emitInitSegment=!0}generateInitSegment(i,_){let{audioCodec:$,videoCodec:j}=this;if(!(i!=null&&i.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:_e,video:et}=this.initData=parseInitSegment(i);if(_)patchEncyptionData(i,_);else{const rt=_e||et;rt!=null&&rt.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${rt.codec}")!`)}_e&&($=getParsedTrackCodec(_e,ElementaryStreamTypes.AUDIO,this)),et&&(j=getParsedTrackCodec(et,ElementaryStreamTypes.VIDEO,this));const tt={};_e&&et?tt.audiovideo={container:"video/mp4",codec:$+","+j,supplemental:et.supplemental,encrypted:et.encrypted,initSegment:i,id:"main"}:_e?tt.audio={container:"audio/mp4",codec:$,encrypted:_e.encrypted,initSegment:i,id:"audio"}:et?tt.video={container:"video/mp4",codec:j,supplemental:et.supplemental,encrypted:et.encrypted,initSegment:i,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=tt}remux(i,_,$,j,_e,et){var tt,rt;let{initPTS:nt,lastEndTime:it}=this;const st={audio:void 0,video:void 0,text:j,id3:$,initSegment:void 0};isFiniteNumber(it)||(it=this.lastEndTime=_e||0);const at=_.samples;if(!at.length)return st;const ot={initPTS:void 0,timescale:void 0,trackId:void 0};let lt=this.initData;if((tt=lt)!=null&&tt.length||(this.generateInitSegment(at),lt=this.initData),!((rt=lt)!=null&&rt.length))return this.warn("Failed to generate initSegment."),st;this.emitInitSegment&&(ot.tracks=this.initTracks,this.emitInitSegment=!1);const ct=getSampleData(at,lt,this),ft=lt.audio?ct[lt.audio.id]:null,ut=lt.video?ct[lt.video.id]:null,ht=toStartEndOrDefault(ut,1/0),dt=toStartEndOrDefault(ft,1/0),mt=toStartEndOrDefault(ut,0,!0),pt=toStartEndOrDefault(ft,0,!0);let yt=_e,gt=0;const vt=ft&&(!ut||!nt&&dt<ht||nt&&nt.trackId===lt.audio.id),St=vt?ft:ut;if(St){const Et=St.timescale,_t=St.start-_e*Et,Mt=vt?lt.audio.id:lt.video.id;yt=St.start/Et,gt=vt?pt-dt:mt-ht,(et||!nt)&&(isInvalidInitPts(nt,yt,_e,gt)||Et!==nt.timescale)&&(nt&&this.warn(`Timestamps at playlist time: ${et?"":"~"}${_e} ${_t/Et} != initPTS: ${nt.baseTime/nt.timescale} (${nt.baseTime}/${nt.timescale}) trackId: ${nt.trackId}`),this.log(`Found initPTS at playlist time: ${_e} offset: ${yt-_e} (${_t}/${Et}) trackId: ${Mt}`),nt=null,ot.initPTS=_t,ot.timescale=Et,ot.trackId=Mt)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${_e}`);nt?(ot.initPTS=nt.baseTime,ot.timescale=nt.timescale,ot.trackId=nt.trackId):((!ot.timescale||ot.trackId===void 0||ot.initPTS===void 0)&&(this.warn("Could not set initPTS"),ot.initPTS=yt,ot.timescale=1,ot.trackId=-1),this.initPTS=nt={baseTime:ot.initPTS,timescale:ot.timescale,trackId:ot.trackId});const At=yt-nt.baseTime/nt.timescale,xt=At+gt;gt>0?this.lastEndTime=xt:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const wt=!!lt.audio,Ot=!!lt.video;let Bt="";wt&&(Bt+="audio"),Ot&&(Bt+="video");const Ft=(lt.audio?lt.audio.encrypted:!1)||(lt.video?lt.video.encrypted:!1),Pt={data1:at,startPTS:At,startDTS:At,endPTS:xt,endDTS:xt,type:Bt,hasAudio:wt,hasVideo:Ot,nb:1,dropped:0,encrypted:Ft};st.audio=wt&&!Ot?Pt:void 0,st.video=Ot?Pt:void 0;const Rt=ut==null?void 0:ut.sampleCount;if(Rt){const Et=ut.keyFrameIndex,_t=Et!==-1;Pt.nb=Rt,Pt.dropped=Et===0||this.isVideoContiguous?0:_t?Et:Rt,Pt.independent=_t,Pt.firstKeyFrame=Et,_t&&ut.keyFrameStart&&(Pt.firstKeyFramePTS=(ut.keyFrameStart-nt.baseTime)/nt.timescale),this.isVideoContiguous||(st.independent=_t),this.isVideoContiguous||(this.isVideoContiguous=_t),Pt.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${Et}/${Rt} dropped: ${Pt.dropped} start: ${Pt.firstKeyFramePTS||"NA"}`)}return st.initSegment=ot,st.id3=flushTextTrackMetadataCueSamples($,_e,nt,nt),j.samples.length&&(st.text=flushTextTrackUserdataCueSamples(j,_e,nt)),st}}function toStartEndOrDefault(o,i,_=!1){return(o==null?void 0:o.start)!==void 0?(o.start+(_?o.duration:0))/o.timescale:i}function isInvalidInitPts(o,i,_,$){if(o===null)return!0;const j=Math.max($,1),_e=i-o.baseTime/o.timescale;return Math.abs(_e-_)>j}function getParsedTrackCodec(o,i,_){const $=o.codec;return $&&$.length>4?$:i===ElementaryStreamTypes.AUDIO?$==="ec-3"||$==="ac-3"||$==="alac"?$:$==="fLaC"||$==="Opus"?getCodecCompatibleName($,!1):(_.warn(`Unhandled audio codec "${$}" in mp4 MAP`),$||"mp4a"):(_.warn(`Unhandled video codec "${$}" in mp4 MAP`),$||"avc1")}let now;try{now=self.performance.now.bind(self.performance)}catch(o){now=Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];muxConfig.splice(2,0,{demux:AC3Demuxer,remux:MP4Remuxer});class Transmuxer{constructor(i,_,$,j,_e,et){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=i,this.typeSupported=_,this.config=$,this.id=_e,this.logger=et}configure(i){this.transmuxConfig=i,this.decrypter&&this.decrypter.reset()}push(i,_,$,j){const _e=$.transmuxing;_e.executeStart=now();let et=new Uint8Array(i);const{currentTransmuxState:tt,transmuxConfig:rt}=this;j&&(this.currentTransmuxState=j);const{contiguous:nt,discontinuity:it,trackSwitch:st,accurateTimeOffset:at,timeOffset:ot,initSegmentChange:lt}=j||tt,{audioCodec:ct,videoCodec:ft,defaultInitPts:ut,duration:ht,initSegmentData:dt}=rt,mt=getEncryptionType(et,_);if(mt&&isFullSegmentEncryption(mt.method)){const vt=this.getDecrypter(),St=getAesModeFromFullSegmentMethod(mt.method);if(vt.isSync()){let At=vt.softwareDecrypt(et,mt.key.buffer,mt.iv.buffer,St);if($.part>-1){const wt=vt.flush();At=wt&&wt.buffer}if(!At)return _e.executeEnd=now(),emptyResult($);et=new Uint8Array(At)}else return this.asyncResult=!0,this.decryptionPromise=vt.webCryptoDecrypt(et,mt.key.buffer,mt.iv.buffer,St).then(At=>{const xt=this.push(At,null,$);return this.decryptionPromise=null,xt}),this.decryptionPromise}const pt=this.needsProbing(it,st);if(pt){const vt=this.configureTransmuxer(et);if(vt)return this.logger.warn(`[transmuxer] ${vt.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:vt,reason:vt.message}),_e.executeEnd=now(),emptyResult($)}(it||st||lt||pt)&&this.resetInitSegment(dt,ct,ft,ht,_),(it||lt||pt)&&this.resetInitialTimestamp(ut),nt||this.resetContiguity();const yt=this.transmux(et,mt,ot,at,$);this.asyncResult=isPromise(yt);const gt=this.currentTransmuxState;return gt.contiguous=!0,gt.discontinuity=!1,gt.trackSwitch=!1,_e.executeEnd=now(),yt}flush(i){const _=i.transmuxing;_.executeStart=now();const{decrypter:$,currentTransmuxState:j,decryptionPromise:_e}=this;if(_e)return this.asyncResult=!0,_e.then(()=>this.flush(i));const et=[],{timeOffset:tt}=j;if($){const st=$.flush();st&&et.push(this.push(st.buffer,null,i))}const{demuxer:rt,remuxer:nt}=this;if(!rt||!nt){_.executeEnd=now();const st=[emptyResult(i)];return this.asyncResult?Promise.resolve(st):st}const it=rt.flush(tt);return isPromise(it)?(this.asyncResult=!0,it.then(st=>(this.flushRemux(et,st,i),et))):(this.flushRemux(et,it,i),this.asyncResult?Promise.resolve(et):et)}flushRemux(i,_,$){const{audioTrack:j,videoTrack:_e,id3Track:et,textTrack:tt}=_,{accurateTimeOffset:rt,timeOffset:nt}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${$.sn}${$.part>-1?" part: "+$.part:""} of ${this.id===PlaylistLevelType.MAIN?"level":"track"} ${$.level}`);const it=this.remuxer.remux(j,_e,et,tt,nt,rt,!0,this.id);i.push({remuxResult:it,chunkMeta:$}),$.transmuxing.executeEnd=now()}resetInitialTimestamp(i){const{demuxer:_,remuxer:$}=this;!_||!$||(_.resetTimeStamp(i),$.resetTimeStamp(i))}resetContiguity(){const{demuxer:i,remuxer:_}=this;!i||!_||(i.resetContiguity(),_.resetNextTimestamp())}resetInitSegment(i,_,$,j,_e){const{demuxer:et,remuxer:tt}=this;!et||!tt||(et.resetInitSegment(i,_,$,j),tt.resetInitSegment(i,_,$,_e))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(i,_,$,j,_e){let et;return _&&_.method==="SAMPLE-AES"?et=this.transmuxSampleAes(i,_,$,j,_e):et=this.transmuxUnencrypted(i,$,j,_e),et}transmuxUnencrypted(i,_,$,j){const{audioTrack:_e,videoTrack:et,id3Track:tt,textTrack:rt}=this.demuxer.demux(i,_,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(_e,et,tt,rt,_,$,!1,this.id),chunkMeta:j}}transmuxSampleAes(i,_,$,j,_e){return this.demuxer.demuxSampleAes(i,_,$).then(et=>({remuxResult:this.remuxer.remux(et.audioTrack,et.videoTrack,et.id3Track,et.textTrack,$,j,!1,this.id),chunkMeta:_e}))}configureTransmuxer(i){const{config:_,observer:$,typeSupported:j}=this;let _e;for(let st=0,at=muxConfig.length;st<at;st++){var et;if((et=muxConfig[st].demux)!=null&&et.probe(i,this.logger)){_e=muxConfig[st];break}}if(!_e)return new Error("Failed to find demuxer by probing fragment data");const tt=this.demuxer,rt=this.remuxer,nt=_e.remux,it=_e.demux;(!rt||!(rt instanceof nt))&&(this.remuxer=new nt($,_,j,this.logger)),(!tt||!(tt instanceof it))&&(this.demuxer=new it($,_,j,this.logger),this.probe=it.probe)}needsProbing(i,_){return!this.demuxer||!this.remuxer||i||_}getDecrypter(){let i=this.decrypter;return i||(i=this.decrypter=new Decrypter(this.config)),i}}function getEncryptionType(o,i){let _=null;return o.byteLength>0&&(i==null?void 0:i.key)!=null&&i.iv!==null&&i.method!=null&&(_=i),_}const emptyResult=o=>({remuxResult:{},chunkMeta:o});function isPromise(o){return"then"in o&&o.then instanceof Function}class TransmuxConfig{constructor(i,_,$,j,_e){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=i,this.videoCodec=_,this.initSegmentData=$,this.duration=j,this.defaultInitPts=_e||null}}class TransmuxState{constructor(i,_,$,j,_e,et){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=i,this.contiguous=_,this.accurateTimeOffset=$,this.trackSwitch=j,this.timeOffset=_e,this.initSegmentChange=et}}let transmuxerInstanceCount=0;class TransmuxerInterface{constructor(i,_,$,j){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=transmuxerInstanceCount++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=rt=>{const nt=rt.data,it=this.hls;if(!(!it||!(nt!=null&&nt.event)||nt.instanceNo!==this.instanceNo))switch(nt.event){case"init":{var st;const at=(st=this.workerContext)==null?void 0:st.objectURL;at&&self.URL.revokeObjectURL(at);break}case"transmuxComplete":{this.handleTransmuxComplete(nt.data);break}case"flush":{this.onFlush(nt.data);break}case"workerLog":{it.logger[nt.data.logType]&&it.logger[nt.data.logType](nt.data.message);break}default:{nt.data=nt.data||{},nt.data.frag=this.frag,nt.data.part=this.part,nt.data.id=this.id,it.trigger(nt.event,nt.data);break}}},this.onWorkerError=rt=>{if(!this.hls)return;const nt=new Error(`${rt.message}  (${rt.filename}:${rt.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:nt})};const _e=i.config;this.hls=i,this.id=_,this.useWorker=!!_e.enableWorker,this.onTransmuxComplete=$,this.onFlush=j;const et=(rt,nt)=>{nt=nt||{},nt.frag=this.frag||void 0,rt===Events.ERROR&&(nt=nt,nt.parent=this.id,nt.part=this.part,this.error=nt.error),this.hls.trigger(rt,nt)};this.observer=new EventEmitter$1,this.observer.on(Events.FRAG_DECRYPTED,et),this.observer.on(Events.ERROR,et);const tt=getM2TSSupportedAudioTypes(_e.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const rt=this.hls.logger;if(_e.workerPath||hasUMDWorker()){try{_e.workerPath?(rt.log(`loading Web Worker ${_e.workerPath} for "${_}"`),this.workerContext=loadWorker(_e.workerPath)):(rt.log(`injecting Web Worker for "${_}"`),this.workerContext=injectWorker());const{worker:it}=this.workerContext;it.addEventListener("message",this.onWorkerMessage),it.addEventListener("error",this.onWorkerError),it.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:tt,id:_,config:stringify(_e)})}catch(it){rt.warn(`Error setting up "${_}" Web Worker, fallback to inline`,it),this.terminateWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,tt,_e,"",_,i.logger)}return}}this.transmuxer=new Transmuxer(this.observer,tt,_e,"",_,i.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const i=this.instanceNo;this.instanceNo=transmuxerInstanceCount++;const _=this.hls.config,$=getM2TSSupportedAudioTypes(_.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:i,typeSupported:$,id:this.id,config:stringify(_)})}}terminateWorker(){if(this.workerContext){const{worker:i}=this.workerContext;this.workerContext=null,i.removeEventListener("message",this.onWorkerMessage),i.removeEventListener("error",this.onWorkerError),removeWorkerFromStore(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const _=this.transmuxer;_&&(_.destroy(),this.transmuxer=null)}const i=this.observer;i&&i.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(i,_,$,j,_e,et,tt,rt,nt,it){var st,at;nt.transmuxing.start=self.performance.now();const{instanceNo:ot,transmuxer:lt}=this,ct=et?et.start:_e.start,ft=_e.decryptdata,ut=this.frag,ht=!(ut&&_e.cc===ut.cc),dt=!(ut&&nt.level===ut.level),mt=ut?nt.sn-ut.sn:-1,pt=this.part?nt.part-this.part.index:-1,yt=mt===0&&nt.id>1&&nt.id===(ut==null?void 0:ut.stats.chunkCount),gt=!dt&&(mt===1||mt===0&&(pt===1||yt&&pt<=0)),vt=self.performance.now();(dt||mt||_e.stats.parsing.start===0)&&(_e.stats.parsing.start=vt),et&&(pt||!gt)&&(et.stats.parsing.start=vt);const St=!(ut&&((st=_e.initSegment)==null?void 0:st.url)===((at=ut.initSegment)==null?void 0:at.url)),At=new TransmuxState(ht,gt,rt,dt,ct,St);if(!gt||ht||St){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${_e.type} sn: ${nt.sn}${nt.part>-1?" part: "+nt.part:""} ${this.id===PlaylistLevelType.MAIN?"level":"track"}: ${nt.level} id: ${nt.id}
        discontinuity: ${ht}
        trackSwitch: ${dt}
        contiguous: ${gt}
        accurateTimeOffset: ${rt}
        timeOffset: ${ct}
        initSegmentChange: ${St}`);const xt=new TransmuxConfig($,j,_,tt,it);this.configureTransmuxer(xt)}if(this.frag=_e,this.part=et,this.workerContext)this.workerContext.worker.postMessage({instanceNo:ot,cmd:"demux",data:i,decryptdata:ft,chunkMeta:nt,state:At},i instanceof ArrayBuffer?[i]:[]);else if(lt){const xt=lt.push(i,ft,nt,At);isPromise(xt)?xt.then(wt=>{this.handleTransmuxComplete(wt)}).catch(wt=>{this.transmuxerError(wt,nt,"transmuxer-interface push error")}):this.handleTransmuxComplete(xt)}}flush(i){i.transmuxing.start=self.performance.now();const{instanceNo:_,transmuxer:$}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:_,cmd:"flush",chunkMeta:i});else if($){const j=$.flush(i);isPromise(j)?j.then(_e=>{this.handleFlushResult(_e,i)}).catch(_e=>{this.transmuxerError(_e,i,"transmuxer-interface flush error")}):this.handleFlushResult(j,i)}}transmuxerError(i,_,$){this.hls&&(this.error=i,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:_,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:i,err:i,reason:$}))}handleFlushResult(i,_){i.forEach($=>{this.handleTransmuxComplete($)}),this.onFlush(_)}configureTransmuxer(i){const{instanceNo:_,transmuxer:$}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:_,cmd:"configure",config:i}):$&&$.configure(i)}handleTransmuxComplete(i){i.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(i)}}const TICK_INTERVAL$3=100;class AudioStreamController extends BaseStreamController{constructor(i,_,$){super(i,_,$,"audio-stream-controller",PlaylistLevelType.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:i}=this;i.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),i.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.on(Events.BUFFER_RESET,this.onBufferReset,this),i.on(Events.BUFFER_CREATED,this.onBufferCreated,this),i.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(Events.FRAG_LOADING,this.onFragLoading,this),i.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:i}=this;i&&(super.unregisterListeners(),i.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),i.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.off(Events.BUFFER_RESET,this.onBufferReset,this),i.off(Events.BUFFER_CREATED,this.onBufferCreated,this),i.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.off(Events.FRAG_LOADING,this.onFragLoading,this),i.off(Events.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(i,{frag:_,id:$,initPTS:j,timescale:_e,trackId:et}){if($===PlaylistLevelType.MAIN){const tt=_.cc,rt=this.fragCurrent;if(this.initPTS[tt]={baseTime:j,timescale:_e,trackId:et},this.log(`InitPTS for cc: ${tt} found from main: ${j/_e} (${j}/${_e}) trackId: ${et}`),this.mainAnchor=_,this.state===State.WAITING_INIT_PTS){const nt=this.waitingData;(!nt&&!this.loadingParts||nt&&nt.frag.cc!==tt)&&this.syncWithAnchor(_,nt==null?void 0:nt.frag)}else!this.hls.hasEnoughToStart&&rt&&rt.cc!==tt?(rt.abortRequests(),this.syncWithAnchor(_,rt)):this.state===State.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(i,_){var $;const j=(($=this.mainFragLoading)==null?void 0:$.frag)||null;if(_&&(j==null?void 0:j.cc)===_.cc)return;const _e=(j||i).cc,et=this.getLevelDetails(),tt=this.getLoadPosition(),rt=findNearestWithCC(et,_e,tt);rt&&(this.log(`Syncing with main frag at ${rt.start} cc ${rt.cc}`),this.startFragRequested=!1,this.nextLoadPosition=rt.start,this.resetLoadingState(),this.state===State.IDLE&&this.doTickIdle())}startLoad(i,_){if(!this.levels){this.startPosition=i,this.state=State.STOPPED;return}const $=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$3),$>0&&i===-1?(this.log(`Override startPosition with lastCurrentTime @${$.toFixed(3)}`),i=$,this.state=State.IDLE):this.state=State.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=i+this.timelineOffset,this.startPosition=_?-1:i,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{const{levels:i,trackId:_}=this,$=i==null?void 0:i[_],j=$==null?void 0:$.details;if(j&&!this.waitForLive($)){if(this.waitForCdnTuneIn(j))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case State.WAITING_INIT_PTS:{const i=this.waitingData;if(i){const{frag:_,part:$,cache:j,complete:_e}=i,et=this.mainAnchor;if(this.initPTS[_.cc]!==void 0){this.waitingData=null,this.state=State.FRAG_LOADING;const tt=j.flush().buffer,rt={frag:_,part:$,payload:tt,networkDetails:null};this._handleFragmentLoadProgress(rt),_e&&super._handleFragmentLoadComplete(rt)}else et&&et.cc!==i.frag.cc&&this.syncWithAnchor(et,i.frag)}else this.state=State.IDLE}}this.onTickEnd()}resetLoadingState(){const i=this.waitingData;i&&(this.fragmentTracker.removeFragment(i.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:i}=this;i!=null&&i.readyState&&(this.lastCurrentTime=i.currentTime)}doTickIdle(){var i;const{hls:_,levels:$,media:j,trackId:_e}=this,et=_.config;if(!this.buffering||!j&&!this.primaryPrefetch&&(this.startFragRequested||!et.startFragPrefetch)||!($!=null&&$[_e]))return;const tt=$[_e],rt=tt.details;if(!rt||this.waitForLive(tt)||this.waitForCdnTuneIn(rt)){this.state=State.WAITING_TRACK,this.startFragRequested=!1;return}const nt=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&nt&&(this.bufferFlushed=!1,this.afterBufferFlushed(nt,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const it=this.getFwdBufferInfo(nt,PlaylistLevelType.AUDIO);if(it===null)return;if(!this.switchingTrack&&this._streamEnded(it,rt)){_.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const st=it.len,at=_.maxBufferLength,ot=rt.fragments,lt=ot[0].start,ct=this.getLoadPosition(),ft=this.flushing?ct:it.end;if(this.switchingTrack&&j){const dt=ct;rt.PTSKnown&&dt<lt&&(it.end>lt||it.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),j.currentTime=lt+.05)}if(st>=at&&!this.switchingTrack&&ft<ot[ot.length-1].start)return;let ut=this.getNextFragment(ft,rt);if(ut&&this.isLoopLoading(ut,ft)&&(ut=this.getNextFragmentLoopLoading(ut,rt,it,PlaylistLevelType.MAIN,at)),!ut){this.bufferFlushed=!0;return}let ht=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(!this.audioOnly&&this.startFragRequested&&ht&&isMediaFragment(ut)&&!ut.endList&&(!rt.live||!this.loadingParts&&ft<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(ht)===FragmentState.OK&&(this.mainFragLoading=ht=null),ht&&isMediaFragment(ht))){if(ut.start>ht.end){const mt=this.fragmentTracker.getFragAtPos(ft,PlaylistLevelType.MAIN);mt&&mt.end>ht.end&&(ht=mt,this.mainFragLoading={frag:mt,targetBufferTime:null})}if(ut.start>ht.end)return}this.loadFragment(ut,tt,ft)}onMediaDetaching(i,_){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(i,_)}onAudioTracksUpdated(i,{audioTracks:_}){this.resetTransmuxer(),this.levels=_.map($=>new Level($))}onAudioTrackSwitching(i,_){const $=!!_.url;this.trackId=_.id;const{fragCurrent:j}=this;j&&(j.abortRequests(),this.removeUnbufferedFrags(j.start)),this.resetLoadingState(),$?(this.switchingTrack=_,this.flushAudioIfNeeded(_),this.state!==State.STOPPED&&(this.setInterval(TICK_INTERVAL$3),this.state=State.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=_,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(i,_){this.mainDetails=_.details;const $=this.cachedTrackLoadedData;$&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(Events.AUDIO_TRACK_LOADED,$))}onAudioTrackLoaded(i,_){var $;const{levels:j}=this,{details:_e,id:et,groupId:tt,track:rt}=_;if(!j){this.warn(`Audio tracks reset while loading track ${et} "${rt.name}" of "${tt}"`);return}const nt=this.mainDetails;if(!nt||_e.endCC>nt.endCC||nt.expired){this.cachedTrackLoadedData=_,this.state!==State.STOPPED&&(this.state=State.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${et} "${rt.name}" of "${tt}" loaded [${_e.startSN},${_e.endSN}]${_e.lastPartSn?`[part-${_e.lastPartSn}-${_e.lastPartIndex}]`:""},duration:${_e.totalduration}`);const it=j[et];let st=0;if(_e.live||($=it.details)!=null&&$.live){if(this.checkLiveUpdate(_e),_e.deltaUpdateFailed)return;if(it.details){var at;st=this.alignPlaylists(_e,it.details,(at=this.levelLastLoaded)==null?void 0:at.details)}_e.alignedSliding||(alignDiscontinuities(_e,nt),_e.alignedSliding||alignMediaPlaylistByPDT(_e,nt),st=_e.fragmentStart)}it.details=_e,this.levelLastLoaded=it,this.startFragRequested||this.setStartPosition(nt,st),this.hls.trigger(Events.AUDIO_TRACK_UPDATED,{details:_e,id:et,groupId:_.groupId}),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(_e)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(i){var _;const $=i.frag,{part:j,payload:_e}=i,{config:et,trackId:tt,levels:rt}=this;if(!rt){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${$.sn} of level ${$.level} will not be buffered`);return}const nt=rt[tt];if(!nt){this.warn("Audio track is undefined on fragment load progress");return}const it=nt.details;if(!it){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags($.start);return}const st=et.defaultAudioCodec||nt.audioCodec||"mp4a.40.2";let at=this.transmuxer;at||(at=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const ot=this.initPTS[$.cc],lt=(_=$.initSegment)==null?void 0:_.data;if(ot!==void 0){const ft=j?j.index:-1,ut=ft!==-1,ht=new ChunkMetadata($.level,$.sn,$.stats.chunkCount,_e.byteLength,ft,ut);at.push(_e,lt,st,"",$,j,it.totalduration,!1,ht,ot)}else{this.log(`Unknown video PTS for cc ${$.cc}, waiting for video PTS before demuxing audio frag ${$.sn} of [${it.startSN} ,${it.endSN}],track ${tt}`);const{cache:ct}=this.waitingData=this.waitingData||{frag:$,part:j,cache:new ChunkCache,complete:!1};ct.push(new Uint8Array(_e)),this.state!==State.STOPPED&&(this.state=State.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(i){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(i)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(i,_){this.bufferFlushed=this.flushing=!1;const $=_.tracks.audio;$&&(this.mediaBuffer=$.buffer||null)}onFragLoading(i,_){!this.audioOnly&&_.frag.type===PlaylistLevelType.MAIN&&isMediaFragment(_.frag)&&(this.mainFragLoading=_,this.state===State.IDLE&&this.tick())}onFragBuffered(i,_){const{frag:$,part:j}=_;if($.type!==PlaylistLevelType.AUDIO){!this.audioOnly&&$.type===PlaylistLevelType.MAIN&&!$.elementaryStreams.video&&!$.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged($)){this.warn(`Fragment ${$.sn}${j?" p: "+j.index:""} of level ${$.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(isMediaFragment($)){this.fragPrevious=$;const _e=this.switchingTrack;_e&&(this.bufferedTrack=_e,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},_e)))}this.fragBufferedComplete($,j),this.media&&this.tick()}onError(i,_){var $;if(_.fatal){this.state=State.ERROR;return}switch(_.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,_);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!_.levelRetry&&this.state===State.WAITING_TRACK&&(($=_.context)==null?void 0:$.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(_.parent!=="audio")return;this.reduceLengthAndFlushBuffer(_)||this.resetLoadingState();break;case ErrorDetails.BUFFER_FULL_ERROR:if(_.parent!=="audio")return;this.reduceLengthAndFlushBuffer(_)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(_);break}}onBufferFlushing(i,{type:_}){_!==ElementaryStreamTypes.VIDEO&&(this.flushing=!0)}onBufferFlushed(i,{type:_}){if(_!==ElementaryStreamTypes.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE);const $=this.mediaBuffer||this.media;$&&(this.afterBufferFlushed($,_,PlaylistLevelType.AUDIO),this.tick())}}_handleTransmuxComplete(i){var _;const $="audio",{hls:j}=this,{remuxResult:_e,chunkMeta:et}=i,tt=this.getCurrentContext(et);if(!tt){this.resetWhenMissingContext(et);return}const{frag:rt,part:nt,level:it}=tt,{details:st}=it,{audio:at,text:ot,id3:lt,initSegment:ct}=_e;if(this.fragContextChanged(rt)||!st){this.fragmentTracker.removeFragment(rt);return}if(this.state=State.PARSING,this.switchingTrack&&at&&this.completeAudioSwitch(this.switchingTrack),ct!=null&&ct.tracks){const ft=rt.initSegment||rt;if(this.unhandledEncryptionError(ct,rt))return;this._bufferInitSegment(it,ct.tracks,ft,et),j.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:ft,id:$,tracks:ct.tracks})}if(at){const{startPTS:ft,endPTS:ut,startDTS:ht,endDTS:dt}=at;nt&&(nt.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:ft,endPTS:ut,startDTS:ht,endDTS:dt}),rt.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,ft,ut,ht,dt),this.bufferFragmentData(at,rt,nt,et)}if(lt!=null&&(_=lt.samples)!=null&&_.length){const ft=_extends({id:$,frag:rt,details:st},lt);j.trigger(Events.FRAG_PARSING_METADATA,ft)}if(ot){const ft=_extends({id:$,frag:rt,details:st},ot);j.trigger(Events.FRAG_PARSING_USERDATA,ft)}}_bufferInitSegment(i,_,$,j){if(this.state!==State.PARSING||(_.video&&delete _.video,_.audiovideo&&delete _.audiovideo,!_.audio))return;const _e=_.audio;_e.id=PlaylistLevelType.AUDIO;const et=i.audioCodec;this.log(`Init audio buffer, container:${_e.container}, codecs[level/parsed]=[${et}/${_e.codec}]`),et&&et.split(",").length===1&&(_e.levelCodec=et),this.hls.trigger(Events.BUFFER_CODECS,_);const tt=_e.initSegment;if(tt!=null&&tt.byteLength){const rt={type:"audio",frag:$,part:null,chunkMeta:j,parent:$.type,data:tt};this.hls.trigger(Events.BUFFER_APPENDING,rt)}this.tickImmediate()}loadFragment(i,_,$){const j=this.fragmentTracker.getState(i);if(this.switchingTrack||j===FragmentState.NOT_LOADED||j===FragmentState.PARTIAL){var _e;if(!isMediaFragment(i))this._loadInitSegment(i,_);else if((_e=_.details)!=null&&_e.live&&!this.initPTS[i.cc]){this.log(`Waiting for video PTS in continuity counter ${i.cc} of live stream before loading audio fragment ${i.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS;const et=this.mainDetails;et&&et.fragmentStart!==_.details.fragmentStart&&alignMediaPlaylistByPDT(_.details,et)}else super.loadFragment(i,_,$)}else this.clearTrackerIfNeeded(i)}flushAudioIfNeeded(i){if(this.media&&this.bufferedTrack){const{name:_,lang:$,assocLang:j,characteristics:_e,audioCodec:et,channels:tt}=this.bufferedTrack;matchesOption({name:_,lang:$,assocLang:j,characteristics:_e,audioCodec:et,channels:tt},i,audioMatchPredicate)||(useAlternateAudio(i.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=i)}}completeAudioSwitch(i){const{hls:_}=this;this.flushAudioIfNeeded(i),this.bufferedTrack=i,this.switchingTrack=null,_.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},i))}}class BasePlaylistController extends Logger$1{constructor(i,_){super(_,i.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=i}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(i,_,$){const j=_==null?void 0:_.renditionReports;if(j){let _e=-1;for(let et=0;et<j.length;et++){const tt=j[et];let rt;try{rt=new self.URL(tt.URI,_.url).href}catch(nt){this.warn(`Could not construct new URL for Rendition Report: ${nt}`),rt=tt.URI||""}if(rt===i){_e=et;break}else rt===i.substring(0,rt.length)&&(_e=et)}if(_e!==-1){const et=j[_e],tt=parseInt(et["LAST-MSN"])||_.lastPartSn;let rt=parseInt(et["LAST-PART"])||_.lastPartIndex;if(this.hls.config.lowLatencyMode){const it=Math.min(_.age-_.partTarget,_.targetduration);rt>=0&&it>_.partTarget&&(rt+=1)}const nt=$&&getSkipValue($);return new HlsUrlParameters(tt,rt>=0?rt:void 0,nt)}}}loadPlaylist(i){this.clearTimer()}loadingPlaylist(i,_){this.clearTimer()}shouldLoadPlaylist(i){return this.canLoad&&!!i&&!!i.url&&(!i.details||i.details.live)}getUrlWithDirectives(i,_){if(_)try{return _.addDirectives(i)}catch($){this.warn(`Could not construct new URL with HLS Delivery Directives: ${$}`)}return i}playlistLoaded(i,_,$){const{details:j,stats:_e}=_,et=self.performance.now(),tt=_e.loading.first?Math.max(0,et-_e.loading.first):0;j.advancedDateTime=Date.now()-tt;const rt=this.hls.config.timelineOffset;if(rt!==j.appliedTimelineOffset){const it=Math.max(rt||0,0);j.appliedTimelineOffset=it,j.fragments.forEach(st=>{st.setStart(st.playlistOffset+it)})}if(j.live||$!=null&&$.live){const it="levelInfo"in _?_.levelInfo:_.track;if(j.reloaded($),$&&j.fragments.length>0){mergeDetails($,j,this);const ht=j.playlistParsingError;if(ht){this.warn(ht);const dt=this.hls;if(!dt.config.ignorePlaylistParsingErrors){var nt;const{networkDetails:mt}=_;dt.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:j.url,error:ht,reason:ht.message,level:_.level||void 0,parent:(nt=j.fragments[0])==null?void 0:nt.type,networkDetails:mt,stats:_e});return}j.playlistParsingError=null}}j.requestScheduled===-1&&(j.requestScheduled=_e.loading.start);const st=this.hls.mainForwardBufferInfo,at=st?st.end-st.len:0,ot=(j.edge-at)*1e3,lt=computeReloadInterval(j,ot);if(j.requestScheduled+lt<et?j.requestScheduled=et:j.requestScheduled+=lt,this.log(`live playlist ${i} ${j.advanced?"REFRESHED "+j.lastPartSn+"-"+j.lastPartIndex:j.updated?"UPDATED":"MISSED"}`),!this.canLoad||!j.live)return;let ct,ft,ut;if(j.canBlockReload&&j.endSN&&j.advanced){const ht=this.hls.config.lowLatencyMode,dt=j.lastPartSn,mt=j.endSN,pt=j.lastPartIndex,yt=pt!==-1,gt=dt===mt;yt?gt?(ft=mt+1,ut=ht?0:pt):(ft=dt,ut=ht?pt+1:j.maxPartIndex):ft=mt+1;const vt=j.age,St=vt+j.ageHeader;let At=Math.min(St-j.partTarget,j.targetduration*1.5);if(At>0){if(St>j.targetduration*3)this.log(`Playlist last advanced ${vt.toFixed(2)}s ago. Omitting segment and part directives.`),ft=void 0,ut=void 0;else if($!=null&&$.tuneInGoal&&St-j.partTarget>$.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${$.tuneInGoal} to: ${At} with playlist age: ${j.age}`),At=0;else{const xt=Math.floor(At/j.targetduration);if(ft+=xt,ut!==void 0){const wt=Math.round(At%j.targetduration/j.partTarget);ut+=wt}this.log(`CDN Tune-in age: ${j.ageHeader}s last advanced ${vt.toFixed(2)}s goal: ${At} skip sn ${xt} to part ${ut}`)}j.tuneInGoal=At}if(ct=this.getDeliveryDirectives(j,_.deliveryDirectives,ft,ut),ht||!gt){j.requestScheduled=et,this.loadingPlaylist(it,ct);return}}else(j.canBlockReload||j.canSkipUntil)&&(ct=this.getDeliveryDirectives(j,_.deliveryDirectives,ft,ut));ct&&ft!==void 0&&j.canBlockReload&&(j.requestScheduled=_e.loading.first+Math.max(lt-tt*2,lt/2)),this.scheduleLoading(it,ct,j)}else this.clearTimer()}scheduleLoading(i,_,$){const j=$||i.details;if(!j){this.loadingPlaylist(i,_);return}const _e=self.performance.now(),et=j.requestScheduled;if(_e>=et){this.loadingPlaylist(i,_);return}const tt=et-_e;this.log(`reload live playlist ${i.name||i.bitrate+"bps"} in ${Math.round(tt)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(i,_),tt)}getDeliveryDirectives(i,_,$,j){let _e=getSkipValue(i);return _!=null&&_.skip&&i.deltaUpdateFailed&&($=_.msn,j=_.part,_e=HlsSkip.No),new HlsUrlParameters($,j,_e)}checkRetry(i){const _=i.details,$=isTimeoutError(i),j=i.errorAction,{action:_e,retryCount:et=0,retryConfig:tt}=j||{},rt=!!j&&!!tt&&(_e===NetworkErrorAction.RetryRequest||!j.resolved&&_e===NetworkErrorAction.SendAlternateToPenaltyBox);if(rt){var nt;if(et>=tt.maxNumRetry)return!1;if($&&(nt=i.context)!=null&&nt.deliveryDirectives)this.warn(`Retrying playlist loading ${et+1}/${tt.maxNumRetry} after "${_}" without delivery-directives`),this.loadPlaylist();else{const it=getRetryDelay(tt,et);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),it),this.warn(`Retrying playlist loading ${et+1}/${tt.maxNumRetry} after "${_}" in ${it}ms`)}i.levelRetry=!0,j.resolved=!0}return rt}}function subtitleOptionsIdentical(o,i){if(o.length!==i.length)return!1;for(let _=0;_<o.length;_++)if(!mediaAttributesIdentical(o[_].attrs,i[_].attrs))return!1;return!0}function mediaAttributesIdentical(o,i,_){const $=o["STABLE-RENDITION-ID"];return $&&!_?$===i["STABLE-RENDITION-ID"]:!(_||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(j=>o[j]!==i[j])}function subtitleTrackMatchesTextTrack(o,i){return i.label.toLowerCase()===o.name.toLowerCase()&&(!i.language||i.language.toLowerCase()===(o.lang||"").toLowerCase())}class AudioTrackController extends BasePlaylistController{constructor(i){super(i,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:i}=this;i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:i}=this;i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(i,_){this.tracks=_.audioTracks||[]}onAudioTrackLoaded(i,_){const{id:$,groupId:j,details:_e}=_,et=this.tracksInGroup[$];if(!et||et.groupId!==j){this.warn(`Audio track with id:${$} and group:${j} not found in active group ${et==null?void 0:et.groupId}`);return}const tt=et.details;et.details=_.details,this.log(`Audio track ${$} "${et.name}" lang:${et.lang} group:${j} loaded [${_e.startSN}-${_e.endSN}]`),$===this.trackId&&this.playlistLoaded($,_,tt)}onLevelLoading(i,_){this.switchLevel(_.level)}onLevelSwitching(i,_){this.switchLevel(_.level)}switchLevel(i){const _=this.hls.levels[i];if(!_)return;const $=_.audioGroups||null,j=this.groupIds;let _e=this.currentTrack;if(!$||(j==null?void 0:j.length)!==($==null?void 0:$.length)||$!=null&&$.some(tt=>(j==null?void 0:j.indexOf(tt))===-1)){this.groupIds=$,this.trackId=-1,this.currentTrack=null;const tt=this.tracks.filter(at=>!$||$.indexOf(at.groupId)!==-1);if(tt.length)this.selectDefaultTrack&&!tt.some(at=>at.default)&&(this.selectDefaultTrack=!1),tt.forEach((at,ot)=>{at.id=ot});else if(!_e&&!this.tracksInGroup.length)return;this.tracksInGroup=tt;const rt=this.hls.config.audioPreference;if(!_e&&rt){const at=findMatchingOption(rt,tt,audioMatchPredicate);if(at>-1)_e=tt[at];else{const ot=findMatchingOption(rt,this.tracks);_e=this.tracks[ot]}}let nt=this.findTrackId(_e);nt===-1&&_e&&(nt=this.findTrackId(null));const it={audioTracks:tt};this.log(`Updating audio tracks, ${tt.length} track(s) found in group(s): ${$==null?void 0:$.join(",")}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,it);const st=this.trackId;if(nt!==-1&&st===-1)this.setAudioTrack(nt);else if(tt.length&&st===-1){var et;const at=new Error(`No audio track selected for current audio group-ID(s): ${(et=this.groupIds)==null?void 0:et.join(",")} track count: ${tt.length}`);this.warn(at.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:at})}}}onError(i,_){_.fatal||!_.context||_.context.type===PlaylistContextType.AUDIO_TRACK&&_.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(_.context.groupId)!==-1)&&this.checkRetry(_)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(i){this.selectDefaultTrack=!1,this.setAudioTrack(i)}setAudioOption(i){const _=this.hls;if(_.config.audioPreference=i,i){const $=this.allAudioTracks;if(this.selectDefaultTrack=!1,$.length){const j=this.currentTrack;if(j&&matchesOption(i,j,audioMatchPredicate))return j;const _e=findMatchingOption(i,this.tracksInGroup,audioMatchPredicate);if(_e>-1){const et=this.tracksInGroup[_e];return this.setAudioTrack(_e),et}else if(j){let et=_.loadLevel;et===-1&&(et=_.firstAutoLevel);const tt=findClosestLevelWithAudioGroup(i,_.levels,$,et,audioMatchPredicate);if(tt===-1)return null;_.nextLoadLevel=tt}if(i.channels||i.audioCodec){const et=findMatchingOption(i,$);if(et>-1)return $[et]}}}return null}setAudioTrack(i){const _=this.tracksInGroup;if(i<0||i>=_.length){this.warn(`Invalid audio track id: ${i}`);return}this.selectDefaultTrack=!1;const $=this.currentTrack,j=_[i],_e=j.details&&!j.details.live;if(i===this.trackId&&j===$&&_e||(this.log(`Switching to audio-track ${i} "${j.name}" lang:${j.lang} group:${j.groupId} channels:${j.channels}`),this.trackId=i,this.currentTrack=j,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},j)),_e))return;const et=this.switchParams(j.url,$==null?void 0:$.details,j.details);this.loadPlaylist(et)}findTrackId(i){const _=this.tracksInGroup;for(let $=0;$<_.length;$++){const j=_[$];if(!(this.selectDefaultTrack&&!j.default)&&(!i||matchesOption(i,j,audioMatchPredicate)))return $}if(i){const{name:$,lang:j,assocLang:_e,characteristics:et,audioCodec:tt,channels:rt}=i;for(let nt=0;nt<_.length;nt++){const it=_[nt];if(matchesOption({name:$,lang:j,assocLang:_e,characteristics:et,audioCodec:tt,channels:rt},it,audioMatchPredicate))return nt}for(let nt=0;nt<_.length;nt++){const it=_[nt];if(mediaAttributesIdentical(i.attrs,it.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return nt}for(let nt=0;nt<_.length;nt++){const it=_[nt];if(mediaAttributesIdentical(i.attrs,it.attrs,["LANGUAGE"]))return nt}}return-1}loadPlaylist(i){super.loadPlaylist();const _=this.currentTrack;this.shouldLoadPlaylist(_)&&useAlternateAudio(_.url,this.hls)&&this.scheduleLoading(_,i)}loadingPlaylist(i,_){super.loadingPlaylist(i,_);const $=i.id,j=i.groupId,_e=this.getUrlWithDirectives(i.url,_),et=i.details,tt=et==null?void 0:et.age;this.log(`Loading audio-track ${$} "${i.name}" lang:${i.lang} group:${j}${(_==null?void 0:_.msn)!==void 0?" at sn "+_.msn+" part "+_.part:""}${tt&&et.live?" age "+tt.toFixed(1)+(et.type&&" "+et.type||""):""} ${_e}`),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:_e,id:$,groupId:j,deliveryDirectives:_||null,track:i})}}class BufferOperationQueue{constructor(i){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=i}destroy(){this.tracks=this.queues=null}append(i,_,$){if(this.queues===null||this.tracks===null)return;const j=this.queues[_];j.push(i),j.length===1&&!$&&this.executeNext(_)}appendBlocker(i){return new Promise(_=>{const $={label:"async-blocker",execute:_,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append($,i)})}prependBlocker(i){return new Promise(_=>{if(this.queues){const $={label:"async-blocker-prepend",execute:_,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[i].unshift($)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(i=>{var _;const $=(_=i[0])==null?void 0:_.label;($==="async-blocker"||$==="async-blocker-prepend")&&(i[0].execute(),i.splice(0,1))})}unblockAudio(i){if(this.queues===null)return;this.queues.audio[0]===i&&this.shiftAndExecuteNext("audio")}executeNext(i){if(this.queues===null||this.tracks===null)return;const _=this.queues[i];if(_.length){const j=_[0];try{j.execute()}catch(_e){var $;if(j.onError(_e),this.queues===null||this.tracks===null)return;const et=($=this.tracks[i])==null?void 0:$.buffer;et!=null&&et.updating||this.shiftAndExecuteNext(i)}}}shiftAndExecuteNext(i){this.queues!==null&&(this.queues[i].shift(),this.executeNext(i))}current(i){var _;return((_=this.queues)==null?void 0:_[i][0])||null}toString(){const{queues:i,tracks:_}=this;return i===null||_===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(i){var _,$;return(_=this.queues)!=null&&_[i]||($=this.tracks)!=null&&$[i]?`${i}: (${this.listSbInfo(i)}) ${this.listOps(i)}`:""}listSbInfo(i){var _;const $=(_=this.tracks)==null?void 0:_[i],j=$==null?void 0:$.buffer;return j?`SourceBuffer${j.updating?" updating":""}${$.ended?" ended":""}${$.ending?" ending":""}`:"none"}listOps(i){var _;return((_=this.queues)==null?void 0:_[i].map($=>$.label).join(", "))||""}}const VIDEO_CODEC_PROFILE_REPLACE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,TRACK_REMOVED_ERROR_NAME="HlsJsTrackRemovedError";class HlsJsTrackRemovedError extends Error{constructor(i){super(i),this.name=TRACK_REMOVED_ERROR_NAME}}class BufferController extends Logger$1{constructor(i,_){super("buffer-controller",i.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=$=>{var j;this.hls&&((j=this.mediaSource)==null?void 0:j.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=$=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=$=>{const{media:j,mediaSource:_e}=this;$&&this.log("Media source opened"),!(!j||!_e)&&(_e.removeEventListener("sourceopen",this._onMediaSourceOpen),j.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:j,mediaSource:_e}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:$,_objectUrl:j}=this;$!==j&&this.error(`Media element src was set while attaching MediaSource (${j} > ${$})`)},this.hls=i,this.fragmentTracker=_,this.appendSource=isManagedMediaSource(getMediaSource(i.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:i}=this;i.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.BUFFER_RESET,this.onBufferReset,this),i.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),i.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),i.on(Events.BUFFER_EOS,this.onBufferEos,this),i.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.on(Events.FRAG_PARSED,this.onFragParsed,this),i.on(Events.FRAG_CHANGED,this.onFragChanged,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:i}=this;i.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.BUFFER_RESET,this.onBufferReset,this),i.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),i.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),i.off(Events.BUFFER_EOS,this.onBufferEos,this),i.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.off(Events.FRAG_PARSED,this.onFragParsed,this),i.off(Events.FRAG_CHANGED,this.onFragChanged,this),i.off(Events.ERROR,this.onError,this)}transferMedia(){const{media:i,mediaSource:_}=this;if(!i)return null;const $={};if(this.operationQueue){const _e=this.isUpdating();_e||this.operationQueue.removeBlockers();const et=this.isQueued();(_e||et)&&this.warn(`Transfering MediaSource with${et?" operations in queue":""}${_e?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const j=this.transferData;return!this.sourceBufferCount&&j&&j.mediaSource===_?_extends($,j.tracks):this.sourceBuffers.forEach(_e=>{const[et]=_e;et&&($[et]=_extends({},this.tracks[et]),this.removeBuffer(et)),_e[0]=_e[1]=null}),{media:i,mediaSource:_,tracks:$}}initTracks(){const i={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=i,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(i,_){var $;let j=2;(_.audio&&!_.video||!_.altAudio)&&(j=1),this.bufferCodecEventsTotal=j,this.log(`${j} bufferCodec event(s) expected.`),($=this.transferData)!=null&&$.mediaSource&&this.sourceBufferCount&&j&&this.bufferCreated()}onMediaAttaching(i,_){const $=this.media=_.media;this.transferData=this.overrides=void 0;const j=getMediaSource(this.appendSource);if(j){const _e=!!_.mediaSource;(_e||_.overrides)&&(this.transferData=_,this.overrides=_.overrides);const et=this.mediaSource=_.mediaSource||new j;if(this.assignMediaSource(et),_e)this._objectUrl=$.src,this.attachTransferred();else{const tt=this._objectUrl=self.URL.createObjectURL(et);if(this.appendSource)try{$.removeAttribute("src");const rt=self.ManagedMediaSource;$.disableRemotePlayback=$.disableRemotePlayback||rt&&et instanceof rt,removeSourceChildren($),addSource($,tt),$.load()}catch{$.src=tt}else $.src=tt}$.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(i){var _,$;this.log(`${((_=this.transferData)==null?void 0:_.mediaSource)===i?"transferred":"created"} media source: ${($=i.constructor)==null?void 0:$.name}`),i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.addEventListener("startstreaming",this._onStartStreaming),i.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const i=this.media,_=this.transferData;if(!_||!i)return;const $=this.tracks,j=_.tracks,_e=j?Object.keys(j):null,et=_e?_e.length:0,tt=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(j&&_e&&et){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${stringify($,(rt,nt)=>rt==="initSegment"?void 0:nt)};
transfer tracks: ${stringify(j,(rt,nt)=>rt==="initSegment"?void 0:nt)}}`),!isCompatibleTrackChange(j,$)){_.mediaSource=null,_.tracks=void 0;const rt=i.currentTime,nt=this.details,it=Math.max(rt,(nt==null?void 0:nt.fragments[0].start)||0);if(it-rt>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${rt} -> ${it}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(j)}"->"${Object.keys($)}") start time: ${it} currentTime: ${rt}`),this.onMediaDetaching(Events.MEDIA_DETACHING,{}),this.onMediaAttaching(Events.MEDIA_ATTACHING,_),i.currentTime=it;return}this.transferData=void 0,_e.forEach(rt=>{const nt=rt,it=j[nt];if(it){const st=it.buffer;if(st){const at=this.fragmentTracker,ot=it.id;if(at.hasFragments(ot)||at.hasParts(ot)){const ft=BufferHelper.getBuffered(st);at.detectEvictedFragments(nt,ft,ot,null,!0)}const lt=sourceBufferNameToIndex(nt),ct=[nt,st];this.sourceBuffers[lt]=ct,st.updating&&this.operationQueue&&this.operationQueue.prependBlocker(nt),this.trackSourceBuffer(nt,it)}}}),tt(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),tt()}get mediaSourceOpenOrEnded(){var i;const _=(i=this.mediaSource)==null?void 0:i.readyState;return _==="open"||_==="ended"}onMediaDetaching(i,_){const $=!!_.transferMedia;this.transferData=this.overrides=void 0;const{media:j,mediaSource:_e,_objectUrl:et}=this;if(_e){if(this.log(`media source ${$?"transferring":"detaching"}`),$)this.sourceBuffers.forEach(([tt])=>{tt&&this.removeBuffer(tt)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const tt=_e.readyState==="open";try{const rt=_e.sourceBuffers;for(let nt=rt.length;nt--;)tt&&rt[nt].abort(),_e.removeSourceBuffer(rt[nt]);tt&&_e.endOfStream()}catch(rt){this.warn(`onMediaDetaching: ${rt.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}_e.removeEventListener("sourceopen",this._onMediaSourceOpen),_e.removeEventListener("sourceended",this._onMediaSourceEnded),_e.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(_e.removeEventListener("startstreaming",this._onStartStreaming),_e.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}j&&(j.removeEventListener("emptied",this._onMediaEmptied),$||(et&&self.URL.revokeObjectURL(et),this.mediaSrc===et?(j.removeAttribute("src"),this.appendSource&&removeSourceChildren(j),j.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(Events.MEDIA_DETACHED,_)}onBufferReset(){this.sourceBuffers.forEach(([i])=>{i&&this.resetBuffer(i)}),this.initTracks()}resetBuffer(i){var _;const $=(_=this.tracks[i])==null?void 0:_.buffer;if(this.removeBuffer(i),$)try{var j;(j=this.mediaSource)!=null&&j.sourceBuffers.length&&this.mediaSource.removeSourceBuffer($)}catch(_e){this.warn(`onBufferReset ${i}`,_e)}delete this.tracks[i]}removeBuffer(i){this.removeBufferListeners(i),this.sourceBuffers[sourceBufferNameToIndex(i)]=[null,null];const _=this.tracks[i];_&&(_.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new BufferOperationQueue(this.tracks)}onBufferCodecs(i,_){var $;const j=this.tracks,_e=Object.keys(_);this.log(`BUFFER_CODECS: "${_e}" (current SB count ${this.sourceBufferCount})`);const et="audiovideo"in _&&(j.audio||j.video)||j.audiovideo&&("audio"in _||"video"in _),tt=!et&&this.sourceBufferCount&&this.media&&_e.some(rt=>!j[rt]);if(et||tt){this.warn(`Unsupported transition between "${Object.keys(j)}" and "${_e}" SourceBuffers`);return}_e.forEach(rt=>{var nt,it;const st=_[rt],{id:at,codec:ot,levelCodec:lt,container:ct,metadata:ft,supplemental:ut}=st;let ht=j[rt];const dt=(nt=this.transferData)==null||(nt=nt.tracks)==null?void 0:nt[rt],mt=dt!=null&&dt.buffer?dt:ht,pt=(mt==null?void 0:mt.pendingCodec)||(mt==null?void 0:mt.codec),yt=mt==null?void 0:mt.levelCodec;ht||(ht=j[rt]={buffer:void 0,listeners:[],codec:ot,supplemental:ut,container:ct,levelCodec:lt,metadata:ft,id:at});const gt=pickMostCompleteCodecName(pt,yt),vt=gt==null?void 0:gt.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");let St=pickMostCompleteCodecName(ot,lt);const At=(it=St)==null?void 0:it.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");St&&gt&&vt!==At&&(rt.slice(0,5)==="audio"&&(St=getCodecCompatibleName(St,this.appendSource)),this.log(`switching codec ${pt} to ${St}`),St!==(ht.pendingCodec||ht.codec)&&(ht.pendingCodec=St),ht.container=ct,this.appendChangeType(rt,ct,St))}),(this.tracksReady||this.sourceBufferCount)&&(_.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!_.video&&(($=_.audio)==null?void 0:$.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((i,_)=>{const $=this.tracks[_];return i[_]={id:$.id,container:$.container,codec:$.codec,levelCodec:$.levelCodec},i},{})}appendChangeType(i,_,$){const j=`${_};codecs=${$}`,_e={label:`change-type=${j}`,execute:()=>{const et=this.tracks[i];if(et){const tt=et.buffer;tt!=null&&tt.changeType&&(this.log(`changing ${i} sourceBuffer type to ${j}`),tt.changeType(j),et.codec=$,et.container=_)}this.shiftAndExecuteNext(i)},onStart:()=>{},onComplete:()=>{},onError:et=>{this.warn(`Failed to change ${i} SourceBuffer type`,et)}};this.append(_e,i,this.isPending(this.tracks[i]))}blockAudio(i){var _;const $=i.start,j=$+i.duration*.05;if(((_=this.fragmentTracker.getAppendedFrag($,PlaylistLevelType.MAIN))==null?void 0:_.gap)===!0)return;const et={label:"block-audio",execute:()=>{var tt;const rt=this.tracks.video;(this.lastVideoAppendEnd>j||rt!=null&&rt.buffer&&BufferHelper.isBuffered(rt.buffer,j)||((tt=this.fragmentTracker.getAppendedFrag(j,PlaylistLevelType.MAIN))==null?void 0:tt.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:tt=>{this.warn("Error executing block-audio operation",tt)}};this.blockedAudioAppend={op:et,frag:i},this.append(et,"audio",!0)}unblockAudio(){const{blockedAudioAppend:i,operationQueue:_}=this;i&&_&&(this.blockedAudioAppend=null,_.unblockAudio(i.op))}onBufferAppending(i,_){const{tracks:$}=this,{data:j,type:_e,parent:et,frag:tt,part:rt,chunkMeta:nt,offset:it}=_,st=nt.buffering[_e],{sn:at,cc:ot}=tt,lt=self.performance.now();st.start=lt;const ct=tt.stats.buffering,ft=rt?rt.stats.buffering:null;ct.start===0&&(ct.start=lt),ft&&ft.start===0&&(ft.start=lt);const ut=$.audio;let ht=!1;_e==="audio"&&(ut==null?void 0:ut.container)==="audio/mpeg"&&(ht=!this.lastMpegAudioChunk||nt.id===1||this.lastMpegAudioChunk.sn!==nt.sn,this.lastMpegAudioChunk=nt);const dt=$.video,mt=dt==null?void 0:dt.buffer;if(mt&&at!=="initSegment"){const gt=rt||tt,vt=this.blockedAudioAppend;if(_e==="audio"&&et!=="main"&&!this.blockedAudioAppend&&!(dt.ending||dt.ended)){const At=gt.start+gt.duration*.05,xt=mt.buffered,wt=this.currentOp("video");!xt.length&&!wt?this.blockAudio(gt):!wt&&!BufferHelper.isBuffered(mt,At)&&this.lastVideoAppendEnd<At&&this.blockAudio(gt)}else if(_e==="video"){const St=gt.end;if(vt){const At=vt.frag.start;(St>At||St<this.lastVideoAppendEnd||BufferHelper.isBuffered(mt,At))&&this.unblockAudio()}this.lastVideoAppendEnd=St}}const pt=(rt||tt).start,yt={label:`append-${_e}`,execute:()=>{var gt;st.executeStart=self.performance.now();const vt=(gt=this.tracks[_e])==null?void 0:gt.buffer;vt&&(ht?this.updateTimestampOffset(vt,pt,.1,_e,at,ot):it!==void 0&&isFiniteNumber(it)&&this.updateTimestampOffset(vt,it,1e-6,_e,at,ot)),this.appendExecutor(j,_e)},onStart:()=>{},onComplete:()=>{const gt=self.performance.now();st.executeEnd=st.end=gt,ct.first===0&&(ct.first=gt),ft&&ft.first===0&&(ft.first=gt);const vt={};this.sourceBuffers.forEach(([St,At])=>{St&&(vt[St]=BufferHelper.getBuffered(At))}),this.appendErrors[_e]=0,_e==="audio"||_e==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Events.BUFFER_APPENDED,{type:_e,frag:tt,part:rt,chunkMeta:nt,parent:tt.type,timeRanges:vt})},onError:gt=>{var vt;const St={type:ErrorTypes.MEDIA_ERROR,parent:tt.type,details:ErrorDetails.BUFFER_APPEND_ERROR,sourceBufferName:_e,frag:tt,part:rt,chunkMeta:nt,error:gt,err:gt,fatal:!1},At=(vt=this.media)==null?void 0:vt.error;if(gt.code===DOMException.QUOTA_EXCEEDED_ERR||gt.name=="QuotaExceededError"||"quota"in gt)St.details=ErrorDetails.BUFFER_FULL_ERROR;else if(gt.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!At)St.errorAction=createDoNothingErrorAction(!0);else if(gt.name===TRACK_REMOVED_ERROR_NAME&&this.sourceBufferCount===0)St.errorAction=createDoNothingErrorAction(!0);else{const xt=++this.appendErrors[_e];this.warn(`Failed ${xt}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${_e}" sourceBuffer (${At||"no media error"})`),(xt>=this.hls.config.appendErrorMaxRetry||At)&&(St.fatal=!0)}this.hls.trigger(Events.ERROR,St)}};this.log(`queuing "${_e}" append sn: ${at}${rt?" p: "+rt.index:""} of ${tt.type===PlaylistLevelType.MAIN?"level":"track"} ${tt.level} cc: ${ot}`),this.append(yt,_e,this.isPending(this.tracks[_e]))}getFlushOp(i,_,$){return this.log(`queuing "${i}" remove ${_}-${$}`),{label:"remove",execute:()=>{this.removeExecutor(i,_,$)},onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:i})},onError:j=>{this.warn(`Failed to remove ${_}-${$} from "${i}" SourceBuffer`,j)}}}onBufferFlushing(i,_){const{type:$,startOffset:j,endOffset:_e}=_;$?this.append(this.getFlushOp($,j,_e),$):this.sourceBuffers.forEach(([et])=>{et&&this.append(this.getFlushOp(et,j,_e),et)})}onFragParsed(i,_){const{frag:$,part:j}=_,_e=[],et=j?j.elementaryStreams:$.elementaryStreams;et[ElementaryStreamTypes.AUDIOVIDEO]?_e.push("audiovideo"):(et[ElementaryStreamTypes.AUDIO]&&_e.push("audio"),et[ElementaryStreamTypes.VIDEO]&&_e.push("video"));const tt=()=>{const rt=self.performance.now();$.stats.buffering.end=rt,j&&(j.stats.buffering.end=rt);const nt=j?j.stats:$.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:$,part:j,stats:nt,id:$.type})};_e.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${$.type} level: ${$.level} sn: ${$.sn}`),this.blockBuffers(tt,_e).catch(rt=>{this.warn(`Fragment buffered callback ${rt}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(i,_){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([i])=>{if(i){const _=this.tracks[i];if(_)return!_.ended||_.ending}return!1})}onBufferEos(i,_){var $;this.sourceBuffers.forEach(([et])=>{if(et){const tt=this.tracks[et];(!_.type||_.type===et)&&(tt.ending=!0,tt.ended||(tt.ended=!0,this.log(`${et} buffer reached EOS`)))}});const j=(($=this.overrides)==null?void 0:$.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([et])=>{var tt;return et&&!((tt=this.tracks[et])!=null&&tt.ended)})?j?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:et}=this;if(!et||et.readyState!=="open"){et&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${et.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),et.endOfStream(),this.hls.trigger(Events.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(Events.BUFFERED_TO_END,void 0)):_.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([i])=>{if(i!==null){const _=this.tracks[i];_&&(_.ending=!1)}})}onLevelUpdated(i,{details:_}){_.fragments.length&&(this.details=_,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const i=this.getDurationAndRange();i&&this.updateMediaSource(i)})}onError(i,_){if(_.details===ErrorDetails.BUFFER_APPEND_ERROR&&_.frag){var $;const j=($=_.errorAction)==null?void 0:$.nextAutoLevel;isFiniteNumber(j)&&j!==_.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:i,details:_,media:$}=this;if(!$||_===null||!this.sourceBufferCount)return;const j=i.config,_e=$.currentTime,et=_.levelTargetDuration,tt=_.live&&j.liveBackBufferLength!==null?j.liveBackBufferLength:j.backBufferLength;if(isFiniteNumber(tt)&&tt>=0){const nt=Math.max(tt,et),it=Math.floor(_e/et)*et-nt;this.flushBackBuffer(_e,et,it)}const rt=j.frontBufferFlushThreshold;if(isFiniteNumber(rt)&&rt>0){const nt=Math.max(j.maxBufferLength,rt),it=Math.max(nt,et),st=Math.floor(_e/et)*et+it;this.flushFrontBuffer(_e,et,st)}}flushBackBuffer(i,_,$){this.sourceBuffers.forEach(([j,_e])=>{if(_e){const tt=BufferHelper.getBuffered(_e);if(tt.length>0&&$>tt.start(0)){var et;this.hls.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:$});const rt=this.tracks[j];if((et=this.details)!=null&&et.live)this.hls.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:$});else if(rt!=null&&rt.ended){this.log(`Cannot flush ${j} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:$,type:j})}}})}flushFrontBuffer(i,_,$){this.sourceBuffers.forEach(([j,_e])=>{if(_e){const et=BufferHelper.getBuffered(_e),tt=et.length;if(tt<2)return;const rt=et.start(tt-1),nt=et.end(tt-1);if($>rt||i>=rt&&i<=nt)return;this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:rt,endOffset:1/0,type:j})}})}getDurationAndRange(){var i;const{details:_,mediaSource:$}=this;if(!_||!this.media||($==null?void 0:$.readyState)!=="open")return null;const j=_.edge;if(_.live&&this.hls.config.liveDurationInfinity){if(_.fragments.length&&$.setLiveSeekableRange){const nt=Math.max(0,_.fragmentStart),it=Math.max(nt,j);return{duration:1/0,start:nt,end:it}}return{duration:1/0}}const _e=(i=this.overrides)==null?void 0:i.duration;if(_e)return isFiniteNumber(_e)?{duration:_e}:null;const et=this.media.duration,tt=isFiniteNumber($.duration)?$.duration:0;return j>tt&&j>et||!isFiniteNumber(et)?{duration:j}:null}updateMediaSource({duration:i,start:_,end:$}){const j=this.mediaSource;!this.media||!j||j.readyState!=="open"||(j.duration!==i&&(isFiniteNumber(i)&&this.log(`Updating MediaSource duration to ${i.toFixed(3)}`),j.duration=i),_!==void 0&&$!==void 0&&(this.log(`MediaSource duration is set to ${j.duration}. Setting seekable range to ${_}-${$}.`),j.setLiveSeekableRange(_,$)))}get tracksReady(){const i=this.pendingTrackCount;return i>0&&(i>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:i,pendingTrackCount:_,tracks:$}=this;if(this.log(`checkPendingTracks (pending: ${_} codec events expected: ${i}) ${stringify($)}`),this.tracksReady){var j;const _e=(j=this.transferData)==null?void 0:j.tracks;_e&&Object.keys(_e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const i={};this.sourceBuffers.forEach(([_,$])=>{if(_){const j=this.tracks[_];i[_]={buffer:$,container:j.container,codec:j.codec,supplemental:j.supplemental,levelCodec:j.levelCodec,id:j.id,metadata:j.metadata}}}),this.hls.trigger(Events.BUFFER_CREATED,{tracks:i}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([_])=>{this.executeNext(_)})}else{const i=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:i,reason:i.message})}}createSourceBuffers(){const{tracks:i,sourceBuffers:_,mediaSource:$}=this;if(!$)throw new Error("createSourceBuffers called when mediaSource was null");for(const _e in i){const et=_e,tt=i[et];if(this.isPending(tt)){const rt=this.getTrackCodec(tt,et),nt=`${tt.container};codecs=${rt}`;tt.codec=rt,this.log(`creating sourceBuffer(${nt})${this.currentOp(et)?" Queued":""} ${stringify(tt)}`);try{const it=$.addSourceBuffer(nt),st=sourceBufferNameToIndex(et),at=[et,it];_[st]=at,tt.buffer=it}catch(it){var j;this.error(`error while trying to add sourceBuffer: ${it.message}`),this.shiftAndExecuteNext(et),(j=this.operationQueue)==null||j.removeBlockers(),delete this.tracks[et],this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:it,sourceBufferName:et,mimeType:nt,parent:tt.id});return}this.trackSourceBuffer(et,tt)}}this.bufferCreated()}getTrackCodec(i,_){const $=i.supplemental;let j=i.codec;$&&(_==="video"||_==="audiovideo")&&areCodecsMediaSourceSupported($,"video")&&(j=replaceVideoCodec(j,$));const _e=pickMostCompleteCodecName(j,i.levelCodec);return _e?_.slice(0,5)==="audio"?getCodecCompatibleName(_e,this.appendSource):_e:""}trackSourceBuffer(i,_){const $=_.buffer;if(!$)return;const j=this.getTrackCodec(_,i);this.tracks[i]={buffer:$,codec:j,container:_.container,levelCodec:_.levelCodec,supplemental:_.supplemental,metadata:_.metadata,id:_.id,listeners:[]},this.removeBufferListeners(i),this.addBufferListener(i,"updatestart",this.onSBUpdateStart),this.addBufferListener(i,"updateend",this.onSBUpdateEnd),this.addBufferListener(i,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(i,"bufferedchange",(_e,et)=>{const tt=et.removedRanges;tt!=null&&tt.length&&this.hls.trigger(Events.BUFFER_FLUSHED,{type:_e})})}get mediaSrc(){var i,_;const $=((i=this.media)==null||(_=i.querySelector)==null?void 0:_.call(i,"source"))||this.media;return $==null?void 0:$.src}onSBUpdateStart(i){const _=this.currentOp(i);_&&_.onStart()}onSBUpdateEnd(i){var _;if(((_=this.mediaSource)==null?void 0:_.readyState)==="closed"){this.resetBuffer(i);return}const $=this.currentOp(i);$&&($.onComplete(),this.shiftAndExecuteNext(i))}onSBUpdateError(i,_){var $;const j=new Error(`${i} SourceBuffer error. MediaSource readyState: ${($=this.mediaSource)==null?void 0:$.readyState}`);this.error(`${j}`,_),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,sourceBufferName:i,error:j,fatal:!1});const _e=this.currentOp(i);_e&&_e.onError(j)}updateTimestampOffset(i,_,$,j,_e,et){const tt=_-i.timestampOffset;Math.abs(tt)>=$&&(this.log(`Updating ${j} SourceBuffer timestampOffset to ${_} (sn: ${_e} cc: ${et})`),i.timestampOffset=_)}removeExecutor(i,_,$){const{media:j,mediaSource:_e}=this,et=this.tracks[i],tt=et==null?void 0:et.buffer;if(!j||!_e||!tt){this.warn(`Attempting to remove from the ${i} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(i);return}const rt=isFiniteNumber(j.duration)?j.duration:1/0,nt=isFiniteNumber(_e.duration)?_e.duration:1/0,it=Math.max(0,_),st=Math.min($,rt,nt);st>it&&(!et.ending||et.ended)?(et.ended=!1,this.log(`Removing [${it},${st}] from the ${i} SourceBuffer`),tt.remove(it,st)):this.shiftAndExecuteNext(i)}appendExecutor(i,_){const $=this.tracks[_],j=$==null?void 0:$.buffer;if(!j)throw new HlsJsTrackRemovedError(`Attempting to append to the ${_} SourceBuffer, but it does not exist`);$.ending=!1,$.ended=!1,j.appendBuffer(i)}blockUntilOpen(i){if(this.isUpdating()||this.isQueued())this.blockBuffers(i).catch(_=>{this.warn(`SourceBuffer blocked callback ${_}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{i()}catch(_){this.warn(`Callback run without blocking ${this.operationQueue} ${_}`)}}isUpdating(){return this.sourceBuffers.some(([i,_])=>i&&_.updating)}isQueued(){return this.sourceBuffers.some(([i])=>i&&!!this.currentOp(i))}isPending(i){return!!i&&!i.buffer}blockBuffers(i,_=this.sourceBufferTypes){if(!_.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(i);const{operationQueue:$}=this,j=_.map(et=>this.appendBlocker(et));return _.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(j).then(et=>{$===this.operationQueue&&(i(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(i){i.forEach(_=>{var $;const j=($=this.tracks[_])==null?void 0:$.buffer;!j||j.updating||this.shiftAndExecuteNext(_)})}append(i,_,$){this.operationQueue&&this.operationQueue.append(i,_,$)}appendBlocker(i){if(this.operationQueue)return this.operationQueue.appendBlocker(i)}currentOp(i){return this.operationQueue?this.operationQueue.current(i):null}executeNext(i){i&&this.operationQueue&&this.operationQueue.executeNext(i)}shiftAndExecuteNext(i){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(i)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((i,_)=>i+(this.isPending(this.tracks[_])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((i,[_])=>i+(_?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([i])=>i).filter(i=>!!i)}addBufferListener(i,_,$){const j=this.tracks[i];if(!j)return;const _e=j.buffer;if(!_e)return;const et=$.bind(this,i);j.listeners.push({event:_,listener:et}),_e.addEventListener(_,et)}removeBufferListeners(i){const _=this.tracks[i];if(!_)return;const $=_.buffer;$&&(_.listeners.forEach(j=>{$.removeEventListener(j.event,j.listener)}),_.listeners.length=0)}}function removeSourceChildren(o){const i=o.querySelectorAll("source");[].slice.call(i).forEach(_=>{o.removeChild(_)})}function addSource(o,i){const _=self.document.createElement("source");_.type="video/mp4",_.src=i,o.appendChild(_)}function sourceBufferNameToIndex(o){return o==="audio"?1:0}class CapLevelController{constructor(i){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=i,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(i){this.streamController=i}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:i}=this;i.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),i.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:i}=this;i.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),i.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(i,_){const $=this.hls.levels[_.droppedLevel];this.isLevelAllowed($)&&this.restrictedLevels.push({bitrate:$.bitrate,height:$.height,width:$.width})}onMediaAttaching(i,_){this.media=_.media instanceof HTMLVideoElement?_.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(i,_){const $=this.hls;this.restrictedLevels=[],this.firstLevel=_.firstLevel,$.config.capLevelToPlayerSize&&_.video&&this.startCapping()}onLevelsUpdated(i,_){this.timer&&isFiniteNumber(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(i,_){this.hls.config.capLevelToPlayerSize&&_.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const i=this.hls.levels;if(i.length){const _=this.hls,$=this.getMaxLevel(i.length-1);$!==this.autoLevelCapping&&_.logger.log(`Setting autoLevelCapping to ${$}: ${i[$].height}p@${i[$].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),_.autoLevelCapping=$,_.autoLevelEnabled&&_.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=_.autoLevelCapping}}}getMaxLevel(i){const _=this.hls.levels;if(!_.length)return-1;const $=_.filter((j,_e)=>this.isLevelAllowed(j)&&_e<=i);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize($,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const i=this.media,_={width:0,height:0};if(i){const $=i.getBoundingClientRect();_.width=$.width,_.height=$.height,!_.width&&!_.height&&(_.width=$.right-$.left||i.width||0,_.height=$.bottom-$.top||i.height||0)}return this.clientRect=_,_}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let i=1;if(!this.hls.config.ignoreDevicePixelRatio)try{i=self.devicePixelRatio}catch{}return Math.min(i,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(i){return!this.restrictedLevels.some($=>i.bitrate===$.bitrate&&i.width===$.width&&i.height===$.height)}static getMaxLevelByMediaSize(i,_,$){if(!(i!=null&&i.length))return-1;const j=(tt,rt)=>rt?tt.width!==rt.width||tt.height!==rt.height:!0;let _e=i.length-1;const et=Math.max(_,$);for(let tt=0;tt<i.length;tt+=1){const rt=i[tt];if((rt.width>=et||rt.height>=et)&&j(rt,i[tt+1])){_e=tt;break}}return _e}}const CmObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},CmcdObjectType=CmObjectType,CmStreamingFormat={HLS:"h"},CmcdStreamingFormat=CmStreamingFormat;class SfItem{constructor(i,_){Array.isArray(i)&&(i=i.map($=>$ instanceof SfItem?$:new SfItem($))),this.value=i,this.params=_}}const DICT="Dict";function format(o){return Array.isArray(o)?JSON.stringify(o):o instanceof Map?"Map{}":o instanceof Set?"Set{}":typeof o=="object"?JSON.stringify(o):String(o)}function throwError(o,i,_,$){return new Error(`failed to ${o} "${format(i)}" as ${_}`,{cause:$})}function serializeError(o,i,_){return throwError("serialize",o,i,_)}class SfToken{constructor(i){this.description=i}}const BARE_ITEM="Bare Item",BOOLEAN="Boolean";function serializeBoolean(o){if(typeof o!="boolean")throw serializeError(o,BOOLEAN);return o?"?1":"?0"}function encodeBase64(o){return btoa(String.fromCharCode(...o))}const BYTES="Byte Sequence";function serializeByteSequence(o){if(ArrayBuffer.isView(o)===!1)throw serializeError(o,BYTES);return`:${encodeBase64(o)}:`}const INTEGER="Integer";function isInvalidInt(o){return o<-999999999999999||999999999999999<o}function serializeInteger(o){if(isInvalidInt(o))throw serializeError(o,INTEGER);return o.toString()}function serializeDate(o){return`@${serializeInteger(o.getTime()/1e3)}`}function roundToEven(o,i){if(o<0)return-roundToEven(-o,i);const _=Math.pow(10,i);if(Math.abs(o*_%1-.5)<Number.EPSILON){const j=Math.floor(o*_);return(j%2===0?j:j+1)/_}else return Math.round(o*_)/_}const DECIMAL="Decimal";function serializeDecimal(o){const i=roundToEven(o,3);if(Math.floor(Math.abs(i)).toString().length>12)throw serializeError(o,DECIMAL);const _=i.toString();return _.includes(".")?_:`${_}.0`}const STRING="String",STRING_REGEX=/[\x00-\x1f\x7f]+/;function serializeString(o){if(STRING_REGEX.test(o))throw serializeError(o,STRING);return`"${o.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function symbolToStr(o){return o.description||o.toString().slice(7,-1)}const TOKEN="Token";function serializeToken(o){const i=symbolToStr(o);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(i)===!1)throw serializeError(i,TOKEN);return i}function serializeBareItem(o){switch(typeof o){case"number":if(!isFiniteNumber(o))throw serializeError(o,BARE_ITEM);return Number.isInteger(o)?serializeInteger(o):serializeDecimal(o);case"string":return serializeString(o);case"symbol":return serializeToken(o);case"boolean":return serializeBoolean(o);case"object":if(o instanceof Date)return serializeDate(o);if(o instanceof Uint8Array)return serializeByteSequence(o);if(o instanceof SfToken)return serializeToken(o);default:throw serializeError(o,BARE_ITEM)}}const KEY="Key";function serializeKey(o){if(/^[a-z*][a-z0-9\-_.*]*$/.test(o)===!1)throw serializeError(o,KEY);return o}function serializeParams(o){return o==null?"":Object.entries(o).map(([i,_])=>_===!0?`;${serializeKey(i)}`:`;${serializeKey(i)}=${serializeBareItem(_)}`).join("")}function serializeItem(o){return o instanceof SfItem?`${serializeBareItem(o.value)}${serializeParams(o.params)}`:serializeBareItem(o)}function serializeInnerList(o){return`(${o.value.map(serializeItem).join(" ")})${serializeParams(o.params)}`}function serializeDict(o,i={whitespace:!0}){if(typeof o!="object"||o==null)throw serializeError(o,DICT);const _=o instanceof Map?o.entries():Object.entries(o),$=i!=null&&i.whitespace?" ":"";return Array.from(_).map(([j,_e])=>{_e instanceof SfItem||(_e=new SfItem(_e));let et=serializeKey(j);return _e.value===!0?et+=serializeParams(_e.params):(et+="=",Array.isArray(_e.value)?et+=serializeInnerList(_e):et+=serializeItem(_e)),et}).join(`,${$}`)}function encodeSfDict(o,i){return serializeDict(o,i)}const CMCD_OBJECT="CMCD-Object",CMCD_REQUEST="CMCD-Request",CMCD_SESSION="CMCD-Session",CMCD_STATUS="CMCD-Status",CMCD_HEADER_MAP={br:CMCD_OBJECT,ab:CMCD_OBJECT,d:CMCD_OBJECT,ot:CMCD_OBJECT,tb:CMCD_OBJECT,tpb:CMCD_OBJECT,lb:CMCD_OBJECT,tab:CMCD_OBJECT,lab:CMCD_OBJECT,url:CMCD_OBJECT,pb:CMCD_REQUEST,bl:CMCD_REQUEST,tbl:CMCD_REQUEST,dl:CMCD_REQUEST,ltc:CMCD_REQUEST,mtp:CMCD_REQUEST,nor:CMCD_REQUEST,nrr:CMCD_REQUEST,rc:CMCD_REQUEST,sn:CMCD_REQUEST,sta:CMCD_REQUEST,su:CMCD_REQUEST,ttfb:CMCD_REQUEST,ttfbb:CMCD_REQUEST,ttlb:CMCD_REQUEST,cmsdd:CMCD_REQUEST,cmsds:CMCD_REQUEST,smrt:CMCD_REQUEST,df:CMCD_REQUEST,cs:CMCD_REQUEST,ts:CMCD_REQUEST,cid:CMCD_SESSION,pr:CMCD_SESSION,sf:CMCD_SESSION,sid:CMCD_SESSION,st:CMCD_SESSION,v:CMCD_SESSION,msd:CMCD_SESSION,bs:CMCD_STATUS,bsd:CMCD_STATUS,cdn:CMCD_STATUS,rtp:CMCD_STATUS,bg:CMCD_STATUS,pt:CMCD_STATUS,ec:CMCD_STATUS,e:CMCD_STATUS},CmcdHeaderField={REQUEST:CMCD_REQUEST};function createHeaderMap(o){return Object.keys(o).reduce((i,_)=>{var $;return($=o[_])===null||$===void 0||$.forEach(j=>i[j]=_),i},{})}function groupCmcdHeaders(o,i){const _={};if(!o)return _;const $=Object.keys(o),j=i?createHeaderMap(i):{};return $.reduce((_e,et)=>{var tt;const rt=CMCD_HEADER_MAP[et]||j[et]||CmcdHeaderField.REQUEST,nt=(tt=_e[rt])!==null&&tt!==void 0?tt:_e[rt]={};return nt[et]=o[et],_e},_)}function isTokenField(o){return["ot","sf","st","e","sta"].includes(o)}function isValid(o){return typeof o=="number"?isFiniteNumber(o):o!=null&&o!==""&&o!==!1}const CMCD_EVENT_MODE="event";function urlToRelativePath(o,i){const _=new URL(o),$=new URL(i);if(_.origin!==$.origin)return o;const j=_.pathname.split("/").slice(1),_e=$.pathname.split("/").slice(1,-1);for(;j[0]===_e[0];)j.shift(),_e.shift();for(;_e.length;)_e.shift(),j.unshift("..");return j.join("/")+_.search+_.hash}const toRounded=o=>Math.round(o),toUrlSafe=(o,i)=>Array.isArray(o)?o.map(_=>toUrlSafe(_,i)):o instanceof SfItem&&typeof o.value=="string"?new SfItem(toUrlSafe(o.value,i),o.params):(i.baseUrl&&(o=urlToRelativePath(o,i.baseUrl)),i.version===1?encodeURIComponent(o):o),toHundred=o=>toRounded(o/100)*100,nor=(o,i)=>{let _=o;return i.version>=2&&(o instanceof SfItem&&typeof o.value=="string"?_=new SfItem([o]):typeof o=="string"&&(_=[o])),toUrlSafe(_,i)},CMCD_FORMATTER_MAP={br:toRounded,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor,rtp:toHundred,tb:toRounded},CMCD_REQUEST_MODE="request",CMCD_RESPONSE_MODE="response",CMCD_COMMON_KEYS=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],CMCD_EVENT_KEYS=["e"],CUSTOM_KEY_REGEX=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function isCmcdCustomKey(o){return CUSTOM_KEY_REGEX.test(o)}function isCmcdEventKey(o){return CMCD_COMMON_KEYS.includes(o)||CMCD_EVENT_KEYS.includes(o)||isCmcdCustomKey(o)}const CMCD_REQUEST_KEYS=["d","dl","nor","ot","rtp","su"];function isCmcdRequestKey(o){return CMCD_COMMON_KEYS.includes(o)||CMCD_REQUEST_KEYS.includes(o)||isCmcdCustomKey(o)}const CMCD_RESPONSE_KEYS=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function isCmcdResponseKey(o){return CMCD_COMMON_KEYS.includes(o)||CMCD_REQUEST_KEYS.includes(o)||CMCD_RESPONSE_KEYS.includes(o)||isCmcdCustomKey(o)}const CMCD_V1_KEYS=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function isCmcdV1Key(o){return CMCD_V1_KEYS.includes(o)||isCmcdCustomKey(o)}const filterMap={[CMCD_RESPONSE_MODE]:isCmcdResponseKey,[CMCD_EVENT_MODE]:isCmcdEventKey,[CMCD_REQUEST_MODE]:isCmcdRequestKey};function prepareCmcdData(o,i={}){const _={};if(o==null||typeof o!="object")return _;const $=i.version||o.v||1,j=i.reportingMode||CMCD_REQUEST_MODE,_e=$===1?isCmcdV1Key:filterMap[j];let et=Object.keys(o).filter(_e);const tt=i.filter;typeof tt=="function"&&(et=et.filter(tt));const rt=j===CMCD_RESPONSE_MODE||j===CMCD_EVENT_MODE;rt&&!et.includes("ts")&&et.push("ts"),$>1&&!et.includes("v")&&et.push("v");const nt=_extends({},CMCD_FORMATTER_MAP,i.formatters),it={version:$,reportingMode:j,baseUrl:i.baseUrl};return et.sort().forEach(st=>{let at=o[st];const ot=nt[st];if(typeof ot=="function"&&(at=ot(at,it)),st==="v"){if($===1)return;at=$}st=="pr"&&at===1||(rt&&st==="ts"&&!isFiniteNumber(at)&&(at=Date.now()),isValid(at)&&(isTokenField(st)&&typeof at=="string"&&(at=new SfToken(at)),_[st]=at))}),_}function toCmcdHeaders(o,i={}){const _={};if(!o)return _;const $=prepareCmcdData(o,i),j=groupCmcdHeaders($,i==null?void 0:i.customHeaderMap);return Object.entries(j).reduce((_e,[et,tt])=>{const rt=encodeSfDict(tt,{whitespace:!1});return rt&&(_e[et]=rt),_e},_)}function appendCmcdHeaders(o,i,_){return _extends(o,toCmcdHeaders(i,_))}const CMCD_PARAM="CMCD";function encodeCmcd(o,i={}){return o?encodeSfDict(prepareCmcdData(o,i),{whitespace:!1}):""}function toCmcdUrl(o,i={}){if(!o)return"";const _=encodeCmcd(o,i);return encodeURIComponent(_)}function toCmcdQuery(o,i={}){if(!o)return"";const _=toCmcdUrl(o,i);return`${CMCD_PARAM}=${_}`}const REGEX=/CMCD=[^&#]+/;function appendCmcdQuery(o,i,_){const $=toCmcdQuery(i,_);if(!$)return o;if(REGEX.test(o))return o.replace(REGEX,$);const j=o.includes("?")?"&":"?";return`${o}${j}${$}`}class CMCDController{constructor(i){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=j=>{try{this.apply(j,{ot:CmcdObjectType.MANIFEST,su:!this.initialized})}catch(_e){this.hls.logger.warn("Could not generate manifest CMCD data.",_e)}},this.applyFragmentData=j=>{try{const{frag:_e,part:et}=j,tt=this.hls.levels[_e.level],rt=this.getObjectType(_e),nt={d:(et||_e).duration*1e3,ot:rt};(rt===CmcdObjectType.VIDEO||rt===CmcdObjectType.AUDIO||rt==CmcdObjectType.MUXED)&&(nt.br=tt.bitrate/1e3,nt.tb=this.getTopBandwidth(rt)/1e3,nt.bl=this.getBufferLength(rt));const it=et?this.getNextPart(et):this.getNextFrag(_e);it!=null&&it.url&&it.url!==_e.url&&(nt.nor=it.url),this.apply(j,nt)}catch(_e){this.hls.logger.warn("Could not generate segment CMCD data.",_e)}},this.hls=i;const _=this.config=i.config,{cmcd:$}=_;$!=null&&(_.pLoader=this.createPlaylistLoader(),_.fLoader=this.createFragmentLoader(),this.sid=$.sessionId||i.sessionId,this.cid=$.contentId,this.useHeaders=$.useHeaders===!0,this.includeKeys=$.includeKeys,this.registerListeners())}registerListeners(){const i=this.hls;i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),i.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const i=this.hls;i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),i.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(i,_){this.media=_.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(i,_){var $,j;this.audioBuffer=($=_.tracks.audio)==null?void 0:$.buffer,this.videoBuffer=(j=_.tracks.video)==null?void 0:j.buffer}createData(){var i;return{v:1,sf:CmcdStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(i=this.media)==null?void 0:i.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(i,_={}){_extends(_,this.createData());const $=_.ot===CmcdObjectType.INIT||_.ot===CmcdObjectType.VIDEO||_.ot===CmcdObjectType.MUXED;this.starved&&$&&(_.bs=!0,_.su=!0,this.starved=!1),_.su==null&&(_.su=this.buffering);const{includeKeys:j}=this;j&&(_=Object.keys(_).reduce((et,tt)=>(j.includes(tt)&&(et[tt]=_[tt]),et),{}));const _e={baseUrl:i.url};this.useHeaders?(i.headers||(i.headers={}),appendCmcdHeaders(i.headers,_,_e)):i.url=appendCmcdQuery(i.url,_,_e)}getNextFrag(i){var _;const $=(_=this.hls.levels[i.level])==null?void 0:_.details;if($){const j=i.sn-$.startSN;return $.fragments[j+1]}}getNextPart(i){var _;const{index:$,fragment:j}=i,_e=(_=this.hls.levels[j.level])==null||(_=_.details)==null?void 0:_.partList;if(_e){const{sn:et}=j;for(let tt=_e.length-1;tt>=0;tt--){const rt=_e[tt];if(rt.index===$&&rt.fragment.sn===et)return _e[tt+1]}}}getObjectType(i){const{type:_}=i;if(_==="subtitle")return CmcdObjectType.TIMED_TEXT;if(i.sn==="initSegment")return CmcdObjectType.INIT;if(_==="audio")return CmcdObjectType.AUDIO;if(_==="main")return this.hls.audioTracks.length?CmcdObjectType.VIDEO:CmcdObjectType.MUXED}getTopBandwidth(i){let _=0,$;const j=this.hls;if(i===CmcdObjectType.AUDIO)$=j.audioTracks;else{const _e=j.maxAutoLevel,et=_e>-1?_e+1:j.levels.length;$=j.levels.slice(0,et)}return $.forEach(_e=>{_e.bitrate>_&&(_=_e.bitrate)}),_>0?_:NaN}getBufferLength(i){const _=this.media,$=i===CmcdObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!$||!_?NaN:BufferHelper.bufferInfo($,_.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:i}=this.config,_=this.applyPlaylistData,$=i||this.config.loader;return class{constructor(_e){this.loader=void 0,this.loader=new $(_e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(_e,et,tt){_(_e),this.loader.load(_e,et,tt)}}}createFragmentLoader(){const{fLoader:i}=this.config,_=this.applyFragmentData,$=i||this.config.loader;return class{constructor(_e){this.loader=void 0,this.loader=new $(_e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(_e,et,tt){_(_e),this.loader.load(_e,et,tt)}}}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController extends Logger$1{constructor(i){super("content-steering",i.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=i,this.registerListeners()}registerListeners(){const i=this.hls;i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const i=this.hls;i&&(i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((i,_)=>(i.indexOf(_.pathwayId)===-1&&i.push(_.pathwayId),i),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(i){this.updatePathwayPriority(i)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const i=this.timeToLoad*1e3-(performance.now()-this.updated);if(i>0){this.scheduleRefresh(this.uri,i);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(i){const _=this.levels;_&&(this.levels=_.filter($=>$!==i))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(i,_){const{contentSteering:$}=_;$!==null&&(this.pathwayId=$.pathwayId,this.uri=$.uri,this.started&&this.startLoad())}onManifestParsed(i,_){this.audioTracks=_.audioTracks,this.subtitleTracks=_.subtitleTracks}onError(i,_){const{errorAction:$}=_;if(($==null?void 0:$.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&$.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){const j=this.levels;let _e=this._pathwayPriority,et=this.pathwayId;if(_.context){const{groupId:tt,pathwayId:rt,type:nt}=_.context;tt&&j?et=this.getPathwayForGroupId(tt,nt,et):rt&&(et=rt)}et in this.penalizedPathways||(this.penalizedPathways[et]=performance.now()),!_e&&j&&(_e=this.pathways()),_e&&_e.length>1&&(this.updatePathwayPriority(_e),$.resolved=this.pathwayId!==et),_.details===ErrorDetails.BUFFER_APPEND_ERROR&&!_.fatal?$.resolved=!0:$.resolved||this.warn(`Could not resolve ${_.details} ("${_.error.message}") with content-steering for Pathway: ${et} levels: ${j&&j.length} priorities: ${stringify(_e)} penalized: ${stringify(this.penalizedPathways)}`)}}filterParsedLevels(i){this.levels=i;let _=this.getLevelsForPathway(this.pathwayId);if(_.length===0){const $=i[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${$}"`),_=this.getLevelsForPathway($),this.pathwayId=$}return _.length!==i.length&&this.log(`Found ${_.length}/${i.length} levels in Pathway "${this.pathwayId}"`),_}getLevelsForPathway(i){return this.levels===null?[]:this.levels.filter(_=>i===_.pathwayId)}updatePathwayPriority(i){this._pathwayPriority=i;let _;const $=this.penalizedPathways,j=performance.now();Object.keys($).forEach(_e=>{j-$[_e]>PATHWAY_PENALTY_DURATION_MS&&delete $[_e]});for(let _e=0;_e<i.length;_e++){const et=i[_e];if(et in $)continue;if(et===this.pathwayId)return;const tt=this.hls.nextLoadLevel,rt=this.hls.levels[tt];if(_=this.getLevelsForPathway(et),_.length>0){this.log(`Setting Pathway to "${et}"`),this.pathwayId=et,reassignFragmentLevelIndexes(_),this.hls.trigger(Events.LEVELS_UPDATED,{levels:_});const nt=this.hls.levels[tt];rt&&nt&&this.levels&&(nt.attrs["STABLE-VARIANT-ID"]!==rt.attrs["STABLE-VARIANT-ID"]&&nt.bitrate!==rt.bitrate&&this.log(`Unstable Pathways change from bitrate ${rt.bitrate} to ${nt.bitrate}`),this.hls.nextLoadLevel=tt);break}}}getPathwayForGroupId(i,_,$){const j=this.getLevelsForPathway($).concat(this.levels||[]);for(let _e=0;_e<j.length;_e++)if(_===PlaylistContextType.AUDIO_TRACK&&j[_e].hasAudioGroup(i)||_===PlaylistContextType.SUBTITLE_TRACK&&j[_e].hasSubtitleGroup(i))return j[_e].pathwayId;return $}clonePathways(i){const _=this.levels;if(!_)return;const $={},j={};i.forEach(_e=>{const{ID:et,"BASE-ID":tt,"URI-REPLACEMENT":rt}=_e;if(_.some(it=>it.pathwayId===et))return;const nt=this.getLevelsForPathway(tt).map(it=>{const st=new AttrList(it.attrs);st["PATHWAY-ID"]=et;const at=st.AUDIO&&`${st.AUDIO}_clone_${et}`,ot=st.SUBTITLES&&`${st.SUBTITLES}_clone_${et}`;at&&($[st.AUDIO]=at,st.AUDIO=at),ot&&(j[st.SUBTITLES]=ot,st.SUBTITLES=ot);const lt=performUriReplacement(it.uri,st["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",rt),ct=new Level({attrs:st,audioCodec:it.audioCodec,bitrate:it.bitrate,height:it.height,name:it.name,url:lt,videoCodec:it.videoCodec,width:it.width});if(it.audioGroups)for(let ft=1;ft<it.audioGroups.length;ft++)ct.addGroupId("audio",`${it.audioGroups[ft]}_clone_${et}`);if(it.subtitleGroups)for(let ft=1;ft<it.subtitleGroups.length;ft++)ct.addGroupId("text",`${it.subtitleGroups[ft]}_clone_${et}`);return ct});_.push(...nt),cloneRenditionGroups(this.audioTracks,$,rt,et),cloneRenditionGroups(this.subtitleTracks,j,rt,et)})}loadSteeringManifest(i){const _=this.hls.config,$=_.loader;this.loader&&this.loader.destroy(),this.loader=new $(_);let j;try{j=new self.URL(i)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${i}`);return}if(j.protocol!=="data:"){const it=(this.hls.bandwidthEstimate||_.abrEwmaDefaultEstimate)|0;j.searchParams.set("_HLS_pathway",this.pathwayId),j.searchParams.set("_HLS_throughput",""+it)}const _e={responseType:"json",url:j.href},et=_.steeringManifestLoadPolicy.default,tt=et.errorRetry||et.timeoutRetry||{},rt={loadPolicy:et,timeout:et.maxLoadTimeMs,maxRetry:tt.maxNumRetry||0,retryDelay:tt.retryDelayMs||0,maxRetryDelay:tt.maxRetryDelayMs||0},nt={onSuccess:(it,st,at,ot)=>{this.log(`Loaded steering manifest: "${j}"`);const lt=it.data;if((lt==null?void 0:lt.VERSION)!==1){this.log(`Steering VERSION ${lt.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=lt.TTL;const{"RELOAD-URI":ct,"PATHWAY-CLONES":ft,"PATHWAY-PRIORITY":ut}=lt;if(ct)try{this.uri=new self.URL(ct,j).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${ct}`);return}this.scheduleRefresh(this.uri||at.url),ft&&this.clonePathways(ft);const ht={steeringManifest:lt,url:j.toString()};this.hls.trigger(Events.STEERING_MANIFEST_LOADED,ht),ut&&this.updatePathwayPriority(ut)},onError:(it,st,at,ot)=>{if(this.log(`Error loading steering manifest: ${it.code} ${it.text} (${st.url})`),this.stopLoad(),it.code===410){this.enabled=!1,this.log(`Steering manifest ${st.url} no longer available`);return}let lt=this.timeToLoad*1e3;if(it.code===429){const ct=this.loader;if(typeof(ct==null?void 0:ct.getResponseHeader)=="function"){const ft=ct.getResponseHeader("Retry-After");ft&&(lt=parseFloat(ft)*1e3)}this.log(`Steering manifest ${st.url} rate limited`);return}this.scheduleRefresh(this.uri||st.url,lt)},onTimeout:(it,st,at)=>{this.log(`Timeout loading steering manifest (${st.url})`),this.scheduleRefresh(this.uri||st.url)}};this.log(`Requesting steering manifest: ${j}`),this.loader.load(_e,rt,nt)}scheduleRefresh(i,_=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var $;const j=($=this.hls)==null?void 0:$.media;if(j&&!j.ended){this.loadSteeringManifest(i);return}this.scheduleRefresh(i,this.timeToLoad*1e3)},_)}}function cloneRenditionGroups(o,i,_,$){o&&Object.keys(i).forEach(j=>{const _e=o.filter(et=>et.groupId===j).map(et=>{const tt=_extends({},et);return tt.details=void 0,tt.attrs=new AttrList(tt.attrs),tt.url=tt.attrs.URI=performUriReplacement(et.url,et.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",_),tt.groupId=tt.attrs["GROUP-ID"]=i[j],tt.attrs["PATHWAY-ID"]=$,tt});o.push(..._e)})}function performUriReplacement(o,i,_,$){const{HOST:j,PARAMS:_e,[_]:et}=$;let tt;i&&(tt=et==null?void 0:et[i],tt&&(o=tt));const rt=new self.URL(o);return j&&!tt&&(rt.host=j),_e&&Object.keys(_e).sort().forEach(nt=>{nt&&rt.searchParams.set(nt,_e[nt])}),rt.href}class EMEController extends Logger$1{constructor(i){super("eme",i.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=_=>{const{initDataType:$,initData:j}=_,_e=`"${_.type}" event: init data type: "${$}"`;if(this.debug(_e),j!==null){if(!this.keyFormatPromise){let et=Object.keys(this.keySystemAccessPromises);et.length||(et=getKeySystemsForConfig(this.config));const tt=et.map(keySystemDomainToKeySystemFormat).filter(rt=>!!rt);this.keyFormatPromise=this.getKeyFormatPromise(tt)}this.keyFormatPromise.then(et=>{const tt=keySystemFormatToKeySystemDomain(et);if($!=="sinf"||tt!==KeySystems.FAIRPLAY){this.log(`Ignoring "${_.type}" event with init data type: "${$}" for selected key-system ${tt}`);return}let rt;try{const ot=bin2str(new Uint8Array(j)),lt=base64Decode(JSON.parse(ot).sinf),ct=parseSinf(lt);if(!ct)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");rt=new Uint8Array(ct.subarray(8,24))}catch(ot){this.warn(`${_e} Failed to parse sinf: ${ot}`);return}const nt=arrayToHex(rt),{keyIdToKeySessionPromise:it,mediaKeySessions:st}=this;let at=it[nt];for(let ot=0;ot<st.length;ot++){const lt=st[ot],ct=lt.decryptdata;if(!ct.keyId)continue;const ft=arrayToHex(ct.keyId);if(arrayValuesMatch(rt,ct.keyId)||ct.uri.replace(/-/g,"").indexOf(nt)!==-1){if(at=it[ft],!at)continue;if(ct.pssh)break;delete it[ft],ct.pssh=new Uint8Array(j),ct.keyId=rt,at=it[nt]=at.then(()=>this.generateRequestWithPreferredKeySession(lt,$,j,"encrypted-event-key-match")),at.catch(ut=>this.handleError(ut));break}}at||this.handleError(new Error(`Key ID ${nt} not encountered in playlist. Key-system sessions ${st.length}.`))}).catch(et=>this.handleError(et))}},this.onWaitingForKey=_=>{this.log(`"${_.type}" event`)},this.hls=i,this.config=i.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const i=this.config;i.requestMediaKeySystemAccessFunc=null,i.licenseXhrSetup=i.licenseResponseCallback=void 0,i.drmSystems=i.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(Events.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(Events.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(i){const{drmSystems:_,widevineLicenseUrl:$}=this.config,j=_==null?void 0:_[i];if(j)return j.licenseUrl;if(i===KeySystems.WIDEVINE&&$)return $}getLicenseServerUrlOrThrow(i){const _=this.getLicenseServerUrl(i);if(_===void 0)throw new Error(`no license server URL configured for key-system "${i}"`);return _}getServerCertificateUrl(i){const{drmSystems:_}=this.config,$=_==null?void 0:_[i];if($)return $.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${i}"]`)}attemptKeySystemAccess(i){const _=this.hls.levels,$=(et,tt,rt)=>!!et&&rt.indexOf(et)===tt,j=_.map(et=>et.audioCodec).filter($),_e=_.map(et=>et.videoCodec).filter($);return j.length+_e.length===0&&_e.push("avc1.42e01e"),new Promise((et,tt)=>{const rt=nt=>{const it=nt.shift();this.getMediaKeysPromise(it,j,_e).then(st=>et({keySystem:it,mediaKeys:st})).catch(st=>{nt.length?rt(nt):st instanceof EMEKeyError?tt(st):tt(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:st,fatal:!0},st.message))})};rt(i)})}requestMediaKeySystemAccess(i,_){const{requestMediaKeySystemAccessFunc:$}=this.config;if(typeof $!="function"){let j=`Configured requestMediaKeySystemAccess is not a function ${$}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(j=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(j))}return $(i,_)}getMediaKeysPromise(i,_,$){var j;const _e=getSupportedMediaKeySystemConfigurations(i,_,$,this.config.drmSystemOptions||{});let et=this.keySystemAccessPromises[i],tt=(j=et)==null?void 0:j.keySystemAccess;if(!tt){this.log(`Requesting encrypted media "${i}" key-system access with config: ${stringify(_e)}`),tt=this.requestMediaKeySystemAccess(i,_e);const rt=et=this.keySystemAccessPromises[i]={keySystemAccess:tt};return tt.catch(nt=>{this.log(`Failed to obtain access to key-system "${i}": ${nt}`)}),tt.then(nt=>{this.log(`Access for key-system "${nt.keySystem}" obtained`);const it=this.fetchServerCertificate(i);this.log(`Create media-keys for "${i}"`);const st=rt.mediaKeys=nt.createMediaKeys().then(at=>(this.log(`Media-keys created for "${i}"`),rt.hasMediaKeys=!0,it.then(ot=>ot?this.setMediaKeysServerCertificate(at,i,ot):at)));return st.catch(at=>{this.error(`Failed to create media-keys for "${i}"}: ${at}`)}),st})}return tt.then(()=>et.mediaKeys)}createMediaKeySessionContext({decryptdata:i,keySystem:_,mediaKeys:$}){this.log(`Creating key-system session "${_}" keyId: ${arrayToHex(i.keyId||[])} keyUri: ${i.uri}`);const j=$.createSession(),_e={decryptdata:i,keySystem:_,mediaKeys:$,mediaKeysSession:j,keyStatus:"status-pending"};return this.mediaKeySessions.push(_e),_e}renewKeySession(i){const _=i.decryptdata;if(_.pssh){const $=this.createMediaKeySessionContext(i),j=getKeyIdString(_),_e="cenc";this.keyIdToKeySessionPromise[j]=this.generateRequestWithPreferredKeySession($,_e,_.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(i)}updateKeySession(i,_){const $=i.mediaKeysSession;return this.log(`Updating key-session "${$.sessionId}" for keyId ${arrayToHex(i.decryptdata.keyId||[])}
      } (data length: ${_.byteLength})`),$.update(_)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(i=>({keySystem:i,hasMediaKeys:this.keySystemAccessPromises[i].hasMediaKeys})).filter(({hasMediaKeys:i})=>!!i).map(({keySystem:i})=>keySystemDomainToKeySystemFormat(i)).filter(i=>!!i)}getKeySystemAccess(i){return this.getKeySystemSelectionPromise(i).then(({keySystem:_,mediaKeys:$})=>this.attemptSetMediaKeys(_,$))}selectKeySystem(i){return new Promise((_,$)=>{this.getKeySystemSelectionPromise(i).then(({keySystem:j})=>{const _e=keySystemDomainToKeySystemFormat(j);_e?_(_e):$(new Error(`Unable to find format for key-system "${j}"`))}).catch($)})}selectKeySystemFormat(i){const _=Object.keys(i.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${i.sn} ${i.type}: ${i.level}) key formats ${_.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(_)),this.keyFormatPromise}getKeyFormatPromise(i){const _=getKeySystemsForConfig(this.config),$=i.map(keySystemFormatToKeySystemDomain).filter(j=>!!j&&_.indexOf(j)!==-1);return this.selectKeySystem($)}getKeyStatus(i){const{mediaKeySessions:_}=this;for(let $=0;$<_.length;$++){const j=getKeyStatus(i,_[$]);if(j)return j}}loadKey(i){const _=i.keyInfo.decryptdata,$=getKeyIdString(_),j=this.bannedKeyIds[$];if(j||this.getKeyStatus(_)==="internal-error"){const tt=getKeyStatusError(j||"internal-error",_);return this.handleError(tt,i.frag),Promise.reject(tt)}const _e=`(keyId: ${$} format: "${_.keyFormat}" method: ${_.method} uri: ${_.uri})`;this.log(`Starting session for key ${_e}`);const et=this.keyIdToKeySessionPromise[$];if(!et){const tt=this.getKeySystemForKeyPromise(_).then(({keySystem:rt,mediaKeys:nt})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${i.frag.sn} ${i.frag.type}: ${i.frag.level} using key ${_e}`),this.attemptSetMediaKeys(rt,nt).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:rt,mediaKeys:nt,decryptdata:_}))))).then(rt=>{const nt="cenc",it=_.pssh?_.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(rt,nt,it,"playlist-key")});return tt.catch(rt=>this.handleError(rt,i.frag)),this.keyIdToKeySessionPromise[$]=tt,tt}return et.catch(tt=>{if(tt instanceof EMEKeyError){const rt=_objectSpread2({},tt.data);this.getKeyStatus(_)==="internal-error"&&(rt.decryptdata=_);const nt=new EMEKeyError(rt,tt.message);this.handleError(nt,i.frag)}}),et}throwIfDestroyed(i="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(i,_){if(this.hls)if(i instanceof EMEKeyError){_&&(i.data.frag=_);const $=i.data.decryptdata;this.error(`${i.message}${$?` (${arrayToHex($.keyId||[])})`:""}`),this.hls.trigger(Events.ERROR,i.data)}else this.error(i.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:i,fatal:!0})}getKeySystemForKeyPromise(i){const _=getKeyIdString(i),$=this.keyIdToKeySessionPromise[_];if(!$){const j=keySystemFormatToKeySystemDomain(i.keyFormat),_e=j?[j]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(_e)}return $}getKeySystemSelectionPromise(i){if(i.length||(i=getKeySystemsForConfig(this.config)),i.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(i)}attemptSetMediaKeys(i,_){if(this.mediaKeys===_)return Promise.resolve();const $=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${i}"`);const j=Promise.all($).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(_)});return this.mediaKeys=_,this.setMediaKeysQueue.push(j),j.then(()=>{this.log(`Media-keys set for "${i}"`),$.push(j),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(_e=>$.indexOf(_e)===-1)})}generateRequestWithPreferredKeySession(i,_,$,j){var _e;const et=(_e=this.config.drmSystems)==null||(_e=_e[i.keySystem])==null?void 0:_e.generateRequest;if(et)try{const lt=et.call(this.hls,_,$,i);if(!lt)throw new Error("Invalid response from configured generateRequest filter");_=lt.initDataType,$=lt.initData?lt.initData:null,i.decryptdata.pssh=$?new Uint8Array($):null}catch(lt){if(this.warn(lt.message),this.hls&&this.hls.config.debug)throw lt}if($===null)return this.log(`Skipping key-session request for "${j}" (no initData)`),Promise.resolve(i);const tt=getKeyIdString(i.decryptdata),rt=i.decryptdata.uri;this.log(`Generating key-session request for "${j}" keyId: ${tt} URI: ${rt} (init data type: ${_} length: ${$.byteLength})`);const nt=new EventEmitter$1,it=i._onmessage=lt=>{const ct=i.mediaKeysSession;if(!ct){nt.emit("error",new Error("invalid state"));return}const{messageType:ft,message:ut}=lt;this.log(`"${ft}" message event for session "${ct.sessionId}" message size: ${ut.byteLength}`),ft==="license-request"||ft==="license-renewal"?this.renewLicense(i,ut).catch(ht=>{nt.eventNames().length?nt.emit("error",ht):this.handleError(ht)}):ft==="license-release"?i.keySystem===KeySystems.FAIRPLAY&&this.updateKeySession(i,strToUtf8array("acknowledged")).then(()=>this.removeSession(i)).catch(ht=>this.handleError(ht)):this.warn(`unhandled media key message type "${ft}"`)},st=(lt,ct)=>{ct.keyStatus=lt;let ft;lt.startsWith("usable")?nt.emit("resolved"):lt==="internal-error"||lt==="output-restricted"||lt==="output-downscaled"?ft=getKeyStatusError(lt,ct.decryptdata):lt==="expired"?ft=new Error(`key expired (keyId: ${tt})`):lt==="released"?ft=new Error("key released"):lt==="status-pending"||this.warn(`unhandled key status change "${lt}" (keyId: ${tt})`),ft&&(nt.eventNames().length?nt.emit("error",ft):this.handleError(ft))},at=i._onkeystatuseschange=lt=>{if(!i.mediaKeysSession){nt.emit("error",new Error("invalid state"));return}const ft=this.getKeyStatuses(i);if(!Object.keys(ft).some(mt=>ft[mt]!=="status-pending"))return;if(ft[tt]==="expired"){this.log(`Expired key ${stringify(ft)} in key-session "${i.mediaKeysSession.sessionId}"`),this.renewKeySession(i);return}let ht=ft[tt];if(ht)st(ht,i);else{var dt;i.keyStatusTimeouts||(i.keyStatusTimeouts={}),(dt=i.keyStatusTimeouts)[tt]||(dt[tt]=self.setTimeout(()=>{if(!i.mediaKeysSession||!this.mediaKeys)return;const pt=this.getKeyStatus(i.decryptdata);if(pt&&pt!=="status-pending")return this.log(`No status for keyId ${tt} in key-session "${i.mediaKeysSession.sessionId}". Using session key-status ${pt} from other session.`),st(pt,i);this.log(`key status for ${tt} in key-session "${i.mediaKeysSession.sessionId}" timed out after 0ms`),ht="internal-error",st(ht,i)},0)),this.log(`No status for keyId ${tt} (${stringify(ft)}).`)}};addEventListener$1(i.mediaKeysSession,"message",it),addEventListener$1(i.mediaKeysSession,"keystatuseschange",at);const ot=new Promise((lt,ct)=>{nt.on("error",ct),nt.on("resolved",lt)});return i.mediaKeysSession.generateRequest(_,$).then(()=>{this.log(`Request generated for key-session "${i.mediaKeysSession.sessionId}" keyId: ${tt} URI: ${rt}`)}).catch(lt=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:lt,decryptdata:i.decryptdata,fatal:!1},`Error generating key-session request: ${lt}`)}).then(()=>ot).catch(lt=>(nt.removeAllListeners(),this.removeSession(i).then(()=>{throw lt}))).then(()=>(nt.removeAllListeners(),i))}getKeyStatuses(i){const _={};return i.mediaKeysSession.keyStatuses.forEach(($,j)=>{if(typeof j=="string"&&typeof $=="object"){const tt=j;j=$,$=tt}const _e="buffer"in j?new Uint8Array(j.buffer,j.byteOffset,j.byteLength):new Uint8Array(j);i.keySystem===KeySystems.PLAYREADY&&_e.length===16&&changeEndianness(_e);const et=arrayToHex(_e);$==="internal-error"&&(this.bannedKeyIds[et]=$),this.log(`key status change "${$}" for keyStatuses keyId: ${et} key-session "${i.mediaKeysSession.sessionId}"`),_[et]=$}),_}fetchServerCertificate(i){const _=this.config,$=_.loader,j=new $(_),_e=this.getServerCertificateUrl(i);return _e?(this.log(`Fetching server certificate for "${i}"`),new Promise((et,tt)=>{const rt={responseType:"arraybuffer",url:_e},nt=_.certLoadPolicy.default,it={loadPolicy:nt,timeout:nt.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},st={onSuccess:(at,ot,lt,ct)=>{et(at.data)},onError:(at,ot,lt,ct)=>{tt(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:lt,response:_objectSpread2({url:rt.url,data:void 0},at)},`"${i}" certificate request failed (${_e}). Status: ${at.code} (${at.text})`))},onTimeout:(at,ot,lt)=>{tt(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:lt,response:{url:rt.url,data:void 0}},`"${i}" certificate request timed out (${_e})`))},onAbort:(at,ot,lt)=>{tt(new Error("aborted"))}};j.load(rt,it,st)})):Promise.resolve()}setMediaKeysServerCertificate(i,_,$){return new Promise((j,_e)=>{i.setServerCertificate($).then(et=>{this.log(`setServerCertificate ${et?"success":"not supported by CDM"} (${$.byteLength}) on "${_}"`),j(i)}).catch(et=>{_e(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:et,fatal:!0},et.message))})})}renewLicense(i,_){return this.requestLicense(i,new Uint8Array(_)).then($=>this.updateKeySession(i,new Uint8Array($)).catch(j=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:i.decryptdata,error:j,fatal:!1},j.message)}))}unpackPlayReadyKeyMessage(i,_){const $=String.fromCharCode.apply(null,new Uint16Array(_.buffer));if(!$.includes("PlayReadyKeyMessage"))return i.setRequestHeader("Content-Type","text/xml; charset=utf-8"),_;const j=new DOMParser().parseFromString($,"application/xml"),_e=j.querySelectorAll("HttpHeader");if(_e.length>0){let it;for(let st=0,at=_e.length;st<at;st++){var et,tt;it=_e[st];const ot=(et=it.querySelector("name"))==null?void 0:et.textContent,lt=(tt=it.querySelector("value"))==null?void 0:tt.textContent;ot&&lt&&i.setRequestHeader(ot,lt)}}const rt=j.querySelector("Challenge"),nt=rt==null?void 0:rt.textContent;if(!nt)throw new Error("Cannot find <Challenge> in key message");return strToUtf8array(atob(nt))}setupLicenseXHR(i,_,$,j){const _e=this.config.licenseXhrSetup;return _e?Promise.resolve().then(()=>{if(!$.decryptdata)throw new Error("Key removed");return _e.call(this.hls,i,_,$,j)}).catch(et=>{if(!$.decryptdata)throw et;return i.open("POST",_,!0),_e.call(this.hls,i,_,$,j)}).then(et=>(i.readyState||i.open("POST",_,!0),{xhr:i,licenseChallenge:et||j})):(i.open("POST",_,!0),Promise.resolve({xhr:i,licenseChallenge:j}))}requestLicense(i,_){const $=this.config.keyLoadPolicy.default;return new Promise((j,_e)=>{const et=this.getLicenseServerUrlOrThrow(i.keySystem);this.log(`Sending license request to URL: ${et}`);const tt=new XMLHttpRequest;tt.responseType="arraybuffer",tt.onreadystatechange=()=>{if(!this.hls||!i.mediaKeysSession)return _e(new Error("invalid state"));if(tt.readyState===4)if(tt.status===200){this._requestLicenseFailureCount=0;let rt=tt.response;this.log(`License received ${rt instanceof ArrayBuffer?rt.byteLength:rt}`);const nt=this.config.licenseResponseCallback;if(nt)try{rt=nt.call(this.hls,tt,et,i)}catch(it){this.error(it)}j(rt)}else{const rt=$.errorRetry,nt=rt?rt.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>nt||tt.status>=400&&tt.status<500)_e(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:i.decryptdata,fatal:!0,networkDetails:tt,response:{url:et,data:void 0,code:tt.status,text:tt.statusText}},`License Request XHR failed (${et}). Status: ${tt.status} (${tt.statusText})`));else{const it=nt-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${it} attempts left`),this.requestLicense(i,_).then(j,_e)}}},i.licenseXhr&&i.licenseXhr.readyState!==XMLHttpRequest.DONE&&i.licenseXhr.abort(),i.licenseXhr=tt,this.setupLicenseXHR(tt,et,i,_).then(({xhr:rt,licenseChallenge:nt})=>{i.keySystem==KeySystems.PLAYREADY&&(nt=this.unpackPlayReadyKeyMessage(rt,nt)),rt.send(nt)}).catch(_e)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(i,_){if(!this.config.emeEnabled)return;const $=_.media;this.media=$,addEventListener$1($,"encrypted",this.onMediaEncrypted),addEventListener$1($,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const i=this.media;i&&(removeEventListener(i,"encrypted",this.onMediaEncrypted),removeEventListener(i,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var i;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const _=this.media,$=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,LevelKey.clearKeyUriToKeyIdMap();const j=$.length;EMEController.CDMCleanupPromise=Promise.all($.map(_e=>this.removeSession(_e)).concat((_==null||(i=_.setMediaKeys(null))==null?void 0:i.catch(_e=>{this.log(`Could not clear media keys: ${_e}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${_e}`)})}))||Promise.resolve())).catch(_e=>{this.log(`Could not close sessions and clear media keys: ${_e}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${_e}`)})}).then(()=>{j&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(i,{sessionKeys:_}){if(!(!_||!this.config.emeEnabled)&&!this.keyFormatPromise){const $=_.reduce((j,_e)=>(j.indexOf(_e.keyFormat)===-1&&j.push(_e.keyFormat),j),[]);this.log(`Selecting key-system from session-keys ${$.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise($)}}removeSession(i){const{mediaKeysSession:_,licenseXhr:$,decryptdata:j}=i;if(_){this.log(`Remove licenses and keys and close session "${_.sessionId}" keyId: ${arrayToHex((j==null?void 0:j.keyId)||[])}`),i._onmessage&&(_.removeEventListener("message",i._onmessage),i._onmessage=void 0),i._onkeystatuseschange&&(_.removeEventListener("keystatuseschange",i._onkeystatuseschange),i._onkeystatuseschange=void 0),$&&$.readyState!==XMLHttpRequest.DONE&&$.abort(),i.mediaKeysSession=i.decryptdata=i.licenseXhr=void 0;const _e=this.mediaKeySessions.indexOf(i);_e>-1&&this.mediaKeySessions.splice(_e,1);const{keyStatusTimeouts:et}=i;et&&Object.keys(et).forEach(nt=>self.clearTimeout(et[nt]));const{drmSystemOptions:tt}=this.config;return(isPersistentSessionType(tt)?new Promise((nt,it)=>{self.setTimeout(()=>it(new Error("MediaKeySession.remove() timeout")),8e3),_.remove().then(nt).catch(it)}):Promise.resolve()).catch(nt=>{this.log(`Could not remove session: ${nt}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${nt}`)})}).then(()=>_.close()).catch(nt=>{this.log(`Could not close session: ${nt}`),this.hls&&this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${nt}`)})})}return Promise.resolve()}}EMEController.CDMCleanupPromise=void 0;function getKeyIdString(o){if(!o)throw new Error("Could not read keyId of undefined decryptdata");if(o.keyId===null)throw new Error("keyId is null");return arrayToHex(o.keyId)}function getKeyStatus(o,i){if(o.keyId&&i.mediaKeysSession.keyStatuses.has(o.keyId))return i.mediaKeysSession.keyStatuses.get(o.keyId);if(o.matches(i.decryptdata))return i.keyStatus}class EMEKeyError extends Error{constructor(i,_){super(_),this.data=void 0,i.error||(i.error=new Error(_)),this.data=i,i.err=i.error}}function getKeyStatusError(o,i){const _=o==="output-restricted",$=_?ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:$,fatal:!1,decryptdata:i},_?"HDCP level output restricted":`key status changed to "${o}"`)}class FPSController{constructor(i){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=i,this.registerListeners()}setStreamController(i){this.streamController=i}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(i,_){const $=this.hls.config;if($.capLevelOnFPSDrop){const j=_.media instanceof self.HTMLVideoElement?_.media:null;this.media=j,j&&typeof j.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),$.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(i,_,$){const j=performance.now();if(_){if(this.lastTime){const _e=j-this.lastTime,et=$-this.lastDroppedFrames,tt=_-this.lastDecodedFrames,rt=1e3*et/_e,nt=this.hls;if(nt.trigger(Events.FPS_DROP,{currentDropped:et,currentDecoded:tt,totalDroppedFrames:$}),rt>0&&et>nt.config.fpsDroppedMonitoringThreshold*tt){let it=nt.currentLevel;nt.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+it),it>0&&(nt.autoLevelCapping===-1||nt.autoLevelCapping>=it)&&(it=it-1,nt.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:it,droppedLevel:nt.currentLevel}),nt.autoLevelCapping=it,this.streamController.nextLevelSwitch())}}this.lastTime=j,this.lastDroppedFrames=$,this.lastDecodedFrames=_}}checkFPSInterval(){const i=this.media;if(i)if(this.isVideoPlaybackQualityAvailable){const _=i.getVideoPlaybackQuality();this.checkFPS(i,_.totalVideoFrames,_.droppedVideoFrames)}else this.checkFPS(i,i.webkitDecodedFrameCount,i.webkitDroppedFrameCount)}}function sendAddTrackEvent(o,i){let _;try{_=new Event("addtrack")}catch{_=document.createEvent("Event"),_.initEvent("addtrack",!1,!1)}_.track=o,i.dispatchEvent(_)}function addCueToTrack(o,i){const _=o.mode;if(_==="disabled"&&(o.mode="hidden"),o.cues&&!o.cues.getCueById(i.id))try{if(o.addCue(i),!o.cues.getCueById(i.id))throw new Error(`addCue is failed for: ${i}`)}catch($){logger.debug(`[texttrack-utils]: ${$}`);try{const j=new self.TextTrackCue(i.startTime,i.endTime,i.text);j.id=i.id,o.addCue(j)}catch(j){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${j}`)}}_==="disabled"&&(o.mode=_)}function clearCurrentCues(o,i){const _=o.mode;if(_==="disabled"&&(o.mode="hidden"),o.cues)for(let $=o.cues.length;$--;)i&&o.cues[$].removeEventListener("enter",i),o.removeCue(o.cues[$]);_==="disabled"&&(o.mode=_)}function removeCuesInRange(o,i,_,$){const j=o.mode;if(j==="disabled"&&(o.mode="hidden"),o.cues&&o.cues.length>0){const _e=getCuesInRange(o.cues,i,_);for(let et=0;et<_e.length;et++)(!$||$(_e[et]))&&o.removeCue(_e[et])}j==="disabled"&&(o.mode=j)}function getFirstCueIndexFromTime(o,i){if(i<=o[0].startTime)return 0;const _=o.length-1;if(i>o[_].endTime)return-1;let $=0,j=_,_e;for(;$<=j;)if(_e=Math.floor((j+$)/2),i<o[_e].startTime)j=_e-1;else if(i>o[_e].startTime&&$<_)$=_e+1;else return _e;return o[$].startTime-i<i-o[j].startTime?$:j}function getCuesInRange(o,i,_){const $=[],j=getFirstCueIndexFromTime(o,i);if(j>-1)for(let _e=j,et=o.length;_e<et;_e++){const tt=o[_e];if(tt.startTime>=i&&tt.endTime<=_)$.push(tt);else if(tt.startTime>_)return $}return $}function filterSubtitleTracks(o){const i=[];for(let _=0;_<o.length;_++){const $=o[_];($.kind==="subtitles"||$.kind==="captions")&&$.label&&i.push(o[_])}return i}class SubtitleTrackController extends BasePlaylistController{constructor(i){super(i,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let _=null;const $=filterSubtitleTracks(this.media.textTracks);for(let _e=0;_e<$.length;_e++)if($[_e].mode==="hidden")_=$[_e];else if($[_e].mode==="showing"){_=$[_e];break}const j=this.findTrackForTextTrack(_);this.subtitleTrack!==j&&this.setSubtitleTrack(j)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(i){this._subtitleDisplay=i,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:i}=this;i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:i}=this;i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.off(Events.ERROR,this.onError,this)}onMediaAttached(i,_){this.media=_.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(i){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,i)}onMediaDetaching(i,_){const $=this.media;if(!$)return;const j=!!_.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||$.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,j)return;filterSubtitleTracks($.textTracks).forEach(et=>{clearCurrentCues(et)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(i,_){this.tracks=_.subtitleTracks}onSubtitleTrackLoaded(i,_){const{id:$,groupId:j,details:_e}=_,et=this.tracksInGroup[$];if(!et||et.groupId!==j){this.warn(`Subtitle track with id:${$} and group:${j} not found in active group ${et==null?void 0:et.groupId}`);return}const tt=et.details;et.details=_.details,this.log(`Subtitle track ${$} "${et.name}" lang:${et.lang} group:${j} loaded [${_e.startSN}-${_e.endSN}]`),$===this.trackId&&this.playlistLoaded($,_,tt)}onLevelLoading(i,_){this.switchLevel(_.level)}onLevelSwitching(i,_){this.switchLevel(_.level)}switchLevel(i){const _=this.hls.levels[i];if(!_)return;const $=_.subtitleGroups||null,j=this.groupIds;let _e=this.currentTrack;if(!$||(j==null?void 0:j.length)!==($==null?void 0:$.length)||$!=null&&$.some(et=>(j==null?void 0:j.indexOf(et))===-1)){this.groupIds=$,this.trackId=-1,this.currentTrack=null;const et=this.tracks.filter(it=>!$||$.indexOf(it.groupId)!==-1);if(et.length)this.selectDefaultTrack&&!et.some(it=>it.default)&&(this.selectDefaultTrack=!1),et.forEach((it,st)=>{it.id=st});else if(!_e&&!this.tracksInGroup.length)return;this.tracksInGroup=et;const tt=this.hls.config.subtitlePreference;if(!_e&&tt){this.selectDefaultTrack=!1;const it=findMatchingOption(tt,et);if(it>-1)_e=et[it];else{const st=findMatchingOption(tt,this.tracks);_e=this.tracks[st]}}let rt=this.findTrackId(_e);rt===-1&&_e&&(rt=this.findTrackId(null));const nt={subtitleTracks:et};this.log(`Updating subtitle tracks, ${et.length} track(s) found in "${$==null?void 0:$.join(",")}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,nt),rt!==-1&&this.trackId===-1&&this.setSubtitleTrack(rt)}}findTrackId(i){const _=this.tracksInGroup,$=this.selectDefaultTrack;for(let j=0;j<_.length;j++){const _e=_[j];if(!($&&!_e.default||!$&&!i)&&(!i||matchesOption(_e,i)))return j}if(i){for(let j=0;j<_.length;j++){const _e=_[j];if(mediaAttributesIdentical(i.attrs,_e.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return j}for(let j=0;j<_.length;j++){const _e=_[j];if(mediaAttributesIdentical(i.attrs,_e.attrs,["LANGUAGE"]))return j}}return-1}findTrackForTextTrack(i){if(i){const _=this.tracksInGroup;for(let $=0;$<_.length;$++){const j=_[$];if(subtitleTrackMatchesTextTrack(j,i))return $}}return-1}onError(i,_){_.fatal||!_.context||_.context.type===PlaylistContextType.SUBTITLE_TRACK&&_.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(_.context.groupId)!==-1)&&this.checkRetry(_)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(i){this.selectDefaultTrack=!1,this.setSubtitleTrack(i)}setSubtitleOption(i){if(this.hls.config.subtitlePreference=i,i){if(i.id===-1)return this.setSubtitleTrack(-1),null;const _=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,_.length){const $=this.currentTrack;if($&&matchesOption(i,$))return $;const j=findMatchingOption(i,this.tracksInGroup);if(j>-1){const _e=this.tracksInGroup[j];return this.setSubtitleTrack(j),_e}else{if($)return null;{const _e=findMatchingOption(i,_);if(_e>-1)return _[_e]}}}}return null}loadPlaylist(i){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,i)}loadingPlaylist(i,_){super.loadingPlaylist(i,_);const $=i.id,j=i.groupId,_e=this.getUrlWithDirectives(i.url,_),et=i.details,tt=et==null?void 0:et.age;this.log(`Loading subtitle ${$} "${i.name}" lang:${i.lang} group:${j}${(_==null?void 0:_.msn)!==void 0?" at sn "+_.msn+" part "+_.part:""}${tt&&et.live?" age "+tt.toFixed(1)+(et.type&&" "+et.type||""):""} ${_e}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:_e,id:$,groupId:j,deliveryDirectives:_||null,track:i})}toggleTrackModes(){const{media:i}=this;if(!i)return;const _=filterSubtitleTracks(i.textTracks),$=this.currentTrack;let j;if($&&(j=_.filter(_e=>subtitleTrackMatchesTextTrack($,_e))[0],j||this.warn(`Unable to find subtitle TextTrack with name "${$.name}" and language "${$.lang}"`)),[].slice.call(_).forEach(_e=>{_e.mode!=="disabled"&&_e!==j&&(_e.mode="disabled")}),j){const _e=this.subtitleDisplay?"showing":"hidden";j.mode!==_e&&(j.mode=_e)}}setSubtitleTrack(i){const _=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=i;return}if(i<-1||i>=_.length||!isFiniteNumber(i)){this.warn(`Invalid subtitle track id: ${i}`);return}this.selectDefaultTrack=!1;const $=this.currentTrack,j=_[i]||null;if(this.trackId=i,this.currentTrack=j,this.toggleTrackModes(),!j){this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:i});return}const _e=!!j.details&&!j.details.live;if(i===this.trackId&&j===$&&_e)return;this.log(`Switching to subtitle-track ${i}`+(j?` "${j.name}" lang:${j.lang} group:${j.groupId}`:""));const{id:et,groupId:tt="",name:rt,type:nt,url:it}=j;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:et,groupId:tt,name:rt,type:nt,url:it});const st=this.switchParams(j.url,$==null?void 0:$.details,j.details);this.loadPlaylist(st)}}function uuid$1(){try{return crypto.randomUUID()}catch{try{const i=URL.createObjectURL(new Blob),_=i.toString();return URL.revokeObjectURL(i),_.slice(_.lastIndexOf("/")+1)}catch{let _=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,j=>{const _e=(_+Math.random()*16)%16|0;return _=Math.floor(_/16),(j=="x"?_e:_e&3|8).toString(16)})}}}function hash$1(o){let i=5381,_=o.length;for(;_;)i=i*33^o.charCodeAt(--_);return(i>>>0).toString()}const ALIGNED_END_THRESHOLD_SECONDS=.025;let TimelineOccupancy=function(o){return o[o.Point=0]="Point",o[o.Range=1]="Range",o}({});function generateAssetIdentifier(o,i,_){return`${o.identifier}-${_+1}-${hash$1(i)}`}class InterstitialEvent{constructor(i,_){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=_,this.dateRange=i,this.setDateRange(i)}setDateRange(i){this.dateRange=i,this.resumeOffset=i.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=i.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=i.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=i.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var i;this.appendInPlaceStarted=!1,(i=this.assetListLoader)==null||i.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(i){var _;if(i>0&&i>=this.assetList.length)return!0;const $=this.playoutLimit;return i<=0||isNaN($)?!1:$===0?!0:(((_=this.assetList[i])==null?void 0:_.startOffset)||0)>$}findAssetIndex(i){return this.assetList.indexOf(i)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const i=this.dateRange.startTime;if(this.snapOptions.out){const _=this.dateRange.tagAnchor;if(_)return getSnapToFragmentTime(i,_)}return i}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const i=this.dateRange.tagAnchor;if(i){const _=this.dateRange.startTime,$=getSnapToFragmentTime(_,i);return _-$<.1}return!1}get resumptionOffset(){const i=this.resumeOffset,_=isFiniteNumber(i)?i:this.duration;return this.cumulativeDuration+_}get resumeTime(){const i=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const _=this.resumeAnchor;if(_)return getSnapToFragmentTime(i,_)}return i}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<ALIGNED_END_THRESHOLD_SECONDS))}set appendInPlace(i){if(this.appendInPlaceStarted){this.resetOnResume=!i;return}this.appendInPlaceDisabled=!i}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(i){this._timelineStart=i}get duration(){const i=this.playoutLimit;let _;return this._duration!==null?_=this._duration:this.dateRange.duration?_=this.dateRange.duration:_=this.dateRange.plannedDuration||0,!isNaN(i)&&i<_&&(_=i),_}set duration(i){this._duration=i}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?TimelineOccupancy.Range:TimelineOccupancy.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return eventToString(this)}}function getSnapToFragmentTime(o,i){return o-i.start<i.duration/2&&!(Math.abs(o-(i.start+i.duration))<ALIGNED_END_THRESHOLD_SECONDS)?i.start:i.start+i.duration}function getInterstitialUrl(o,i,_){const $=new self.URL(o,_);return $.protocol!=="data:"&&$.searchParams.set("_HLS_primary_id",i),$}function getNextAssetIndex(o,i){for(;(_=o.assetList[++i])!=null&&_.error;)var _;return i}function eventToString(o){return`["${o.identifier}" ${o.cue.pre?"<pre>":o.cue.post?"<post>":""}${o.timelineStart.toFixed(2)}-${o.resumeTime.toFixed(2)}]`}function eventAssetToString(o){const i=o.timelineStart,_=o.duration||0;return`["${o.identifier}" ${i.toFixed(2)}-${(i+_).toFixed(2)}]`}class HlsAssetPlayer{constructor(i,_,$,j){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(Events.PLAYOUT_LIMIT_REACHED,{})};const _e=this.hls=new i(_);this.interstitial=$,this.assetItem=j;const et=()=>{this.hasDetails=!0};_e.once(Events.LEVEL_LOADED,et),_e.once(Events.AUDIO_TRACK_LOADED,et),_e.once(Events.SUBTITLE_TRACK_LOADED,et),_e.on(Events.MEDIA_ATTACHING,(tt,{media:rt})=>{this.removeMediaListeners(),this.mediaAttached=rt,this.interstitial.playoutLimit&&(rt.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&_e.on(Events.BUFFER_APPENDED,()=>{const it=this.bufferedEnd;this.reachedPlayout(it)&&(this._bufferedEosTime=it,_e.trigger(Events.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const i=this.hls;if(i)if(i.url)i.levels.length&&!i.started&&i.startLoad(-1,!0);else{let _=this.assetItem.uri;try{_=getInterstitialUrl(_,i.config.primarySessionId||"").href}catch{}i.loadSource(_)}}bufferedInPlaceToEnd(i){var _;if(!this.appendInPlace)return!1;if((_=this.hls)!=null&&_.bufferedToEnd)return!0;if(!i)return!1;const $=Math.min(this._bufferedEosTime||1/0,this.duration),j=this.timelineOffset,_e=BufferHelper.bufferInfo(i,j,0);return this.getAssetTime(_e.end)>=$-.02}reachedPlayout(i){const $=this.interstitial.playoutLimit;return this.startOffset+i>=$}get destroyed(){var i;return!((i=this.hls)!=null&&i.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var i;return((i=this.hls)==null?void 0:i.media)||null}get bufferedEnd(){const i=this.media||this.mediaAttached;if(!i)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const _=BufferHelper.bufferInfo(i,i.currentTime,.001);return this.getAssetTime(_.end)}get currentTime(){const i=this.media||this.mediaAttached;return i?this.getAssetTime(i.currentTime):this._currentTime||0}get duration(){const i=this.assetItem.duration;if(!i)return 0;const _=this.interstitial.playoutLimit;if(_){const $=_-this.startOffset;if($>0&&$<i)return $}return i}get remaining(){const i=this.duration;return i?Math.max(0,i-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var i;return((i=this.hls)==null?void 0:i.config.timelineOffset)||0}set timelineOffset(i){const _=this.timelineOffset;if(i!==_){const $=i-_;if(Math.abs($)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=i}}}getAssetTime(i){const _=this.timelineOffset,$=this.duration;return Math.min(Math.max(0,i-_),$)}removeMediaListeners(){const i=this.mediaAttached;i&&(this._currentTime=i.currentTime,this.bufferSnapShot(),i.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var i;(i=this.hls)!=null&&i.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(i){var _;this.loadSource(),(_=this.hls)==null||_.attachMedia(i)}detachMedia(){var i;this.removeMediaListeners(),this.mediaAttached=null,(i=this.hls)==null||i.detachMedia()}resumeBuffering(){var i;(i=this.hls)==null||i.resumeBuffering()}pauseBuffering(){var i;(i=this.hls)==null||i.pauseBuffering()}transferMedia(){var i;return this.bufferSnapShot(),((i=this.hls)==null?void 0:i.transferMedia())||null}resetDetails(){const i=this.hls;if(i&&this.hasDetails){i.stopLoad();const _=$=>delete $.details;i.levels.forEach(_),i.allAudioTracks.forEach(_),i.allSubtitleTracks.forEach(_),this.hasDetails=!1}}on(i,_,$){var j;(j=this.hls)==null||j.on(i,_)}once(i,_,$){var j;(j=this.hls)==null||j.once(i,_)}off(i,_,$){var j;(j=this.hls)==null||j.off(i,_)}toString(){var i;return`HlsAssetPlayer: ${eventAssetToString(this.assetItem)} ${(i=this.hls)==null?void 0:i.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const ABUTTING_THRESHOLD_SECONDS=.033;class InterstitialsSchedule extends Logger$1{constructor(i,_){super("interstitials-sched",_),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=i}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(i=>i.reset()),this.events=this.items=null}resetErrorsInRange(i,_){return this.events?this.events.reduce(($,j)=>i<=j.startOffset&&_>j.startOffset?(delete j.error,$+1):$,0):0}get duration(){const i=this.items;return i?i[i.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(i){return i&&this.eventMap[i]||null}hasEvent(i){return i in this.eventMap}findItemIndex(i,_){if(i.event)return this.findEventIndex(i.event.identifier);let $=-1;i.nextEvent?$=this.findEventIndex(i.nextEvent.identifier)-1:i.previousEvent&&($=this.findEventIndex(i.previousEvent.identifier)+1);const j=this.items;if(j)for(j[$]||(_===void 0&&(_=i.start),$=this.findItemIndexAtTime(_));$>=0&&(_e=j[$])!=null&&_e.event;){var _e;$--}return $}findItemIndexAtTime(i,_){const $=this.items;if($)for(let j=0;j<$.length;j++){let _e=$[j];if(_&&_!=="primary"&&(_e=_e[_]),i===_e.start||i>_e.start&&i<_e.end)return j}return-1}findJumpRestrictedIndex(i,_){const $=this.items;if($)for(let j=i;j<=_&&$[j];j++){const _e=$[j].event;if(_e!=null&&_e.restrictions.jump&&!_e.appendInPlace)return j}return-1}findEventIndex(i){const _=this.items;if(_)for(let j=_.length;j--;){var $;if((($=_[j].event)==null?void 0:$.identifier)===i)return j}return-1}findAssetIndex(i,_){const $=i.assetList,j=$.length;if(j>1)for(let _e=0;_e<j;_e++){const et=$[_e];if(!et.error){const tt=et.timelineStart;if(_===tt||_>tt&&(_<tt+(et.duration||0)||_e===j-1))return _e}}return 0}get assetIdAtEnd(){var i;const _=(i=this.items)==null||(i=i[this.length-1])==null?void 0:i.event;if(_){const $=_.assetList,j=$[$.length-1];if(j)return j.identifier}return null}parseInterstitialDateRanges(i,_){const $=i.main.details,{dateRanges:j}=$,_e=this.events,et=this.parseDateRanges(j,{url:$.url},_),tt=Object.keys(j),rt=_e?_e.filter(nt=>!tt.includes(nt.identifier)):[];et.length&&et.sort((nt,it)=>{const st=nt.cue.pre,at=nt.cue.post,ot=it.cue.pre,lt=it.cue.post;if(st&&!ot)return-1;if(ot&&!st||at&&!lt)return 1;if(lt&&!at)return-1;if(!st&&!ot&&!at&&!lt){const ct=nt.startTime,ft=it.startTime;if(ct!==ft)return ct-ft}return nt.dateRange.tagOrder-it.dateRange.tagOrder}),this.events=et,rt.forEach(nt=>{this.removeEvent(nt)}),this.updateSchedule(i,rt)}updateSchedule(i,_=[],$=!1){const j=this.events||[];if(j.length||_.length||this.length<2){const _e=this.items,et=this.parseSchedule(j,i);($||_.length||(_e==null?void 0:_e.length)!==et.length||et.some((rt,nt)=>Math.abs(rt.playout.start-_e[nt].playout.start)>.005||Math.abs(rt.playout.end-_e[nt].playout.end)>.005))&&(this.items=et,this.onScheduleUpdate(_,_e))}}parseDateRanges(i,_,$){const j=[],_e=Object.keys(i);for(let et=0;et<_e.length;et++){const tt=_e[et],rt=i[tt];if(rt.isInterstitial){let nt=this.eventMap[tt];nt?nt.setDateRange(rt):(nt=new InterstitialEvent(rt,_),this.eventMap[tt]=nt,$===!1&&(nt.appendInPlace=$)),j.push(nt)}}return j}parseSchedule(i,_){const $=[],j=_.main.details,_e=j.live?1/0:j.edge;let et=0;if(i=i.filter(rt=>!rt.error&&!(rt.cue.once&&rt.hasPlayed)),i.length){this.resolveOffsets(i,_);let rt=0,nt=0;if(i.forEach((it,st)=>{const at=it.cue.pre,ot=it.cue.post,lt=i[st-1]||null,ct=it.appendInPlace,ft=ot?_e:it.startOffset,ut=it.duration,ht=it.timelineOccupancy===TimelineOccupancy.Range?ut:0,dt=it.resumptionOffset,mt=(lt==null?void 0:lt.startTime)===ft,pt=ft+it.cumulativeDuration;let yt=ct?pt+ut:ft+dt;if(at||!ot&&ft<=0){const vt=nt;nt+=ht,it.timelineStart=pt;const St=et;et+=ut,$.push({event:it,start:pt,end:yt,playout:{start:St,end:et},integrated:{start:vt,end:nt}})}else if(ft<=_e){if(!mt){const At=ft-rt;if(At>ABUTTING_THRESHOLD_SECONDS){const xt=rt,wt=nt;nt+=At;const Ot=et;et+=At;const Bt={previousEvent:i[st-1]||null,nextEvent:it,start:xt,end:xt+At,playout:{start:Ot,end:et},integrated:{start:wt,end:nt}};$.push(Bt)}else At>0&&lt&&(lt.cumulativeDuration+=At,$[$.length-1].end=ft)}ot&&(yt=pt),it.timelineStart=pt;const vt=nt;nt+=ht;const St=et;et+=ut,$.push({event:it,start:pt,end:yt,playout:{start:St,end:et},integrated:{start:vt,end:nt}})}else return;const gt=it.resumeTime;ot||gt>_e?rt=_e:rt=gt}),rt<_e){var tt;const it=rt,st=nt,at=_e-rt;nt+=at;const ot=et;et+=at,$.push({previousEvent:((tt=$[$.length-1])==null?void 0:tt.event)||null,nextEvent:null,start:rt,end:it+at,playout:{start:ot,end:et},integrated:{start:st,end:nt}})}this.setDurations(_e,et,nt)}else $.push({previousEvent:null,nextEvent:null,start:0,end:_e,playout:{start:0,end:_e},integrated:{start:0,end:_e}}),this.setDurations(_e,_e,_e);return $}setDurations(i,_,$){this.durations={primary:i,playout:_,integrated:$}}resolveOffsets(i,_){const $=_.main.details,j=$.live?1/0:$.edge;let _e=0,et=-1;i.forEach((tt,rt)=>{const nt=tt.cue.pre,it=tt.cue.post,st=nt?0:it?j:tt.startTime;this.updateAssetDurations(tt),et===st?tt.cumulativeDuration=_e:(_e=0,et=st),!it&&tt.snapOptions.in&&(tt.resumeAnchor=findFragmentByPTS(null,$.fragments,tt.startOffset+tt.resumptionOffset,0,0)||void 0),tt.appendInPlace&&!tt.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(tt,_)||(tt.appendInPlace=!1)),!tt.appendInPlace&&rt+1<i.length&&i[rt+1].startTime-i[rt].resumeTime<ABUTTING_THRESHOLD_SECONDS&&(i[rt+1].appendInPlace=!1,i[rt+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${tt}`));const ot=isFiniteNumber(tt.resumeOffset)?tt.resumeOffset:tt.duration;_e+=ot})}primaryCanResumeInPlaceAt(i,_){const $=i.resumeTime,j=i.startTime+i.resumptionOffset;return Math.abs($-j)>ALIGNED_END_THRESHOLD_SECONDS?(this.log(`"${i.identifier}" resumption ${$} not aligned with estimated timeline end ${j}`),!1):!Object.keys(_).some(et=>{const tt=_[et].details,rt=tt.edge;if($>=rt)return this.log(`"${i.identifier}" resumption ${$} past ${et} playlist end ${rt}`),!1;const nt=findFragmentByPTS(null,tt.fragments,$);if(!nt)return this.log(`"${i.identifier}" resumption ${$} does not align with any fragments in ${et} playlist (${tt.fragStart}-${tt.fragmentEnd})`),!0;const it=et==="audio"?.175:0;return Math.abs(nt.start-$)<ALIGNED_END_THRESHOLD_SECONDS+it||Math.abs(nt.end-$)<ALIGNED_END_THRESHOLD_SECONDS+it?!1:(this.log(`"${i.identifier}" resumption ${$} not aligned with ${et} fragment bounds (${nt.start}-${nt.end} sn: ${nt.sn} cc: ${nt.cc})`),!0)})}updateAssetDurations(i){if(!i.assetListLoaded)return;const _=i.timelineStart;let $=0,j=!1,_e=!1;for(let et=0;et<i.assetList.length;et++){const tt=i.assetList[et],rt=_+$;tt.startOffset=$,tt.timelineStart=rt,j||(j=tt.duration===null),_e||(_e=!!tt.error);const nt=tt.error?0:tt.duration||0;$+=nt}j&&!_e?i.duration=Math.max($,i.duration):i.duration=$}removeEvent(i){i.reset(),delete this.eventMap[i.identifier]}}function segmentToString(o){return`[${o.event?'"'+o.event.identifier+'"':"primary"}: ${o.start.toFixed(2)}-${o.end.toFixed(2)}]`}class AssetListLoader{constructor(i){this.hls=void 0,this.hls=i}destroy(){this.hls=null}loadAssetList(i,_){const $=i.assetListUrl;let j;try{j=getInterstitialUrl($,this.hls.sessionId,i.baseUrl)}catch(at){const ot=this.assignAssetListError(i,ErrorDetails.ASSET_LIST_LOAD_ERROR,at,$);this.hls.trigger(Events.ERROR,ot);return}_&&j.protocol!=="data:"&&j.searchParams.set("_HLS_start_offset",""+_);const _e=this.hls.config,et=_e.loader,tt=new et(_e),rt={responseType:"json",url:j.href},nt=_e.interstitialAssetListLoadPolicy.default,it={loadPolicy:nt,timeout:nt.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},st={onSuccess:(at,ot,lt,ct)=>{const ft=at.data,ut=ft==null?void 0:ft.ASSETS;if(!Array.isArray(ut)){const ht=this.assignAssetListError(i,ErrorDetails.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),lt.url,ot,ct);this.hls.trigger(Events.ERROR,ht);return}i.assetListResponse=ft,this.hls.trigger(Events.ASSET_LIST_LOADED,{event:i,assetListResponse:ft,networkDetails:ct})},onError:(at,ot,lt,ct)=>{const ft=this.assignAssetListError(i,ErrorDetails.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${at.code} ${at.text} (${ot.url})`),ot.url,ct,lt);this.hls.trigger(Events.ERROR,ft)},onTimeout:(at,ot,lt)=>{const ct=this.assignAssetListError(i,ErrorDetails.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${ot.url})`),ot.url,at,lt);this.hls.trigger(Events.ERROR,ct)}};return tt.load(rt,it,st),this.hls.trigger(Events.ASSET_LIST_LOADING,{event:i}),tt}assignAssetListError(i,_,$,j,_e,et){return i.error=$,{type:ErrorTypes.NETWORK_ERROR,details:_,fatal:!1,interstitial:i,url:j,error:$,networkDetails:et,stats:_e}}}function playWithCatch(o){o==null||o.play().catch(()=>{})}function timelineMessage(o,i){return`[${o}] Advancing timeline position to ${i}`}class InterstitialsController extends Logger$1{constructor(i,_){super("interstitials",i.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const $=this.currentTime;if($===void 0||this.playbackDisabled||!this.schedule)return;const j=$-this.timelinePos;if(Math.abs(j)<1/7056e5)return;const et=j<=-.01;this.timelinePos=$,this.bufferedPos=$;const tt=this.playingItem;if(!tt){this.checkBuffer();return}if(et&&this.schedule.resetErrorsInRange($,$-j)&&this.updateSchedule(!0),this.checkBuffer(),et&&$<tt.start||$>=tt.end){var rt;const ot=this.findItemIndex(tt);let lt=this.schedule.findItemIndexAtTime($);if(lt===-1&&(lt=ot+(et?-1:1),this.log(`seeked ${et?"back ":""}to position not covered by schedule ${$} (resolving from ${ot} to ${lt})`)),!this.isInterstitial(tt)&&(rt=this.media)!=null&&rt.paused&&(this.shouldPlay=!1),!et&&lt>ot){const ct=this.schedule.findJumpRestrictedIndex(ot+1,lt);if(ct>ot){this.setSchedulePosition(ct);return}}this.setSchedulePosition(lt);return}const nt=this.playingAsset;if(!nt){if(this.playingLastItem&&this.isInterstitial(tt)){const ot=tt.event.assetList[0];ot&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime($,ot))}return}const it=nt.timelineStart,st=nt.duration||0;if(et&&$<it||$>=it+st){var at;(at=tt.event)!=null&&at.appendInPlace&&(this.clearInterstitial(tt.event,tt),this.flushFrontBuffer($)),this.setScheduleToAssetAtTime($,nt)}},this.onTimeupdate=()=>{const $=this.currentTime;if($===void 0||this.playbackDisabled)return;if($>this.timelinePos)this.timelinePos=$,$>this.bufferedPos&&this.checkBuffer();else return;const j=this.playingItem;if(!j||this.playingLastItem)return;if($>=j.end){this.timelinePos=j.end;const tt=this.findItemIndex(j);this.setSchedulePosition(tt+1)}const _e=this.playingAsset;if(!_e)return;const et=_e.timelineStart+(_e.duration||0);$>=et&&this.setScheduleToAssetAtTime($,_e)},this.onScheduleUpdate=($,j)=>{const _e=this.schedule;if(!_e)return;const et=this.playingItem,tt=_e.events||[],rt=_e.items||[],nt=_e.durations,it=$.map(ct=>ct.identifier),st=!!(tt.length||it.length);(st||j)&&this.log(`INTERSTITIALS_UPDATED (${tt.length}): ${tt}
Schedule: ${rt.map(ct=>segmentToString(ct))} pos: ${this.timelinePos}`),it.length&&this.log(`Removed events ${it}`);let at=null,ot=null;et&&(at=this.updateItem(et,this.timelinePos),this.itemsMatch(et,at)?this.playingItem=at:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const lt=this.bufferingItem;if(lt&&(ot=this.updateItem(lt,this.bufferedPos),this.itemsMatch(lt,ot)?this.bufferingItem=ot:lt.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(lt.event,null))),$.forEach(ct=>{ct.assetList.forEach(ft=>{this.clearAssetPlayer(ft.identifier,null)})}),this.playerQueue.forEach(ct=>{if(ct.interstitial.appendInPlace){const ft=ct.assetItem.timelineStart,ut=ct.timelineOffset-ft;if(ut)try{ct.timelineOffset=ft}catch(ht){Math.abs(ut)>ALIGNED_END_THRESHOLD_SECONDS&&this.warn(`${ht} ("${ct.assetId}" ${ct.timelineOffset}->${ft})`)}}}),st||j){if(this.hls.trigger(Events.INTERSTITIALS_UPDATED,{events:tt.slice(0),schedule:rt.slice(0),durations:nt,removedIds:it}),this.isInterstitial(et)&&it.includes(et.event.identifier)){this.warn(`Interstitial "${et.event.identifier}" removed while playing`),this.primaryFallback(et.event);return}et&&this.trimInPlace(at,et),lt&&ot!==at&&this.trimInPlace(ot,lt),this.checkBuffer()}},this.hls=i,this.HlsPlayerClass=_,this.assetListLoader=new AssetListLoader(i),this.schedule=new InterstitialsSchedule(this.onScheduleUpdate,i.logger),this.registerListeners()}registerListeners(){const i=this.hls;i&&(i.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.on(Events.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),i.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.on(Events.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),i.on(Events.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),i.on(Events.ASSET_LIST_LOADED,this.onAssetListLoaded,this),i.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),i.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.on(Events.BUFFERED_TO_END,this.onBufferedToEnd,this),i.on(Events.MEDIA_ENDED,this.onMediaEnded,this),i.on(Events.ERROR,this.onError,this),i.on(Events.DESTROYING,this.onDestroying,this))}unregisterListeners(){const i=this.hls;i&&(i.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.off(Events.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),i.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.off(Events.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),i.off(Events.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),i.off(Events.ASSET_LIST_LOADED,this.onAssetListLoaded,this),i.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),i.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),i.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.off(Events.BUFFERED_TO_END,this.onBufferedToEnd,this),i.off(Events.MEDIA_ENDED,this.onMediaEnded,this),i.off(Events.ERROR,this.onError,this),i.off(Events.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var i;(i=this.getBufferingPlayer())==null||i.resumeBuffering()}pauseBuffering(){var i;(i=this.getBufferingPlayer())==null||i.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const i=this.primaryMedia||this.media;i&&this.removeMediaListeners(i)}removeMediaListeners(i){removeEventListener(i,"play",this.onPlay),removeEventListener(i,"pause",this.onPause),removeEventListener(i,"seeking",this.onSeeking),removeEventListener(i,"timeupdate",this.onTimeupdate)}onMediaAttaching(i,_){const $=this.media=_.media;addEventListener$1($,"seeking",this.onSeeking),addEventListener$1($,"timeupdate",this.onTimeupdate),addEventListener$1($,"play",this.onPlay),addEventListener$1($,"pause",this.onPause)}onMediaAttached(i,_){const $=this.effectivePlayingItem,j=this.detachedData;if(this.detachedData=null,$===null)this.checkStart();else if(!j){this.clearScheduleState();const _e=this.findItemIndex($);this.setSchedulePosition(_e)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(i,_){const $=!!_.transferMedia,j=this.media;if(this.media=null,!$&&(j&&this.removeMediaListeners(j),this.detachedData)){const _e=this.getBufferingPlayer();_e&&(this.log(`Removing schedule state for detachedData and ${_e}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,_e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const i=this,_=()=>i.bufferingItem||i.waitingItem,$=st=>st&&i.getAssetPlayer(st.identifier),j=(st,at,ot,lt,ct)=>{if(st){let ft=st[at].start;const ut=st.event;if(ut){if(at==="playout"||ut.timelineOccupancy!==TimelineOccupancy.Point){const ht=$(ot);(ht==null?void 0:ht.interstitial)===ut&&(ft+=ht.assetItem.startOffset+ht[ct])}}else{const ht=lt==="bufferedPos"?et():i[lt];ft+=ht-st.start}return ft}return 0},_e=(st,at)=>{var ot;if(st!==0&&at!=="primary"&&(ot=i.schedule)!=null&&ot.length){var lt;const ct=i.schedule.findItemIndexAtTime(st),ft=(lt=i.schedule.items)==null?void 0:lt[ct];if(ft){const ut=ft[at].start-ft.start;return st+ut}}return st},et=()=>{const st=i.bufferedPos;return st===Number.MAX_VALUE?tt("primary"):Math.max(st,0)},tt=st=>{var at,ot;return(at=i.primaryDetails)!=null&&at.live?i.primaryDetails.edge:((ot=i.schedule)==null?void 0:ot.durations[st])||0},rt=(st,at)=>{var ot,lt;const ct=i.effectivePlayingItem;if(ct!=null&&(ot=ct.event)!=null&&ot.restrictions.skip||!i.schedule)return;i.log(`seek to ${st} "${at}"`);const ft=i.effectivePlayingItem,ut=i.schedule.findItemIndexAtTime(st,at),ht=(lt=i.schedule.items)==null?void 0:lt[ut],dt=i.getBufferingPlayer(),mt=dt==null?void 0:dt.interstitial,pt=mt==null?void 0:mt.appendInPlace,yt=ft&&i.itemsMatch(ft,ht);if(ft&&(pt||yt)){const gt=$(i.playingAsset),vt=(gt==null?void 0:gt.media)||i.primaryMedia;if(vt){const St=at==="primary"?vt.currentTime:j(ft,at,i.playingAsset,"timelinePos","currentTime"),At=st-St,xt=(pt?St:vt.currentTime)+At;if(xt>=0&&(!gt||pt||xt<=gt.duration)){vt.currentTime=xt;return}}}if(ht){let gt=st;if(at!=="primary"){const St=ht[at].start,At=st-St;gt=ht.start+At}const vt=!i.isInterstitial(ht);if((!i.isInterstitial(ft)||ft.event.appendInPlace)&&(vt||ht.event.appendInPlace)){const St=i.media||(pt?dt==null?void 0:dt.media:null);St&&(St.currentTime=gt)}else if(ft){const St=i.findItemIndex(ft);if(ut>St){const xt=i.schedule.findJumpRestrictedIndex(St+1,ut);if(xt>St){i.setSchedulePosition(xt);return}}let At=0;if(vt)i.timelinePos=gt,i.checkBuffer();else{const xt=ht.event.assetList,wt=st-(ht[at]||ht).start;for(let Ot=xt.length;Ot--;){const Bt=xt[Ot];if(Bt.duration&&wt>=Bt.startOffset&&wt<Bt.startOffset+Bt.duration){At=Ot;break}}}i.setSchedulePosition(ut,At)}}},nt=()=>{const st=i.effectivePlayingItem;if(i.isInterstitial(st))return st;const at=_();return i.isInterstitial(at)?at:null},it={get bufferedEnd(){const st=_(),at=i.bufferingItem;if(at&&at===st){var ot;return j(at,"playout",i.bufferingAsset,"bufferedPos","bufferedEnd")-at.playout.start||((ot=i.bufferingAsset)==null?void 0:ot.startOffset)||0}return 0},get currentTime(){const st=nt(),at=i.effectivePlayingItem;return at&&at===st?j(at,"playout",i.effectivePlayingAsset,"timelinePos","currentTime")-at.playout.start:0},set currentTime(st){const at=nt(),ot=i.effectivePlayingItem;ot&&ot===at&&rt(st+ot.playout.start,"playout")},get duration(){const st=nt();return st?st.playout.end-st.playout.start:0},get assetPlayers(){var st;const at=(st=nt())==null?void 0:st.event.assetList;return at?at.map(ot=>i.getAssetPlayer(ot.identifier)):[]},get playingIndex(){var st;const at=(st=nt())==null?void 0:st.event;return at&&i.effectivePlayingAsset?at.findAssetIndex(i.effectivePlayingAsset):-1},get scheduleItem(){return nt()}};return this.manager={get events(){var st;return((st=i.schedule)==null||(st=st.events)==null?void 0:st.slice(0))||[]},get schedule(){var st;return((st=i.schedule)==null||(st=st.items)==null?void 0:st.slice(0))||[]},get interstitialPlayer(){return nt()?it:null},get playerQueue(){return i.playerQueue.slice(0)},get bufferingAsset(){return i.bufferingAsset},get bufferingItem(){return _()},get bufferingIndex(){const st=_();return i.findItemIndex(st)},get playingAsset(){return i.effectivePlayingAsset},get playingItem(){return i.effectivePlayingItem},get playingIndex(){const st=i.effectivePlayingItem;return i.findItemIndex(st)},primary:{get bufferedEnd(){return et()},get currentTime(){const st=i.timelinePos;return st>0?st:0},set currentTime(st){rt(st,"primary")},get duration(){return tt("primary")},get seekableStart(){var st;return((st=i.primaryDetails)==null?void 0:st.fragmentStart)||0}},integrated:{get bufferedEnd(){return j(_(),"integrated",i.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return j(i.effectivePlayingItem,"integrated",i.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(st){rt(st,"integrated")},get duration(){return tt("integrated")},get seekableStart(){var st;return _e(((st=i.primaryDetails)==null?void 0:st.fragmentStart)||0,"integrated")}},skip:()=>{const st=i.effectivePlayingItem,at=st==null?void 0:st.event;if(at&&!at.restrictions.skip){const ot=i.findItemIndex(st);if(at.appendInPlace){const lt=st.playout.start+st.event.duration;rt(lt+.001,"playout")}else i.advanceAfterAssetEnded(at,ot,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var i;const _=this.playingItem,$=(i=this.schedule)==null?void 0:i.items;return!this.playbackStarted||!_||!$?!1:this.findItemIndex(_)===$.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var i,_;if(this.mediaSelection===null)return;const $=this.waitingItem||this.playingItem;if(this.isInterstitial($)&&!$.event.appendInPlace)return;let j=this.media;!j&&(i=this.bufferingItem)!=null&&(i=i.event)!=null&&i.appendInPlace&&(j=this.primaryMedia);const _e=(_=j)==null?void 0:_.currentTime;if(!(_e===void 0||!isFiniteNumber(_e)))return _e}get primaryMedia(){var i;return this.media||((i=this.detachedData)==null?void 0:i.media)||null}isInterstitial(i){return!!(i!=null&&i.event)}retreiveMediaSource(i,_){const $=this.getAssetPlayer(i);$&&this.transferMediaFromPlayer($,_)}transferMediaFromPlayer(i,_){const $=i.interstitial.appendInPlace,j=i.media;if($&&j===this.primaryMedia){if(this.bufferingAsset=null,(!_||this.isInterstitial(_)&&!_.event.appendInPlace)&&_&&j){this.detachedData={media:j};return}const _e=i.transferMedia();this.log(`transfer MediaSource from ${i} ${stringify(_e)}`),this.detachedData=_e}else _&&j&&(this.shouldPlay||(this.shouldPlay=!j.paused))}transferMediaTo(i,_){var $,j;if(i.media===_)return;let _e=null;const et=this.hls,tt=i!==et,rt=tt&&i.interstitial.appendInPlace,nt=($=this.detachedData)==null?void 0:$.mediaSource;let it;if(et.media)rt&&(_e=et.transferMedia(),this.detachedData=_e),it="Primary";else if(nt){const lt=this.getBufferingPlayer();lt?(_e=lt.transferMedia(),it=`${lt}`):it="detached MediaSource"}else it="detached media";if(!_e){if(nt)_e=this.detachedData,this.log(`using detachedData: MediaSource ${stringify(_e)}`);else if(!this.detachedData||et.media===_){const lt=this.playerQueue;lt.length>1&&lt.forEach(ct=>{if(tt&&ct.interstitial.appendInPlace!==rt){const ft=ct.interstitial;this.clearInterstitial(ct.interstitial,null),ft.appendInPlace=!1,ft.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${ft}`)}}),this.hls.detachMedia(),this.detachedData={media:_}}}const st=_e&&"mediaSource"in _e&&((j=_e.mediaSource)==null?void 0:j.readyState)!=="closed",at=st&&_e?_e:_;this.log(`${st?"transfering MediaSource":"attaching media"} to ${tt?i:"Primary"} from ${it} (media.currentTime: ${_.currentTime})`);const ot=this.schedule;if(at===_e&&ot){const lt=tt&&i.assetId===ot.assetIdAtEnd;at.overrides={duration:ot.duration,endOfStream:!tt||lt,cueRemoval:!tt}}i.attachMedia(at)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const i=this.schedule,_=i==null?void 0:i.events;if(!_||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const $=this.timelinePos,j=this.effectivePlayingItem;if($===-1){const _e=this.hls.startPosition;if(this.log(timelineMessage("checkStart",_e)),this.timelinePos=_e,_.length&&_[0].cue.pre){const et=i.findEventIndex(_[0].identifier);this.setSchedulePosition(et)}else if(_e>=0||!this.primaryLive){const et=this.timelinePos=_e>0?_e:0,tt=i.findItemIndexAtTime(et);this.setSchedulePosition(tt)}}else if(j&&!this.playingItem){const _e=i.findItemIndex(j);this.setSchedulePosition(_e)}}advanceAssetBuffering(i,_){const $=i.event,j=$.findAssetIndex(_),_e=getNextAssetIndex($,j);if(!$.isAssetPastPlayoutLimit(_e))this.bufferedToEvent(i,_e);else if(this.schedule){var et;const tt=(et=this.schedule.items)==null?void 0:et[this.findItemIndex(i)+1];tt&&this.bufferedToItem(tt)}}advanceAfterAssetEnded(i,_,$){const j=getNextAssetIndex(i,$);if(i.isAssetPastPlayoutLimit(j)){if(this.schedule){const _e=this.schedule.items;if(_e){const et=_+1,tt=_e.length;if(et>=tt){this.setSchedulePosition(-1);return}const rt=i.resumeTime;this.timelinePos<rt&&(this.log(timelineMessage("advanceAfterAssetEnded",rt)),this.timelinePos=rt,i.appendInPlace&&this.advanceInPlace(rt),this.checkBuffer(this.bufferedPos<rt)),this.setSchedulePosition(et)}}}else{if(i.appendInPlace){const _e=i.assetList[j];_e&&this.advanceInPlace(_e.timelineStart)}this.setSchedulePosition(_,j)}}setScheduleToAssetAtTime(i,_){const $=this.schedule;if(!$)return;const j=_.parentIdentifier,_e=$.getEvent(j);if(_e){const et=$.findEventIndex(j),tt=$.findAssetIndex(_e,i);this.advanceAfterAssetEnded(_e,et,tt-1)}}setSchedulePosition(i,_){var $;const j=($=this.schedule)==null?void 0:$.items;if(!j||this.playbackDisabled)return;const _e=i>=0?j[i]:null;this.log(`setSchedulePosition ${i}, ${_} (${_e&&segmentToString(_e)}) pos: ${this.timelinePos}`);const et=this.waitingItem||this.playingItem,tt=this.playingLastItem;if(this.isInterstitial(et)){const it=et.event,st=this.playingAsset,at=st==null?void 0:st.identifier,ot=at?this.getAssetPlayer(at):null;if(ot&&at&&(!this.eventItemsMatch(et,_e)||_!==void 0&&at!==it.assetList[_].identifier)){var rt;const lt=it.findAssetIndex(st);if(this.log(`INTERSTITIAL_ASSET_ENDED ${lt+1}/${it.assetList.length} ${eventAssetToString(st)}`),this.endedAsset=st,this.playingAsset=null,this.hls.trigger(Events.INTERSTITIAL_ASSET_ENDED,{asset:st,assetListIndex:lt,event:it,schedule:j.slice(0),scheduleIndex:i,player:ot}),et!==this.playingItem){this.itemsMatch(et,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(it,this.findItemIndex(this.playingItem),lt);return}this.retreiveMediaSource(at,_e),ot.media&&!((rt=this.detachedData)!=null&&rt.mediaSource)&&ot.detachMedia()}if(!this.eventItemsMatch(et,_e)&&(this.endedItem=et,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${it} ${segmentToString(et)}`),it.hasPlayed=!0,this.hls.trigger(Events.INTERSTITIAL_ENDED,{event:it,schedule:j.slice(0),scheduleIndex:i}),it.cue.once)){var nt;this.updateSchedule();const lt=(nt=this.schedule)==null?void 0:nt.items;if(_e&&lt){const ct=this.findItemIndex(_e);this.advanceSchedule(ct,lt,_,et,tt)}return}}this.advanceSchedule(i,j,_,et,tt)}advanceSchedule(i,_,$,j,_e){const et=this.schedule;if(!et)return;const tt=_[i]||null,rt=this.primaryMedia,nt=this.playerQueue;if(nt.length&&nt.forEach(it=>{const st=it.interstitial,at=et.findEventIndex(st.identifier);(at<i||at>i+1)&&this.clearInterstitial(st,tt)}),this.isInterstitial(tt)){this.timelinePos=Math.min(Math.max(this.timelinePos,tt.start),tt.end);const it=tt.event;if($===void 0){$=et.findAssetIndex(it,this.timelinePos);const lt=getNextAssetIndex(it,$-1);if(it.isAssetPastPlayoutLimit(lt)||it.appendInPlace&&this.timelinePos===tt.end){this.advanceAfterAssetEnded(it,i,$);return}$=lt}const st=this.waitingItem;this.assetsBuffered(tt,rt)||this.setBufferingItem(tt);let at=this.preloadAssets(it,$);if(this.eventItemsMatch(tt,st||j)||(this.waitingItem=tt,this.log(`INTERSTITIAL_STARTED ${segmentToString(tt)} ${it.appendInPlace?"append in place":""}`),this.hls.trigger(Events.INTERSTITIAL_STARTED,{event:it,schedule:_.slice(0),scheduleIndex:i})),!it.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${it}`);return}if(it.assetListLoader&&(it.assetListLoader.destroy(),it.assetListLoader=void 0),!rt){this.log(`Waiting for attachMedia to start Interstitial ${it}`);return}this.waitingItem=this.endedItem=null,this.playingItem=tt;const ot=it.assetList[$];if(!ot){this.advanceAfterAssetEnded(it,i,$||0);return}if(at||(at=this.getAssetPlayer(ot.identifier)),at===null||at.destroyed){const lt=it.assetList.length;this.warn(`asset ${$+1}/${lt} player destroyed ${it}`),at=this.createAssetPlayer(it,ot,$),at.loadSource()}if(!this.eventItemsMatch(tt,this.bufferingItem)&&it.appendInPlace&&this.isAssetBuffered(ot))return;this.startAssetPlayer(at,$,_,i,rt),this.shouldPlay&&playWithCatch(at.media)}else tt?(this.resumePrimary(tt,i,j),this.shouldPlay&&playWithCatch(this.hls.media)):_e&&this.isInterstitial(j)&&(this.endedItem=null,this.playingItem=j,j.event.appendInPlace||this.attachPrimary(et.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var i;return(i=this.mediaSelection)==null?void 0:i.main.details}get primaryLive(){var i;return!!((i=this.primaryDetails)!=null&&i.live)}resumePrimary(i,_,$){var j,_e;if(this.playingItem=i,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(i),this.log(`resuming ${segmentToString(i)}`),!((j=this.detachedData)!=null&&j.mediaSource)){let tt=this.timelinePos;(tt<i.start||tt>=i.end)&&(tt=this.getPrimaryResumption(i,_),this.log(timelineMessage("resumePrimary",tt)),this.timelinePos=tt),this.attachPrimary(tt,i)}if(!$)return;const et=(_e=this.schedule)==null?void 0:_e.items;et&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${segmentToString(i)}`),this.hls.trigger(Events.INTERSTITIALS_PRIMARY_RESUMED,{schedule:et.slice(0),scheduleIndex:_}),this.checkBuffer())}getPrimaryResumption(i,_){const $=i.start;if(this.primaryLive){const j=this.primaryDetails;if(_===0)return this.hls.startPosition;if(j&&($<j.fragmentStart||$>j.edge))return this.hls.liveSyncPosition||-1}return $}isAssetBuffered(i){const _=this.getAssetPlayer(i.identifier);return _!=null&&_.hls?_.hls.bufferedToEnd:BufferHelper.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=i.timelineStart+(i.duration||0)}attachPrimary(i,_,$){_?this.setBufferingItem(_):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const j=this.primaryMedia;if(!j)return;const _e=this.hls;_e.media?this.checkBuffer():(this.transferMediaTo(_e,j),$&&this.startLoadingPrimaryAt(i,$)),$||(this.log(timelineMessage("attachPrimary",i)),this.timelinePos=i,this.startLoadingPrimaryAt(i,$))}startLoadingPrimaryAt(i,_){var $;const j=this.hls;!j.loadingEnabled||!j.media||Math.abs(((($=j.mainForwardBufferInfo)==null?void 0:$.start)||j.media.currentTime)-i)>.5?j.startLoad(i,_):j.bufferingEnabled||j.resumeBuffering()}onManifestLoading(){var i;this.stopLoad(),(i=this.schedule)==null||i.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(Events.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(i,_){if(_.level===-1||!this.schedule)return;const $=this.hls.levels[_.level];if(!$.details)return;const j=_objectSpread2(_objectSpread2({},this.mediaSelection||this.altSelection),{},{main:$});this.mediaSelection=j,this.schedule.parseInterstitialDateRanges(j,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(i,_){const $=this.hls.audioTracks[_.id],j=this.mediaSelection;if(!j){this.altSelection=_objectSpread2(_objectSpread2({},this.altSelection),{},{audio:$});return}const _e=_objectSpread2(_objectSpread2({},j),{},{audio:$});this.mediaSelection=_e}onSubtitleTrackUpdated(i,_){const $=this.hls.subtitleTracks[_.id],j=this.mediaSelection;if(!j){this.altSelection=_objectSpread2(_objectSpread2({},this.altSelection),{},{subtitles:$});return}const _e=_objectSpread2(_objectSpread2({},j),{},{subtitles:$});this.mediaSelection=_e}onAudioTrackSwitching(i,_){const $=getBasicSelectionOption(_);this.playerQueue.forEach(({hls:j})=>j&&(j.setAudioOption(_)||j.setAudioOption($)))}onSubtitleTrackSwitch(i,_){const $=getBasicSelectionOption(_);this.playerQueue.forEach(({hls:j})=>j&&(j.setSubtitleOption(_)||_.id!==-1&&j.setSubtitleOption($)))}onBufferCodecs(i,_){const $=_.tracks;$&&(this.requiredTracks=$)}onBufferAppended(i,_){this.checkBuffer()}onBufferFlushed(i,_){const $=this.playingItem;if($&&!this.itemsMatch($,this.bufferingItem)&&!this.isInterstitial($)){const j=this.timelinePos;this.bufferedPos=j,this.checkBuffer()}}onBufferedToEnd(i){if(!this.schedule)return;const _=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&_){for(let j=0;j<_.length;j++){const _e=_[j];if(_e.cue.post){var $;const et=this.schedule.findEventIndex(_e.identifier),tt=($=this.schedule.items)==null?void 0:$[et];this.isInterstitial(tt)&&this.eventItemsMatch(tt,this.bufferingItem)&&this.bufferedToItem(tt,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(i){const _=this.playingItem;if(!this.playingLastItem&&_){const $=this.findItemIndex(_);this.setSchedulePosition($+1)}else this.shouldPlay=!1}updateItem(i,_){var $;const j=($=this.schedule)==null?void 0:$.items;if(i&&j){const _e=this.findItemIndex(i,_);return j[_e]||null}return null}trimInPlace(i,_){if(this.isInterstitial(i)&&i.event.appendInPlace&&_.end-i.end>.25){i.event.assetList.forEach((_e,et)=>{i.event.isAssetPastPlayoutLimit(et)&&this.clearAssetPlayer(_e.identifier,null)});const $=i.end+.25,j=BufferHelper.bufferInfo(this.primaryMedia,$,0);(j.end>$||(j.nextStart||0)>$)&&(this.log(`trim buffered interstitial ${segmentToString(i)} (was ${segmentToString(_)})`),this.attachPrimary($,null,!0),this.flushFrontBuffer($))}}itemsMatch(i,_){return!!_&&(i===_||i.event&&_.event&&this.eventItemsMatch(i,_)||!i.event&&!_.event&&this.findItemIndex(i)===this.findItemIndex(_))}eventItemsMatch(i,_){var $;return!!_&&(i===_||i.event.identifier===(($=_.event)==null?void 0:$.identifier))}findItemIndex(i,_){return i&&this.schedule?this.schedule.findItemIndex(i,_):-1}updateSchedule(i=!1){var _;const $=this.mediaSelection;$&&((_=this.schedule)==null||_.updateSchedule($,[],i))}checkBuffer(i){var _;const $=(_=this.schedule)==null?void 0:_.items;if(!$)return;const j=BufferHelper.bufferInfo(this.primaryMedia,this.timelinePos,0);i&&(this.bufferedPos=this.timelinePos),i||(i=j.len<1),this.updateBufferedPos(j.end,$,i)}updateBufferedPos(i,_,$){const j=this.schedule,_e=this.bufferingItem;if(this.bufferedPos>i||!j)return;if(_.length===1&&this.itemsMatch(_[0],_e)){this.bufferedPos=i;return}const et=this.playingItem,tt=this.findItemIndex(et);let rt=j.findItemIndexAtTime(i);if(this.bufferedPos<i){var nt;const it=this.findItemIndex(_e),st=Math.min(it+1,_.length-1),at=_[st];if((rt===-1&&_e&&i>=_e.end||(nt=at.event)!=null&&nt.appendInPlace&&i+.01>=at.start)&&(rt=st),this.isInterstitial(_e)){const ot=_e.event;if(st-tt>1&&ot.appendInPlace===!1||ot.assetList.length===0&&ot.assetListLoader)return}if(this.bufferedPos=i,rt>it&&rt>tt)this.bufferedToItem(at);else{const ot=this.primaryDetails;this.primaryLive&&ot&&i>ot.edge-ot.targetduration&&at.start<ot.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(at)&&this.preloadAssets(at.event,0)}}else $&&et&&!this.itemsMatch(et,_e)&&(rt===tt?this.bufferedToItem(et):rt===tt+1&&this.bufferedToItem(_[rt]))}assetsBuffered(i,_){return i.event.assetList.length===0?!1:!i.event.assetList.some(j=>{const _e=this.getAssetPlayer(j.identifier);return!(_e!=null&&_e.bufferedInPlaceToEnd(_))})}setBufferingItem(i){const _=this.bufferingItem,$=this.schedule;if(!this.itemsMatch(i,_)&&$){const{items:j,events:_e}=$;if(!j||!_e)return _;const et=this.isInterstitial(i),tt=this.getBufferingPlayer();this.bufferingItem=i,this.bufferedPos=Math.max(i.start,Math.min(i.end,this.timelinePos));const rt=tt?tt.remaining:_?_.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${segmentToString(i)}`+(_?` (${rt.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(et){const nt=$.findAssetIndex(i.event,this.bufferedPos);i.event.assetList.forEach((it,st)=>{const at=this.getAssetPlayer(it.identifier);at&&(st===nt&&at.loadSource(),at.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(nt=>nt.pauseBuffering());this.hls.trigger(Events.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:_e.slice(0),schedule:j.slice(0),bufferingIndex:this.findItemIndex(i),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==i&&(this.bufferingItem=i);return _}bufferedToItem(i,_=0){const $=this.setBufferingItem(i);if(!this.playbackDisabled){if(this.isInterstitial(i))this.bufferedToEvent(i,_);else if($!==null){this.bufferingAsset=null;const j=this.detachedData;j?j.mediaSource?this.attachPrimary(i.start,i,!0):this.preloadPrimary(i):this.preloadPrimary(i)}}}preloadPrimary(i){const _=this.findItemIndex(i),$=this.getPrimaryResumption(i,_);this.startLoadingPrimaryAt($)}bufferedToEvent(i,_){const $=i.event,j=$.assetList.length===0&&!$.assetListLoader,_e=$.cue.once;if(j||!_e){const et=this.preloadAssets($,_);if(et!=null&&et.interstitial.appendInPlace){const tt=this.primaryMedia;tt&&this.bufferAssetPlayer(et,tt)}}}preloadAssets(i,_){const $=i.assetUrl,j=i.assetList.length,_e=j===0&&!i.assetListLoader,et=i.cue.once;if(_e){const rt=i.timelineStart;if(i.appendInPlace){var tt;const at=this.playingItem;!this.isInterstitial(at)&&(at==null||(tt=at.nextEvent)==null?void 0:tt.identifier)===i.identifier&&this.flushFrontBuffer(rt+.25)}let nt,it=0;if(!this.playingItem&&this.primaryLive&&(it=this.hls.startPosition,it===-1&&(it=this.hls.liveSyncPosition||0)),it&&!(i.cue.pre||i.cue.post)){const at=it-rt;at>0&&(nt=Math.round(at*1e3)/1e3)}if(this.log(`Load interstitial asset ${_+1}/${$?1:j} ${i}${nt?` live-start: ${it} start-offset: ${nt}`:""}`),$)return this.createAsset(i,0,0,rt,i.duration,$);const st=this.assetListLoader.loadAssetList(i,nt);st&&(i.assetListLoader=st)}else if(!et&&j){for(let nt=_;nt<j;nt++){const it=i.assetList[nt],st=this.getAssetPlayerQueueIndex(it.identifier);(st===-1||this.playerQueue[st].destroyed)&&!it.error&&this.createAssetPlayer(i,it,nt)}const rt=i.assetList[_];if(rt){const nt=this.getAssetPlayer(rt.identifier);return nt&&nt.loadSource(),nt}}return null}flushFrontBuffer(i){const _=this.requiredTracks;if(!_)return;this.log(`Removing front buffer starting at ${i}`),Object.keys(_).forEach(j=>{this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:i,endOffset:1/0,type:j})})}getAssetPlayerQueueIndex(i){const _=this.playerQueue;for(let $=0;$<_.length;$++)if(i===_[$].assetId)return $;return-1}getAssetPlayer(i){const _=this.getAssetPlayerQueueIndex(i);return this.playerQueue[_]||null}getBufferingPlayer(){const{playerQueue:i,primaryMedia:_}=this;if(_){for(let $=0;$<i.length;$++)if(i[$].media===_)return i[$]}return null}createAsset(i,_,$,j,_e,et){const tt={parentIdentifier:i.identifier,identifier:generateAssetIdentifier(i,et,_),duration:_e,startOffset:$,timelineStart:j,uri:et};return this.createAssetPlayer(i,tt,_)}createAssetPlayer(i,_,$){const j=this.hls,_e=j.userConfig;let et=_e.videoPreference;const tt=j.loadLevelObj||j.levels[j.currentLevel];(et||tt)&&(et=_extends({},et),tt.videoCodec&&(et.videoCodec=tt.videoCodec),tt.videoRange&&(et.allowedVideoRanges=[tt.videoRange]));const rt=j.audioTracks[j.audioTrack],nt=j.subtitleTracks[j.subtitleTrack];let it=0;if(this.primaryLive||i.appendInPlace){const mt=this.timelinePos-_.timelineStart;if(mt>1){const pt=_.duration;pt&&mt<pt&&(it=mt)}}const st=_.identifier,at=_objectSpread2(_objectSpread2({},_e),{},{maxMaxBufferLength:Math.min(180,j.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:j.sessionId,assetPlayerId:st,abrEwmaDefaultEstimate:j.bandwidthEstimate,interstitialsController:void 0,startPosition:it,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:et,audioPreference:rt||_e.audioPreference,subtitlePreference:nt||_e.subtitlePreference});i.appendInPlace&&(i.appendInPlaceStarted=!0,_.timelineStart&&(at.timelineOffset=_.timelineStart));const ot=at.cmcd;ot!=null&&ot.sessionId&&ot.contentId&&(at.cmcd=_extends({},ot,{contentId:hash$1(_.uri)})),this.getAssetPlayer(st)&&this.warn(`Duplicate date range identifier ${i} and asset ${st}`);const lt=new HlsAssetPlayer(this.HlsPlayerClass,at,i,_);this.playerQueue.push(lt),i.assetList[$]=_;let ct=!0;const ft=mt=>{if(mt.live){var pt;const vt=new Error(`Interstitials MUST be VOD assets ${i}`),St={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:vt},At=((pt=this.schedule)==null?void 0:pt.findEventIndex(i.identifier))||-1;this.handleAssetItemError(St,i,At,$,vt.message);return}const yt=mt.edge-mt.fragmentStart,gt=_.duration;(ct||gt===null||yt>gt)&&(ct=!1,this.log(`Interstitial asset "${st}" duration change ${gt} > ${yt}`),_.duration=yt,this.updateSchedule())};lt.on(Events.LEVEL_UPDATED,(mt,{details:pt})=>ft(pt)),lt.on(Events.LEVEL_PTS_UPDATED,(mt,{details:pt})=>ft(pt)),lt.on(Events.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const ut=(mt,pt)=>{const yt=this.getAssetPlayer(st);if(yt&&pt.tracks){yt.off(Events.BUFFER_CODECS,ut),yt.tracks=pt.tracks;const gt=this.primaryMedia;this.bufferingAsset===yt.assetItem&&gt&&!yt.media&&this.bufferAssetPlayer(yt,gt)}};lt.on(Events.BUFFER_CODECS,ut);const ht=()=>{var mt;const pt=this.getAssetPlayer(st);if(this.log(`buffered to end of asset ${pt}`),!pt||!this.schedule)return;const yt=this.schedule.findEventIndex(i.identifier),gt=(mt=this.schedule.items)==null?void 0:mt[yt];this.isInterstitial(gt)&&this.advanceAssetBuffering(gt,_)};lt.on(Events.BUFFERED_TO_END,ht);const dt=mt=>()=>{if(!this.getAssetPlayer(st)||!this.schedule)return;this.shouldPlay=!0;const yt=this.schedule.findEventIndex(i.identifier);this.advanceAfterAssetEnded(i,yt,mt)};return lt.once(Events.MEDIA_ENDED,dt($)),lt.once(Events.PLAYOUT_LIMIT_REACHED,dt(1/0)),lt.on(Events.ERROR,(mt,pt)=>{if(!this.schedule)return;const yt=this.getAssetPlayer(st);if(pt.details===ErrorDetails.BUFFER_STALLED_ERROR){if(yt!=null&&yt.appendInPlace){this.handleInPlaceStall(i);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(pt,i,this.schedule.findEventIndex(i.identifier),$,`Asset player error ${pt.error} ${i}`)}),lt.on(Events.DESTROYING,()=>{if(!this.getAssetPlayer(st)||!this.schedule)return;const pt=new Error(`Asset player destroyed unexpectedly ${st}`),yt={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:pt};this.handleAssetItemError(yt,i,this.schedule.findEventIndex(i.identifier),$,pt.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${eventAssetToString(_)}`),this.hls.trigger(Events.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:_,assetListIndex:$,event:i,player:lt}),lt}clearInterstitial(i,_){i.assetList.forEach($=>{this.clearAssetPlayer($.identifier,_)}),i.reset()}resetAssetPlayer(i){const _=this.getAssetPlayerQueueIndex(i);if(_!==-1){this.log(`reset asset player "${i}" after error`);const $=this.playerQueue[_];this.transferMediaFromPlayer($,null),$.resetDetails()}}clearAssetPlayer(i,_){const $=this.getAssetPlayerQueueIndex(i);if($!==-1){const j=this.playerQueue[$];this.log(`clear ${j} toSegment: ${_&&segmentToString(_)}`),this.transferMediaFromPlayer(j,_),this.playerQueue.splice($,1),j.destroy()}}emptyPlayerQueue(){let i;for(;i=this.playerQueue.pop();)i.destroy();this.playerQueue=[]}startAssetPlayer(i,_,$,j,_e){const{interstitial:et,assetItem:tt,assetId:rt}=i,nt=et.assetList.length,it=this.playingAsset;this.endedAsset=null,this.playingAsset=tt,(!it||it.identifier!==rt)&&(it&&(this.clearAssetPlayer(it.identifier,$[j]),delete it.error),this.log(`INTERSTITIAL_ASSET_STARTED ${_+1}/${nt} ${eventAssetToString(tt)}`),this.hls.trigger(Events.INTERSTITIAL_ASSET_STARTED,{asset:tt,assetListIndex:_,event:et,schedule:$.slice(0),scheduleIndex:j,player:i})),this.bufferAssetPlayer(i,_e)}bufferAssetPlayer(i,_){var $,j;if(!this.schedule)return;const{interstitial:_e,assetItem:et}=i,tt=this.schedule.findEventIndex(_e.identifier),rt=($=this.schedule.items)==null?void 0:$[tt];if(!rt)return;i.loadSource(),this.setBufferingItem(rt),this.bufferingAsset=et;const nt=this.getBufferingPlayer();if(nt===i)return;const it=_e.appendInPlace;if(it&&(nt==null?void 0:nt.interstitial.appendInPlace)===!1)return;const st=(nt==null?void 0:nt.tracks)||((j=this.detachedData)==null?void 0:j.tracks)||this.requiredTracks;if(it&&et!==this.playingAsset){if(!i.tracks){this.log(`Waiting for track info before buffering ${i}`);return}if(st&&!isCompatibleTrackChange(st,i.tracks)){const at=new Error(`Asset ${eventAssetToString(et)} SourceBuffer tracks ('${Object.keys(i.tracks)}') are not compatible with primary content tracks ('${Object.keys(st)}')`),ot={fatal:!0,type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERSTITIAL_ASSET_ITEM_ERROR,error:at},lt=_e.findAssetIndex(et);this.handleAssetItemError(ot,_e,tt,lt,at.message);return}}this.transferMediaTo(i,_)}handleInPlaceStall(i){const _=this.schedule,$=this.primaryMedia;if(!_||!$)return;const j=$.currentTime,_e=_.findAssetIndex(i,j),et=i.assetList[_e];if(et){const tt=this.getAssetPlayer(et.identifier);if(tt){const rt=tt.currentTime||j-et.timelineStart,nt=tt.duration-rt;if(this.warn(`Stalled at ${rt} of ${rt+nt} in ${tt} ${i} (media.currentTime: ${j})`),rt&&(nt/$.playbackRate<.5||tt.bufferedInPlaceToEnd($))&&tt.hls){const it=_.findEventIndex(i.identifier);this.advanceAfterAssetEnded(i,it,_e)}}}}advanceInPlace(i){const _=this.primaryMedia;_&&_.currentTime<i&&(_.currentTime=i)}handleAssetItemError(i,_,$,j,_e){if(i.details===ErrorDetails.BUFFER_STALLED_ERROR)return;const et=_.assetList[j]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${et&&eventAssetToString(et)} ${i.error}`),!this.schedule)return;const tt=(et==null?void 0:et.identifier)||"",rt=this.getAssetPlayerQueueIndex(tt),nt=this.playerQueue[rt]||null,it=this.schedule.items,st=_extends({},i,{fatal:!1,errorAction:createDoNothingErrorAction(!0),asset:et,assetListIndex:j,event:_,schedule:it,scheduleIndex:$,player:nt});if(this.hls.trigger(Events.INTERSTITIAL_ASSET_ERROR,st),!i.fatal)return;const at=this.playingAsset,ot=this.bufferingAsset,lt=new Error(_e);if(et&&(this.clearAssetPlayer(tt,null),et.error=lt),!_.assetList.some(ct=>!ct.error))_.error=lt;else for(let ct=j;ct<_.assetList.length;ct++)this.resetAssetPlayer(_.assetList[ct].identifier);this.updateSchedule(!0),_.error?this.primaryFallback(_):at&&at.identifier===tt?this.advanceAfterAssetEnded(_,$,j):ot&&ot.identifier===tt&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,ot)}primaryFallback(i){const _=i.timelineStart,$=this.effectivePlayingItem;if($){this.log(`Fallback to primary from event "${i.identifier}" start: ${_} pos: ${this.timelinePos} playing: ${segmentToString($)} error: ${i.error}`);let j=this.timelinePos;j===-1&&(j=this.hls.startPosition);const _e=this.updateItem($,j);if(this.itemsMatch($,_e)&&this.clearInterstitial(i,null),i.appendInPlace&&(this.attachPrimary(_,null),this.flushFrontBuffer(_)),!this.schedule)return;const et=this.schedule.findItemIndexAtTime(j);this.setSchedulePosition(et)}else this.checkStart()}onAssetListLoaded(i,_){var $,j;const _e=_.event,et=_e.identifier,tt=_.assetListResponse.ASSETS;if(!(($=this.schedule)!=null&&$.hasEvent(et)))return;const rt=_e.timelineStart,nt=_e.duration;let it=0;tt.forEach((ct,ft)=>{const ut=parseFloat(ct.DURATION);this.createAsset(_e,ft,it,rt+it,ut,ct.URI),it+=ut}),_e.duration=it,this.log(`Loaded asset-list with duration: ${it} (was: ${nt}) ${_e}`);const st=this.waitingItem,at=(st==null?void 0:st.event.identifier)===et;this.updateSchedule();const ot=(j=this.bufferingItem)==null?void 0:j.event;if(at){var lt;const ct=this.schedule.findEventIndex(et),ft=(lt=this.schedule.items)==null?void 0:lt[ct];if(ft){if(!this.playingItem&&this.timelinePos>ft.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==ct){_e.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${_e}`),this.updateSchedule(!0),this.primaryFallback(_e);return}this.setBufferingItem(ft)}this.setSchedulePosition(ct)}else if((ot==null?void 0:ot.identifier)===et){const ct=_e.assetList[0];if(ct){const ft=this.getAssetPlayer(ct.identifier);if(ot.appendInPlace){const ut=this.primaryMedia;ft&&ut&&this.bufferAssetPlayer(ft,ut)}else ft&&ft.loadSource()}}}onError(i,_){if(this.schedule)switch(_.details){case ErrorDetails.ASSET_LIST_PARSING_ERROR:case ErrorDetails.ASSET_LIST_LOAD_ERROR:case ErrorDetails.ASSET_LIST_LOAD_TIMEOUT:{const $=_.interstitial;$&&(this.updateSchedule(!0),this.primaryFallback($));break}case ErrorDetails.BUFFER_STALLED_ERROR:{const $=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial($)&&$.event.appendInPlace){this.handleInPlaceStall($.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const TICK_INTERVAL$2=500;class SubtitleStreamController extends BaseStreamController{constructor(i,_,$){super(i,_,$,"subtitle-stream-controller",PlaylistLevelType.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:i}=this;i.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),i.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:i}=this;i.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),i.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(i,_){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL$2),this.nextLoadPosition=this.lastCurrentTime=i+this.timelineOffset,this.startPosition=_?-1:i,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(i,_){this.tracksBuffered=[],super.onMediaDetaching(i,_)}onLevelLoaded(i,_){this.mainDetails=_.details}onSubtitleFragProcessed(i,_){const{frag:$,success:j}=_;if(this.fragContextChanged($)||(isMediaFragment($)&&(this.fragPrevious=$),this.state=State.IDLE),!j)return;const _e=this.tracksBuffered[this.currentTrackId];if(!_e)return;let et;const tt=$.start;for(let nt=0;nt<_e.length;nt++)if(tt>=_e[nt].start&&tt<=_e[nt].end){et=_e[nt];break}const rt=$.start+$.duration;et?et.end=rt:(et={start:tt,end:rt},_e.push(et)),this.fragmentTracker.fragBuffered($),this.fragBufferedComplete($,null),this.media&&this.tick()}onBufferFlushing(i,_){const{startOffset:$,endOffset:j}=_;if($===0&&j!==Number.POSITIVE_INFINITY){const _e=j-1;if(_e<=0)return;_.endOffsetSubtitles=Math.max(0,_e),this.tracksBuffered.forEach(et=>{for(let tt=0;tt<et.length;){if(et[tt].end<=_e){et.shift();continue}else if(et[tt].start<_e)et[tt].start=_e;else break;tt++}}),this.fragmentTracker.removeFragmentsInRange($,_e,PlaylistLevelType.SUBTITLE)}}onError(i,_){const $=_.frag;($==null?void 0:$.type)===PlaylistLevelType.SUBTITLE&&(_.details===ErrorDetails.FRAG_GAP&&this.fragmentTracker.fragBuffered($,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(i,{subtitleTracks:_}){if(this.levels&&subtitleOptionsIdentical(this.levels,_)){this.levels=_.map($=>new Level($));return}this.tracksBuffered=[],this.levels=_.map($=>{const j=new Level($);return this.tracksBuffered[j.id]=[],j}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(i,_){var $;if(this.currentTrackId=_.id,!(($=this.levels)!=null&&$.length)||this.currentTrackId===-1){this.clearInterval();return}const j=this.levels[this.currentTrackId];j!=null&&j.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,j&&this.state!==State.STOPPED&&this.setInterval(TICK_INTERVAL$2)}onSubtitleTrackLoaded(i,_){var $;const{currentTrackId:j,levels:_e}=this,{details:et,id:tt}=_;if(!_e){this.warn(`Subtitle tracks were reset while loading level ${tt}`);return}const rt=_e[tt];if(tt>=_e.length||!rt)return;this.log(`Subtitle track ${tt} loaded [${et.startSN},${et.endSN}]${et.lastPartSn?`[part-${et.lastPartSn}-${et.lastPartIndex}]`:""},duration:${et.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let nt=0;if(et.live||($=rt.details)!=null&&$.live){if(et.deltaUpdateFailed)return;const st=this.mainDetails;if(!st){this.startFragRequested=!1;return}const at=st.fragments[0];if(!rt.details)et.hasProgramDateTime&&st.hasProgramDateTime?(alignMediaPlaylistByPDT(et,st),nt=et.fragmentStart):at&&(nt=at.start,addSliding(et,nt));else{var it;nt=this.alignPlaylists(et,rt.details,(it=this.levelLastLoaded)==null?void 0:it.details),nt===0&&at&&(nt=at.start,addSliding(et,nt))}st&&!this.startFragRequested&&this.setStartPosition(st,nt)}rt.details=et,this.levelLastLoaded=rt,tt===j&&(this.hls.trigger(Events.SUBTITLE_TRACK_UPDATED,{details:et,id:tt,groupId:_.groupId}),this.tick(),et.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,et.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),rt.details=void 0)))}_handleFragmentLoadComplete(i){const{frag:_,payload:$}=i,j=_.decryptdata,_e=this.hls;if(!this.fragContextChanged(_)&&$&&$.byteLength>0&&j!=null&&j.key&&j.iv&&isFullSegmentEncryption(j.method)){const et=performance.now();this.decrypter.decrypt(new Uint8Array($),j.key.buffer,j.iv.buffer,getAesModeFromFullSegmentMethod(j.method)).catch(tt=>{throw _e.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:tt,reason:tt.message,frag:_}),tt}).then(tt=>{const rt=performance.now();_e.trigger(Events.FRAG_DECRYPTED,{frag:_,payload:tt,stats:{tstart:et,tdecrypt:rt}})}).catch(tt=>{this.warn(`${tt.name}: ${tt.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:i,levels:_}=this,$=_==null?void 0:_[i];if(!$||!_.length||!$.details||this.waitForLive($))return;const{config:j}=this,_e=this.getLoadPosition(),et=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],_e,j.maxBufferHole),{end:tt,len:rt}=et,nt=$.details,it=this.hls.maxBufferLength+nt.levelTargetDuration;if(rt>it)return;const st=nt.fragments,at=st.length,ot=nt.edge;let lt=null;const ct=this.fragPrevious;if(tt<ot){const ht=j.maxFragLookUpTolerance,dt=tt>ot-ht?0:ht;lt=findFragmentByPTS(ct,st,Math.max(st[0].start,tt),dt),!lt&&ct&&ct.start<st[0].start&&(lt=st[0])}else lt=st[at-1];if(lt=this.filterReplacedPrimary(lt,$.details),!lt)return;const ft=lt.sn-nt.startSN,ut=st[ft-1];if(ut&&ut.cc===lt.cc&&this.fragmentTracker.getState(ut)===FragmentState.NOT_LOADED&&(lt=ut),this.fragmentTracker.getState(lt)===FragmentState.NOT_LOADED){const ht=this.mapToInitFragWhenRequired(lt);ht&&this.loadFragment(ht,$,tt)}}}loadFragment(i,_,$){isMediaFragment(i)?super.loadFragment(i,_,$):this._loadInitSegment(i,_)}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(i){this.buffered=void 0;const _=($,j,_e)=>{if(j=j>>>0,j>_e-1)throw new DOMException(`Failed to execute '${$}' on 'TimeRanges': The index provided (${j}) is greater than the maximum bound (${_e})`);return i[j][$]};this.buffered={get length(){return i.length},end($){return _("end",$,i.length)},start($){return _("start",$,i.length)}}}}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=o=>String.fromCharCode(specialCea608CharsCodes[o]||o),NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(i,_){if(this.verboseLevel>=i){const $=typeof _=="function"?_():_;logger.log(`${this.time} [${i}] ${$}`)}}}const numArrayToHexArray=function o(i){const _=[];for(let $=0;$<i.length;$++)_.push(i[$].toString(16));return _};class PenState{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(i){const _=["foreground","underline","italics","background","flash"];for(let $=0;$<_.length;$++){const j=_[$];i.hasOwnProperty(j)&&(this[j]=i[j])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(i){return this.foreground===i.foreground&&this.underline===i.underline&&this.italics===i.italics&&this.background===i.background&&this.flash===i.flash}copy(i){this.foreground=i.foreground,this.underline=i.underline,this.italics=i.italics,this.background=i.background,this.flash=i.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(){this.uchar=" ",this.penState=new PenState}reset(){this.uchar=" ",this.penState.reset()}setChar(i,_){this.uchar=i,this.penState.copy(_)}setPenState(i){this.penState.copy(i)}equals(i){return this.uchar===i.uchar&&this.penState.equals(i.penState)}copy(i){this.uchar=i.uchar,this.penState.copy(i.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(i){this.chars=[],this.pos=0,this.currPenState=new PenState,this.cueStartTime=null,this.logger=void 0;for(let _=0;_<NR_COLS;_++)this.chars.push(new StyledUnicodeChar);this.logger=i}equals(i){for(let _=0;_<NR_COLS;_++)if(!this.chars[_].equals(i.chars[_]))return!1;return!0}copy(i){for(let _=0;_<NR_COLS;_++)this.chars[_].copy(i.chars[_])}isEmpty(){let i=!0;for(let _=0;_<NR_COLS;_++)if(!this.chars[_].isEmpty()){i=!1;break}return i}setCursor(i){this.pos!==i&&(this.pos=i),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(i){const _=this.pos+i;if(i>1)for(let $=this.pos+1;$<_+1;$++)this.chars[$].setPenState(this.currPenState);this.setCursor(_)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(i){i>=144&&this.backSpace();const _=getCharForByte(i);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+i.toString(16)+" ("+_+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(_,this.currPenState),this.moveCursor(1)}clearFromPos(i){let _;for(_=i;_<NR_COLS;_++)this.chars[_].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const i=[];let _=!0;for(let $=0;$<NR_COLS;$++){const j=this.chars[$].uchar;j!==" "&&(_=!1),i.push(j)}return _?"":i.join("")}setPenStyles(i){this.currPenState.setStyles(i),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(i){this.rows=[],this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let _=0;_<NR_ROWS;_++)this.rows.push(new Row(i));this.logger=i}reset(){for(let i=0;i<NR_ROWS;i++)this.rows[i].clear();this.currRow=NR_ROWS-1}equals(i){let _=!0;for(let $=0;$<NR_ROWS;$++)if(!this.rows[$].equals(i.rows[$])){_=!1;break}return _}copy(i){for(let _=0;_<NR_ROWS;_++)this.rows[_].copy(i.rows[_])}isEmpty(){let i=!0;for(let _=0;_<NR_ROWS;_++)if(!this.rows[_].isEmpty()){i=!1;break}return i}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(i){this.rows[this.currRow].insertChar(i)}setPen(i){this.rows[this.currRow].setPenStyles(i)}moveCursor(i){this.rows[this.currRow].moveCursor(i)}setCursor(i){this.logger.log(2,"setCursor: "+i),this.rows[this.currRow].setCursor(i)}setPAC(i){this.logger.log(2,()=>"pacData = "+stringify(i));let _=i.row-1;if(this.nrRollUpRows&&_<this.nrRollUpRows-1&&(_=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==_){for(let tt=0;tt<NR_ROWS;tt++)this.rows[tt].clear();const _e=this.currRow+1-this.nrRollUpRows,et=this.lastOutputScreen;if(et){const tt=et.rows[_e].cueStartTime,rt=this.logger.time;if(tt!==null&&rt!==null&&tt<rt)for(let nt=0;nt<this.nrRollUpRows;nt++)this.rows[_-this.nrRollUpRows+nt+1].copy(et.rows[_e+nt])}}this.currRow=_;const $=this.rows[this.currRow];if(i.indent!==null){const _e=i.indent,et=Math.max(_e-1,0);$.setCursor(i.indent),i.color=$.chars[et].penState.foreground}const j={foreground:i.color,underline:i.underline,italics:i.italics,background:"black",flash:!1};this.setPen(j)}setBkgData(i){this.logger.log(2,()=>"bkgData = "+stringify(i)),this.backSpace(),this.setPen(i),this.insertChar(32)}setRollUpRows(i){this.nrRollUpRows=i}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const i=this.currRow+1-this.nrRollUpRows,_=this.rows.splice(i,1)[0];_.clear(),this.rows.splice(this.currRow,0,_),this.logger.log(2,"Rolling up")}getDisplayText(i){i=i||!1;const _=[];let $="",j=-1;for(let _e=0;_e<NR_ROWS;_e++){const et=this.rows[_e].getTextString();et&&(j=_e+1,i?_.push("Row "+j+": '"+et+"'"):_.push(et.trim()))}return _.length>0&&(i?$="["+_.join(" | ")+"]":$=_.join(`
`)),$}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(i,_,$){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=i,this.outputFilter=_,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen($),this.nonDisplayedMemory=new CaptionScreen($),this.lastOutputScreen=new CaptionScreen($),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=$}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(i){this.outputFilter=i}setPAC(i){this.writeScreen.setPAC(i)}setBkgData(i){this.writeScreen.setBkgData(i)}setMode(i){i!==this.mode&&(this.mode=i,this.logger.log(2,()=>"MODE="+i),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=i)}insertChars(i){for(let $=0;$<i.length;$++)this.writeScreen.insertChar(i[$]);const _=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>_+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(i){this.logger.log(2,"RU("+i+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(i)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const i=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=i,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(i){this.logger.log(2,"TO("+i+") - Tab Offset"),this.writeScreen.moveCursor(i)}ccMIDROW(i){const _={flash:!1};if(_.underline=i%2===1,_.italics=i>=46,_.italics)_.foreground="white";else{const $=Math.floor(i/2)-16,j=["white","green","blue","cyan","red","yellow","magenta"];_.foreground=j[$]}this.logger.log(2,"MIDROW: "+stringify(_)),this.writeScreen.setPen(_)}outputDataUpdate(i=!1){const _=this.logger.time;_!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=_:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,_,this.lastOutputScreen),i&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:_),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(i){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,i,this.displayedMemory),this.cueStartTime=i))}}class Cea608Parser{constructor(i,_,$){this.channels=void 0,this.currentChannel=0,this.cmdHistory=createCmdHistory(),this.logger=void 0;const j=this.logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(i,_,j),new Cea608Channel(i+1,$,j)]}getHandler(i){return this.channels[i].getHandler()}setHandler(i,_){this.channels[i].setHandler(_)}addData(i,_){this.logger.time=i;for(let $=0;$<_.length;$+=2){const j=_[$]&127,_e=_[$+1]&127;let et=!1,tt=null;if(j===0&&_e===0)continue;this.logger.log(3,()=>"["+numArrayToHexArray([_[$],_[$+1]])+"] -> ("+numArrayToHexArray([j,_e])+")");const rt=this.cmdHistory;if(j>=16&&j<=31){if(hasCmdRepeated(j,_e,rt)){setLastCmd(null,null,rt),this.logger.log(3,()=>"Repeated command ("+numArrayToHexArray([j,_e])+") is dropped");continue}setLastCmd(j,_e,this.cmdHistory),et=this.parseCmd(j,_e),et||(et=this.parseMidrow(j,_e)),et||(et=this.parsePAC(j,_e)),et||(et=this.parseBackgroundAttributes(j,_e))}else setLastCmd(null,null,rt);if(!et&&(tt=this.parseChars(j,_e),tt)){const it=this.currentChannel;it&&it>0?this.channels[it].insertChars(tt):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!et&&!tt&&this.logger.log(2,()=>"Couldn't parse cleaned data "+numArrayToHexArray([j,_e])+" orig: "+numArrayToHexArray([_[$],_[$+1]]))}}parseCmd(i,_){const $=(i===20||i===28||i===21||i===29)&&_>=32&&_<=47,j=(i===23||i===31)&&_>=33&&_<=35;if(!($||j))return!1;const _e=i===20||i===21||i===23?1:2,et=this.channels[_e];return i===20||i===21||i===28||i===29?_===32?et.ccRCL():_===33?et.ccBS():_===34?et.ccAOF():_===35?et.ccAON():_===36?et.ccDER():_===37?et.ccRU(2):_===38?et.ccRU(3):_===39?et.ccRU(4):_===40?et.ccFON():_===41?et.ccRDC():_===42?et.ccTR():_===43?et.ccRTD():_===44?et.ccEDM():_===45?et.ccCR():_===46?et.ccENM():_===47&&et.ccEOC():et.ccTO(_-32),this.currentChannel=_e,!0}parseMidrow(i,_){let $=0;if((i===17||i===25)&&_>=32&&_<=47){if(i===17?$=1:$=2,$!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const j=this.channels[$];return j?(j.ccMIDROW(_),this.logger.log(3,()=>"MIDROW ("+numArrayToHexArray([i,_])+")"),!0):!1}return!1}parsePAC(i,_){let $;const j=(i>=17&&i<=23||i>=25&&i<=31)&&_>=64&&_<=127,_e=(i===16||i===24)&&_>=64&&_<=95;if(!(j||_e))return!1;const et=i<=23?1:2;_>=64&&_<=95?$=et===1?rowsLowCh1[i]:rowsLowCh2[i]:$=et===1?rowsHighCh1[i]:rowsHighCh2[i];const tt=this.channels[et];return tt?(tt.setPAC(this.interpretPAC($,_)),this.currentChannel=et,!0):!1}interpretPAC(i,_){let $;const j={color:null,italics:!1,indent:null,underline:!1,row:i};return _>95?$=_-96:$=_-64,j.underline=($&1)===1,$<=13?j.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor($/2)]:$<=15?(j.italics=!0,j.color="white"):j.indent=Math.floor(($-16)/2)*4,j}parseChars(i,_){let $,j=null,_e=null;if(i>=25?($=2,_e=i-8):($=1,_e=i),_e>=17&&_e<=19){let et;_e===17?et=_+80:_e===18?et=_+112:et=_+144,this.logger.log(2,()=>"Special char '"+getCharForByte(et)+"' in channel "+$),j=[et]}else i>=32&&i<=127&&(j=_===0?[i]:[i,_]);return j&&this.logger.log(3,()=>"Char codes =  "+numArrayToHexArray(j).join(",")),j}parseBackgroundAttributes(i,_){const $=(i===16||i===24)&&_>=32&&_<=47,j=(i===23||i===31)&&_>=45&&_<=47;if(!($||j))return!1;let _e;const et={};i===16||i===24?(_e=Math.floor((_-32)/2),et.background=backgroundColors[_e],_%2===1&&(et.background=et.background+"_semi")):_===45?et.background="transparent":(et.foreground="black",_===47&&(et.underline=!0));const tt=i<=23?1:2;return this.channels[tt].setBkgData(et),!0}reset(){for(let i=0;i<Object.keys(this.channels).length;i++){const _=this.channels[i];_&&_.reset()}setLastCmd(null,null,this.cmdHistory)}cueSplitAtTime(i){for(let _=0;_<this.channels.length;_++){const $=this.channels[_];$&&$.cueSplitAtTime(i)}}}function setLastCmd(o,i,_){_.a=o,_.b=i}function hasCmdRepeated(o,i,_){return _.a===o&&_.b===i}function createCmdHistory(){return{a:null,b:null}}var VTTCue=function(){if(optionalSelf!=null&&optionalSelf.VTTCue)return self.VTTCue;const o=["","lr","rl"],i=["start","middle","end","left","right"];function _(tt,rt){if(typeof rt!="string"||!Array.isArray(tt))return!1;const nt=rt.toLowerCase();return~tt.indexOf(nt)?nt:!1}function $(tt){return _(o,tt)}function j(tt){return _(i,tt)}function _e(tt,...rt){let nt=1;for(;nt<arguments.length;nt++){const it=arguments[nt];for(const st in it)tt[st]=it[st]}return tt}function et(tt,rt,nt){const it=this,st={enumerable:!0};it.hasBeenReset=!1;let at="",ot=!1,lt=tt,ct=rt,ft=nt,ut=null,ht="",dt=!0,mt="auto",pt="start",yt=50,gt="middle",vt=50,St="middle";Object.defineProperty(it,"id",_e({},st,{get:function(){return at},set:function(At){at=""+At}})),Object.defineProperty(it,"pauseOnExit",_e({},st,{get:function(){return ot},set:function(At){ot=!!At}})),Object.defineProperty(it,"startTime",_e({},st,{get:function(){return lt},set:function(At){if(typeof At!="number")throw new TypeError("Start time must be set to a number.");lt=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"endTime",_e({},st,{get:function(){return ct},set:function(At){if(typeof At!="number")throw new TypeError("End time must be set to a number.");ct=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"text",_e({},st,{get:function(){return ft},set:function(At){ft=""+At,this.hasBeenReset=!0}})),Object.defineProperty(it,"region",_e({},st,{get:function(){return ut},set:function(At){ut=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"vertical",_e({},st,{get:function(){return ht},set:function(At){const xt=$(At);if(xt===!1)throw new SyntaxError("An invalid or illegal string was specified.");ht=xt,this.hasBeenReset=!0}})),Object.defineProperty(it,"snapToLines",_e({},st,{get:function(){return dt},set:function(At){dt=!!At,this.hasBeenReset=!0}})),Object.defineProperty(it,"line",_e({},st,{get:function(){return mt},set:function(At){if(typeof At!="number"&&At!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");mt=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"lineAlign",_e({},st,{get:function(){return pt},set:function(At){const xt=j(At);if(!xt)throw new SyntaxError("An invalid or illegal string was specified.");pt=xt,this.hasBeenReset=!0}})),Object.defineProperty(it,"position",_e({},st,{get:function(){return yt},set:function(At){if(At<0||At>100)throw new Error("Position must be between 0 and 100.");yt=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"positionAlign",_e({},st,{get:function(){return gt},set:function(At){const xt=j(At);if(!xt)throw new SyntaxError("An invalid or illegal string was specified.");gt=xt,this.hasBeenReset=!0}})),Object.defineProperty(it,"size",_e({},st,{get:function(){return vt},set:function(At){if(At<0||At>100)throw new Error("Size must be between 0 and 100.");vt=At,this.hasBeenReset=!0}})),Object.defineProperty(it,"align",_e({},st,{get:function(){return St},set:function(At){const xt=j(At);if(!xt)throw new SyntaxError("An invalid or illegal string was specified.");St=xt,this.hasBeenReset=!0}})),it.displayState=void 0}return et.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},et}();class StringDecoder{decode(i,_){if(!i)return"";if(typeof i!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(i))}}function parseTimeStamp(o){function i($,j,_e,et){return($|0)*3600+(j|0)*60+(_e|0)+parseFloat(et||0)}const _=o.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return _?parseFloat(_[2])>59?i(_[2],_[3],0,_[4]):i(_[1],_[2],_[3],_[4]):null}let Settings$1=class{constructor(){this.values=Object.create(null)}set(i,_){!this.get(i)&&_!==""&&(this.values[i]=_)}get(i,_,$){return $?this.has(i)?this.values[i]:_[$]:this.has(i)?this.values[i]:_}has(i){return i in this.values}alt(i,_,$){for(let j=0;j<$.length;++j)if(_===$[j]){this.set(i,_);break}}integer(i,_){/^-?\d+$/.test(_)&&this.set(i,parseInt(_,10))}percent(i,_){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(_)){const $=parseFloat(_);if($>=0&&$<=100)return this.set(i,$),!0}return!1}};function parseOptions(o,i,_,$){const j=$?o.split($):[o];for(const _e in j){if(typeof j[_e]!="string")continue;const et=j[_e].split(_);if(et.length!==2)continue;const tt=et[0],rt=et[1];i(tt,rt)}}const defaults$1=new VTTCue(0,0,""),center=defaults$1.align==="middle"?"middle":"center";function parseCue(o,i,_){const $=o;function j(){const tt=parseTimeStamp(o);if(tt===null)throw new Error("Malformed timestamp: "+$);return o=o.replace(/^[^\sa-zA-Z-]+/,""),tt}function _e(tt,rt){const nt=new Settings$1;parseOptions(tt,function(at,ot){let lt;switch(at){case"region":for(let ct=_.length-1;ct>=0;ct--)if(_[ct].id===ot){nt.set(at,_[ct].region);break}break;case"vertical":nt.alt(at,ot,["rl","lr"]);break;case"line":lt=ot.split(","),nt.integer(at,lt[0]),nt.percent(at,lt[0])&&nt.set("snapToLines",!1),nt.alt(at,lt[0],["auto"]),lt.length===2&&nt.alt("lineAlign",lt[1],["start",center,"end"]);break;case"position":lt=ot.split(","),nt.percent(at,lt[0]),lt.length===2&&nt.alt("positionAlign",lt[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":nt.percent(at,ot);break;case"align":nt.alt(at,ot,["start",center,"end","left","right"]);break}},/:/,/\s/),rt.region=nt.get("region",null),rt.vertical=nt.get("vertical","");let it=nt.get("line","auto");it==="auto"&&defaults$1.line===-1&&(it=-1),rt.line=it,rt.lineAlign=nt.get("lineAlign","start"),rt.snapToLines=nt.get("snapToLines",!0),rt.size=nt.get("size",100),rt.align=nt.get("align",center);let st=nt.get("position","auto");st==="auto"&&defaults$1.position===50&&(st=rt.align==="start"||rt.align==="left"?0:rt.align==="end"||rt.align==="right"?100:50),rt.position=st}function et(){o=o.replace(/^\s+/,"")}if(et(),i.startTime=j(),et(),o.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+$);o=o.slice(3),et(),i.endTime=j(),et(),_e(o,i)}function fixLineBreaks(o){return o.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(i){const _=this;i&&(_.buffer+=_.decoder.decode(i,{stream:!0}));function $(){let _e=_.buffer,et=0;for(_e=fixLineBreaks(_e);et<_e.length&&_e[et]!=="\r"&&_e[et]!==`
`;)++et;const tt=_e.slice(0,et);return _e[et]==="\r"&&++et,_e[et]===`
`&&++et,_.buffer=_e.slice(et),tt}function j(_e){parseOptions(_e,function(et,tt){},/:/)}try{let _e="";if(_.state==="INITIAL"){if(!/\r\n|\n/.test(_.buffer))return this;_e=$();const tt=_e.match(/^()?WEBVTT([ \t].*)?$/);if(!(tt!=null&&tt[0]))throw new Error("Malformed WebVTT signature.");_.state="HEADER"}let et=!1;for(;_.buffer;){if(!/\r\n|\n/.test(_.buffer))return this;switch(et?et=!1:_e=$(),_.state){case"HEADER":/:/.test(_e)?j(_e):_e||(_.state="ID");continue;case"NOTE":_e||(_.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(_e)){_.state="NOTE";break}if(!_e)continue;if(_.cue=new VTTCue(0,0,""),_.state="CUE",_e.indexOf("-->")===-1){_.cue.id=_e;continue}case"CUE":if(!_.cue){_.state="BADCUE";continue}try{parseCue(_e,_.cue,_.regionList)}catch{_.cue=null,_.state="BADCUE";continue}_.state="CUETEXT";continue;case"CUETEXT":{const tt=_e.indexOf("-->")!==-1;if(!_e||tt&&(et=!0)){_.oncue&&_.cue&&_.oncue(_.cue),_.cue=null,_.state="ID";continue}if(_.cue===null)continue;_.cue.text&&(_.cue.text+=`
`),_.cue.text+=_e}continue;case"BADCUE":_e||(_.state="ID")}}}catch{_.state==="CUETEXT"&&_.cue&&_.oncue&&_.oncue(_.cue),_.cue=null,_.state=_.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const i=this;try{if((i.cue||i.state==="HEADER")&&(i.buffer+=`

`,i.parse()),i.state==="INITIAL"||i.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(_){i.onparsingerror&&i.onparsingerror(_)}return i.onflush&&i.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function o(i,_,$=0){return i.slice($,$+_.length)===_},cueString2millis=function o(i){let _=parseInt(i.slice(-3));const $=parseInt(i.slice(-6,-4)),j=parseInt(i.slice(-9,-7)),_e=i.length>9?parseInt(i.substring(0,i.indexOf(":"))):0;if(!isFiniteNumber(_)||!isFiniteNumber($)||!isFiniteNumber(j)||!isFiniteNumber(_e))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${i}`);return _+=1e3*$,_+=60*1e3*j,_+=60*60*1e3*_e,_};function generateCueId(o,i,_){return hash$1(o.toString())+hash$1(i.toString())+hash$1(_)}const calculateOffset=function o(i,_,$){let j=i[_],_e=i[j.prevCC];if(!_e||!_e.new&&j.new){i.ccOffset=i.presentationOffset=j.start,j.new=!1;return}for(;(et=_e)!=null&&et.new;){var et;i.ccOffset+=j.start-_e.start,j.new=!1,j=_e,_e=i[j.prevCC]}i.presentationOffset=$};function parseWebVTT(o,i,_,$,j,_e,et){const tt=new VTTParser,rt=utf8ArrayToStr(new Uint8Array(o)).trim().replace(LINEBREAKS,`
`).split(`
`),nt=[],it=i?toMpegTsClockFromTimescale(i.baseTime,i.timescale):0;let st="00:00.000",at=0,ot=0,lt,ct=!0;tt.oncue=function(ft){const ut=_[$];let ht=_.ccOffset;const dt=(at-it)/9e4;if(ut!=null&&ut.new&&(ot!==void 0?ht=_.ccOffset=ut.start:calculateOffset(_,$,dt)),dt){if(!i){lt=new Error("Missing initPTS for VTT MPEGTS");return}ht=dt-_.presentationOffset}const mt=ft.endTime-ft.startTime,pt=normalizePts((ft.startTime+ht-ot)*9e4,j*9e4)/9e4;ft.startTime=Math.max(pt,0),ft.endTime=Math.max(pt+mt,0);const yt=ft.text.trim();ft.text=decodeURIComponent(encodeURIComponent(yt)),ft.id||(ft.id=generateCueId(ft.startTime,ft.endTime,yt)),ft.endTime>0&&nt.push(ft)},tt.onparsingerror=function(ft){lt=ft},tt.onflush=function(){if(lt){et(lt);return}_e(nt)},rt.forEach(ft=>{if(ct)if(startsWith(ft,"X-TIMESTAMP-MAP=")){ct=!1,ft.slice(16).split(",").forEach(ut=>{startsWith(ut,"LOCAL:")?st=ut.slice(6):startsWith(ut,"MPEGTS:")&&(at=parseInt(ut.slice(7)))});try{ot=cueString2millis(st)/1e3}catch(ut){lt=ut}return}else ft===""&&(ct=!1);tt.parse(ft+`
`)}),tt.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(o,i,_,$){const j=findBox(new Uint8Array(o),["mdat"]);if(j.length===0){$(new Error("Could not parse IMSC1 mdat"));return}const _e=j.map(tt=>utf8ArrayToStr(tt)),et=toTimescaleFromScale(i.baseTime,1,i.timescale);try{_e.forEach(tt=>_(parseTTML(tt,et)))}catch(tt){$(tt)}}function parseTTML(o,i){const j=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("tt")[0];if(!j)throw new Error("Invalid ttml");const _e={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},et=Object.keys(_e).reduce((st,at)=>(st[at]=j.getAttribute(`ttp:${at}`)||_e[at],st),{}),tt=j.getAttribute("xml:space")!=="preserve",rt=collectionToDictionary(getElementCollection(j,"styling","style")),nt=collectionToDictionary(getElementCollection(j,"layout","region")),it=getElementCollection(j,"body","[begin]");return[].map.call(it,st=>{const at=getTextContent(st,tt);if(!at||!st.hasAttribute("begin"))return null;const ot=parseTtmlTime(st.getAttribute("begin"),et),lt=parseTtmlTime(st.getAttribute("dur"),et);let ct=parseTtmlTime(st.getAttribute("end"),et);if(ot===null)throw timestampParsingError(st);if(ct===null){if(lt===null)throw timestampParsingError(st);ct=ot+lt}const ft=new VTTCue(ot-i,ct-i,at);ft.id=generateCueId(ft.startTime,ft.endTime,ft.text);const ut=nt[st.getAttribute("region")],ht=rt[st.getAttribute("style")],dt=getTtmlStyles(ut,ht,rt),{textAlign:mt}=dt;if(mt){const pt=textAlignToLineAlign[mt];pt&&(ft.lineAlign=pt),ft.align=mt}return _extends(ft,dt),ft}).filter(st=>st!==null)}function getElementCollection(o,i,_){const $=o.getElementsByTagName(i)[0];return $?[].slice.call($.querySelectorAll(_)):[]}function collectionToDictionary(o){return o.reduce((i,_)=>{const $=_.getAttribute("xml:id");return $&&(i[$]=_),i},{})}function getTextContent(o,i){return[].slice.call(o.childNodes).reduce((_,$,j)=>{var _e;return $.nodeName==="br"&&j?_+`
`:(_e=$.childNodes)!=null&&_e.length?getTextContent($,i):i?_+$.textContent.trim().replace(/\s+/g," "):_+$.textContent},"")}function getTtmlStyles(o,i,_){const $="http://www.w3.org/ns/ttml#styling";let j=null;const _e=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],et=o!=null&&o.hasAttribute("style")?o.getAttribute("style"):null;return et&&_.hasOwnProperty(et)&&(j=_[et]),_e.reduce((tt,rt)=>{const nt=getAttributeNS(i,$,rt)||getAttributeNS(o,$,rt)||getAttributeNS(j,$,rt);return nt&&(tt[rt]=nt),tt},{})}function getAttributeNS(o,i,_){return o&&o.hasAttributeNS(i,_)?o.getAttributeNS(i,_):null}function timestampParsingError(o){return new Error(`Could not parse ttml timestamp ${o}`)}function parseTtmlTime(o,i){if(!o)return null;let _=parseTimeStamp(o);return _===null&&(HMSF_REGEX.test(o)?_=parseHoursMinutesSecondsFrames(o,i):TIME_UNIT_REGEX.test(o)&&(_=parseTimeUnits(o,i))),_}function parseHoursMinutesSecondsFrames(o,i){const _=HMSF_REGEX.exec(o),$=(_[4]|0)+(_[5]|0)/i.subFrameRate;return(_[1]|0)*3600+(_[2]|0)*60+(_[3]|0)+$/i.frameRate}function parseTimeUnits(o,i){const _=TIME_UNIT_REGEX.exec(o),$=Number(_[1]);switch(_[2]){case"h":return $*3600;case"m":return $*60;case"ms":return $*1e3;case"f":return $/i.frameRate;case"t":return $/i.tickRate}return $}class OutputFilter{constructor(i,_){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=i,this.trackName=_}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(i,_,$){(this.startTime===null||this.startTime>i)&&(this.startTime=i),this.endTime=_,this.screen=$,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class TimelineController{constructor(i){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},i.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(Events.FRAG_LOADING,this.onFragLoading,this),i.on(Events.FRAG_LOADED,this.onFragLoaded,this),i.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:i}=this;i.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.off(Events.FRAG_LOADING,this.onFragLoading,this),i.off(Events.FRAG_LOADED,this.onFragLoaded,this),i.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const i=new OutputFilter(this,"textTrack1"),_=new OutputFilter(this,"textTrack2"),$=new OutputFilter(this,"textTrack3"),j=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,i,_),this.cea608Parser2=new Cea608Parser(3,$,j)}addCues(i,_,$,j,_e){let et=!1;for(let tt=_e.length;tt--;){const rt=_e[tt],nt=intersection(rt[0],rt[1],_,$);if(nt>=0&&(rt[0]=Math.min(rt[0],_),rt[1]=Math.max(rt[1],$),et=!0,nt/($-_)>.5))return}if(et||_e.push([_,$]),this.config.renderTextTracksNatively){const tt=this.captionsTracks[i];this.Cues.newCue(tt,_,$,j)}else{const tt=this.Cues.newCue(null,_,$,j);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:tt,track:i})}}onInitPtsFound(i,{frag:_,id:$,initPTS:j,timescale:_e,trackId:et}){const{unparsedVttFrags:tt}=this;$===PlaylistLevelType.MAIN&&(this.initPTS[_.cc]={baseTime:j,timescale:_e,trackId:et}),tt.length&&(this.unparsedVttFrags=[],tt.forEach(rt=>{this.initPTS[rt.frag.cc]?this.onFragLoaded(Events.FRAG_LOADED,rt):this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:rt.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(i,_){const{media:$}=this;if($)for(let j=0;j<$.textTracks.length;j++){const _e=$.textTracks[j];if(canReuseVttTextTrack(_e,{name:i,lang:_,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return _e}return null}createCaptionsTrack(i){this.config.renderTextTracksNatively?this.createNativeTrack(i):this.createNonNativeTrack(i)}createNativeTrack(i){if(this.captionsTracks[i])return;const{captionsProperties:_,captionsTracks:$,media:j}=this,{label:_e,languageCode:et}=_[i],tt=this.getExistingTrack(_e,et);if(tt)$[i]=tt,clearCurrentCues($[i]),sendAddTrackEvent($[i],j);else{const rt=this.createTextTrack("captions",_e,et);rt&&(rt[i]=!0,$[i]=rt)}}createNonNativeTrack(i){if(this.nonNativeCaptionsTracks[i])return;const _=this.captionsProperties[i];if(!_)return;const $=_.label,j={_id:i,label:$,kind:"captions",default:_.media?!!_.media.default:!1,closedCaptions:_.media};this.nonNativeCaptionsTracks[i]=j,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[j]})}createTextTrack(i,_,$){const j=this.media;if(j)return j.addTextTrack(i,_,$)}onMediaAttaching(i,_){this.media=_.media,_.mediaSource||this._cleanTracks()}onMediaDetaching(i,_){const $=!!_.transferMedia;if(this.media=null,$)return;const{captionsTracks:j}=this;Object.keys(j).forEach(_e=>{clearCurrentCues(j[_e]),delete j[_e]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:i}=this;if(!i)return;const _=i.textTracks;if(_)for(let $=0;$<_.length;$++)clearCurrentCues(_[$])}onSubtitleTracksUpdated(i,_){const $=_.subtitleTracks||[],j=$.some(_e=>_e.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||j&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,$)){this.tracks=$;return}if(this.textTracks=[],this.tracks=$,this.config.renderTextTracksNatively){const et=this.media,tt=et?filterSubtitleTracks(et.textTracks):null;if(this.tracks.forEach((rt,nt)=>{let it;if(tt){let st=null;for(let at=0;at<tt.length;at++)if(tt[at]&&canReuseVttTextTrack(tt[at],rt)){st=tt[at],tt[at]=null;break}st&&(it=st)}if(it)clearCurrentCues(it);else{const st=captionsOrSubtitlesFromCharacteristics(rt);it=this.createTextTrack(st,rt.name,rt.lang),it&&(it.mode="disabled")}it&&this.textTracks.push(it)}),tt!=null&&tt.length){const rt=tt.filter(nt=>nt!==null).map(nt=>nt.label);rt.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${rt.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const et=this.tracks.map(tt=>({label:tt.name,kind:tt.type.toLowerCase(),default:tt.default,subtitleTrack:tt}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:et})}}}onManifestLoaded(i,_){this.config.enableCEA708Captions&&_.captions&&_.captions.forEach($=>{const j=/(?:CC|SERVICE)([1-4])/.exec($.instreamId);if(!j)return;const _e=`textTrack${j[1]}`,et=this.captionsProperties[_e];et&&(et.label=$.name,$.lang&&(et.languageCode=$.lang),et.media=$)})}closedCaptionsForLevel(i){const _=this.hls.levels[i.level];return _==null?void 0:_.attrs["CLOSED-CAPTIONS"]}onFragLoading(i,_){if(this.enabled&&_.frag.type===PlaylistLevelType.MAIN){var $,j;const{cea608Parser1:_e,cea608Parser2:et,lastSn:tt}=this,{cc:rt,sn:nt}=_.frag,it=($=(j=_.part)==null?void 0:j.index)!=null?$:-1;_e&&et&&(nt!==tt+1||nt===tt&&it!==this.lastPartIndex+1||rt!==this.lastCc)&&(_e.reset(),et.reset()),this.lastCc=rt,this.lastSn=nt,this.lastPartIndex=it}}onFragLoaded(i,_){const{frag:$,payload:j}=_;if($.type===PlaylistLevelType.SUBTITLE)if(j.byteLength){const _e=$.decryptdata,et="stats"in _;if(_e==null||!_e.encrypted||et){const tt=this.tracks[$.level],rt=this.vttCCs;rt[$.cc]||(rt[$.cc]={start:$.start,prevCC:this.prevCC,new:!0},this.prevCC=$.cc),tt&&tt.textCodec===IMSC1_CODEC?this._parseIMSC1($,j):this._parseVTTs(_)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:$,error:new Error("Empty subtitle payload")})}_parseIMSC1(i,_){const $=this.hls;parseIMSC1(_,this.initPTS[i.cc],j=>{this._appendCues(j,i.level),$.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},j=>{$.logger.log(`Failed to parse IMSC1: ${j}`),$.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:j})})}_parseVTTs(i){var _;const{frag:$,payload:j}=i,{initPTS:_e,unparsedVttFrags:et}=this,tt=_e.length-1;if(!_e[$.cc]&&tt===-1){et.push(i);return}const rt=this.hls,nt=(_=$.initSegment)!=null&&_.data?appendUint8Array($.initSegment.data,new Uint8Array(j)).buffer:j;parseWebVTT(nt,this.initPTS[$.cc],this.vttCCs,$.cc,$.start,it=>{this._appendCues(it,$.level),rt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:$})},it=>{const st=it.message==="Missing initPTS for VTT MPEGTS";st?et.push(i):this._fallbackToIMSC1($,j),rt.logger.log(`Failed to parse VTT cue: ${it}`),!(st&&tt>$.cc)&&rt.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:$,error:it})})}_fallbackToIMSC1(i,_){const $=this.tracks[i.level];$.textCodec||parseIMSC1(_,this.initPTS[i.cc],()=>{$.textCodec=IMSC1_CODEC,this._parseIMSC1(i,_)},()=>{$.textCodec="wvtt"})}_appendCues(i,_){const $=this.hls;if(this.config.renderTextTracksNatively){const j=this.textTracks[_];if(!j||j.mode==="disabled")return;i.forEach(_e=>addCueToTrack(j,_e))}else{const j=this.tracks[_];if(!j)return;const _e=j.default?"default":"subtitles"+_;$.trigger(Events.CUES_PARSED,{type:"subtitles",cues:i,track:_e})}}onFragDecrypted(i,_){const{frag:$}=_;$.type===PlaylistLevelType.SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,_)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(i,_){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:$,samples:j}=_;if(!($.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel($)==="NONE"))for(let _e=0;_e<j.length;_e++){const et=j[_e].bytes;if(et){this.cea608Parser1||this.initCea608Parsers();const tt=this.extractCea608Data(et);this.cea608Parser1.addData(j[_e].pts,tt[0]),this.cea608Parser2.addData(j[_e].pts,tt[1])}}}onBufferFlushing(i,{startOffset:_,endOffset:$,endOffsetSubtitles:j,type:_e}){const{media:et}=this;if(!(!et||et.currentTime<$)){if(!_e||_e==="video"){const{captionsTracks:tt}=this;Object.keys(tt).forEach(rt=>removeCuesInRange(tt[rt],_,$))}if(this.config.renderTextTracksNatively&&_===0&&j!==void 0){const{textTracks:tt}=this;Object.keys(tt).forEach(rt=>removeCuesInRange(tt[rt],_,j))}}}extractCea608Data(i){const _=[[],[]],$=i[0]&31;let j=2;for(let _e=0;_e<$;_e++){const et=i[j++],tt=127&i[j++],rt=127&i[j++];if(tt===0&&rt===0)continue;if((4&et)!==0){const it=3&et;(it===0||it===1)&&(_[it].push(tt),_[it].push(rt))}}return _}}function captionsOrSubtitlesFromCharacteristics(o){return o.characteristics&&/transcribes-spoken-dialog/gi.test(o.characteristics)&&/describes-music-and-sound/gi.test(o.characteristics)?"captions":"subtitles"}function canReuseVttTextTrack(o,i){return!!o&&o.kind===captionsOrSubtitlesFromCharacteristics(i)&&subtitleTrackMatchesTextTrack(i,o)}function intersection(o,i,_,$){return Math.min(i,$)-Math.max(o,_)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const WHITESPACE_CHAR=/\s/,Cues={newCue(o,i,_,$){const j=[];let _e,et,tt,rt,nt;const it=self.VTTCue||self.TextTrackCue;for(let at=0;at<$.rows.length;at++)if(_e=$.rows[at],tt=!0,rt=0,nt="",!_e.isEmpty()){var st;for(let ct=0;ct<_e.chars.length;ct++)WHITESPACE_CHAR.test(_e.chars[ct].uchar)&&tt?rt++:(nt+=_e.chars[ct].uchar,tt=!1);_e.cueStartTime=i,i===_&&(_+=1e-4),rt>=16?rt--:rt++;const ot=fixLineBreaks(nt.trim()),lt=generateCueId(i,_,ot);o!=null&&(st=o.cues)!=null&&st.getCueById(lt)||(et=new it(i,_,ot),et.id=lt,et.line=at+1,et.align="left",et.position=10+Math.min(80,Math.floor(rt*8/32)*10),j.push(et))}return o&&j.length&&(j.sort((at,ot)=>at.line==="auto"||ot.line==="auto"?0:at.line>8&&ot.line>8?ot.line-at.line:at.line-ot.line),j.forEach(at=>addCueToTrack(o,at))),j}};function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(i){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=i.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var i;this.abortInternal(),(i=this.callbacks)!=null&&i.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(i,_,$){const j=this.stats;if(j.loading.start)throw new Error("Loader can only be used once.");j.loading.start=self.performance.now();const _e=getRequestParameters(i,this.controller.signal),et=i.responseType==="arraybuffer",tt=et?"byteLength":"length",{maxTimeToFirstByteMs:rt,maxLoadTimeMs:nt}=_.loadPolicy;this.context=i,this.config=_,this.callbacks=$,this.request=this.fetchSetup(i,_e),self.clearTimeout(this.requestTimeout),_.timeout=rt&&isFiniteNumber(rt)?rt:nt,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(j,i,this.response))},_.timeout),(isPromise(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(st=>{var at;this.response=this.loader=st;const ot=Math.max(self.performance.now(),j.loading.start);if(self.clearTimeout(this.requestTimeout),_.timeout=nt,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(j,i,this.response))},nt-(ot-j.loading.start)),!st.ok){const{status:ct,statusText:ft}=st;throw new FetchError(ft||"fetch, bad network response",ct,st)}j.loading.first=ot,j.total=getContentLength(st.headers)||j.total;const lt=(at=this.callbacks)==null?void 0:at.onProgress;return lt&&isFiniteNumber(_.highWaterMark)?this.loadProgressively(st,j,i,_.highWaterMark,lt):et?st.arrayBuffer():i.responseType==="json"?st.json():st.text()}).then(st=>{var at,ot;const lt=this.response;if(!lt)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),j.loading.end=Math.max(self.performance.now(),j.loading.first);const ct=st[tt];ct&&(j.loaded=j.total=ct);const ft={url:lt.url,data:st,code:lt.status},ut=(at=this.callbacks)==null?void 0:at.onProgress;ut&&!isFiniteNumber(_.highWaterMark)&&ut(j,i,st,lt),(ot=this.callbacks)==null||ot.onSuccess(ft,j,i,lt)}).catch(st=>{var at;if(self.clearTimeout(this.requestTimeout),j.aborted)return;const ot=st&&st.code||0,lt=st?st.message:null;(at=this.callbacks)==null||at.onError({code:ot,text:lt},i,st?st.details:null,j)})}getCacheAge(){let i=null;if(this.response){const _=this.response.headers.get("age");i=_?parseFloat(_):null}return i}getResponseHeader(i){return this.response?this.response.headers.get(i):null}loadProgressively(i,_,$,j=0,_e){const et=new ChunkCache,tt=i.body.getReader(),rt=()=>tt.read().then(nt=>{if(nt.done)return et.dataLength&&_e(_,$,et.flush().buffer,i),Promise.resolve(new ArrayBuffer(0));const it=nt.value,st=it.length;return _.loaded+=st,st<j||et.dataLength?(et.push(it),et.dataLength>=j&&_e(_,$,et.flush().buffer,i)):_e(_,$,it.buffer,i),rt()}).catch(()=>Promise.reject());return rt()}}function getRequestParameters(o,i){const _={method:"GET",mode:"cors",credentials:"same-origin",signal:i,headers:new self.Headers(_extends({},o.headers))};return o.rangeEnd&&_.headers.set("Range","bytes="+o.rangeStart+"-"+String(o.rangeEnd-1)),_}function getByteRangeLength(o){const i=BYTERANGE.exec(o);if(i)return parseInt(i[2])-parseInt(i[1])+1}function getContentLength(o){const i=o.get("Content-Range");if(i){const $=getByteRangeLength(i);if(isFiniteNumber($))return $}const _=o.get("Content-Length");if(_)return parseInt(_)}function getRequest(o,i){return new self.Request(o.url,i)}class FetchError extends Error{constructor(i,_,$){super(i),this.code=void 0,this.details=void 0,this.code=_,this.details=$}}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(i){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=i&&i.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const i=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),i&&(i.onreadystatechange=null,i.onprogress=null,i.readyState!==4&&(this.stats.aborted=!0,i.abort()))}abort(){var i;this.abortInternal(),(i=this.callbacks)!=null&&i.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(i,_,$){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=i,this.config=_,this.callbacks=$,this.loadInternal()}loadInternal(){const{config:i,context:_}=this;if(!i||!_)return;const $=this.loader=new self.XMLHttpRequest,j=this.stats;j.loading.first=0,j.loaded=0,j.aborted=!1;const _e=this.xhrSetup;_e?Promise.resolve().then(()=>{if(!(this.loader!==$||this.stats.aborted))return _e($,_.url)}).catch(et=>{if(!(this.loader!==$||this.stats.aborted))return $.open("GET",_.url,!0),_e($,_.url)}).then(()=>{this.loader!==$||this.stats.aborted||this.openAndSendXhr($,_,i)}).catch(et=>{var tt;(tt=this.callbacks)==null||tt.onError({code:$.status,text:et.message},_,$,j)}):this.openAndSendXhr($,_,i)}openAndSendXhr(i,_,$){i.readyState||i.open("GET",_.url,!0);const j=_.headers,{maxTimeToFirstByteMs:_e,maxLoadTimeMs:et}=$.loadPolicy;if(j)for(const tt in j)i.setRequestHeader(tt,j[tt]);_.rangeEnd&&i.setRequestHeader("Range","bytes="+_.rangeStart+"-"+(_.rangeEnd-1)),i.onreadystatechange=this.readystatechange.bind(this),i.onprogress=this.loadprogress.bind(this),i.responseType=_.responseType,self.clearTimeout(this.requestTimeout),$.timeout=_e&&isFiniteNumber(_e)?_e:et,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),$.timeout),i.send()}readystatechange(){const{context:i,loader:_,stats:$}=this;if(!i||!_)return;const j=_.readyState,_e=this.config;if(!$.aborted&&j>=2&&($.loading.first===0&&($.loading.first=Math.max(self.performance.now(),$.loading.start),_e.timeout!==_e.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),_e.timeout=_e.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),_e.loadPolicy.maxLoadTimeMs-($.loading.first-$.loading.start)))),j===4)){self.clearTimeout(this.requestTimeout),_.onreadystatechange=null,_.onprogress=null;const nt=_.status,it=_.responseType==="text"?_.responseText:null;if(nt>=200&&nt<300){const lt=it??_.response;if(lt!=null){var et,tt;$.loading.end=Math.max(self.performance.now(),$.loading.first);const ct=_.responseType==="arraybuffer"?lt.byteLength:lt.length;$.loaded=$.total=ct,$.bwEstimate=$.total*8e3/($.loading.end-$.loading.first);const ft=(et=this.callbacks)==null?void 0:et.onProgress;ft&&ft($,i,lt,_);const ut={url:_.responseURL,data:lt,code:nt};(tt=this.callbacks)==null||tt.onSuccess(ut,$,i,_);return}}const st=_e.loadPolicy.errorRetry,at=$.retry,ot={url:i.url,data:void 0,code:nt};if(shouldRetry(st,at,!1,ot))this.retry(st);else{var rt;logger.error(`${nt} while loading ${i.url}`),(rt=this.callbacks)==null||rt.onError({code:nt,text:_.statusText},i,_,$)}}}loadtimeout(){if(!this.config)return;const i=this.config.loadPolicy.timeoutRetry,_=this.stats.retry;if(shouldRetry(i,_,!0))this.retry(i);else{var $;logger.warn(`timeout while loading ${($=this.context)==null?void 0:$.url}`);const j=this.callbacks;j&&(this.abortInternal(),j.onTimeout(this.stats,this.context,this.loader))}}retry(i){const{context:_,stats:$}=this;this.retryDelay=getRetryDelay(i,$.retry),$.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${_==null?void 0:_.url}, retrying ${$.retry}/${i.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(i){const _=this.stats;_.loaded=i.loaded,i.lengthComputable&&(_.total=i.total)}getCacheAge(){let i=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const _=this.loader.getResponseHeader("age");i=_?parseFloat(_):null}return i}getResponseHeader(i){return this.loader&&new RegExp(`^${i}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(i):null}}const defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController,interstitialsController:InterstitialsController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(o,i,_){if((i.liveSyncDurationCount||i.liveMaxLatencyDurationCount)&&(i.liveSyncDuration||i.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(i.liveMaxLatencyDurationCount!==void 0&&(i.liveSyncDurationCount===void 0||i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(i.liveMaxLatencyDuration!==void 0&&(i.liveSyncDuration===void 0||i.liveMaxLatencyDuration<=i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const $=deepCpy(o),j=["manifest","level","frag"],_e=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return j.forEach(et=>{const tt=`${et==="level"?"playlist":et}LoadPolicy`,rt=i[tt]===void 0,nt=[];_e.forEach(it=>{const st=`${et}Loading${it}`,at=i[st];if(at!==void 0&&rt){nt.push(st);const ot=$[tt].default;switch(i[tt]={default:ot},it){case"TimeOut":ot.maxLoadTimeMs=at,ot.maxTimeToFirstByteMs=at;break;case"MaxRetry":ot.errorRetry.maxNumRetry=at,ot.timeoutRetry.maxNumRetry=at;break;case"RetryDelay":ot.errorRetry.retryDelayMs=at,ot.timeoutRetry.retryDelayMs=at;break;case"MaxRetryTimeout":ot.errorRetry.maxRetryDelayMs=at,ot.timeoutRetry.maxRetryDelayMs=at;break}}}),nt.length&&_.warn(`hls.js config: "${nt.join('", "')}" setting(s) are deprecated, use "${tt}": ${stringify(i[tt])}`)}),_objectSpread2(_objectSpread2({},$),i)}function deepCpy(o){return o&&typeof o=="object"?Array.isArray(o)?o.map(deepCpy):Object.keys(o).reduce((i,_)=>(i[_]=deepCpy(o[_]),i),{}):o}function enableStreamingMode(o,i){const _=o.loader;_!==FetchLoader&&_!==XhrLoader?(i.log("[config]: Custom loader detected, cannot enable progressive streaming"),o.progressive=!1):fetchSupported()&&(o.loader=FetchLoader,o.progressive=!0,o.enableSoftwareAES=!0,i.log("[config]: Progressive streaming enabled, using FetchLoader"))}const MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05,TICK_INTERVAL$1=100;class GapController extends TaskLoop{constructor(i,_){super("gap-controller",i.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var $;($=this.media)!=null&&$.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var $;this.ended=(($=this.media)==null?void 0:$.currentTime)||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!1})}},this.hls=i,this.fragmentTracker=_,this.registerListeners()}registerListeners(){const{hls:i}=this;i&&(i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:i}=this;i&&(i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(i,_){this.setInterval(TICK_INTERVAL$1),this.mediaSource=_.mediaSource;const $=this.media=_.media;addEventListener$1($,"playing",this.onMediaPlaying),addEventListener$1($,"waiting",this.onMediaWaiting),addEventListener$1($,"ended",this.onMediaEnded)}onMediaDetaching(i,_){this.clearInterval();const{media:$}=this;$&&(removeEventListener($,"playing",this.onMediaPlaying),removeEventListener($,"waiting",this.onMediaWaiting),removeEventListener($,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(i,_){this.buffered=_.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var i;if(!((i=this.media)!=null&&i.readyState)||!this.hasBuffered)return;const _=this.media.currentTime;this.poll(_,this.lastCurrentTime),this.lastCurrentTime=_}poll(i,_){var $,j;const _e=($=this.hls)==null?void 0:$.config;if(!_e)return;const et=this.media;if(!et)return;const{seeking:tt}=et,rt=this.seeking&&!tt,nt=!this.seeking&&tt,it=et.paused&&!tt||et.ended||et.playbackRate===0;if(this.seeking=tt,i!==_){_&&(this.ended=0),this.moved=!0,tt||(this.nudgeRetry=0,_e.nudgeOnVideoHole&&!it&&i>_&&this.nudgeOnVideoHole(i,_)),this.waiting===0&&this.stallResolved(i);return}if(nt||rt){rt&&this.stallResolved(i);return}if(it){this.nudgeRetry=0,this.stallResolved(i),!this.ended&&et.ended&&this.hls&&(this.ended=i||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!1}));return}if(!BufferHelper.getBuffered(et).length){this.nudgeRetry=0;return}const st=BufferHelper.bufferInfo(et,i,0),at=st.nextStart||0,ot=this.fragmentTracker;if(tt&&ot&&this.hls){const yt=getInFlightDependency(this.hls.inFlightFragments,i),gt=st.len>MAX_START_GAP_JUMP,vt=!at||yt||at-i>MAX_START_GAP_JUMP&&!ot.getPartialFragment(i);if(gt||vt)return;this.moved=!1}const lt=(j=this.hls)==null?void 0:j.latestLevelDetails;if(!this.moved&&this.stalled!==null&&ot){if(!(st.len>0)&&!at)return;const gt=Math.max(at,st.start||0)-i,St=!!(lt!=null&&lt.live)?lt.targetduration*2:MAX_START_GAP_JUMP,At=appendedFragAtPosition(i,ot);if(gt>0&&(gt<=St||At)){et.paused||this._trySkipBufferHole(At);return}}const ct=_e.detectStallWithCurrentTimeMs,ft=self.performance.now(),ut=this.waiting;let ht=this.stalled;if(ht===null)if(ut>0&&ft-ut<ct)ht=this.stalled=ut;else{this.stalled=ft;return}const dt=ft-ht;if(!tt&&(dt>=ct||ut)&&this.hls){var mt;if(((mt=this.mediaSource)==null?void 0:mt.readyState)==="ended"&&!(lt!=null&&lt.live)&&Math.abs(i-((lt==null?void 0:lt.edge)||0))<1){if(this.ended)return;this.ended=i||1,this.hls.trigger(Events.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(st),!this.media||!this.hls)return}const pt=BufferHelper.bufferInfo(et,i,_e.maxBufferHole);this._tryFixBufferStall(pt,dt,i)}stallResolved(i){const _=this.stalled;if(_&&this.hls&&(this.stalled=null,this.stallReported)){const $=self.performance.now()-_;this.log(`playback not stuck anymore @${i}, after ${Math.round($)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(Events.STALL_RESOLVED,{})}}nudgeOnVideoHole(i,_){var $;const j=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&($=this.buffered.audio)!=null&&$.length&&j&&j.length>1&&i>j.end(0)){const _e=BufferHelper.bufferedInfo(BufferHelper.timeRangesToArray(this.buffered.audio),i,0);if(_e.len>1&&_>=_e.start){const et=BufferHelper.timeRangesToArray(j),tt=BufferHelper.bufferedInfo(et,_,0).bufferedIndex;if(tt>-1&&tt<et.length-1){const rt=BufferHelper.bufferedInfo(et,i,0).bufferedIndex,nt=et[tt].end,it=et[tt+1].start;if((rt===-1||rt>tt)&&it-nt<1&&i-nt<2){const st=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${i} hole: ${nt} -> ${it} buffered index: ${rt}`);this.warn(st.message),this.media.currentTime+=1e-6;let at=appendedFragAtPosition(i,this.fragmentTracker);at&&"fragment"in at?at=at.fragment:at||(at=void 0);const ot=BufferHelper.bufferInfo(this.media,i,0);this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:st,reason:st.message,frag:at,buffer:ot.len,bufferInfo:ot})}}}}}_tryFixBufferStall(i,_,$){var j,_e;const{fragmentTracker:et,media:tt}=this,rt=(j=this.hls)==null?void 0:j.config;if(!tt||!et||!rt)return;const nt=(_e=this.hls)==null?void 0:_e.latestLevelDetails,it=appendedFragAtPosition($,et);if((it||nt!=null&&nt.live&&$<nt.fragmentStart)&&(this._trySkipBufferHole(it)||!this.media))return;const st=i.buffered,at=this.adjacentTraversal(i,$);(st&&st.length>1&&i.len>rt.maxBufferHole||i.nextStart&&(i.nextStart-$<rt.maxBufferHole||at))&&(_>rt.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(i))}adjacentTraversal(i,_){const $=this.fragmentTracker,j=i.nextStart;if($&&j){const _e=$.getFragAtPos(_,PlaylistLevelType.MAIN),et=$.getFragAtPos(j,PlaylistLevelType.MAIN);if(_e&&et)return et.sn-_e.sn<2}return!1}_reportStall(i){const{hls:_,media:$,stallReported:j,stalled:_e}=this;if(!j&&_e!==null&&$&&_){this.stallReported=!0;const et=new Error(`Playback stalling at @${$.currentTime} due to low buffer (${stringify(i)})`);this.warn(et.message),_.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:et,buffer:i.len,bufferInfo:i,stalled:{start:_e}})}}_trySkipBufferHole(i){var _;const{fragmentTracker:$,media:j}=this,_e=(_=this.hls)==null?void 0:_.config;if(!j||!$||!_e)return 0;const et=j.currentTime,tt=BufferHelper.bufferInfo(j,et,0),rt=et<tt.start?tt.start:tt.nextStart;if(rt&&this.hls){const it=tt.len<=_e.maxBufferHole,st=tt.len>0&&tt.len<1&&j.readyState<3,at=rt-et;if(at>0&&(it||st)){if(at>_e.maxBufferHole){let lt=!1;if(et===0){const ct=$.getAppendedFrag(0,PlaylistLevelType.MAIN);ct&&rt<ct.end&&(lt=!0)}if(!lt&&i){var nt;if(!((nt=this.hls.loadLevelObj)!=null&&nt.details)||getInFlightDependency(this.hls.inFlightFragments,rt))return 0;let ft=!1,ut=i.end;for(;ut<rt;){const ht=appendedFragAtPosition(ut,$);if(ht)ut+=ht.duration;else{ft=!0;break}}if(ft)return 0}}const ot=Math.max(rt+SKIP_BUFFER_RANGE_START,et+SKIP_BUFFER_HOLE_STEP_SECONDS);if(this.warn(`skipping hole, adjusting currentTime from ${et} to ${ot}`),this.moved=!0,j.currentTime=ot,!(i!=null&&i.gap)){const lt=new Error(`fragment loaded with buffer holes, seeking from ${et} to ${ot}`),ct={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:lt,reason:lt.message,buffer:tt.len,bufferInfo:tt};i&&("fragment"in i?ct.part=i:ct.frag=i),this.hls.trigger(Events.ERROR,ct)}return ot}}return 0}_tryNudgeBuffer(i){const{hls:_,media:$,nudgeRetry:j}=this,_e=_==null?void 0:_.config;if(!$||!_e)return 0;const et=$.currentTime;if(this.nudgeRetry++,j<_e.nudgeMaxRetry){const tt=et+(j+1)*_e.nudgeOffset,rt=new Error(`Nudging 'currentTime' from ${et} to ${tt}`);this.warn(rt.message),$.currentTime=tt,_.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:rt,fatal:!1,buffer:i.len,bufferInfo:i})}else{const tt=new Error(`Playhead still not moving while enough data buffered @${et} after ${_e.nudgeMaxRetry} nudges`);this.error(tt.message),_.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:tt,fatal:!0,buffer:i.len,bufferInfo:i})}}}function getInFlightDependency(o,i){const _=inFlight(o.main);if(_&&_.start<=i)return _;const $=inFlight(o.audio);return $&&$.start<=i?$:null}function inFlight(o){if(!o)return null;switch(o.state){case State.IDLE:case State.STOPPED:case State.ENDED:case State.ERROR:return null}return o.frag}function appendedFragAtPosition(o,i){return i.getAppendedFrag(o,PlaylistLevelType.MAIN)||i.getPartialFragment(o)}const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function createCueWithDataFields(o,i,_,$,j){let _e=new o(i,_,"");try{_e.value=$,j&&(_e.type=j)}catch{_e=new o(i,_,stringify(j?_objectSpread2({type:j},$):$))}return _e}const MAX_CUE_ENDTIME=(()=>{const o=getCueClass();try{o&&new o(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class ID3TrackController{constructor(i){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(Events.EVENT_CUE_ENTER,{})},this.hls=i,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:i}=this;i&&(i.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),i.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.on(Events.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:i}=this;i&&(i.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),i.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.off(Events.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(i,_){var $;this.media=_.media,(($=_.overrides)==null?void 0:$.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var i;const _=(i=this.hls)==null?void 0:i.latestLevelDetails;_&&this.updateDateRangeCues(_)}onMediaDetaching(i,_){this.media=null,!_.transferMedia&&(this.id3Track&&(this.removeCues&&clearCurrentCues(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(i){const _=this.getID3Track(i.textTracks);return _.mode="hidden",_}getID3Track(i){if(this.media){for(let _=0;_<i.length;_++){const $=i[_];if($.kind==="metadata"&&$.label==="id3")return sendAddTrackEvent($,this.media),$}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(i,_){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:$,enableID3MetadataCues:j}=this.hls.config;if(!$&&!j)return;const{samples:_e}=_;this.id3Track||(this.id3Track=this.createTrack(this.media));const et=getCueClass();if(et)for(let tt=0;tt<_e.length;tt++){const rt=_e[tt].type;if(rt===MetadataSchema.emsg&&!$||!j)continue;const nt=getId3Frames(_e[tt].data),it=_e[tt].pts;let st=it+_e[tt].duration;st>MAX_CUE_ENDTIME&&(st=MAX_CUE_ENDTIME),st-it<=0&&(st=it+MIN_CUE_DURATION);for(let ot=0;ot<nt.length;ot++){const lt=nt[ot];if(!isId3TimestampFrame(lt)){this.updateId3CueEnds(it,rt);const ct=createCueWithDataFields(et,it,st,lt,rt);ct&&this.id3Track.addCue(ct)}}}}updateId3CueEnds(i,_){var $;const j=($=this.id3Track)==null?void 0:$.cues;if(j)for(let _e=j.length;_e--;){const et=j[_e];et.type===_&&et.startTime<i&&et.endTime===MAX_CUE_ENDTIME&&(et.endTime=i)}}onBufferFlushing(i,{startOffset:_,endOffset:$,type:j}){const{id3Track:_e,hls:et}=this;if(!et)return;const{config:{enableEmsgMetadataCues:tt,enableID3MetadataCues:rt}}=et;if(_e&&(tt||rt)){let nt;j==="audio"?nt=it=>it.type===MetadataSchema.audioId3&&rt:j==="video"?nt=it=>it.type===MetadataSchema.emsg&&tt:nt=it=>it.type===MetadataSchema.audioId3&&rt||it.type===MetadataSchema.emsg&&tt,removeCuesInRange(_e,_,$,nt)}}onLevelUpdated(i,{details:_}){this.updateDateRangeCues(_,!0)}onLevelPtsUpdated(i,_){Math.abs(_.drift)>.01&&this.updateDateRangeCues(_.details)}updateDateRangeCues(i,_){if(!this.hls||!this.media)return;const{assetPlayerId:$,timelineOffset:j,enableDateRangeMetadataCues:_e,interstitialsController:et}=this.hls.config;if(!_e)return;const tt=getCueClass();if($&&j&&!et){const{fragmentStart:ct,fragmentEnd:ft}=i;let ut=this.assetCue;ut?(ut.startTime=ct,ut.endTime=ft):tt&&(ut=this.assetCue=createCueWithDataFields(tt,ct,ft,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),ut&&(ut.id=$,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(ut),ut.addEventListener("enter",this.onEventCueEnter)))}if(!i.hasProgramDateTime)return;const{id3Track:rt}=this,{dateRanges:nt}=i,it=Object.keys(nt);let st=this.dateRangeCuesAppended;if(rt&&_){var at;if((at=rt.cues)!=null&&at.length){const ct=Object.keys(st).filter(ft=>!it.includes(ft));for(let ft=ct.length;ft--;){var ot;const ut=ct[ft],ht=(ot=st[ut])==null?void 0:ot.cues;delete st[ut],ht&&Object.keys(ht).forEach(dt=>{const mt=ht[dt];if(mt){mt.removeEventListener("enter",this.onEventCueEnter);try{rt.removeCue(mt)}catch{}}})}}else st=this.dateRangeCuesAppended={}}const lt=i.fragments[i.fragments.length-1];if(!(it.length===0||!isFiniteNumber(lt==null?void 0:lt.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let ct=0;ct<it.length;ct++){const ft=it[ct],ut=nt[ft],ht=ut.startTime,dt=st[ft],mt=(dt==null?void 0:dt.cues)||{};let pt=(dt==null?void 0:dt.durationKnown)||!1,yt=MAX_CUE_ENDTIME;const{duration:gt,endDate:vt}=ut;if(vt&&gt!==null)yt=ht+gt,pt=!0;else if(ut.endOnNext&&!pt){const At=it.reduce((xt,wt)=>{if(wt!==ut.id){const Ot=nt[wt];if(Ot.class===ut.class&&Ot.startDate>ut.startDate&&(!xt||ut.startDate<xt.startDate))return Ot}return xt},null);At&&(yt=At.startTime,pt=!0)}const St=Object.keys(ut.attr);for(let At=0;At<St.length;At++){const xt=St[At];if(!isDateRangeCueAttribute(xt))continue;const wt=mt[xt];if(wt)pt&&!(dt!=null&&dt.durationKnown)?wt.endTime=yt:Math.abs(wt.startTime-ht)>.01&&(wt.startTime=ht,wt.endTime=yt);else if(tt){let Ot=ut.attr[xt];isSCTE35Attribute(xt)&&(Ot=hexToArrayBuffer(Ot));const Ft=createCueWithDataFields(tt,ht,yt,{key:xt,data:Ot},MetadataSchema.dateRange);Ft&&(Ft.id=ft,this.id3Track.addCue(Ft),mt[xt]=Ft,et&&(xt==="X-ASSET-LIST"||xt==="X-ASSET-URL")&&Ft.addEventListener("enter",this.onEventCueEnter))}}st[ft]={cues:mt,dateRange:ut,durationKnown:pt}}}}}class LatencyController{constructor(i){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:_}=this,$=this.levelDetails;if(!_||!$)return;this.currentTime=_.currentTime;const j=this.computeLatency();if(j===null)return;this._latency=j;const{lowLatencyMode:_e,maxLiveSyncPlaybackRate:et}=this.config;if(!_e||et===1||!$.live)return;const tt=this.targetLatency;if(tt===null)return;const rt=j-tt,nt=Math.min(this.maxLatency,tt+$.targetduration);if(rt<nt&&rt>.05&&this.forwardBufferLength>1){const st=Math.min(2,Math.max(1,et)),at=Math.round(2/(1+Math.exp(-.75*rt-this.edgeStalled))*20)/20,ot=Math.min(st,Math.max(1,at));this.changeMediaPlaybackRate(_,ot)}else _.playbackRate!==1&&_.playbackRate!==0&&this.changeMediaPlaybackRate(_,1)},this.hls=i,this.config=i.config,this.registerListeners()}get levelDetails(){var i;return((i=this.hls)==null?void 0:i.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:i}=this;if(i.liveMaxLatencyDuration!==void 0)return i.liveMaxLatencyDuration;const _=this.levelDetails;return _?i.liveMaxLatencyDurationCount*_.targetduration:0}get targetLatency(){const i=this.levelDetails;if(i===null||this.hls===null)return null;const{holdBack:_,partHoldBack:$,targetduration:j}=i,{liveSyncDuration:_e,liveSyncDurationCount:et,lowLatencyMode:tt}=this.config,rt=this.hls.userConfig;let nt=tt&&$||_;(this._targetLatencyUpdated||rt.liveSyncDuration||rt.liveSyncDurationCount||nt===0)&&(nt=_e!==void 0?_e:et*j);const it=j;return nt+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,it)}set targetLatency(i){this.stallCount=0,this.config.liveSyncDuration=i,this._targetLatencyUpdated=!0}get liveSyncPosition(){const i=this.estimateLiveEdge(),_=this.targetLatency;if(i===null||_===null)return null;const $=this.levelDetails;if($===null)return null;const j=$.edge,_e=i-_-this.edgeStalled,et=j-$.totalduration,tt=j-(this.config.lowLatencyMode&&$.partTarget||$.targetduration);return Math.min(Math.max(et,_e),tt)}get drift(){const i=this.levelDetails;return i===null?1:i.drift}get edgeStalled(){const i=this.levelDetails;if(i===null)return 0;const _=(this.config.lowLatencyMode&&i.partTarget||i.targetduration)*3;return Math.max(i.age-_,0)}get forwardBufferLength(){const{media:i}=this,_=this.levelDetails;if(!i||!_)return 0;const $=i.buffered.length;return($?i.buffered.end($-1):_.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:i}=this;i&&(i.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.on(Events.ERROR,this.onError,this))}unregisterListeners(){const{hls:i}=this;i&&(i.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),i.off(Events.ERROR,this.onError,this))}onMediaAttached(i,_){this.media=_.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(i,{details:_}){_.advanced&&this.onTimeupdate(),!_.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(i,_){var $;_.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&($=this.levelDetails)!=null&&$.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(i,_){var $,j;i.playbackRate!==_&&(($=this.hls)==null||$.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(j=this.targetLatency)==null?void 0:j.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${i.playbackRate} to ${_}`),i.playbackRate=_)}estimateLiveEdge(){const i=this.levelDetails;return i===null?null:i.edge+i.age}computeLatency(){const i=this.estimateLiveEdge();return i===null?null:i-this.currentTime}}class LevelController extends BasePlaylistController{constructor(i,_){super(i,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=_,this._registerListeners()}_registerListeners(){const{hls:i}=this;i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:i}=this;i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),i.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(_=>{_.loadError=0,_.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(i,_){this.resetLevels()}onManifestLoaded(i,_){const $=this.hls.config.preferManagedMediaSource,j=[],_e={},et={};let tt=!1,rt=!1,nt=!1;_.levels.forEach(it=>{const st=it.attrs;let{audioCodec:at,videoCodec:ot}=it;at&&(it.audioCodec=at=getCodecCompatibleName(at,$)||void 0),ot&&(ot=it.videoCodec=convertAVC1ToAVCOTI(ot));const{width:lt,height:ct,unknownCodecs:ft}=it,ut=(ft==null?void 0:ft.length)||0;if(tt||(tt=!!(lt&&ct)),rt||(rt=!!ot),nt||(nt=!!at),ut||at&&!this.isAudioSupported(at)||ot&&!this.isVideoSupported(ot)){this.log(`Some or all CODECS not supported "${st.CODECS}"`);return}const{CODECS:ht,"FRAME-RATE":dt,"HDCP-LEVEL":mt,"PATHWAY-ID":pt,RESOLUTION:yt,"VIDEO-RANGE":gt}=st,St=`${`${pt||"."}-`}${it.bitrate}-${yt}-${dt}-${ht}-${gt}-${mt}`;if(_e[St])if(_e[St].uri!==it.url&&!it.attrs["PATHWAY-ID"]){const At=et[St]+=1;it.attrs["PATHWAY-ID"]=new Array(At+1).join(".");const xt=this.createLevel(it);_e[St]=xt,j.push(xt)}else _e[St].addGroupId("audio",st.AUDIO),_e[St].addGroupId("text",st.SUBTITLES);else{const At=this.createLevel(it);_e[St]=At,et[St]=1,j.push(At)}}),this.filterAndSortMediaOptions(j,_,tt,rt,nt)}createLevel(i){const _=new Level(i),$=i.supplemental;if($!=null&&$.videoCodec&&!this.isVideoSupported($.videoCodec)){const j=new Error(`SUPPLEMENTAL-CODECS not supported "${$.videoCodec}"`);this.log(j.message),_.supportedResult=getUnsupportedResult(j,[])}return _}isAudioSupported(i){return areCodecsMediaSourceSupported(i,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(i){return areCodecsMediaSourceSupported(i,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(i,_,$,j,_e){var et;let tt=[],rt=[],nt=i;const it=((et=_.stats)==null?void 0:et.parsing)||{};if(($||j)&&_e&&(nt=nt.filter(({videoCodec:ht,videoRange:dt,width:mt,height:pt})=>(!!ht||!!(mt&&pt))&&isVideoRange(dt))),nt.length===0){Promise.resolve().then(()=>{if(this.hls){let ht="no level with compatible codecs found in manifest",dt=ht;_.levels.length&&(dt=`one or more CODECS in variant not supported: ${stringify(_.levels.map(pt=>pt.attrs.CODECS).filter((pt,yt,gt)=>gt.indexOf(pt)===yt))}`,this.warn(dt),ht+=` (${dt})`);const mt=new Error(ht);this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:_.url,error:mt,reason:dt})}}),it.end=performance.now();return}_.audioTracks&&(tt=_.audioTracks.filter(ht=>!ht.audioCodec||this.isAudioSupported(ht.audioCodec)),assignTrackIdsByGroup(tt)),_.subtitles&&(rt=_.subtitles,assignTrackIdsByGroup(rt));const st=nt.slice(0);nt.sort((ht,dt)=>{if(ht.attrs["HDCP-LEVEL"]!==dt.attrs["HDCP-LEVEL"])return(ht.attrs["HDCP-LEVEL"]||"")>(dt.attrs["HDCP-LEVEL"]||"")?1:-1;if($&&ht.height!==dt.height)return ht.height-dt.height;if(ht.frameRate!==dt.frameRate)return ht.frameRate-dt.frameRate;if(ht.videoRange!==dt.videoRange)return VideoRangeValues.indexOf(ht.videoRange)-VideoRangeValues.indexOf(dt.videoRange);if(ht.videoCodec!==dt.videoCodec){const mt=videoCodecPreferenceValue(ht.videoCodec),pt=videoCodecPreferenceValue(dt.videoCodec);if(mt!==pt)return pt-mt}if(ht.uri===dt.uri&&ht.codecSet!==dt.codecSet){const mt=codecsSetSelectionPreferenceValue(ht.codecSet),pt=codecsSetSelectionPreferenceValue(dt.codecSet);if(mt!==pt)return pt-mt}return ht.averageBitrate!==dt.averageBitrate?ht.averageBitrate-dt.averageBitrate:0});let at=st[0];if(this.steering&&(nt=this.steering.filterParsedLevels(nt),nt.length!==st.length)){for(let ht=0;ht<st.length;ht++)if(st[ht].pathwayId===nt[0].pathwayId){at=st[ht];break}}this._levels=nt;for(let ht=0;ht<nt.length;ht++)if(nt[ht]===at){var ot;this._firstLevel=ht;const dt=at.bitrate,mt=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${nt.length} level(s) found, first bitrate: ${dt}`),((ot=this.hls.userConfig)==null?void 0:ot.abrEwmaDefaultEstimate)===void 0){const pt=Math.min(dt,this.hls.config.abrEwmaDefaultEstimateMax);pt>mt&&mt===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=pt)}break}const lt=_e&&!j,ct=this.hls.config,ft=!!(ct.audioStreamController&&ct.audioTrackController),ut={levels:nt,audioTracks:tt,subtitleTracks:rt,sessionData:_.sessionData,sessionKeys:_.sessionKeys,firstLevel:this._firstLevel,stats:_.stats,audio:_e,video:j,altAudio:ft&&!lt&&tt.some(ht=>!!ht.url)};it.end=performance.now(),this.hls.trigger(Events.MANIFEST_PARSED,ut)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(i){const _=this._levels;if(_.length===0)return;if(i<0||i>=_.length){const it=new Error("invalid level idx"),st=i<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:i,fatal:st,error:it,reason:it.message}),st)return;i=Math.min(i,_.length-1)}const $=this.currentLevelIndex,j=this.currentLevel,_e=j?j.attrs["PATHWAY-ID"]:void 0,et=_[i],tt=et.attrs["PATHWAY-ID"];if(this.currentLevelIndex=i,this.currentLevel=et,$===i&&j&&_e===tt)return;this.log(`Switching to level ${i} (${et.height?et.height+"p ":""}${et.videoRange?et.videoRange+" ":""}${et.codecSet?et.codecSet+" ":""}@${et.bitrate})${tt?" with Pathway "+tt:""} from level ${$}${_e?" with Pathway "+_e:""}`);const rt={level:i,attrs:et.attrs,details:et.details,bitrate:et.bitrate,averageBitrate:et.averageBitrate,maxBitrate:et.maxBitrate,realBitrate:et.realBitrate,width:et.width,height:et.height,codecSet:et.codecSet,audioCodec:et.audioCodec,videoCodec:et.videoCodec,audioGroups:et.audioGroups,subtitleGroups:et.subtitleGroups,loaded:et.loaded,loadError:et.loadError,fragmentError:et.fragmentError,name:et.name,id:et.id,uri:et.uri,url:et.url,urlId:0,audioGroupIds:et.audioGroupIds,textGroupIds:et.textGroupIds};this.hls.trigger(Events.LEVEL_SWITCHING,rt);const nt=et.details;if(!nt||nt.live){const it=this.switchParams(et.uri,j==null?void 0:j.details,nt);this.loadPlaylist(it)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(i){this.manualLevelIndex=i,this._startLevel===void 0&&(this._startLevel=i),i!==-1&&(this.level=i)}get firstLevel(){return this._firstLevel}set firstLevel(i){this._firstLevel=i}get startLevel(){if(this._startLevel===void 0){const i=this.hls.config.startLevel;return i!==void 0?i:this.hls.firstAutoLevel}return this._startLevel}set startLevel(i){this._startLevel=i}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(i){if(this.steering){const _=this.steering.pathways(),$=i.filter(j=>_.indexOf(j)!==-1);if(i.length<1){this.warn(`pathwayPriority ${i} should contain at least one pathway from list: ${_}`);return}this.steering.pathwayPriority=$}}onError(i,_){_.fatal||!_.context||_.context.type===PlaylistContextType.LEVEL&&_.context.level===this.level&&this.checkRetry(_)}onFragBuffered(i,{frag:_}){if(_!==void 0&&_.type===PlaylistLevelType.MAIN){const $=_.elementaryStreams;if(!Object.keys($).some(_e=>!!$[_e]))return;const j=this._levels[_.level];j!=null&&j.loadError&&(this.log(`Resetting level error count of ${j.loadError} on frag buffered`),j.loadError=0)}}onLevelLoaded(i,_){var $;const{level:j,details:_e}=_,et=_.levelInfo;if(!et){var tt;this.warn(`Invalid level index ${j}`),(tt=_.deliveryDirectives)!=null&&tt.skip&&(_e.deltaUpdateFailed=!0);return}if(et===this.currentLevel||_.withoutMultiVariant){et.fragmentError===0&&(et.loadError=0);let rt=et.details;rt===_.details&&rt.advanced&&(rt=void 0),this.playlistLoaded(j,_,rt)}else($=_.deliveryDirectives)!=null&&$.skip&&(_e.deltaUpdateFailed=!0)}loadPlaylist(i){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,i)}loadingPlaylist(i,_){super.loadingPlaylist(i,_);const $=this.getUrlWithDirectives(i.uri,_),j=this.currentLevelIndex,_e=i.attrs["PATHWAY-ID"],et=i.details,tt=et==null?void 0:et.age;this.log(`Loading level index ${j}${(_==null?void 0:_.msn)!==void 0?" at sn "+_.msn+" part "+_.part:""}${_e?" Pathway "+_e:""}${tt&&et.live?" age "+tt.toFixed(1)+(et.type&&" "+et.type||""):""} ${$}`),this.hls.trigger(Events.LEVEL_LOADING,{url:$,level:j,levelInfo:i,pathwayId:i.attrs["PATHWAY-ID"],id:0,deliveryDirectives:_||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(i){this.level=i,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=i)}removeLevel(i){var _;if(this._levels.length===1)return;const $=this._levels.filter((_e,et)=>et!==i?!0:(this.steering&&this.steering.removeLevel(_e),_e===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,_e.details&&_e.details.fragments.forEach(tt=>tt.level=-1)),!1));reassignFragmentLevelIndexes($),this._levels=$,this.currentLevelIndex>-1&&(_=this.currentLevel)!=null&&_.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const j=$.length-1;this._firstLevel=Math.min(this._firstLevel,j),this._startLevel&&(this._startLevel=Math.min(this._startLevel,j)),this.hls.trigger(Events.LEVELS_UPDATED,{levels:$})}onLevelsUpdated(i,{levels:_}){this._levels=_}checkMaxAutoUpdated(){const{autoLevelCapping:i,maxAutoLevel:_,maxHdcpLevel:$}=this.hls;this._maxAutoLevel!==_&&(this._maxAutoLevel=_,this.hls.trigger(Events.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:i,levels:this.levels,maxAutoLevel:_,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:$}))}}function assignTrackIdsByGroup(o){const i={};o.forEach(_=>{const $=_.groupId||"";_.id=i[$]=i[$]||0,i[$]++})}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isMSESupported(){if(!getMediaSource())return!1;const i=getSourceBuffer();return!i||i.prototype&&typeof i.prototype.appendBuffer=="function"&&typeof i.prototype.remove=="function"}function isSupported(){if(!isMSESupported())return!1;const o=getMediaSource();return typeof(o==null?void 0:o.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(i=>o.isTypeSupported(mimeTypeForCodec(i,"video")))||["mp4a.40.2","fLaC"].some(i=>o.isTypeSupported(mimeTypeForCodec(i,"audio"))))}function changeTypeSupported(){var o;const i=getSourceBuffer();return typeof(i==null||(o=i.prototype)==null?void 0:o.changeType)=="function"}const TICK_INTERVAL=100;class StreamController extends BaseStreamController{constructor(i,_,$){super(i,_,$,"stream-controller",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const j=this.media,_e=j?j.currentTime:null;if(_e===null||!isFiniteNumber(_e)||(this.log(`Media seeked to ${_e.toFixed(3)}`),!this.getBufferedFrag(_e)))return;const et=this.getFwdBufferInfoAtPos(j,_e,PlaylistLevelType.MAIN,0);if(et===null||et.len===0){this.warn(`Main forward buffer length at ${_e} on "seeked" event ${et?et.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:i}=this;i.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),i.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.on(Events.BUFFER_CREATED,this.onBufferCreated,this),i.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:i}=this;i.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),i.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.off(Events.BUFFER_CREATED,this.onBufferCreated,this),i.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(i,_){if(this.levels){const{lastCurrentTime:$,hls:j}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL),this.level=-1,!this.startFragRequested){let _e=j.startLevel;_e===-1&&(j.config.testBandwidth&&this.levels.length>1?(_e=0,this.bitrateTest=!0):_e=j.firstAutoLevel),j.nextLoadLevel=_e,this.level=j.loadLevel,this._hasEnoughToStart=!!_}$>0&&i===-1&&!_&&(this.log(`Override startPosition with lastCurrentTime @${$.toFixed(3)}`),i=$),this.state=State.IDLE,this.nextLoadPosition=this.lastCurrentTime=i+this.timelineOffset,this.startPosition=_?-1:i,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{const{levels:i,level:_}=this,$=i==null?void 0:i[_],j=$==null?void 0:$.details;if(j&&(!j.live||this.levelLastLoaded===$&&!this.waitForLive($))){if(this.waitForCdnTuneIn(j))break;this.state=State.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var i;super.onTickEnd(),(i=this.media)!=null&&i.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:i,levelLastLoaded:_,levels:$,media:j}=this;if(_===null||!j&&!this.primaryPrefetch&&(this.startFragRequested||!i.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const _e=this.buffering?i.nextLoadLevel:i.loadLevel;if(!($!=null&&$[_e]))return;const et=$[_e],tt=this.getMainFwdBufferInfo();if(tt===null)return;const rt=this.getLevelDetails();if(rt&&this._streamEnded(tt,rt)){const ct={};this.altAudio===2&&(ct.type="video"),this.hls.trigger(Events.BUFFER_EOS,ct),this.state=State.ENDED;return}if(!this.buffering)return;i.loadLevel!==_e&&i.manualLevel===-1&&this.log(`Adapting to level ${_e} from level ${this.level}`),this.level=i.nextLoadLevel=_e;const nt=et.details;if(!nt||this.state===State.WAITING_LEVEL||this.waitForLive(et)){this.level=_e,this.state=State.WAITING_LEVEL,this.startFragRequested=!1;return}const it=tt.len,st=this.getMaxBufferLength(et.maxBitrate);if(it>=st)return;this.backtrackFragment&&this.backtrackFragment.start>tt.end&&(this.backtrackFragment=null);const at=this.backtrackFragment?this.backtrackFragment.start:tt.end;let ot=this.getNextFragment(at,nt);if(this.couldBacktrack&&!this.fragPrevious&&ot&&isMediaFragment(ot)&&this.fragmentTracker.getState(ot)!==FragmentState.OK){var lt;const ft=((lt=this.backtrackFragment)!=null?lt:ot).sn-nt.startSN,ut=nt.fragments[ft-1];ut&&ot.cc===ut.cc&&(ot=ut,this.fragmentTracker.removeFragment(ut))}else this.backtrackFragment&&tt.len&&(this.backtrackFragment=null);if(ot&&this.isLoopLoading(ot,at)){if(!ot.gap){const ft=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,ut=(ft===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;ut&&this.afterBufferFlushed(ut,ft,PlaylistLevelType.MAIN)}ot=this.getNextFragmentLoopLoading(ot,nt,tt,PlaylistLevelType.MAIN,st)}ot&&(ot.initSegment&&!ot.initSegment.data&&!this.bitrateTest&&(ot=ot.initSegment),this.loadFragment(ot,et,at))}loadFragment(i,_,$){const j=this.fragmentTracker.getState(i);j===FragmentState.NOT_LOADED||j===FragmentState.PARTIAL?isMediaFragment(i)?this.bitrateTest?(this.log(`Fragment ${i.sn} of level ${i.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(i,_)):super.loadFragment(i,_,$):this._loadInitSegment(i,_):this.clearTrackerIfNeeded(i)}getBufferedFrag(i){return this.fragmentTracker.getBufferedFrag(i,PlaylistLevelType.MAIN)}followingBufferedFrag(i){return i?this.getBufferedFrag(i.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:i,media:_}=this;if(_!=null&&_.readyState){let $;const j=this.getAppendedFrag(_.currentTime);j&&j.start>1&&this.flushMainBuffer(0,j.start-1);const _e=this.getLevelDetails();if(_e!=null&&_e.live){const tt=this.getMainFwdBufferInfo();if(!tt||tt.len<_e.targetduration*2)return}if(!_.paused&&i){const tt=this.hls.nextLoadLevel,rt=i[tt],nt=this.fragLastKbps;nt&&this.fragCurrent?$=this.fragCurrent.duration*rt.maxBitrate/(1e3*nt)+1:$=0}else $=0;const et=this.getBufferedFrag(_.currentTime+$);if(et){const tt=this.followingBufferedFrag(et);if(tt){this.abortCurrentFrag();const rt=tt.maxStartPTS?tt.maxStartPTS:tt.start,nt=tt.duration,it=Math.max(et.end,rt+Math.min(Math.max(nt-this.config.maxFragLookUpTolerance,nt*(this.couldBacktrack?.5:.125)),nt*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(it,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const i=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,i&&(i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(i,_){super.flushMainBuffer(i,_,this.altAudio===2?"video":null)}onMediaAttached(i,_){super.onMediaAttached(i,_);const $=_.media;addEventListener$1($,"playing",this.onMediaPlaying),addEventListener$1($,"seeked",this.onMediaSeeked)}onMediaDetaching(i,_){const{media:$}=this;$&&(removeEventListener($,"playing",this.onMediaPlaying),removeEventListener($,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(i,_),!_.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(i,_){let $=!1,j=!1;for(let _e=0;_e<_.levels.length;_e++){const et=_.levels[_e].audioCodec;et&&($=$||et.indexOf("mp4a.40.2")!==-1,j=j||et.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=$&&j&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=_.levels,this.startFragRequested=!1}onLevelLoading(i,_){const{levels:$}=this;if(!$||this.state!==State.IDLE)return;const j=_.levelInfo;(!j.details||j.details.live&&(this.levelLastLoaded!==j||j.details.expired)||this.waitForCdnTuneIn(j.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(i,_){var $;const{levels:j,startFragRequested:_e}=this,et=_.level,tt=_.details,rt=tt.totalduration;if(!j){this.warn(`Levels were reset while loading level ${et}`);return}this.log(`Level ${et} loaded [${tt.startSN},${tt.endSN}]${tt.lastPartSn?`[part-${tt.lastPartSn}-${tt.lastPartIndex}]`:""}, cc [${tt.startCC}, ${tt.endCC}] duration:${rt}`);const nt=_.levelInfo,it=this.fragCurrent;it&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&it.level!==_.level&&it.loader&&this.abortCurrentFrag();let st=0;if(tt.live||($=nt.details)!=null&&$.live){var at;if(this.checkLiveUpdate(tt),tt.deltaUpdateFailed)return;st=this.alignPlaylists(tt,nt.details,(at=this.levelLastLoaded)==null?void 0:at.details)}if(nt.details=tt,this.levelLastLoaded=nt,_e||this.setStartPosition(tt,st),this.hls.trigger(Events.LEVEL_UPDATED,{details:tt,level:et}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(tt))return;this.state=State.IDLE}_e&&tt.live&&this.synchronizeToLiveEdge(tt),this.tick()}synchronizeToLiveEdge(i){const{config:_,media:$}=this;if(!$)return;const j=this.hls.liveSyncPosition,_e=this.getLoadPosition(),et=i.fragmentStart,tt=i.edge,rt=_e>=et-_.maxFragLookUpTolerance&&_e<=tt;if(j!==null&&$.duration>j&&(_e<j||!rt)){const it=_.liveMaxLatencyDuration!==void 0?_.liveMaxLatencyDuration:_.liveMaxLatencyDurationCount*i.targetduration;if((!rt&&$.readyState<4||_e<tt-it)&&(this._hasEnoughToStart||(this.nextLoadPosition=j),$.readyState))if(this.warn(`Playback: ${_e.toFixed(3)} is located too far from the end of live sliding playlist: ${tt}, reset currentTime to : ${j.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var nt;const st=BufferHelper.bufferInfo($,j,0);if(!((nt=st.buffered)!=null&&nt.length)){$.currentTime=j;return}if(st.start<=_e){$.currentTime=j;return}const{nextStart:ot}=BufferHelper.bufferedInfo(st.buffered,_e,0);ot&&($.currentTime=ot)}else $.currentTime=j}}_handleFragmentLoadProgress(i){var _;const $=i.frag,{part:j,payload:_e}=i,{levels:et}=this;if(!et){this.warn(`Levels were reset while fragment load was in progress. Fragment ${$.sn} of level ${$.level} will not be buffered`);return}const tt=et[$.level];if(!tt){this.warn(`Level ${$.level} not found on progress`);return}const rt=tt.details;if(!rt){this.warn(`Dropping fragment ${$.sn} of level ${$.level} after level details were reset`),this.fragmentTracker.removeFragment($);return}const nt=tt.videoCodec,it=rt.PTSKnown||!rt.live,st=(_=$.initSegment)==null?void 0:_.data,at=this._getAudioCodec(tt),ot=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),lt=j?j.index:-1,ct=lt!==-1,ft=new ChunkMetadata($.level,$.sn,$.stats.chunkCount,_e.byteLength,lt,ct),ut=this.initPTS[$.cc];ot.push(_e,st,at,nt,$,j,rt.totalduration,it,ft,ut)}onAudioTrackSwitching(i,_){const $=this.hls,j=this.altAudio===2;if(useAlternateAudio(_.url,$))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const et=this.fragCurrent;et&&(this.log("Switching to main audio track, cancel main fragment load"),et.abortRequests(),this.fragmentTracker.removeFragment(et)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(j){this.fragmentTracker.removeAllFragments(),$.once(Events.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_)}),$.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}$.trigger(Events.AUDIO_TRACK_SWITCHED,_)}}onAudioTrackSwitched(i,_){const $=useAlternateAudio(_.url,this.hls);if($){const j=this.videoBuffer;j&&this.mediaBuffer!==j&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=j)}this.altAudio=$?2:0,this.tick()}onBufferCreated(i,_){const $=_.tracks;let j,_e,et=!1;for(const tt in $){const rt=$[tt];if(rt.id==="main"){if(_e=tt,j=rt,tt==="video"){const nt=$[tt];nt&&(this.videoBuffer=nt.buffer)}}else et=!0}et&&j?(this.log(`Alternate track found, use ${_e}.buffered to schedule main fragment loading`),this.mediaBuffer=j.buffer):this.mediaBuffer=this.media}onFragBuffered(i,_){const{frag:$,part:j}=_,_e=$.type===PlaylistLevelType.MAIN;if(_e){if(this.fragContextChanged($)){this.warn(`Fragment ${$.sn}${j?" p: "+j.index:""} of level ${$.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const tt=j?j.stats:$.stats;this.fragLastKbps=Math.round(8*tt.total/(tt.buffering.end-tt.loading.first)),isMediaFragment($)&&(this.fragPrevious=$),this.fragBufferedComplete($,j)}const et=this.media;et&&(!this._hasEnoughToStart&&BufferHelper.getBuffered(et).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),_e&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(i,_){var $;if(_.fatal){this.state=State.ERROR;return}switch(_.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,_);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!_.levelRetry&&this.state===State.WAITING_LEVEL&&(($=_.context)==null?void 0:$.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:if(_.parent!=="main")return;this.reduceLengthAndFlushBuffer(_)&&this.resetLoadingState();break;case ErrorDetails.BUFFER_FULL_ERROR:if(_.parent!=="main")return;this.reduceLengthAndFlushBuffer(_)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(_);break}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(i,{type:_}){if(_!==ElementaryStreamTypes.AUDIO||!this.altAudio){const $=(_===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;$&&(this.afterBufferFlushed($,_,PlaylistLevelType.MAIN),this.tick())}}onLevelsUpdated(i,_){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=_.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:i}=this;if(!i)return;const _=i.currentTime;let $=this.startPosition;if($>=0&&_<$){if(i.seeking){this.log(`could not seek to ${$}, already seeking at ${_}`);return}const j=this.timelineOffset;j&&$&&($+=j);const _e=this.getLevelDetails(),et=BufferHelper.getBuffered(i),tt=et.length?et.start(0):0,rt=tt-$,nt=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||rt>0&&(rt<nt||this.loadingParts&&rt<2*((_e==null?void 0:_e.partTarget)||0)))&&(this.log(`adjusting start position by ${rt} to match buffer start`),$+=rt,this.startPosition=$),_<$&&(this.log(`seek to target start position ${$} from current time ${_} buffer start ${tt}`),i.currentTime=$)}}_getAudioCodec(i){let _=this.config.defaultAudioCodec||i.audioCodec;return this.audioCodecSwap&&_&&(this.log("Swapping audio codec"),_.indexOf("mp4a.40.5")!==-1?_="mp4a.40.2":_="mp4a.40.5"),_}_loadBitrateTestFrag(i,_){i.bitrateTest=!0,this._doFragLoad(i,_).then($=>{const{hls:j}=this,_e=$==null?void 0:$.frag;if(!_e||this.fragContextChanged(_e))return;_.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const et=_e.stats;et.parsing.start=et.parsing.end=et.buffering.start=et.buffering.end=self.performance.now(),j.trigger(Events.FRAG_LOADED,$),_e.bitrateTest=!1}).catch($=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn($),this.resetFragmentLoading(i))})}_handleTransmuxComplete(i){const _=this.playlistType,{hls:$}=this,{remuxResult:j,chunkMeta:_e}=i,et=this.getCurrentContext(_e);if(!et){this.resetWhenMissingContext(_e);return}const{frag:tt,part:rt,level:nt}=et,{video:it,text:st,id3:at,initSegment:ot}=j,{details:lt}=nt,ct=this.altAudio?void 0:j.audio;if(this.fragContextChanged(tt)){this.fragmentTracker.removeFragment(tt);return}if(this.state=State.PARSING,ot){const ft=ot.tracks;if(ft){const mt=tt.initSegment||tt;if(this.unhandledEncryptionError(ot,tt))return;this._bufferInitSegment(nt,ft,mt,_e),$.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:mt,id:_,tracks:ft})}const ut=ot.initPTS,ht=ot.timescale,dt=this.initPTS[tt.cc];if(isFiniteNumber(ut)&&(!dt||dt.baseTime!==ut||dt.timescale!==ht)){const mt=ot.trackId;this.initPTS[tt.cc]={baseTime:ut,timescale:ht,trackId:mt},$.trigger(Events.INIT_PTS_FOUND,{frag:tt,id:_,initPTS:ut,timescale:ht,trackId:mt})}}if(it&&lt){ct&&it.type==="audiovideo"&&this.logMuxedErr(tt);const ft=lt.fragments[tt.sn-1-lt.startSN],ut=tt.sn===lt.startSN,ht=!ft||tt.cc>ft.cc;if(j.independent!==!1){const{startPTS:dt,endPTS:mt,startDTS:pt,endDTS:yt}=it;if(rt)rt.elementaryStreams[it.type]={startPTS:dt,endPTS:mt,startDTS:pt,endDTS:yt};else if(it.firstKeyFrame&&it.independent&&_e.id===1&&!ht&&(this.couldBacktrack=!0),it.dropped&&it.independent){const gt=this.getMainFwdBufferInfo(),vt=(gt?gt.end:this.getLoadPosition())+this.config.maxBufferHole,St=it.firstKeyFramePTS?it.firstKeyFramePTS:dt;if(!ut&&vt<St-this.config.maxBufferHole&&!ht){this.backtrack(tt);return}else ht&&(tt.gap=!0);tt.setElementaryStreamInfo(it.type,tt.start,mt,tt.start,yt,!0)}else ut&&dt-(lt.appliedTimelineOffset||0)>MAX_START_GAP_JUMP&&(tt.gap=!0);tt.setElementaryStreamInfo(it.type,dt,mt,pt,yt),this.backtrackFragment&&(this.backtrackFragment=tt),this.bufferFragmentData(it,tt,rt,_e,ut||ht)}else if(ut||ht)tt.gap=!0;else{this.backtrack(tt);return}}if(ct){const{startPTS:ft,endPTS:ut,startDTS:ht,endDTS:dt}=ct;rt&&(rt.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:ft,endPTS:ut,startDTS:ht,endDTS:dt}),tt.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,ft,ut,ht,dt),this.bufferFragmentData(ct,tt,rt,_e)}if(lt&&at!=null&&at.samples.length){const ft={id:_,frag:tt,details:lt,samples:at.samples};$.trigger(Events.FRAG_PARSING_METADATA,ft)}if(lt&&st){const ft={id:_,frag:tt,details:lt,samples:st.samples};$.trigger(Events.FRAG_PARSING_USERDATA,ft)}}logMuxedErr(i){this.warn(`${isMediaFragment(i)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${i.url}`)}_bufferInitSegment(i,_,$,j){if(this.state!==State.PARSING)return;this.audioOnly=!!_.audio&&!_.video,this.altAudio&&!this.audioOnly&&(delete _.audio,_.audiovideo&&this.logMuxedErr($));const{audio:_e,video:et,audiovideo:tt}=_;if(_e){const nt=i.audioCodec;let it=pickMostCompleteCodecName(_e.codec,nt);it==="mp4a"&&(it="mp4a.40.5");const st=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){it&&(it.indexOf("mp4a.40.5")!==-1?it="mp4a.40.2":it="mp4a.40.5");const at=_e.metadata;at&&"channelCount"in at&&(at.channelCount||1)!==1&&st.indexOf("firefox")===-1&&(it="mp4a.40.5")}it&&it.indexOf("mp4a.40.5")!==-1&&st.indexOf("android")!==-1&&_e.container!=="audio/mpeg"&&(it="mp4a.40.2",this.log(`Android: force audio codec to ${it}`)),nt&&nt!==it&&this.log(`Swapping manifest audio codec "${nt}" for "${it}"`),_e.levelCodec=it,_e.id=PlaylistLevelType.MAIN,this.log(`Init audio buffer, container:${_e.container}, codecs[selected/level/parsed]=[${it||""}/${nt||""}/${_e.codec}]`),delete _.audiovideo}if(et){et.levelCodec=i.videoCodec,et.id=PlaylistLevelType.MAIN;const nt=et.codec;if((nt==null?void 0:nt.length)===4)switch(nt){case"hvc1":case"hev1":et.codec="hvc1.1.6.L120.90";break;case"av01":et.codec="av01.0.04M.08";break;case"avc1":et.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${et.container}, codecs[level/parsed]=[${i.videoCodec||""}/${nt}]${et.codec!==nt?" parsed-corrected="+et.codec:""}${et.supplemental?" supplemental="+et.supplemental:""}`),delete _.audiovideo}tt&&(this.log(`Init audiovideo buffer, container:${tt.container}, codecs[level/parsed]=[${i.codecs}/${tt.codec}]`),delete _.video,delete _.audio);const rt=Object.keys(_);if(rt.length){if(this.hls.trigger(Events.BUFFER_CODECS,_),!this.hls)return;rt.forEach(nt=>{const st=_[nt].initSegment;st!=null&&st.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:nt,data:st,frag:$,part:null,chunkMeta:j,parent:$.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const i=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(i,PlaylistLevelType.MAIN)}get maxBufferLength(){const{levels:i,level:_}=this,$=i==null?void 0:i[_];return $?this.getMaxBufferLength($.maxBitrate):this.config.maxBufferLength}backtrack(i){this.couldBacktrack=!0,this.backtrackFragment=i,this.resetTransmuxer(),this.flushBufferGap(i),this.fragmentTracker.removeFragment(i),this.fragPrevious=null,this.nextLoadPosition=i.start,this.state=State.IDLE}checkFragmentChanged(){const i=this.media;let _=null;if(i&&i.readyState>1&&i.seeking===!1){const $=i.currentTime;if(BufferHelper.isBuffered(i,$)?_=this.getAppendedFrag($):BufferHelper.isBuffered(i,$+.1)&&(_=this.getAppendedFrag($+.1)),_){this.backtrackFragment=null;const j=this.fragPlaying,_e=_.level;(!j||_.sn!==j.sn||j.level!==_e)&&(this.fragPlaying=_,this.hls.trigger(Events.FRAG_CHANGED,{frag:_}),(!j||j.level!==_e)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:_e}))}}}get nextLevel(){const i=this.nextBufferedFrag;return i?i.level:-1}get currentFrag(){var i;if(this.fragPlaying)return this.fragPlaying;const _=((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime;return isFiniteNumber(_)?this.getAppendedFrag(_):null}get currentProgramDateTime(){var i;const _=((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime;if(isFiniteNumber(_)){const $=this.getLevelDetails(),j=this.currentFrag||($?findFragmentByPTS(null,$.fragments,_):null);if(j){const _e=j.programDateTime;if(_e!==null){const et=_e+(_-j.start)*1e3;return new Date(et)}}}return null}get currentLevel(){const i=this.currentFrag;return i?i.level:-1}get nextBufferedFrag(){const i=this.currentFrag;return i?this.followingBufferedFrag(i):null}get forceStartLoad(){return this._forceStartLoad}}class KeyLoader extends Logger$1{constructor(i,_){super("key-loader",_),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=i}abort(i){for(const $ in this.keyIdToKeyInfo){const j=this.keyIdToKeyInfo[$].loader;if(j){var _;if(i&&i!==((_=j.context)==null?void 0:_.frag.type))return;j.abort()}}}detach(){for(const i in this.keyIdToKeyInfo){const _=this.keyIdToKeyInfo[i];(_.mediaKeySessionContext||_.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[i]}}destroy(){this.detach();for(const i in this.keyIdToKeyInfo){const _=this.keyIdToKeyInfo[i].loader;_&&_.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(i,_=ErrorDetails.KEY_LOAD_ERROR,$,j,_e){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:_,fatal:!1,frag:i,response:_e,error:$,networkDetails:j})}loadClear(i,_,$){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(_.length)for(let j=0,_e=_.length;j<_e;j++){const et=_[j];if(i.cc<=et.cc&&(!isMediaFragment(i)||!isMediaFragment(et)||i.sn<et.sn)||!$&&j==_e-1)return this.emeController.selectKeySystemFormat(et).then(tt=>{if(!this.emeController)return;et.setKeyFormat(tt);const rt=keySystemFormatToKeySystemDomain(tt);if(rt)return this.emeController.getKeySystemAccess([rt])})}if(this.config.requireKeySystemAccessOnStart){const j=getKeySystemsForConfig(this.config);if(j.length)return this.emeController.getKeySystemAccess(j)}}return null}load(i){return!i.decryptdata&&i.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(i).then(_=>this.loadInternal(i,_)):this.loadInternal(i)}loadInternal(i,_){var $,j;_&&i.setKeyFormat(_);const _e=i.decryptdata;if(!_e){const nt=new Error(_?`Expected frag.decryptdata to be defined after setting format ${_}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(i,ErrorDetails.KEY_LOAD_ERROR,nt))}const et=_e.uri;if(!et)return Promise.reject(this.createKeyLoadError(i,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${et}"`)));const tt=getKeyId(_e);let rt=this.keyIdToKeyInfo[tt];if(($=rt)!=null&&$.decryptdata.key)return _e.key=rt.decryptdata.key,Promise.resolve({frag:i,keyInfo:rt});if(this.emeController&&(j=rt)!=null&&j.keyLoadPromise)switch(this.emeController.getKeyStatus(rt.decryptdata)){case"usable":case"usable-in-future":return rt.keyLoadPromise.then(it=>{const{keyInfo:st}=it;return _e.key=st.decryptdata.key,{frag:i,keyInfo:st}})}switch(this.log(`${this.keyIdToKeyInfo[tt]?"Rel":"L"}oading${_e.keyId?" keyId: "+arrayToHex(_e.keyId):""} URI: ${_e.uri} from ${i.type} ${i.level}`),rt=this.keyIdToKeyInfo[tt]={decryptdata:_e,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},_e.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return _e.keyFormat==="identity"?this.loadKeyHTTP(rt,i):this.loadKeyEME(rt,i);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(rt,i);default:return Promise.reject(this.createKeyLoadError(i,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${_e.method}"`)))}}loadKeyEME(i,_){const $={frag:_,keyInfo:i};if(this.emeController&&this.config.emeEnabled){const j=this.emeController.loadKey($);return(i.keyLoadPromise=j.then(_e=>(i.mediaKeySessionContext=_e,$))).catch(_e=>{throw i.keyLoadPromise=null,"data"in _e&&(_e.data.frag=_),_e})}return Promise.resolve($)}loadKeyHTTP(i,_){const $=this.config,j=$.loader,_e=new j($);return _.keyLoader=i.loader=_e,i.keyLoadPromise=new Promise((et,tt)=>{const rt={keyInfo:i,frag:_,responseType:"arraybuffer",url:i.decryptdata.uri},nt=$.keyLoadPolicy.default,it={loadPolicy:nt,timeout:nt.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},st={onSuccess:(at,ot,lt,ct)=>{const{frag:ft,keyInfo:ut}=lt,ht=getKeyId(ut.decryptdata);if(!ft.decryptdata||ut!==this.keyIdToKeyInfo[ht])return tt(this.createKeyLoadError(ft,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),ct));ut.decryptdata.key=ft.decryptdata.key=new Uint8Array(at.data),ft.keyLoader=null,ut.loader=null,et({frag:ft,keyInfo:ut})},onError:(at,ot,lt,ct)=>{this.resetLoader(ot),tt(this.createKeyLoadError(_,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${at.code} loading key ${at.text}`),lt,_objectSpread2({url:rt.url,data:void 0},at)))},onTimeout:(at,ot,lt)=>{this.resetLoader(ot),tt(this.createKeyLoadError(_,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),lt))},onAbort:(at,ot,lt)=>{this.resetLoader(ot),tt(this.createKeyLoadError(_,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),lt))}};_e.load(rt,it,st)})}resetLoader(i){const{frag:_,keyInfo:$,url:j}=i,_e=$.loader;_.keyLoader===_e&&(_.keyLoader=null,$.loader=null);const et=getKeyId($.decryptdata)||j;delete this.keyIdToKeyInfo[et],_e&&_e.destroy()}}function getKeyId(o){if(o.keyFormat!==KeySystemFormats.FAIRPLAY){const i=o.keyId;if(i)return arrayToHex(i)}return o.uri}function mapContextToLevelType(o){const{type:i}=o;switch(i){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(o,i){let _=o.url;return(_===void 0||_.indexOf("data:")===0)&&(_=i.url),_}class PlaylistLoader{constructor(i){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=i,this.registerListeners()}startLoad(i){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:i}=this;i.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),i.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),i.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:i}=this;i.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),i.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),i.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(i){const _=this.hls.config,$=_.pLoader,j=_.loader,_e=$||j,et=new _e(_);return this.loaders[i.type]=et,et}getInternalLoader(i){return this.loaders[i.type]}resetInternalLoader(i){this.loaders[i]&&delete this.loaders[i]}destroyInternalLoaders(){for(const i in this.loaders){const _=this.loaders[i];_&&_.destroy(),this.resetInternalLoader(i)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(i,_){const{url:$}=_;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:$,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(i,_){const{id:$,level:j,pathwayId:_e,url:et,deliveryDirectives:tt,levelInfo:rt}=_;this.load({id:$,level:j,pathwayId:_e,responseType:"text",type:PlaylistContextType.LEVEL,url:et,deliveryDirectives:tt,levelOrTrack:rt})}onAudioTrackLoading(i,_){const{id:$,groupId:j,url:_e,deliveryDirectives:et,track:tt}=_;this.load({id:$,groupId:j,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:_e,deliveryDirectives:et,levelOrTrack:tt})}onSubtitleTrackLoading(i,_){const{id:$,groupId:j,url:_e,deliveryDirectives:et,track:tt}=_;this.load({id:$,groupId:j,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:_e,deliveryDirectives:et,levelOrTrack:tt})}onLevelsUpdated(i,_){const $=this.loaders[PlaylistContextType.LEVEL];if($){const j=$.context;j&&!_.levels.some(_e=>_e===j.levelOrTrack)&&($.abort(),delete this.loaders[PlaylistContextType.LEVEL])}}load(i){var _;const $=this.hls.config;let j=this.getInternalLoader(i);if(j){const nt=this.hls.logger,it=j.context;if(it&&it.levelOrTrack===i.levelOrTrack&&(it.url===i.url||it.deliveryDirectives&&!i.deliveryDirectives)){it.url===i.url?nt.log(`[playlist-loader]: ignore ${i.url} ongoing request`):nt.log(`[playlist-loader]: ignore ${i.url} in favor of ${it.url}`);return}nt.log(`[playlist-loader]: aborting previous loader for type: ${i.type}`),j.abort()}let _e;if(i.type===PlaylistContextType.MANIFEST?_e=$.manifestLoadPolicy.default:_e=_extends({},$.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),j=this.createInternalLoader(i),isFiniteNumber((_=i.deliveryDirectives)==null?void 0:_.part)){let nt;if(i.type===PlaylistContextType.LEVEL&&i.level!==null?nt=this.hls.levels[i.level].details:i.type===PlaylistContextType.AUDIO_TRACK&&i.id!==null?nt=this.hls.audioTracks[i.id].details:i.type===PlaylistContextType.SUBTITLE_TRACK&&i.id!==null&&(nt=this.hls.subtitleTracks[i.id].details),nt){const it=nt.partTarget,st=nt.targetduration;if(it&&st){const at=Math.max(it*3,st*.8)*1e3;_e=_extends({},_e,{maxTimeToFirstByteMs:Math.min(at,_e.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(at,_e.maxTimeToFirstByteMs)})}}}const et=_e.errorRetry||_e.timeoutRetry||{},tt={loadPolicy:_e,timeout:_e.maxLoadTimeMs,maxRetry:et.maxNumRetry||0,retryDelay:et.retryDelayMs||0,maxRetryDelay:et.maxRetryDelayMs||0},rt={onSuccess:(nt,it,st,at)=>{const ot=this.getInternalLoader(st);this.resetInternalLoader(st.type);const lt=nt.data;it.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(lt)||st.type!==PlaylistContextType.MANIFEST?this.handleTrackOrLevelPlaylist(nt,it,st,at||null,ot):this.handleMasterPlaylist(nt,it,st,at)},onError:(nt,it,st,at)=>{this.handleNetworkError(it,st,!1,nt,at)},onTimeout:(nt,it,st)=>{this.handleNetworkError(it,st,!0,void 0,nt)}};j.load(i,tt,rt)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:i,startPosition:_},forceStartLoad:$}=this.hls;(i||$)&&(this.hls.logger.log(`${i?"auto":"force"} startLoad with configured startPosition ${_}`),this.hls.startLoad(_))}handleMasterPlaylist(i,_,$,j){const _e=this.hls,et=i.data,tt=getResponseUrl(i,$),rt=M3U8Parser.parseMasterPlaylist(et,tt);if(rt.playlistParsingError){_.parsing.end=performance.now(),this.handleManifestParsingError(i,$,rt.playlistParsingError,j,_);return}const{contentSteering:nt,levels:it,sessionData:st,sessionKeys:at,startTimeOffset:ot,variableList:lt}=rt;this.variableList=lt,it.forEach(ht=>{const{unknownCodecs:dt}=ht;if(dt){const{preferManagedMediaSource:mt}=this.hls.config;let{audioCodec:pt,videoCodec:yt}=ht;for(let gt=dt.length;gt--;){const vt=dt[gt];areCodecsMediaSourceSupported(vt,"audio",mt)?(ht.audioCodec=pt=pt?`${pt},${vt}`:vt,sampleEntryCodesISO.audio[pt.substring(0,4)]=2,dt.splice(gt,1)):areCodecsMediaSourceSupported(vt,"video",mt)&&(ht.videoCodec=yt=yt?`${yt},${vt}`:vt,sampleEntryCodesISO.video[yt.substring(0,4)]=2,dt.splice(gt,1))}}});const{AUDIO:ct=[],SUBTITLES:ft,"CLOSED-CAPTIONS":ut}=M3U8Parser.parseMasterPlaylistMedia(et,tt,rt);ct.length&&!ct.some(dt=>!dt.url)&&it[0].audioCodec&&!it[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),ct.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),_e.trigger(Events.MANIFEST_LOADED,{levels:it,audioTracks:ct,subtitles:ft,captions:ut,contentSteering:nt,url:tt,stats:_,networkDetails:j,sessionData:st,sessionKeys:at,startTimeOffset:ot,variableList:lt})}handleTrackOrLevelPlaylist(i,_,$,j,_e){const et=this.hls,{id:tt,level:rt,type:nt}=$,it=getResponseUrl(i,$),st=isFiniteNumber(rt)?rt:isFiniteNumber(tt)?tt:0,at=mapContextToLevelType($),ot=M3U8Parser.parseLevelPlaylist(i.data,it,st,at,0,this.variableList);if(nt===PlaylistContextType.MANIFEST){const lt={attrs:new AttrList({}),bitrate:0,details:ot,name:"",url:it};ot.requestScheduled=_.loading.start+computeReloadInterval(ot,0),et.trigger(Events.MANIFEST_LOADED,{levels:[lt],audioTracks:[],url:it,stats:_,networkDetails:j,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}_.parsing.end=performance.now(),$.levelDetails=ot,this.handlePlaylistLoaded(ot,i,_,$,j,_e)}handleManifestParsingError(i,_,$,j,_e){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:_.type===PlaylistContextType.MANIFEST,url:i.url,err:$,error:$,reason:$.message,response:i,context:_,networkDetails:j,stats:_e})}handleNetworkError(i,_,$=!1,j,_e){let et=`A network ${$?"timeout":"error"+(j?" (status "+j.code+")":"")} occurred while loading ${i.type}`;i.type===PlaylistContextType.LEVEL?et+=`: ${i.level} id: ${i.id}`:(i.type===PlaylistContextType.AUDIO_TRACK||i.type===PlaylistContextType.SUBTITLE_TRACK)&&(et+=` id: ${i.id} group-id: "${i.groupId}"`);const tt=new Error(et);this.hls.logger.warn(`[playlist-loader]: ${et}`);let rt=ErrorDetails.UNKNOWN,nt=!1;const it=this.getInternalLoader(i);switch(i.type){case PlaylistContextType.MANIFEST:rt=$?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,nt=!0;break;case PlaylistContextType.LEVEL:rt=$?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,nt=!1;break;case PlaylistContextType.AUDIO_TRACK:rt=$?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,nt=!1;break;case PlaylistContextType.SUBTITLE_TRACK:rt=$?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,nt=!1;break}it&&this.resetInternalLoader(i.type);const st={type:ErrorTypes.NETWORK_ERROR,details:rt,fatal:nt,url:i.url,loader:it,context:i,error:tt,networkDetails:_,stats:_e};if(j){const at=(_==null?void 0:_.url)||i.url;st.response=_objectSpread2({url:at,data:void 0},j)}this.hls.trigger(Events.ERROR,st)}handlePlaylistLoaded(i,_,$,j,_e,et){const tt=this.hls,{type:rt,level:nt,levelOrTrack:it,id:st,groupId:at,deliveryDirectives:ot}=j,lt=getResponseUrl(_,j),ct=mapContextToLevelType(j);let ft=typeof j.level=="number"&&ct===PlaylistLevelType.MAIN?nt:void 0;const ut=i.playlistParsingError;if(ut){if(this.hls.logger.warn(`${ut} ${i.url}`),!tt.config.ignorePlaylistParsingErrors){tt.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:lt,error:ut,reason:ut.message,response:_,context:j,level:ft,parent:ct,networkDetails:_e,stats:$});return}i.playlistParsingError=null}if(!i.fragments.length){const ht=i.playlistParsingError=new Error("No Segments found in Playlist");tt.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:lt,error:ht,reason:ht.message,response:_,context:j,level:ft,parent:ct,networkDetails:_e,stats:$});return}switch(i.live&&et&&(et.getCacheAge&&(i.ageHeader=et.getCacheAge()||0),(!et.getCacheAge||isNaN(i.ageHeader))&&(i.ageHeader=0)),rt){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:if(ft){if(!it)ft=0;else if(it!==tt.levels[ft]){const ht=tt.levels.indexOf(it);ht>-1&&(ft=ht)}}tt.trigger(Events.LEVEL_LOADED,{details:i,levelInfo:it||tt.levels[0],level:ft||0,id:st||0,stats:$,networkDetails:_e,deliveryDirectives:ot,withoutMultiVariant:rt===PlaylistContextType.MANIFEST});break;case PlaylistContextType.AUDIO_TRACK:tt.trigger(Events.AUDIO_TRACK_LOADED,{details:i,track:it,id:st||0,groupId:at||"",stats:$,networkDetails:_e,deliveryDirectives:ot});break;case PlaylistContextType.SUBTITLE_TRACK:tt.trigger(Events.SUBTITLE_TRACK_LOADED,{details:i,track:it,id:st||0,groupId:at||"",stats:$,networkDetails:_e,deliveryDirectives:ot});break}}}class Hls{static get version(){return version$4}static isMSESupported(){return isMSESupported()}static isSupported(){return isSupported()}static getMediaSource(){return getMediaSource()}static get Events(){return Events}static get MetadataSchema(){return MetadataSchema}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(i){Hls.defaultConfig=i}constructor(i={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new EventEmitter$1,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const _=this.logger=enableLogs(i.debug||!1,"Hls instance",i.assetPlayerId),$=this.config=mergeConfig(Hls.DefaultConfig,i,_);this.userConfig=i,$.progressive&&enableStreamingMode($,_);const{abrController:j,bufferController:_e,capLevelController:et,errorController:tt,fpsController:rt}=$,nt=new tt(this),it=this.abrController=new j(this),st=new FragmentTracker(this),at=$.interstitialsController,ot=at?this.interstitialsController=new at(this,Hls):null,lt=this.bufferController=new _e(this,st),ct=this.capLevelController=new et(this),ft=new rt(this),ut=new PlaylistLoader(this),ht=$.contentSteeringController,dt=ht?new ht(this):null,mt=this.levelController=new LevelController(this,dt),pt=new ID3TrackController(this),yt=new KeyLoader(this.config,this.logger),gt=this.streamController=new StreamController(this,st,yt),vt=this.gapController=new GapController(this,st);ct.setStreamController(gt),ft.setStreamController(gt);const St=[ut,mt,gt];ot&&St.splice(1,0,ot),dt&&St.splice(1,0,dt),this.networkControllers=St;const At=[it,lt,vt,ct,ft,pt,st];this.audioTrackController=this.createController($.audioTrackController,St);const xt=$.audioStreamController;xt&&St.push(this.audioStreamController=new xt(this,st,yt)),this.subtitleTrackController=this.createController($.subtitleTrackController,St);const wt=$.subtitleStreamController;wt&&St.push(this.subtititleStreamController=new wt(this,st,yt)),this.createController($.timelineController,At),yt.emeController=this.emeController=this.createController($.emeController,At),this.cmcdController=this.createController($.cmcdController,At),this.latencyController=this.createController(LatencyController,At),this.coreComponents=At,St.push(nt);const Ot=nt.onErrorOut;typeof Ot=="function"&&this.on(Events.ERROR,Ot,nt),this.on(Events.MANIFEST_LOADED,ut.onManifestLoaded,ut)}createController(i,_){if(i){const $=new i(this);return _&&_.push($),$}return null}on(i,_,$=this){this._emitter.on(i,_,$)}once(i,_,$=this){this._emitter.once(i,_,$)}removeAllListeners(i){this._emitter.removeAllListeners(i)}off(i,_,$=this,j){this._emitter.off(i,_,$,j)}listeners(i){return this._emitter.listeners(i)}emit(i,_,$){return this._emitter.emit(i,_,$)}trigger(i,_){if(this.config.debug)return this.emit(i,i,_);try{return this.emit(i,i,_)}catch($){if(this.logger.error("An internal error happened while handling event "+i+'. Error message: "'+$.message+'". Here is a stacktrace:',$),!this.triggeringException){this.triggeringException=!0;const j=i===Events.ERROR;this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:j,event:i,error:$}),this.triggeringException=!1}}return!1}listenerCount(i){return this._emitter.listenerCount(i)}destroy(){this.logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(_=>_.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(_=>_.destroy()),this.coreComponents.length=0;const i=this.config;i.xhrSetup=i.fetchSetup=void 0,this.userConfig=null}attachMedia(i){if(!i||"media"in i&&!i.media){const _e=new Error(`attachMedia failed: invalid argument (${i})`);this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.ATTACH_MEDIA_ERROR,fatal:!0,error:_e});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const _="media"in i,$=_?i.media:i,j=_?i:{media:$};this._media=$,this.trigger(Events.MEDIA_ATTACHING,j)}detachMedia(){this.logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const i=this.bufferController.transferMedia();return this.trigger(Events.MEDIA_DETACHING,{transferMedia:i}),i}loadSource(i){this.stopLoad();const _=this.media,$=this._url,j=this._url=urlToolkitExports.buildAbsoluteURL(self.location.href,i,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${j}`),_&&$&&($!==j||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(_)),this.trigger(Events.MANIFEST_LOADING,{url:i})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(i=-1,_){this.logger.log(`startLoad(${i+(_?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let $=0;$<this.networkControllers.length&&(this.networkControllers[$].startLoad(i,_),!(!this.started||!this.networkControllers));$++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].stopLoad(),!(this.started||!this.networkControllers));i++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(i=>{i.resumeBuffering&&i.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(i=>{i.pauseBuffering&&i.pauseBuffering()}))}get inFlightFragments(){const i={[PlaylistLevelType.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(i[PlaylistLevelType.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(i[PlaylistLevelType.SUBTITLE]=this.subtititleStreamController.inFlightFrag),i}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const i=this._media,_=i==null?void 0:i.currentTime;this.detachMedia(),i&&(this.attachMedia(i),_&&this.startLoad(_))}removeLevel(i){this.levelController.removeLevel(i)}get sessionId(){let i=this._sessionId;return i||(i=this._sessionId=uuid$1()),i}get levels(){const i=this.levelController.levels;return i||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(i){this.logger.log(`set currentLevel:${i}`),this.levelController.manualLevel=i,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(i){this.logger.log(`set nextLevel:${i}`),this.levelController.manualLevel=i,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(i){this.logger.log(`set loadLevel:${i}`),this.levelController.manualLevel=i}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(i){this.levelController.nextLoadLevel=i}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(i){this.logger.log(`set firstLevel:${i}`),this.levelController.firstLevel=i}get startLevel(){const i=this.levelController.startLevel;return i===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:i}set startLevel(i){this.logger.log(`set startLevel:${i}`),i!==-1&&(i=Math.max(i,this.minAutoLevel)),this.levelController.startLevel=i}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(i){const _=!!i;_!==this.config.capLevelToPlayerSize&&(_?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=_)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:i}=this.abrController;return i?i.getEstimate():NaN}set bandwidthEstimate(i){this.abrController.resetEstimator(i)}get abrEwmaDefaultEstimate(){const{bwEstimator:i}=this.abrController;return i?i.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:i}=this.abrController;return i?i.getEstimateTTFB():NaN}set autoLevelCapping(i){this._autoLevelCapping!==i&&(this.logger.log(`set autoLevelCapping:${i}`),this._autoLevelCapping=i,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(i){isHdcpLevel(i)&&this._maxHdcpLevel!==i&&(this._maxHdcpLevel=i,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:i,config:{minAutoBitrate:_}}=this;if(!i)return 0;const $=i.length;for(let j=0;j<$;j++)if(i[j].maxBitrate>=_)return j;return 0}get maxAutoLevel(){const{levels:i,autoLevelCapping:_,maxHdcpLevel:$}=this;let j;if(_===-1&&i!=null&&i.length?j=i.length-1:j=_,$)for(let _e=j;_e--;){const et=i[_e].attrs["HDCP-LEVEL"];if(et&&et<=$)return _e}return j}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(i){this.abrController.nextAutoLevel=i}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(i){var _;return((_=this.audioTrackController)==null?void 0:_.setAudioOption(i))||null}setSubtitleOption(i){var _;return((_=this.subtitleTrackController)==null?void 0:_.setSubtitleOption(i))||null}get allAudioTracks(){const i=this.audioTrackController;return i?i.allAudioTracks:[]}get audioTracks(){const i=this.audioTrackController;return i?i.audioTracks:[]}get audioTrack(){const i=this.audioTrackController;return i?i.audioTrack:-1}set audioTrack(i){const _=this.audioTrackController;_&&(_.audioTrack=i)}get allSubtitleTracks(){const i=this.subtitleTrackController;return i?i.allSubtitleTracks:[]}get subtitleTracks(){const i=this.subtitleTrackController;return i?i.subtitleTracks:[]}get subtitleTrack(){const i=this.subtitleTrackController;return i?i.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(i){const _=this.subtitleTrackController;_&&(_.subtitleTrack=i)}get subtitleDisplay(){const i=this.subtitleTrackController;return i?i.subtitleDisplay:!1}set subtitleDisplay(i){const _=this.subtitleTrackController;_&&(_.subtitleDisplay=i)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(i){this.config.lowLatencyMode=i}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(i){this.latencyController.targetLatency=i}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(i){this.levelController.pathwayPriority=i}get bufferedToEnd(){var i;return!!((i=this.bufferController)!=null&&i.bufferedToEnd)}get interstitialsManager(){var i;return((i=this.interstitialsController)==null?void 0:i.interstitialsManager)||null}getMediaDecodingInfo(i,_=this.allAudioTracks){const $=getAudioTracksByGroup(_);return getMediaDecodingInfoPromise(i,$,navigator.mediaCapabilities)}}Hls.defaultConfig=void 0;var dexie_min={exports:{}};(function(o,i){(function(_,$){o.exports=$()})(commonjsGlobal,function(){var _=function(bt,Tt){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(It,Nt){It.__proto__=Nt}||function(It,Nt){for(var Ut in Nt)Object.prototype.hasOwnProperty.call(Nt,Ut)&&(It[Ut]=Nt[Ut])})(bt,Tt)},$=function(){return($=Object.assign||function(bt){for(var Tt,It=1,Nt=arguments.length;It<Nt;It++)for(var Ut in Tt=arguments[It])Object.prototype.hasOwnProperty.call(Tt,Ut)&&(bt[Ut]=Tt[Ut]);return bt}).apply(this,arguments)};function j(bt,Tt,It){for(var Nt,Ut=0,Kt=Tt.length;Ut<Kt;Ut++)!Nt&&Ut in Tt||((Nt=Nt||Array.prototype.slice.call(Tt,0,Ut))[Ut]=Tt[Ut]);return bt.concat(Nt||Array.prototype.slice.call(Tt))}var _e=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,et=Object.keys,tt=Array.isArray;function rt(bt,Tt){return typeof Tt!="object"||et(Tt).forEach(function(It){bt[It]=Tt[It]}),bt}typeof Promise>"u"||_e.Promise||(_e.Promise=Promise);var nt=Object.getPrototypeOf,it={}.hasOwnProperty;function st(bt,Tt){return it.call(bt,Tt)}function at(bt,Tt){typeof Tt=="function"&&(Tt=Tt(nt(bt))),(typeof Reflect>"u"?et:Reflect.ownKeys)(Tt).forEach(function(It){lt(bt,It,Tt[It])})}var ot=Object.defineProperty;function lt(bt,Tt,It,Nt){ot(bt,Tt,rt(It&&st(It,"get")&&typeof It.get=="function"?{get:It.get,set:It.set,configurable:!0}:{value:It,configurable:!0,writable:!0},Nt))}function ct(bt){return{from:function(Tt){return bt.prototype=Object.create(Tt.prototype),lt(bt.prototype,"constructor",bt),{extend:at.bind(null,bt.prototype)}}}}var ft=Object.getOwnPropertyDescriptor,ut=[].slice;function ht(bt,Tt,It){return ut.call(bt,Tt,It)}function dt(bt,Tt){return Tt(bt)}function mt(bt){if(!bt)throw new Error("Assertion Failed")}function pt(bt){_e.setImmediate?setImmediate(bt):setTimeout(bt,0)}function yt(bt,Tt){if(typeof Tt=="string"&&st(bt,Tt))return bt[Tt];if(!Tt)return bt;if(typeof Tt!="string"){for(var It=[],Nt=0,Ut=Tt.length;Nt<Ut;++Nt){var Kt=yt(bt,Tt[Nt]);It.push(Kt)}return It}var nr=Tt.indexOf(".");if(nr!==-1){var ur=bt[Tt.substr(0,nr)];return ur==null?void 0:yt(ur,Tt.substr(nr+1))}}function gt(bt,Tt,It){if(bt&&Tt!==void 0&&!("isFrozen"in Object&&Object.isFrozen(bt)))if(typeof Tt!="string"&&"length"in Tt){mt(typeof It!="string"&&"length"in It);for(var Nt=0,Ut=Tt.length;Nt<Ut;++Nt)gt(bt,Tt[Nt],It[Nt])}else{var Kt,nr,ur=Tt.indexOf(".");ur!==-1?(Kt=Tt.substr(0,ur),(nr=Tt.substr(ur+1))===""?It===void 0?tt(bt)&&!isNaN(parseInt(Kt))?bt.splice(Kt,1):delete bt[Kt]:bt[Kt]=It:gt(ur=!(ur=bt[Kt])||!st(bt,Kt)?bt[Kt]={}:ur,nr,It)):It===void 0?tt(bt)&&!isNaN(parseInt(Tt))?bt.splice(Tt,1):delete bt[Tt]:bt[Tt]=It}}function vt(bt){var Tt,It={};for(Tt in bt)st(bt,Tt)&&(It[Tt]=bt[Tt]);return It}var St=[].concat;function At(bt){return St.apply([],bt)}var Hr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(At([8,16,32,64].map(function(bt){return["Int","Uint","Float"].map(function(Tt){return Tt+bt+"Array"})}))).filter(function(bt){return _e[bt]}),xt=new Set(Hr.map(function(bt){return _e[bt]})),wt=null;function Ot(bt){return wt=new WeakMap,bt=function Tt(It){if(!It||typeof It!="object")return It;var Nt=wt.get(It);if(Nt)return Nt;if(tt(It)){Nt=[],wt.set(It,Nt);for(var Ut=0,Kt=It.length;Ut<Kt;++Ut)Nt.push(Tt(It[Ut]))}else if(xt.has(It.constructor))Nt=It;else{var nr,ur=nt(It);for(nr in Nt=ur===Object.prototype?{}:Object.create(ur),wt.set(It,Nt),It)st(It,nr)&&(Nt[nr]=Tt(It[nr]))}return Nt}(bt),wt=null,bt}var Bt={}.toString;function Ft(bt){return Bt.call(bt).slice(8,-1)}var Pt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Rt=typeof Pt=="symbol"?function(bt){var Tt;return bt!=null&&(Tt=bt[Pt])&&Tt.apply(bt)}:function(){return null};function Et(bt,Tt){return Tt=bt.indexOf(Tt),0<=Tt&&bt.splice(Tt,1),0<=Tt}var _t={};function Mt(bt){var Tt,It,Nt,Ut;if(arguments.length===1){if(tt(bt))return bt.slice();if(this===_t&&typeof bt=="string")return[bt];if(Ut=Rt(bt)){for(It=[];!(Nt=Ut.next()).done;)It.push(Nt.value);return It}if(bt==null)return[bt];if(typeof(Tt=bt.length)!="number")return[bt];for(It=new Array(Tt);Tt--;)It[Tt]=bt[Tt];return It}for(Tt=arguments.length,It=new Array(Tt);Tt--;)It[Tt]=arguments[Tt];return It}var Dt=typeof Symbol<"u"?function(bt){return bt[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Yn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(fr),Lt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ct(bt,Tt){this.name=bt,this.message=Tt}function kt(bt,Tt){return bt+". Errors: "+Object.keys(Tt).map(function(It){return Tt[It].toString()}).filter(function(It,Nt,Ut){return Ut.indexOf(It)===Nt}).join(`
`)}function jt(bt,Tt,It,Nt){this.failures=Tt,this.failedKeys=Nt,this.successCount=It,this.message=kt(bt,Tt)}function Vt(bt,Tt){this.name="BulkError",this.failures=Object.keys(Tt).map(function(It){return Tt[It]}),this.failuresByPos=Tt,this.message=kt(bt,this.failures)}ct(Ct).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ct(jt).from(Ct),ct(Vt).from(Ct);var zt=Yn.reduce(function(bt,Tt){return bt[Tt]=Tt+"Error",bt},{}),qt=Ct,Wt=Yn.reduce(function(bt,Tt){var It=Tt+"Error";function Nt(Ut,Kt){this.name=It,Ut?typeof Ut=="string"?(this.message="".concat(Ut).concat(Kt?`
 `+Kt:""),this.inner=Kt||null):typeof Ut=="object"&&(this.message="".concat(Ut.name," ").concat(Ut.message),this.inner=Ut):(this.message=Lt[Tt]||It,this.inner=null)}return ct(Nt).from(qt),bt[Tt]=Nt,bt},{});Wt.Syntax=SyntaxError,Wt.Type=TypeError,Wt.Range=RangeError;var ir=fr.reduce(function(bt,Tt){return bt[Tt+"Error"]=Wt[Tt],bt},{}),or=Yn.reduce(function(bt,Tt){return["Syntax","Type","Range"].indexOf(Tt)===-1&&(bt[Tt+"Error"]=Wt[Tt]),bt},{});function Qt(){}function gr(bt){return bt}function ar(bt,Tt){return bt==null||bt===gr?Tt:function(It){return Tt(bt(It))}}function Ar(bt,Tt){return function(){bt.apply(this,arguments),Tt.apply(this,arguments)}}function er(bt,Tt){return bt===Qt?Tt:function(){var It=bt.apply(this,arguments);It!==void 0&&(arguments[0]=It);var Nt=this.onsuccess,Ut=this.onerror;this.onsuccess=null,this.onerror=null;var Kt=Tt.apply(this,arguments);return Nt&&(this.onsuccess=this.onsuccess?Ar(Nt,this.onsuccess):Nt),Ut&&(this.onerror=this.onerror?Ar(Ut,this.onerror):Ut),Kt!==void 0?Kt:It}}function sr(bt,Tt){return bt===Qt?Tt:function(){bt.apply(this,arguments);var It=this.onsuccess,Nt=this.onerror;this.onsuccess=this.onerror=null,Tt.apply(this,arguments),It&&(this.onsuccess=this.onsuccess?Ar(It,this.onsuccess):It),Nt&&(this.onerror=this.onerror?Ar(Nt,this.onerror):Nt)}}function Gt(bt,Tt){return bt===Qt?Tt:function(It){var Nt=bt.apply(this,arguments);rt(It,Nt);var Ut=this.onsuccess,Kt=this.onerror;return this.onsuccess=null,this.onerror=null,It=Tt.apply(this,arguments),Ut&&(this.onsuccess=this.onsuccess?Ar(Ut,this.onsuccess):Ut),Kt&&(this.onerror=this.onerror?Ar(Kt,this.onerror):Kt),Nt===void 0?It===void 0?void 0:It:rt(Nt,It)}}function Jt(bt,Tt){return bt===Qt?Tt:function(){return Tt.apply(this,arguments)!==!1&&bt.apply(this,arguments)}}function lr(bt,Tt){return bt===Qt?Tt:function(){var It=bt.apply(this,arguments);if(It&&typeof It.then=="function"){for(var Nt=this,Ut=arguments.length,Kt=new Array(Ut);Ut--;)Kt[Ut]=arguments[Ut];return It.then(function(){return Tt.apply(Nt,Kt)})}return Tt.apply(this,arguments)}}or.ModifyError=jt,or.DexieError=Ct,or.BulkError=Vt;var dr=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function xr(bt){dr=bt}var Mr={},Or=100,Hr=typeof Promise>"u"?[]:function(){var bt=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[bt,nt(bt),bt];var Tt=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[Tt,nt(Tt),bt]}(),fr=Hr[0],Yn=Hr[1],Hr=Hr[2],Yn=Yn&&Yn.then,Gr=fr&&fr.constructor,dn=!!Hr,nn=function(bt,Tt){Sr.push([bt,Tt]),Jr&&(queueMicrotask(Zt),Jr=!1)},vn=!0,Jr=!0,an=[],yn=[],_n=gr,jr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Qt,pgp:!1,env:{},finalize:Qt},cr=jr,Sr=[],en=0,bn=[];function qr(bt){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var Tt=this._PSD=cr;if(typeof bt!="function"){if(bt!==Mr)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Xr(this,this._value))}this._state=null,this._value=null,++Tt.ref,function It(Nt,Ut){try{Ut(function(Kt){if(Nt._state===null){if(Kt===Nt)throw new TypeError("A promise cannot be resolved with itself.");var nr=Nt._lib&&Yt();Kt&&typeof Kt.then=="function"?It(Nt,function(ur,yr){Kt instanceof qr?Kt._then(ur,yr):Kt.then(ur,yr)}):(Nt._state=!0,Nt._value=Kt,un(Nt)),nr&&hr()}},Xr.bind(null,Nt))}catch(Kt){Xr(Nt,Kt)}}(this,bt)}var rr={get:function(){var bt=cr,Tt=Qr;function It(Nt,Ut){var Kt=this,nr=!bt.global&&(bt!==cr||Tt!==Qr),ur=nr&&!Yr(),yr=new qr(function(br,Pr){hn(Kt,new Fr(In(Nt,bt,nr,ur),In(Ut,bt,nr,ur),br,Pr,bt))});return this._consoleTask&&(yr._consoleTask=this._consoleTask),yr}return It.prototype=Mr,It},set:function(bt){lt(this,"then",bt&&bt.prototype===Mr?rr:{get:function(){return bt},set:rr.set})}};function Fr(bt,Tt,It,Nt,Ut){this.onFulfilled=typeof bt=="function"?bt:null,this.onRejected=typeof Tt=="function"?Tt:null,this.resolve=It,this.reject=Nt,this.psd=Ut}function Xr(bt,Tt){var It,Nt;yn.push(Tt),bt._state===null&&(It=bt._lib&&Yt(),Tt=_n(Tt),bt._state=!1,bt._value=Tt,Nt=bt,an.some(function(Ut){return Ut._value===Nt._value})||an.push(Nt),un(bt),It&&hr())}function un(bt){var Tt=bt._listeners;bt._listeners=[];for(var It=0,Nt=Tt.length;It<Nt;++It)hn(bt,Tt[It]);var Ut=bt._PSD;--Ut.ref||Ut.finalize(),en===0&&(++en,nn(function(){--en==0&&Lr()},[]))}function hn(bt,Tt){if(bt._state!==null){var It=bt._state?Tt.onFulfilled:Tt.onRejected;if(It===null)return(bt._state?Tt.resolve:Tt.reject)(bt._value);++Tt.psd.ref,++en,nn(rn,[It,bt,Tt])}else bt._listeners.push(Tt)}function rn(bt,Tt,It){try{var Nt,Ut=Tt._value;!Tt._state&&yn.length&&(yn=[]),Nt=dr&&Tt._consoleTask?Tt._consoleTask.run(function(){return bt(Ut)}):bt(Ut),Tt._state||yn.indexOf(Ut)!==-1||function(Kt){for(var nr=an.length;nr;)if(an[--nr]._value===Kt._value)return an.splice(nr,1)}(Tt),It.resolve(Nt)}catch(Kt){It.reject(Kt)}finally{--en==0&&Lr(),--It.psd.ref||It.psd.finalize()}}function Zt(){xn(jr,function(){Yt()&&hr()})}function Yt(){var bt=vn;return Jr=vn=!1,bt}function hr(){var bt,Tt,It;do for(;0<Sr.length;)for(bt=Sr,Sr=[],It=bt.length,Tt=0;Tt<It;++Tt){var Nt=bt[Tt];Nt[0].apply(null,Nt[1])}while(0<Sr.length);Jr=vn=!0}function Lr(){var bt=an;an=[],bt.forEach(function(Nt){Nt._PSD.onunhandled.call(null,Nt._value,Nt)});for(var Tt=bn.slice(0),It=Tt.length;It;)Tt[--It]()}function Ht(bt){return new qr(Mr,!1,bt)}function Xt(bt,Tt){var It=cr;return function(){var Nt=Yt(),Ut=cr;try{return Tn(It,!0),bt.apply(this,arguments)}catch(Kt){Tt&&Tt(Kt)}finally{Tn(Ut,!1),Nt&&hr()}}}at(qr.prototype,{then:rr,_then:function(bt,Tt){hn(this,new Fr(null,null,bt,Tt,cr))},catch:function(bt){if(arguments.length===1)return this.then(null,bt);var Tt=bt,It=arguments[1];return typeof Tt=="function"?this.then(null,function(Nt){return(Nt instanceof Tt?It:Ht)(Nt)}):this.then(null,function(Nt){return(Nt&&Nt.name===Tt?It:Ht)(Nt)})},finally:function(bt){return this.then(function(Tt){return qr.resolve(bt()).then(function(){return Tt})},function(Tt){return qr.resolve(bt()).then(function(){return Ht(Tt)})})},timeout:function(bt,Tt){var It=this;return bt<1/0?new qr(function(Nt,Ut){var Kt=setTimeout(function(){return Ut(new Wt.Timeout(Tt))},bt);It.then(Nt,Ut).finally(clearTimeout.bind(null,Kt))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&lt(qr.prototype,Symbol.toStringTag,"Dexie.Promise"),jr.env=En(),at(qr,{all:function(){var bt=Mt.apply(null,arguments).map(on);return new qr(function(Tt,It){bt.length===0&&Tt([]);var Nt=bt.length;bt.forEach(function(Ut,Kt){return qr.resolve(Ut).then(function(nr){bt[Kt]=nr,--Nt||Tt(bt)},It)})})},resolve:function(bt){return bt instanceof qr?bt:bt&&typeof bt.then=="function"?new qr(function(Tt,It){bt.then(Tt,It)}):new qr(Mr,!0,bt)},reject:Ht,race:function(){var bt=Mt.apply(null,arguments).map(on);return new qr(function(Tt,It){bt.map(function(Nt){return qr.resolve(Nt).then(Tt,It)})})},PSD:{get:function(){return cr},set:function(bt){return cr=bt}},totalEchoes:{get:function(){return Qr}},newPSD:Br,usePSD:xn,scheduler:{get:function(){return nn},set:function(bt){nn=bt}},rejectionMapper:{get:function(){return _n},set:function(bt){_n=bt}},follow:function(bt,Tt){return new qr(function(It,Nt){return Br(function(Ut,Kt){var nr=cr;nr.unhandleds=[],nr.onunhandled=Kt,nr.finalize=Ar(function(){var ur,yr=this;ur=function(){yr.unhandleds.length===0?Ut():Kt(yr.unhandleds[0])},bn.push(function br(){ur(),bn.splice(bn.indexOf(br),1)}),++en,nn(function(){--en==0&&Lr()},[])},nr.finalize),bt()},Tt,It,Nt)})}}),Gr&&(Gr.allSettled&&lt(qr,"allSettled",function(){var bt=Mt.apply(null,arguments).map(on);return new qr(function(Tt){bt.length===0&&Tt([]);var It=bt.length,Nt=new Array(It);bt.forEach(function(Ut,Kt){return qr.resolve(Ut).then(function(nr){return Nt[Kt]={status:"fulfilled",value:nr}},function(nr){return Nt[Kt]={status:"rejected",reason:nr}}).then(function(){return--It||Tt(Nt)})})})}),Gr.any&&typeof AggregateError<"u"&&lt(qr,"any",function(){var bt=Mt.apply(null,arguments).map(on);return new qr(function(Tt,It){bt.length===0&&It(new AggregateError([]));var Nt=bt.length,Ut=new Array(Nt);bt.forEach(function(Kt,nr){return qr.resolve(Kt).then(function(ur){return Tt(ur)},function(ur){Ut[nr]=ur,--Nt||It(new AggregateError(Ut))})})})}),Gr.withResolvers&&(qr.withResolvers=Gr.withResolvers));var tr={awaits:0,echoes:0,id:0},wr=0,Dr=[],Nr=0,Qr=0,Ur=0;function Br(bt,Tt,It,Nt){var Ut=cr,Kt=Object.create(Ut);return Kt.parent=Ut,Kt.ref=0,Kt.global=!1,Kt.id=++Ur,jr.env,Kt.env=dn?{Promise:qr,PromiseProp:{value:qr,configurable:!0,writable:!0},all:qr.all,race:qr.race,allSettled:qr.allSettled,any:qr.any,resolve:qr.resolve,reject:qr.reject}:{},Tt&&rt(Kt,Tt),++Ut.ref,Kt.finalize=function(){--this.parent.ref||this.parent.finalize()},Nt=xn(Kt,bt,It,Nt),Kt.ref===0&&Kt.finalize(),Nt}function Kr(){return tr.id||(tr.id=++wr),++tr.awaits,tr.echoes+=Or,tr.id}function Yr(){return!!tr.awaits&&(--tr.awaits==0&&(tr.id=0),tr.echoes=tr.awaits*Or,!0)}function on(bt){return tr.echoes&&bt&&bt.constructor===Gr?(Kr(),bt.then(function(Tt){return Yr(),Tt},function(Tt){return Yr(),$n(Tt)})):bt}function gn(){var bt=Dr[Dr.length-1];Dr.pop(),Tn(bt,!1)}function Tn(bt,Tt){var It,Nt=cr;(Tt?!tr.echoes||Nr++&&bt===cr:!Nr||--Nr&&bt===cr)||queueMicrotask(Tt?(function(Ut){++Qr,tr.echoes&&--tr.echoes!=0||(tr.echoes=tr.awaits=tr.id=0),Dr.push(cr),Tn(Ut,!0)}).bind(null,bt):gn),bt!==cr&&(cr=bt,Nt===jr&&(jr.env=En()),dn&&(It=jr.env.Promise,Tt=bt.env,(Nt.global||bt.global)&&(Object.defineProperty(_e,"Promise",Tt.PromiseProp),It.all=Tt.all,It.race=Tt.race,It.resolve=Tt.resolve,It.reject=Tt.reject,Tt.allSettled&&(It.allSettled=Tt.allSettled),Tt.any&&(It.any=Tt.any))))}function En(){var bt=_e.Promise;return dn?{Promise:bt,PromiseProp:Object.getOwnPropertyDescriptor(_e,"Promise"),all:bt.all,race:bt.race,allSettled:bt.allSettled,any:bt.any,resolve:bt.resolve,reject:bt.reject}:{}}function xn(bt,Tt,It,Nt,Ut){var Kt=cr;try{return Tn(bt,!0),Tt(It,Nt,Ut)}finally{Tn(Kt,!1)}}function In(bt,Tt,It,Nt){return typeof bt!="function"?bt:function(){var Ut=cr;It&&Kr(),Tn(Tt,!0);try{return bt.apply(this,arguments)}finally{Tn(Ut,!1),Nt&&queueMicrotask(Yr)}}}function jn(bt){Promise===Gr&&tr.echoes===0?Nr===0?bt():enqueueNativeMicroTask(bt):setTimeout(bt,0)}(""+Yn).indexOf("[native code]")===-1&&(Kr=Yr=Qt);var $n=qr.reject,Un="",Nn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ds="String expected.",zn=[],qn="__dbnames",rs="readonly",ns="readwrite";function Cn(bt,Tt){return bt?Tt?function(){return bt.apply(this,arguments)&&Tt.apply(this,arguments)}:bt:Tt}var On={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qn(bt){return typeof bt!="string"||/\./.test(bt)?function(Tt){return Tt}:function(Tt){return Tt[bt]===void 0&&bt in Tt&&delete(Tt=Ot(Tt))[bt],Tt}}function ss(){throw Wt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Sn(bt,Tt){try{var It=_i(bt),Nt=_i(Tt);if(It!==Nt)return It==="Array"?1:Nt==="Array"?-1:It==="binary"?1:Nt==="binary"?-1:It==="string"?1:Nt==="string"?-1:It==="Date"?1:Nt!=="Date"?NaN:-1;switch(It){case"number":case"Date":case"string":return Tt<bt?1:bt<Tt?-1:0;case"binary":return function(Ut,Kt){for(var nr=Ut.length,ur=Kt.length,yr=nr<ur?nr:ur,br=0;br<yr;++br)if(Ut[br]!==Kt[br])return Ut[br]<Kt[br]?-1:1;return nr===ur?0:nr<ur?-1:1}(Ts(bt),Ts(Tt));case"Array":return function(Ut,Kt){for(var nr=Ut.length,ur=Kt.length,yr=nr<ur?nr:ur,br=0;br<yr;++br){var Pr=Sn(Ut[br],Kt[br]);if(Pr!==0)return Pr}return nr===ur?0:nr<ur?-1:1}(bt,Tt)}}catch{}return NaN}function _i(bt){var Tt=typeof bt;return Tt!="object"?Tt:ArrayBuffer.isView(bt)?"binary":(bt=Ft(bt),bt==="ArrayBuffer"?"binary":bt)}function Ts(bt){return bt instanceof Uint8Array?bt:ArrayBuffer.isView(bt)?new Uint8Array(bt.buffer,bt.byteOffset,bt.byteLength):new Uint8Array(bt)}function ps(bt,Tt,It){var Nt=bt.schema.yProps;return Nt?(Tt&&0<It.numFailures&&(Tt=Tt.filter(function(Ut,Kt){return!It.failures[Kt]})),Promise.all(Nt.map(function(Ut){return Ut=Ut.updatesTable,Tt?bt.db.table(Ut).where("k").anyOf(Tt).delete():bt.db.table(Ut).clear()})).then(function(){return It})):It}var Fl=(Dn.prototype._trans=function(bt,Tt,It){var Nt=this._tx||cr.trans,Ut=this.name,Kt=dr&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(bt==="readonly"?"read":"write"," ").concat(this.name));function nr(br,Pr,pr){if(!pr.schema[Ut])throw new Wt.NotFound("Table "+Ut+" not part of transaction");return Tt(pr.idbtrans,pr)}var ur=Yt();try{var yr=Nt&&Nt.db._novip===this.db._novip?Nt===cr.trans?Nt._promise(bt,nr,It):Br(function(){return Nt._promise(bt,nr,It)},{trans:Nt,transless:cr.transless||cr}):function br(Pr,pr,Ir,vr){if(Pr.idbdb&&(Pr._state.openComplete||cr.letThrough||Pr._vip)){var _r=Pr._createTransaction(pr,Ir,Pr._dbSchema);try{_r.create(),Pr._state.PR1398_maxLoop=3}catch(Rr){return Rr.name===zt.InvalidState&&Pr.isOpen()&&0<--Pr._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Pr.close({disableAutoOpen:!1}),Pr.open().then(function(){return br(Pr,pr,Ir,vr)})):$n(Rr)}return _r._promise(pr,function(Rr,Cr){return Br(function(){return cr.trans=_r,vr(Rr,Cr,_r)})}).then(function(Rr){if(pr==="readwrite")try{_r.idbtrans.commit()}catch{}return pr==="readonly"?Rr:_r._completion.then(function(){return Rr})})}if(Pr._state.openComplete)return $n(new Wt.DatabaseClosed(Pr._state.dbOpenError));if(!Pr._state.isBeingOpened){if(!Pr._state.autoOpen)return $n(new Wt.DatabaseClosed);Pr.open().catch(Qt)}return Pr._state.dbReadyPromise.then(function(){return br(Pr,pr,Ir,vr)})}(this.db,bt,[this.name],nr);return Kt&&(yr._consoleTask=Kt,yr=yr.catch(function(br){return console.trace(br),$n(br)})),yr}finally{ur&&hr()}},Dn.prototype.get=function(bt,Tt){var It=this;return bt&&bt.constructor===Object?this.where(bt).first(Tt):bt==null?$n(new Wt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(Nt){return It.core.get({trans:Nt,key:bt}).then(function(Ut){return It.hook.reading.fire(Ut)})}).then(Tt)},Dn.prototype.where=function(bt){if(typeof bt=="string")return new this.db.WhereClause(this,bt);if(tt(bt))return new this.db.WhereClause(this,"[".concat(bt.join("+"),"]"));var Tt=et(bt);if(Tt.length===1)return this.where(Tt[0]).equals(bt[Tt[0]]);var It=this.schema.indexes.concat(this.schema.primKey).filter(function(ur){if(ur.compound&&Tt.every(function(br){return 0<=ur.keyPath.indexOf(br)})){for(var yr=0;yr<Tt.length;++yr)if(Tt.indexOf(ur.keyPath[yr])===-1)return!1;return!0}return!1}).sort(function(ur,yr){return ur.keyPath.length-yr.keyPath.length})[0];if(It&&this.db._maxKey!==Un){var Kt=It.keyPath.slice(0,Tt.length);return this.where(Kt).equals(Kt.map(function(yr){return bt[yr]}))}!It&&dr&&console.warn("The query ".concat(JSON.stringify(bt)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(Tt.join("+"),"]"));var Nt=this.schema.idxByName;function Ut(ur,yr){return Sn(ur,yr)===0}var nr=Tt.reduce(function(pr,yr){var br=pr[0],Pr=pr[1],pr=Nt[yr],Ir=bt[yr];return[br||pr,br||!pr?Cn(Pr,pr&&pr.multi?function(vr){return vr=yt(vr,yr),tt(vr)&&vr.some(function(_r){return Ut(Ir,_r)})}:function(vr){return Ut(Ir,yt(vr,yr))}):Pr]},[null,null]),Kt=nr[0],nr=nr[1];return Kt?this.where(Kt.name).equals(bt[Kt.keyPath]).filter(nr):It?this.filter(nr):this.where(Tt).equals("")},Dn.prototype.filter=function(bt){return this.toCollection().and(bt)},Dn.prototype.count=function(bt){return this.toCollection().count(bt)},Dn.prototype.offset=function(bt){return this.toCollection().offset(bt)},Dn.prototype.limit=function(bt){return this.toCollection().limit(bt)},Dn.prototype.each=function(bt){return this.toCollection().each(bt)},Dn.prototype.toArray=function(bt){return this.toCollection().toArray(bt)},Dn.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Dn.prototype.orderBy=function(bt){return new this.db.Collection(new this.db.WhereClause(this,tt(bt)?"[".concat(bt.join("+"),"]"):bt))},Dn.prototype.reverse=function(){return this.toCollection().reverse()},Dn.prototype.mapToClass=function(bt){var Tt,It=this.db,Nt=this.name;function Ut(){return Tt!==null&&Tt.apply(this,arguments)||this}(this.schema.mappedClass=bt).prototype instanceof ss&&(function(yr,br){if(typeof br!="function"&&br!==null)throw new TypeError("Class extends value "+String(br)+" is not a constructor or null");function Pr(){this.constructor=yr}_(yr,br),yr.prototype=br===null?Object.create(br):(Pr.prototype=br.prototype,new Pr)}(Ut,Tt=bt),Object.defineProperty(Ut.prototype,"db",{get:function(){return It},enumerable:!1,configurable:!0}),Ut.prototype.table=function(){return Nt},bt=Ut);for(var Kt=new Set,nr=bt.prototype;nr;nr=nt(nr))Object.getOwnPropertyNames(nr).forEach(function(yr){return Kt.add(yr)});function ur(yr){if(!yr)return yr;var br,Pr=Object.create(bt.prototype);for(br in yr)if(!Kt.has(br))try{Pr[br]=yr[br]}catch{}return Pr}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=ur,this.hook("reading",ur),bt},Dn.prototype.defineClass=function(){return this.mapToClass(function(bt){rt(this,bt)})},Dn.prototype.add=function(bt,Tt){var It=this,Nt=this.schema.primKey,Ut=Nt.auto,Kt=Nt.keyPath,nr=bt;return Kt&&Ut&&(nr=Qn(Kt)(bt)),this._trans("readwrite",function(ur){return It.core.mutate({trans:ur,type:"add",keys:Tt!=null?[Tt]:null,values:[nr]})}).then(function(ur){return ur.numFailures?qr.reject(ur.failures[0]):ur.lastResult}).then(function(ur){if(Kt)try{gt(bt,Kt,ur)}catch{}return ur})},Dn.prototype.update=function(bt,Tt){return typeof bt!="object"||tt(bt)?this.where(":id").equals(bt).modify(Tt):(bt=yt(bt,this.schema.primKey.keyPath),bt===void 0?$n(new Wt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(bt).modify(Tt))},Dn.prototype.put=function(bt,Tt){var It=this,Nt=this.schema.primKey,Ut=Nt.auto,Kt=Nt.keyPath,nr=bt;return Kt&&Ut&&(nr=Qn(Kt)(bt)),this._trans("readwrite",function(ur){return It.core.mutate({trans:ur,type:"put",values:[nr],keys:Tt!=null?[Tt]:null})}).then(function(ur){return ur.numFailures?qr.reject(ur.failures[0]):ur.lastResult}).then(function(ur){if(Kt)try{gt(bt,Kt,ur)}catch{}return ur})},Dn.prototype.delete=function(bt){var Tt=this;return this._trans("readwrite",function(It){return Tt.core.mutate({trans:It,type:"delete",keys:[bt]}).then(function(Nt){return ps(Tt,[bt],Nt)}).then(function(Nt){return Nt.numFailures?qr.reject(Nt.failures[0]):void 0})})},Dn.prototype.clear=function(){var bt=this;return this._trans("readwrite",function(Tt){return bt.core.mutate({trans:Tt,type:"deleteRange",range:On}).then(function(It){return ps(bt,null,It)})}).then(function(Tt){return Tt.numFailures?qr.reject(Tt.failures[0]):void 0})},Dn.prototype.bulkGet=function(bt){var Tt=this;return this._trans("readonly",function(It){return Tt.core.getMany({keys:bt,trans:It}).then(function(Nt){return Nt.map(function(Ut){return Tt.hook.reading.fire(Ut)})})})},Dn.prototype.bulkAdd=function(bt,Tt,It){var Nt=this,Ut=Array.isArray(Tt)?Tt:void 0,Kt=(It=It||(Ut?void 0:Tt))?It.allKeys:void 0;return this._trans("readwrite",function(nr){var br=Nt.schema.primKey,ur=br.auto,br=br.keyPath;if(br&&Ut)throw new Wt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(Ut&&Ut.length!==bt.length)throw new Wt.InvalidArgument("Arguments objects and keys must have the same length");var yr=bt.length,br=br&&ur?bt.map(Qn(br)):bt;return Nt.core.mutate({trans:nr,type:"add",keys:Ut,values:br,wantResults:Kt}).then(function(_r){var pr=_r.numFailures,Ir=_r.results,vr=_r.lastResult,_r=_r.failures;if(pr===0)return Kt?Ir:vr;throw new Vt("".concat(Nt.name,".bulkAdd(): ").concat(pr," of ").concat(yr," operations failed"),_r)})})},Dn.prototype.bulkPut=function(bt,Tt,It){var Nt=this,Ut=Array.isArray(Tt)?Tt:void 0,Kt=(It=It||(Ut?void 0:Tt))?It.allKeys:void 0;return this._trans("readwrite",function(nr){var br=Nt.schema.primKey,ur=br.auto,br=br.keyPath;if(br&&Ut)throw new Wt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(Ut&&Ut.length!==bt.length)throw new Wt.InvalidArgument("Arguments objects and keys must have the same length");var yr=bt.length,br=br&&ur?bt.map(Qn(br)):bt;return Nt.core.mutate({trans:nr,type:"put",keys:Ut,values:br,wantResults:Kt}).then(function(_r){var pr=_r.numFailures,Ir=_r.results,vr=_r.lastResult,_r=_r.failures;if(pr===0)return Kt?Ir:vr;throw new Vt("".concat(Nt.name,".bulkPut(): ").concat(pr," of ").concat(yr," operations failed"),_r)})})},Dn.prototype.bulkUpdate=function(bt){var Tt=this,It=this.core,Nt=bt.map(function(nr){return nr.key}),Ut=bt.map(function(nr){return nr.changes}),Kt=[];return this._trans("readwrite",function(nr){return It.getMany({trans:nr,keys:Nt,cache:"clone"}).then(function(ur){var yr=[],br=[];bt.forEach(function(pr,Ir){var vr=pr.key,_r=pr.changes,Rr=ur[Ir];if(Rr){for(var Cr=0,$r=Object.keys(_r);Cr<$r.length;Cr++){var Vr=$r[Cr],Wr=_r[Vr];if(Vr===Tt.schema.primKey.keyPath){if(Sn(Wr,vr)!==0)throw new Wt.Constraint("Cannot update primary key in bulkUpdate()")}else gt(Rr,Vr,Wr)}Kt.push(Ir),yr.push(vr),br.push(Rr)}});var Pr=yr.length;return It.mutate({trans:nr,type:"put",keys:yr,values:br,updates:{keys:Nt,changeSpecs:Ut}}).then(function(pr){var Ir=pr.numFailures,vr=pr.failures;if(Ir===0)return Pr;for(var _r=0,Rr=Object.keys(vr);_r<Rr.length;_r++){var Cr,$r=Rr[_r],Vr=Kt[Number($r)];Vr!=null&&(Cr=vr[$r],delete vr[$r],vr[Vr]=Cr)}throw new Vt("".concat(Tt.name,".bulkUpdate(): ").concat(Ir," of ").concat(Pr," operations failed"),vr)})})})},Dn.prototype.bulkDelete=function(bt){var Tt=this,It=bt.length;return this._trans("readwrite",function(Nt){return Tt.core.mutate({trans:Nt,type:"delete",keys:bt}).then(function(Ut){return ps(Tt,bt,Ut)})}).then(function(nr){var Ut=nr.numFailures,Kt=nr.lastResult,nr=nr.failures;if(Ut===0)return Kt;throw new Vt("".concat(Tt.name,".bulkDelete(): ").concat(Ut," of ").concat(It," operations failed"),nr)})},Dn);function Dn(){}function As(bt){function Tt(nr,ur){if(ur){for(var yr=arguments.length,br=new Array(yr-1);--yr;)br[yr-1]=arguments[yr];return It[nr].subscribe.apply(null,br),bt}if(typeof nr=="string")return It[nr]}var It={};Tt.addEventType=Kt;for(var Nt=1,Ut=arguments.length;Nt<Ut;++Nt)Kt(arguments[Nt]);return Tt;function Kt(nr,ur,yr){if(typeof nr!="object"){var br;ur=ur||Jt;var Pr={subscribers:[],fire:yr=yr||Qt,subscribe:function(pr){Pr.subscribers.indexOf(pr)===-1&&(Pr.subscribers.push(pr),Pr.fire=ur(Pr.fire,pr))},unsubscribe:function(pr){Pr.subscribers=Pr.subscribers.filter(function(Ir){return Ir!==pr}),Pr.fire=Pr.subscribers.reduce(ur,yr)}};return It[nr]=Tt[nr]=Pr}et(br=nr).forEach(function(pr){var Ir=br[pr];if(tt(Ir))Kt(pr,br[pr][0],br[pr][1]);else{if(Ir!=="asap")throw new Wt.InvalidArgument("Invalid event config");var vr=Kt(pr,gr,function(){for(var _r=arguments.length,Rr=new Array(_r);_r--;)Rr[_r]=arguments[_r];vr.subscribers.forEach(function(Cr){pt(function(){Cr.apply(null,Rr)})})})}})}}function Ps(bt,Tt){return ct(Tt).from({prototype:bt}),Tt}function ms(bt,Tt){return!(bt.filter||bt.algorithm||bt.or)&&(Tt?bt.justLimit:!bt.replayFilter)}function ho(bt,Tt){bt.filter=Cn(bt.filter,Tt)}function fo(bt,Tt,It){var Nt=bt.replayFilter;bt.replayFilter=Nt?function(){return Cn(Nt(),Tt())}:Tt,bt.justLimit=It&&!Nt}function Vs(bt,Tt){if(bt.isPrimKey)return Tt.primaryKey;var It=Tt.getIndexByKeyPath(bt.index);if(!It)throw new Wt.Schema("KeyPath "+bt.index+" on object store "+Tt.name+" is not indexed");return It}function Nl(bt,Tt,It){var Nt=Vs(bt,Tt.schema);return Tt.openCursor({trans:It,values:!bt.keysOnly,reverse:bt.dir==="prev",unique:!!bt.unique,query:{index:Nt,range:bt.range}})}function Gs(bt,Tt,It,Nt){var Ut=bt.replayFilter?Cn(bt.filter,bt.replayFilter()):bt.filter;if(bt.or){var Kt={},nr=function(ur,yr,br){var Pr,pr;Ut&&!Ut(yr,br,function(Ir){return yr.stop(Ir)},function(Ir){return yr.fail(Ir)})||((pr=""+(Pr=yr.primaryKey))=="[object ArrayBuffer]"&&(pr=""+new Uint8Array(Pr)),st(Kt,pr)||(Kt[pr]=!0,Tt(ur,yr,br)))};return Promise.all([bt.or._iterate(nr,It),Bl(Nl(bt,Nt,It),bt.algorithm,nr,!bt.keysOnly&&bt.valueMapper)])}return Bl(Nl(bt,Nt,It),Cn(bt.algorithm,Ut),Tt,!bt.keysOnly&&bt.valueMapper)}function Bl(bt,Tt,It,Nt){var Ut=Xt(Nt?function(Kt,nr,ur){return It(Nt(Kt),nr,ur)}:It);return bt.then(function(Kt){if(Kt)return Kt.start(function(){var nr=function(){return Kt.continue()};Tt&&!Tt(Kt,function(ur){return nr=ur},function(ur){Kt.stop(ur),nr=Qt},function(ur){Kt.fail(ur),nr=Qt})||Ut(Kt.value,Kt,function(ur){return nr=ur}),nr()})})}var ws=(Ul.prototype.execute=function(bt){var Tt=this["@@propmod"];if(Tt.add!==void 0){var It=Tt.add;if(tt(It))return j(j([],tt(bt)?bt:[],!0),It).sort();if(typeof It=="number")return(Number(bt)||0)+It;if(typeof It=="bigint")try{return BigInt(bt)+It}catch{return BigInt(0)+It}throw new TypeError("Invalid term ".concat(It))}if(Tt.remove!==void 0){var Nt=Tt.remove;if(tt(Nt))return tt(bt)?bt.filter(function(Ut){return!Nt.includes(Ut)}).sort():[];if(typeof Nt=="number")return Number(bt)-Nt;if(typeof Nt=="bigint")try{return BigInt(bt)-Nt}catch{return BigInt(0)-Nt}throw new TypeError("Invalid subtrahend ".concat(Nt))}return It=(It=Tt.replacePrefix)===null||It===void 0?void 0:It[0],It&&typeof bt=="string"&&bt.startsWith(It)?Tt.replacePrefix[1]+bt.substring(It.length):bt},Ul);function Ul(bt){this["@@propmod"]=bt}var Gu=(Ln.prototype._read=function(bt,Tt){var It=this._ctx;return It.error?It.table._trans(null,$n.bind(null,It.error)):It.table._trans("readonly",bt).then(Tt)},Ln.prototype._write=function(bt){var Tt=this._ctx;return Tt.error?Tt.table._trans(null,$n.bind(null,Tt.error)):Tt.table._trans("readwrite",bt,"locked")},Ln.prototype._addAlgorithm=function(bt){var Tt=this._ctx;Tt.algorithm=Cn(Tt.algorithm,bt)},Ln.prototype._iterate=function(bt,Tt){return Gs(this._ctx,bt,Tt,this._ctx.table.core)},Ln.prototype.clone=function(bt){var Tt=Object.create(this.constructor.prototype),It=Object.create(this._ctx);return bt&&rt(It,bt),Tt._ctx=It,Tt},Ln.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ln.prototype.each=function(bt){var Tt=this._ctx;return this._read(function(It){return Gs(Tt,bt,It,Tt.table.core)})},Ln.prototype.count=function(bt){var Tt=this;return this._read(function(It){var Nt=Tt._ctx,Ut=Nt.table.core;if(ms(Nt,!0))return Ut.count({trans:It,query:{index:Vs(Nt,Ut.schema),range:Nt.range}}).then(function(nr){return Math.min(nr,Nt.limit)});var Kt=0;return Gs(Nt,function(){return++Kt,!1},It,Ut).then(function(){return Kt})}).then(bt)},Ln.prototype.sortBy=function(bt,Tt){var It=bt.split(".").reverse(),Nt=It[0],Ut=It.length-1;function Kt(yr,br){return br?Kt(yr[It[br]],br-1):yr[Nt]}var nr=this._ctx.dir==="next"?1:-1;function ur(yr,br){return Sn(Kt(yr,Ut),Kt(br,Ut))*nr}return this.toArray(function(yr){return yr.sort(ur)}).then(Tt)},Ln.prototype.toArray=function(bt){var Tt=this;return this._read(function(It){var Nt=Tt._ctx;if(Nt.dir==="next"&&ms(Nt,!0)&&0<Nt.limit){var Ut=Nt.valueMapper,Kt=Vs(Nt,Nt.table.core.schema);return Nt.table.core.query({trans:It,limit:Nt.limit,values:!0,query:{index:Kt,range:Nt.range}}).then(function(ur){return ur=ur.result,Ut?ur.map(Ut):ur})}var nr=[];return Gs(Nt,function(ur){return nr.push(ur)},It,Nt.table.core).then(function(){return nr})},bt)},Ln.prototype.offset=function(bt){var Tt=this._ctx;return bt<=0||(Tt.offset+=bt,ms(Tt)?fo(Tt,function(){var It=bt;return function(Nt,Ut){return It===0||(It===1?--It:Ut(function(){Nt.advance(It),It=0}),!1)}}):fo(Tt,function(){var It=bt;return function(){return--It<0}})),this},Ln.prototype.limit=function(bt){return this._ctx.limit=Math.min(this._ctx.limit,bt),fo(this._ctx,function(){var Tt=bt;return function(It,Nt,Ut){return--Tt<=0&&Nt(Ut),0<=Tt}},!0),this},Ln.prototype.until=function(bt,Tt){return ho(this._ctx,function(It,Nt,Ut){return!bt(It.value)||(Nt(Ut),Tt)}),this},Ln.prototype.first=function(bt){return this.limit(1).toArray(function(Tt){return Tt[0]}).then(bt)},Ln.prototype.last=function(bt){return this.reverse().first(bt)},Ln.prototype.filter=function(bt){var Tt;return ho(this._ctx,function(It){return bt(It.value)}),(Tt=this._ctx).isMatch=Cn(Tt.isMatch,bt),this},Ln.prototype.and=function(bt){return this.filter(bt)},Ln.prototype.or=function(bt){return new this.db.WhereClause(this._ctx.table,bt,this)},Ln.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ln.prototype.desc=function(){return this.reverse()},Ln.prototype.eachKey=function(bt){var Tt=this._ctx;return Tt.keysOnly=!Tt.isMatch,this.each(function(It,Nt){bt(Nt.key,Nt)})},Ln.prototype.eachUniqueKey=function(bt){return this._ctx.unique="unique",this.eachKey(bt)},Ln.prototype.eachPrimaryKey=function(bt){var Tt=this._ctx;return Tt.keysOnly=!Tt.isMatch,this.each(function(It,Nt){bt(Nt.primaryKey,Nt)})},Ln.prototype.keys=function(bt){var Tt=this._ctx;Tt.keysOnly=!Tt.isMatch;var It=[];return this.each(function(Nt,Ut){It.push(Ut.key)}).then(function(){return It}).then(bt)},Ln.prototype.primaryKeys=function(bt){var Tt=this._ctx;if(Tt.dir==="next"&&ms(Tt,!0)&&0<Tt.limit)return this._read(function(Nt){var Ut=Vs(Tt,Tt.table.core.schema);return Tt.table.core.query({trans:Nt,values:!1,limit:Tt.limit,query:{index:Ut,range:Tt.range}})}).then(function(Nt){return Nt.result}).then(bt);Tt.keysOnly=!Tt.isMatch;var It=[];return this.each(function(Nt,Ut){It.push(Ut.primaryKey)}).then(function(){return It}).then(bt)},Ln.prototype.uniqueKeys=function(bt){return this._ctx.unique="unique",this.keys(bt)},Ln.prototype.firstKey=function(bt){return this.limit(1).keys(function(Tt){return Tt[0]}).then(bt)},Ln.prototype.lastKey=function(bt){return this.reverse().firstKey(bt)},Ln.prototype.distinct=function(){var bt=this._ctx,bt=bt.index&&bt.table.schema.idxByName[bt.index];if(!bt||!bt.multi)return this;var Tt={};return ho(this._ctx,function(Ut){var Nt=Ut.primaryKey.toString(),Ut=st(Tt,Nt);return Tt[Nt]=!0,!Ut}),this},Ln.prototype.modify=function(bt){var Tt=this,It=this._ctx;return this._write(function(Nt){var Ut,Kt,nr;nr=typeof bt=="function"?bt:(Ut=et(bt),Kt=Ut.length,function($r){for(var Vr=!1,Wr=0;Wr<Kt;++Wr){var zr=Ut[Wr],Zr=bt[zr],cn=yt($r,zr);Zr instanceof ws?(gt($r,zr,Zr.execute(cn)),Vr=!0):cn!==Zr&&(gt($r,zr,Zr),Vr=!0)}return Vr});var ur=It.table.core,pr=ur.schema.primaryKey,yr=pr.outbound,br=pr.extractKey,Pr=200,pr=Tt.db._options.modifyChunkSize;pr&&(Pr=typeof pr=="object"?pr[ur.name]||pr["*"]||200:pr);function Ir($r,zr){var Wr=zr.failures,zr=zr.numFailures;_r+=$r-zr;for(var Zr=0,cn=et(Wr);Zr<cn.length;Zr++){var tn=cn[Zr];vr.push(Wr[tn])}}var vr=[],_r=0,Rr=[],Cr=bt===Vl;return Tt.clone().primaryKeys().then(function($r){function Vr(zr){var Zr=Math.min(Pr,$r.length-zr),cn=$r.slice(zr,zr+Zr);return(Cr?Promise.resolve([]):ur.getMany({trans:Nt,keys:cn,cache:"immutable"})).then(function(tn){var sn=[],pn=[],fn=yr?[]:null,mn=Cr?cn:[];if(!Cr)for(var wn=0;wn<Zr;++wn){var kn=tn[wn],Pn={value:Ot(kn),primKey:$r[zr+wn]};nr.call(Pn,Pn.value,Pn)!==!1&&(Pn.value==null?mn.push($r[zr+wn]):yr||Sn(br(kn),br(Pn.value))===0?(pn.push(Pn.value),yr&&fn.push($r[zr+wn])):(mn.push($r[zr+wn]),sn.push(Pn.value)))}return Promise.resolve(0<sn.length&&ur.mutate({trans:Nt,type:"add",values:sn}).then(function(Mn){for(var An in Mn.failures)mn.splice(parseInt(An),1);Ir(sn.length,Mn)})).then(function(){return(0<pn.length||Wr&&typeof bt=="object")&&ur.mutate({trans:Nt,type:"put",keys:fn,values:pn,criteria:Wr,changeSpec:typeof bt!="function"&&bt,isAdditionalChunk:0<zr}).then(function(Mn){return Ir(pn.length,Mn)})}).then(function(){return(0<mn.length||Wr&&Cr)&&ur.mutate({trans:Nt,type:"delete",keys:mn,criteria:Wr,isAdditionalChunk:0<zr}).then(function(Mn){return ps(It.table,mn,Mn)}).then(function(Mn){return Ir(mn.length,Mn)})}).then(function(){return $r.length>zr+Zr&&Vr(zr+Pr)})})}var Wr=ms(It)&&It.limit===1/0&&(typeof bt!="function"||Cr)&&{index:It.index,range:It.range};return Vr(0).then(function(){if(0<vr.length)throw new jt("Error modifying one or more objects",vr,_r,Rr);return $r.length})})})},Ln.prototype.delete=function(){var bt=this._ctx,Tt=bt.range;return!ms(bt)||bt.table.schema.yProps||!bt.isPrimKey&&Tt.type!==3?this.modify(Vl):this._write(function(It){var Nt=bt.table.core.schema.primaryKey,Ut=Tt;return bt.table.core.count({trans:It,query:{index:Nt,range:Ut}}).then(function(Kt){return bt.table.core.mutate({trans:It,type:"deleteRange",range:Ut}).then(function(yr){var ur=yr.failures,yr=yr.numFailures;if(yr)throw new jt("Could not delete some values",Object.keys(ur).map(function(br){return ur[br]}),Kt-yr);return Kt-yr})})})},Ln);function Ln(){}var Vl=function(bt,Tt){return Tt.value=null};function Hu(bt,Tt){return bt<Tt?-1:bt===Tt?0:1}function Ku(bt,Tt){return Tt<bt?-1:bt===Tt?0:1}function Wn(bt,Tt,It){return bt=bt instanceof Hl?new bt.Collection(bt):bt,bt._ctx.error=new(It||TypeError)(Tt),bt}function gs(bt){return new bt.Collection(bt,function(){return Gl("")}).limit(0)}function Hs(bt,Tt,It,Nt){var Ut,Kt,nr,ur,yr,br,Pr,pr=It.length;if(!It.every(function(_r){return typeof _r=="string"}))return Wn(bt,ds);function Ir(_r){Ut=_r==="next"?function(Cr){return Cr.toUpperCase()}:function(Cr){return Cr.toLowerCase()},Kt=_r==="next"?function(Cr){return Cr.toLowerCase()}:function(Cr){return Cr.toUpperCase()},nr=_r==="next"?Hu:Ku;var Rr=It.map(function(Cr){return{lower:Kt(Cr),upper:Ut(Cr)}}).sort(function(Cr,$r){return nr(Cr.lower,$r.lower)});ur=Rr.map(function(Cr){return Cr.upper}),yr=Rr.map(function(Cr){return Cr.lower}),Pr=(br=_r)==="next"?"":Nt}Ir("next"),bt=new bt.Collection(bt,function(){return as(ur[0],yr[pr-1]+Nt)}),bt._ondirectionchange=function(_r){Ir(_r)};var vr=0;return bt._addAlgorithm(function(_r,Rr,Cr){var $r=_r.key;if(typeof $r!="string")return!1;var Vr=Kt($r);if(Tt(Vr,yr,vr))return!0;for(var Wr=null,zr=vr;zr<pr;++zr){var Zr=function(cn,tn,sn,pn,fn,mn){for(var wn=Math.min(cn.length,pn.length),kn=-1,Pn=0;Pn<wn;++Pn){var Mn=tn[Pn];if(Mn!==pn[Pn])return fn(cn[Pn],sn[Pn])<0?cn.substr(0,Pn)+sn[Pn]+sn.substr(Pn+1):fn(cn[Pn],pn[Pn])<0?cn.substr(0,Pn)+pn[Pn]+sn.substr(Pn+1):0<=kn?cn.substr(0,kn)+tn[kn]+sn.substr(kn+1):null;fn(cn[Pn],Mn)<0&&(kn=Pn)}return wn<pn.length&&mn==="next"?cn+sn.substr(cn.length):wn<cn.length&&mn==="prev"?cn.substr(0,sn.length):kn<0?null:cn.substr(0,kn)+pn[kn]+sn.substr(kn+1)}($r,Vr,ur[zr],yr[zr],nr,br);Zr===null&&Wr===null?vr=zr+1:(Wr===null||0<nr(Wr,Zr))&&(Wr=Zr)}return Rr(Wr!==null?function(){_r.continue(Wr+Pr)}:Cr),!1}),bt}function as(bt,Tt,It,Nt){return{type:2,lower:bt,upper:Tt,lowerOpen:It,upperOpen:Nt}}function Gl(bt){return{type:1,lower:bt,upper:bt}}var Hl=(Object.defineProperty(Bn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Bn.prototype.between=function(bt,Tt,It,Nt){It=It!==!1,Nt=Nt===!0;try{return 0<this._cmp(bt,Tt)||this._cmp(bt,Tt)===0&&(It||Nt)&&(!It||!Nt)?gs(this):new this.Collection(this,function(){return as(bt,Tt,!It,!Nt)})}catch{return Wn(this,Nn)}},Bn.prototype.equals=function(bt){return bt==null?Wn(this,Nn):new this.Collection(this,function(){return Gl(bt)})},Bn.prototype.above=function(bt){return bt==null?Wn(this,Nn):new this.Collection(this,function(){return as(bt,void 0,!0)})},Bn.prototype.aboveOrEqual=function(bt){return bt==null?Wn(this,Nn):new this.Collection(this,function(){return as(bt,void 0,!1)})},Bn.prototype.below=function(bt){return bt==null?Wn(this,Nn):new this.Collection(this,function(){return as(void 0,bt,!1,!0)})},Bn.prototype.belowOrEqual=function(bt){return bt==null?Wn(this,Nn):new this.Collection(this,function(){return as(void 0,bt)})},Bn.prototype.startsWith=function(bt){return typeof bt!="string"?Wn(this,ds):this.between(bt,bt+Un,!0,!0)},Bn.prototype.startsWithIgnoreCase=function(bt){return bt===""?this.startsWith(bt):Hs(this,function(Tt,It){return Tt.indexOf(It[0])===0},[bt],Un)},Bn.prototype.equalsIgnoreCase=function(bt){return Hs(this,function(Tt,It){return Tt===It[0]},[bt],"")},Bn.prototype.anyOfIgnoreCase=function(){var bt=Mt.apply(_t,arguments);return bt.length===0?gs(this):Hs(this,function(Tt,It){return It.indexOf(Tt)!==-1},bt,"")},Bn.prototype.startsWithAnyOfIgnoreCase=function(){var bt=Mt.apply(_t,arguments);return bt.length===0?gs(this):Hs(this,function(Tt,It){return It.some(function(Nt){return Tt.indexOf(Nt)===0})},bt,Un)},Bn.prototype.anyOf=function(){var bt=this,Tt=Mt.apply(_t,arguments),It=this._cmp;try{Tt.sort(It)}catch{return Wn(this,Nn)}if(Tt.length===0)return gs(this);var Nt=new this.Collection(this,function(){return as(Tt[0],Tt[Tt.length-1])});Nt._ondirectionchange=function(Kt){It=Kt==="next"?bt._ascending:bt._descending,Tt.sort(It)};var Ut=0;return Nt._addAlgorithm(function(Kt,nr,ur){for(var yr=Kt.key;0<It(yr,Tt[Ut]);)if(++Ut===Tt.length)return nr(ur),!1;return It(yr,Tt[Ut])===0||(nr(function(){Kt.continue(Tt[Ut])}),!1)}),Nt},Bn.prototype.notEqual=function(bt){return this.inAnyRange([[-1/0,bt],[bt,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Bn.prototype.noneOf=function(){var bt=Mt.apply(_t,arguments);if(bt.length===0)return new this.Collection(this);try{bt.sort(this._ascending)}catch{return Wn(this,Nn)}var Tt=bt.reduce(function(It,Nt){return It?It.concat([[It[It.length-1][1],Nt]]):[[-1/0,Nt]]},null);return Tt.push([bt[bt.length-1],this.db._maxKey]),this.inAnyRange(Tt,{includeLowers:!1,includeUppers:!1})},Bn.prototype.inAnyRange=function($r,Tt){var It=this,Nt=this._cmp,Ut=this._ascending,Kt=this._descending,nr=this._min,ur=this._max;if($r.length===0)return gs(this);if(!$r.every(function(Vr){return Vr[0]!==void 0&&Vr[1]!==void 0&&Ut(Vr[0],Vr[1])<=0}))return Wn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Wt.InvalidArgument);var yr=!Tt||Tt.includeLowers!==!1,br=Tt&&Tt.includeUppers===!0,Pr,pr=Ut;function Ir(Vr,Wr){return pr(Vr[0],Wr[0])}try{(Pr=$r.reduce(function(Vr,Wr){for(var zr=0,Zr=Vr.length;zr<Zr;++zr){var cn=Vr[zr];if(Nt(Wr[0],cn[1])<0&&0<Nt(Wr[1],cn[0])){cn[0]=nr(cn[0],Wr[0]),cn[1]=ur(cn[1],Wr[1]);break}}return zr===Zr&&Vr.push(Wr),Vr},[])).sort(Ir)}catch{return Wn(this,Nn)}var vr=0,_r=br?function(Vr){return 0<Ut(Vr,Pr[vr][1])}:function(Vr){return 0<=Ut(Vr,Pr[vr][1])},Rr=yr?function(Vr){return 0<Kt(Vr,Pr[vr][0])}:function(Vr){return 0<=Kt(Vr,Pr[vr][0])},Cr=_r,$r=new this.Collection(this,function(){return as(Pr[0][0],Pr[Pr.length-1][1],!yr,!br)});return $r._ondirectionchange=function(Vr){pr=Vr==="next"?(Cr=_r,Ut):(Cr=Rr,Kt),Pr.sort(Ir)},$r._addAlgorithm(function(Vr,Wr,zr){for(var Zr,cn=Vr.key;Cr(cn);)if(++vr===Pr.length)return Wr(zr),!1;return!_r(Zr=cn)&&!Rr(Zr)||(It._cmp(cn,Pr[vr][1])===0||It._cmp(cn,Pr[vr][0])===0||Wr(function(){pr===Ut?Vr.continue(Pr[vr][0]):Vr.continue(Pr[vr][1])}),!1)}),$r},Bn.prototype.startsWithAnyOf=function(){var bt=Mt.apply(_t,arguments);return bt.every(function(Tt){return typeof Tt=="string"})?bt.length===0?gs(this):this.inAnyRange(bt.map(function(Tt){return[Tt,Tt+Un]})):Wn(this,"startsWithAnyOf() only works with strings")},Bn);function Bn(){}function Jn(bt){return Xt(function(Tt){return Cs(Tt),bt(Tt.target.error),!1})}function Cs(bt){bt.stopPropagation&&bt.stopPropagation(),bt.preventDefault&&bt.preventDefault()}var Rs="storagemutated",po="x-storagemutated-1",os=As(null,Rs),Wu=(Zn.prototype._lock=function(){return mt(!cr.global),++this._reculock,this._reculock!==1||cr.global||(cr.lockOwnerFor=this),this},Zn.prototype._unlock=function(){if(mt(!cr.global),--this._reculock==0)for(cr.global||(cr.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var bt=this._blockedFuncs.shift();try{xn(bt[1],bt[0])}catch{}}return this},Zn.prototype._locked=function(){return this._reculock&&cr.lockOwnerFor!==this},Zn.prototype.create=function(bt){var Tt=this;if(!this.mode)return this;var It=this.db.idbdb,Nt=this.db._state.dbOpenError;if(mt(!this.idbtrans),!bt&&!It)switch(Nt&&Nt.name){case"DatabaseClosedError":throw new Wt.DatabaseClosed(Nt);case"MissingAPIError":throw new Wt.MissingAPI(Nt.message,Nt);default:throw new Wt.OpenFailed(Nt)}if(!this.active)throw new Wt.TransactionInactive;return mt(this._completion._state===null),(bt=this.idbtrans=bt||(this.db.core||It).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Xt(function(Ut){Cs(Ut),Tt._reject(bt.error)}),bt.onabort=Xt(function(Ut){Cs(Ut),Tt.active&&Tt._reject(new Wt.Abort(bt.error)),Tt.active=!1,Tt.on("abort").fire(Ut)}),bt.oncomplete=Xt(function(){Tt.active=!1,Tt._resolve(),"mutatedParts"in bt&&os.storagemutated.fire(bt.mutatedParts)}),this},Zn.prototype._promise=function(bt,Tt,It){var Nt=this;if(bt==="readwrite"&&this.mode!=="readwrite")return $n(new Wt.ReadOnly("Transaction is readonly"));if(!this.active)return $n(new Wt.TransactionInactive);if(this._locked())return new qr(function(Kt,nr){Nt._blockedFuncs.push([function(){Nt._promise(bt,Tt,It).then(Kt,nr)},cr])});if(It)return Br(function(){var Kt=new qr(function(nr,ur){Nt._lock();var yr=Tt(nr,ur,Nt);yr&&yr.then&&yr.then(nr,ur)});return Kt.finally(function(){return Nt._unlock()}),Kt._lib=!0,Kt});var Ut=new qr(function(Kt,nr){var ur=Tt(Kt,nr,Nt);ur&&ur.then&&ur.then(Kt,nr)});return Ut._lib=!0,Ut},Zn.prototype._root=function(){return this.parent?this.parent._root():this},Zn.prototype.waitFor=function(bt){var Tt,It=this._root(),Nt=qr.resolve(bt);It._waitingFor?It._waitingFor=It._waitingFor.then(function(){return Nt}):(It._waitingFor=Nt,It._waitingQueue=[],Tt=It.idbtrans.objectStore(It.storeNames[0]),function Kt(){for(++It._spinCount;It._waitingQueue.length;)It._waitingQueue.shift()();It._waitingFor&&(Tt.get(-1/0).onsuccess=Kt)}());var Ut=It._waitingFor;return new qr(function(Kt,nr){Nt.then(function(ur){return It._waitingQueue.push(Xt(Kt.bind(null,ur)))},function(ur){return It._waitingQueue.push(Xt(nr.bind(null,ur)))}).finally(function(){It._waitingFor===Ut&&(It._waitingFor=null)})})},Zn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Wt.Abort))},Zn.prototype.table=function(bt){var Tt=this._memoizedTables||(this._memoizedTables={});if(st(Tt,bt))return Tt[bt];var It=this.schema[bt];if(!It)throw new Wt.NotFound("Table "+bt+" not part of transaction");return It=new this.db.Table(bt,It,this),It.core=this.db.core.table(bt),Tt[bt]=It},Zn);function Zn(){}function mo(bt,Tt,It,Nt,Ut,Kt,nr,ur){return{name:bt,keyPath:Tt,unique:It,multi:Nt,auto:Ut,compound:Kt,src:(It&&!nr?"&":"")+(Nt?"*":"")+(Ut?"++":"")+Kl(Tt),type:ur}}function Kl(bt){return typeof bt=="string"?bt:bt?"["+[].join.call(bt,"+")+"]":""}function go(bt,Tt,It){return{name:bt,primKey:Tt,indexes:It,mappedClass:null,idxByName:(Nt=function(Ut){return[Ut.name,Ut]},It.reduce(function(Ut,Kt,nr){return nr=Nt(Kt,nr),nr&&(Ut[nr[0]]=nr[1]),Ut},{}))};var Nt}var Is=function(bt){try{return bt.only([[]]),Is=function(){return[[]]},[[]]}catch{return Is=function(){return Un},Un}};function yo(bt){return bt==null?function(){}:typeof bt=="string"?(Tt=bt).split(".").length===1?function(It){return It[Tt]}:function(It){return yt(It,Tt)}:function(It){return yt(It,bt)};var Tt}function Wl(bt){return[].slice.call(bt)}var zu=0;function ks(bt){return bt==null?":id":typeof bt=="string"?bt:"[".concat(bt.join("+"),"]")}function qu(bt,Tt,yr){function Nt(Cr){if(Cr.type===3)return null;if(Cr.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var vr=Cr.lower,_r=Cr.upper,Rr=Cr.lowerOpen,Cr=Cr.upperOpen;return vr===void 0?_r===void 0?null:Tt.upperBound(_r,!!Cr):_r===void 0?Tt.lowerBound(vr,!!Rr):Tt.bound(vr,_r,!!Rr,!!Cr)}function Ut(Ir){var vr,_r=Ir.name;return{name:_r,schema:Ir,mutate:function(Rr){var Cr=Rr.trans,$r=Rr.type,Vr=Rr.keys,Wr=Rr.values,zr=Rr.range;return new Promise(function(Zr,cn){Zr=Xt(Zr);var tn=Cr.objectStore(_r),sn=tn.keyPath==null,pn=$r==="put"||$r==="add";if(!pn&&$r!=="delete"&&$r!=="deleteRange")throw new Error("Invalid operation type: "+$r);var fn,mn=(Vr||Wr||{length:1}).length;if(Vr&&Wr&&Vr.length!==Wr.length)throw new Error("Given keys array must have same length as given values array.");if(mn===0)return Zr({numFailures:0,failures:{},results:[],lastResult:void 0});function wn(Kn){++Mn,Cs(Kn)}var kn=[],Pn=[],Mn=0;if($r==="deleteRange"){if(zr.type===4)return Zr({numFailures:Mn,failures:Pn,results:[],lastResult:void 0});zr.type===3?kn.push(fn=tn.clear()):kn.push(fn=tn.delete(Nt(zr)))}else{var sn=pn?sn?[Wr,Vr]:[Wr,null]:[Vr,null],An=sn[0],Gn=sn[1];if(pn)for(var Hn=0;Hn<mn;++Hn)kn.push(fn=Gn&&Gn[Hn]!==void 0?tn[$r](An[Hn],Gn[Hn]):tn[$r](An[Hn])),fn.onerror=wn;else for(Hn=0;Hn<mn;++Hn)kn.push(fn=tn[$r](An[Hn])),fn.onerror=wn}function ba(Kn){Kn=Kn.target.result,kn.forEach(function(hs,Do){return hs.error!=null&&(Pn[Do]=hs.error)}),Zr({numFailures:Mn,failures:Pn,results:$r==="delete"?Vr:kn.map(function(hs){return hs.result}),lastResult:Kn})}fn.onerror=function(Kn){wn(Kn),ba(Kn)},fn.onsuccess=ba})},getMany:function(Rr){var Cr=Rr.trans,$r=Rr.keys;return new Promise(function(Vr,Wr){Vr=Xt(Vr);for(var zr,Zr=Cr.objectStore(_r),cn=$r.length,tn=new Array(cn),sn=0,pn=0,fn=function(kn){kn=kn.target,tn[kn._pos]=kn.result,++pn===sn&&Vr(tn)},mn=Jn(Wr),wn=0;wn<cn;++wn)$r[wn]!=null&&((zr=Zr.get($r[wn]))._pos=wn,zr.onsuccess=fn,zr.onerror=mn,++sn);sn===0&&Vr(tn)})},get:function(Rr){var Cr=Rr.trans,$r=Rr.key;return new Promise(function(Vr,Wr){Vr=Xt(Vr);var zr=Cr.objectStore(_r).get($r);zr.onsuccess=function(Zr){return Vr(Zr.target.result)},zr.onerror=Jn(Wr)})},query:(vr=br,function(Rr){return new Promise(function(Cr,$r){Cr=Xt(Cr);var Vr,Wr,zr,sn=Rr.trans,Zr=Rr.values,cn=Rr.limit,fn=Rr.query,tn=cn===1/0?void 0:cn,pn=fn.index,fn=fn.range,sn=sn.objectStore(_r),pn=pn.isPrimaryKey?sn:sn.index(pn.name),fn=Nt(fn);if(cn===0)return Cr({result:[]});vr?((tn=Zr?pn.getAll(fn,tn):pn.getAllKeys(fn,tn)).onsuccess=function(mn){return Cr({result:mn.target.result})},tn.onerror=Jn($r)):(Vr=0,Wr=!Zr&&"openKeyCursor"in pn?pn.openKeyCursor(fn):pn.openCursor(fn),zr=[],Wr.onsuccess=function(mn){var wn=Wr.result;return wn?(zr.push(Zr?wn.value:wn.primaryKey),++Vr===cn?Cr({result:zr}):void wn.continue()):Cr({result:zr})},Wr.onerror=Jn($r))})}),openCursor:function(Rr){var Cr=Rr.trans,$r=Rr.values,Vr=Rr.query,Wr=Rr.reverse,zr=Rr.unique;return new Promise(function(Zr,cn){Zr=Xt(Zr);var pn=Vr.index,tn=Vr.range,sn=Cr.objectStore(_r),sn=pn.isPrimaryKey?sn:sn.index(pn.name),pn=Wr?zr?"prevunique":"prev":zr?"nextunique":"next",fn=!$r&&"openKeyCursor"in sn?sn.openKeyCursor(Nt(tn),pn):sn.openCursor(Nt(tn),pn);fn.onerror=Jn(cn),fn.onsuccess=Xt(function(mn){var wn,kn,Pn,Mn,An=fn.result;An?(An.___id=++zu,An.done=!1,wn=An.continue.bind(An),kn=(kn=An.continuePrimaryKey)&&kn.bind(An),Pn=An.advance.bind(An),Mn=function(){throw new Error("Cursor not stopped")},An.trans=Cr,An.stop=An.continue=An.continuePrimaryKey=An.advance=function(){throw new Error("Cursor not started")},An.fail=Xt(cn),An.next=function(){var Gn=this,Hn=1;return this.start(function(){return Hn--?Gn.continue():Gn.stop()}).then(function(){return Gn})},An.start=function(Gn){function Hn(){if(fn.result)try{Gn()}catch(Kn){An.fail(Kn)}else An.done=!0,An.start=function(){throw new Error("Cursor behind last entry")},An.stop()}var ba=new Promise(function(Kn,hs){Kn=Xt(Kn),fn.onerror=Jn(hs),An.fail=hs,An.stop=function(Do){An.stop=An.continue=An.continuePrimaryKey=An.advance=Mn,Kn(Do)}});return fn.onsuccess=Xt(function(Kn){fn.onsuccess=Hn,Hn()}),An.continue=wn,An.continuePrimaryKey=kn,An.advance=Pn,Hn(),ba},Zr(An)):Zr(null)},cn)})},count:function(Rr){var Cr=Rr.query,$r=Rr.trans,Vr=Cr.index,Wr=Cr.range;return new Promise(function(zr,Zr){var cn=$r.objectStore(_r),tn=Vr.isPrimaryKey?cn:cn.index(Vr.name),cn=Nt(Wr),tn=cn?tn.count(cn):tn.count();tn.onsuccess=Xt(function(sn){return zr(sn.target.result)}),tn.onerror=Jn(Zr)})}}}var Kt,nr,ur,Pr=(nr=yr,ur=Wl((Kt=bt).objectStoreNames),{schema:{name:Kt.name,tables:ur.map(function(Ir){return nr.objectStore(Ir)}).map(function(Ir){var vr=Ir.keyPath,Cr=Ir.autoIncrement,_r=tt(vr),Rr={},Cr={name:Ir.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:vr==null,compound:_r,keyPath:vr,autoIncrement:Cr,unique:!0,extractKey:yo(vr)},indexes:Wl(Ir.indexNames).map(function($r){return Ir.index($r)}).map(function(zr){var Vr=zr.name,Wr=zr.unique,Zr=zr.multiEntry,zr=zr.keyPath,Zr={name:Vr,compound:tt(zr),keyPath:zr,unique:Wr,multiEntry:Zr,extractKey:yo(zr)};return Rr[ks(zr)]=Zr}),getIndexByKeyPath:function($r){return Rr[ks($r)]}};return Rr[":id"]=Cr.primaryKey,vr!=null&&(Rr[ks(vr)]=Cr.primaryKey),Cr})},hasGetAll:0<ur.length&&"getAll"in nr.objectStore(ur[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),yr=Pr.schema,br=Pr.hasGetAll,Pr=yr.tables.map(Ut),pr={};return Pr.forEach(function(Ir){return pr[Ir.name]=Ir}),{stack:"dbcore",transaction:bt.transaction.bind(bt),table:function(Ir){if(!pr[Ir])throw new Error("Table '".concat(Ir,"' not found"));return pr[Ir]},MIN_KEY:-1/0,MAX_KEY:Is(Tt),schema:yr}}function Yu(bt,Tt,It,Nt){var Ut=It.IDBKeyRange;return It.indexedDB,{dbcore:(Nt=qu(Tt,Ut,Nt),bt.dbcore.reduce(function(Kt,nr){return nr=nr.create,$($({},Kt),nr(Kt))},Nt))}}function Ks(bt,Nt){var It=Nt.db,Nt=Yu(bt._middlewares,It,bt._deps,Nt);bt.core=Nt.dbcore,bt.tables.forEach(function(Ut){var Kt=Ut.name;bt.core.schema.tables.some(function(nr){return nr.name===Kt})&&(Ut.core=bt.core.table(Kt),bt[Kt]instanceof bt.Table&&(bt[Kt].core=Ut.core))})}function Ws(bt,Tt,It,Nt){It.forEach(function(Ut){var Kt=Nt[Ut];Tt.forEach(function(nr){var ur=function yr(br,Pr){return ft(br,Pr)||(br=nt(br))&&yr(br,Pr)}(nr,Ut);(!ur||"value"in ur&&ur.value===void 0)&&(nr===bt.Transaction.prototype||nr instanceof bt.Transaction?lt(nr,Ut,{get:function(){return this.table(Ut)},set:function(yr){ot(this,Ut,{value:yr,writable:!0,configurable:!0,enumerable:!0})}}):nr[Ut]=new bt.Table(Ut,Kt))})})}function vo(bt,Tt){Tt.forEach(function(It){for(var Nt in It)It[Nt]instanceof bt.Table&&delete It[Nt]})}function Xu(bt,Tt){return bt._cfg.version-Tt._cfg.version}function Qu(bt,Tt,It,Nt){var Ut=bt._dbSchema;It.objectStoreNames.contains("$meta")&&!Ut.$meta&&(Ut.$meta=go("$meta",Yl("")[0],[]),bt._storeNames.push("$meta"));var Kt=bt._createTransaction("readwrite",bt._storeNames,Ut);Kt.create(It),Kt._completion.catch(Nt);var nr=Kt._reject.bind(Kt),ur=cr.transless||cr;Br(function(){return cr.trans=Kt,cr.transless=ur,Tt!==0?(Ks(bt,It),br=Tt,((yr=Kt).storeNames.includes("$meta")?yr.table("$meta").get("version").then(function(Pr){return Pr??br}):qr.resolve(br)).then(function(Pr){return Ir=Pr,vr=Kt,_r=It,Rr=[],Pr=(pr=bt)._versions,Cr=pr._dbSchema=qs(0,pr.idbdb,_r),(Pr=Pr.filter(function($r){return $r._cfg.version>=Ir})).length!==0?(Pr.forEach(function($r){Rr.push(function(){var Vr=Cr,Wr=$r._cfg.dbschema;Ys(pr,Vr,_r),Ys(pr,Wr,_r),Cr=pr._dbSchema=Wr;var zr=bo(Vr,Wr);zr.add.forEach(function(pn){So(_r,pn[0],pn[1].primKey,pn[1].indexes)}),zr.change.forEach(function(pn){if(pn.recreate)throw new Wt.Upgrade("Not yet support for changing primary key");var fn=_r.objectStore(pn.name);pn.add.forEach(function(mn){return zs(fn,mn)}),pn.change.forEach(function(mn){fn.deleteIndex(mn.name),zs(fn,mn)}),pn.del.forEach(function(mn){return fn.deleteIndex(mn)})});var Zr=$r._cfg.contentUpgrade;if(Zr&&$r._cfg.version>Ir){Ks(pr,_r),vr._memoizedTables={};var cn=vt(Wr);zr.del.forEach(function(pn){cn[pn]=Vr[pn]}),vo(pr,[pr.Transaction.prototype]),Ws(pr,[pr.Transaction.prototype],et(cn),cn),vr.schema=cn;var tn,sn=Dt(Zr);return sn&&Kr(),zr=qr.follow(function(){var pn;(tn=Zr(vr))&&sn&&(pn=Yr.bind(null,null),tn.then(pn,pn))}),tn&&typeof tn.then=="function"?qr.resolve(tn):zr.then(function(){return tn})}}),Rr.push(function(Vr){var Wr,zr,Zr=$r._cfg.dbschema;Wr=Zr,zr=Vr,[].slice.call(zr.db.objectStoreNames).forEach(function(cn){return Wr[cn]==null&&zr.db.deleteObjectStore(cn)}),vo(pr,[pr.Transaction.prototype]),Ws(pr,[pr.Transaction.prototype],pr._storeNames,pr._dbSchema),vr.schema=pr._dbSchema}),Rr.push(function(Vr){pr.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(pr.idbdb.version/10)===$r._cfg.version?(pr.idbdb.deleteObjectStore("$meta"),delete pr._dbSchema.$meta,pr._storeNames=pr._storeNames.filter(function(Wr){return Wr!=="$meta"})):Vr.objectStore("$meta").put($r._cfg.version,"version"))})}),function $r(){return Rr.length?qr.resolve(Rr.shift()(vr.idbtrans)).then($r):qr.resolve()}().then(function(){zl(Cr,_r)})):qr.resolve();var pr,Ir,vr,_r,Rr,Cr}).catch(nr)):(et(Ut).forEach(function(Pr){So(It,Pr,Ut[Pr].primKey,Ut[Pr].indexes)}),Ks(bt,It),void qr.follow(function(){return bt.on.populate.fire(Kt)}).catch(nr));var yr,br})}function Ju(bt,Tt){zl(bt._dbSchema,Tt),Tt.db.version%10!=0||Tt.objectStoreNames.contains("$meta")||Tt.db.createObjectStore("$meta").add(Math.ceil(Tt.db.version/10-1),"version");var It=qs(0,bt.idbdb,Tt);Ys(bt,bt._dbSchema,Tt);for(var Nt=0,Ut=bo(It,bt._dbSchema).change;Nt<Ut.length;Nt++){var Kt=function(nr){if(nr.change.length||nr.recreate)return console.warn("Unable to patch indexes of table ".concat(nr.name," because it has changes on the type of index or primary key.")),{value:void 0};var ur=Tt.objectStore(nr.name);nr.add.forEach(function(yr){dr&&console.debug("Dexie upgrade patch: Creating missing index ".concat(nr.name,".").concat(yr.src)),zs(ur,yr)})}(Ut[Nt]);if(typeof Kt=="object")return Kt.value}}function bo(bt,Tt){var It,Nt={del:[],add:[],change:[]};for(It in bt)Tt[It]||Nt.del.push(It);for(It in Tt){var Ut=bt[It],Kt=Tt[It];if(Ut){var nr={name:It,def:Kt,recreate:!1,del:[],add:[],change:[]};if(""+(Ut.primKey.keyPath||"")!=""+(Kt.primKey.keyPath||"")||Ut.primKey.auto!==Kt.primKey.auto)nr.recreate=!0,Nt.change.push(nr);else{var ur=Ut.idxByName,yr=Kt.idxByName,br=void 0;for(br in ur)yr[br]||nr.del.push(br);for(br in yr){var Pr=ur[br],pr=yr[br];Pr?Pr.src!==pr.src&&nr.change.push(pr):nr.add.push(pr)}(0<nr.del.length||0<nr.add.length||0<nr.change.length)&&Nt.change.push(nr)}}else Nt.add.push([It,Kt])}return Nt}function So(bt,Tt,It,Nt){var Ut=bt.db.createObjectStore(Tt,It.keyPath?{keyPath:It.keyPath,autoIncrement:It.auto}:{autoIncrement:It.auto});return Nt.forEach(function(Kt){return zs(Ut,Kt)}),Ut}function zl(bt,Tt){et(bt).forEach(function(It){Tt.db.objectStoreNames.contains(It)||(dr&&console.debug("Dexie: Creating missing table",It),So(Tt,It,bt[It].primKey,bt[It].indexes))})}function zs(bt,Tt){bt.createIndex(Tt.name,Tt.keyPath,{unique:Tt.unique,multiEntry:Tt.multi})}function qs(bt,Tt,It){var Nt={};return ht(Tt.objectStoreNames,0).forEach(function(Ut){for(var Kt=It.objectStore(Ut),nr=mo(Kl(br=Kt.keyPath),br||"",!0,!1,!!Kt.autoIncrement,br&&typeof br!="string",!0),ur=[],yr=0;yr<Kt.indexNames.length;++yr){var Pr=Kt.index(Kt.indexNames[yr]),br=Pr.keyPath,Pr=mo(Pr.name,br,!!Pr.unique,!!Pr.multiEntry,!1,br&&typeof br!="string",!1);ur.push(Pr)}Nt[Ut]=go(Ut,nr,ur)}),Nt}function Ys(bt,Tt,It){for(var Nt=It.db.objectStoreNames,Ut=0;Ut<Nt.length;++Ut){var Kt=Nt[Ut],nr=It.objectStore(Kt);bt._hasGetAll="getAll"in nr;for(var ur=0;ur<nr.indexNames.length;++ur){var yr=nr.indexNames[ur],br=nr.index(yr).keyPath,Pr=typeof br=="string"?br:"["+ht(br).join("+")+"]";!Tt[Kt]||(br=Tt[Kt].idxByName[Pr])&&(br.name=yr,delete Tt[Kt].idxByName[Pr],Tt[Kt].idxByName[yr]=br)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&_e.WorkerGlobalScope&&_e instanceof _e.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(bt._hasGetAll=!1)}function Yl(bt){return bt.split(",").map(function(Tt,It){var Kt=Tt.split(":"),Nt=(Ut=Kt[1])===null||Ut===void 0?void 0:Ut.trim(),Ut=(Tt=Kt[0].trim()).replace(/([&*]|\+\+)/g,""),Kt=/^\[/.test(Ut)?Ut.match(/^\[(.*)\]$/)[1].split("+"):Ut;return mo(Ut,Kt||null,/\&/.test(Tt),/\*/.test(Tt),/\+\+/.test(Tt),tt(Kt),It===0,Nt)})}var Zu=(ys.prototype._createTableSchema=go,ys.prototype._parseIndexSyntax=Yl,ys.prototype._parseStoresSpec=function(bt,Tt){var It=this;et(bt).forEach(function(Nt){if(bt[Nt]!==null){var Ut=It._parseIndexSyntax(bt[Nt]),Kt=Ut.shift();if(!Kt)throw new Wt.Schema("Invalid schema for table "+Nt+": "+bt[Nt]);if(Kt.unique=!0,Kt.multi)throw new Wt.Schema("Primary key cannot be multiEntry*");Ut.forEach(function(nr){if(nr.auto)throw new Wt.Schema("Only primary key can be marked as autoIncrement (++)");if(!nr.keyPath)throw new Wt.Schema("Index must have a name and cannot be an empty string")}),Ut=It._createTableSchema(Nt,Kt,Ut),Tt[Nt]=Ut}})},ys.prototype.stores=function(It){var Tt=this.db;this._cfg.storesSource=this._cfg.storesSource?rt(this._cfg.storesSource,It):It;var It=Tt._versions,Nt={},Ut={};return It.forEach(function(Kt){rt(Nt,Kt._cfg.storesSource),Ut=Kt._cfg.dbschema={},Kt._parseStoresSpec(Nt,Ut)}),Tt._dbSchema=Ut,vo(Tt,[Tt._allTables,Tt,Tt.Transaction.prototype]),Ws(Tt,[Tt._allTables,Tt,Tt.Transaction.prototype,this._cfg.tables],et(Ut),Ut),Tt._storeNames=et(Ut),this},ys.prototype.upgrade=function(bt){return this._cfg.contentUpgrade=lr(this._cfg.contentUpgrade||Qt,bt),this},ys);function ys(){}function Eo(bt,Tt){var It=bt._dbNamesDB;return It||(It=bt._dbNamesDB=new es(qn,{addons:[],indexedDB:bt,IDBKeyRange:Tt})).version(1).stores({dbnames:"name"}),It.table("dbnames")}function _o(bt){return bt&&typeof bt.databases=="function"}function xo(bt){return Br(function(){return cr.letThrough=!0,bt()})}function To(bt){return!("from"in bt)}var Vn=function(bt,Tt){if(!this){var It=new Vn;return bt&&"d"in bt&&rt(It,bt),It}rt(this,arguments.length?{d:1,from:bt,to:1<arguments.length?Tt:bt}:{d:0})};function Ls(bt,Tt,It){var Nt=Sn(Tt,It);if(!isNaN(Nt)){if(0<Nt)throw RangeError();if(To(bt))return rt(bt,{from:Tt,to:It,d:1});var Ut=bt.l,Nt=bt.r;if(Sn(It,bt.from)<0)return Ut?Ls(Ut,Tt,It):bt.l={from:Tt,to:It,d:1,l:null,r:null},Ql(bt);if(0<Sn(Tt,bt.to))return Nt?Ls(Nt,Tt,It):bt.r={from:Tt,to:It,d:1,l:null,r:null},Ql(bt);Sn(Tt,bt.from)<0&&(bt.from=Tt,bt.l=null,bt.d=Nt?Nt.d+1:1),0<Sn(It,bt.to)&&(bt.to=It,bt.r=null,bt.d=bt.l?bt.l.d+1:1),It=!bt.r,Ut&&!bt.l&&$s(bt,Ut),Nt&&It&&$s(bt,Nt)}}function $s(bt,Tt){To(Tt)||function It(Nt,yr){var Kt=yr.from,nr=yr.to,ur=yr.l,yr=yr.r;Ls(Nt,Kt,nr),ur&&It(Nt,ur),yr&&It(Nt,yr)}(bt,Tt)}function Xl(bt,Tt){var It=Xs(Tt),Nt=It.next();if(Nt.done)return!1;for(var Ut=Nt.value,Kt=Xs(bt),nr=Kt.next(Ut.from),ur=nr.value;!Nt.done&&!nr.done;){if(Sn(ur.from,Ut.to)<=0&&0<=Sn(ur.to,Ut.from))return!0;Sn(Ut.from,ur.from)<0?Ut=(Nt=It.next(ur.from)).value:ur=(nr=Kt.next(Ut.from)).value}return!1}function Xs(bt){var Tt=To(bt)?null:{s:0,n:bt};return{next:function(It){for(var Nt=0<arguments.length;Tt;)switch(Tt.s){case 0:if(Tt.s=1,Nt)for(;Tt.n.l&&Sn(It,Tt.n.from)<0;)Tt={up:Tt,n:Tt.n.l,s:1};else for(;Tt.n.l;)Tt={up:Tt,n:Tt.n.l,s:1};case 1:if(Tt.s=2,!Nt||Sn(It,Tt.n.to)<=0)return{value:Tt.n,done:!1};case 2:if(Tt.n.r){Tt.s=3,Tt={up:Tt,n:Tt.n.r,s:0};continue}case 3:Tt=Tt.up}return{done:!0}}}}function Ql(bt){var Tt,It,Nt=(((Tt=bt.r)===null||Tt===void 0?void 0:Tt.d)||0)-(((It=bt.l)===null||It===void 0?void 0:It.d)||0),Ut=1<Nt?"r":Nt<-1?"l":"";Ut&&(Tt=Ut=="r"?"l":"r",It=$({},bt),Nt=bt[Ut],bt.from=Nt.from,bt.to=Nt.to,bt[Ut]=Nt[Ut],It[Ut]=Nt[Tt],(bt[Tt]=It).d=Jl(It)),bt.d=Jl(bt)}function Jl(It){var Tt=It.r,It=It.l;return(Tt?It?Math.max(Tt.d,It.d):Tt.d:It?It.d:0)+1}function Qs(bt,Tt){return et(Tt).forEach(function(It){bt[It]?$s(bt[It],Tt[It]):bt[It]=function Nt(Ut){var Kt,nr,ur={};for(Kt in Ut)st(Ut,Kt)&&(nr=Ut[Kt],ur[Kt]=!nr||typeof nr!="object"||xt.has(nr.constructor)?nr:Nt(nr));return ur}(Tt[It])}),bt}function Ao(bt,Tt){return bt.all||Tt.all||Object.keys(bt).some(function(It){return Tt[It]&&Xl(Tt[It],bt[It])})}at(Vn.prototype,((Yn={add:function(bt){return $s(this,bt),this},addKey:function(bt){return Ls(this,bt,bt),this},addKeys:function(bt){var Tt=this;return bt.forEach(function(It){return Ls(Tt,It,It)}),this},hasKey:function(bt){var Tt=Xs(this).next(bt).value;return Tt&&Sn(Tt.from,bt)<=0&&0<=Sn(Tt.to,bt)}})[Pt]=function(){return Xs(this)},Yn));var cs={},Po={},wo=!1;function Js(bt){Qs(Po,bt),wo||(wo=!0,setTimeout(function(){wo=!1,Co(Po,!(Po={}))},0))}function Co(bt,Tt){Tt===void 0&&(Tt=!1);var It=new Set;if(bt.all)for(var Nt=0,Ut=Object.values(cs);Nt<Ut.length;Nt++)Zl(nr=Ut[Nt],bt,It,Tt);else for(var Kt in bt){var nr,ur=/^idb\:\/\/(.*)\/(.*)\//.exec(Kt);ur&&(Kt=ur[1],ur=ur[2],(nr=cs["idb://".concat(Kt,"/").concat(ur)])&&Zl(nr,bt,It,Tt))}It.forEach(function(yr){return yr()})}function Zl(bt,Tt,It,Nt){for(var Ut=[],Kt=0,nr=Object.entries(bt.queries.query);Kt<nr.length;Kt++){for(var ur=nr[Kt],yr=ur[0],br=[],Pr=0,pr=ur[1];Pr<pr.length;Pr++){var Ir=pr[Pr];Ao(Tt,Ir.obsSet)?Ir.subscribers.forEach(function(Cr){return It.add(Cr)}):Nt&&br.push(Ir)}Nt&&Ut.push([yr,br])}if(Nt)for(var vr=0,_r=Ut;vr<_r.length;vr++){var Rr=_r[vr],yr=Rr[0],br=Rr[1];bt.queries.query[yr]=br}}function _h(bt){var Tt=bt._state,It=bt._deps.indexedDB;if(Tt.isBeingOpened||bt.idbdb)return Tt.dbReadyPromise.then(function(){return Tt.dbOpenError?$n(Tt.dbOpenError):bt});Tt.isBeingOpened=!0,Tt.dbOpenError=null,Tt.openComplete=!1;var Nt=Tt.openCanceller,Ut=Math.round(10*bt.verno),Kt=!1;function nr(){if(Tt.openCanceller!==Nt)throw new Wt.DatabaseClosed("db.open() was cancelled")}function ur(){return new qr(function(Ir,vr){if(nr(),!It)throw new Wt.MissingAPI;var _r=bt.name,Rr=Tt.autoSchema||!Ut?It.open(_r):It.open(_r,Ut);if(!Rr)throw new Wt.MissingAPI;Rr.onerror=Jn(vr),Rr.onblocked=Xt(bt._fireOnBlocked),Rr.onupgradeneeded=Xt(function(Cr){var $r;Pr=Rr.transaction,Tt.autoSchema&&!bt._options.allowEmptyDB?(Rr.onerror=Cs,Pr.abort(),Rr.result.close(),($r=It.deleteDatabase(_r)).onsuccess=$r.onerror=Xt(function(){vr(new Wt.NoSuchDatabase("Database ".concat(_r," doesnt exist")))})):(Pr.onerror=Jn(vr),Cr=Cr.oldVersion>Math.pow(2,62)?0:Cr.oldVersion,pr=Cr<1,bt.idbdb=Rr.result,Kt&&Ju(bt,Pr),Qu(bt,Cr/10,Pr,vr))},vr),Rr.onsuccess=Xt(function(){Pr=null;var Cr,$r,Vr,Wr,zr,Zr=bt.idbdb=Rr.result,cn=ht(Zr.objectStoreNames);if(0<cn.length)try{var tn=Zr.transaction((Wr=cn).length===1?Wr[0]:Wr,"readonly");if(Tt.autoSchema)$r=Zr,Vr=tn,(Cr=bt).verno=$r.version/10,Vr=Cr._dbSchema=qs(0,$r,Vr),Cr._storeNames=ht($r.objectStoreNames,0),Ws(Cr,[Cr._allTables],et(Vr),Vr);else if(Ys(bt,bt._dbSchema,tn),((zr=bo(qs(0,(zr=bt).idbdb,tn),zr._dbSchema)).add.length||zr.change.some(function(sn){return sn.add.length||sn.change.length}))&&!Kt)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Zr.close(),Ut=Zr.version+1,Kt=!0,Ir(ur());Ks(bt,tn)}catch{}zn.push(bt),Zr.onversionchange=Xt(function(sn){Tt.vcFired=!0,bt.on("versionchange").fire(sn)}),Zr.onclose=Xt(function(sn){bt.on("close").fire(sn)}),pr&&(zr=bt._deps,tn=_r,Zr=zr.indexedDB,zr=zr.IDBKeyRange,_o(Zr)||tn===qn||Eo(Zr,zr).put({name:tn}).catch(Qt)),Ir()},vr)}).catch(function(Ir){switch(Ir==null?void 0:Ir.name){case"UnknownError":if(0<Tt.PR1398_maxLoop)return Tt.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),ur();break;case"VersionError":if(0<Ut)return Ut=0,ur()}return qr.reject(Ir)})}var yr,br=Tt.dbReadyResolve,Pr=null,pr=!1;return qr.race([Nt,(typeof navigator>"u"?qr.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Ir){function vr(){return indexedDB.databases().finally(Ir)}yr=setInterval(vr,100),vr()}).finally(function(){return clearInterval(yr)}):Promise.resolve()).then(ur)]).then(function(){return nr(),Tt.onReadyBeingFired=[],qr.resolve(xo(function(){return bt.on.ready.fire(bt.vip)})).then(function Ir(){if(0<Tt.onReadyBeingFired.length){var vr=Tt.onReadyBeingFired.reduce(lr,Qt);return Tt.onReadyBeingFired=[],qr.resolve(xo(function(){return vr(bt.vip)})).then(Ir)}})}).finally(function(){Tt.openCanceller===Nt&&(Tt.onReadyBeingFired=null,Tt.isBeingOpened=!1)}).catch(function(Ir){Tt.dbOpenError=Ir;try{Pr&&Pr.abort()}catch{}return Nt===Tt.openCanceller&&bt._close(),$n(Ir)}).finally(function(){Tt.openComplete=!0,br()}).then(function(){var Ir;return pr&&(Ir={},bt.tables.forEach(function(vr){vr.schema.indexes.forEach(function(_r){_r.name&&(Ir["idb://".concat(bt.name,"/").concat(vr.name,"/").concat(_r.name)]=new Vn(-1/0,[[[]]]))}),Ir["idb://".concat(bt.name,"/").concat(vr.name,"/")]=Ir["idb://".concat(bt.name,"/").concat(vr.name,"/:dels")]=new Vn(-1/0,[[[]]])}),os(Rs).fire(Ir),Co(Ir,!0)),bt})}function Ro(bt){function Tt(Kt){return bt.next(Kt)}var It=Ut(Tt),Nt=Ut(function(Kt){return bt.throw(Kt)});function Ut(Kt){return function(yr){var ur=Kt(yr),yr=ur.value;return ur.done?yr:yr&&typeof yr.then=="function"?yr.then(It,Nt):tt(yr)?Promise.all(yr).then(It,Nt):It(yr)}}return Ut(Tt)()}function Zs(bt,Tt,It){for(var Nt=tt(bt)?bt.slice():[bt],Ut=0;Ut<It;++Ut)Nt.push(Tt);return Nt}var _f={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(bt){return $($({},bt),{table:function(Tt){var It=bt.table(Tt),Nt=It.schema,Ut={},Kt=[];function nr(pr,Ir,vr){var _r=ks(pr),Rr=Ut[_r]=Ut[_r]||[],Cr=pr==null?0:typeof pr=="string"?1:pr.length,$r=0<Ir,$r=$($({},vr),{name:$r?"".concat(_r,"(virtual-from:").concat(vr.name,")"):vr.name,lowLevelIndex:vr,isVirtual:$r,keyTail:Ir,keyLength:Cr,extractKey:yo(pr),unique:!$r&&vr.unique});return Rr.push($r),$r.isPrimaryKey||Kt.push($r),1<Cr&&nr(Cr===2?pr[0]:pr.slice(0,Cr-1),Ir+1,vr),Rr.sort(function(Vr,Wr){return Vr.keyTail-Wr.keyTail}),$r}Tt=nr(Nt.primaryKey.keyPath,0,Nt.primaryKey),Ut[":id"]=[Tt];for(var ur=0,yr=Nt.indexes;ur<yr.length;ur++){var br=yr[ur];nr(br.keyPath,0,br)}function Pr(pr){var Ir,vr=pr.query.index;return vr.isVirtual?$($({},pr),{query:{index:vr.lowLevelIndex,range:(Ir=pr.query.range,vr=vr.keyTail,{type:Ir.type===1?2:Ir.type,lower:Zs(Ir.lower,Ir.lowerOpen?bt.MAX_KEY:bt.MIN_KEY,vr),lowerOpen:!0,upper:Zs(Ir.upper,Ir.upperOpen?bt.MIN_KEY:bt.MAX_KEY,vr),upperOpen:!0})}}):pr}return $($({},It),{schema:$($({},Nt),{primaryKey:Tt,indexes:Kt,getIndexByKeyPath:function(pr){return(pr=Ut[ks(pr)])&&pr[0]}}),count:function(pr){return It.count(Pr(pr))},query:function(pr){return It.query(Pr(pr))},openCursor:function(pr){var Ir=pr.query.index,vr=Ir.keyTail,_r=Ir.isVirtual,Rr=Ir.keyLength;return _r?It.openCursor(Pr(pr)).then(function($r){return $r&&Cr($r)}):It.openCursor(pr);function Cr($r){return Object.create($r,{continue:{value:function(Vr){Vr!=null?$r.continue(Zs(Vr,pr.reverse?bt.MAX_KEY:bt.MIN_KEY,vr)):pr.unique?$r.continue($r.key.slice(0,Rr).concat(pr.reverse?bt.MIN_KEY:bt.MAX_KEY,vr)):$r.continue()}},continuePrimaryKey:{value:function(Vr,Wr){$r.continuePrimaryKey(Zs(Vr,bt.MAX_KEY,vr),Wr)}},primaryKey:{get:function(){return $r.primaryKey}},key:{get:function(){var Vr=$r.key;return Rr===1?Vr[0]:Vr.slice(0,Rr)}},value:{get:function(){return $r.value}}})}}})}})}};function Io(bt,Tt,It,Nt){return It=It||{},Nt=Nt||"",et(bt).forEach(function(Ut){var Kt,nr,ur;st(Tt,Ut)?(Kt=bt[Ut],nr=Tt[Ut],typeof Kt=="object"&&typeof nr=="object"&&Kt&&nr?(ur=Ft(Kt))!==Ft(nr)?It[Nt+Ut]=Tt[Ut]:ur==="Object"?Io(Kt,nr,It,Nt+Ut+"."):Kt!==nr&&(It[Nt+Ut]=Tt[Ut]):Kt!==nr&&(It[Nt+Ut]=Tt[Ut])):It[Nt+Ut]=void 0}),et(Tt).forEach(function(Ut){st(bt,Ut)||(It[Nt+Ut]=Tt[Ut])}),It}function ko(bt,Tt){return Tt.type==="delete"?Tt.keys:Tt.keys||Tt.values.map(bt.extractKey)}var _d={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(bt){return $($({},bt),{table:function(Tt){var It=bt.table(Tt),Nt=It.schema.primaryKey;return $($({},It),{mutate:function(Ut){var Kt=cr.trans,nr=Kt.table(Tt).hook,ur=nr.deleting,yr=nr.creating,br=nr.updating;switch(Ut.type){case"add":if(yr.fire===Qt)break;return Kt._promise("readwrite",function(){return Pr(Ut)},!0);case"put":if(yr.fire===Qt&&br.fire===Qt)break;return Kt._promise("readwrite",function(){return Pr(Ut)},!0);case"delete":if(ur.fire===Qt)break;return Kt._promise("readwrite",function(){return Pr(Ut)},!0);case"deleteRange":if(ur.fire===Qt)break;return Kt._promise("readwrite",function(){return function pr(Ir,vr,_r){return It.query({trans:Ir,values:!1,query:{index:Nt,range:vr},limit:_r}).then(function(Rr){var Cr=Rr.result;return Pr({type:"delete",keys:Cr,trans:Ir}).then(function($r){return 0<$r.numFailures?Promise.reject($r.failures[0]):Cr.length<_r?{failures:[],numFailures:0,lastResult:void 0}:pr(Ir,$($({},vr),{lower:Cr[Cr.length-1],lowerOpen:!0}),_r)})})}(Ut.trans,Ut.range,1e4)},!0)}return It.mutate(Ut);function Pr(pr){var Ir,vr,_r,Rr=cr.trans,Cr=pr.keys||ko(Nt,pr);if(!Cr)throw new Error("Keys missing");return(pr=pr.type==="add"||pr.type==="put"?$($({},pr),{keys:Cr}):$({},pr)).type!=="delete"&&(pr.values=j([],pr.values)),pr.keys&&(pr.keys=j([],pr.keys)),Ir=It,_r=Cr,((vr=pr).type==="add"?Promise.resolve([]):Ir.getMany({trans:vr.trans,keys:_r,cache:"immutable"})).then(function($r){var Vr=Cr.map(function(Wr,zr){var Zr,cn,tn,sn=$r[zr],pn={onerror:null,onsuccess:null};return pr.type==="delete"?ur.fire.call(pn,Wr,sn,Rr):pr.type==="add"||sn===void 0?(Zr=yr.fire.call(pn,Wr,pr.values[zr],Rr),Wr==null&&Zr!=null&&(pr.keys[zr]=Wr=Zr,Nt.outbound||gt(pr.values[zr],Nt.keyPath,Wr))):(Zr=Io(sn,pr.values[zr]),(cn=br.fire.call(pn,Zr,Wr,sn,Rr))&&(tn=pr.values[zr],Object.keys(cn).forEach(function(fn){st(tn,fn)?tn[fn]=cn[fn]:gt(tn,fn,cn[fn])}))),pn});return It.mutate(pr).then(function(Wr){for(var zr=Wr.failures,Zr=Wr.results,cn=Wr.numFailures,Wr=Wr.lastResult,tn=0;tn<Cr.length;++tn){var sn=(Zr||Cr)[tn],pn=Vr[tn];sn==null?pn.onerror&&pn.onerror(zr[tn]):pn.onsuccess&&pn.onsuccess(pr.type==="put"&&$r[tn]?pr.values[tn]:sn)}return{failures:zr,results:Zr,numFailures:cn,lastResult:Wr}}).catch(function(Wr){return Vr.forEach(function(zr){return zr.onerror&&zr.onerror(Wr)}),Promise.reject(Wr)})})}}})}})}};function _c(bt,Tt,It){try{if(!Tt||Tt.keys.length<bt.length)return null;for(var Nt=[],Ut=0,Kt=0;Ut<Tt.keys.length&&Kt<bt.length;++Ut)Sn(Tt.keys[Ut],bt[Kt])===0&&(Nt.push(It?Ot(Tt.values[Ut]):Tt.values[Ut]),++Kt);return Nt.length===bt.length?Nt:null}catch{return null}}var ep={stack:"dbcore",level:-1,create:function(bt){return{table:function(Tt){var It=bt.table(Tt);return $($({},It),{getMany:function(Nt){if(!Nt.cache)return It.getMany(Nt);var Ut=_c(Nt.keys,Nt.trans._cache,Nt.cache==="clone");return Ut?qr.resolve(Ut):It.getMany(Nt).then(function(Kt){return Nt.trans._cache={keys:Nt.keys,values:Nt.cache==="clone"?Ot(Kt):Kt},Kt})},mutate:function(Nt){return Nt.type!=="add"&&(Nt.trans._cache=null),It.mutate(Nt)}})}}}};function eu(bt,Tt){return bt.trans.mode==="readonly"&&!!bt.subscr&&!bt.trans.explicit&&bt.trans.db._options.cache!=="disabled"&&!Tt.schema.primaryKey.outbound}function tu(bt,Tt){switch(bt){case"query":return Tt.values&&!Tt.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var tp={stack:"dbcore",level:0,name:"Observability",create:function(bt){var Tt=bt.schema.name,It=new Vn(bt.MIN_KEY,bt.MAX_KEY);return $($({},bt),{transaction:function(Nt,Ut,Kt){if(cr.subscr&&Ut!=="readonly")throw new Wt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(cr.querier));return bt.transaction(Nt,Ut,Kt)},table:function(Nt){var Ut=bt.table(Nt),Kt=Ut.schema,nr=Kt.primaryKey,pr=Kt.indexes,ur=nr.extractKey,yr=nr.outbound,br=nr.autoIncrement&&pr.filter(function(vr){return vr.compound&&vr.keyPath.includes(nr.keyPath)}),Pr=$($({},Ut),{mutate:function(vr){function _r(fn){return fn="idb://".concat(Tt,"/").concat(Nt,"/").concat(fn),Wr[fn]||(Wr[fn]=new Vn)}var Rr,Cr,$r,Vr=vr.trans,Wr=vr.mutatedParts||(vr.mutatedParts={}),zr=_r(""),Zr=_r(":dels"),cn=vr.type,pn=vr.type==="deleteRange"?[vr.range]:vr.type==="delete"?[vr.keys]:vr.values.length<50?[ko(nr,vr).filter(function(fn){return fn}),vr.values]:[],tn=pn[0],sn=pn[1],pn=vr.trans._cache;return tt(tn)?(zr.addKeys(tn),(pn=cn==="delete"||tn.length===sn.length?_c(tn,pn):null)||Zr.addKeys(tn),(pn||sn)&&(Rr=_r,Cr=pn,$r=sn,Kt.indexes.forEach(function(fn){var mn=Rr(fn.name||"");function wn(Pn){return Pn!=null?fn.extractKey(Pn):null}function kn(Pn){return fn.multiEntry&&tt(Pn)?Pn.forEach(function(Mn){return mn.addKey(Mn)}):mn.addKey(Pn)}(Cr||$r).forEach(function(Pn,Gn){var An=Cr&&wn(Cr[Gn]),Gn=$r&&wn($r[Gn]);Sn(An,Gn)!==0&&(An!=null&&kn(An),Gn!=null&&kn(Gn))})}))):tn?(sn={from:(sn=tn.lower)!==null&&sn!==void 0?sn:bt.MIN_KEY,to:(sn=tn.upper)!==null&&sn!==void 0?sn:bt.MAX_KEY},Zr.add(sn),zr.add(sn)):(zr.add(It),Zr.add(It),Kt.indexes.forEach(function(fn){return _r(fn.name).add(It)})),Ut.mutate(vr).then(function(fn){return!tn||vr.type!=="add"&&vr.type!=="put"||(zr.addKeys(fn.results),br&&br.forEach(function(mn){for(var wn=vr.values.map(function(An){return mn.extractKey(An)}),kn=mn.keyPath.findIndex(function(An){return An===nr.keyPath}),Pn=0,Mn=fn.results.length;Pn<Mn;++Pn)wn[Pn][kn]=fn.results[Pn];_r(mn.name).addKeys(wn)})),Vr.mutatedParts=Qs(Vr.mutatedParts||{},Wr),fn})}}),pr=function(_r){var Rr=_r.query,_r=Rr.index,Rr=Rr.range;return[_r,new Vn((_r=Rr.lower)!==null&&_r!==void 0?_r:bt.MIN_KEY,(Rr=Rr.upper)!==null&&Rr!==void 0?Rr:bt.MAX_KEY)]},Ir={get:function(vr){return[nr,new Vn(vr.key)]},getMany:function(vr){return[nr,new Vn().addKeys(vr.keys)]},count:pr,query:pr,openCursor:pr};return et(Ir).forEach(function(vr){Pr[vr]=function(_r){var Rr=cr.subscr,Cr=!!Rr,$r=eu(cr,Ut)&&tu(vr,_r)?_r.obsSet={}:Rr;if(Cr){var Vr=function(sn){return sn="idb://".concat(Tt,"/").concat(Nt,"/").concat(sn),$r[sn]||($r[sn]=new Vn)},Wr=Vr(""),zr=Vr(":dels"),Rr=Ir[vr](_r),Cr=Rr[0],Rr=Rr[1];if((vr==="query"&&Cr.isPrimaryKey&&!_r.values?zr:Vr(Cr.name||"")).add(Rr),!Cr.isPrimaryKey){if(vr!=="count"){var Zr=vr==="query"&&yr&&_r.values&&Ut.query($($({},_r),{values:!1}));return Ut[vr].apply(this,arguments).then(function(sn){if(vr==="query"){if(yr&&_r.values)return Zr.then(function(wn){return wn=wn.result,Wr.addKeys(wn),sn});var pn=_r.values?sn.result.map(ur):sn.result;(_r.values?Wr:zr).addKeys(pn)}else if(vr==="openCursor"){var fn=sn,mn=_r.values;return fn&&Object.create(fn,{key:{get:function(){return zr.addKey(fn.primaryKey),fn.key}},primaryKey:{get:function(){var wn=fn.primaryKey;return zr.addKey(wn),wn}},value:{get:function(){return mn&&Wr.addKey(fn.primaryKey),fn.value}}})}return sn})}zr.add(It)}}return Ut[vr].apply(this,arguments)}}),Pr}})}};function ru(bt,Tt,It){if(It.numFailures===0)return Tt;if(Tt.type==="deleteRange")return null;var Nt=Tt.keys?Tt.keys.length:"values"in Tt&&Tt.values?Tt.values.length:1;return It.numFailures===Nt?null:(Tt=$({},Tt),tt(Tt.keys)&&(Tt.keys=Tt.keys.filter(function(Ut,Kt){return!(Kt in It.failures)})),"values"in Tt&&tt(Tt.values)&&(Tt.values=Tt.values.filter(function(Ut,Kt){return!(Kt in It.failures)})),Tt)}function Lo(bt,Tt){return It=bt,((Nt=Tt).lower===void 0||(Nt.lowerOpen?0<Sn(It,Nt.lower):0<=Sn(It,Nt.lower)))&&(bt=bt,(Tt=Tt).upper===void 0||(Tt.upperOpen?Sn(bt,Tt.upper)<0:Sn(bt,Tt.upper)<=0));var It,Nt}function nu(bt,Tt,Ir,Nt,Ut,Kt){if(!Ir||Ir.length===0)return bt;var nr=Tt.query.index,ur=nr.multiEntry,yr=Tt.query.range,br=Nt.schema.primaryKey.extractKey,Pr=nr.extractKey,pr=(nr.lowLevelIndex||nr).extractKey,Ir=Ir.reduce(function(vr,_r){var Rr=vr,Cr=[];if(_r.type==="add"||_r.type==="put")for(var $r=new Vn,Vr=_r.values.length-1;0<=Vr;--Vr){var Wr,zr=_r.values[Vr],Zr=br(zr);$r.hasKey(Zr)||(Wr=Pr(zr),(ur&&tt(Wr)?Wr.some(function(fn){return Lo(fn,yr)}):Lo(Wr,yr))&&($r.addKey(Zr),Cr.push(zr)))}switch(_r.type){case"add":var cn=new Vn().addKeys(Tt.values?vr.map(function(mn){return br(mn)}):vr),Rr=vr.concat(Tt.values?Cr.filter(function(mn){return mn=br(mn),!cn.hasKey(mn)&&(cn.addKey(mn),!0)}):Cr.map(function(mn){return br(mn)}).filter(function(mn){return!cn.hasKey(mn)&&(cn.addKey(mn),!0)}));break;case"put":var tn=new Vn().addKeys(_r.values.map(function(mn){return br(mn)}));Rr=vr.filter(function(mn){return!tn.hasKey(Tt.values?br(mn):mn)}).concat(Tt.values?Cr:Cr.map(function(mn){return br(mn)}));break;case"delete":var sn=new Vn().addKeys(_r.keys);Rr=vr.filter(function(mn){return!sn.hasKey(Tt.values?br(mn):mn)});break;case"deleteRange":var pn=_r.range;Rr=vr.filter(function(mn){return!Lo(br(mn),pn)})}return Rr},bt);return Ir===bt?bt:(Ir.sort(function(vr,_r){return Sn(pr(vr),pr(_r))||Sn(br(vr),br(_r))}),Tt.limit&&Tt.limit<1/0&&(Ir.length>Tt.limit?Ir.length=Tt.limit:bt.length===Tt.limit&&Ir.length<Tt.limit&&(Ut.dirty=!0)),Kt?Object.freeze(Ir):Ir)}function iu(bt,Tt){return Sn(bt.lower,Tt.lower)===0&&Sn(bt.upper,Tt.upper)===0&&!!bt.lowerOpen==!!Tt.lowerOpen&&!!bt.upperOpen==!!Tt.upperOpen}function rp(bt,Tt){return function(It,Nt,Ut,Kt){if(It===void 0)return Nt!==void 0?-1:0;if(Nt===void 0)return 1;if((Nt=Sn(It,Nt))===0){if(Ut&&Kt)return 0;if(Ut)return 1;if(Kt)return-1}return Nt}(bt.lower,Tt.lower,bt.lowerOpen,Tt.lowerOpen)<=0&&0<=function(It,Nt,Ut,Kt){if(It===void 0)return Nt!==void 0?1:0;if(Nt===void 0)return-1;if((Nt=Sn(It,Nt))===0){if(Ut&&Kt)return 0;if(Ut)return-1;if(Kt)return 1}return Nt}(bt.upper,Tt.upper,bt.upperOpen,Tt.upperOpen)}function np(bt,Tt,It,Nt){bt.subscribers.add(It),Nt.addEventListener("abort",function(){var Ut,Kt;bt.subscribers.delete(It),bt.subscribers.size===0&&(Ut=bt,Kt=Tt,setTimeout(function(){Ut.subscribers.size===0&&Et(Kt,Ut)},3e3))})}var ip={stack:"dbcore",level:0,name:"Cache",create:function(bt){var Tt=bt.schema.name;return $($({},bt),{transaction:function(It,Nt,Ut){var Kt,nr,ur=bt.transaction(It,Nt,Ut);return Nt==="readwrite"&&(nr=(Kt=new AbortController).signal,Ut=function(yr){return function(){if(Kt.abort(),Nt==="readwrite"){for(var br=new Set,Pr=0,pr=It;Pr<pr.length;Pr++){var Ir=pr[Pr],vr=cs["idb://".concat(Tt,"/").concat(Ir)];if(vr){var _r=bt.table(Ir),Rr=vr.optimisticOps.filter(function(mn){return mn.trans===ur});if(ur._explicit&&yr&&ur.mutatedParts)for(var Cr=0,$r=Object.values(vr.queries.query);Cr<$r.length;Cr++)for(var Vr=0,Wr=(cn=$r[Cr]).slice();Vr<Wr.length;Vr++)Ao((tn=Wr[Vr]).obsSet,ur.mutatedParts)&&(Et(cn,tn),tn.subscribers.forEach(function(mn){return br.add(mn)}));else if(0<Rr.length){vr.optimisticOps=vr.optimisticOps.filter(function(mn){return mn.trans!==ur});for(var zr=0,Zr=Object.values(vr.queries.query);zr<Zr.length;zr++)for(var cn,tn,sn,pn=0,fn=(cn=Zr[zr]).slice();pn<fn.length;pn++)(tn=fn[pn]).res!=null&&ur.mutatedParts&&(yr&&!tn.dirty?(sn=Object.isFrozen(tn.res),sn=nu(tn.res,tn.req,Rr,_r,tn,sn),tn.dirty?(Et(cn,tn),tn.subscribers.forEach(function(mn){return br.add(mn)})):sn!==tn.res&&(tn.res=sn,tn.promise=qr.resolve({result:sn}))):(tn.dirty&&Et(cn,tn),tn.subscribers.forEach(function(mn){return br.add(mn)})))}}}br.forEach(function(mn){return mn()})}}},ur.addEventListener("abort",Ut(!1),{signal:nr}),ur.addEventListener("error",Ut(!1),{signal:nr}),ur.addEventListener("complete",Ut(!0),{signal:nr})),ur},table:function(It){var Nt=bt.table(It),Ut=Nt.schema.primaryKey;return $($({},Nt),{mutate:function(Kt){var nr=cr.trans;if(Ut.outbound||nr.db._options.cache==="disabled"||nr.explicit||nr.idbtrans.mode!=="readwrite")return Nt.mutate(Kt);var ur=cs["idb://".concat(Tt,"/").concat(It)];return ur?(nr=Nt.mutate(Kt),Kt.type!=="add"&&Kt.type!=="put"||!(50<=Kt.values.length||ko(Ut,Kt).some(function(yr){return yr==null}))?(ur.optimisticOps.push(Kt),Kt.mutatedParts&&Js(Kt.mutatedParts),nr.then(function(yr){0<yr.numFailures&&(Et(ur.optimisticOps,Kt),(yr=ru(0,Kt,yr))&&ur.optimisticOps.push(yr),Kt.mutatedParts&&Js(Kt.mutatedParts))}),nr.catch(function(){Et(ur.optimisticOps,Kt),Kt.mutatedParts&&Js(Kt.mutatedParts)})):nr.then(function(yr){var br=ru(0,$($({},Kt),{values:Kt.values.map(function(Pr,pr){var Ir;return yr.failures[pr]?Pr:(Pr=(Ir=Ut.keyPath)!==null&&Ir!==void 0&&Ir.includes(".")?Ot(Pr):$({},Pr),gt(Pr,Ut.keyPath,yr.results[pr]),Pr)})}),yr);ur.optimisticOps.push(br),queueMicrotask(function(){return Kt.mutatedParts&&Js(Kt.mutatedParts)})}),nr):Nt.mutate(Kt)},query:function(Kt){if(!eu(cr,Nt)||!tu("query",Kt))return Nt.query(Kt);var nr=((br=cr.trans)===null||br===void 0?void 0:br.db._options.cache)==="immutable",pr=cr,ur=pr.requery,yr=pr.signal,br=function(_r,Rr,Cr,$r){var Vr=cs["idb://".concat(_r,"/").concat(Rr)];if(!Vr)return[];if(!(Rr=Vr.queries[Cr]))return[null,!1,Vr,null];var Wr=Rr[($r.query?$r.query.index.name:null)||""];if(!Wr)return[null,!1,Vr,null];switch(Cr){case"query":var zr=Wr.find(function(Zr){return Zr.req.limit===$r.limit&&Zr.req.values===$r.values&&iu(Zr.req.query.range,$r.query.range)});return zr?[zr,!0,Vr,Wr]:[Wr.find(function(Zr){return("limit"in Zr.req?Zr.req.limit:1/0)>=$r.limit&&(!$r.values||Zr.req.values)&&rp(Zr.req.query.range,$r.query.range)}),!1,Vr,Wr];case"count":return zr=Wr.find(function(Zr){return iu(Zr.req.query.range,$r.query.range)}),[zr,!!zr,Vr,Wr]}}(Tt,It,"query",Kt),Pr=br[0],pr=br[1],Ir=br[2],vr=br[3];return Pr&&pr?Pr.obsSet=Kt.obsSet:(pr=Nt.query(Kt).then(function(_r){var Rr=_r.result;if(Pr&&(Pr.res=Rr),nr){for(var Cr=0,$r=Rr.length;Cr<$r;++Cr)Object.freeze(Rr[Cr]);Object.freeze(Rr)}else _r.result=Ot(Rr);return _r}).catch(function(_r){return vr&&Pr&&Et(vr,Pr),Promise.reject(_r)}),Pr={obsSet:Kt.obsSet,promise:pr,subscribers:new Set,type:"query",req:Kt,dirty:!1},vr?vr.push(Pr):(vr=[Pr],(Ir=Ir||(cs["idb://".concat(Tt,"/").concat(It)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Kt.query.index.name||""]=vr)),np(Pr,vr,ur,yr),Pr.promise.then(function(_r){return{result:nu(_r.result,Kt,Ir==null?void 0:Ir.optimisticOps,Nt,Pr,nr)}})}})}})}};function na(bt,Tt){return new Proxy(bt,{get:function(It,Nt,Ut){return Nt==="db"?Tt:Reflect.get(It,Nt,Ut)}})}var es=(Fn.prototype.version=function(bt){if(isNaN(bt)||bt<.1)throw new Wt.Type("Given version is not a positive number");if(bt=Math.round(10*bt)/10,this.idbdb||this._state.isBeingOpened)throw new Wt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,bt);var Tt=this._versions,It=Tt.filter(function(Nt){return Nt._cfg.version===bt})[0];return It||(It=new this.Version(bt),Tt.push(It),Tt.sort(Xu),It.stores({}),this._state.autoSchema=!1,It)},Fn.prototype._whenReady=function(bt){var Tt=this;return this.idbdb&&(this._state.openComplete||cr.letThrough||this._vip)?bt():new qr(function(It,Nt){if(Tt._state.openComplete)return Nt(new Wt.DatabaseClosed(Tt._state.dbOpenError));if(!Tt._state.isBeingOpened){if(!Tt._state.autoOpen)return void Nt(new Wt.DatabaseClosed);Tt.open().catch(Qt)}Tt._state.dbReadyPromise.then(It,Nt)}).then(bt)},Fn.prototype.use=function(bt){var Tt=bt.stack,It=bt.create,Nt=bt.level,Ut=bt.name;return Ut&&this.unuse({stack:Tt,name:Ut}),bt=this._middlewares[Tt]||(this._middlewares[Tt]=[]),bt.push({stack:Tt,create:It,level:Nt??10,name:Ut}),bt.sort(function(Kt,nr){return Kt.level-nr.level}),this},Fn.prototype.unuse=function(bt){var Tt=bt.stack,It=bt.name,Nt=bt.create;return Tt&&this._middlewares[Tt]&&(this._middlewares[Tt]=this._middlewares[Tt].filter(function(Ut){return Nt?Ut.create!==Nt:!!It&&Ut.name!==It})),this},Fn.prototype.open=function(){var bt=this;return xn(jr,function(){return _h(bt)})},Fn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var bt=this._state,Tt=zn.indexOf(this);if(0<=Tt&&zn.splice(Tt,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}bt.isBeingOpened||(bt.dbReadyPromise=new qr(function(It){bt.dbReadyResolve=It}),bt.openCanceller=new qr(function(It,Nt){bt.cancelOpen=Nt}))},Fn.prototype.close=function(It){var Tt=(It===void 0?{disableAutoOpen:!0}:It).disableAutoOpen,It=this._state;Tt?(It.isBeingOpened&&It.cancelOpen(new Wt.DatabaseClosed),this._close(),It.autoOpen=!1,It.dbOpenError=new Wt.DatabaseClosed):(this._close(),It.autoOpen=this._options.autoOpen||It.isBeingOpened,It.openComplete=!1,It.dbOpenError=null)},Fn.prototype.delete=function(bt){var Tt=this;bt===void 0&&(bt={disableAutoOpen:!0});var It=0<arguments.length&&typeof arguments[0]!="object",Nt=this._state;return new qr(function(Ut,Kt){function nr(){Tt.close(bt);var ur=Tt._deps.indexedDB.deleteDatabase(Tt.name);ur.onsuccess=Xt(function(){var yr,br,Pr;yr=Tt._deps,br=Tt.name,Pr=yr.indexedDB,yr=yr.IDBKeyRange,_o(Pr)||br===qn||Eo(Pr,yr).delete(br).catch(Qt),Ut()}),ur.onerror=Jn(Kt),ur.onblocked=Tt._fireOnBlocked}if(It)throw new Wt.InvalidArgument("Invalid closeOptions argument to db.delete()");Nt.isBeingOpened?Nt.dbReadyPromise.then(nr):nr()})},Fn.prototype.backendDB=function(){return this.idbdb},Fn.prototype.isOpen=function(){return this.idbdb!==null},Fn.prototype.hasBeenClosed=function(){var bt=this._state.dbOpenError;return bt&&bt.name==="DatabaseClosed"},Fn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Fn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Fn.prototype,"tables",{get:function(){var bt=this;return et(this._allTables).map(function(Tt){return bt._allTables[Tt]})},enumerable:!1,configurable:!0}),Fn.prototype.transaction=function(){var bt=(function(Tt,It,Nt){var Ut=arguments.length;if(Ut<2)throw new Wt.InvalidArgument("Too few arguments");for(var Kt=new Array(Ut-1);--Ut;)Kt[Ut-1]=arguments[Ut];return Nt=Kt.pop(),[Tt,At(Kt),Nt]}).apply(this,arguments);return this._transaction.apply(this,bt)},Fn.prototype._transaction=function(bt,Tt,It){var Nt=this,Ut=cr.trans;Ut&&Ut.db===this&&bt.indexOf("!")===-1||(Ut=null);var Kt,nr,ur=bt.indexOf("?")!==-1;bt=bt.replace("!","").replace("?","");try{if(nr=Tt.map(function(br){if(br=br instanceof Nt.Table?br.name:br,typeof br!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return br}),bt=="r"||bt===rs)Kt=rs;else{if(bt!="rw"&&bt!=ns)throw new Wt.InvalidArgument("Invalid transaction mode: "+bt);Kt=ns}if(Ut){if(Ut.mode===rs&&Kt===ns){if(!ur)throw new Wt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");Ut=null}Ut&&nr.forEach(function(br){if(Ut&&Ut.storeNames.indexOf(br)===-1){if(!ur)throw new Wt.SubTransaction("Table "+br+" not included in parent transaction.");Ut=null}}),ur&&Ut&&!Ut.active&&(Ut=null)}}catch(br){return Ut?Ut._promise(null,function(Pr,pr){pr(br)}):$n(br)}var yr=(function br(Pr,pr,Ir,vr,_r){return qr.resolve().then(function(){var Rr=cr.transless||cr,Cr=Pr._createTransaction(pr,Ir,Pr._dbSchema,vr);if(Cr.explicit=!0,Rr={trans:Cr,transless:Rr},vr)Cr.idbtrans=vr.idbtrans;else try{Cr.create(),Cr.idbtrans._explicit=!0,Pr._state.PR1398_maxLoop=3}catch(Wr){return Wr.name===zt.InvalidState&&Pr.isOpen()&&0<--Pr._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Pr.close({disableAutoOpen:!1}),Pr.open().then(function(){return br(Pr,pr,Ir,null,_r)})):$n(Wr)}var $r,Vr=Dt(_r);return Vr&&Kr(),Rr=qr.follow(function(){var Wr;($r=_r.call(Cr,Cr))&&(Vr?(Wr=Yr.bind(null,null),$r.then(Wr,Wr)):typeof $r.next=="function"&&typeof $r.throw=="function"&&($r=Ro($r)))},Rr),($r&&typeof $r.then=="function"?qr.resolve($r).then(function(Wr){return Cr.active?Wr:$n(new Wt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Rr.then(function(){return $r})).then(function(Wr){return vr&&Cr._resolve(),Cr._completion.then(function(){return Wr})}).catch(function(Wr){return Cr._reject(Wr),$n(Wr)})})}).bind(null,this,Kt,nr,Ut,It);return Ut?Ut._promise(Kt,yr,"lock"):cr.trans?xn(cr.transless,function(){return Nt._whenReady(yr)}):this._whenReady(yr)},Fn.prototype.table=function(bt){if(!st(this._allTables,bt))throw new Wt.InvalidTable("Table ".concat(bt," does not exist"));return this._allTables[bt]},Fn);function Fn(bt,Tt){var It=this;this._middlewares={},this.verno=0;var Nt=Fn.dependencies;this._options=Tt=$({addons:Fn.addons,autoOpen:!0,indexedDB:Nt.indexedDB,IDBKeyRange:Nt.IDBKeyRange,cache:"cloned"},Tt),this._deps={indexedDB:Tt.indexedDB,IDBKeyRange:Tt.IDBKeyRange},Nt=Tt.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var Ut,Kt,nr,ur,yr,br={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Qt,dbReadyPromise:null,cancelOpen:Qt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:Tt.autoOpen};br.dbReadyPromise=new qr(function(pr){br.dbReadyResolve=pr}),br.openCanceller=new qr(function(pr,Ir){br.cancelOpen=Ir}),this._state=br,this.name=bt,this.on=As(this,"populate","blocked","versionchange","close",{ready:[lr,Qt]}),this.once=function(pr,Ir){var vr=function(){for(var _r=[],Rr=0;Rr<arguments.length;Rr++)_r[Rr]=arguments[Rr];It.on(pr).unsubscribe(vr),Ir.apply(It,_r)};return It.on(pr,vr)},this.on.ready.subscribe=dt(this.on.ready.subscribe,function(pr){return function(Ir,vr){Fn.vip(function(){var _r,Rr=It._state;Rr.openComplete?(Rr.dbOpenError||qr.resolve().then(Ir),vr&&pr(Ir)):Rr.onReadyBeingFired?(Rr.onReadyBeingFired.push(Ir),vr&&pr(Ir)):(pr(Ir),_r=It,vr||pr(function Cr(){_r.on.ready.unsubscribe(Ir),_r.on.ready.unsubscribe(Cr)}))})}}),this.Collection=(Ut=this,Ps(Gu.prototype,function($r,Cr){this.db=Ut;var vr=On,_r=null;if(Cr)try{vr=Cr()}catch(Vr){_r=Vr}var Rr=$r._ctx,Cr=Rr.table,$r=Cr.hook.reading.fire;this._ctx={table:Cr,index:Rr.index,isPrimKey:!Rr.index||Cr.schema.primKey.keyPath&&Rr.index===Cr.schema.primKey.name,range:vr,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:_r,or:Rr.or,valueMapper:$r!==gr?$r:null}})),this.Table=(Kt=this,Ps(Fl.prototype,function(pr,Ir,vr){this.db=Kt,this._tx=vr,this.name=pr,this.schema=Ir,this.hook=Kt._allTables[pr]?Kt._allTables[pr].hook:As(null,{creating:[er,Qt],reading:[ar,gr],updating:[Gt,Qt],deleting:[sr,Qt]})})),this.Transaction=(nr=this,Ps(Wu.prototype,function(pr,Ir,vr,_r,Rr){var Cr=this;pr!=="readonly"&&Ir.forEach(function($r){$r=($r=vr[$r])===null||$r===void 0?void 0:$r.yProps,$r&&(Ir=Ir.concat($r.map(function(Vr){return Vr.updatesTable})))}),this.db=nr,this.mode=pr,this.storeNames=Ir,this.schema=vr,this.chromeTransactionDurability=_r,this.idbtrans=null,this.on=As(this,"complete","error","abort"),this.parent=Rr||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new qr(function($r,Vr){Cr._resolve=$r,Cr._reject=Vr}),this._completion.then(function(){Cr.active=!1,Cr.on.complete.fire()},function($r){var Vr=Cr.active;return Cr.active=!1,Cr.on.error.fire($r),Cr.parent?Cr.parent._reject($r):Vr&&Cr.idbtrans&&Cr.idbtrans.abort(),$n($r)})})),this.Version=(ur=this,Ps(Zu.prototype,function(pr){this.db=ur,this._cfg={version:pr,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(yr=this,Ps(Hl.prototype,function(pr,Ir,vr){if(this.db=yr,this._ctx={table:pr,index:Ir===":id"?null:Ir,or:vr},this._cmp=this._ascending=Sn,this._descending=function(_r,Rr){return Sn(Rr,_r)},this._max=function(_r,Rr){return 0<Sn(_r,Rr)?_r:Rr},this._min=function(_r,Rr){return Sn(_r,Rr)<0?_r:Rr},this._IDBKeyRange=yr._deps.IDBKeyRange,!this._IDBKeyRange)throw new Wt.MissingAPI})),this.on("versionchange",function(pr){0<pr.newVersion?console.warn("Another connection wants to upgrade database '".concat(It.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(It.name,"'. Closing db now to resume the delete request.")),It.close({disableAutoOpen:!1})}),this.on("blocked",function(pr){!pr.newVersion||pr.newVersion<pr.oldVersion?console.warn("Dexie.delete('".concat(It.name,"') was blocked")):console.warn("Upgrade '".concat(It.name,"' blocked by other connection holding version ").concat(pr.oldVersion/10))}),this._maxKey=Is(Tt.IDBKeyRange),this._createTransaction=function(pr,Ir,vr,_r){return new It.Transaction(pr,Ir,vr,It._options.chromeTransactionDurability,_r)},this._fireOnBlocked=function(pr){It.on("blocked").fire(pr),zn.filter(function(Ir){return Ir.name===It.name&&Ir!==It&&!Ir._state.vcFired}).map(function(Ir){return Ir.on("versionchange").fire(pr)})},this.use(ep),this.use(ip),this.use(tp),this.use(_f),this.use(_d);var Pr=new Proxy(this,{get:function(pr,Ir,vr){if(Ir==="_vip")return!0;if(Ir==="table")return function(Rr){return na(It.table(Rr),Pr)};var _r=Reflect.get(pr,Ir,vr);return _r instanceof Fl?na(_r,Pr):Ir==="tables"?_r.map(function(Rr){return na(Rr,Pr)}):Ir==="_createTransaction"?function(){return na(_r.apply(this,arguments),Pr)}:_r}});this.vip=Pr,Nt.forEach(function(pr){return pr(It)})}var ga,Yn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",sp=($o.prototype.subscribe=function(bt,Tt,It){return this._subscribe(bt&&typeof bt!="function"?bt:{next:bt,error:Tt,complete:It})},$o.prototype[Yn]=function(){return this},$o);function $o(bt){this._subscribe=bt}try{ga={indexedDB:_e.indexedDB||_e.mozIndexedDB||_e.webkitIndexedDB||_e.msIndexedDB,IDBKeyRange:_e.IDBKeyRange||_e.webkitIDBKeyRange}}catch{ga={indexedDB:null,IDBKeyRange:null}}function su(bt){var Tt,It=!1,Nt=new sp(function(Ut){var Kt=Dt(bt),nr,ur=!1,yr={},br={},Pr={get closed(){return ur},unsubscribe:function(){ur||(ur=!0,nr&&nr.abort(),pr&&os.storagemutated.unsubscribe(vr))}};Ut.start&&Ut.start(Pr);var pr=!1,Ir=function(){return jn(_r)},vr=function(Rr){Qs(yr,Rr),Ao(br,yr)&&Ir()},_r=function(){var Rr,Cr,$r;!ur&&ga.indexedDB&&(yr={},Rr={},nr&&nr.abort(),nr=new AbortController,$r=function(Vr){var Wr=Yt();try{Kt&&Kr();var zr=Br(bt,Vr);return zr=Kt?zr.finally(Yr):zr}finally{Wr&&hr()}}(Cr={subscr:Rr,signal:nr.signal,requery:Ir,querier:bt,trans:null}),Promise.resolve($r).then(function(Vr){It=!0,Tt=Vr,ur||Cr.signal.aborted||(yr={},function(Wr){for(var zr in Wr)if(st(Wr,zr))return;return 1}(br=Rr)||pr||(os(Rs,vr),pr=!0),jn(function(){return!ur&&Ut.next&&Ut.next(Vr)}))},function(Vr){It=!1,["DatabaseClosedError","AbortError"].includes(Vr==null?void 0:Vr.name)||ur||jn(function(){ur||Ut.error&&Ut.error(Vr)})}))};return setTimeout(Ir,0),Pr});return Nt.hasValue=function(){return It},Nt.getValue=function(){return Tt},Nt}var us=es;function Oo(bt){var Tt=ls;try{ls=!0,os.storagemutated.fire(bt),Co(bt,!0)}finally{ls=Tt}}at(us,$($({},or),{delete:function(bt){return new us(bt,{addons:[]}).delete()},exists:function(bt){return new us(bt,{addons:[]}).open().then(function(Tt){return Tt.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(bt){try{return Tt=us.dependencies,It=Tt.indexedDB,Tt=Tt.IDBKeyRange,(_o(It)?Promise.resolve(It.databases()).then(function(Nt){return Nt.map(function(Ut){return Ut.name}).filter(function(Ut){return Ut!==qn})}):Eo(It,Tt).toCollection().primaryKeys()).then(bt)}catch{return $n(new Wt.MissingAPI)}var Tt,It},defineClass:function(){return function(bt){rt(this,bt)}},ignoreTransaction:function(bt){return cr.trans?xn(cr.transless,bt):bt()},vip:xo,async:function(bt){return function(){try{var Tt=Ro(bt.apply(this,arguments));return Tt&&typeof Tt.then=="function"?Tt:qr.resolve(Tt)}catch(It){return $n(It)}}},spawn:function(bt,Tt,It){try{var Nt=Ro(bt.apply(It,Tt||[]));return Nt&&typeof Nt.then=="function"?Nt:qr.resolve(Nt)}catch(Ut){return $n(Ut)}},currentTransaction:{get:function(){return cr.trans||null}},waitFor:function(bt,Tt){return Tt=qr.resolve(typeof bt=="function"?us.ignoreTransaction(bt):bt).timeout(Tt||6e4),cr.trans?cr.trans.waitFor(Tt):Tt},Promise:qr,debug:{get:function(){return dr},set:function(bt){xr(bt)}},derive:ct,extend:rt,props:at,override:dt,Events:As,on:os,liveQuery:su,extendObservabilitySet:Qs,getByKeyPath:yt,setByKeyPath:gt,delByKeyPath:function(bt,Tt){typeof Tt=="string"?gt(bt,Tt,void 0):"length"in Tt&&[].map.call(Tt,function(It){gt(bt,It,void 0)})},shallowClone:vt,deepClone:Ot,getObjectDiff:Io,cmp:Sn,asap:pt,minKey:-1/0,addons:[],connections:zn,errnames:zt,dependencies:ga,cache:cs,semVer:"4.2.0",version:"4.2.0".split(".").map(function(bt){return parseInt(bt)}).reduce(function(bt,Tt,It){return bt+Tt/Math.pow(10,2*It)})})),us.maxKey=Is(us.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(os(Rs,function(bt){ls||(bt=new CustomEvent(po,{detail:bt}),ls=!0,dispatchEvent(bt),ls=!1)}),addEventListener(po,function(bt){bt=bt.detail,ls||Oo(bt)}));var vs,ls=!1,au=function(){};return typeof BroadcastChannel<"u"&&((au=function(){(vs=new BroadcastChannel(po)).onmessage=function(bt){return bt.data&&Oo(bt.data)}})(),typeof vs.unref=="function"&&vs.unref(),os(Rs,function(bt){ls||vs.postMessage(bt)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(bt){if(!es.disableBfCache&&bt.persisted){dr&&console.debug("Dexie: handling persisted pagehide"),vs!=null&&vs.close();for(var Tt=0,It=zn;Tt<It.length;Tt++)It[Tt].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(bt){!es.disableBfCache&&bt.persisted&&(dr&&console.debug("Dexie: handling persisted pageshow"),au(),Oo({all:new Vn(-1/0,[[]])}))})),qr.rejectionMapper=function(bt,Tt){return!bt||bt instanceof Ct||bt instanceof TypeError||bt instanceof SyntaxError||!bt.name||!ir[bt.name]?bt:(Tt=new ir[bt.name](Tt||bt.message,bt),"stack"in bt&&lt(Tt,"stack",{get:function(){return this.inner.stack}}),Tt)},xr(dr),$(es,Object.freeze({__proto__:null,Dexie:es,liveQuery:su,Entity:ss,cmp:Sn,PropModification:ws,replacePrefix:function(bt,Tt){return new ws({replacePrefix:[bt,Tt]})},add:function(bt){return new ws({add:bt})},remove:function(bt){return new ws({remove:bt})},default:es,RangeSet:Vn,mergeRanges:$s,rangesOverlap:Xl}),{default:es}),es})})(dexie_min);var dexie_minExports=dexie_min.exports;const _Dexie=getDefaultExportFromCjs$1(dexie_minExports),DexieSymbol=Symbol.for("Dexie"),Dexie=globalThis[DexieSymbol]||(globalThis[DexieSymbol]=_Dexie);if(_Dexie.semVer!==Dexie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);const{liveQuery,mergeRanges,rangesOverlap,RangeSet,cmp,Entity,PropModification,replacePrefix,add,remove:remove$1,DexieYProvider}=Dexie;class StudyForgeDB extends Dexie{constructor(){super("StudyForgeDB");Rn(this,"media");Rn(this,"notes");Rn(this,"progress");Rn(this,"quizzes");Rn(this,"questions");Rn(this,"attempts");Rn(this,"annotations");Rn(this,"settings");Rn(this,"contentBundles");this.version(1).stores({media:"id, lesson_id, type, last_updated",notes:"id, user_id, lesson_id, last_updated",progress:"id, user_id, lesson_id, completed, percentage, last_updated",quizzes:"id, lesson_id, last_updated",questions:"id, quiz_id, last_updated",attempts:"id, quiz_id, user_id, last_updated",annotations:"id, lesson_id, user_id, page, last_updated",settings:"key",contentBundles:"id, last_updated"})}}const db=new StudyForgeDB;function VideoPlayer({src:o,captionUrl:i,lessonId:_}){const $=reactExports.useRef(null);return reactExports.useEffect(()=>{const j=$.current;let _e=null;Hls.isSupported()&&o.endsWith(".m3u8")?(_e=new Hls,_e.loadSource(o),_e.attachMedia(j)):j.src=o;const et=async()=>{if(!_)return;const rt=await db.progress.where("lesson_id").equals(_).first();rt!=null&&rt.last_position_seconds&&(j.currentTime=rt.last_position_seconds)},tt=async()=>{_&&await db.progress.put({id:_,user_id:"local",lesson_id:_,completed:!1,percentage:j.currentTime/(j.duration||1)*100,last_position_seconds:j.currentTime,last_updated:new Date().toISOString()})};return et(),j.addEventListener("timeupdate",tt),()=>{j.removeEventListener("timeupdate",tt),_e==null||_e.destroy()}},[o,_]),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("video",{ref:$,className:"h-auto w-full rounded-xl bg-black",controls:!0,playsInline:!0}),i&&jsxRuntimeExports.jsx("track",{src:i,kind:"captions",label:"ar",default:!0})]})}function AudioPlayer({src:o}){const i=reactExports.useRef(null),[_,$]=reactExports.useState(1);return reactExports.useEffect(()=>{i.current&&(i.current.playbackRate=_)},[_]),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("audio",{ref:i,src:o,controls:!0,className:"w-full"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>{i.current&&(i.current.currentTime-=15)},children:"-15s"}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>{i.current&&(i.current.currentTime+=15)},children:"+15s"}),jsxRuntimeExports.jsx("label",{className:"ml-auto text-sm text-muted",children:""}),jsxRuntimeExports.jsx("select",{className:"btn btn-secondary",value:_,onChange:j=>$(parseFloat(j.target.value)),children:[.75,1,1.25,1.5,1.75,2].map(j=>jsxRuntimeExports.jsxs("option",{value:j,children:[j,"x"]},j))})]})]})}function commonjsRequire(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$3={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,_){module.exports=i.pdfjsLib=_()})(globalThis,()=>(()=>{var __webpack_modules__=[,(o,i)=>{var _n;Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PromiseCapability=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationReplyType=i.AnnotationPrefix=i.AnnotationMode=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=_t,i.bytesToString=or,i.createValidAbsoluteUrl=Dt,i.getModificationDate=Gr,i.getUuid=an,i.getVerbosityLevel=Ft,i.info=Pt,i.isArrayBuffer=fr,i.isArrayEqual=Hr,i.isNodeJS=void 0,i.normalizeUnicode=Jr,i.objectFromMap=Ar,i.objectSize=ar,i.setVerbosityLevel=Bt,i.shadow=Lt,i.string32=gr,i.stringToBytes=Qt,i.stringToPDFString=xr,i.stringToUTF8String=Mr,i.unreachable=Et,i.utf8StringToString=Or,i.warn=Rt;const _=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=_;const $=[1,0,0,1,0,0];i.IDENTITY_MATRIX=$;const j=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=j;const _e=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=_e;const et=1.35;i.LINE_FACTOR=et;const tt=.35;i.LINE_DESCENT_FACTOR=tt;const rt=tt/et;i.BASELINE_FACTOR=rt;const nt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=nt;const it={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=it;const st="pdfjs_internal_editor_";i.AnnotationEditorPrefix=st;const at={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};i.AnnotationEditorType=at;const ot={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};i.AnnotationEditorParamsType=ot;const lt={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=lt;const ct={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=ct;const ft={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=ft;const ut={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=ut;const ht={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=ht;const dt={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=dt;const mt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=mt;const pt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=pt;const yt={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=yt;const gt={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=gt;const vt={O:"PageOpen",C:"PageClose"};i.PageActionEventType=vt;const St={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=St;const At={NONE:0,BINARY:1};i.CMapCompressionType=At;const xt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=xt;const wt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=wt;let Ot=St.WARNINGS;function Bt(jr){Number.isInteger(jr)&&(Ot=jr)}function Ft(){return Ot}function Pt(jr){Ot>=St.INFOS&&console.log(`Info: ${jr}`)}function Rt(jr){Ot>=St.WARNINGS&&console.log(`Warning: ${jr}`)}function Et(jr){throw new Error(jr)}function _t(jr,cr){jr||Et(cr)}function Mt(jr){switch(jr==null?void 0:jr.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Dt(jr,cr=null,Sr=null){if(!jr)return null;try{if(Sr&&typeof jr=="string"){if(Sr.addDefaultProtocol&&jr.startsWith("www.")){const bn=jr.match(/\./g);(bn==null?void 0:bn.length)>=2&&(jr=`http://${jr}`)}if(Sr.tryConvertEncoding)try{jr=Mr(jr)}catch{}}const en=cr?new URL(jr,cr):new URL(jr);if(Mt(en))return en}catch{}return null}function Lt(jr,cr,Sr,en=!1){return Object.defineProperty(jr,cr,{value:Sr,enumerable:!en,configurable:!0,writable:!1}),Sr}const Ct=function(){function cr(Sr,en){this.constructor===cr&&Et("Cannot initialize BaseException."),this.message=Sr,this.name=en}return cr.prototype=new Error,cr.constructor=cr,cr}();i.BaseException=Ct;class kt extends Ct{constructor(cr,Sr){super(cr,"PasswordException"),this.code=Sr}}i.PasswordException=kt;class jt extends Ct{constructor(cr,Sr){super(cr,"UnknownErrorException"),this.details=Sr}}i.UnknownErrorException=jt;class Vt extends Ct{constructor(cr){super(cr,"InvalidPDFException")}}i.InvalidPDFException=Vt;class zt extends Ct{constructor(cr){super(cr,"MissingPDFException")}}i.MissingPDFException=zt;class qt extends Ct{constructor(cr,Sr){super(cr,"UnexpectedResponseException"),this.status=Sr}}i.UnexpectedResponseException=qt;class Wt extends Ct{constructor(cr){super(cr,"FormatError")}}i.FormatError=Wt;class ir extends Ct{constructor(cr){super(cr,"AbortException")}}i.AbortException=ir;function or(jr){(typeof jr!="object"||(jr==null?void 0:jr.length)===void 0)&&Et("Invalid argument for bytesToString");const cr=jr.length,Sr=8192;if(cr<Sr)return String.fromCharCode.apply(null,jr);const en=[];for(let bn=0;bn<cr;bn+=Sr){const qr=Math.min(bn+Sr,cr),rr=jr.subarray(bn,qr);en.push(String.fromCharCode.apply(null,rr))}return en.join("")}function Qt(jr){typeof jr!="string"&&Et("Invalid argument for stringToBytes");const cr=jr.length,Sr=new Uint8Array(cr);for(let en=0;en<cr;++en)Sr[en]=jr.charCodeAt(en)&255;return Sr}function gr(jr){return String.fromCharCode(jr>>24&255,jr>>16&255,jr>>8&255,jr&255)}function ar(jr){return Object.keys(jr).length}function Ar(jr){const cr=Object.create(null);for(const[Sr,en]of jr)cr[Sr]=en;return cr}function er(){const jr=new Uint8Array(4);return jr[0]=1,new Uint32Array(jr.buffer,0,1)[0]===1}function sr(){try{return new Function(""),!0}catch{return!1}}class Gt{static get isLittleEndian(){return Lt(this,"isLittleEndian",er())}static get isEvalSupported(){return Lt(this,"isEvalSupported",sr())}static get isOffscreenCanvasSupported(){return Lt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Lt(this,"platform",{isWin:!1,isMac:!1}):Lt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var cr,Sr;return Lt(this,"isCSSRoundSupported",(Sr=(cr=globalThis.CSS)==null?void 0:cr.supports)==null?void 0:Sr.call(cr,"width: round(1.5px, 1px)"))}}i.FeatureTest=Gt;const Jt=[...Array(256).keys()].map(jr=>jr.toString(16).padStart(2,"0"));class lr{static makeHexColor(cr,Sr,en){return`#${Jt[cr]}${Jt[Sr]}${Jt[en]}`}static scaleMinMax(cr,Sr){let en;cr[0]?(cr[0]<0&&(en=Sr[0],Sr[0]=Sr[1],Sr[1]=en),Sr[0]*=cr[0],Sr[1]*=cr[0],cr[3]<0&&(en=Sr[2],Sr[2]=Sr[3],Sr[3]=en),Sr[2]*=cr[3],Sr[3]*=cr[3]):(en=Sr[0],Sr[0]=Sr[2],Sr[2]=en,en=Sr[1],Sr[1]=Sr[3],Sr[3]=en,cr[1]<0&&(en=Sr[2],Sr[2]=Sr[3],Sr[3]=en),Sr[2]*=cr[1],Sr[3]*=cr[1],cr[2]<0&&(en=Sr[0],Sr[0]=Sr[1],Sr[1]=en),Sr[0]*=cr[2],Sr[1]*=cr[2]),Sr[0]+=cr[4],Sr[1]+=cr[4],Sr[2]+=cr[5],Sr[3]+=cr[5]}static transform(cr,Sr){return[cr[0]*Sr[0]+cr[2]*Sr[1],cr[1]*Sr[0]+cr[3]*Sr[1],cr[0]*Sr[2]+cr[2]*Sr[3],cr[1]*Sr[2]+cr[3]*Sr[3],cr[0]*Sr[4]+cr[2]*Sr[5]+cr[4],cr[1]*Sr[4]+cr[3]*Sr[5]+cr[5]]}static applyTransform(cr,Sr){const en=cr[0]*Sr[0]+cr[1]*Sr[2]+Sr[4],bn=cr[0]*Sr[1]+cr[1]*Sr[3]+Sr[5];return[en,bn]}static applyInverseTransform(cr,Sr){const en=Sr[0]*Sr[3]-Sr[1]*Sr[2],bn=(cr[0]*Sr[3]-cr[1]*Sr[2]+Sr[2]*Sr[5]-Sr[4]*Sr[3])/en,qr=(-cr[0]*Sr[1]+cr[1]*Sr[0]+Sr[4]*Sr[1]-Sr[5]*Sr[0])/en;return[bn,qr]}static getAxialAlignedBoundingBox(cr,Sr){const en=this.applyTransform(cr,Sr),bn=this.applyTransform(cr.slice(2,4),Sr),qr=this.applyTransform([cr[0],cr[3]],Sr),rr=this.applyTransform([cr[2],cr[1]],Sr);return[Math.min(en[0],bn[0],qr[0],rr[0]),Math.min(en[1],bn[1],qr[1],rr[1]),Math.max(en[0],bn[0],qr[0],rr[0]),Math.max(en[1],bn[1],qr[1],rr[1])]}static inverseTransform(cr){const Sr=cr[0]*cr[3]-cr[1]*cr[2];return[cr[3]/Sr,-cr[1]/Sr,-cr[2]/Sr,cr[0]/Sr,(cr[2]*cr[5]-cr[4]*cr[3])/Sr,(cr[4]*cr[1]-cr[5]*cr[0])/Sr]}static singularValueDecompose2dScale(cr){const Sr=[cr[0],cr[2],cr[1],cr[3]],en=cr[0]*Sr[0]+cr[1]*Sr[2],bn=cr[0]*Sr[1]+cr[1]*Sr[3],qr=cr[2]*Sr[0]+cr[3]*Sr[2],rr=cr[2]*Sr[1]+cr[3]*Sr[3],Fr=(en+rr)/2,Xr=Math.sqrt((en+rr)**2-4*(en*rr-qr*bn))/2,un=Fr+Xr||1,hn=Fr-Xr||1;return[Math.sqrt(un),Math.sqrt(hn)]}static normalizeRect(cr){const Sr=cr.slice(0);return cr[0]>cr[2]&&(Sr[0]=cr[2],Sr[2]=cr[0]),cr[1]>cr[3]&&(Sr[1]=cr[3],Sr[3]=cr[1]),Sr}static intersect(cr,Sr){const en=Math.max(Math.min(cr[0],cr[2]),Math.min(Sr[0],Sr[2])),bn=Math.min(Math.max(cr[0],cr[2]),Math.max(Sr[0],Sr[2]));if(en>bn)return null;const qr=Math.max(Math.min(cr[1],cr[3]),Math.min(Sr[1],Sr[3])),rr=Math.min(Math.max(cr[1],cr[3]),Math.max(Sr[1],Sr[3]));return qr>rr?null:[en,qr,bn,rr]}static bezierBoundingBox(cr,Sr,en,bn,qr,rr,Fr,Xr){const un=[],hn=[[],[]];let rn,Zt,Yt,hr,Lr,Ht,Xt,tr;for(let Qr=0;Qr<2;++Qr){if(Qr===0?(Zt=6*cr-12*en+6*qr,rn=-3*cr+9*en-9*qr+3*Fr,Yt=3*en-3*cr):(Zt=6*Sr-12*bn+6*rr,rn=-3*Sr+9*bn-9*rr+3*Xr,Yt=3*bn-3*Sr),Math.abs(rn)<1e-12){if(Math.abs(Zt)<1e-12)continue;hr=-Yt/Zt,0<hr&&hr<1&&un.push(hr);continue}Xt=Zt*Zt-4*Yt*rn,tr=Math.sqrt(Xt),!(Xt<0)&&(Lr=(-Zt+tr)/(2*rn),0<Lr&&Lr<1&&un.push(Lr),Ht=(-Zt-tr)/(2*rn),0<Ht&&Ht<1&&un.push(Ht))}let wr=un.length,Dr;const Nr=wr;for(;wr--;)hr=un[wr],Dr=1-hr,hn[0][wr]=Dr*Dr*Dr*cr+3*Dr*Dr*hr*en+3*Dr*hr*hr*qr+hr*hr*hr*Fr,hn[1][wr]=Dr*Dr*Dr*Sr+3*Dr*Dr*hr*bn+3*Dr*hr*hr*rr+hr*hr*hr*Xr;return hn[0][Nr]=cr,hn[1][Nr]=Sr,hn[0][Nr+1]=Fr,hn[1][Nr+1]=Xr,hn[0].length=hn[1].length=Nr+2,[Math.min(...hn[0]),Math.min(...hn[1]),Math.max(...hn[0]),Math.max(...hn[1])]}}i.Util=lr;const dr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function xr(jr){if(jr[0]>=""){let Sr;if(jr[0]===""&&jr[1]===""?Sr="utf-16be":jr[0]===""&&jr[1]===""?Sr="utf-16le":jr[0]===""&&jr[1]===""&&jr[2]===""&&(Sr="utf-8"),Sr)try{const en=new TextDecoder(Sr,{fatal:!0}),bn=Qt(jr);return en.decode(bn)}catch(en){Rt(`stringToPDFString: "${en}".`)}}const cr=[];for(let Sr=0,en=jr.length;Sr<en;Sr++){const bn=dr[jr.charCodeAt(Sr)];cr.push(bn?String.fromCharCode(bn):jr.charAt(Sr))}return cr.join("")}function Mr(jr){return decodeURIComponent(escape(jr))}function Or(jr){return unescape(encodeURIComponent(jr))}function fr(jr){return typeof jr=="object"&&(jr==null?void 0:jr.byteLength)!==void 0}function Hr(jr,cr){if(jr.length!==cr.length)return!1;for(let Sr=0,en=jr.length;Sr<en;Sr++)if(jr[Sr]!==cr[Sr])return!1;return!0}function Gr(jr=new Date){return[jr.getUTCFullYear().toString(),(jr.getUTCMonth()+1).toString().padStart(2,"0"),jr.getUTCDate().toString().padStart(2,"0"),jr.getUTCHours().toString().padStart(2,"0"),jr.getUTCMinutes().toString().padStart(2,"0"),jr.getUTCSeconds().toString().padStart(2,"0")].join("")}class dn{constructor(){Er(this,_n,!1);this.promise=new Promise((cr,Sr)=>{this.resolve=en=>{Tr(this,_n,!0),cr(en)},this.reject=en=>{Tr(this,_n,!0),Sr(en)}})}get settled(){return $t(this,_n)}}_n=new WeakMap,i.PromiseCapability=dn;let nn=null,vn=null;function Jr(jr){return nn||(nn=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vn=new Map([["","t"]])),jr.replaceAll(nn,(cr,Sr,en)=>Sr?Sr.normalize("NFKC"):vn.get(en))}function an(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const jr=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(jr);else for(let cr=0;cr<32;cr++)jr[cr]=Math.floor(Math.random()*255);return or(jr)}const yn="pdfjs_internal_id_";i.AnnotationPrefix=yn},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var o,_,$,j,bs,_a,tt,rt,nt,it,st,at,ot,lt,ct,xa,ut,ht,Fo,mt,pt;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(gt){if(typeof gt=="string"||gt instanceof URL?gt={url:gt}:(0,_util.isArrayBuffer)(gt)&&(gt={data:gt}),typeof gt!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!gt.url&&!gt.data&&!gt.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const vt=new PDFDocumentLoadingTask,{docId:St}=vt,At=gt.url?getUrlProp(gt.url):null,xt=gt.data?getDataProp(gt.data):null,wt=gt.httpHeaders||null,Ot=gt.withCredentials===!0,Bt=gt.password??null,Ft=gt.range instanceof PDFDataRangeTransport?gt.range:null,Pt=Number.isInteger(gt.rangeChunkSize)&&gt.rangeChunkSize>0?gt.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Rt=gt.worker instanceof PDFWorker?gt.worker:null;const Et=gt.verbosity,_t=typeof gt.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(gt.docBaseUrl)?gt.docBaseUrl:null,Mt=typeof gt.cMapUrl=="string"?gt.cMapUrl:null,Dt=gt.cMapPacked!==!1,Lt=gt.CMapReaderFactory||DefaultCMapReaderFactory,Ct=typeof gt.standardFontDataUrl=="string"?gt.standardFontDataUrl:null,kt=gt.StandardFontDataFactory||DefaultStandardFontDataFactory,jt=gt.stopAtErrors!==!0,Vt=Number.isInteger(gt.maxImageSize)&&gt.maxImageSize>-1?gt.maxImageSize:-1,zt=gt.isEvalSupported!==!1,qt=typeof gt.isOffscreenCanvasSupported=="boolean"?gt.isOffscreenCanvasSupported:!_util.isNodeJS,Wt=Number.isInteger(gt.canvasMaxAreaInBytes)?gt.canvasMaxAreaInBytes:-1,ir=typeof gt.disableFontFace=="boolean"?gt.disableFontFace:_util.isNodeJS,or=gt.fontExtraProperties===!0,Qt=gt.enableXfa===!0,gr=gt.ownerDocument||globalThis.document,ar=gt.disableRange===!0,Ar=gt.disableStream===!0,er=gt.disableAutoFetch===!0,sr=gt.pdfBug===!0,Gt=Ft?Ft.length:gt.length??NaN,Jt=typeof gt.useSystemFonts=="boolean"?gt.useSystemFonts:!_util.isNodeJS&&!ir,lr=typeof gt.useWorkerFetch=="boolean"?gt.useWorkerFetch:Lt===_display_utils.DOMCMapReaderFactory&&kt===_display_utils.DOMStandardFontDataFactory&&Mt&&Ct&&(0,_display_utils.isValidFetchUrl)(Mt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(Ct,document.baseURI),dr=gt.canvasFactory||new DefaultCanvasFactory({ownerDocument:gr}),xr=gt.filterFactory||new DefaultFilterFactory({docId:St,ownerDocument:gr}),Mr=null;(0,_util.setVerbosityLevel)(Et);const Or={canvasFactory:dr,filterFactory:xr};if(lr||(Or.cMapReaderFactory=new Lt({baseUrl:Mt,isCompressed:Dt}),Or.standardFontDataFactory=new kt({baseUrl:Ct})),!Rt){const Gr={verbosity:Et,port:_worker_options.GlobalWorkerOptions.workerPort};Rt=Gr.port?PDFWorker.fromPort(Gr):new PDFWorker(Gr),vt._worker=Rt}const fr={docId:St,apiVersion:"3.11.174",data:xt,password:Bt,disableAutoFetch:er,rangeChunkSize:Pt,length:Gt,docBaseUrl:_t,enableXfa:Qt,evaluatorOptions:{maxImageSize:Vt,disableFontFace:ir,ignoreErrors:jt,isEvalSupported:zt,isOffscreenCanvasSupported:qt,canvasMaxAreaInBytes:Wt,fontExtraProperties:or,useSystemFonts:Jt,cMapUrl:lr?Mt:null,standardFontDataUrl:lr?Ct:null}},Hr={ignoreErrors:jt,isEvalSupported:zt,disableFontFace:ir,fontExtraProperties:or,enableXfa:Qt,ownerDocument:gr,disableAutoFetch:er,pdfBug:sr,styleElement:Mr};return Rt.promise.then(function(){if(vt.destroyed)throw new Error("Loading aborted");const Gr=_fetchDocument(Rt,fr),dn=new Promise(function(nn){let vn;Ft?vn=new _transport_stream.PDFDataTransportStream({length:Gt,initialData:Ft.initialData,progressiveDone:Ft.progressiveDone,contentDispositionFilename:Ft.contentDispositionFilename,disableRange:ar,disableStream:Ar},Ft):xt||(vn=(an=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(an):(0,_display_utils.isValidFetchUrl)(an.url)?new _displayFetch_stream.PDFFetchStream(an):new _displayNetwork.PDFNetworkStream(an))({url:At,length:Gt,httpHeaders:wt,withCredentials:Ot,rangeChunkSize:Pt,disableRange:ar,disableStream:Ar})),nn(vn)});return Promise.all([Gr,dn]).then(function([nn,vn]){if(vt.destroyed)throw new Error("Loading aborted");const Jr=new _message_handler.MessageHandler(St,nn,Rt.port),an=new WorkerTransport(Jr,vt,vn,Hr,Or);vt._transport=an,Jr.send("Ready",null)})}).catch(vt._capability.reject),vt}async function _fetchDocument(gt,vt){if(gt.destroyed)throw new Error("Worker was destroyed");const St=await gt.messageHandler.sendWithPromise("GetDocRequest",vt,vt.data?[vt.data.buffer]:null);if(gt.destroyed)throw new Error("Worker was destroyed");return St}function getUrlProp(gt){if(gt instanceof URL)return gt.href;try{return new URL(gt,window.location).href}catch{if(_util.isNodeJS&&typeof gt=="string")return gt}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(gt){if(_util.isNodeJS&&typeof Buffer<"u"&&gt instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(gt instanceof Uint8Array&&gt.byteLength===gt.buffer.byteLength)return gt;if(typeof gt=="string")return(0,_util.stringToBytes)(gt);if(typeof gt=="object"&&!isNaN(gt==null?void 0:gt.length)||(0,_util.isArrayBuffer)(gt))return new Uint8Array(gt);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class i{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Os(i,o)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var vt,St,At;this.destroyed=!0;try{(vt=this._worker)!=null&&vt.port&&(this._worker._pendingDestroy=!0),await((St=this._transport)==null?void 0:St.destroy())}catch(xt){throw(At=this._worker)!=null&&At.port&&delete this._worker._pendingDestroy,xt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};o=new WeakMap,Er(i,o,0);let PDFDocumentLoadingTask=i;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(vt,St,At=!1,xt=null){this.length=vt,this.initialData=St,this.progressiveDone=At,this.contentDispositionFilename=xt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(vt){this._rangeListeners.push(vt)}addProgressListener(vt){this._progressListeners.push(vt)}addProgressiveReadListener(vt){this._progressiveReadListeners.push(vt)}addProgressiveDoneListener(vt){this._progressiveDoneListeners.push(vt)}onDataRange(vt,St){for(const At of this._rangeListeners)At(vt,St)}onDataProgress(vt,St){this._readyCapability.promise.then(()=>{for(const At of this._progressListeners)At(vt,St)})}onDataProgressiveRead(vt){this._readyCapability.promise.then(()=>{for(const St of this._progressiveReadListeners)St(vt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const vt of this._progressiveDoneListeners)vt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(vt,St){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(vt,St){this._pdfInfo=vt,this._transport=St,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(At=>{if(!At)return At;const xt=[];for(const wt in At)xt.push(...At[wt]);return xt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(vt){return this._transport.getPage(vt)}getPageIndex(vt){return this._transport.getPageIndex(vt)}getDestinations(){return this._transport.getDestinations()}getDestination(vt){return this._transport.getDestination(vt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(vt=!1){return this._transport.startCleanup(vt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(vt,St,At,xt=!1){Er(this,j);Er(this,_,null);Er(this,$,!1);this._pageIndex=vt,this._pageInfo=St,this._transport=At,this._stats=xt?new _display_utils.StatTimer:null,this._pdfBug=xt,this.commonObjs=At.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:vt,rotation:St=this.rotate,offsetX:At=0,offsetY:xt=0,dontFlip:wt=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:vt,rotation:St,offsetX:At,offsetY:xt,dontFlip:wt})}getAnnotations({intent:vt="display"}={}){const St=this._transport.getRenderingIntent(vt);return this._transport.getAnnotations(this._pageIndex,St.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var vt;return((vt=this._transport._htmlForXfa)==null?void 0:vt.children[this._pageIndex])||null}render({canvasContext:vt,viewport:St,intent:At="display",annotationMode:xt=_util.AnnotationMode.ENABLE,transform:wt=null,background:Ot=null,optionalContentConfigPromise:Bt=null,annotationCanvasMap:Ft=null,pageColors:Pt=null,printAnnotationStorage:Rt=null}){var kt,jt;(kt=this._stats)==null||kt.time("Overall");const Et=this._transport.getRenderingIntent(At,xt,Rt);Tr(this,$,!1),mr(this,j,_a).call(this),Bt||(Bt=this._transport.getOptionalContentConfig());let _t=this._intentStates.get(Et.cacheKey);_t||(_t=Object.create(null),this._intentStates.set(Et.cacheKey,_t)),_t.streamReaderCancelTimeout&&(clearTimeout(_t.streamReaderCancelTimeout),_t.streamReaderCancelTimeout=null);const Mt=!!(Et.renderingIntent&_util.RenderingIntentFlag.PRINT);_t.displayReadyCapability||(_t.displayReadyCapability=new _util.PromiseCapability,_t.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(jt=this._stats)==null||jt.time("Page Request"),this._pumpOperatorList(Et));const Dt=Vt=>{var zt,qt;_t.renderTasks.delete(Lt),(this._maybeCleanupAfterRender||Mt)&&Tr(this,$,!0),mr(this,j,bs).call(this,!Mt),Vt?(Lt.capability.reject(Vt),this._abortOperatorList({intentState:_t,reason:Vt instanceof Error?Vt:new Error(Vt)})):Lt.capability.resolve(),(zt=this._stats)==null||zt.timeEnd("Rendering"),(qt=this._stats)==null||qt.timeEnd("Overall")},Lt=new InternalRenderTask({callback:Dt,params:{canvasContext:vt,viewport:St,transform:wt,background:Ot},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ft,operatorList:_t.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Mt,pdfBug:this._pdfBug,pageColors:Pt});(_t.renderTasks||(_t.renderTasks=new Set)).add(Lt);const Ct=Lt.task;return Promise.all([_t.displayReadyCapability.promise,Bt]).then(([Vt,zt])=>{var qt;if(this.destroyed){Dt();return}(qt=this._stats)==null||qt.time("Rendering"),Lt.initializeGraphics({transparency:Vt,optionalContentConfig:zt}),Lt.operatorListChanged()}).catch(Dt),Ct}getOperatorList({intent:vt="display",annotationMode:St=_util.AnnotationMode.ENABLE,printAnnotationStorage:At=null}={}){var Ft;function xt(){Ot.operatorList.lastChunk&&(Ot.opListReadCapability.resolve(Ot.operatorList),Ot.renderTasks.delete(Bt))}const wt=this._transport.getRenderingIntent(vt,St,At,!0);let Ot=this._intentStates.get(wt.cacheKey);Ot||(Ot=Object.create(null),this._intentStates.set(wt.cacheKey,Ot));let Bt;return Ot.opListReadCapability||(Bt=Object.create(null),Bt.operatorListChanged=xt,Ot.opListReadCapability=new _util.PromiseCapability,(Ot.renderTasks||(Ot.renderTasks=new Set)).add(Bt),Ot.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ft=this._stats)==null||Ft.time("Page Request"),this._pumpOperatorList(wt)),Ot.opListReadCapability.promise}streamTextContent({includeMarkedContent:vt=!1,disableNormalization:St=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:vt===!0,disableNormalization:St===!0},{highWaterMark:100,size(xt){return xt.items.length}})}getTextContent(vt={}){if(this._transport._htmlForXfa)return this.getXfa().then(At=>_xfa_text.XfaText.textContent(At));const St=this.streamTextContent(vt);return new Promise(function(At,xt){function wt(){Ot.read().then(function({value:Ft,done:Pt}){if(Pt){At(Bt);return}Object.assign(Bt.styles,Ft.styles),Bt.items.push(...Ft.items),wt()},xt)}const Ot=St.getReader(),Bt={items:[],styles:Object.create(null)};wt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const vt=[];for(const St of this._intentStates.values())if(this._abortOperatorList({intentState:St,reason:new Error("Page was destroyed."),force:!0}),!St.opListReadCapability)for(const At of St.renderTasks)vt.push(At.completed),At.cancel();return this.objs.clear(),Tr(this,$,!1),mr(this,j,_a).call(this),Promise.all(vt)}cleanup(vt=!1){Tr(this,$,!0);const St=mr(this,j,bs).call(this,!1);return vt&&St&&this._stats&&(this._stats=new _display_utils.StatTimer),St}_startRenderPage(vt,St){var xt,wt;const At=this._intentStates.get(St);At&&((xt=this._stats)==null||xt.timeEnd("Page Request"),(wt=At.displayReadyCapability)==null||wt.resolve(vt))}_renderPageChunk(vt,St){for(let At=0,xt=vt.length;At<xt;At++)St.operatorList.fnArray.push(vt.fnArray[At]),St.operatorList.argsArray.push(vt.argsArray[At]);St.operatorList.lastChunk=vt.lastChunk,St.operatorList.separateAnnots=vt.separateAnnots;for(const At of St.renderTasks)At.operatorListChanged();vt.lastChunk&&mr(this,j,bs).call(this,!0)}_pumpOperatorList({renderingIntent:vt,cacheKey:St,annotationStorageSerializable:At}){const{map:xt,transfers:wt}=At,Bt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:vt,cacheKey:St,annotationStorage:xt},wt).getReader(),Ft=this._intentStates.get(St);Ft.streamReader=Bt;const Pt=()=>{Bt.read().then(({value:Rt,done:Et})=>{if(Et){Ft.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Rt,Ft),Pt())},Rt=>{if(Ft.streamReader=null,!this._transport.destroyed){if(Ft.operatorList){Ft.operatorList.lastChunk=!0;for(const Et of Ft.renderTasks)Et.operatorListChanged();mr(this,j,bs).call(this,!0)}if(Ft.displayReadyCapability)Ft.displayReadyCapability.reject(Rt);else if(Ft.opListReadCapability)Ft.opListReadCapability.reject(Rt);else throw Rt}})};Pt()}_abortOperatorList({intentState:vt,reason:St,force:At=!1}){if(vt.streamReader){if(vt.streamReaderCancelTimeout&&(clearTimeout(vt.streamReaderCancelTimeout),vt.streamReaderCancelTimeout=null),!At){if(vt.renderTasks.size>0)return;if(St instanceof _display_utils.RenderingCancelledException){let xt=RENDERING_CANCELLED_TIMEOUT;St.extraDelay>0&&St.extraDelay<1e3&&(xt+=St.extraDelay),vt.streamReaderCancelTimeout=setTimeout(()=>{vt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:vt,reason:St,force:!0})},xt);return}}if(vt.streamReader.cancel(new _util.AbortException(St.message)).catch(()=>{}),vt.streamReader=null,!this._transport.destroyed){for(const[xt,wt]of this._intentStates)if(wt===vt){this._intentStates.delete(xt);break}this.cleanup()}}}get stats(){return this._stats}}_=new WeakMap,$=new WeakMap,j=new WeakSet,bs=function(vt=!1){if(mr(this,j,_a).call(this),!$t(this,$)||this.destroyed)return!1;if(vt)return Tr(this,_,setTimeout(()=>{Tr(this,_,null),mr(this,j,bs).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:St,operatorList:At}of this._intentStates.values())if(St.size>0||!At.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Tr(this,$,!1),!0},_a=function(){$t(this,_)&&(clearTimeout($t(this,_)),Tr(this,_,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Er(this,tt,new Set);Er(this,rt,Promise.resolve())}postMessage(vt,St){const At={data:structuredClone(vt,St?{transfer:St}:null)};$t(this,rt).then(()=>{for(const xt of $t(this,tt))xt.call(this,At)})}addEventListener(vt,St){$t(this,tt).add(St)}removeEventListener(vt,St){$t(this,tt).delete(St)}terminate(){$t(this,tt).clear()}}tt=new WeakMap,rt=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const gt=(nt=document==null?void 0:document.currentScript)==null?void 0:nt.src;gt&&(PDFWorkerUtil.fallbackWorkerSrc=gt.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(gt,vt){let St;try{if(St=new URL(gt),!St.origin||St.origin==="null")return!1}catch{return!1}const At=new URL(vt,St);return St.origin===At.origin},PDFWorkerUtil.createCDNWrapper=function(gt){const vt=`importScripts("${gt}");`;return URL.createObjectURL(new Blob([vt]))}}const _PDFWorker=class _PDFWorker{constructor({name:gt=null,port:vt=null,verbosity:St=(0,_util.getVerbosityLevel)()}={}){var At;if(this.name=gt,this.destroyed=!1,this.verbosity=St,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,vt){if((At=$t(_PDFWorker,it))!=null&&At.has(vt))throw new Error("Cannot use more than one PDFWorker per port.");($t(_PDFWorker,it)||Tr(_PDFWorker,it,new WeakMap)).set(vt,this),this._initializeFromPort(vt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(gt){this._port=gt,this._messageHandler=new _message_handler.MessageHandler("main","worker",gt),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:gt}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,gt)||(gt=PDFWorkerUtil.createCDNWrapper(new URL(gt,window.location).href));const vt=new Worker(gt),St=new _message_handler.MessageHandler("main","worker",vt),At=()=>{vt.removeEventListener("error",xt),St.destroy(),vt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},xt=()=>{this._webWorker||At()};vt.addEventListener("error",xt),St.on("test",Ot=>{if(vt.removeEventListener("error",xt),this.destroyed){At();return}Ot?(this._messageHandler=St,this._port=vt,this._webWorker=vt,this._readyCapability.resolve(),St.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),St.destroy(),vt.terminate())}),St.on("ready",Ot=>{if(vt.removeEventListener("error",xt),this.destroyed){At();return}try{wt()}catch{this._setupFakeWorker()}});const wt=()=>{const Ot=new Uint8Array;St.send("test",Ot,[Ot.buffer])};wt();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(gt=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const vt=new LoopbackPort;this._port=vt;const St=`fake${PDFWorkerUtil.fakeWorkerId++}`,At=new _message_handler.MessageHandler(St+"_worker",St,vt);gt.setup(At,vt);const xt=new _message_handler.MessageHandler(St,St+"_worker",vt);this._messageHandler=xt,this._readyCapability.resolve(),xt.send("configure",{verbosity:this.verbosity})}).catch(gt=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${gt.message}".`))})}destroy(){var gt;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(gt=$t(_PDFWorker,it))==null||gt.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(gt){var St;if(!(gt!=null&&gt.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const vt=(St=$t(this,it))==null?void 0:St.get(gt.port);if(vt){if(vt._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return vt}return new _PDFWorker(gt)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var gt;try{return((gt=globalThis.pdfjsWorker)==null?void 0:gt.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};it=new WeakMap,Er(_PDFWorker,it);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(vt,St,At,xt,wt){Er(this,ct);Er(this,st,new Map);Er(this,at,new Map);Er(this,ot,new Map);Er(this,lt,null);this.messageHandler=vt,this.loadingTask=St,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:xt.ownerDocument,styleElement:xt.styleElement}),this._params=xt,this.canvasFactory=wt.canvasFactory,this.filterFactory=wt.filterFactory,this.cMapReaderFactory=wt.cMapReaderFactory,this.standardFontDataFactory=wt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=At,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(vt,St=_util.AnnotationMode.ENABLE,At=null,xt=!1){let wt=_util.RenderingIntentFlag.DISPLAY,Ot=_annotation_storage.SerializableEmpty;switch(vt){case"any":wt=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":wt=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${vt}`)}switch(St){case _util.AnnotationMode.DISABLE:wt+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:wt+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:wt+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Ot=(wt&_util.RenderingIntentFlag.PRINT&&At instanceof _annotation_storage.PrintAnnotationStorage?At:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${St}`)}return xt&&(wt+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:wt,cacheKey:`${wt}_${Ot.hash}`,annotationStorageSerializable:Ot}}destroy(){var At;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(At=$t(this,lt))==null||At.reject(new Error("Worker was destroyed during onPassword callback"));const vt=[];for(const xt of $t(this,at).values())vt.push(xt._destroy());$t(this,at).clear(),$t(this,ot).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const St=this.messageHandler.sendWithPromise("Terminate",null);return vt.push(St),Promise.all(vt).then(()=>{var xt;this.commonObjs.clear(),this.fontLoader.clear(),$t(this,st).clear(),this.filterFactory.destroy(),(xt=this._networkStream)==null||xt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:vt,loadingTask:St}=this;vt.on("GetReader",(At,xt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=wt=>{this._lastProgress={loaded:wt.loaded,total:wt.total}},xt.onPull=()=>{this._fullReader.read().then(function({value:wt,done:Ot}){if(Ot){xt.close();return}(0,_util.assert)(wt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),xt.enqueue(new Uint8Array(wt),1,[wt])}).catch(wt=>{xt.error(wt)})},xt.onCancel=wt=>{this._fullReader.cancel(wt),xt.ready.catch(Ot=>{if(!this.destroyed)throw Ot})}}),vt.on("ReaderHeadersReady",At=>{const xt=new _util.PromiseCapability,wt=this._fullReader;return wt.headersReady.then(()=>{var Ot;(!wt.isStreamingSupported||!wt.isRangeSupported)&&(this._lastProgress&&((Ot=St.onProgress)==null||Ot.call(St,this._lastProgress)),wt.onProgress=Bt=>{var Ft;(Ft=St.onProgress)==null||Ft.call(St,{loaded:Bt.loaded,total:Bt.total})}),xt.resolve({isStreamingSupported:wt.isStreamingSupported,isRangeSupported:wt.isRangeSupported,contentLength:wt.contentLength})},xt.reject),xt.promise}),vt.on("GetRangeReader",(At,xt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const wt=this._networkStream.getRangeReader(At.begin,At.end);if(!wt){xt.close();return}xt.onPull=()=>{wt.read().then(function({value:Ot,done:Bt}){if(Bt){xt.close();return}(0,_util.assert)(Ot instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),xt.enqueue(new Uint8Array(Ot),1,[Ot])}).catch(Ot=>{xt.error(Ot)})},xt.onCancel=Ot=>{wt.cancel(Ot),xt.ready.catch(Bt=>{if(!this.destroyed)throw Bt})}}),vt.on("GetDoc",({pdfInfo:At})=>{this._numPages=At.numPages,this._htmlForXfa=At.htmlForXfa,delete At.htmlForXfa,St._capability.resolve(new PDFDocumentProxy(At,this))}),vt.on("DocException",function(At){let xt;switch(At.name){case"PasswordException":xt=new _util.PasswordException(At.message,At.code);break;case"InvalidPDFException":xt=new _util.InvalidPDFException(At.message);break;case"MissingPDFException":xt=new _util.MissingPDFException(At.message);break;case"UnexpectedResponseException":xt=new _util.UnexpectedResponseException(At.message,At.status);break;case"UnknownErrorException":xt=new _util.UnknownErrorException(At.message,At.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}St._capability.reject(xt)}),vt.on("PasswordRequest",At=>{if(Tr(this,lt,new _util.PromiseCapability),St.onPassword){const xt=wt=>{wt instanceof Error?$t(this,lt).reject(wt):$t(this,lt).resolve({password:wt})};try{St.onPassword(xt,At.code)}catch(wt){$t(this,lt).reject(wt)}}else $t(this,lt).reject(new _util.PasswordException(At.message,At.code));return $t(this,lt).promise}),vt.on("DataLoaded",At=>{var xt;(xt=St.onProgress)==null||xt.call(St,{loaded:At.length,total:At.length}),this.downloadInfoCapability.resolve(At)}),vt.on("StartRenderPage",At=>{if(this.destroyed)return;$t(this,at).get(At.pageIndex)._startRenderPage(At.transparency,At.cacheKey)}),vt.on("commonobj",([At,xt,wt])=>{var Ot;if(!this.destroyed&&!this.commonObjs.has(At))switch(xt){case"Font":const Bt=this._params;if("error"in wt){const Rt=wt.error;(0,_util.warn)(`Error during font loading: ${Rt}`),this.commonObjs.resolve(At,Rt);break}const Ft=Bt.pdfBug&&((Ot=globalThis.FontInspector)!=null&&Ot.enabled)?(Rt,Et)=>globalThis.FontInspector.fontAdded(Rt,Et):null,Pt=new _font_loader.FontFaceObject(wt,{isEvalSupported:Bt.isEvalSupported,disableFontFace:Bt.disableFontFace,ignoreErrors:Bt.ignoreErrors,inspectFont:Ft});this.fontLoader.bind(Pt).catch(Rt=>vt.sendWithPromise("FontFallback",{id:At})).finally(()=>{!Bt.fontExtraProperties&&Pt.data&&(Pt.data=null),this.commonObjs.resolve(At,Pt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(At,wt);break;default:throw new Error(`Got unknown common object type ${xt}`)}}),vt.on("obj",([At,xt,wt,Ot])=>{var Ft;if(this.destroyed)return;const Bt=$t(this,at).get(xt);if(!Bt.objs.has(At))switch(wt){case"Image":if(Bt.objs.resolve(At,Ot),Ot){let Pt;if(Ot.bitmap){const{width:Rt,height:Et}=Ot;Pt=Rt*Et*4}else Pt=((Ft=Ot.data)==null?void 0:Ft.length)||0;Pt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Bt._maybeCleanupAfterRender=!0)}break;case"Pattern":Bt.objs.resolve(At,Ot);break;default:throw new Error(`Got unknown object type ${wt}`)}}),vt.on("DocProgress",At=>{var xt;this.destroyed||(xt=St.onProgress)==null||xt.call(St,{loaded:At.loaded,total:At.total})}),vt.on("FetchBuiltInCMap",At=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(At):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),vt.on("FetchStandardFontData",At=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(At):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var At;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:vt,transfers:St}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:vt,filename:((At=this._fullReader)==null?void 0:At.filename)??null},St).finally(()=>{this.annotationStorage.resetModified()})}getPage(vt){if(!Number.isInteger(vt)||vt<=0||vt>this._numPages)return Promise.reject(new Error("Invalid page request."));const St=vt-1,At=$t(this,ot).get(St);if(At)return At;const xt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:St}).then(wt=>{if(this.destroyed)throw new Error("Transport destroyed");const Ot=new PDFPageProxy(St,wt,this,this._params.pdfBug);return $t(this,at).set(St,Ot),Ot});return $t(this,ot).set(St,xt),xt}getPageIndex(vt){return typeof vt!="object"||vt===null||!Number.isInteger(vt.num)||vt.num<0||!Number.isInteger(vt.gen)||vt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:vt.num,gen:vt.gen})}getAnnotations(vt,St){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:vt,intent:St})}getFieldObjects(){return mr(this,ct,xa).call(this,"GetFieldObjects")}hasJSActions(){return mr(this,ct,xa).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(vt){return typeof vt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:vt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return mr(this,ct,xa).call(this,"GetDocJSActions")}getPageJSActions(vt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:vt})}getStructTree(vt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:vt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(vt=>new _optional_content_config.OptionalContentConfig(vt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const vt="GetMetadata",St=$t(this,st).get(vt);if(St)return St;const At=this.messageHandler.sendWithPromise(vt,null).then(xt=>{var wt,Ot;return{info:xt[0],metadata:xt[1]?new _metadata.Metadata(xt[1]):null,contentDispositionFilename:((wt=this._fullReader)==null?void 0:wt.filename)??null,contentLength:((Ot=this._fullReader)==null?void 0:Ot.contentLength)??null}});return $t(this,st).set(vt,At),At}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(vt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const St of $t(this,at).values())if(!St.cleanup())throw new Error(`startCleanup: Page ${St.pageNumber} is currently rendering.`);this.commonObjs.clear(),vt||this.fontLoader.clear(),$t(this,st).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:vt,enableXfa:St}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:vt,enableXfa:St})}}st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakSet,xa=function(vt,St=null){const At=$t(this,st).get(vt);if(At)return At;const xt=this.messageHandler.sendWithPromise(vt,St);return $t(this,st).set(vt,xt),xt};class PDFObjects{constructor(){Er(this,ht);Er(this,ut,Object.create(null))}get(vt,St=null){if(St){const xt=mr(this,ht,Fo).call(this,vt);return xt.capability.promise.then(()=>St(xt.data)),null}const At=$t(this,ut)[vt];if(!(At!=null&&At.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${vt}.`);return At.data}has(vt){const St=$t(this,ut)[vt];return(St==null?void 0:St.capability.settled)||!1}resolve(vt,St=null){const At=mr(this,ht,Fo).call(this,vt);At.data=St,At.capability.resolve()}clear(){var vt;for(const St in $t(this,ut)){const{data:At}=$t(this,ut)[St];(vt=At==null?void 0:At.bitmap)==null||vt.close()}Tr(this,ut,Object.create(null))}}ut=new WeakMap,ht=new WeakSet,Fo=function(vt){var St;return(St=$t(this,ut))[vt]||(St[vt]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(vt){Er(this,mt,null);Tr(this,mt,vt),this.onContinue=null}get promise(){return $t(this,mt).capability.promise}cancel(vt=0){$t(this,mt).cancel(null,vt)}get separateAnnots(){const{separateAnnots:vt}=$t(this,mt).operatorList;if(!vt)return!1;const{annotationCanvasMap:St}=$t(this,mt);return vt.form||vt.canvas&&(St==null?void 0:St.size)>0}}mt=new WeakMap,exports.RenderTask=RenderTask;const yt=class yt{constructor({callback:vt,params:St,objs:At,commonObjs:xt,annotationCanvasMap:wt,operatorList:Ot,pageIndex:Bt,canvasFactory:Ft,filterFactory:Pt,useRequestAnimationFrame:Rt=!1,pdfBug:Et=!1,pageColors:_t=null}){this.callback=vt,this.params=St,this.objs=At,this.commonObjs=xt,this.annotationCanvasMap=wt,this.operatorListIdx=null,this.operatorList=Ot,this._pageIndex=Bt,this.canvasFactory=Ft,this.filterFactory=Pt,this._pdfBug=Et,this.pageColors=_t,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Rt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=St.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:vt=!1,optionalContentConfig:St}){var Bt,Ft;if(this.cancelled)return;if(this._canvas){if($t(yt,pt).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");$t(yt,pt).add(this._canvas)}this._pdfBug&&((Bt=globalThis.StepperManager)!=null&&Bt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:At,viewport:xt,transform:wt,background:Ot}=this.params;this.gfx=new _canvas.CanvasGraphics(At,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:St},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:wt,viewport:xt,transparency:vt,background:Ot}),this.operatorListIdx=0,this.graphicsReady=!0,(Ft=this.graphicsReadyCallback)==null||Ft.call(this)}cancel(vt=null,St=0){var At;this.running=!1,this.cancelled=!0,(At=this.gfx)==null||At.endDrawing(),$t(yt,pt).delete(this._canvas),this.callback(vt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,St))}operatorListChanged(){var vt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(vt=this.stepper)==null||vt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),$t(yt,pt).delete(this._canvas),this.callback())))}};pt=new WeakMap,Er(yt,pt,new WeakSet);let InternalRenderTask=yt;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(o,i,_)=>{var nt,it,st,lu,ot;Object.defineProperty(i,"__esModule",{value:!0}),i.SerializableEmpty=i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var $=_(1),j=_(4),_e=_(8);const et=Object.freeze({map:null,hash:"",transfers:void 0});i.SerializableEmpty=et;class tt{constructor(){Er(this,st);Er(this,nt,!1);Er(this,it,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(ct,ft){const ut=$t(this,it).get(ct);return ut===void 0?ft:Object.assign(ft,ut)}getRawValue(ct){return $t(this,it).get(ct)}remove(ct){if($t(this,it).delete(ct),$t(this,it).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const ft of $t(this,it).values())if(ft instanceof j.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(ct,ft){const ut=$t(this,it).get(ct);let ht=!1;if(ut!==void 0)for(const[dt,mt]of Object.entries(ft))ut[dt]!==mt&&(ht=!0,ut[dt]=mt);else ht=!0,$t(this,it).set(ct,ft);ht&&mr(this,st,lu).call(this),ft instanceof j.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(ft.constructor._type)}has(ct){return $t(this,it).has(ct)}getAll(){return $t(this,it).size>0?(0,$.objectFromMap)($t(this,it)):null}setAll(ct){for(const[ft,ut]of Object.entries(ct))this.setValue(ft,ut)}get size(){return $t(this,it).size}resetModified(){$t(this,nt)&&(Tr(this,nt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new rt(this)}get serializable(){if($t(this,it).size===0)return et;const ct=new Map,ft=new _e.MurmurHash3_64,ut=[],ht=Object.create(null);let dt=!1;for(const[mt,pt]of $t(this,it)){const yt=pt instanceof j.AnnotationEditor?pt.serialize(!1,ht):pt;yt&&(ct.set(mt,yt),ft.update(`${mt}:${JSON.stringify(yt)}`),dt||(dt=!!yt.bitmap))}if(dt)for(const mt of ct.values())mt.bitmap&&ut.push(mt.bitmap);return ct.size>0?{map:ct,hash:ft.hexdigest(),transfers:ut}:et}}nt=new WeakMap,it=new WeakMap,st=new WeakSet,lu=function(){$t(this,nt)||(Tr(this,nt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=tt;class rt extends tt{constructor(ft){super();Er(this,ot);const{map:ut,hash:ht,transfers:dt}=ft.serializable,mt=structuredClone(ut,dt?{transfer:dt}:null);Tr(this,ot,{map:mt,hash:ht,transfers:dt})}get print(){(0,$.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return $t(this,ot)}}ot=new WeakMap,i.PrintAnnotationStorage=rt},(o,i,_)=>{var rt,nt,it,st,at,ot,lt,ct,ft,ut,ht,dt,mt,pt,yt,No,jo,St,Bo,Uo,cu,uu,hu,Vo,fu;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var $=_(5),j=_(1),_e=_(6);const Rt=class Rt{constructor(_t){Er(this,yt);Er(this,rt,"");Er(this,nt,!1);Er(this,it,null);Er(this,st,null);Er(this,at,null);Er(this,ot,!1);Er(this,lt,null);Er(this,ct,this.focusin.bind(this));Er(this,ft,this.focusout.bind(this));Er(this,ut,!1);Er(this,ht,!1);Er(this,dt,!1);Rn(this,"_initialOptions",Object.create(null));Rn(this,"_uiManager",null);Rn(this,"_focusEventsAllowed",!0);Rn(this,"_l10nPromise",null);Er(this,mt,!1);Er(this,pt,Rt._zIndex++);this.constructor===Rt&&(0,j.unreachable)("Cannot initialize AnnotationEditor."),this.parent=_t.parent,this.id=_t.id,this.width=this.height=null,this.pageIndex=_t.parent.pageIndex,this.name=_t.name,this.div=null,this._uiManager=_t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=_t.isCentered,this._structTreeParentId=null;const{rotation:Mt,rawDims:{pageWidth:Dt,pageHeight:Lt,pageX:Ct,pageY:kt}}=this.parent.viewport;this.rotation=Mt,this.pageRotation=(360+Mt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Dt,Lt],this.pageTranslation=[Ct,kt];const[jt,Vt]=this.parentDimensions;this.x=_t.x/jt,this.y=_t.y/Vt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,j.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(_t){const Mt=new tt({id:_t.parent.getNextId(),parent:_t.parent,uiManager:_t._uiManager});Mt.annotationElementId=_t.annotationElementId,Mt.deleted=!0,Mt._uiManager.addToAnnotationStorage(Mt)}static initialize(_t,Mt=null){if(Rt._l10nPromise||(Rt._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Lt=>[Lt,_t.get(Lt)]))),Mt!=null&&Mt.strings)for(const Lt of Mt.strings)Rt._l10nPromise.set(Lt,_t.get(Lt));if(Rt._borderLineWidth!==-1)return;const Dt=getComputedStyle(document.documentElement);Rt._borderLineWidth=parseFloat(Dt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(_t,Mt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(_t){return!1}static paste(_t,Mt){(0,j.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return $t(this,mt)}set _isDraggable(_t){var Mt;Tr(this,mt,_t),(Mt=this.div)==null||Mt.classList.toggle("draggable",_t)}center(){const[_t,Mt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Mt/(_t*2),this.y+=this.width*_t/(Mt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Mt/(_t*2),this.y-=this.width*_t/(Mt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(_t){this._uiManager.addCommands(_t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=$t(this,pt)}setParent(_t){_t!==null&&(this.pageIndex=_t.pageIndex,this.pageDimensions=_t.pageDimensions),this.parent=_t}focusin(_t){this._focusEventsAllowed&&($t(this,ut)?Tr(this,ut,!1):this.parent.setSelected(this))}focusout(_t){var Dt;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Mt=_t.relatedTarget;Mt!=null&&Mt.closest(`#${this.id}`)||(_t.preventDefault(),(Dt=this.parent)!=null&&Dt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(_t,Mt,Dt,Lt){const[Ct,kt]=this.parentDimensions;[Dt,Lt]=this.screenToPageTranslation(Dt,Lt),this.x=(_t+Dt)/Ct,this.y=(Mt+Lt)/kt,this.fixAndSetPosition()}translate(_t,Mt){mr(this,yt,No).call(this,this.parentDimensions,_t,Mt)}translateInPage(_t,Mt){mr(this,yt,No).call(this,this.pageDimensions,_t,Mt),this.div.scrollIntoView({block:"nearest"})}drag(_t,Mt){const[Dt,Lt]=this.parentDimensions;if(this.x+=_t/Dt,this.y+=Mt/Lt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:zt,y:qt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,zt,qt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:Ct,y:kt}=this;const[jt,Vt]=mr(this,yt,jo).call(this);Ct+=jt,kt+=Vt,this.div.style.left=`${(100*Ct).toFixed(2)}%`,this.div.style.top=`${(100*kt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[_t,Mt]=this.pageDimensions;let{x:Dt,y:Lt,width:Ct,height:kt}=this;switch(Ct*=_t,kt*=Mt,Dt*=_t,Lt*=Mt,this.rotation){case 0:Dt=Math.max(0,Math.min(_t-Ct,Dt)),Lt=Math.max(0,Math.min(Mt-kt,Lt));break;case 90:Dt=Math.max(0,Math.min(_t-kt,Dt)),Lt=Math.min(Mt,Math.max(Ct,Lt));break;case 180:Dt=Math.min(_t,Math.max(Ct,Dt)),Lt=Math.min(Mt,Math.max(kt,Lt));break;case 270:Dt=Math.min(_t,Math.max(kt,Dt)),Lt=Math.max(0,Math.min(Mt-Ct,Lt));break}this.x=Dt/=_t,this.y=Lt/=Mt;const[jt,Vt]=mr(this,yt,jo).call(this);Dt+=jt,Lt+=Vt;const{style:zt}=this.div;zt.left=`${(100*Dt).toFixed(2)}%`,zt.top=`${(100*Lt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(_t,Mt){var Dt;return mr(Dt=Rt,St,Bo).call(Dt,_t,Mt,this.parentRotation)}pageTranslationToScreen(_t,Mt){var Dt;return mr(Dt=Rt,St,Bo).call(Dt,_t,Mt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:_t,pageDimensions:[Mt,Dt]}=this,Lt=Mt*_t,Ct=Dt*_t;return j.FeatureTest.isCSSRoundSupported?[Math.round(Lt),Math.round(Ct)]:[Lt,Ct]}setDims(_t,Mt){var Ct;const[Dt,Lt]=this.parentDimensions;this.div.style.width=`${(100*_t/Dt).toFixed(2)}%`,$t(this,ot)||(this.div.style.height=`${(100*Mt/Lt).toFixed(2)}%`),(Ct=$t(this,it))==null||Ct.classList.toggle("small",_t<Rt.SMALL_EDITOR_SIZE||Mt<Rt.SMALL_EDITOR_SIZE)}fixDims(){const{style:_t}=this.div,{height:Mt,width:Dt}=_t,Lt=Dt.endsWith("%"),Ct=!$t(this,ot)&&Mt.endsWith("%");if(Lt&&Ct)return;const[kt,jt]=this.parentDimensions;Lt||(_t.width=`${(100*parseFloat(Dt)/kt).toFixed(2)}%`),!$t(this,ot)&&!Ct&&(_t.height=`${(100*parseFloat(Mt)/jt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if($t(this,it))return;const _t=Tr(this,it,document.createElement("button"));_t.className="altText";const Mt=await Rt._l10nPromise.get("editor_alt_text_button_label");_t.textContent=Mt,_t.setAttribute("aria-label",Mt),_t.tabIndex="0",_t.addEventListener("contextmenu",_e.noContextMenu),_t.addEventListener("pointerdown",Dt=>Dt.stopPropagation()),_t.addEventListener("click",Dt=>{Dt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),_t.addEventListener("keydown",Dt=>{Dt.target===_t&&Dt.key==="Enter"&&(Dt.preventDefault(),this._uiManager.editAltText(this))}),mr(this,yt,Vo).call(this),this.div.append(_t),Rt.SMALL_EDITOR_SIZE||(Rt.SMALL_EDITOR_SIZE=Math.min(128,Math.round(_t.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:$t(this,rt),decorative:$t(this,nt)}}set altTextData({altText:_t,decorative:Mt}){$t(this,rt)===_t&&$t(this,nt)===Mt||(Tr(this,rt,_t),Tr(this,nt,Mt),mr(this,yt,Vo).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",$t(this,ct)),this.div.addEventListener("focusout",$t(this,ft));const[_t,Mt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Mt/_t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*_t/Mt).toFixed(2)}%`);const[Dt,Lt]=this.getInitialTranslation();return this.translate(Dt,Lt),(0,$.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(_t){const{isMac:Mt}=j.FeatureTest.platform;if(_t.button!==0||_t.ctrlKey&&Mt){_t.preventDefault();return}Tr(this,ut,!0),mr(this,yt,fu).call(this,_t)}moveInDOM(){var _t;(_t=this.parent)==null||_t.moveEditorInDOM(this)}_setParentAndPosition(_t,Mt,Dt){_t.changeParent(this),this.x=Mt,this.y=Dt,this.fixAndSetPosition()}getRect(_t,Mt){const Dt=this.parentScale,[Lt,Ct]=this.pageDimensions,[kt,jt]=this.pageTranslation,Vt=_t/Dt,zt=Mt/Dt,qt=this.x*Lt,Wt=this.y*Ct,ir=this.width*Lt,or=this.height*Ct;switch(this.rotation){case 0:return[qt+Vt+kt,Ct-Wt-zt-or+jt,qt+Vt+ir+kt,Ct-Wt-zt+jt];case 90:return[qt+zt+kt,Ct-Wt+Vt+jt,qt+zt+or+kt,Ct-Wt+Vt+ir+jt];case 180:return[qt-Vt-ir+kt,Ct-Wt+zt+jt,qt-Vt+kt,Ct-Wt+zt+or+jt];case 270:return[qt-zt-or+kt,Ct-Wt-Vt-ir+jt,qt-zt+kt,Ct-Wt-Vt+jt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(_t,Mt){const[Dt,Lt,Ct,kt]=_t,jt=Ct-Dt,Vt=kt-Lt;switch(this.rotation){case 0:return[Dt,Mt-kt,jt,Vt];case 90:return[Dt,Mt-Lt,Vt,jt];case 180:return[Ct,Mt-Lt,jt,Vt];case 270:return[Ct,Mt-kt,Vt,jt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Tr(this,dt,!0)}disableEditMode(){Tr(this,dt,!1)}isInEditMode(){return $t(this,dt)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var _t,Mt;(_t=this.div)==null||_t.addEventListener("focusin",$t(this,ct)),(Mt=this.div)==null||Mt.addEventListener("focusout",$t(this,ft))}serialize(_t=!1,Mt=null){(0,j.unreachable)("An editor must be serializable")}static deserialize(_t,Mt,Dt){const Lt=new this.prototype.constructor({parent:Mt,id:Mt.getNextId(),uiManager:Dt});Lt.rotation=_t.rotation;const[Ct,kt]=Lt.pageDimensions,[jt,Vt,zt,qt]=Lt.getRectInCurrentCoords(_t.rect,kt);return Lt.x=jt/Ct,Lt.y=Vt/kt,Lt.width=zt/Ct,Lt.height=qt/kt,Lt}remove(){var _t;this.div.removeEventListener("focusin",$t(this,ct)),this.div.removeEventListener("focusout",$t(this,ft)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(_t=$t(this,it))==null||_t.remove(),Tr(this,it,null),Tr(this,st,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(mr(this,yt,cu).call(this),$t(this,lt).classList.remove("hidden"))}select(){var _t;this.makeResizable(),(_t=this.div)==null||_t.classList.add("selectedEditor")}unselect(){var _t,Mt,Dt;(_t=$t(this,lt))==null||_t.classList.add("hidden"),(Mt=this.div)==null||Mt.classList.remove("selectedEditor"),(Dt=this.div)!=null&&Dt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(_t,Mt){}disableEditing(){$t(this,it)&&($t(this,it).hidden=!0)}enableEditing(){$t(this,it)&&($t(this,it).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return $t(this,ht)}set isEditing(_t){Tr(this,ht,_t),this.parent&&(_t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(_t,Mt){Tr(this,ot,!0);const Dt=_t/Mt,{style:Lt}=this.div;Lt.aspectRatio=Dt,Lt.height="auto"}static get MIN_SIZE(){return 16}};rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakMap,ht=new WeakMap,dt=new WeakMap,mt=new WeakMap,pt=new WeakMap,yt=new WeakSet,No=function([_t,Mt],Dt,Lt){[Dt,Lt]=this.screenToPageTranslation(Dt,Lt),this.x+=Dt/_t,this.y+=Lt/Mt,this.fixAndSetPosition()},jo=function(){const[_t,Mt]=this.parentDimensions,{_borderLineWidth:Dt}=Rt,Lt=Dt/_t,Ct=Dt/Mt;switch(this.rotation){case 90:return[-Lt,Ct];case 180:return[Lt,Ct];case 270:return[Lt,-Ct];default:return[-Lt,-Ct]}},St=new WeakSet,Bo=function(_t,Mt,Dt){switch(Dt){case 90:return[Mt,-_t];case 180:return[-_t,-Mt];case 270:return[-Mt,_t];default:return[_t,Mt]}},Uo=function(_t){switch(_t){case 90:{const[Mt,Dt]=this.pageDimensions;return[0,-Mt/Dt,Dt/Mt,0]}case 180:return[-1,0,0,-1];case 270:{const[Mt,Dt]=this.pageDimensions;return[0,Mt/Dt,-Dt/Mt,0]}default:return[1,0,0,1]}},cu=function(){if($t(this,lt))return;Tr(this,lt,document.createElement("div")),$t(this,lt).classList.add("resizers");const _t=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||_t.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Mt of _t){const Dt=document.createElement("div");$t(this,lt).append(Dt),Dt.classList.add("resizer",Mt),Dt.addEventListener("pointerdown",mr(this,yt,uu).bind(this,Mt)),Dt.addEventListener("contextmenu",_e.noContextMenu)}this.div.prepend($t(this,lt))},uu=function(_t,Mt){Mt.preventDefault();const{isMac:Dt}=j.FeatureTest.platform;if(Mt.button!==0||Mt.ctrlKey&&Dt)return;const Lt=mr(this,yt,hu).bind(this,_t),Ct=this._isDraggable;this._isDraggable=!1;const kt={passive:!0,capture:!0};window.addEventListener("pointermove",Lt,kt);const jt=this.x,Vt=this.y,zt=this.width,qt=this.height,Wt=this.parent.div.style.cursor,ir=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Mt.target).cursor;const or=()=>{this._isDraggable=Ct,window.removeEventListener("pointerup",or),window.removeEventListener("blur",or),window.removeEventListener("pointermove",Lt,kt),this.parent.div.style.cursor=Wt,this.div.style.cursor=ir;const Qt=this.x,gr=this.y,ar=this.width,Ar=this.height;Qt===jt&&gr===Vt&&ar===zt&&Ar===qt||this.addCommands({cmd:()=>{this.width=ar,this.height=Ar,this.x=Qt,this.y=gr;const[er,sr]=this.parentDimensions;this.setDims(er*ar,sr*Ar),this.fixAndSetPosition()},undo:()=>{this.width=zt,this.height=qt,this.x=jt,this.y=Vt;const[er,sr]=this.parentDimensions;this.setDims(er*zt,sr*qt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",or),window.addEventListener("blur",or)},hu=function(_t,Mt){const[Dt,Lt]=this.parentDimensions,Ct=this.x,kt=this.y,jt=this.width,Vt=this.height,zt=Rt.MIN_SIZE/Dt,qt=Rt.MIN_SIZE/Lt,Wt=Jr=>Math.round(Jr*1e4)/1e4,ir=mr(this,yt,Uo).call(this,this.rotation),or=(Jr,an)=>[ir[0]*Jr+ir[2]*an,ir[1]*Jr+ir[3]*an],Qt=mr(this,yt,Uo).call(this,360-this.rotation),gr=(Jr,an)=>[Qt[0]*Jr+Qt[2]*an,Qt[1]*Jr+Qt[3]*an];let ar,Ar,er=!1,sr=!1;switch(_t){case"topLeft":er=!0,ar=(Jr,an)=>[0,0],Ar=(Jr,an)=>[Jr,an];break;case"topMiddle":ar=(Jr,an)=>[Jr/2,0],Ar=(Jr,an)=>[Jr/2,an];break;case"topRight":er=!0,ar=(Jr,an)=>[Jr,0],Ar=(Jr,an)=>[0,an];break;case"middleRight":sr=!0,ar=(Jr,an)=>[Jr,an/2],Ar=(Jr,an)=>[0,an/2];break;case"bottomRight":er=!0,ar=(Jr,an)=>[Jr,an],Ar=(Jr,an)=>[0,0];break;case"bottomMiddle":ar=(Jr,an)=>[Jr/2,an],Ar=(Jr,an)=>[Jr/2,0];break;case"bottomLeft":er=!0,ar=(Jr,an)=>[0,an],Ar=(Jr,an)=>[Jr,0];break;case"middleLeft":sr=!0,ar=(Jr,an)=>[0,an/2],Ar=(Jr,an)=>[Jr,an/2];break}const Gt=ar(jt,Vt),Jt=Ar(jt,Vt);let lr=or(...Jt);const dr=Wt(Ct+lr[0]),xr=Wt(kt+lr[1]);let Mr=1,Or=1,[fr,Hr]=this.screenToPageTranslation(Mt.movementX,Mt.movementY);if([fr,Hr]=gr(fr/Dt,Hr/Lt),er){const Jr=Math.hypot(jt,Vt);Mr=Or=Math.max(Math.min(Math.hypot(Jt[0]-Gt[0]-fr,Jt[1]-Gt[1]-Hr)/Jr,1/jt,1/Vt),zt/jt,qt/Vt)}else sr?Mr=Math.max(zt,Math.min(1,Math.abs(Jt[0]-Gt[0]-fr)))/jt:Or=Math.max(qt,Math.min(1,Math.abs(Jt[1]-Gt[1]-Hr)))/Vt;const Gr=Wt(jt*Mr),dn=Wt(Vt*Or);lr=or(...Ar(Gr,dn));const nn=dr-lr[0],vn=xr-lr[1];this.width=Gr,this.height=dn,this.x=nn,this.y=vn,this.setDims(Dt*Gr,Lt*dn),this.fixAndSetPosition()},Vo=async function(){var Dt;const _t=$t(this,it);if(!_t)return;if(!$t(this,rt)&&!$t(this,nt)){_t.classList.remove("done"),(Dt=$t(this,st))==null||Dt.remove();return}Rt._l10nPromise.get("editor_alt_text_edit_button_label").then(Lt=>{_t.setAttribute("aria-label",Lt)});let Mt=$t(this,st);if(!Mt){Tr(this,st,Mt=document.createElement("span")),Mt.className="tooltip",Mt.setAttribute("role","tooltip");const Lt=Mt.id=`alt-text-tooltip-${this.id}`;_t.setAttribute("aria-describedby",Lt);const Ct=100;_t.addEventListener("mouseenter",()=>{Tr(this,at,setTimeout(()=>{Tr(this,at,null),$t(this,st).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},Ct))}),_t.addEventListener("mouseleave",()=>{var kt;clearTimeout($t(this,at)),Tr(this,at,null),(kt=$t(this,st))==null||kt.classList.remove("show")})}_t.classList.add("done"),Mt.innerText=$t(this,nt)?await Rt._l10nPromise.get("editor_alt_text_decorative_tooltip"):$t(this,rt),Mt.parentNode||_t.append(Mt)},fu=function(_t){if(!this._isDraggable)return;const Mt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Dt,Lt;Mt&&(Dt={passive:!0,capture:!0},Lt=kt=>{const[jt,Vt]=this.screenToPageTranslation(kt.movementX,kt.movementY);this._uiManager.dragSelectedEditors(jt,Vt)},window.addEventListener("pointermove",Lt,Dt));const Ct=()=>{if(window.removeEventListener("pointerup",Ct),window.removeEventListener("blur",Ct),Mt&&window.removeEventListener("pointermove",Lt,Dt),Tr(this,ut,!1),!this._uiManager.endDragSession()){const{isMac:kt}=j.FeatureTest.platform;_t.ctrlKey&&!kt||_t.shiftKey||_t.metaKey&&kt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",Ct),window.addEventListener("blur",Ct)},Er(Rt,St),Rn(Rt,"_borderLineWidth",-1),Rn(Rt,"_colorManager",new $.ColorManager),Rn(Rt,"_zIndex",1),Rn(Rt,"SMALL_EDITOR_SIZE",0);let et=Rt;i.AnnotationEditor=et;class tt extends et{constructor(_t){super(_t),this.annotationElementId=_t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(o,i,_)=>{var ot,lt,ct,ft,ut,Go,mt,pt,yt,gt,vt,du,xt,wt,Ot,Bt,Ft,Pt,Rt,Et,_t,Mt,Dt,Lt,Ct,kt,jt,Vt,zt,qt,Wt,ir,or,Qt,gr,ar,Ar,er,sr,Gt,Jt,lr,dr,xr,Mr,Or,fr,pu,Ho,Ko,$a,Wo,zo,Xn,Ds,mu,gu,qo,Ms,Yo;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=_e,i.opacityToHex=et;var $=_(1),j=_(6);function _e(qr,rr,Fr){for(const Xr of Fr)rr.addEventListener(Xr,qr[Xr].bind(qr))}function et(qr){return Math.round(Math.min(255,Math.max(1,255*qr))).toString(16).padStart(2,"0")}class tt{constructor(){Er(this,ot,0)}getId(){return`${$.AnnotationEditorPrefix}${Os(this,ot)._++}`}}ot=new WeakMap;const dt=class dt{constructor(){Er(this,ut);Er(this,lt,(0,$.getUuid)());Er(this,ct,0);Er(this,ft,null)}static get _isSVGFittingCanvas(){const rr='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Xr=new OffscreenCanvas(1,3).getContext("2d"),un=new Image;un.src=rr;const hn=un.decode().then(()=>(Xr.drawImage(un,0,0,1,1,0,0,1,3),new Uint32Array(Xr.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,$.shadow)(this,"_isSVGFittingCanvas",hn)}async getFromFile(rr){const{lastModified:Fr,name:Xr,size:un,type:hn}=rr;return mr(this,ut,Go).call(this,`${Fr}_${Xr}_${un}_${hn}`,rr)}async getFromUrl(rr){return mr(this,ut,Go).call(this,rr,rr)}async getFromId(rr){$t(this,ft)||Tr(this,ft,new Map);const Fr=$t(this,ft).get(rr);return Fr?Fr.bitmap?(Fr.refCounter+=1,Fr):Fr.file?this.getFromFile(Fr.file):this.getFromUrl(Fr.url):null}getSvgUrl(rr){const Fr=$t(this,ft).get(rr);return Fr!=null&&Fr.isSvg?Fr.svgUrl:null}deleteId(rr){$t(this,ft)||Tr(this,ft,new Map);const Fr=$t(this,ft).get(rr);Fr&&(Fr.refCounter-=1,Fr.refCounter===0&&(Fr.bitmap=null))}isValidId(rr){return rr.startsWith(`image_${$t(this,lt)}_`)}};lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakSet,Go=async function(rr,Fr){$t(this,ft)||Tr(this,ft,new Map);let Xr=$t(this,ft).get(rr);if(Xr===null)return null;if(Xr!=null&&Xr.bitmap)return Xr.refCounter+=1,Xr;try{Xr||(Xr={bitmap:null,id:`image_${$t(this,lt)}_${Os(this,ct)._++}`,refCounter:0,isSvg:!1});let un;if(typeof Fr=="string"){Xr.url=Fr;const hn=await fetch(Fr);if(!hn.ok)throw new Error(hn.statusText);un=await hn.blob()}else un=Xr.file=Fr;if(un.type==="image/svg+xml"){const hn=dt._isSVGFittingCanvas,rn=new FileReader,Zt=new Image,Yt=new Promise((hr,Lr)=>{Zt.onload=()=>{Xr.bitmap=Zt,Xr.isSvg=!0,hr()},rn.onload=async()=>{const Ht=Xr.svgUrl=rn.result;Zt.src=await hn?`${Ht}#svgView(preserveAspectRatio(none))`:Ht},Zt.onerror=rn.onerror=Lr});rn.readAsDataURL(un),await Yt}else Xr.bitmap=await createImageBitmap(un);Xr.refCounter=1}catch(un){console.error(un),Xr=null}return $t(this,ft).set(rr,Xr),Xr&&$t(this,ft).set(Xr.id,Xr),Xr};let rt=dt;class nt{constructor(rr=128){Er(this,mt,[]);Er(this,pt,!1);Er(this,yt);Er(this,gt,-1);Tr(this,yt,rr)}add({cmd:rr,undo:Fr,mustExec:Xr,type:un=NaN,overwriteIfSameType:hn=!1,keepUndo:rn=!1}){if(Xr&&rr(),$t(this,pt))return;const Zt={cmd:rr,undo:Fr,type:un};if($t(this,gt)===-1){$t(this,mt).length>0&&($t(this,mt).length=0),Tr(this,gt,0),$t(this,mt).push(Zt);return}if(hn&&$t(this,mt)[$t(this,gt)].type===un){rn&&(Zt.undo=$t(this,mt)[$t(this,gt)].undo),$t(this,mt)[$t(this,gt)]=Zt;return}const Yt=$t(this,gt)+1;Yt===$t(this,yt)?$t(this,mt).splice(0,1):(Tr(this,gt,Yt),Yt<$t(this,mt).length&&$t(this,mt).splice(Yt)),$t(this,mt).push(Zt)}undo(){$t(this,gt)!==-1&&(Tr(this,pt,!0),$t(this,mt)[$t(this,gt)].undo(),Tr(this,pt,!1),Tr(this,gt,$t(this,gt)-1))}redo(){$t(this,gt)<$t(this,mt).length-1&&(Tr(this,gt,$t(this,gt)+1),Tr(this,pt,!0),$t(this,mt)[$t(this,gt)].cmd(),Tr(this,pt,!1))}hasSomethingToUndo(){return $t(this,gt)!==-1}hasSomethingToRedo(){return $t(this,gt)<$t(this,mt).length-1}destroy(){Tr(this,mt,null)}}mt=new WeakMap,pt=new WeakMap,yt=new WeakMap,gt=new WeakMap,i.CommandManager=nt;class it{constructor(rr){Er(this,vt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Fr}=$.FeatureTest.platform;for(const[Xr,un,hn={}]of rr)for(const rn of Xr){const Zt=rn.startsWith("mac+");Fr&&Zt?(this.callbacks.set(rn.slice(4),{callback:un,options:hn}),this.allKeys.add(rn.split("+").at(-1))):!Fr&&!Zt&&(this.callbacks.set(rn,{callback:un,options:hn}),this.allKeys.add(rn.split("+").at(-1)))}}exec(rr,Fr){if(!this.allKeys.has(Fr.key))return;const Xr=this.callbacks.get(mr(this,vt,du).call(this,Fr));if(!Xr)return;const{callback:un,options:{bubbles:hn=!1,args:rn=[],checker:Zt=null}}=Xr;Zt&&!Zt(rr,Fr)||(un.bind(rr,...rn)(),hn||(Fr.stopPropagation(),Fr.preventDefault()))}}vt=new WeakSet,du=function(rr){rr.altKey&&this.buffer.push("alt"),rr.ctrlKey&&this.buffer.push("ctrl"),rr.metaKey&&this.buffer.push("meta"),rr.shiftKey&&this.buffer.push("shift"),this.buffer.push(rr.key);const Fr=this.buffer.join("+");return this.buffer.length=0,Fr},i.KeyboardManager=it;const At=class At{get _colors(){const rr=new Map([["CanvasText",null],["Canvas",null]]);return(0,j.getColorValues)(rr),(0,$.shadow)(this,"_colors",rr)}convert(rr){const Fr=(0,j.getRGB)(rr);if(!window.matchMedia("(forced-colors: active)").matches)return Fr;for(const[Xr,un]of this._colors)if(un.every((hn,rn)=>hn===Fr[rn]))return At._colorsMapping.get(Xr);return Fr}getHexCode(rr){const Fr=this._colors.get(rr);return Fr?$.Util.makeHexColor(...Fr):rr}};Rn(At,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let st=At;i.ColorManager=st;const bn=class bn{constructor(rr,Fr,Xr,un,hn,rn){Er(this,fr);Er(this,xt,null);Er(this,wt,new Map);Er(this,Ot,new Map);Er(this,Bt,null);Er(this,Ft,null);Er(this,Pt,new nt);Er(this,Rt,0);Er(this,Et,new Set);Er(this,_t,null);Er(this,Mt,null);Er(this,Dt,new Set);Er(this,Lt,null);Er(this,Ct,new tt);Er(this,kt,!1);Er(this,jt,!1);Er(this,Vt,null);Er(this,zt,$.AnnotationEditorType.NONE);Er(this,qt,new Set);Er(this,Wt,null);Er(this,ir,this.blur.bind(this));Er(this,or,this.focus.bind(this));Er(this,Qt,this.copy.bind(this));Er(this,gr,this.cut.bind(this));Er(this,ar,this.paste.bind(this));Er(this,Ar,this.keydown.bind(this));Er(this,er,this.onEditingAction.bind(this));Er(this,sr,this.onPageChanging.bind(this));Er(this,Gt,this.onScaleChanging.bind(this));Er(this,Jt,this.onRotationChanging.bind(this));Er(this,lr,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Er(this,dr,[0,0]);Er(this,xr,null);Er(this,Mr,null);Er(this,Or,null);Tr(this,Mr,rr),Tr(this,Or,Fr),Tr(this,Bt,Xr),this._eventBus=un,this._eventBus._on("editingaction",$t(this,er)),this._eventBus._on("pagechanging",$t(this,sr)),this._eventBus._on("scalechanging",$t(this,Gt)),this._eventBus._on("rotationchanging",$t(this,Jt)),Tr(this,Ft,hn.annotationStorage),Tr(this,Lt,hn.filterFactory),Tr(this,Wt,rn),this.viewParameters={realScale:j.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const rr=bn.prototype,Fr=hn=>{const{activeElement:rn}=document;return rn&&$t(hn,Mr).contains(rn)&&hn.hasSomethingToControl()},Xr=this.TRANSLATE_SMALL,un=this.TRANSLATE_BIG;return(0,$.shadow)(this,"_keyboardManager",new it([[["ctrl+a","mac+meta+a"],rr.selectAll],[["ctrl+z","mac+meta+z"],rr.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],rr.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],rr.delete],[["Escape","mac+Escape"],rr.unselectAll],[["ArrowLeft","mac+ArrowLeft"],rr.translateSelectedEditors,{args:[-Xr,0],checker:Fr}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],rr.translateSelectedEditors,{args:[-un,0],checker:Fr}],[["ArrowRight","mac+ArrowRight"],rr.translateSelectedEditors,{args:[Xr,0],checker:Fr}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],rr.translateSelectedEditors,{args:[un,0],checker:Fr}],[["ArrowUp","mac+ArrowUp"],rr.translateSelectedEditors,{args:[0,-Xr],checker:Fr}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],rr.translateSelectedEditors,{args:[0,-un],checker:Fr}],[["ArrowDown","mac+ArrowDown"],rr.translateSelectedEditors,{args:[0,Xr],checker:Fr}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],rr.translateSelectedEditors,{args:[0,un],checker:Fr}]]))}destroy(){mr(this,fr,$a).call(this),mr(this,fr,Ho).call(this),this._eventBus._off("editingaction",$t(this,er)),this._eventBus._off("pagechanging",$t(this,sr)),this._eventBus._off("scalechanging",$t(this,Gt)),this._eventBus._off("rotationchanging",$t(this,Jt));for(const rr of $t(this,Ot).values())rr.destroy();$t(this,Ot).clear(),$t(this,wt).clear(),$t(this,Dt).clear(),Tr(this,xt,null),$t(this,qt).clear(),$t(this,Pt).destroy(),$t(this,Bt).destroy()}get hcmFilter(){return(0,$.shadow)(this,"hcmFilter",$t(this,Wt)?$t(this,Lt).addHCMFilter($t(this,Wt).foreground,$t(this,Wt).background):"none")}get direction(){return(0,$.shadow)(this,"direction",getComputedStyle($t(this,Mr)).direction)}editAltText(rr){var Fr;(Fr=$t(this,Bt))==null||Fr.editAltText(this,rr)}onPageChanging({pageNumber:rr}){Tr(this,Rt,rr-1)}focusMainContainer(){$t(this,Mr).focus()}findParent(rr,Fr){for(const Xr of $t(this,Ot).values()){const{x:un,y:hn,width:rn,height:Zt}=Xr.div.getBoundingClientRect();if(rr>=un&&rr<=un+rn&&Fr>=hn&&Fr<=hn+Zt)return Xr}return null}disableUserSelect(rr=!1){$t(this,Or).classList.toggle("noUserSelect",rr)}addShouldRescale(rr){$t(this,Dt).add(rr)}removeShouldRescale(rr){$t(this,Dt).delete(rr)}onScaleChanging({scale:rr}){this.commitOrRemove(),this.viewParameters.realScale=rr*j.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Fr of $t(this,Dt))Fr.onScaleChanging()}onRotationChanging({pagesRotation:rr}){this.commitOrRemove(),this.viewParameters.rotation=rr}addToAnnotationStorage(rr){!rr.isEmpty()&&$t(this,Ft)&&!$t(this,Ft).has(rr.id)&&$t(this,Ft).setValue(rr.id,rr)}blur(){if(!this.hasSelection)return;const{activeElement:rr}=document;for(const Fr of $t(this,qt))if(Fr.div.contains(rr)){Tr(this,Vt,[Fr,rr]),Fr._focusEventsAllowed=!1;break}}focus(){if(!$t(this,Vt))return;const[rr,Fr]=$t(this,Vt);Tr(this,Vt,null),Fr.addEventListener("focusin",()=>{rr._focusEventsAllowed=!0},{once:!0}),Fr.focus()}addEditListeners(){mr(this,fr,Ko).call(this),mr(this,fr,Wo).call(this)}removeEditListeners(){mr(this,fr,$a).call(this),mr(this,fr,zo).call(this)}copy(rr){var Xr;if(rr.preventDefault(),(Xr=$t(this,xt))==null||Xr.commitOrRemove(),!this.hasSelection)return;const Fr=[];for(const un of $t(this,qt)){const hn=un.serialize(!0);hn&&Fr.push(hn)}Fr.length!==0&&rr.clipboardData.setData("application/pdfjs",JSON.stringify(Fr))}cut(rr){this.copy(rr),this.delete()}paste(rr){rr.preventDefault();const{clipboardData:Fr}=rr;for(const hn of Fr.items)for(const rn of $t(this,Mt))if(rn.isHandlingMimeForPasting(hn.type)){rn.paste(hn,this.currentLayer);return}let Xr=Fr.getData("application/pdfjs");if(!Xr)return;try{Xr=JSON.parse(Xr)}catch(hn){(0,$.warn)(`paste: "${hn.message}".`);return}if(!Array.isArray(Xr))return;this.unselectAll();const un=this.currentLayer;try{const hn=[];for(const Yt of Xr){const hr=un.deserialize(Yt);if(!hr)return;hn.push(hr)}const rn=()=>{for(const Yt of hn)mr(this,fr,qo).call(this,Yt);mr(this,fr,Yo).call(this,hn)},Zt=()=>{for(const Yt of hn)Yt.remove()};this.addCommands({cmd:rn,undo:Zt,mustExec:!0})}catch(hn){(0,$.warn)(`paste: "${hn.message}".`)}}keydown(rr){var Fr;(Fr=this.getActive())!=null&&Fr.shouldGetKeyboardEvents()||bn._keyboardManager.exec(this,rr)}onEditingAction(rr){["undo","redo","delete","selectAll"].includes(rr.name)&&this[rr.name]()}setEditingState(rr){rr?(mr(this,fr,pu).call(this),mr(this,fr,Ko).call(this),mr(this,fr,Wo).call(this),mr(this,fr,Xn).call(this,{isEditing:$t(this,zt)!==$.AnnotationEditorType.NONE,isEmpty:mr(this,fr,Ms).call(this),hasSomethingToUndo:$t(this,Pt).hasSomethingToUndo(),hasSomethingToRedo:$t(this,Pt).hasSomethingToRedo(),hasSelectedEditor:!1})):(mr(this,fr,Ho).call(this),mr(this,fr,$a).call(this),mr(this,fr,zo).call(this),mr(this,fr,Xn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(rr){if(!$t(this,Mt)){Tr(this,Mt,rr);for(const Fr of $t(this,Mt))mr(this,fr,Ds).call(this,Fr.defaultPropertiesToUpdate)}}getId(){return $t(this,Ct).getId()}get currentLayer(){return $t(this,Ot).get($t(this,Rt))}getLayer(rr){return $t(this,Ot).get(rr)}get currentPageIndex(){return $t(this,Rt)}addLayer(rr){$t(this,Ot).set(rr.pageIndex,rr),$t(this,kt)?rr.enable():rr.disable()}removeLayer(rr){$t(this,Ot).delete(rr.pageIndex)}updateMode(rr,Fr=null){if($t(this,zt)!==rr){if(Tr(this,zt,rr),rr===$.AnnotationEditorType.NONE){this.setEditingState(!1),mr(this,fr,gu).call(this);return}this.setEditingState(!0),mr(this,fr,mu).call(this),this.unselectAll();for(const Xr of $t(this,Ot).values())Xr.updateMode(rr);if(Fr){for(const Xr of $t(this,wt).values())if(Xr.annotationElementId===Fr){this.setSelected(Xr),Xr.enterInEditMode();break}}}}updateToolbar(rr){rr!==$t(this,zt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:rr})}updateParams(rr,Fr){if($t(this,Mt)){if(rr===$.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(rr);return}for(const Xr of $t(this,qt))Xr.updateParams(rr,Fr);for(const Xr of $t(this,Mt))Xr.updateDefaultParams(rr,Fr)}}enableWaiting(rr=!1){if($t(this,jt)!==rr){Tr(this,jt,rr);for(const Fr of $t(this,Ot).values())rr?Fr.disableClick():Fr.enableClick(),Fr.div.classList.toggle("waiting",rr)}}getEditors(rr){const Fr=[];for(const Xr of $t(this,wt).values())Xr.pageIndex===rr&&Fr.push(Xr);return Fr}getEditor(rr){return $t(this,wt).get(rr)}addEditor(rr){$t(this,wt).set(rr.id,rr)}removeEditor(rr){var Fr;$t(this,wt).delete(rr.id),this.unselect(rr),(!rr.annotationElementId||!$t(this,Et).has(rr.annotationElementId))&&((Fr=$t(this,Ft))==null||Fr.remove(rr.id))}addDeletedAnnotationElement(rr){$t(this,Et).add(rr.annotationElementId),rr.deleted=!0}isDeletedAnnotationElement(rr){return $t(this,Et).has(rr)}removeDeletedAnnotationElement(rr){$t(this,Et).delete(rr.annotationElementId),rr.deleted=!1}setActiveEditor(rr){$t(this,xt)!==rr&&(Tr(this,xt,rr),rr&&mr(this,fr,Ds).call(this,rr.propertiesToUpdate))}toggleSelected(rr){if($t(this,qt).has(rr)){$t(this,qt).delete(rr),rr.unselect(),mr(this,fr,Xn).call(this,{hasSelectedEditor:this.hasSelection});return}$t(this,qt).add(rr),rr.select(),mr(this,fr,Ds).call(this,rr.propertiesToUpdate),mr(this,fr,Xn).call(this,{hasSelectedEditor:!0})}setSelected(rr){for(const Fr of $t(this,qt))Fr!==rr&&Fr.unselect();$t(this,qt).clear(),$t(this,qt).add(rr),rr.select(),mr(this,fr,Ds).call(this,rr.propertiesToUpdate),mr(this,fr,Xn).call(this,{hasSelectedEditor:!0})}isSelected(rr){return $t(this,qt).has(rr)}unselect(rr){rr.unselect(),$t(this,qt).delete(rr),mr(this,fr,Xn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return $t(this,qt).size!==0}undo(){$t(this,Pt).undo(),mr(this,fr,Xn).call(this,{hasSomethingToUndo:$t(this,Pt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:mr(this,fr,Ms).call(this)})}redo(){$t(this,Pt).redo(),mr(this,fr,Xn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:$t(this,Pt).hasSomethingToRedo(),isEmpty:mr(this,fr,Ms).call(this)})}addCommands(rr){$t(this,Pt).add(rr),mr(this,fr,Xn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:mr(this,fr,Ms).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const rr=[...$t(this,qt)],Fr=()=>{for(const un of rr)un.remove()},Xr=()=>{for(const un of rr)mr(this,fr,qo).call(this,un)};this.addCommands({cmd:Fr,undo:Xr,mustExec:!0})}commitOrRemove(){var rr;(rr=$t(this,xt))==null||rr.commitOrRemove()}hasSomethingToControl(){return $t(this,xt)||this.hasSelection}selectAll(){for(const rr of $t(this,qt))rr.commit();mr(this,fr,Yo).call(this,$t(this,wt).values())}unselectAll(){if($t(this,xt)){$t(this,xt).commitOrRemove();return}if(this.hasSelection){for(const rr of $t(this,qt))rr.unselect();$t(this,qt).clear(),mr(this,fr,Xn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(rr,Fr,Xr=!1){if(Xr||this.commitOrRemove(),!this.hasSelection)return;$t(this,dr)[0]+=rr,$t(this,dr)[1]+=Fr;const[un,hn]=$t(this,dr),rn=[...$t(this,qt)],Zt=1e3;$t(this,xr)&&clearTimeout($t(this,xr)),Tr(this,xr,setTimeout(()=>{Tr(this,xr,null),$t(this,dr)[0]=$t(this,dr)[1]=0,this.addCommands({cmd:()=>{for(const Yt of rn)$t(this,wt).has(Yt.id)&&Yt.translateInPage(un,hn)},undo:()=>{for(const Yt of rn)$t(this,wt).has(Yt.id)&&Yt.translateInPage(-un,-hn)},mustExec:!1})},Zt));for(const Yt of rn)Yt.translateInPage(rr,Fr)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Tr(this,_t,new Map);for(const rr of $t(this,qt))$t(this,_t).set(rr,{savedX:rr.x,savedY:rr.y,savedPageIndex:rr.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!$t(this,_t))return!1;this.disableUserSelect(!1);const rr=$t(this,_t);Tr(this,_t,null);let Fr=!1;for(const[{x:un,y:hn,pageIndex:rn},Zt]of rr)Zt.newX=un,Zt.newY=hn,Zt.newPageIndex=rn,Fr||(Fr=un!==Zt.savedX||hn!==Zt.savedY||rn!==Zt.savedPageIndex);if(!Fr)return!1;const Xr=(un,hn,rn,Zt)=>{if($t(this,wt).has(un.id)){const Yt=$t(this,Ot).get(Zt);Yt?un._setParentAndPosition(Yt,hn,rn):(un.pageIndex=Zt,un.x=hn,un.y=rn)}};return this.addCommands({cmd:()=>{for(const[un,{newX:hn,newY:rn,newPageIndex:Zt}]of rr)Xr(un,hn,rn,Zt)},undo:()=>{for(const[un,{savedX:hn,savedY:rn,savedPageIndex:Zt}]of rr)Xr(un,hn,rn,Zt)},mustExec:!0}),!0}dragSelectedEditors(rr,Fr){if($t(this,_t))for(const Xr of $t(this,_t).keys())Xr.drag(rr,Fr)}rebuild(rr){if(rr.parent===null){const Fr=this.getLayer(rr.pageIndex);Fr?(Fr.changeParent(rr),Fr.addOrRebuild(rr)):(this.addEditor(rr),this.addToAnnotationStorage(rr),rr.rebuild())}else rr.parent.addOrRebuild(rr)}isActive(rr){return $t(this,xt)===rr}getActive(){return $t(this,xt)}getMode(){return $t(this,zt)}get imageManager(){return(0,$.shadow)(this,"imageManager",new rt)}};xt=new WeakMap,wt=new WeakMap,Ot=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Pt=new WeakMap,Rt=new WeakMap,Et=new WeakMap,_t=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,Ct=new WeakMap,kt=new WeakMap,jt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,qt=new WeakMap,Wt=new WeakMap,ir=new WeakMap,or=new WeakMap,Qt=new WeakMap,gr=new WeakMap,ar=new WeakMap,Ar=new WeakMap,er=new WeakMap,sr=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,lr=new WeakMap,dr=new WeakMap,xr=new WeakMap,Mr=new WeakMap,Or=new WeakMap,fr=new WeakSet,pu=function(){window.addEventListener("focus",$t(this,or)),window.addEventListener("blur",$t(this,ir))},Ho=function(){window.removeEventListener("focus",$t(this,or)),window.removeEventListener("blur",$t(this,ir))},Ko=function(){window.addEventListener("keydown",$t(this,Ar),{capture:!0})},$a=function(){window.removeEventListener("keydown",$t(this,Ar),{capture:!0})},Wo=function(){document.addEventListener("copy",$t(this,Qt)),document.addEventListener("cut",$t(this,gr)),document.addEventListener("paste",$t(this,ar))},zo=function(){document.removeEventListener("copy",$t(this,Qt)),document.removeEventListener("cut",$t(this,gr)),document.removeEventListener("paste",$t(this,ar))},Xn=function(rr){Object.entries(rr).some(([Xr,un])=>$t(this,lr)[Xr]!==un)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign($t(this,lr),rr)})},Ds=function(rr){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:rr})},mu=function(){if(!$t(this,kt)){Tr(this,kt,!0);for(const rr of $t(this,Ot).values())rr.enable()}},gu=function(){if(this.unselectAll(),$t(this,kt)){Tr(this,kt,!1);for(const rr of $t(this,Ot).values())rr.disable()}},qo=function(rr){const Fr=$t(this,Ot).get(rr.pageIndex);Fr?Fr.addOrRebuild(rr):this.addEditor(rr)},Ms=function(){if($t(this,wt).size===0)return!0;if($t(this,wt).size===1)for(const rr of $t(this,wt).values())return rr.isEmpty();return!1},Yo=function(rr){$t(this,qt).clear();for(const Fr of rr)Fr.isEmpty()||($t(this,qt).add(Fr),Fr.select());mr(this,fr,Xn).call(this,{hasSelectedEditor:!0})},Rn(bn,"TRANSLATE_SMALL",1),Rn(bn,"TRANSLATE_BIG",10);let at=bn;i.AnnotationEditorUIManager=at},(o,i,_)=>{var Rt,Et,_t,Mt,Dt,Lt,Ct,kt,jt,Vt,zt,qt,Ss,Es,Xo,eo,to,Fs,Ns;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=void 0,i.deprecated=gt,i.getColorValues=wt,i.getCurrentTransform=Ot,i.getCurrentTransformInverse=Bt,i.getFilenameFromUrl=ut,i.getPdfFilenameFromUrl=ht,i.getRGB=xt,i.getXfaPageViewport=At,i.isDataScheme=ct,i.isPdfFile=ft,i.isValidFetchUrl=mt,i.loadScript=yt,i.noContextMenu=pt,i.setLayerDimensions=Ft;var $=_(7),j=_(1);const _e="http://www.w3.org/2000/svg",Pt=class Pt{};Rn(Pt,"CSS",96),Rn(Pt,"PDF",72),Rn(Pt,"PDF_TO_CSS_UNITS",Pt.CSS/Pt.PDF);let et=Pt;i.PixelsPerInch=et;class tt extends $.BaseFilterFactory{constructor({docId:Gt,ownerDocument:Jt=globalThis.document}={}){super();Er(this,qt);Er(this,Rt);Er(this,Et);Er(this,_t);Er(this,Mt);Er(this,Dt);Er(this,Lt);Er(this,Ct);Er(this,kt);Er(this,jt);Er(this,Vt);Er(this,zt,0);Tr(this,_t,Gt),Tr(this,Mt,Jt)}addFilter(Gt){if(!Gt)return"none";let Jt=$t(this,qt,Ss).get(Gt);if(Jt)return Jt;let lr,dr,xr,Mr;if(Gt.length===1){const Gr=Gt[0],dn=new Array(256);for(let nn=0;nn<256;nn++)dn[nn]=Gr[nn]/255;Mr=lr=dr=xr=dn.join(",")}else{const[Gr,dn,nn]=Gt,vn=new Array(256),Jr=new Array(256),an=new Array(256);for(let yn=0;yn<256;yn++)vn[yn]=Gr[yn]/255,Jr[yn]=dn[yn]/255,an[yn]=nn[yn]/255;lr=vn.join(","),dr=Jr.join(","),xr=an.join(","),Mr=`${lr}${dr}${xr}`}if(Jt=$t(this,qt,Ss).get(Mr),Jt)return $t(this,qt,Ss).set(Gt,Jt),Jt;const Or=`g_${$t(this,_t)}_transfer_map_${Os(this,zt)._++}`,fr=`url(#${Or})`;$t(this,qt,Ss).set(Gt,fr),$t(this,qt,Ss).set(Mr,fr);const Hr=mr(this,qt,eo).call(this,Or);return mr(this,qt,Fs).call(this,lr,dr,xr,Hr),fr}addHCMFilter(Gt,Jt){var dn;const lr=`${Gt}-${Jt}`;if($t(this,Lt)===lr)return $t(this,Ct);if(Tr(this,Lt,lr),Tr(this,Ct,"none"),(dn=$t(this,Dt))==null||dn.remove(),!Gt||!Jt)return $t(this,Ct);const dr=mr(this,qt,Ns).call(this,Gt);Gt=j.Util.makeHexColor(...dr);const xr=mr(this,qt,Ns).call(this,Jt);if(Jt=j.Util.makeHexColor(...xr),$t(this,qt,Es).style.color="",Gt==="#000000"&&Jt==="#ffffff"||Gt===Jt)return $t(this,Ct);const Mr=new Array(256);for(let nn=0;nn<=255;nn++){const vn=nn/255;Mr[nn]=vn<=.03928?vn/12.92:((vn+.055)/1.055)**2.4}const Or=Mr.join(","),fr=`g_${$t(this,_t)}_hcm_filter`,Hr=Tr(this,kt,mr(this,qt,eo).call(this,fr));mr(this,qt,Fs).call(this,Or,Or,Or,Hr),mr(this,qt,Xo).call(this,Hr);const Gr=(nn,vn)=>{const Jr=dr[nn]/255,an=xr[nn]/255,yn=new Array(vn+1);for(let _n=0;_n<=vn;_n++)yn[_n]=Jr+_n/vn*(an-Jr);return yn.join(",")};return mr(this,qt,Fs).call(this,Gr(0,5),Gr(1,5),Gr(2,5),Hr),Tr(this,Ct,`url(#${fr})`),$t(this,Ct)}addHighlightHCMFilter(Gt,Jt,lr,dr){var an;const xr=`${Gt}-${Jt}-${lr}-${dr}`;if($t(this,jt)===xr)return $t(this,Vt);if(Tr(this,jt,xr),Tr(this,Vt,"none"),(an=$t(this,kt))==null||an.remove(),!Gt||!Jt)return $t(this,Vt);const[Mr,Or]=[Gt,Jt].map(mr(this,qt,Ns).bind(this));let fr=Math.round(.2126*Mr[0]+.7152*Mr[1]+.0722*Mr[2]),Hr=Math.round(.2126*Or[0]+.7152*Or[1]+.0722*Or[2]),[Gr,dn]=[lr,dr].map(mr(this,qt,Ns).bind(this));Hr<fr&&([fr,Hr,Gr,dn]=[Hr,fr,dn,Gr]),$t(this,qt,Es).style.color="";const nn=(yn,_n,jr)=>{const cr=new Array(256),Sr=(Hr-fr)/jr,en=yn/255,bn=(_n-yn)/(255*jr);let qr=0;for(let rr=0;rr<=jr;rr++){const Fr=Math.round(fr+rr*Sr),Xr=en+rr*bn;for(let un=qr;un<=Fr;un++)cr[un]=Xr;qr=Fr+1}for(let rr=qr;rr<256;rr++)cr[rr]=cr[qr-1];return cr.join(",")},vn=`g_${$t(this,_t)}_hcm_highlight_filter`,Jr=Tr(this,kt,mr(this,qt,eo).call(this,vn));return mr(this,qt,Xo).call(this,Jr),mr(this,qt,Fs).call(this,nn(Gr[0],dn[0],5),nn(Gr[1],dn[1],5),nn(Gr[2],dn[2],5),Jr),Tr(this,Vt,`url(#${vn})`),$t(this,Vt)}destroy(Gt=!1){Gt&&($t(this,Ct)||$t(this,Vt))||($t(this,Et)&&($t(this,Et).parentNode.parentNode.remove(),Tr(this,Et,null)),$t(this,Rt)&&($t(this,Rt).clear(),Tr(this,Rt,null)),Tr(this,zt,0))}}Rt=new WeakMap,Et=new WeakMap,_t=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,Ct=new WeakMap,kt=new WeakMap,jt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,qt=new WeakSet,Ss=function(){return $t(this,Rt)||Tr(this,Rt,new Map)},Es=function(){if(!$t(this,Et)){const Gt=$t(this,Mt).createElement("div"),{style:Jt}=Gt;Jt.visibility="hidden",Jt.contain="strict",Jt.width=Jt.height=0,Jt.position="absolute",Jt.top=Jt.left=0,Jt.zIndex=-1;const lr=$t(this,Mt).createElementNS(_e,"svg");lr.setAttribute("width",0),lr.setAttribute("height",0),Tr(this,Et,$t(this,Mt).createElementNS(_e,"defs")),Gt.append(lr),lr.append($t(this,Et)),$t(this,Mt).body.append(Gt)}return $t(this,Et)},Xo=function(Gt){const Jt=$t(this,Mt).createElementNS(_e,"feColorMatrix");Jt.setAttribute("type","matrix"),Jt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Gt.append(Jt)},eo=function(Gt){const Jt=$t(this,Mt).createElementNS(_e,"filter");return Jt.setAttribute("color-interpolation-filters","sRGB"),Jt.setAttribute("id",Gt),$t(this,qt,Es).append(Jt),Jt},to=function(Gt,Jt,lr){const dr=$t(this,Mt).createElementNS(_e,Jt);dr.setAttribute("type","discrete"),dr.setAttribute("tableValues",lr),Gt.append(dr)},Fs=function(Gt,Jt,lr,dr){const xr=$t(this,Mt).createElementNS(_e,"feComponentTransfer");dr.append(xr),mr(this,qt,to).call(this,xr,"feFuncR",Gt),mr(this,qt,to).call(this,xr,"feFuncG",Jt),mr(this,qt,to).call(this,xr,"feFuncB",lr)},Ns=function(Gt){return $t(this,qt,Es).style.color=Gt,xt(getComputedStyle($t(this,qt,Es)).getPropertyValue("color"))},i.DOMFilterFactory=tt;class rt extends $.BaseCanvasFactory{constructor({ownerDocument:sr=globalThis.document}={}){super(),this._document=sr}_createCanvas(sr,Gt){const Jt=this._document.createElement("canvas");return Jt.width=sr,Jt.height=Gt,Jt}}i.DOMCanvasFactory=rt;async function nt(er,sr=!1){if(mt(er,document.baseURI)){const Gt=await fetch(er);if(!Gt.ok)throw new Error(Gt.statusText);return sr?new Uint8Array(await Gt.arrayBuffer()):(0,j.stringToBytes)(await Gt.text())}return new Promise((Gt,Jt)=>{const lr=new XMLHttpRequest;lr.open("GET",er,!0),sr&&(lr.responseType="arraybuffer"),lr.onreadystatechange=()=>{if(lr.readyState===XMLHttpRequest.DONE){if(lr.status===200||lr.status===0){let dr;if(sr&&lr.response?dr=new Uint8Array(lr.response):!sr&&lr.responseText&&(dr=(0,j.stringToBytes)(lr.responseText)),dr){Gt(dr);return}}Jt(new Error(lr.statusText))}},lr.send(null)})}class it extends $.BaseCMapReaderFactory{_fetchData(sr,Gt){return nt(sr,this.isCompressed).then(Jt=>({cMapData:Jt,compressionType:Gt}))}}i.DOMCMapReaderFactory=it;class st extends $.BaseStandardFontDataFactory{_fetchData(sr){return nt(sr,!0)}}i.DOMStandardFontDataFactory=st;class at extends $.BaseSVGFactory{_createSVG(sr){return document.createElementNS(_e,sr)}}i.DOMSVGFactory=at;class ot{constructor({viewBox:sr,scale:Gt,rotation:Jt,offsetX:lr=0,offsetY:dr=0,dontFlip:xr=!1}){this.viewBox=sr,this.scale=Gt,this.rotation=Jt,this.offsetX=lr,this.offsetY=dr;const Mr=(sr[2]+sr[0])/2,Or=(sr[3]+sr[1])/2;let fr,Hr,Gr,dn;switch(Jt%=360,Jt<0&&(Jt+=360),Jt){case 180:fr=-1,Hr=0,Gr=0,dn=1;break;case 90:fr=0,Hr=1,Gr=1,dn=0;break;case 270:fr=0,Hr=-1,Gr=-1,dn=0;break;case 0:fr=1,Hr=0,Gr=0,dn=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}xr&&(Gr=-Gr,dn=-dn);let nn,vn,Jr,an;fr===0?(nn=Math.abs(Or-sr[1])*Gt+lr,vn=Math.abs(Mr-sr[0])*Gt+dr,Jr=(sr[3]-sr[1])*Gt,an=(sr[2]-sr[0])*Gt):(nn=Math.abs(Mr-sr[0])*Gt+lr,vn=Math.abs(Or-sr[1])*Gt+dr,Jr=(sr[2]-sr[0])*Gt,an=(sr[3]-sr[1])*Gt),this.transform=[fr*Gt,Hr*Gt,Gr*Gt,dn*Gt,nn-fr*Gt*Mr-Gr*Gt*Or,vn-Hr*Gt*Mr-dn*Gt*Or],this.width=Jr,this.height=an}get rawDims(){const{viewBox:sr}=this;return(0,j.shadow)(this,"rawDims",{pageWidth:sr[2]-sr[0],pageHeight:sr[3]-sr[1],pageX:sr[0],pageY:sr[1]})}clone({scale:sr=this.scale,rotation:Gt=this.rotation,offsetX:Jt=this.offsetX,offsetY:lr=this.offsetY,dontFlip:dr=!1}={}){return new ot({viewBox:this.viewBox.slice(),scale:sr,rotation:Gt,offsetX:Jt,offsetY:lr,dontFlip:dr})}convertToViewportPoint(sr,Gt){return j.Util.applyTransform([sr,Gt],this.transform)}convertToViewportRectangle(sr){const Gt=j.Util.applyTransform([sr[0],sr[1]],this.transform),Jt=j.Util.applyTransform([sr[2],sr[3]],this.transform);return[Gt[0],Gt[1],Jt[0],Jt[1]]}convertToPdfPoint(sr,Gt){return j.Util.applyInverseTransform([sr,Gt],this.transform)}}i.PageViewport=ot;class lt extends j.BaseException{constructor(sr,Gt=0){super(sr,"RenderingCancelledException"),this.extraDelay=Gt}}i.RenderingCancelledException=lt;function ct(er){const sr=er.length;let Gt=0;for(;Gt<sr&&er[Gt].trim()==="";)Gt++;return er.substring(Gt,Gt+5).toLowerCase()==="data:"}function ft(er){return typeof er=="string"&&/\.pdf$/i.test(er)}function ut(er,sr=!1){return sr||([er]=er.split(/[#?]/,1)),er.substring(er.lastIndexOf("/")+1)}function ht(er,sr="document.pdf"){if(typeof er!="string")return sr;if(ct(er))return(0,j.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),sr;const Gt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Jt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,lr=Gt.exec(er);let dr=Jt.exec(lr[1])||Jt.exec(lr[2])||Jt.exec(lr[3]);if(dr&&(dr=dr[0],dr.includes("%")))try{dr=Jt.exec(decodeURIComponent(dr))[0]}catch{}return dr||sr}class dt{constructor(){Rn(this,"started",Object.create(null));Rn(this,"times",[])}time(sr){sr in this.started&&(0,j.warn)(`Timer is already running for ${sr}`),this.started[sr]=Date.now()}timeEnd(sr){sr in this.started||(0,j.warn)(`Timer has not been started for ${sr}`),this.times.push({name:sr,start:this.started[sr],end:Date.now()}),delete this.started[sr]}toString(){const sr=[];let Gt=0;for(const{name:Jt}of this.times)Gt=Math.max(Jt.length,Gt);for(const{name:Jt,start:lr,end:dr}of this.times)sr.push(`${Jt.padEnd(Gt)} ${dr-lr}ms
`);return sr.join("")}}i.StatTimer=dt;function mt(er,sr){try{const{protocol:Gt}=sr?new URL(er,sr):new URL(er);return Gt==="http:"||Gt==="https:"}catch{return!1}}function pt(er){er.preventDefault()}function yt(er,sr=!1){return new Promise((Gt,Jt)=>{const lr=document.createElement("script");lr.src=er,lr.onload=function(dr){sr&&lr.remove(),Gt(dr)},lr.onerror=function(){Jt(new Error(`Cannot load script at: ${lr.src}`))},(document.head||document.documentElement).append(lr)})}function gt(er){console.log("Deprecated API usage: "+er)}let vt;class St{static toDateObject(sr){if(!sr||typeof sr!="string")return null;vt||(vt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Gt=vt.exec(sr);if(!Gt)return null;const Jt=parseInt(Gt[1],10);let lr=parseInt(Gt[2],10);lr=lr>=1&&lr<=12?lr-1:0;let dr=parseInt(Gt[3],10);dr=dr>=1&&dr<=31?dr:1;let xr=parseInt(Gt[4],10);xr=xr>=0&&xr<=23?xr:0;let Mr=parseInt(Gt[5],10);Mr=Mr>=0&&Mr<=59?Mr:0;let Or=parseInt(Gt[6],10);Or=Or>=0&&Or<=59?Or:0;const fr=Gt[7]||"Z";let Hr=parseInt(Gt[8],10);Hr=Hr>=0&&Hr<=23?Hr:0;let Gr=parseInt(Gt[9],10)||0;return Gr=Gr>=0&&Gr<=59?Gr:0,fr==="-"?(xr+=Hr,Mr+=Gr):fr==="+"&&(xr-=Hr,Mr-=Gr),new Date(Date.UTC(Jt,lr,dr,xr,Mr,Or))}}i.PDFDateString=St;function At(er,{scale:sr=1,rotation:Gt=0}){const{width:Jt,height:lr}=er.attributes.style,dr=[0,0,parseInt(Jt),parseInt(lr)];return new ot({viewBox:dr,scale:sr,rotation:Gt})}function xt(er){if(er.startsWith("#")){const sr=parseInt(er.slice(1),16);return[(sr&16711680)>>16,(sr&65280)>>8,sr&255]}return er.startsWith("rgb(")?er.slice(4,-1).split(",").map(sr=>parseInt(sr)):er.startsWith("rgba(")?er.slice(5,-1).split(",").map(sr=>parseInt(sr)).slice(0,3):((0,j.warn)(`Not a valid color format: "${er}"`),[0,0,0])}function wt(er){const sr=document.createElement("span");sr.style.visibility="hidden",document.body.append(sr);for(const Gt of er.keys()){sr.style.color=Gt;const Jt=window.getComputedStyle(sr).color;er.set(Gt,xt(Jt))}sr.remove()}function Ot(er){const{a:sr,b:Gt,c:Jt,d:lr,e:dr,f:xr}=er.getTransform();return[sr,Gt,Jt,lr,dr,xr]}function Bt(er){const{a:sr,b:Gt,c:Jt,d:lr,e:dr,f:xr}=er.getTransform().invertSelf();return[sr,Gt,Jt,lr,dr,xr]}function Ft(er,sr,Gt=!1,Jt=!0){if(sr instanceof ot){const{pageWidth:lr,pageHeight:dr}=sr.rawDims,{style:xr}=er,Mr=j.FeatureTest.isCSSRoundSupported,Or=`var(--scale-factor) * ${lr}px`,fr=`var(--scale-factor) * ${dr}px`,Hr=Mr?`round(${Or}, 1px)`:`calc(${Or})`,Gr=Mr?`round(${fr}, 1px)`:`calc(${fr})`;!Gt||sr.rotation%180===0?(xr.width=Hr,xr.height=Gr):(xr.width=Gr,xr.height=Hr)}Jt&&er.setAttribute("data-main-rotation",sr.rotation)}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var $=_(1);class j{constructor(){this.constructor===j&&(0,$.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(it){return"none"}addHCMFilter(it,st){return"none"}addHighlightHCMFilter(it,st,at,ot){return"none"}destroy(it=!1){}}i.BaseFilterFactory=j;class _e{constructor(){this.constructor===_e&&(0,$.unreachable)("Cannot initialize BaseCanvasFactory.")}create(it,st){if(it<=0||st<=0)throw new Error("Invalid canvas size");const at=this._createCanvas(it,st);return{canvas:at,context:at.getContext("2d")}}reset(it,st,at){if(!it.canvas)throw new Error("Canvas is not specified");if(st<=0||at<=0)throw new Error("Invalid canvas size");it.canvas.width=st,it.canvas.height=at}destroy(it){if(!it.canvas)throw new Error("Canvas is not specified");it.canvas.width=0,it.canvas.height=0,it.canvas=null,it.context=null}_createCanvas(it,st){(0,$.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=_e;class et{constructor({baseUrl:it=null,isCompressed:st=!0}){this.constructor===et&&(0,$.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=it,this.isCompressed=st}async fetch({name:it}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!it)throw new Error("CMap name must be specified.");const st=this.baseUrl+it+(this.isCompressed?".bcmap":""),at=this.isCompressed?$.CMapCompressionType.BINARY:$.CMapCompressionType.NONE;return this._fetchData(st,at).catch(ot=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${st}`)})}_fetchData(it,st){(0,$.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=et;class tt{constructor({baseUrl:it=null}){this.constructor===tt&&(0,$.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=it}async fetch({filename:it}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!it)throw new Error("Font filename must be specified.");const st=`${this.baseUrl}${it}`;return this._fetchData(st).catch(at=>{throw new Error(`Unable to load font data at: ${st}`)})}_fetchData(it){(0,$.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=tt;class rt{constructor(){this.constructor===rt&&(0,$.unreachable)("Cannot initialize BaseSVGFactory.")}create(it,st,at=!1){if(it<=0||st<=0)throw new Error("Invalid SVG dimensions");const ot=this._createSVG("svg:svg");return ot.setAttribute("version","1.1"),at||(ot.setAttribute("width",`${it}px`),ot.setAttribute("height",`${st}px`)),ot.setAttribute("preserveAspectRatio","none"),ot.setAttribute("viewBox",`0 0 ${it} ${st}`),ot}createElement(it){if(typeof it!="string")throw new Error("Invalid SVG element type");return this._createSVG(it)}_createSVG(it){(0,$.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=rt},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var $=_(1);const j=3285377520,_e=4294901760,et=65535;class tt{constructor(nt){this.h1=nt?nt&4294967295:j,this.h2=nt?nt&4294967295:j}update(nt){let it,st;if(typeof nt=="string"){it=new Uint8Array(nt.length*2),st=0;for(let gt=0,vt=nt.length;gt<vt;gt++){const St=nt.charCodeAt(gt);St<=255?it[st++]=St:(it[st++]=St>>>8,it[st++]=St&255)}}else if((0,$.isArrayBuffer)(nt))it=nt.slice(),st=it.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const at=st>>2,ot=st-at*4,lt=new Uint32Array(it.buffer,0,at);let ct=0,ft=0,ut=this.h1,ht=this.h2;const dt=3432918353,mt=461845907,pt=dt&et,yt=mt&et;for(let gt=0;gt<at;gt++)gt&1?(ct=lt[gt],ct=ct*dt&_e|ct*pt&et,ct=ct<<15|ct>>>17,ct=ct*mt&_e|ct*yt&et,ut^=ct,ut=ut<<13|ut>>>19,ut=ut*5+3864292196):(ft=lt[gt],ft=ft*dt&_e|ft*pt&et,ft=ft<<15|ft>>>17,ft=ft*mt&_e|ft*yt&et,ht^=ft,ht=ht<<13|ht>>>19,ht=ht*5+3864292196);switch(ct=0,ot){case 3:ct^=it[at*4+2]<<16;case 2:ct^=it[at*4+1]<<8;case 1:ct^=it[at*4],ct=ct*dt&_e|ct*pt&et,ct=ct<<15|ct>>>17,ct=ct*mt&_e|ct*yt&et,at&1?ut^=ct:ht^=ct}this.h1=ut,this.h2=ht}hexdigest(){let nt=this.h1,it=this.h2;return nt^=it>>>1,nt=nt*3981806797&_e|nt*36045&et,it=it*4283543511&_e|((it<<16|nt>>>16)*2950163797&_e)>>>16,nt^=it>>>1,nt=nt*444984403&_e|nt*60499&et,it=it*3301882366&_e|((it<<16|nt>>>16)*3120437893&_e)>>>16,nt^=it>>>1,(nt>>>0).toString(16).padStart(8,"0")+(it>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=tt},(o,i,_)=>{var et;Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var $=_(1);class j{constructor({ownerDocument:rt=globalThis.document,styleElement:nt=null}){Er(this,et,new Set);this._document=rt,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(rt){this.nativeFontFaces.add(rt),this._document.fonts.add(rt)}removeNativeFontFace(rt){this.nativeFontFaces.delete(rt),this._document.fonts.delete(rt)}insertRule(rt){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const nt=this.styleElement.sheet;nt.insertRule(rt,nt.cssRules.length)}clear(){for(const rt of this.nativeFontFaces)this._document.fonts.delete(rt);this.nativeFontFaces.clear(),$t(this,et).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(rt){if(!(!rt||$t(this,et).has(rt.loadedName))){if((0,$.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:nt,src:it,style:st}=rt,at=new FontFace(nt,it,st);this.addNativeFontFace(at);try{await at.load(),$t(this,et).add(nt)}catch{(0,$.warn)(`Cannot load system font: ${rt.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(at)}return}(0,$.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(rt){if(rt.attached||rt.missingFile&&!rt.systemFontInfo)return;if(rt.attached=!0,rt.systemFontInfo){await this.loadSystemFont(rt.systemFontInfo);return}if(this.isFontLoadingAPISupported){const it=rt.createNativeFontFace();if(it){this.addNativeFontFace(it);try{await it.loaded}catch(st){throw(0,$.warn)(`Failed to load font '${it.family}': '${st}'.`),rt.disableFontFace=!0,st}}return}const nt=rt.createFontFaceRule();if(nt){if(this.insertRule(nt),this.isSyncFontLoadingSupported)return;await new Promise(it=>{const st=this._queueLoadingCallback(it);this._prepareFontLoadEvent(rt,st)})}}get isFontLoadingAPISupported(){var nt;const rt=!!((nt=this._document)!=null&&nt.fonts);return(0,$.shadow)(this,"isFontLoadingAPISupported",rt)}get isSyncFontLoadingSupported(){let rt=!1;return($.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(rt=!0),(0,$.shadow)(this,"isSyncFontLoadingSupported",rt)}_queueLoadingCallback(rt){function nt(){for((0,$.assert)(!st.done,"completeRequest() cannot be called twice."),st.done=!0;it.length>0&&it[0].done;){const at=it.shift();setTimeout(at.callback,0)}}const{loadingRequests:it}=this,st={done:!1,complete:nt,callback:rt};return it.push(st),st}get _loadTestFont(){const rt=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,$.shadow)(this,"_loadTestFont",rt)}_prepareFontLoadEvent(rt,nt){function it(xt,wt){return xt.charCodeAt(wt)<<24|xt.charCodeAt(wt+1)<<16|xt.charCodeAt(wt+2)<<8|xt.charCodeAt(wt+3)&255}function st(xt,wt,Ot,Bt){const Ft=xt.substring(0,wt),Pt=xt.substring(wt+Ot);return Ft+Bt+Pt}let at,ot;const lt=this._document.createElement("canvas");lt.width=1,lt.height=1;const ct=lt.getContext("2d");let ft=0;function ut(xt,wt){if(++ft>30){(0,$.warn)("Load test font never loaded."),wt();return}if(ct.font="30px "+xt,ct.fillText(".",0,20),ct.getImageData(0,0,1,1).data[3]>0){wt();return}setTimeout(ut.bind(null,xt,wt))}const ht=`lt${Date.now()}${this.loadTestFontId++}`;let dt=this._loadTestFont;dt=st(dt,976,ht.length,ht);const pt=16,yt=1482184792;let gt=it(dt,pt);for(at=0,ot=ht.length-3;at<ot;at+=4)gt=gt-yt+it(ht,at)|0;at<ht.length&&(gt=gt-yt+it(ht+"XXX",at)|0),dt=st(dt,pt,4,(0,$.string32)(gt));const vt=`url(data:font/opentype;base64,${btoa(dt)});`,St=`@font-face {font-family:"${ht}";src:${vt}}`;this.insertRule(St);const At=this._document.createElement("div");At.style.visibility="hidden",At.style.width=At.style.height="10px",At.style.position="absolute",At.style.top=At.style.left="0px";for(const xt of[rt.loadedName,ht]){const wt=this._document.createElement("span");wt.textContent="Hi",wt.style.fontFamily=xt,At.append(wt)}this._document.body.append(At),ut(ht,()=>{At.remove(),nt.complete()})}}et=new WeakMap,i.FontLoader=j;class _e{constructor(rt,{isEvalSupported:nt=!0,disableFontFace:it=!1,ignoreErrors:st=!1,inspectFont:at=null}){this.compiledGlyphs=Object.create(null);for(const ot in rt)this[ot]=rt[ot];this.isEvalSupported=nt!==!1,this.disableFontFace=it===!0,this.ignoreErrors=st===!0,this._inspectFont=at}createNativeFontFace(){var nt;if(!this.data||this.disableFontFace)return null;let rt;if(!this.cssFontInfo)rt=new FontFace(this.loadedName,this.data,{});else{const it={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(it.style=`oblique ${this.cssFontInfo.italicAngle}deg`),rt=new FontFace(this.cssFontInfo.fontFamily,this.data,it)}return(nt=this._inspectFont)==null||nt.call(this,this),rt}createFontFaceRule(){var st;if(!this.data||this.disableFontFace)return null;const rt=(0,$.bytesToString)(this.data),nt=`url(data:${this.mimetype};base64,${btoa(rt)});`;let it;if(!this.cssFontInfo)it=`@font-face {font-family:"${this.loadedName}";src:${nt}}`;else{let at=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(at+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),it=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${at}src:${nt}}`}return(st=this._inspectFont)==null||st.call(this,this,nt),it}getPathGenerator(rt,nt){if(this.compiledGlyphs[nt]!==void 0)return this.compiledGlyphs[nt];let it;try{it=rt.get(this.loadedName+"_path_"+nt)}catch(st){if(!this.ignoreErrors)throw st;return(0,$.warn)(`getPathGenerator - ignoring character: "${st}".`),this.compiledGlyphs[nt]=function(at,ot){}}if(this.isEvalSupported&&$.FeatureTest.isEvalSupported){const st=[];for(const at of it){const ot=at.args!==void 0?at.args.join(","):"";st.push("c.",at.cmd,"(",ot,`);
`)}return this.compiledGlyphs[nt]=new Function("c","size",st.join(""))}return this.compiledGlyphs[nt]=function(st,at){for(const ot of it)ot.cmd==="scale"&&(ot.args=[at,-at]),st[ot.cmd].apply(st,ot.args)}}}i.FontFaceObject=_e},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var $=_(7);_(1);const j=function(nt){return new Promise((it,st)=>{require$$5.readFile(nt,(ot,lt)=>{if(ot||!lt){st(new Error(ot));return}it(new Uint8Array(lt))})})};class _e extends $.BaseFilterFactory{}i.NodeFilterFactory=_e;class et extends $.BaseCanvasFactory{_createCanvas(it,st){return require$$5.createCanvas(it,st)}}i.NodeCanvasFactory=et;class tt extends $.BaseCMapReaderFactory{_fetchData(it,st){return j(it).then(at=>({cMapData:at,compressionType:st}))}}i.NodeCMapReaderFactory=tt;class rt extends $.BaseStandardFontDataFactory{_fetchData(it){return j(it)}}i.NodeStandardFontDataFactory=rt},(o,i,_)=>{var Et,Qo,Jo;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var $=_(1),j=_(6),_e=_(12),et=_(13);const tt=16,rt=100,nt=4096,it=15,st=10,at=1e3,ot=16;function lt(Lt,Ct){if(Lt._removeMirroring)throw new Error("Context is already forwarding operations.");Lt.__originalSave=Lt.save,Lt.__originalRestore=Lt.restore,Lt.__originalRotate=Lt.rotate,Lt.__originalScale=Lt.scale,Lt.__originalTranslate=Lt.translate,Lt.__originalTransform=Lt.transform,Lt.__originalSetTransform=Lt.setTransform,Lt.__originalResetTransform=Lt.resetTransform,Lt.__originalClip=Lt.clip,Lt.__originalMoveTo=Lt.moveTo,Lt.__originalLineTo=Lt.lineTo,Lt.__originalBezierCurveTo=Lt.bezierCurveTo,Lt.__originalRect=Lt.rect,Lt.__originalClosePath=Lt.closePath,Lt.__originalBeginPath=Lt.beginPath,Lt._removeMirroring=()=>{Lt.save=Lt.__originalSave,Lt.restore=Lt.__originalRestore,Lt.rotate=Lt.__originalRotate,Lt.scale=Lt.__originalScale,Lt.translate=Lt.__originalTranslate,Lt.transform=Lt.__originalTransform,Lt.setTransform=Lt.__originalSetTransform,Lt.resetTransform=Lt.__originalResetTransform,Lt.clip=Lt.__originalClip,Lt.moveTo=Lt.__originalMoveTo,Lt.lineTo=Lt.__originalLineTo,Lt.bezierCurveTo=Lt.__originalBezierCurveTo,Lt.rect=Lt.__originalRect,Lt.closePath=Lt.__originalClosePath,Lt.beginPath=Lt.__originalBeginPath,delete Lt._removeMirroring},Lt.save=function(){Ct.save(),this.__originalSave()},Lt.restore=function(){Ct.restore(),this.__originalRestore()},Lt.translate=function(jt,Vt){Ct.translate(jt,Vt),this.__originalTranslate(jt,Vt)},Lt.scale=function(jt,Vt){Ct.scale(jt,Vt),this.__originalScale(jt,Vt)},Lt.transform=function(jt,Vt,zt,qt,Wt,ir){Ct.transform(jt,Vt,zt,qt,Wt,ir),this.__originalTransform(jt,Vt,zt,qt,Wt,ir)},Lt.setTransform=function(jt,Vt,zt,qt,Wt,ir){Ct.setTransform(jt,Vt,zt,qt,Wt,ir),this.__originalSetTransform(jt,Vt,zt,qt,Wt,ir)},Lt.resetTransform=function(){Ct.resetTransform(),this.__originalResetTransform()},Lt.rotate=function(jt){Ct.rotate(jt),this.__originalRotate(jt)},Lt.clip=function(jt){Ct.clip(jt),this.__originalClip(jt)},Lt.moveTo=function(kt,jt){Ct.moveTo(kt,jt),this.__originalMoveTo(kt,jt)},Lt.lineTo=function(kt,jt){Ct.lineTo(kt,jt),this.__originalLineTo(kt,jt)},Lt.bezierCurveTo=function(kt,jt,Vt,zt,qt,Wt){Ct.bezierCurveTo(kt,jt,Vt,zt,qt,Wt),this.__originalBezierCurveTo(kt,jt,Vt,zt,qt,Wt)},Lt.rect=function(kt,jt,Vt,zt){Ct.rect(kt,jt,Vt,zt),this.__originalRect(kt,jt,Vt,zt)},Lt.closePath=function(){Ct.closePath(),this.__originalClosePath()},Lt.beginPath=function(){Ct.beginPath(),this.__originalBeginPath()}}class ct{constructor(Ct){this.canvasFactory=Ct,this.cache=Object.create(null)}getCanvas(Ct,kt,jt){let Vt;return this.cache[Ct]!==void 0?(Vt=this.cache[Ct],this.canvasFactory.reset(Vt,kt,jt)):(Vt=this.canvasFactory.create(kt,jt),this.cache[Ct]=Vt),Vt}delete(Ct){delete this.cache[Ct]}clear(){for(const Ct in this.cache){const kt=this.cache[Ct];this.canvasFactory.destroy(kt),delete this.cache[Ct]}}}function ft(Lt,Ct,kt,jt,Vt,zt,qt,Wt,ir,or){const[Qt,gr,ar,Ar,er,sr]=(0,j.getCurrentTransform)(Lt);if(gr===0&&ar===0){const lr=qt*Qt+er,dr=Math.round(lr),xr=Wt*Ar+sr,Mr=Math.round(xr),Or=(qt+ir)*Qt+er,fr=Math.abs(Math.round(Or)-dr)||1,Hr=(Wt+or)*Ar+sr,Gr=Math.abs(Math.round(Hr)-Mr)||1;return Lt.setTransform(Math.sign(Qt),0,0,Math.sign(Ar),dr,Mr),Lt.drawImage(Ct,kt,jt,Vt,zt,0,0,fr,Gr),Lt.setTransform(Qt,gr,ar,Ar,er,sr),[fr,Gr]}if(Qt===0&&Ar===0){const lr=Wt*ar+er,dr=Math.round(lr),xr=qt*gr+sr,Mr=Math.round(xr),Or=(Wt+or)*ar+er,fr=Math.abs(Math.round(Or)-dr)||1,Hr=(qt+ir)*gr+sr,Gr=Math.abs(Math.round(Hr)-Mr)||1;return Lt.setTransform(0,Math.sign(gr),Math.sign(ar),0,dr,Mr),Lt.drawImage(Ct,kt,jt,Vt,zt,0,0,Gr,fr),Lt.setTransform(Qt,gr,ar,Ar,er,sr),[Gr,fr]}Lt.drawImage(Ct,kt,jt,Vt,zt,qt,Wt,ir,or);const Gt=Math.hypot(Qt,gr),Jt=Math.hypot(ar,Ar);return[Gt*ir,Jt*or]}function ut(Lt){const{width:Ct,height:kt}=Lt;if(Ct>at||kt>at)return null;const jt=1e3,Vt=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),zt=Ct+1;let qt=new Uint8Array(zt*(kt+1)),Wt,ir,or;const Qt=Ct+7&-8;let gr=new Uint8Array(Qt*kt),ar=0;for(const Jt of Lt.data){let lr=128;for(;lr>0;)gr[ar++]=Jt&lr?0:255,lr>>=1}let Ar=0;for(ar=0,gr[ar]!==0&&(qt[0]=1,++Ar),ir=1;ir<Ct;ir++)gr[ar]!==gr[ar+1]&&(qt[ir]=gr[ar]?2:1,++Ar),ar++;for(gr[ar]!==0&&(qt[ir]=2,++Ar),Wt=1;Wt<kt;Wt++){ar=Wt*Qt,or=Wt*zt,gr[ar-Qt]!==gr[ar]&&(qt[or]=gr[ar]?1:8,++Ar);let Jt=(gr[ar]?4:0)+(gr[ar-Qt]?8:0);for(ir=1;ir<Ct;ir++)Jt=(Jt>>2)+(gr[ar+1]?4:0)+(gr[ar-Qt+1]?8:0),Vt[Jt]&&(qt[or+ir]=Vt[Jt],++Ar),ar++;if(gr[ar-Qt]!==gr[ar]&&(qt[or+ir]=gr[ar]?2:4,++Ar),Ar>jt)return null}for(ar=Qt*(kt-1),or=Wt*zt,gr[ar]!==0&&(qt[or]=8,++Ar),ir=1;ir<Ct;ir++)gr[ar]!==gr[ar+1]&&(qt[or+ir]=gr[ar]?4:8,++Ar),ar++;if(gr[ar]!==0&&(qt[or+ir]=4,++Ar),Ar>jt)return null;const er=new Int32Array([0,zt,-1,0,-zt,0,0,0,1]),sr=new Path2D;for(Wt=0;Ar&&Wt<=kt;Wt++){let Jt=Wt*zt;const lr=Jt+Ct;for(;Jt<lr&&!qt[Jt];)Jt++;if(Jt===lr)continue;sr.moveTo(Jt%zt,Wt);const dr=Jt;let xr=qt[Jt];do{const Mr=er[xr];do Jt+=Mr;while(!qt[Jt]);const Or=qt[Jt];Or!==5&&Or!==10?(xr=Or,qt[Jt]=0):(xr=Or&51*xr>>4,qt[Jt]&=xr>>2|xr<<2),sr.lineTo(Jt%zt,Jt/zt|0),qt[Jt]||--Ar}while(dr!==Jt);--Wt}return gr=null,qt=null,function(Jt){Jt.save(),Jt.scale(1/Ct,-1/kt),Jt.translate(0,-kt),Jt.fill(sr),Jt.beginPath(),Jt.restore()}}class ht{constructor(Ct,kt){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=$.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=$.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=$.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,Ct,kt])}clone(){const Ct=Object.create(this);return Ct.clipBox=this.clipBox.slice(),Ct}setCurrentPoint(Ct,kt){this.x=Ct,this.y=kt}updatePathMinMax(Ct,kt,jt){[kt,jt]=$.Util.applyTransform([kt,jt],Ct),this.minX=Math.min(this.minX,kt),this.minY=Math.min(this.minY,jt),this.maxX=Math.max(this.maxX,kt),this.maxY=Math.max(this.maxY,jt)}updateRectMinMax(Ct,kt){const jt=$.Util.applyTransform(kt,Ct),Vt=$.Util.applyTransform(kt.slice(2),Ct);this.minX=Math.min(this.minX,jt[0],Vt[0]),this.minY=Math.min(this.minY,jt[1],Vt[1]),this.maxX=Math.max(this.maxX,jt[0],Vt[0]),this.maxY=Math.max(this.maxY,jt[1],Vt[1])}updateScalingPathMinMax(Ct,kt){$.Util.scaleMinMax(Ct,kt),this.minX=Math.min(this.minX,kt[0]),this.maxX=Math.max(this.maxX,kt[1]),this.minY=Math.min(this.minY,kt[2]),this.maxY=Math.max(this.maxY,kt[3])}updateCurvePathMinMax(Ct,kt,jt,Vt,zt,qt,Wt,ir,or,Qt){const gr=$.Util.bezierBoundingBox(kt,jt,Vt,zt,qt,Wt,ir,or);if(Qt){Qt[0]=Math.min(Qt[0],gr[0],gr[2]),Qt[1]=Math.max(Qt[1],gr[0],gr[2]),Qt[2]=Math.min(Qt[2],gr[1],gr[3]),Qt[3]=Math.max(Qt[3],gr[1],gr[3]);return}this.updateRectMinMax(Ct,gr)}getPathBoundingBox(Ct=_e.PathType.FILL,kt=null){const jt=[this.minX,this.minY,this.maxX,this.maxY];if(Ct===_e.PathType.STROKE){kt||(0,$.unreachable)("Stroke bounding box must include transform.");const Vt=$.Util.singularValueDecompose2dScale(kt),zt=Vt[0]*this.lineWidth/2,qt=Vt[1]*this.lineWidth/2;jt[0]-=zt,jt[1]-=qt,jt[2]+=zt,jt[3]+=qt}return jt}updateClipFromPath(){const Ct=$.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(Ct||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(Ct){this.clipBox=Ct,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(Ct=_e.PathType.FILL,kt=null){return $.Util.intersect(this.clipBox,this.getPathBoundingBox(Ct,kt))}}function dt(Lt,Ct){if(typeof ImageData<"u"&&Ct instanceof ImageData){Lt.putImageData(Ct,0,0);return}const kt=Ct.height,jt=Ct.width,Vt=kt%ot,zt=(kt-Vt)/ot,qt=Vt===0?zt:zt+1,Wt=Lt.createImageData(jt,ot);let ir=0,or;const Qt=Ct.data,gr=Wt.data;let ar,Ar,er,sr;if(Ct.kind===$.ImageKind.GRAYSCALE_1BPP){const Gt=Qt.byteLength,Jt=new Uint32Array(gr.buffer,0,gr.byteLength>>2),lr=Jt.length,dr=jt+7>>3,xr=4294967295,Mr=$.FeatureTest.isLittleEndian?4278190080:255;for(ar=0;ar<qt;ar++){for(er=ar<zt?ot:Vt,or=0,Ar=0;Ar<er;Ar++){const Or=Gt-ir;let fr=0;const Hr=Or>dr?jt:Or*8-7,Gr=Hr&-8;let dn=0,nn=0;for(;fr<Gr;fr+=8)nn=Qt[ir++],Jt[or++]=nn&128?xr:Mr,Jt[or++]=nn&64?xr:Mr,Jt[or++]=nn&32?xr:Mr,Jt[or++]=nn&16?xr:Mr,Jt[or++]=nn&8?xr:Mr,Jt[or++]=nn&4?xr:Mr,Jt[or++]=nn&2?xr:Mr,Jt[or++]=nn&1?xr:Mr;for(;fr<Hr;fr++)dn===0&&(nn=Qt[ir++],dn=128),Jt[or++]=nn&dn?xr:Mr,dn>>=1}for(;or<lr;)Jt[or++]=0;Lt.putImageData(Wt,0,ar*ot)}}else if(Ct.kind===$.ImageKind.RGBA_32BPP){for(Ar=0,sr=jt*ot*4,ar=0;ar<zt;ar++)gr.set(Qt.subarray(ir,ir+sr)),ir+=sr,Lt.putImageData(Wt,0,Ar),Ar+=ot;ar<qt&&(sr=jt*Vt*4,gr.set(Qt.subarray(ir,ir+sr)),Lt.putImageData(Wt,0,Ar))}else if(Ct.kind===$.ImageKind.RGB_24BPP)for(er=ot,sr=jt*er,ar=0;ar<qt;ar++){for(ar>=zt&&(er=Vt,sr=jt*er),or=0,Ar=sr;Ar--;)gr[or++]=Qt[ir++],gr[or++]=Qt[ir++],gr[or++]=Qt[ir++],gr[or++]=255;Lt.putImageData(Wt,0,ar*ot)}else throw new Error(`bad image kind: ${Ct.kind}`)}function mt(Lt,Ct){if(Ct.bitmap){Lt.drawImage(Ct.bitmap,0,0);return}const kt=Ct.height,jt=Ct.width,Vt=kt%ot,zt=(kt-Vt)/ot,qt=Vt===0?zt:zt+1,Wt=Lt.createImageData(jt,ot);let ir=0;const or=Ct.data,Qt=Wt.data;for(let gr=0;gr<qt;gr++){const ar=gr<zt?ot:Vt;({srcPos:ir}=(0,et.convertBlackAndWhiteToRGBA)({src:or,srcPos:ir,dest:Qt,width:jt,height:ar,nonBlackColor:0})),Lt.putImageData(Wt,0,gr*ot)}}function pt(Lt,Ct){const kt=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const jt of kt)Lt[jt]!==void 0&&(Ct[jt]=Lt[jt]);Lt.setLineDash!==void 0&&(Ct.setLineDash(Lt.getLineDash()),Ct.lineDashOffset=Lt.lineDashOffset)}function yt(Lt){if(Lt.strokeStyle=Lt.fillStyle="#000000",Lt.fillRule="nonzero",Lt.globalAlpha=1,Lt.lineWidth=1,Lt.lineCap="butt",Lt.lineJoin="miter",Lt.miterLimit=10,Lt.globalCompositeOperation="source-over",Lt.font="10px sans-serif",Lt.setLineDash!==void 0&&(Lt.setLineDash([]),Lt.lineDashOffset=0),!$.isNodeJS){const{filter:Ct}=Lt;Ct!=="none"&&Ct!==""&&(Lt.filter="none")}}function gt(Lt,Ct,kt,jt){const Vt=Lt.length;for(let zt=3;zt<Vt;zt+=4){const qt=Lt[zt];if(qt===0)Lt[zt-3]=Ct,Lt[zt-2]=kt,Lt[zt-1]=jt;else if(qt<255){const Wt=255-qt;Lt[zt-3]=Lt[zt-3]*qt+Ct*Wt>>8,Lt[zt-2]=Lt[zt-2]*qt+kt*Wt>>8,Lt[zt-1]=Lt[zt-1]*qt+jt*Wt>>8}}}function vt(Lt,Ct,kt){const jt=Lt.length,Vt=1/255;for(let zt=3;zt<jt;zt+=4){const qt=kt?kt[Lt[zt]]:Lt[zt];Ct[zt]=Ct[zt]*qt*Vt|0}}function St(Lt,Ct,kt){const jt=Lt.length;for(let Vt=3;Vt<jt;Vt+=4){const zt=Lt[Vt-3]*77+Lt[Vt-2]*152+Lt[Vt-1]*28;Ct[Vt]=kt?Ct[Vt]*kt[zt>>8]>>8:Ct[Vt]*zt>>16}}function At(Lt,Ct,kt,jt,Vt,zt,qt,Wt,ir,or,Qt){const gr=!!zt,ar=gr?zt[0]:0,Ar=gr?zt[1]:0,er=gr?zt[2]:0,sr=Vt==="Luminosity"?St:vt,Jt=Math.min(jt,Math.ceil(1048576/kt));for(let lr=0;lr<jt;lr+=Jt){const dr=Math.min(Jt,jt-lr),xr=Lt.getImageData(Wt-or,lr+(ir-Qt),kt,dr),Mr=Ct.getImageData(Wt,lr+ir,kt,dr);gr&&gt(xr.data,ar,Ar,er),sr(xr.data,Mr.data,qt),Ct.putImageData(Mr,Wt,lr+ir)}}function xt(Lt,Ct,kt,jt){const Vt=jt[0],zt=jt[1],qt=jt[2]-Vt,Wt=jt[3]-zt;qt===0||Wt===0||(At(Ct.context,kt,qt,Wt,Ct.subtype,Ct.backdrop,Ct.transferMap,Vt,zt,Ct.offsetX,Ct.offsetY),Lt.save(),Lt.globalAlpha=1,Lt.globalCompositeOperation="source-over",Lt.setTransform(1,0,0,1,0,0),Lt.drawImage(kt.canvas,0,0),Lt.restore())}function wt(Lt,Ct){const kt=$.Util.singularValueDecompose2dScale(Lt);kt[0]=Math.fround(kt[0]),kt[1]=Math.fround(kt[1]);const jt=Math.fround((globalThis.devicePixelRatio||1)*j.PixelsPerInch.PDF_TO_CSS_UNITS);return Ct!==void 0?Ct:kt[0]<=jt||kt[1]<=jt}const Ot=["butt","round","square"],Bt=["miter","round","bevel"],Ft={},Pt={},Dt=class Dt{constructor(Ct,kt,jt,Vt,zt,{optionalContentConfig:qt,markedContentStack:Wt=null},ir,or){Er(this,Et);this.ctx=Ct,this.current=new ht(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=kt,this.objs=jt,this.canvasFactory=Vt,this.filterFactory=zt,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Wt||[],this.optionalContentConfig=qt,this.cachedCanvases=new ct(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ir,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=or,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(Ct,kt=null){return typeof Ct=="string"?Ct.startsWith("g_")?this.commonObjs.get(Ct):this.objs.get(Ct):kt}beginDrawing({transform:Ct,viewport:kt,transparency:jt=!1,background:Vt=null}){const zt=this.ctx.canvas.width,qt=this.ctx.canvas.height,Wt=this.ctx.fillStyle;if(this.ctx.fillStyle=Vt||"#ffffff",this.ctx.fillRect(0,0,zt,qt),this.ctx.fillStyle=Wt,jt){const ir=this.cachedCanvases.getCanvas("transparent",zt,qt);this.compositeCtx=this.ctx,this.transparentCanvas=ir.canvas,this.ctx=ir.context,this.ctx.save(),this.ctx.transform(...(0,j.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),yt(this.ctx),Ct&&(this.ctx.transform(...Ct),this.outputScaleX=Ct[0],this.outputScaleY=Ct[0]),this.ctx.transform(...kt.transform),this.viewportScale=kt.scale,this.baseTransform=(0,j.getCurrentTransform)(this.ctx)}executeOperatorList(Ct,kt,jt,Vt){const zt=Ct.argsArray,qt=Ct.fnArray;let Wt=kt||0;const ir=zt.length;if(ir===Wt)return Wt;const or=ir-Wt>st&&typeof jt=="function",Qt=or?Date.now()+it:0;let gr=0;const ar=this.commonObjs,Ar=this.objs;let er;for(;;){if(Vt!==void 0&&Wt===Vt.nextBreakPoint)return Vt.breakIt(Wt,jt),Wt;if(er=qt[Wt],er!==$.OPS.dependency)this[er].apply(this,zt[Wt]);else for(const sr of zt[Wt]){const Gt=sr.startsWith("g_")?ar:Ar;if(!Gt.has(sr))return Gt.get(sr,jt),Wt}if(Wt++,Wt===ir)return Wt;if(or&&++gr>st){if(Date.now()>Qt)return jt(),Wt;gr=0}}}endDrawing(){mr(this,Et,Qo).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const Ct of this._cachedBitmapsMap.values()){for(const kt of Ct.values())typeof HTMLCanvasElement<"u"&&kt instanceof HTMLCanvasElement&&(kt.width=kt.height=0);Ct.clear()}this._cachedBitmapsMap.clear(),mr(this,Et,Jo).call(this)}_scaleImage(Ct,kt){const jt=Ct.width,Vt=Ct.height;let zt=Math.max(Math.hypot(kt[0],kt[1]),1),qt=Math.max(Math.hypot(kt[2],kt[3]),1),Wt=jt,ir=Vt,or="prescale1",Qt,gr;for(;zt>2&&Wt>1||qt>2&&ir>1;){let ar=Wt,Ar=ir;zt>2&&Wt>1&&(ar=Wt>=16384?Math.floor(Wt/2)-1||1:Math.ceil(Wt/2),zt/=Wt/ar),qt>2&&ir>1&&(Ar=ir>=16384?Math.floor(ir/2)-1||1:Math.ceil(ir)/2,qt/=ir/Ar),Qt=this.cachedCanvases.getCanvas(or,ar,Ar),gr=Qt.context,gr.clearRect(0,0,ar,Ar),gr.drawImage(Ct,0,0,Wt,ir,0,0,ar,Ar),Ct=Qt.canvas,Wt=ar,ir=Ar,or=or==="prescale1"?"prescale2":"prescale1"}return{img:Ct,paintWidth:Wt,paintHeight:ir}}_createMaskCanvas(Ct){const kt=this.ctx,{width:jt,height:Vt}=Ct,zt=this.current.fillColor,qt=this.current.patternFill,Wt=(0,j.getCurrentTransform)(kt);let ir,or,Qt,gr;if((Ct.bitmap||Ct.data)&&Ct.count>1){const fr=Ct.bitmap||Ct.data.buffer;or=JSON.stringify(qt?Wt:[Wt.slice(0,4),zt]),ir=this._cachedBitmapsMap.get(fr),ir||(ir=new Map,this._cachedBitmapsMap.set(fr,ir));const Hr=ir.get(or);if(Hr&&!qt){const Gr=Math.round(Math.min(Wt[0],Wt[2])+Wt[4]),dn=Math.round(Math.min(Wt[1],Wt[3])+Wt[5]);return{canvas:Hr,offsetX:Gr,offsetY:dn}}Qt=Hr}Qt||(gr=this.cachedCanvases.getCanvas("maskCanvas",jt,Vt),mt(gr.context,Ct));let ar=$.Util.transform(Wt,[1/jt,0,0,-1/Vt,0,0]);ar=$.Util.transform(ar,[1,0,0,1,0,-Vt]);const Ar=$.Util.applyTransform([0,0],ar),er=$.Util.applyTransform([jt,Vt],ar),sr=$.Util.normalizeRect([Ar[0],Ar[1],er[0],er[1]]),Gt=Math.round(sr[2]-sr[0])||1,Jt=Math.round(sr[3]-sr[1])||1,lr=this.cachedCanvases.getCanvas("fillCanvas",Gt,Jt),dr=lr.context,xr=Math.min(Ar[0],er[0]),Mr=Math.min(Ar[1],er[1]);dr.translate(-xr,-Mr),dr.transform(...ar),Qt||(Qt=this._scaleImage(gr.canvas,(0,j.getCurrentTransformInverse)(dr)),Qt=Qt.img,ir&&qt&&ir.set(or,Qt)),dr.imageSmoothingEnabled=wt((0,j.getCurrentTransform)(dr),Ct.interpolate),ft(dr,Qt,0,0,Qt.width,Qt.height,0,0,jt,Vt),dr.globalCompositeOperation="source-in";const Or=$.Util.transform((0,j.getCurrentTransformInverse)(dr),[1,0,0,1,-xr,-Mr]);return dr.fillStyle=qt?zt.getPattern(kt,this,Or,_e.PathType.FILL):zt,dr.fillRect(0,0,jt,Vt),ir&&!qt&&(this.cachedCanvases.delete("fillCanvas"),ir.set(or,lr.canvas)),{canvas:lr.canvas,offsetX:Math.round(xr),offsetY:Math.round(Mr)}}setLineWidth(Ct){Ct!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=Ct,this.ctx.lineWidth=Ct}setLineCap(Ct){this.ctx.lineCap=Ot[Ct]}setLineJoin(Ct){this.ctx.lineJoin=Bt[Ct]}setMiterLimit(Ct){this.ctx.miterLimit=Ct}setDash(Ct,kt){const jt=this.ctx;jt.setLineDash!==void 0&&(jt.setLineDash(Ct),jt.lineDashOffset=kt)}setRenderingIntent(Ct){}setFlatness(Ct){}setGState(Ct){for(const[kt,jt]of Ct)switch(kt){case"LW":this.setLineWidth(jt);break;case"LC":this.setLineCap(jt);break;case"LJ":this.setLineJoin(jt);break;case"ML":this.setMiterLimit(jt);break;case"D":this.setDash(jt[0],jt[1]);break;case"RI":this.setRenderingIntent(jt);break;case"FL":this.setFlatness(jt);break;case"Font":this.setFont(jt[0],jt[1]);break;case"CA":this.current.strokeAlpha=jt;break;case"ca":this.current.fillAlpha=jt,this.ctx.globalAlpha=jt;break;case"BM":this.ctx.globalCompositeOperation=jt;break;case"SMask":this.current.activeSMask=jt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(jt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const Ct=this.inSMaskMode;this.current.activeSMask&&!Ct?this.beginSMaskMode():!this.current.activeSMask&&Ct&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const Ct=this.ctx.canvas.width,kt=this.ctx.canvas.height,jt="smaskGroupAt"+this.groupLevel,Vt=this.cachedCanvases.getCanvas(jt,Ct,kt);this.suspendedCtx=this.ctx,this.ctx=Vt.context;const zt=this.ctx;zt.setTransform(...(0,j.getCurrentTransform)(this.suspendedCtx)),pt(this.suspendedCtx,zt),lt(zt,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),pt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(Ct){if(!this.current.activeSMask)return;Ct?(Ct[0]=Math.floor(Ct[0]),Ct[1]=Math.floor(Ct[1]),Ct[2]=Math.ceil(Ct[2]),Ct[3]=Math.ceil(Ct[3])):Ct=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const kt=this.current.activeSMask,jt=this.suspendedCtx;xt(jt,kt,this.ctx,Ct),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(pt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const Ct=this.current;this.stateStack.push(Ct),this.current=Ct.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),pt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(Ct,kt,jt,Vt,zt,qt){this.ctx.transform(Ct,kt,jt,Vt,zt,qt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(Ct,kt,jt){const Vt=this.ctx,zt=this.current;let qt=zt.x,Wt=zt.y,ir,or;const Qt=(0,j.getCurrentTransform)(Vt),gr=Qt[0]===0&&Qt[3]===0||Qt[1]===0&&Qt[2]===0,ar=gr?jt.slice(0):null;for(let Ar=0,er=0,sr=Ct.length;Ar<sr;Ar++)switch(Ct[Ar]|0){case $.OPS.rectangle:qt=kt[er++],Wt=kt[er++];const Gt=kt[er++],Jt=kt[er++],lr=qt+Gt,dr=Wt+Jt;Vt.moveTo(qt,Wt),Gt===0||Jt===0?Vt.lineTo(lr,dr):(Vt.lineTo(lr,Wt),Vt.lineTo(lr,dr),Vt.lineTo(qt,dr)),gr||zt.updateRectMinMax(Qt,[qt,Wt,lr,dr]),Vt.closePath();break;case $.OPS.moveTo:qt=kt[er++],Wt=kt[er++],Vt.moveTo(qt,Wt),gr||zt.updatePathMinMax(Qt,qt,Wt);break;case $.OPS.lineTo:qt=kt[er++],Wt=kt[er++],Vt.lineTo(qt,Wt),gr||zt.updatePathMinMax(Qt,qt,Wt);break;case $.OPS.curveTo:ir=qt,or=Wt,qt=kt[er+4],Wt=kt[er+5],Vt.bezierCurveTo(kt[er],kt[er+1],kt[er+2],kt[er+3],qt,Wt),zt.updateCurvePathMinMax(Qt,ir,or,kt[er],kt[er+1],kt[er+2],kt[er+3],qt,Wt,ar),er+=6;break;case $.OPS.curveTo2:ir=qt,or=Wt,Vt.bezierCurveTo(qt,Wt,kt[er],kt[er+1],kt[er+2],kt[er+3]),zt.updateCurvePathMinMax(Qt,ir,or,qt,Wt,kt[er],kt[er+1],kt[er+2],kt[er+3],ar),qt=kt[er+2],Wt=kt[er+3],er+=4;break;case $.OPS.curveTo3:ir=qt,or=Wt,qt=kt[er+2],Wt=kt[er+3],Vt.bezierCurveTo(kt[er],kt[er+1],qt,Wt,qt,Wt),zt.updateCurvePathMinMax(Qt,ir,or,kt[er],kt[er+1],qt,Wt,qt,Wt,ar),er+=4;break;case $.OPS.closePath:Vt.closePath();break}gr&&zt.updateScalingPathMinMax(Qt,ar),zt.setCurrentPoint(qt,Wt)}closePath(){this.ctx.closePath()}stroke(Ct=!0){const kt=this.ctx,jt=this.current.strokeColor;kt.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof jt=="object"&&(jt!=null&&jt.getPattern)?(kt.save(),kt.strokeStyle=jt.getPattern(kt,this,(0,j.getCurrentTransformInverse)(kt),_e.PathType.STROKE),this.rescaleAndStroke(!1),kt.restore()):this.rescaleAndStroke(!0)),Ct&&this.consumePath(this.current.getClippedPathBoundingBox()),kt.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(Ct=!0){const kt=this.ctx,jt=this.current.fillColor,Vt=this.current.patternFill;let zt=!1;Vt&&(kt.save(),kt.fillStyle=jt.getPattern(kt,this,(0,j.getCurrentTransformInverse)(kt),_e.PathType.FILL),zt=!0);const qt=this.current.getClippedPathBoundingBox();this.contentVisible&&qt!==null&&(this.pendingEOFill?(kt.fill("evenodd"),this.pendingEOFill=!1):kt.fill()),zt&&kt.restore(),Ct&&this.consumePath(qt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Ft}eoClip(){this.pendingClip=Pt}beginText(){this.current.textMatrix=$.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const Ct=this.pendingTextPaths,kt=this.ctx;if(Ct===void 0){kt.beginPath();return}kt.save(),kt.beginPath();for(const jt of Ct)kt.setTransform(...jt.transform),kt.translate(jt.x,jt.y),jt.addToPath(kt,jt.fontSize);kt.restore(),kt.clip(),kt.beginPath(),delete this.pendingTextPaths}setCharSpacing(Ct){this.current.charSpacing=Ct}setWordSpacing(Ct){this.current.wordSpacing=Ct}setHScale(Ct){this.current.textHScale=Ct/100}setLeading(Ct){this.current.leading=-Ct}setFont(Ct,kt){var Qt;const jt=this.commonObjs.get(Ct),Vt=this.current;if(!jt)throw new Error(`Can't find font for ${Ct}`);if(Vt.fontMatrix=jt.fontMatrix||$.FONT_IDENTITY_MATRIX,(Vt.fontMatrix[0]===0||Vt.fontMatrix[3]===0)&&(0,$.warn)("Invalid font matrix for font "+Ct),kt<0?(kt=-kt,Vt.fontDirection=-1):Vt.fontDirection=1,this.current.font=jt,this.current.fontSize=kt,jt.isType3Font)return;const zt=jt.loadedName||"sans-serif",qt=((Qt=jt.systemFontInfo)==null?void 0:Qt.css)||`"${zt}", ${jt.fallbackName}`;let Wt="normal";jt.black?Wt="900":jt.bold&&(Wt="bold");const ir=jt.italic?"italic":"normal";let or=kt;kt<tt?or=tt:kt>rt&&(or=rt),this.current.fontSizeScale=kt/or,this.ctx.font=`${ir} ${Wt} ${or}px ${qt}`}setTextRenderingMode(Ct){this.current.textRenderingMode=Ct}setTextRise(Ct){this.current.textRise=Ct}moveText(Ct,kt){this.current.x=this.current.lineX+=Ct,this.current.y=this.current.lineY+=kt}setLeadingMoveText(Ct,kt){this.setLeading(-kt),this.moveText(Ct,kt)}setTextMatrix(Ct,kt,jt,Vt,zt,qt){this.current.textMatrix=[Ct,kt,jt,Vt,zt,qt],this.current.textMatrixScale=Math.hypot(Ct,kt),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(Ct,kt,jt,Vt){const zt=this.ctx,qt=this.current,Wt=qt.font,ir=qt.textRenderingMode,or=qt.fontSize/qt.fontSizeScale,Qt=ir&$.TextRenderingMode.FILL_STROKE_MASK,gr=!!(ir&$.TextRenderingMode.ADD_TO_PATH_FLAG),ar=qt.patternFill&&!Wt.missingFile;let Ar;(Wt.disableFontFace||gr||ar)&&(Ar=Wt.getPathGenerator(this.commonObjs,Ct)),Wt.disableFontFace||ar?(zt.save(),zt.translate(kt,jt),zt.beginPath(),Ar(zt,or),Vt&&zt.setTransform(...Vt),(Qt===$.TextRenderingMode.FILL||Qt===$.TextRenderingMode.FILL_STROKE)&&zt.fill(),(Qt===$.TextRenderingMode.STROKE||Qt===$.TextRenderingMode.FILL_STROKE)&&zt.stroke(),zt.restore()):((Qt===$.TextRenderingMode.FILL||Qt===$.TextRenderingMode.FILL_STROKE)&&zt.fillText(Ct,kt,jt),(Qt===$.TextRenderingMode.STROKE||Qt===$.TextRenderingMode.FILL_STROKE)&&zt.strokeText(Ct,kt,jt)),gr&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,j.getCurrentTransform)(zt),x:kt,y:jt,fontSize:or,addToPath:Ar})}get isFontSubpixelAAEnabled(){const{context:Ct}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);Ct.scale(1.5,1),Ct.fillText("I",0,10);const kt=Ct.getImageData(0,0,10,10).data;let jt=!1;for(let Vt=3;Vt<kt.length;Vt+=4)if(kt[Vt]>0&&kt[Vt]<255){jt=!0;break}return(0,$.shadow)(this,"isFontSubpixelAAEnabled",jt)}showText(Ct){const kt=this.current,jt=kt.font;if(jt.isType3Font)return this.showType3Text(Ct);const Vt=kt.fontSize;if(Vt===0)return;const zt=this.ctx,qt=kt.fontSizeScale,Wt=kt.charSpacing,ir=kt.wordSpacing,or=kt.fontDirection,Qt=kt.textHScale*or,gr=Ct.length,ar=jt.vertical,Ar=ar?1:-1,er=jt.defaultVMetrics,sr=Vt*kt.fontMatrix[0],Gt=kt.textRenderingMode===$.TextRenderingMode.FILL&&!jt.disableFontFace&&!kt.patternFill;zt.save(),zt.transform(...kt.textMatrix),zt.translate(kt.x,kt.y+kt.textRise),or>0?zt.scale(Qt,-1):zt.scale(Qt,1);let Jt;if(kt.patternFill){zt.save();const Or=kt.fillColor.getPattern(zt,this,(0,j.getCurrentTransformInverse)(zt),_e.PathType.FILL);Jt=(0,j.getCurrentTransform)(zt),zt.restore(),zt.fillStyle=Or}let lr=kt.lineWidth;const dr=kt.textMatrixScale;if(dr===0||lr===0){const Or=kt.textRenderingMode&$.TextRenderingMode.FILL_STROKE_MASK;(Or===$.TextRenderingMode.STROKE||Or===$.TextRenderingMode.FILL_STROKE)&&(lr=this.getSinglePixelWidth())}else lr/=dr;if(qt!==1&&(zt.scale(qt,qt),lr/=qt),zt.lineWidth=lr,jt.isInvalidPDFjsFont){const Or=[];let fr=0;for(const Hr of Ct)Or.push(Hr.unicode),fr+=Hr.width;zt.fillText(Or.join(""),0,0),kt.x+=fr*sr*Qt,zt.restore(),this.compose();return}let xr=0,Mr;for(Mr=0;Mr<gr;++Mr){const Or=Ct[Mr];if(typeof Or=="number"){xr+=Ar*Or*Vt/1e3;continue}let fr=!1;const Hr=(Or.isSpace?ir:0)+Wt,Gr=Or.fontChar,dn=Or.accent;let nn,vn,Jr=Or.width;if(ar){const yn=Or.vmetric||er,_n=-(Or.vmetric?yn[1]:Jr*.5)*sr,jr=yn[2]*sr;Jr=yn?-yn[0]:Jr,nn=_n/qt,vn=(xr+jr)/qt}else nn=xr/qt,vn=0;if(jt.remeasure&&Jr>0){const yn=zt.measureText(Gr).width*1e3/Vt*qt;if(Jr<yn&&this.isFontSubpixelAAEnabled){const _n=Jr/yn;fr=!0,zt.save(),zt.scale(_n,1),nn/=_n}else Jr!==yn&&(nn+=(Jr-yn)/2e3*Vt/qt)}if(this.contentVisible&&(Or.isInFont||jt.missingFile)){if(Gt&&!dn)zt.fillText(Gr,nn,vn);else if(this.paintChar(Gr,nn,vn,Jt),dn){const yn=nn+Vt*dn.offset.x/qt,_n=vn-Vt*dn.offset.y/qt;this.paintChar(dn.fontChar,yn,_n,Jt)}}const an=ar?Jr*sr-Hr*or:Jr*sr+Hr*or;xr+=an,fr&&zt.restore()}ar?kt.y-=xr:kt.x+=xr*Qt,zt.restore(),this.compose()}showType3Text(Ct){const kt=this.ctx,jt=this.current,Vt=jt.font,zt=jt.fontSize,qt=jt.fontDirection,Wt=Vt.vertical?1:-1,ir=jt.charSpacing,or=jt.wordSpacing,Qt=jt.textHScale*qt,gr=jt.fontMatrix||$.FONT_IDENTITY_MATRIX,ar=Ct.length,Ar=jt.textRenderingMode===$.TextRenderingMode.INVISIBLE;let er,sr,Gt,Jt;if(!(Ar||zt===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,kt.save(),kt.transform(...jt.textMatrix),kt.translate(jt.x,jt.y),kt.scale(Qt,qt),er=0;er<ar;++er){if(sr=Ct[er],typeof sr=="number"){Jt=Wt*sr*zt/1e3,this.ctx.translate(Jt,0),jt.x+=Jt*Qt;continue}const lr=(sr.isSpace?or:0)+ir,dr=Vt.charProcOperatorList[sr.operatorListId];if(!dr){(0,$.warn)(`Type3 character "${sr.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=sr,this.save(),kt.scale(zt,zt),kt.transform(...gr),this.executeOperatorList(dr),this.restore()),Gt=$.Util.applyTransform([sr.width,0],gr)[0]*zt+lr,kt.translate(Gt,0),jt.x+=Gt*Qt}kt.restore(),this.processingType3=null}}setCharWidth(Ct,kt){}setCharWidthAndBounds(Ct,kt,jt,Vt,zt,qt){this.ctx.rect(jt,Vt,zt-jt,qt-Vt),this.ctx.clip(),this.endPath()}getColorN_Pattern(Ct){let kt;if(Ct[0]==="TilingPattern"){const jt=Ct[1],Vt=this.baseTransform||(0,j.getCurrentTransform)(this.ctx),zt={createCanvasGraphics:qt=>new Dt(qt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};kt=new _e.TilingPattern(Ct,jt,this.ctx,zt,Vt)}else kt=this._getPattern(Ct[1],Ct[2]);return kt}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(Ct,kt,jt){const Vt=$.Util.makeHexColor(Ct,kt,jt);this.ctx.strokeStyle=Vt,this.current.strokeColor=Vt}setFillRGBColor(Ct,kt,jt){const Vt=$.Util.makeHexColor(Ct,kt,jt);this.ctx.fillStyle=Vt,this.current.fillColor=Vt,this.current.patternFill=!1}_getPattern(Ct,kt=null){let jt;return this.cachedPatterns.has(Ct)?jt=this.cachedPatterns.get(Ct):(jt=(0,_e.getShadingPattern)(this.getObject(Ct)),this.cachedPatterns.set(Ct,jt)),kt&&(jt.matrix=kt),jt}shadingFill(Ct){if(!this.contentVisible)return;const kt=this.ctx;this.save();const jt=this._getPattern(Ct);kt.fillStyle=jt.getPattern(kt,this,(0,j.getCurrentTransformInverse)(kt),_e.PathType.SHADING);const Vt=(0,j.getCurrentTransformInverse)(kt);if(Vt){const{width:zt,height:qt}=kt.canvas,[Wt,ir,or,Qt]=$.Util.getAxialAlignedBoundingBox([0,0,zt,qt],Vt);this.ctx.fillRect(Wt,ir,or-Wt,Qt-ir)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,$.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,$.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(Ct,kt){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(Ct)&&Ct.length===6&&this.transform(...Ct),this.baseTransform=(0,j.getCurrentTransform)(this.ctx),kt)){const jt=kt[2]-kt[0],Vt=kt[3]-kt[1];this.ctx.rect(kt[0],kt[1],jt,Vt),this.current.updateRectMinMax((0,j.getCurrentTransform)(this.ctx),kt),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(Ct){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const kt=this.ctx;Ct.isolated||(0,$.info)("TODO: Support non-isolated groups."),Ct.knockout&&(0,$.warn)("Knockout groups not supported.");const jt=(0,j.getCurrentTransform)(kt);if(Ct.matrix&&kt.transform(...Ct.matrix),!Ct.bbox)throw new Error("Bounding box is required.");let Vt=$.Util.getAxialAlignedBoundingBox(Ct.bbox,(0,j.getCurrentTransform)(kt));const zt=[0,0,kt.canvas.width,kt.canvas.height];Vt=$.Util.intersect(Vt,zt)||[0,0,0,0];const qt=Math.floor(Vt[0]),Wt=Math.floor(Vt[1]);let ir=Math.max(Math.ceil(Vt[2])-qt,1),or=Math.max(Math.ceil(Vt[3])-Wt,1),Qt=1,gr=1;ir>nt&&(Qt=ir/nt,ir=nt),or>nt&&(gr=or/nt,or=nt),this.current.startNewPathAndClipBox([0,0,ir,or]);let ar="groupAt"+this.groupLevel;Ct.smask&&(ar+="_smask_"+this.smaskCounter++%2);const Ar=this.cachedCanvases.getCanvas(ar,ir,or),er=Ar.context;er.scale(1/Qt,1/gr),er.translate(-qt,-Wt),er.transform(...jt),Ct.smask?this.smaskStack.push({canvas:Ar.canvas,context:er,offsetX:qt,offsetY:Wt,scaleX:Qt,scaleY:gr,subtype:Ct.smask.subtype,backdrop:Ct.smask.backdrop,transferMap:Ct.smask.transferMap||null,startTransformInverse:null}):(kt.setTransform(1,0,0,1,0,0),kt.translate(qt,Wt),kt.scale(Qt,gr),kt.save()),pt(kt,er),this.ctx=er,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(kt),this.groupLevel++}endGroup(Ct){if(!this.contentVisible)return;this.groupLevel--;const kt=this.ctx,jt=this.groupStack.pop();if(this.ctx=jt,this.ctx.imageSmoothingEnabled=!1,Ct.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Vt=(0,j.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Vt);const zt=$.Util.getAxialAlignedBoundingBox([0,0,kt.canvas.width,kt.canvas.height],Vt);this.ctx.drawImage(kt.canvas,0,0),this.ctx.restore(),this.compose(zt)}}beginAnnotation(Ct,kt,jt,Vt,zt){if(mr(this,Et,Qo).call(this),yt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(kt)&&kt.length===4){const qt=kt[2]-kt[0],Wt=kt[3]-kt[1];if(zt&&this.annotationCanvasMap){jt=jt.slice(),jt[4]-=kt[0],jt[5]-=kt[1],kt=kt.slice(),kt[0]=kt[1]=0,kt[2]=qt,kt[3]=Wt;const[ir,or]=$.Util.singularValueDecompose2dScale((0,j.getCurrentTransform)(this.ctx)),{viewportScale:Qt}=this,gr=Math.ceil(qt*this.outputScaleX*Qt),ar=Math.ceil(Wt*this.outputScaleY*Qt);this.annotationCanvas=this.canvasFactory.create(gr,ar);const{canvas:Ar,context:er}=this.annotationCanvas;this.annotationCanvasMap.set(Ct,Ar),this.annotationCanvas.savedCtx=this.ctx,this.ctx=er,this.ctx.save(),this.ctx.setTransform(ir,0,0,-or,0,Wt*or),yt(this.ctx)}else yt(this.ctx),this.ctx.rect(kt[0],kt[1],qt,Wt),this.ctx.clip(),this.endPath()}this.current=new ht(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...jt),this.transform(...Vt)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),mr(this,Et,Jo).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(Ct){if(!this.contentVisible)return;const kt=Ct.count;Ct=this.getObject(Ct.data,Ct),Ct.count=kt;const jt=this.ctx,Vt=this.processingType3;if(Vt&&(Vt.compiled===void 0&&(Vt.compiled=ut(Ct)),Vt.compiled)){Vt.compiled(jt);return}const zt=this._createMaskCanvas(Ct),qt=zt.canvas;jt.save(),jt.setTransform(1,0,0,1,0,0),jt.drawImage(qt,zt.offsetX,zt.offsetY),jt.restore(),this.compose()}paintImageMaskXObjectRepeat(Ct,kt,jt=0,Vt=0,zt,qt){if(!this.contentVisible)return;Ct=this.getObject(Ct.data,Ct);const Wt=this.ctx;Wt.save();const ir=(0,j.getCurrentTransform)(Wt);Wt.transform(kt,jt,Vt,zt,0,0);const or=this._createMaskCanvas(Ct);Wt.setTransform(1,0,0,1,or.offsetX-ir[4],or.offsetY-ir[5]);for(let Qt=0,gr=qt.length;Qt<gr;Qt+=2){const ar=$.Util.transform(ir,[kt,jt,Vt,zt,qt[Qt],qt[Qt+1]]),[Ar,er]=$.Util.applyTransform([0,0],ar);Wt.drawImage(or.canvas,Ar,er)}Wt.restore(),this.compose()}paintImageMaskXObjectGroup(Ct){if(!this.contentVisible)return;const kt=this.ctx,jt=this.current.fillColor,Vt=this.current.patternFill;for(const zt of Ct){const{data:qt,width:Wt,height:ir,transform:or}=zt,Qt=this.cachedCanvases.getCanvas("maskCanvas",Wt,ir),gr=Qt.context;gr.save();const ar=this.getObject(qt,zt);mt(gr,ar),gr.globalCompositeOperation="source-in",gr.fillStyle=Vt?jt.getPattern(gr,this,(0,j.getCurrentTransformInverse)(kt),_e.PathType.FILL):jt,gr.fillRect(0,0,Wt,ir),gr.restore(),kt.save(),kt.transform(...or),kt.scale(1,-1),ft(kt,Qt.canvas,0,0,Wt,ir,0,-1,1,1),kt.restore()}this.compose()}paintImageXObject(Ct){if(!this.contentVisible)return;const kt=this.getObject(Ct);if(!kt){(0,$.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(kt)}paintImageXObjectRepeat(Ct,kt,jt,Vt){if(!this.contentVisible)return;const zt=this.getObject(Ct);if(!zt){(0,$.warn)("Dependent image isn't ready yet");return}const qt=zt.width,Wt=zt.height,ir=[];for(let or=0,Qt=Vt.length;or<Qt;or+=2)ir.push({transform:[kt,0,0,jt,Vt[or],Vt[or+1]],x:0,y:0,w:qt,h:Wt});this.paintInlineImageXObjectGroup(zt,ir)}applyTransferMapsToCanvas(Ct){return this.current.transferMaps!=="none"&&(Ct.filter=this.current.transferMaps,Ct.drawImage(Ct.canvas,0,0),Ct.filter="none"),Ct.canvas}applyTransferMapsToBitmap(Ct){if(this.current.transferMaps==="none")return Ct.bitmap;const{bitmap:kt,width:jt,height:Vt}=Ct,zt=this.cachedCanvases.getCanvas("inlineImage",jt,Vt),qt=zt.context;return qt.filter=this.current.transferMaps,qt.drawImage(kt,0,0),qt.filter="none",zt.canvas}paintInlineImageXObject(Ct){if(!this.contentVisible)return;const kt=Ct.width,jt=Ct.height,Vt=this.ctx;if(this.save(),!$.isNodeJS){const{filter:Wt}=Vt;Wt!=="none"&&Wt!==""&&(Vt.filter="none")}Vt.scale(1/kt,-1/jt);let zt;if(Ct.bitmap)zt=this.applyTransferMapsToBitmap(Ct);else if(typeof HTMLElement=="function"&&Ct instanceof HTMLElement||!Ct.data)zt=Ct;else{const ir=this.cachedCanvases.getCanvas("inlineImage",kt,jt).context;dt(ir,Ct),zt=this.applyTransferMapsToCanvas(ir)}const qt=this._scaleImage(zt,(0,j.getCurrentTransformInverse)(Vt));Vt.imageSmoothingEnabled=wt((0,j.getCurrentTransform)(Vt),Ct.interpolate),ft(Vt,qt.img,0,0,qt.paintWidth,qt.paintHeight,0,-jt,kt,jt),this.compose(),this.restore()}paintInlineImageXObjectGroup(Ct,kt){if(!this.contentVisible)return;const jt=this.ctx;let Vt;if(Ct.bitmap)Vt=Ct.bitmap;else{const zt=Ct.width,qt=Ct.height,ir=this.cachedCanvases.getCanvas("inlineImage",zt,qt).context;dt(ir,Ct),Vt=this.applyTransferMapsToCanvas(ir)}for(const zt of kt)jt.save(),jt.transform(...zt.transform),jt.scale(1,-1),ft(jt,Vt,zt.x,zt.y,zt.w,zt.h,0,-1,1,1),jt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(Ct){}markPointProps(Ct,kt){}beginMarkedContent(Ct){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(Ct,kt){Ct==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(kt)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(Ct){const kt=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(Ct);const jt=this.ctx;this.pendingClip&&(kt||(this.pendingClip===Pt?jt.clip("evenodd"):jt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),jt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const Ct=(0,j.getCurrentTransform)(this.ctx);if(Ct[1]===0&&Ct[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(Ct[0]),Math.abs(Ct[3]));else{const kt=Math.abs(Ct[0]*Ct[3]-Ct[2]*Ct[1]),jt=Math.hypot(Ct[0],Ct[2]),Vt=Math.hypot(Ct[1],Ct[3]);this._cachedGetSinglePixelWidth=Math.max(jt,Vt)/kt}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:Ct}=this.current,{a:kt,b:jt,c:Vt,d:zt}=this.ctx.getTransform();let qt,Wt;if(jt===0&&Vt===0){const ir=Math.abs(kt),or=Math.abs(zt);if(ir===or)if(Ct===0)qt=Wt=1/ir;else{const Qt=ir*Ct;qt=Wt=Qt<1?1/Qt:1}else if(Ct===0)qt=1/ir,Wt=1/or;else{const Qt=ir*Ct,gr=or*Ct;qt=Qt<1?1/Qt:1,Wt=gr<1?1/gr:1}}else{const ir=Math.abs(kt*zt-jt*Vt),or=Math.hypot(kt,jt),Qt=Math.hypot(Vt,zt);if(Ct===0)qt=Qt/ir,Wt=or/ir;else{const gr=Ct*ir;qt=Qt>gr?Qt/gr:1,Wt=or>gr?or/gr:1}}this._cachedScaleForStroking[0]=qt,this._cachedScaleForStroking[1]=Wt}return this._cachedScaleForStroking}rescaleAndStroke(Ct){const{ctx:kt}=this,{lineWidth:jt}=this.current,[Vt,zt]=this.getScaleForStroking();if(kt.lineWidth=jt||1,Vt===1&&zt===1){kt.stroke();return}const qt=kt.getLineDash();if(Ct&&kt.save(),kt.scale(Vt,zt),qt.length>0){const Wt=Math.max(Vt,zt);kt.setLineDash(qt.map(ir=>ir/Wt)),kt.lineDashOffset/=Wt}kt.stroke(),Ct&&kt.restore()}isContentVisible(){for(let Ct=this.markedContentStack.length-1;Ct>=0;Ct--)if(!this.markedContentStack[Ct].visible)return!1;return!0}};Et=new WeakSet,Qo=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Jo=function(){if(this.pageColors){const Ct=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(Ct!=="none"){const kt=this.ctx.filter;this.ctx.filter=Ct,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=kt}}};let Rt=Dt;i.CanvasGraphics=Rt;for(const Lt in $.OPS)Rt.prototype[Lt]!==void 0&&(Rt.prototype[$.OPS[Lt]]=Rt.prototype[Lt])},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=ot;var $=_(1),j=_(6);const _e={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=_e;function et(ut,ht){if(!ht)return;const dt=ht[2]-ht[0],mt=ht[3]-ht[1],pt=new Path2D;pt.rect(ht[0],ht[1],dt,mt),ut.clip(pt)}class tt{constructor(){this.constructor===tt&&(0,$.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,$.unreachable)("Abstract method `getPattern` called.")}}class rt extends tt{constructor(ht){super(),this._type=ht[1],this._bbox=ht[2],this._colorStops=ht[3],this._p0=ht[4],this._p1=ht[5],this._r0=ht[6],this._r1=ht[7],this.matrix=null}_createGradient(ht){let dt;this._type==="axial"?dt=ht.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(dt=ht.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const mt of this._colorStops)dt.addColorStop(mt[0],mt[1]);return dt}getPattern(ht,dt,mt,pt){let yt;if(pt===_e.STROKE||pt===_e.FILL){const gt=dt.current.getClippedPathBoundingBox(pt,(0,j.getCurrentTransform)(ht))||[0,0,0,0],vt=Math.ceil(gt[2]-gt[0])||1,St=Math.ceil(gt[3]-gt[1])||1,At=dt.cachedCanvases.getCanvas("pattern",vt,St,!0),xt=At.context;xt.clearRect(0,0,xt.canvas.width,xt.canvas.height),xt.beginPath(),xt.rect(0,0,xt.canvas.width,xt.canvas.height),xt.translate(-gt[0],-gt[1]),mt=$.Util.transform(mt,[1,0,0,1,gt[0],gt[1]]),xt.transform(...dt.baseTransform),this.matrix&&xt.transform(...this.matrix),et(xt,this._bbox),xt.fillStyle=this._createGradient(xt),xt.fill(),yt=ht.createPattern(At.canvas,"no-repeat");const wt=new DOMMatrix(mt);yt.setTransform(wt)}else et(ht,this._bbox),yt=this._createGradient(ht);return yt}}function nt(ut,ht,dt,mt,pt,yt,gt,vt){const St=ht.coords,At=ht.colors,xt=ut.data,wt=ut.width*4;let Ot;St[dt+1]>St[mt+1]&&(Ot=dt,dt=mt,mt=Ot,Ot=yt,yt=gt,gt=Ot),St[mt+1]>St[pt+1]&&(Ot=mt,mt=pt,pt=Ot,Ot=gt,gt=vt,vt=Ot),St[dt+1]>St[mt+1]&&(Ot=dt,dt=mt,mt=Ot,Ot=yt,yt=gt,gt=Ot);const Bt=(St[dt]+ht.offsetX)*ht.scaleX,Ft=(St[dt+1]+ht.offsetY)*ht.scaleY,Pt=(St[mt]+ht.offsetX)*ht.scaleX,Rt=(St[mt+1]+ht.offsetY)*ht.scaleY,Et=(St[pt]+ht.offsetX)*ht.scaleX,_t=(St[pt+1]+ht.offsetY)*ht.scaleY;if(Ft>=_t)return;const Mt=At[yt],Dt=At[yt+1],Lt=At[yt+2],Ct=At[gt],kt=At[gt+1],jt=At[gt+2],Vt=At[vt],zt=At[vt+1],qt=At[vt+2],Wt=Math.round(Ft),ir=Math.round(_t);let or,Qt,gr,ar,Ar,er,sr,Gt;for(let Jt=Wt;Jt<=ir;Jt++){if(Jt<Rt){const Or=Jt<Ft?0:(Ft-Jt)/(Ft-Rt);or=Bt-(Bt-Pt)*Or,Qt=Mt-(Mt-Ct)*Or,gr=Dt-(Dt-kt)*Or,ar=Lt-(Lt-jt)*Or}else{let Or;Jt>_t?Or=1:Rt===_t?Or=0:Or=(Rt-Jt)/(Rt-_t),or=Pt-(Pt-Et)*Or,Qt=Ct-(Ct-Vt)*Or,gr=kt-(kt-zt)*Or,ar=jt-(jt-qt)*Or}let lr;Jt<Ft?lr=0:Jt>_t?lr=1:lr=(Ft-Jt)/(Ft-_t),Ar=Bt-(Bt-Et)*lr,er=Mt-(Mt-Vt)*lr,sr=Dt-(Dt-zt)*lr,Gt=Lt-(Lt-qt)*lr;const dr=Math.round(Math.min(or,Ar)),xr=Math.round(Math.max(or,Ar));let Mr=wt*Jt+dr*4;for(let Or=dr;Or<=xr;Or++)lr=(or-Or)/(or-Ar),lr<0?lr=0:lr>1&&(lr=1),xt[Mr++]=Qt-(Qt-er)*lr|0,xt[Mr++]=gr-(gr-sr)*lr|0,xt[Mr++]=ar-(ar-Gt)*lr|0,xt[Mr++]=255}}function it(ut,ht,dt){const mt=ht.coords,pt=ht.colors;let yt,gt;switch(ht.type){case"lattice":const vt=ht.verticesPerRow,St=Math.floor(mt.length/vt)-1,At=vt-1;for(yt=0;yt<St;yt++){let xt=yt*vt;for(let wt=0;wt<At;wt++,xt++)nt(ut,dt,mt[xt],mt[xt+1],mt[xt+vt],pt[xt],pt[xt+1],pt[xt+vt]),nt(ut,dt,mt[xt+vt+1],mt[xt+1],mt[xt+vt],pt[xt+vt+1],pt[xt+1],pt[xt+vt])}break;case"triangles":for(yt=0,gt=mt.length;yt<gt;yt+=3)nt(ut,dt,mt[yt],mt[yt+1],mt[yt+2],pt[yt],pt[yt+1],pt[yt+2]);break;default:throw new Error("illegal figure")}}class st extends tt{constructor(ht){super(),this._coords=ht[2],this._colors=ht[3],this._figures=ht[4],this._bounds=ht[5],this._bbox=ht[7],this._background=ht[8],this.matrix=null}_createMeshCanvas(ht,dt,mt){const vt=Math.floor(this._bounds[0]),St=Math.floor(this._bounds[1]),At=Math.ceil(this._bounds[2])-vt,xt=Math.ceil(this._bounds[3])-St,wt=Math.min(Math.ceil(Math.abs(At*ht[0]*1.1)),3e3),Ot=Math.min(Math.ceil(Math.abs(xt*ht[1]*1.1)),3e3),Bt=At/wt,Ft=xt/Ot,Pt={coords:this._coords,colors:this._colors,offsetX:-vt,offsetY:-St,scaleX:1/Bt,scaleY:1/Ft},Rt=wt+2*2,Et=Ot+2*2,_t=mt.getCanvas("mesh",Rt,Et,!1),Mt=_t.context,Dt=Mt.createImageData(wt,Ot);if(dt){const Ct=Dt.data;for(let kt=0,jt=Ct.length;kt<jt;kt+=4)Ct[kt]=dt[0],Ct[kt+1]=dt[1],Ct[kt+2]=dt[2],Ct[kt+3]=255}for(const Ct of this._figures)it(Dt,Ct,Pt);return Mt.putImageData(Dt,2,2),{canvas:_t.canvas,offsetX:vt-2*Bt,offsetY:St-2*Ft,scaleX:Bt,scaleY:Ft}}getPattern(ht,dt,mt,pt){et(ht,this._bbox);let yt;if(pt===_e.SHADING)yt=$.Util.singularValueDecompose2dScale((0,j.getCurrentTransform)(ht));else if(yt=$.Util.singularValueDecompose2dScale(dt.baseTransform),this.matrix){const vt=$.Util.singularValueDecompose2dScale(this.matrix);yt=[yt[0]*vt[0],yt[1]*vt[1]]}const gt=this._createMeshCanvas(yt,pt===_e.SHADING?null:this._background,dt.cachedCanvases);return pt!==_e.SHADING&&(ht.setTransform(...dt.baseTransform),this.matrix&&ht.transform(...this.matrix)),ht.translate(gt.offsetX,gt.offsetY),ht.scale(gt.scaleX,gt.scaleY),ht.createPattern(gt.canvas,"no-repeat")}}class at extends tt{getPattern(){return"hotpink"}}function ot(ut){switch(ut[0]){case"RadialAxial":return new rt(ut);case"Mesh":return new st(ut);case"Dummy":return new at}throw new Error(`Unknown IR type: ${ut[0]}`)}const lt={COLORED:1,UNCOLORED:2},ft=class ft{constructor(ht,dt,mt,pt,yt){this.operatorList=ht[2],this.matrix=ht[3]||[1,0,0,1,0,0],this.bbox=ht[4],this.xstep=ht[5],this.ystep=ht[6],this.paintType=ht[7],this.tilingType=ht[8],this.color=dt,this.ctx=mt,this.canvasGraphicsFactory=pt,this.baseTransform=yt}createPatternCanvas(ht){const dt=this.operatorList,mt=this.bbox,pt=this.xstep,yt=this.ystep,gt=this.paintType,vt=this.tilingType,St=this.color,At=this.canvasGraphicsFactory;(0,$.info)("TilingType: "+vt);const xt=mt[0],wt=mt[1],Ot=mt[2],Bt=mt[3],Ft=$.Util.singularValueDecompose2dScale(this.matrix),Pt=$.Util.singularValueDecompose2dScale(this.baseTransform),Rt=[Ft[0]*Pt[0],Ft[1]*Pt[1]],Et=this.getSizeAndScale(pt,this.ctx.canvas.width,Rt[0]),_t=this.getSizeAndScale(yt,this.ctx.canvas.height,Rt[1]),Mt=ht.cachedCanvases.getCanvas("pattern",Et.size,_t.size,!0),Dt=Mt.context,Lt=At.createCanvasGraphics(Dt);Lt.groupLevel=ht.groupLevel,this.setFillAndStrokeStyleToContext(Lt,gt,St);let Ct=xt,kt=wt,jt=Ot,Vt=Bt;return xt<0&&(Ct=0,jt+=Math.abs(xt)),wt<0&&(kt=0,Vt+=Math.abs(wt)),Dt.translate(-(Et.scale*Ct),-(_t.scale*kt)),Lt.transform(Et.scale,0,0,_t.scale,0,0),Dt.save(),this.clipBbox(Lt,Ct,kt,jt,Vt),Lt.baseTransform=(0,j.getCurrentTransform)(Lt.ctx),Lt.executeOperatorList(dt),Lt.endDrawing(),{canvas:Mt.canvas,scaleX:Et.scale,scaleY:_t.scale,offsetX:Ct,offsetY:kt}}getSizeAndScale(ht,dt,mt){ht=Math.abs(ht);const pt=Math.max(ft.MAX_PATTERN_SIZE,dt);let yt=Math.ceil(ht*mt);return yt>=pt?yt=pt:mt=yt/ht,{scale:mt,size:yt}}clipBbox(ht,dt,mt,pt,yt){const gt=pt-dt,vt=yt-mt;ht.ctx.rect(dt,mt,gt,vt),ht.current.updateRectMinMax((0,j.getCurrentTransform)(ht.ctx),[dt,mt,pt,yt]),ht.clip(),ht.endPath()}setFillAndStrokeStyleToContext(ht,dt,mt){const pt=ht.ctx,yt=ht.current;switch(dt){case lt.COLORED:const gt=this.ctx;pt.fillStyle=gt.fillStyle,pt.strokeStyle=gt.strokeStyle,yt.fillColor=gt.fillStyle,yt.strokeColor=gt.strokeStyle;break;case lt.UNCOLORED:const vt=$.Util.makeHexColor(mt[0],mt[1],mt[2]);pt.fillStyle=vt,pt.strokeStyle=vt,yt.fillColor=vt,yt.strokeColor=vt;break;default:throw new $.FormatError(`Unsupported paint type: ${dt}`)}}getPattern(ht,dt,mt,pt){let yt=mt;pt!==_e.SHADING&&(yt=$.Util.transform(yt,dt.baseTransform),this.matrix&&(yt=$.Util.transform(yt,this.matrix)));const gt=this.createPatternCanvas(dt);let vt=new DOMMatrix(yt);vt=vt.translate(gt.offsetX,gt.offsetY),vt=vt.scale(1/gt.scaleX,1/gt.scaleY);const St=ht.createPattern(gt.canvas,"repeat");return St.setTransform(vt),St}};Rn(ft,"MAX_PATTERN_SIZE",3e3);let ct=ft;i.TilingPattern=ct},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=_e,i.convertToRGBA=j,i.grayToRGBA=tt;var $=_(1);function j(rt){switch(rt.kind){case $.ImageKind.GRAYSCALE_1BPP:return _e(rt);case $.ImageKind.RGB_24BPP:return et(rt)}return null}function _e({src:rt,srcPos:nt=0,dest:it,width:st,height:at,nonBlackColor:ot=4294967295,inverseDecode:lt=!1}){const ct=$.FeatureTest.isLittleEndian?4278190080:255,[ft,ut]=lt?[ot,ct]:[ct,ot],ht=st>>3,dt=st&7,mt=rt.length;it=new Uint32Array(it.buffer);let pt=0;for(let yt=0;yt<at;yt++){for(const vt=nt+ht;nt<vt;nt++){const St=nt<mt?rt[nt]:255;it[pt++]=St&128?ut:ft,it[pt++]=St&64?ut:ft,it[pt++]=St&32?ut:ft,it[pt++]=St&16?ut:ft,it[pt++]=St&8?ut:ft,it[pt++]=St&4?ut:ft,it[pt++]=St&2?ut:ft,it[pt++]=St&1?ut:ft}if(dt===0)continue;const gt=nt<mt?rt[nt++]:255;for(let vt=0;vt<dt;vt++)it[pt++]=gt&1<<7-vt?ut:ft}return{srcPos:nt,destPos:pt}}function et({src:rt,srcPos:nt=0,dest:it,destPos:st=0,width:at,height:ot}){let lt=0;const ct=rt.length>>2,ft=new Uint32Array(rt.buffer,nt,ct);if($.FeatureTest.isLittleEndian){for(;lt<ct-2;lt+=3,st+=4){const ut=ft[lt],ht=ft[lt+1],dt=ft[lt+2];it[st]=ut|4278190080,it[st+1]=ut>>>24|ht<<8|4278190080,it[st+2]=ht>>>16|dt<<16|4278190080,it[st+3]=dt>>>8|4278190080}for(let ut=lt*4,ht=rt.length;ut<ht;ut+=3)it[st++]=rt[ut]|rt[ut+1]<<8|rt[ut+2]<<16|4278190080}else{for(;lt<ct-2;lt+=3,st+=4){const ut=ft[lt],ht=ft[lt+1],dt=ft[lt+2];it[st]=ut|255,it[st+1]=ut<<24|ht>>>8|255,it[st+2]=ht<<16|dt>>>16|255,it[st+3]=dt<<8|255}for(let ut=lt*4,ht=rt.length;ut<ht;ut+=3)it[st++]=rt[ut]<<24|rt[ut+1]<<16|rt[ut+2]<<8|255}return{srcPos:nt,destPos:st}}function tt(rt,nt){if($.FeatureTest.isLittleEndian)for(let it=0,st=rt.length;it<st;it++)nt[it]=rt[it]*65793|4278190080;else for(let it=0,st=rt.length;it<st;it++)nt[it]=rt[it]*16843008|255}},(o,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const _=Object.create(null);i.GlobalWorkerOptions=_,_.workerPort=null,_.workerSrc=""},(o,i,_)=>{var rt,yu,vu,ro;Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var $=_(1);const j={DATA:1,ERROR:2},_e={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function et(at){switch(at instanceof Error||typeof at=="object"&&at!==null||(0,$.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),at.name){case"AbortException":return new $.AbortException(at.message);case"MissingPDFException":return new $.MissingPDFException(at.message);case"PasswordException":return new $.PasswordException(at.message,at.code);case"UnexpectedResponseException":return new $.UnexpectedResponseException(at.message,at.status);case"UnknownErrorException":return new $.UnknownErrorException(at.message,at.details);default:return new $.UnknownErrorException(at.message,at.toString())}}class tt{constructor(ot,lt,ct){Er(this,rt);this.sourceName=ot,this.targetName=lt,this.comObj=ct,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=ft=>{const ut=ft.data;if(ut.targetName!==this.sourceName)return;if(ut.stream){mr(this,rt,vu).call(this,ut);return}if(ut.callback){const dt=ut.callbackId,mt=this.callbackCapabilities[dt];if(!mt)throw new Error(`Cannot resolve callback ${dt}`);if(delete this.callbackCapabilities[dt],ut.callback===j.DATA)mt.resolve(ut.data);else if(ut.callback===j.ERROR)mt.reject(et(ut.reason));else throw new Error("Unexpected callback case");return}const ht=this.actionHandler[ut.action];if(!ht)throw new Error(`Unknown action from worker: ${ut.action}`);if(ut.callbackId){const dt=this.sourceName,mt=ut.sourceName;new Promise(function(pt){pt(ht(ut.data))}).then(function(pt){ct.postMessage({sourceName:dt,targetName:mt,callback:j.DATA,callbackId:ut.callbackId,data:pt})},function(pt){ct.postMessage({sourceName:dt,targetName:mt,callback:j.ERROR,callbackId:ut.callbackId,reason:et(pt)})});return}if(ut.streamId){mr(this,rt,yu).call(this,ut);return}ht(ut.data)},ct.addEventListener("message",this._onComObjOnMessage)}on(ot,lt){const ct=this.actionHandler;if(ct[ot])throw new Error(`There is already an actionName called "${ot}"`);ct[ot]=lt}send(ot,lt,ct){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ot,data:lt},ct)}sendWithPromise(ot,lt,ct){const ft=this.callbackId++,ut=new $.PromiseCapability;this.callbackCapabilities[ft]=ut;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ot,callbackId:ft,data:lt},ct)}catch(ht){ut.reject(ht)}return ut.promise}sendWithStream(ot,lt,ct,ft){const ut=this.streamId++,ht=this.sourceName,dt=this.targetName,mt=this.comObj;return new ReadableStream({start:pt=>{const yt=new $.PromiseCapability;return this.streamControllers[ut]={controller:pt,startCall:yt,pullCall:null,cancelCall:null,isClosed:!1},mt.postMessage({sourceName:ht,targetName:dt,action:ot,streamId:ut,data:lt,desiredSize:pt.desiredSize},ft),yt.promise},pull:pt=>{const yt=new $.PromiseCapability;return this.streamControllers[ut].pullCall=yt,mt.postMessage({sourceName:ht,targetName:dt,stream:_e.PULL,streamId:ut,desiredSize:pt.desiredSize}),yt.promise},cancel:pt=>{(0,$.assert)(pt instanceof Error,"cancel must have a valid reason");const yt=new $.PromiseCapability;return this.streamControllers[ut].cancelCall=yt,this.streamControllers[ut].isClosed=!0,mt.postMessage({sourceName:ht,targetName:dt,stream:_e.CANCEL,streamId:ut,reason:et(pt)}),yt.promise}},ct)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}rt=new WeakSet,yu=function(ot){const lt=ot.streamId,ct=this.sourceName,ft=ot.sourceName,ut=this.comObj,ht=this,dt=this.actionHandler[ot.action],mt={enqueue(pt,yt=1,gt){if(this.isCancelled)return;const vt=this.desiredSize;this.desiredSize-=yt,vt>0&&this.desiredSize<=0&&(this.sinkCapability=new $.PromiseCapability,this.ready=this.sinkCapability.promise),ut.postMessage({sourceName:ct,targetName:ft,stream:_e.ENQUEUE,streamId:lt,chunk:pt},gt)},close(){this.isCancelled||(this.isCancelled=!0,ut.postMessage({sourceName:ct,targetName:ft,stream:_e.CLOSE,streamId:lt}),delete ht.streamSinks[lt])},error(pt){(0,$.assert)(pt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,ut.postMessage({sourceName:ct,targetName:ft,stream:_e.ERROR,streamId:lt,reason:et(pt)}))},sinkCapability:new $.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:ot.desiredSize,ready:null};mt.sinkCapability.resolve(),mt.ready=mt.sinkCapability.promise,this.streamSinks[lt]=mt,new Promise(function(pt){pt(dt(ot.data,mt))}).then(function(){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.START_COMPLETE,streamId:lt,success:!0})},function(pt){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.START_COMPLETE,streamId:lt,reason:et(pt)})})},vu=function(ot){const lt=ot.streamId,ct=this.sourceName,ft=ot.sourceName,ut=this.comObj,ht=this.streamControllers[lt],dt=this.streamSinks[lt];switch(ot.stream){case _e.START_COMPLETE:ot.success?ht.startCall.resolve():ht.startCall.reject(et(ot.reason));break;case _e.PULL_COMPLETE:ot.success?ht.pullCall.resolve():ht.pullCall.reject(et(ot.reason));break;case _e.PULL:if(!dt){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.PULL_COMPLETE,streamId:lt,success:!0});break}dt.desiredSize<=0&&ot.desiredSize>0&&dt.sinkCapability.resolve(),dt.desiredSize=ot.desiredSize,new Promise(function(mt){var pt;mt((pt=dt.onPull)==null?void 0:pt.call(dt))}).then(function(){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.PULL_COMPLETE,streamId:lt,success:!0})},function(mt){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.PULL_COMPLETE,streamId:lt,reason:et(mt)})});break;case _e.ENQUEUE:if((0,$.assert)(ht,"enqueue should have stream controller"),ht.isClosed)break;ht.controller.enqueue(ot.chunk);break;case _e.CLOSE:if((0,$.assert)(ht,"close should have stream controller"),ht.isClosed)break;ht.isClosed=!0,ht.controller.close(),mr(this,rt,ro).call(this,ht,lt);break;case _e.ERROR:(0,$.assert)(ht,"error should have stream controller"),ht.controller.error(et(ot.reason)),mr(this,rt,ro).call(this,ht,lt);break;case _e.CANCEL_COMPLETE:ot.success?ht.cancelCall.resolve():ht.cancelCall.reject(et(ot.reason)),mr(this,rt,ro).call(this,ht,lt);break;case _e.CANCEL:if(!dt)break;new Promise(function(mt){var pt;mt((pt=dt.onCancel)==null?void 0:pt.call(dt,et(ot.reason)))}).then(function(){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.CANCEL_COMPLETE,streamId:lt,success:!0})},function(mt){ut.postMessage({sourceName:ct,targetName:ft,stream:_e.CANCEL_COMPLETE,streamId:lt,reason:et(mt)})}),dt.sinkCapability.reject(et(ot.reason)),dt.isCancelled=!0,delete this.streamSinks[lt];break;default:throw new Error("Unexpected stream case")}},ro=async function(ot,lt){var ct,ft,ut;await Promise.allSettled([(ct=ot.startCall)==null?void 0:ct.promise,(ft=ot.pullCall)==null?void 0:ft.promise,(ut=ot.cancelCall)==null?void 0:ut.promise]),delete this.streamControllers[lt]},i.MessageHandler=tt},(o,i,_)=>{var _e,et;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var $=_(1);class j{constructor({parsedData:rt,rawData:nt}){Er(this,_e);Er(this,et);Tr(this,_e,rt),Tr(this,et,nt)}getRaw(){return $t(this,et)}get(rt){return $t(this,_e).get(rt)??null}getAll(){return(0,$.objectFromMap)($t(this,_e))}has(rt){return $t(this,_e).has(rt)}}_e=new WeakMap,et=new WeakMap,i.Metadata=j},(o,i,_)=>{var rt,nt,it,st,at,ot,Zo;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var $=_(1),j=_(8);const _e=Symbol("INTERNAL");class et{constructor(ft,ut){Er(this,rt,!0);this.name=ft,this.intent=ut}get visible(){return $t(this,rt)}_setVisible(ft,ut){ft!==_e&&(0,$.unreachable)("Internal method `_setVisible` called."),Tr(this,rt,ut)}}rt=new WeakMap;class tt{constructor(ft){Er(this,ot);Er(this,nt,null);Er(this,it,new Map);Er(this,st,null);Er(this,at,null);if(this.name=null,this.creator=null,ft!==null){this.name=ft.name,this.creator=ft.creator,Tr(this,at,ft.order);for(const ut of ft.groups)$t(this,it).set(ut.id,new et(ut.name,ut.intent));if(ft.baseState==="OFF")for(const ut of $t(this,it).values())ut._setVisible(_e,!1);for(const ut of ft.on)$t(this,it).get(ut)._setVisible(_e,!0);for(const ut of ft.off)$t(this,it).get(ut)._setVisible(_e,!1);Tr(this,st,this.getHash())}}isVisible(ft){if($t(this,it).size===0)return!0;if(!ft)return(0,$.warn)("Optional content group not defined."),!0;if(ft.type==="OCG")return $t(this,it).has(ft.id)?$t(this,it).get(ft.id).visible:((0,$.warn)(`Optional content group not found: ${ft.id}`),!0);if(ft.type==="OCMD"){if(ft.expression)return mr(this,ot,Zo).call(this,ft.expression);if(!ft.policy||ft.policy==="AnyOn"){for(const ut of ft.ids){if(!$t(this,it).has(ut))return(0,$.warn)(`Optional content group not found: ${ut}`),!0;if($t(this,it).get(ut).visible)return!0}return!1}else if(ft.policy==="AllOn"){for(const ut of ft.ids){if(!$t(this,it).has(ut))return(0,$.warn)(`Optional content group not found: ${ut}`),!0;if(!$t(this,it).get(ut).visible)return!1}return!0}else if(ft.policy==="AnyOff"){for(const ut of ft.ids){if(!$t(this,it).has(ut))return(0,$.warn)(`Optional content group not found: ${ut}`),!0;if(!$t(this,it).get(ut).visible)return!0}return!1}else if(ft.policy==="AllOff"){for(const ut of ft.ids){if(!$t(this,it).has(ut))return(0,$.warn)(`Optional content group not found: ${ut}`),!0;if($t(this,it).get(ut).visible)return!1}return!0}return(0,$.warn)(`Unknown optional content policy ${ft.policy}.`),!0}return(0,$.warn)(`Unknown group type ${ft.type}.`),!0}setVisibility(ft,ut=!0){if(!$t(this,it).has(ft)){(0,$.warn)(`Optional content group not found: ${ft}`);return}$t(this,it).get(ft)._setVisible(_e,!!ut),Tr(this,nt,null)}get hasInitialVisibility(){return $t(this,st)===null||this.getHash()===$t(this,st)}getOrder(){return $t(this,it).size?$t(this,at)?$t(this,at).slice():[...$t(this,it).keys()]:null}getGroups(){return $t(this,it).size>0?(0,$.objectFromMap)($t(this,it)):null}getGroup(ft){return $t(this,it).get(ft)||null}getHash(){if($t(this,nt)!==null)return $t(this,nt);const ft=new j.MurmurHash3_64;for(const[ut,ht]of $t(this,it))ft.update(`${ut}:${ht.visible}`);return Tr(this,nt,ft.hexdigest())}}nt=new WeakMap,it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakSet,Zo=function(ft){const ut=ft.length;if(ut<2)return!0;const ht=ft[0];for(let dt=1;dt<ut;dt++){const mt=ft[dt];let pt;if(Array.isArray(mt))pt=mr(this,ot,Zo).call(this,mt);else if($t(this,it).has(mt))pt=$t(this,it).get(mt).visible;else return(0,$.warn)(`Optional content group not found: ${mt}`),!0;switch(ht){case"And":if(!pt)return!1;break;case"Or":if(pt)return!0;break;case"Not":return!pt;default:return!0}}return ht==="And"},i.OptionalContentConfig=tt},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var $=_(1),j=_(6);class _e{constructor({length:nt,initialData:it,progressiveDone:st=!1,contentDispositionFilename:at=null,disableRange:ot=!1,disableStream:lt=!1},ct){if((0,$.assert)(ct,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=st,this._contentDispositionFilename=at,(it==null?void 0:it.length)>0){const ft=it instanceof Uint8Array&&it.byteLength===it.buffer.byteLength?it.buffer:new Uint8Array(it).buffer;this._queuedChunks.push(ft)}this._pdfDataRangeTransport=ct,this._isStreamingSupported=!lt,this._isRangeSupported=!ot,this._contentLength=nt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((ft,ut)=>{this._onReceiveData({begin:ft,chunk:ut})}),this._pdfDataRangeTransport.addProgressListener((ft,ut)=>{this._onProgress({loaded:ft,total:ut})}),this._pdfDataRangeTransport.addProgressiveReadListener(ft=>{this._onReceiveData({chunk:ft})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:nt,chunk:it}){const st=it instanceof Uint8Array&&it.byteLength===it.buffer.byteLength?it.buffer:new Uint8Array(it).buffer;if(nt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(st):this._queuedChunks.push(st);else{const at=this._rangeReaders.some(function(ot){return ot._begin!==nt?!1:(ot._enqueue(st),!0)});(0,$.assert)(at,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var nt;return((nt=this._fullRequestReader)==null?void 0:nt._loaded)??0}_onProgress(nt){var it,st,at,ot;nt.total===void 0?(st=(it=this._rangeReaders[0])==null?void 0:it.onProgress)==null||st.call(it,{loaded:nt.loaded}):(ot=(at=this._fullRequestReader)==null?void 0:at.onProgress)==null||ot.call(at,{loaded:nt.loaded,total:nt.total})}_onProgressiveDone(){var nt;(nt=this._fullRequestReader)==null||nt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(nt){const it=this._rangeReaders.indexOf(nt);it>=0&&this._rangeReaders.splice(it,1)}getFullReader(){(0,$.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const nt=this._queuedChunks;return this._queuedChunks=null,new et(this,nt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(nt,it){if(it<=this._progressiveDataLength)return null;const st=new tt(this,nt,it);return this._pdfDataRangeTransport.requestDataRange(nt,it),this._rangeReaders.push(st),st}cancelAllRequests(nt){var it;(it=this._fullRequestReader)==null||it.cancel(nt);for(const st of this._rangeReaders.slice(0))st.cancel(nt);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=_e;class et{constructor(nt,it,st=!1,at=null){this._stream=nt,this._done=st||!1,this._filename=(0,j.isPdfFile)(at)?at:null,this._queuedChunks=it||[],this._loaded=0;for(const ot of this._queuedChunks)this._loaded+=ot.byteLength;this._requests=[],this._headersReady=Promise.resolve(),nt._fullRequestReader=this,this.onProgress=null}_enqueue(nt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:nt,done:!1}):this._queuedChunks.push(nt),this._loaded+=nt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const nt=new $.PromiseCapability;return this._requests.push(nt),nt.promise}cancel(nt){this._done=!0;for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(nt,it,st){this._stream=nt,this._begin=it,this._end=st,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(nt){if(!this._done){if(this._requests.length===0)this._queuedChunk=nt;else{this._requests.shift().resolve({value:nt,done:!1});for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const it=this._queuedChunk;return this._queuedChunk=null,{value:it,done:!1}}if(this._done)return{value:void 0,done:!0};const nt=new $.PromiseCapability;return this._requests.push(nt),nt.promise}cancel(nt){this._done=!0;for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var $=_(1),j=_(20);function _e(st,at,ot){return{method:"GET",headers:st,signal:ot.signal,mode:"cors",credentials:at?"include":"same-origin",redirect:"follow"}}function et(st){const at=new Headers;for(const ot in st){const lt=st[ot];lt!==void 0&&at.append(ot,lt)}return at}function tt(st){return st instanceof Uint8Array?st.buffer:st instanceof ArrayBuffer?st:((0,$.warn)(`getArrayBuffer - unexpected data format: ${st}`),new Uint8Array(st).buffer)}class rt{constructor(at){this.source=at,this.isHttp=/^https?:/i.test(at.url),this.httpHeaders=this.isHttp&&at.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var at;return((at=this._fullRequestReader)==null?void 0:at._loaded)??0}getFullReader(){return(0,$.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new nt(this),this._fullRequestReader}getRangeReader(at,ot){if(ot<=this._progressiveDataLength)return null;const lt=new it(this,at,ot);return this._rangeRequestReaders.push(lt),lt}cancelAllRequests(at){var ot;(ot=this._fullRequestReader)==null||ot.cancel(at);for(const lt of this._rangeRequestReaders.slice(0))lt.cancel(at)}}i.PDFFetchStream=rt;class nt{constructor(at){this._stream=at,this._reader=null,this._loaded=0,this._filename=null;const ot=at.source;this._withCredentials=ot.withCredentials||!1,this._contentLength=ot.length,this._headersCapability=new $.PromiseCapability,this._disableRange=ot.disableRange||!1,this._rangeChunkSize=ot.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!ot.disableStream,this._isRangeSupported=!ot.disableRange,this._headers=et(this._stream.httpHeaders);const lt=ot.url;fetch(lt,_e(this._headers,this._withCredentials,this._abortController)).then(ct=>{if(!(0,j.validateResponseStatus)(ct.status))throw(0,j.createResponseStatusError)(ct.status,lt);this._reader=ct.body.getReader(),this._headersCapability.resolve();const ft=dt=>ct.headers.get(dt),{allowRangeRequests:ut,suggestedLength:ht}=(0,j.validateRangeRequestCapabilities)({getResponseHeader:ft,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ut,this._contentLength=ht||this._contentLength,this._filename=(0,j.extractFilenameFromHeader)(ft),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new $.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var lt;await this._headersCapability.promise;const{value:at,done:ot}=await this._reader.read();return ot?{value:at,done:ot}:(this._loaded+=at.byteLength,(lt=this.onProgress)==null||lt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tt(at),done:!1})}cancel(at){var ot;(ot=this._reader)==null||ot.cancel(at),this._abortController.abort()}}class it{constructor(at,ot,lt){this._stream=at,this._reader=null,this._loaded=0;const ct=at.source;this._withCredentials=ct.withCredentials||!1,this._readCapability=new $.PromiseCapability,this._isStreamingSupported=!ct.disableStream,this._abortController=new AbortController,this._headers=et(this._stream.httpHeaders),this._headers.append("Range",`bytes=${ot}-${lt-1}`);const ft=ct.url;fetch(ft,_e(this._headers,this._withCredentials,this._abortController)).then(ut=>{if(!(0,j.validateResponseStatus)(ut.status))throw(0,j.createResponseStatusError)(ut.status,ft);this._readCapability.resolve(),this._reader=ut.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var lt;await this._readCapability.promise;const{value:at,done:ot}=await this._reader.read();return ot?{value:at,done:ot}:(this._loaded+=at.byteLength,(lt=this.onProgress)==null||lt.call(this,{loaded:this._loaded}),{value:tt(at),done:!1})}cancel(at){var ot;(ot=this._reader)==null||ot.cancel(at),this._abortController.abort()}}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=rt,i.extractFilenameFromHeader=tt,i.validateRangeRequestCapabilities=et,i.validateResponseStatus=nt;var $=_(1),j=_(21),_e=_(6);function et({getResponseHeader:it,isHttp:st,rangeChunkSize:at,disableRange:ot}){const lt={allowRangeRequests:!1,suggestedLength:void 0},ct=parseInt(it("Content-Length"),10);return!Number.isInteger(ct)||(lt.suggestedLength=ct,ct<=2*at)||ot||!st||it("Accept-Ranges")!=="bytes"||(it("Content-Encoding")||"identity")!=="identity"||(lt.allowRangeRequests=!0),lt}function tt(it){const st=it("Content-Disposition");if(st){let at=(0,j.getFilenameFromContentDispositionHeader)(st);if(at.includes("%"))try{at=decodeURIComponent(at)}catch{}if((0,_e.isPdfFile)(at))return at}return null}function rt(it,st){return it===404||it===0&&st.startsWith("file:")?new $.MissingPDFException('Missing PDF "'+st+'".'):new $.UnexpectedResponseException(`Unexpected server response (${it}) while retrieving PDF "${st}".`,it)}function nt(it){return it===200||it===206}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=j;var $=_(1);function j(_e){let et=!0,tt=rt("filename\\*","i").exec(_e);if(tt){tt=tt[1];let ct=at(tt);return ct=unescape(ct),ct=ot(ct),ct=lt(ct),it(ct)}if(tt=st(_e),tt){const ct=lt(tt);return it(ct)}if(tt=rt("filename","i").exec(_e),tt){tt=tt[1];let ct=at(tt);return ct=lt(ct),it(ct)}function rt(ct,ft){return new RegExp("(?:^|;)\\s*"+ct+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',ft)}function nt(ct,ft){if(ct){if(!/^[\x00-\xFF]+$/.test(ft))return ft;try{const ut=new TextDecoder(ct,{fatal:!0}),ht=(0,$.stringToBytes)(ft);ft=ut.decode(ht),et=!1}catch{}}return ft}function it(ct){return et&&/[\x80-\xff]/.test(ct)&&(ct=nt("utf-8",ct),et&&(ct=nt("iso-8859-1",ct))),ct}function st(ct){const ft=[];let ut;const ht=rt("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(ut=ht.exec(ct))!==null;){let[,mt,pt,yt]=ut;if(mt=parseInt(mt,10),mt in ft){if(mt===0)break;continue}ft[mt]=[pt,yt]}const dt=[];for(let mt=0;mt<ft.length&&mt in ft;++mt){let[pt,yt]=ft[mt];yt=at(yt),pt&&(yt=unescape(yt),mt===0&&(yt=ot(yt))),dt.push(yt)}return dt.join("")}function at(ct){if(ct.startsWith('"')){const ft=ct.slice(1).split('\\"');for(let ut=0;ut<ft.length;++ut){const ht=ft[ut].indexOf('"');ht!==-1&&(ft[ut]=ft[ut].slice(0,ht),ft.length=ut+1),ft[ut]=ft[ut].replaceAll(/\\(.)/g,"$1")}ct=ft.join('"')}return ct}function ot(ct){const ft=ct.indexOf("'");if(ft===-1)return ct;const ut=ct.slice(0,ft),dt=ct.slice(ft+1).replace(/^[^']*'/,"");return nt(ut,dt)}function lt(ct){return!ct.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(ct)?ct:ct.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(ft,ut,ht,dt){if(ht==="q"||ht==="Q")return dt=dt.replaceAll("_"," "),dt=dt.replaceAll(/=([0-9a-fA-F]{2})/g,function(mt,pt){return String.fromCharCode(parseInt(pt,16))}),nt(ut,dt);try{dt=atob(dt)}catch{}return nt(ut,dt)})}return""}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var $=_(1),j=_(20);const _e=200,et=206;function tt(at){const ot=at.response;return typeof ot!="string"?ot:(0,$.stringToBytes)(ot).buffer}class rt{constructor(ot,lt={}){this.url=ot,this.isHttp=/^https?:/i.test(ot),this.httpHeaders=this.isHttp&&lt.httpHeaders||Object.create(null),this.withCredentials=lt.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(ot,lt,ct){const ft={begin:ot,end:lt};for(const ut in ct)ft[ut]=ct[ut];return this.request(ft)}requestFull(ot){return this.request(ot)}request(ot){const lt=new XMLHttpRequest,ct=this.currXhrId++,ft=this.pendingRequests[ct]={xhr:lt};lt.open("GET",this.url),lt.withCredentials=this.withCredentials;for(const ut in this.httpHeaders){const ht=this.httpHeaders[ut];ht!==void 0&&lt.setRequestHeader(ut,ht)}return this.isHttp&&"begin"in ot&&"end"in ot?(lt.setRequestHeader("Range",`bytes=${ot.begin}-${ot.end-1}`),ft.expectedStatus=et):ft.expectedStatus=_e,lt.responseType="arraybuffer",ot.onError&&(lt.onerror=function(ut){ot.onError(lt.status)}),lt.onreadystatechange=this.onStateChange.bind(this,ct),lt.onprogress=this.onProgress.bind(this,ct),ft.onHeadersReceived=ot.onHeadersReceived,ft.onDone=ot.onDone,ft.onError=ot.onError,ft.onProgress=ot.onProgress,lt.send(null),ct}onProgress(ot,lt){var ft;const ct=this.pendingRequests[ot];ct&&((ft=ct.onProgress)==null||ft.call(ct,lt))}onStateChange(ot,lt){var mt,pt,yt;const ct=this.pendingRequests[ot];if(!ct)return;const ft=ct.xhr;if(ft.readyState>=2&&ct.onHeadersReceived&&(ct.onHeadersReceived(),delete ct.onHeadersReceived),ft.readyState!==4||!(ot in this.pendingRequests))return;if(delete this.pendingRequests[ot],ft.status===0&&this.isHttp){(mt=ct.onError)==null||mt.call(ct,ft.status);return}const ut=ft.status||_e;if(!(ut===_e&&ct.expectedStatus===et)&&ut!==ct.expectedStatus){(pt=ct.onError)==null||pt.call(ct,ft.status);return}const dt=tt(ft);if(ut===et){const gt=ft.getResponseHeader("Content-Range"),vt=/bytes (\d+)-(\d+)\/(\d+)/.exec(gt);ct.onDone({begin:parseInt(vt[1],10),chunk:dt})}else dt?ct.onDone({begin:0,chunk:dt}):(yt=ct.onError)==null||yt.call(ct,ft.status)}getRequestXhr(ot){return this.pendingRequests[ot].xhr}isPendingRequest(ot){return ot in this.pendingRequests}abortRequest(ot){const lt=this.pendingRequests[ot].xhr;delete this.pendingRequests[ot],lt.abort()}}class nt{constructor(ot){this._source=ot,this._manager=new rt(ot.url,{httpHeaders:ot.httpHeaders,withCredentials:ot.withCredentials}),this._rangeChunkSize=ot.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(ot){const lt=this._rangeRequestReaders.indexOf(ot);lt>=0&&this._rangeRequestReaders.splice(lt,1)}getFullReader(){return(0,$.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new it(this._manager,this._source),this._fullRequestReader}getRangeReader(ot,lt){const ct=new st(this._manager,ot,lt);return ct.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(ct),ct}cancelAllRequests(ot){var lt;(lt=this._fullRequestReader)==null||lt.cancel(ot);for(const ct of this._rangeRequestReaders.slice(0))ct.cancel(ot)}}i.PDFNetworkStream=nt;class it{constructor(ot,lt){this._manager=ot;const ct={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=lt.url,this._fullRequestId=ot.requestFull(ct),this._headersReceivedCapability=new $.PromiseCapability,this._disableRange=lt.disableRange||!1,this._contentLength=lt.length,this._rangeChunkSize=lt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const ot=this._fullRequestId,lt=this._manager.getRequestXhr(ot),ct=ht=>lt.getResponseHeader(ht),{allowRangeRequests:ft,suggestedLength:ut}=(0,j.validateRangeRequestCapabilities)({getResponseHeader:ct,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});ft&&(this._isRangeSupported=!0),this._contentLength=ut||this._contentLength,this._filename=(0,j.extractFilenameFromHeader)(ct),this._isRangeSupported&&this._manager.abortRequest(ot),this._headersReceivedCapability.resolve()}_onDone(ot){if(ot&&(this._requests.length>0?this._requests.shift().resolve({value:ot.chunk,done:!1}):this._cachedChunks.push(ot.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(ot){this._storedError=(0,j.createResponseStatusError)(ot,this._url),this._headersReceivedCapability.reject(this._storedError);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(ot){var lt;(lt=this.onProgress)==null||lt.call(this,{loaded:ot.loaded,total:ot.lengthComputable?ot.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const ot=new $.PromiseCapability;return this._requests.push(ot),ot.promise}cancel(ot){this._done=!0,this._headersReceivedCapability.reject(ot);for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class st{constructor(ot,lt,ct){this._manager=ot;const ft={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=ot.url,this._requestId=ot.requestRange(lt,ct,ft),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var ot;(ot=this.onClosed)==null||ot.call(this,this)}_onDone(ot){const lt=ot.chunk;this._requests.length>0?this._requests.shift().resolve({value:lt,done:!1}):this._queuedChunk=lt,this._done=!0;for(const ct of this._requests)ct.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(ot){this._storedError=(0,j.createResponseStatusError)(ot,this._url);for(const lt of this._requests)lt.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(ot){var lt;this.isStreamingSupported||(lt=this.onProgress)==null||lt.call(this,{loaded:ot.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const lt=this._queuedChunk;return this._queuedChunk=null,{value:lt,done:!1}}if(this._done)return{value:void 0,done:!0};const ot=new $.PromiseCapability;return this._requests.push(ot),ot.promise}cancel(ot){this._done=!0;for(const lt of this._requests)lt.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var $=_(1),j=_(20);const _e=/^file:\/\/\/[a-zA-Z]:\//;function et(ct){const ft=require$$5,ut=ft.parse(ct);return ut.protocol==="file:"||ut.host?ut:/^[a-z]:[/\\]/i.test(ct)?ft.parse(`file:///${ct}`):(ut.host||(ut.protocol="file:"),ut)}class tt{constructor(ft){this.source=ft,this.url=et(ft.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&ft.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var ft;return((ft=this._fullRequestReader)==null?void 0:ft._loaded)??0}getFullReader(){return(0,$.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new ot(this):new st(this),this._fullRequestReader}getRangeReader(ft,ut){if(ut<=this._progressiveDataLength)return null;const ht=this.isFsUrl?new lt(this,ft,ut):new at(this,ft,ut);return this._rangeRequestReaders.push(ht),ht}cancelAllRequests(ft){var ut;(ut=this._fullRequestReader)==null||ut.cancel(ft);for(const ht of this._rangeRequestReaders.slice(0))ht.cancel(ft)}}i.PDFNodeStream=tt;class rt{constructor(ft){this._url=ft.url,this._done=!1,this._storedError=null,this.onProgress=null;const ut=ft.source;this._contentLength=ut.length,this._loaded=0,this._filename=null,this._disableRange=ut.disableRange||!1,this._rangeChunkSize=ut.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ut.disableStream,this._isRangeSupported=!ut.disableRange,this._readableStream=null,this._readCapability=new $.PromiseCapability,this._headersCapability=new $.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ht;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ft=this._readableStream.read();return ft===null?(this._readCapability=new $.PromiseCapability,this.read()):(this._loaded+=ft.length,(ht=this.onProgress)==null||ht.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(ft).buffer,done:!1})}cancel(ft){if(!this._readableStream){this._error(ft);return}this._readableStream.destroy(ft)}_error(ft){this._storedError=ft,this._readCapability.resolve()}_setReadableStream(ft){this._readableStream=ft,ft.on("readable",()=>{this._readCapability.resolve()}),ft.on("end",()=>{ft.destroy(),this._done=!0,this._readCapability.resolve()}),ft.on("error",ut=>{this._error(ut)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new $.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class nt{constructor(ft){this._url=ft.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new $.PromiseCapability;const ut=ft.source;this._isStreamingSupported=!ut.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ht;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const ft=this._readableStream.read();return ft===null?(this._readCapability=new $.PromiseCapability,this.read()):(this._loaded+=ft.length,(ht=this.onProgress)==null||ht.call(this,{loaded:this._loaded}),{value:new Uint8Array(ft).buffer,done:!1})}cancel(ft){if(!this._readableStream){this._error(ft);return}this._readableStream.destroy(ft)}_error(ft){this._storedError=ft,this._readCapability.resolve()}_setReadableStream(ft){this._readableStream=ft,ft.on("readable",()=>{this._readCapability.resolve()}),ft.on("end",()=>{ft.destroy(),this._done=!0,this._readCapability.resolve()}),ft.on("error",ut=>{this._error(ut)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function it(ct,ft){return{protocol:ct.protocol,auth:ct.auth,host:ct.hostname,port:ct.port,path:ct.path,method:"GET",headers:ft}}class st extends rt{constructor(ft){super(ft);const ut=ht=>{if(ht.statusCode===404){const yt=new $.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=yt,this._headersCapability.reject(yt);return}this._headersCapability.resolve(),this._setReadableStream(ht);const dt=yt=>this._readableStream.headers[yt.toLowerCase()],{allowRangeRequests:mt,suggestedLength:pt}=(0,j.validateRangeRequestCapabilities)({getResponseHeader:dt,isHttp:ft.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=mt,this._contentLength=pt||this._contentLength,this._filename=(0,j.extractFilenameFromHeader)(dt)};if(this._request=null,this._url.protocol==="http:"){const ht=require$$5;this._request=ht.request(it(this._url,ft.httpHeaders),ut)}else{const ht=require$$5;this._request=ht.request(it(this._url,ft.httpHeaders),ut)}this._request.on("error",ht=>{this._storedError=ht,this._headersCapability.reject(ht)}),this._request.end()}}class at extends nt{constructor(ft,ut,ht){super(ft),this._httpHeaders={};for(const mt in ft.httpHeaders){const pt=ft.httpHeaders[mt];pt!==void 0&&(this._httpHeaders[mt]=pt)}this._httpHeaders.Range=`bytes=${ut}-${ht-1}`;const dt=mt=>{if(mt.statusCode===404){const pt=new $.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=pt;return}this._setReadableStream(mt)};if(this._request=null,this._url.protocol==="http:"){const mt=require$$5;this._request=mt.request(it(this._url,this._httpHeaders),dt)}else{const mt=require$$5;this._request=mt.request(it(this._url,this._httpHeaders),dt)}this._request.on("error",mt=>{this._storedError=mt}),this._request.end()}}class ot extends rt{constructor(ft){super(ft);let ut=decodeURIComponent(this._url.path);_e.test(this._url.href)&&(ut=ut.replace(/^\//,""));const ht=require$$5;ht.lstat(ut,(dt,mt)=>{if(dt){dt.code==="ENOENT"&&(dt=new $.MissingPDFException(`Missing PDF "${ut}".`)),this._storedError=dt,this._headersCapability.reject(dt);return}this._contentLength=mt.size,this._setReadableStream(ht.createReadStream(ut)),this._headersCapability.resolve()})}}class lt extends nt{constructor(ft,ut,ht){super(ft);let dt=decodeURIComponent(this._url.path);_e.test(this._url.href)&&(dt=dt.replace(/^\//,""));const mt=require$$5;this._setReadableStream(mt.createReadStream(dt,{start:ut,end:ht-1}))}}},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var $=_(6),j=_(1);const _e={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},et="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",rt=["butt","round","square"],nt=["miter","round","bevel"],it=function(mt,pt="",yt=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!yt)return URL.createObjectURL(new Blob([mt],{type:pt}));const gt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let vt=`data:${pt};base64,`;for(let St=0,At=mt.length;St<At;St+=3){const xt=mt[St]&255,wt=mt[St+1]&255,Ot=mt[St+2]&255,Bt=xt>>2,Ft=(xt&3)<<4|wt>>4,Pt=St+1<At?(wt&15)<<2|Ot>>6:64,Rt=St+2<At?Ot&63:64;vt+=gt[Bt]+gt[Ft]+gt[Pt]+gt[Rt]}return vt},st=function(){const mt=new Uint8Array([137,80,78,71,13,10,26,10]),pt=12,yt=new Int32Array(256);for(let Ot=0;Ot<256;Ot++){let Bt=Ot;for(let Ft=0;Ft<8;Ft++)Bt=Bt&1?3988292384^Bt>>1&2147483647:Bt>>1&2147483647;yt[Ot]=Bt}function gt(Ot,Bt,Ft){let Pt=-1;for(let Rt=Bt;Rt<Ft;Rt++){const Et=(Pt^Ot[Rt])&255,_t=yt[Et];Pt=Pt>>>8^_t}return Pt^-1}function vt(Ot,Bt,Ft,Pt){let Rt=Pt;const Et=Bt.length;Ft[Rt]=Et>>24&255,Ft[Rt+1]=Et>>16&255,Ft[Rt+2]=Et>>8&255,Ft[Rt+3]=Et&255,Rt+=4,Ft[Rt]=Ot.charCodeAt(0)&255,Ft[Rt+1]=Ot.charCodeAt(1)&255,Ft[Rt+2]=Ot.charCodeAt(2)&255,Ft[Rt+3]=Ot.charCodeAt(3)&255,Rt+=4,Ft.set(Bt,Rt),Rt+=Bt.length;const _t=gt(Ft,Pt+4,Rt);Ft[Rt]=_t>>24&255,Ft[Rt+1]=_t>>16&255,Ft[Rt+2]=_t>>8&255,Ft[Rt+3]=_t&255}function St(Ot,Bt,Ft){let Pt=1,Rt=0;for(let Et=Bt;Et<Ft;++Et)Pt=(Pt+(Ot[Et]&255))%65521,Rt=(Rt+Pt)%65521;return Rt<<16|Pt}function At(Ot){if(!j.isNodeJS)return xt(Ot);try{const Bt=parseInt(process.versions.node)>=8?Ot:Buffer.from(Ot),Ft=require$$5.deflateSync(Bt,{level:9});return Ft instanceof Uint8Array?Ft:new Uint8Array(Ft)}catch(Bt){(0,j.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Bt)}return xt(Ot)}function xt(Ot){let Bt=Ot.length;const Ft=65535,Pt=Math.ceil(Bt/Ft),Rt=new Uint8Array(2+Bt+Pt*5+4);let Et=0;Rt[Et++]=120,Rt[Et++]=156;let _t=0;for(;Bt>Ft;)Rt[Et++]=0,Rt[Et++]=255,Rt[Et++]=255,Rt[Et++]=0,Rt[Et++]=0,Rt.set(Ot.subarray(_t,_t+Ft),Et),Et+=Ft,_t+=Ft,Bt-=Ft;Rt[Et++]=1,Rt[Et++]=Bt&255,Rt[Et++]=Bt>>8&255,Rt[Et++]=~Bt&65535&255,Rt[Et++]=(~Bt&65535)>>8&255,Rt.set(Ot.subarray(_t),Et),Et+=Ot.length-_t;const Mt=St(Ot,0,Ot.length);return Rt[Et++]=Mt>>24&255,Rt[Et++]=Mt>>16&255,Rt[Et++]=Mt>>8&255,Rt[Et++]=Mt&255,Rt}function wt(Ot,Bt,Ft,Pt){const Rt=Ot.width,Et=Ot.height;let _t,Mt,Dt;const Lt=Ot.data;switch(Bt){case j.ImageKind.GRAYSCALE_1BPP:Mt=0,_t=1,Dt=Rt+7>>3;break;case j.ImageKind.RGB_24BPP:Mt=2,_t=8,Dt=Rt*3;break;case j.ImageKind.RGBA_32BPP:Mt=6,_t=8,Dt=Rt*4;break;default:throw new Error("invalid format")}const Ct=new Uint8Array((1+Dt)*Et);let kt=0,jt=0;for(let or=0;or<Et;++or)Ct[kt++]=0,Ct.set(Lt.subarray(jt,jt+Dt),kt),jt+=Dt,kt+=Dt;if(Bt===j.ImageKind.GRAYSCALE_1BPP&&Pt){kt=0;for(let or=0;or<Et;or++){kt++;for(let Qt=0;Qt<Dt;Qt++)Ct[kt++]^=255}}const Vt=new Uint8Array([Rt>>24&255,Rt>>16&255,Rt>>8&255,Rt&255,Et>>24&255,Et>>16&255,Et>>8&255,Et&255,_t,Mt,0,0,0]),zt=At(Ct),qt=mt.length+pt*3+Vt.length+zt.length,Wt=new Uint8Array(qt);let ir=0;return Wt.set(mt,ir),ir+=mt.length,vt("IHDR",Vt,Wt,ir),ir+=pt+Vt.length,vt("IDATA",zt,Wt,ir),ir+=pt+zt.length,vt("IEND",new Uint8Array(0),Wt,ir),it(Wt,"image/png",Ft)}return function(Bt,Ft,Pt){const Rt=Bt.kind===void 0?j.ImageKind.GRAYSCALE_1BPP:Bt.kind;return wt(Bt,Rt,Ft,Pt)}}();class at{constructor(){this.fontSizeScale=1,this.fontWeight=_e.fontWeight,this.fontSize=0,this.textMatrix=j.IDENTITY_MATRIX,this.fontMatrix=j.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=j.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=_e.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(pt,yt){this.x=pt,this.y=yt}}function ot(mt){let pt=[];const yt=[];for(const gt of mt){if(gt.fn==="save"){pt.push({fnId:92,fn:"group",items:[]}),yt.push(pt),pt=pt.at(-1).items;continue}gt.fn==="restore"?pt=yt.pop():pt.push(gt)}return pt}function lt(mt){if(Number.isInteger(mt))return mt.toString();const pt=mt.toFixed(10);let yt=pt.length-1;if(pt[yt]!=="0")return pt;do yt--;while(pt[yt]==="0");return pt.substring(0,pt[yt]==="."?yt:yt+1)}function ct(mt){if(mt[4]===0&&mt[5]===0){if(mt[1]===0&&mt[2]===0)return mt[0]===1&&mt[3]===1?"":`scale(${lt(mt[0])} ${lt(mt[3])})`;if(mt[0]===mt[3]&&mt[1]===-mt[2]){const pt=Math.acos(mt[0])*180/Math.PI;return`rotate(${lt(pt)})`}}else if(mt[0]===1&&mt[1]===0&&mt[2]===0&&mt[3]===1)return`translate(${lt(mt[4])} ${lt(mt[5])})`;return`matrix(${lt(mt[0])} ${lt(mt[1])} ${lt(mt[2])} ${lt(mt[3])} ${lt(mt[4])} ${lt(mt[5])})`}let ft=0,ut=0,ht=0;class dt{constructor(pt,yt,gt=!1){(0,$.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new $.DOMSVGFactory,this.current=new at,this.transformMatrix=j.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=pt,this.objs=yt,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!gt,this._operatorIdMapping=[];for(const vt in j.OPS)this._operatorIdMapping[j.OPS[vt]]=vt}getObject(pt,yt=null){return typeof pt=="string"?pt.startsWith("g_")?this.commonObjs.get(pt):this.objs.get(pt):yt}save(){this.transformStack.push(this.transformMatrix);const pt=this.current;this.extraStack.push(pt),this.current=pt.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(pt){this.save(),this.executeOpTree(pt),this.restore()}loadDependencies(pt){const yt=pt.fnArray,gt=pt.argsArray;for(let vt=0,St=yt.length;vt<St;vt++)if(yt[vt]===j.OPS.dependency)for(const At of gt[vt]){const xt=At.startsWith("g_")?this.commonObjs:this.objs,wt=new Promise(Ot=>{xt.get(At,Ot)});this.current.dependencies.push(wt)}return Promise.all(this.current.dependencies)}transform(pt,yt,gt,vt,St,At){const xt=[pt,yt,gt,vt,St,At];this.transformMatrix=j.Util.transform(this.transformMatrix,xt),this.tgrp=null}getSVG(pt,yt){this.viewport=yt;const gt=this._initialize(yt);return this.loadDependencies(pt).then(()=>(this.transformMatrix=j.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(pt)),gt))}convertOpList(pt){const yt=this._operatorIdMapping,gt=pt.argsArray,vt=pt.fnArray,St=[];for(let At=0,xt=vt.length;At<xt;At++){const wt=vt[At];St.push({fnId:wt,fn:yt[wt],args:gt[At]})}return ot(St)}executeOpTree(pt){for(const yt of pt){const gt=yt.fn,vt=yt.fnId,St=yt.args;switch(vt|0){case j.OPS.beginText:this.beginText();break;case j.OPS.dependency:break;case j.OPS.setLeading:this.setLeading(St);break;case j.OPS.setLeadingMoveText:this.setLeadingMoveText(St[0],St[1]);break;case j.OPS.setFont:this.setFont(St);break;case j.OPS.showText:this.showText(St[0]);break;case j.OPS.showSpacedText:this.showText(St[0]);break;case j.OPS.endText:this.endText();break;case j.OPS.moveText:this.moveText(St[0],St[1]);break;case j.OPS.setCharSpacing:this.setCharSpacing(St[0]);break;case j.OPS.setWordSpacing:this.setWordSpacing(St[0]);break;case j.OPS.setHScale:this.setHScale(St[0]);break;case j.OPS.setTextMatrix:this.setTextMatrix(St[0],St[1],St[2],St[3],St[4],St[5]);break;case j.OPS.setTextRise:this.setTextRise(St[0]);break;case j.OPS.setTextRenderingMode:this.setTextRenderingMode(St[0]);break;case j.OPS.setLineWidth:this.setLineWidth(St[0]);break;case j.OPS.setLineJoin:this.setLineJoin(St[0]);break;case j.OPS.setLineCap:this.setLineCap(St[0]);break;case j.OPS.setMiterLimit:this.setMiterLimit(St[0]);break;case j.OPS.setFillRGBColor:this.setFillRGBColor(St[0],St[1],St[2]);break;case j.OPS.setStrokeRGBColor:this.setStrokeRGBColor(St[0],St[1],St[2]);break;case j.OPS.setStrokeColorN:this.setStrokeColorN(St);break;case j.OPS.setFillColorN:this.setFillColorN(St);break;case j.OPS.shadingFill:this.shadingFill(St[0]);break;case j.OPS.setDash:this.setDash(St[0],St[1]);break;case j.OPS.setRenderingIntent:this.setRenderingIntent(St[0]);break;case j.OPS.setFlatness:this.setFlatness(St[0]);break;case j.OPS.setGState:this.setGState(St[0]);break;case j.OPS.fill:this.fill();break;case j.OPS.eoFill:this.eoFill();break;case j.OPS.stroke:this.stroke();break;case j.OPS.fillStroke:this.fillStroke();break;case j.OPS.eoFillStroke:this.eoFillStroke();break;case j.OPS.clip:this.clip("nonzero");break;case j.OPS.eoClip:this.clip("evenodd");break;case j.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case j.OPS.paintImageXObject:this.paintImageXObject(St[0]);break;case j.OPS.paintInlineImageXObject:this.paintInlineImageXObject(St[0]);break;case j.OPS.paintImageMaskXObject:this.paintImageMaskXObject(St[0]);break;case j.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(St[0],St[1]);break;case j.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case j.OPS.closePath:this.closePath();break;case j.OPS.closeStroke:this.closeStroke();break;case j.OPS.closeFillStroke:this.closeFillStroke();break;case j.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case j.OPS.nextLine:this.nextLine();break;case j.OPS.transform:this.transform(St[0],St[1],St[2],St[3],St[4],St[5]);break;case j.OPS.constructPath:this.constructPath(St[0],St[1]);break;case j.OPS.endPath:this.endPath();break;case 92:this.group(yt.items);break;default:(0,j.warn)(`Unimplemented operator ${gt}`);break}}}setWordSpacing(pt){this.current.wordSpacing=pt}setCharSpacing(pt){this.current.charSpacing=pt}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(pt,yt,gt,vt,St,At){const xt=this.current;xt.textMatrix=xt.lineMatrix=[pt,yt,gt,vt,St,At],xt.textMatrixScale=Math.hypot(pt,yt),xt.x=xt.lineX=0,xt.y=xt.lineY=0,xt.xcoords=[],xt.ycoords=[],xt.tspan=this.svgFactory.createElement("svg:tspan"),xt.tspan.setAttributeNS(null,"font-family",xt.fontFamily),xt.tspan.setAttributeNS(null,"font-size",`${lt(xt.fontSize)}px`),xt.tspan.setAttributeNS(null,"y",lt(-xt.y)),xt.txtElement=this.svgFactory.createElement("svg:text"),xt.txtElement.append(xt.tspan)}beginText(){const pt=this.current;pt.x=pt.lineX=0,pt.y=pt.lineY=0,pt.textMatrix=j.IDENTITY_MATRIX,pt.lineMatrix=j.IDENTITY_MATRIX,pt.textMatrixScale=1,pt.tspan=this.svgFactory.createElement("svg:tspan"),pt.txtElement=this.svgFactory.createElement("svg:text"),pt.txtgrp=this.svgFactory.createElement("svg:g"),pt.xcoords=[],pt.ycoords=[]}moveText(pt,yt){const gt=this.current;gt.x=gt.lineX+=pt,gt.y=gt.lineY+=yt,gt.xcoords=[],gt.ycoords=[],gt.tspan=this.svgFactory.createElement("svg:tspan"),gt.tspan.setAttributeNS(null,"font-family",gt.fontFamily),gt.tspan.setAttributeNS(null,"font-size",`${lt(gt.fontSize)}px`),gt.tspan.setAttributeNS(null,"y",lt(-gt.y))}showText(pt){const yt=this.current,gt=yt.font,vt=yt.fontSize;if(vt===0)return;const St=yt.fontSizeScale,At=yt.charSpacing,xt=yt.wordSpacing,wt=yt.fontDirection,Ot=yt.textHScale*wt,Bt=gt.vertical,Ft=Bt?1:-1,Pt=gt.defaultVMetrics,Rt=vt*yt.fontMatrix[0];let Et=0;for(const Dt of pt){if(Dt===null){Et+=wt*xt;continue}else if(typeof Dt=="number"){Et+=Ft*Dt*vt/1e3;continue}const Lt=(Dt.isSpace?xt:0)+At,Ct=Dt.fontChar;let kt,jt,Vt=Dt.width;if(Bt){let qt;const Wt=Dt.vmetric||Pt;qt=Dt.vmetric?Wt[1]:Vt*.5,qt=-qt*Rt;const ir=Wt[2]*Rt;Vt=Wt?-Wt[0]:Vt,kt=qt/St,jt=(Et+ir)/St}else kt=Et/St,jt=0;(Dt.isInFont||gt.missingFile)&&(yt.xcoords.push(yt.x+kt),Bt&&yt.ycoords.push(-yt.y+jt),yt.tspan.textContent+=Ct);const zt=Bt?Vt*Rt-Lt*wt:Vt*Rt+Lt*wt;Et+=zt}yt.tspan.setAttributeNS(null,"x",yt.xcoords.map(lt).join(" ")),Bt?yt.tspan.setAttributeNS(null,"y",yt.ycoords.map(lt).join(" ")):yt.tspan.setAttributeNS(null,"y",lt(-yt.y)),Bt?yt.y-=Et:yt.x+=Et*Ot,yt.tspan.setAttributeNS(null,"font-family",yt.fontFamily),yt.tspan.setAttributeNS(null,"font-size",`${lt(yt.fontSize)}px`),yt.fontStyle!==_e.fontStyle&&yt.tspan.setAttributeNS(null,"font-style",yt.fontStyle),yt.fontWeight!==_e.fontWeight&&yt.tspan.setAttributeNS(null,"font-weight",yt.fontWeight);const _t=yt.textRenderingMode&j.TextRenderingMode.FILL_STROKE_MASK;if(_t===j.TextRenderingMode.FILL||_t===j.TextRenderingMode.FILL_STROKE?(yt.fillColor!==_e.fillColor&&yt.tspan.setAttributeNS(null,"fill",yt.fillColor),yt.fillAlpha<1&&yt.tspan.setAttributeNS(null,"fill-opacity",yt.fillAlpha)):yt.textRenderingMode===j.TextRenderingMode.ADD_TO_PATH?yt.tspan.setAttributeNS(null,"fill","transparent"):yt.tspan.setAttributeNS(null,"fill","none"),_t===j.TextRenderingMode.STROKE||_t===j.TextRenderingMode.FILL_STROKE){const Dt=1/(yt.textMatrixScale||1);this._setStrokeAttributes(yt.tspan,Dt)}let Mt=yt.textMatrix;yt.textRise!==0&&(Mt=Mt.slice(),Mt[5]+=yt.textRise),yt.txtElement.setAttributeNS(null,"transform",`${ct(Mt)} scale(${lt(Ot)}, -1)`),yt.txtElement.setAttributeNS(et,"xml:space","preserve"),yt.txtElement.append(yt.tspan),yt.txtgrp.append(yt.txtElement),this._ensureTransformGroup().append(yt.txtElement)}setLeadingMoveText(pt,yt){this.setLeading(-yt),this.moveText(pt,yt)}addFontStyle(pt){if(!pt.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const yt=it(pt.data,pt.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${pt.loadedName}"; src: url(${yt}); }
`}setFont(pt){const yt=this.current,gt=this.commonObjs.get(pt[0]);let vt=pt[1];yt.font=gt,this.embedFonts&&!gt.missingFile&&!this.embeddedFonts[gt.loadedName]&&(this.addFontStyle(gt),this.embeddedFonts[gt.loadedName]=gt),yt.fontMatrix=gt.fontMatrix||j.FONT_IDENTITY_MATRIX;let St="normal";gt.black?St="900":gt.bold&&(St="bold");const At=gt.italic?"italic":"normal";vt<0?(vt=-vt,yt.fontDirection=-1):yt.fontDirection=1,yt.fontSize=vt,yt.fontFamily=gt.loadedName,yt.fontWeight=St,yt.fontStyle=At,yt.tspan=this.svgFactory.createElement("svg:tspan"),yt.tspan.setAttributeNS(null,"y",lt(-yt.y)),yt.xcoords=[],yt.ycoords=[]}endText(){var yt;const pt=this.current;pt.textRenderingMode&j.TextRenderingMode.ADD_TO_PATH_FLAG&&((yt=pt.txtElement)!=null&&yt.hasChildNodes())&&(pt.element=pt.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(pt){pt>0&&(this.current.lineWidth=pt)}setLineCap(pt){this.current.lineCap=rt[pt]}setLineJoin(pt){this.current.lineJoin=nt[pt]}setMiterLimit(pt){this.current.miterLimit=pt}setStrokeAlpha(pt){this.current.strokeAlpha=pt}setStrokeRGBColor(pt,yt,gt){this.current.strokeColor=j.Util.makeHexColor(pt,yt,gt)}setFillAlpha(pt){this.current.fillAlpha=pt}setFillRGBColor(pt,yt,gt){this.current.fillColor=j.Util.makeHexColor(pt,yt,gt),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(pt){this.current.strokeColor=this._makeColorN_Pattern(pt)}setFillColorN(pt){this.current.fillColor=this._makeColorN_Pattern(pt)}shadingFill(pt){const{width:yt,height:gt}=this.viewport,vt=j.Util.inverseTransform(this.transformMatrix),[St,At,xt,wt]=j.Util.getAxialAlignedBoundingBox([0,0,yt,gt],vt),Ot=this.svgFactory.createElement("svg:rect");Ot.setAttributeNS(null,"x",St),Ot.setAttributeNS(null,"y",At),Ot.setAttributeNS(null,"width",xt-St),Ot.setAttributeNS(null,"height",wt-At),Ot.setAttributeNS(null,"fill",this._makeShadingPattern(pt)),this.current.fillAlpha<1&&Ot.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Ot)}_makeColorN_Pattern(pt){return pt[0]==="TilingPattern"?this._makeTilingPattern(pt):this._makeShadingPattern(pt)}_makeTilingPattern(pt){const yt=pt[1],gt=pt[2],vt=pt[3]||j.IDENTITY_MATRIX,[St,At,xt,wt]=pt[4],Ot=pt[5],Bt=pt[6],Ft=pt[7],Pt=`shading${ht++}`,[Rt,Et,_t,Mt]=j.Util.normalizeRect([...j.Util.applyTransform([St,At],vt),...j.Util.applyTransform([xt,wt],vt)]),[Dt,Lt]=j.Util.singularValueDecompose2dScale(vt),Ct=Ot*Dt,kt=Bt*Lt,jt=this.svgFactory.createElement("svg:pattern");jt.setAttributeNS(null,"id",Pt),jt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),jt.setAttributeNS(null,"width",Ct),jt.setAttributeNS(null,"height",kt),jt.setAttributeNS(null,"x",`${Rt}`),jt.setAttributeNS(null,"y",`${Et}`);const Vt=this.svg,zt=this.transformMatrix,qt=this.current.fillColor,Wt=this.current.strokeColor,ir=this.svgFactory.create(_t-Rt,Mt-Et);if(this.svg=ir,this.transformMatrix=vt,Ft===2){const or=j.Util.makeHexColor(...yt);this.current.fillColor=or,this.current.strokeColor=or}return this.executeOpTree(this.convertOpList(gt)),this.svg=Vt,this.transformMatrix=zt,this.current.fillColor=qt,this.current.strokeColor=Wt,jt.append(ir.childNodes[0]),this.defs.append(jt),`url(#${Pt})`}_makeShadingPattern(pt){switch(typeof pt=="string"&&(pt=this.objs.get(pt)),pt[0]){case"RadialAxial":const yt=`shading${ht++}`,gt=pt[3];let vt;switch(pt[1]){case"axial":const St=pt[4],At=pt[5];vt=this.svgFactory.createElement("svg:linearGradient"),vt.setAttributeNS(null,"id",yt),vt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),vt.setAttributeNS(null,"x1",St[0]),vt.setAttributeNS(null,"y1",St[1]),vt.setAttributeNS(null,"x2",At[0]),vt.setAttributeNS(null,"y2",At[1]);break;case"radial":const xt=pt[4],wt=pt[5],Ot=pt[6],Bt=pt[7];vt=this.svgFactory.createElement("svg:radialGradient"),vt.setAttributeNS(null,"id",yt),vt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),vt.setAttributeNS(null,"cx",wt[0]),vt.setAttributeNS(null,"cy",wt[1]),vt.setAttributeNS(null,"r",Bt),vt.setAttributeNS(null,"fx",xt[0]),vt.setAttributeNS(null,"fy",xt[1]),vt.setAttributeNS(null,"fr",Ot);break;default:throw new Error(`Unknown RadialAxial type: ${pt[1]}`)}for(const St of gt){const At=this.svgFactory.createElement("svg:stop");At.setAttributeNS(null,"offset",St[0]),At.setAttributeNS(null,"stop-color",St[1]),vt.append(At)}return this.defs.append(vt),`url(#${yt})`;case"Mesh":return(0,j.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${pt[0]}`)}}setDash(pt,yt){this.current.dashArray=pt,this.current.dashPhase=yt}constructPath(pt,yt){const gt=this.current;let vt=gt.x,St=gt.y,At=[],xt=0;for(const wt of pt)switch(wt|0){case j.OPS.rectangle:vt=yt[xt++],St=yt[xt++];const Ot=yt[xt++],Bt=yt[xt++],Ft=vt+Ot,Pt=St+Bt;At.push("M",lt(vt),lt(St),"L",lt(Ft),lt(St),"L",lt(Ft),lt(Pt),"L",lt(vt),lt(Pt),"Z");break;case j.OPS.moveTo:vt=yt[xt++],St=yt[xt++],At.push("M",lt(vt),lt(St));break;case j.OPS.lineTo:vt=yt[xt++],St=yt[xt++],At.push("L",lt(vt),lt(St));break;case j.OPS.curveTo:vt=yt[xt+4],St=yt[xt+5],At.push("C",lt(yt[xt]),lt(yt[xt+1]),lt(yt[xt+2]),lt(yt[xt+3]),lt(vt),lt(St)),xt+=6;break;case j.OPS.curveTo2:At.push("C",lt(vt),lt(St),lt(yt[xt]),lt(yt[xt+1]),lt(yt[xt+2]),lt(yt[xt+3])),vt=yt[xt+2],St=yt[xt+3],xt+=4;break;case j.OPS.curveTo3:vt=yt[xt+2],St=yt[xt+3],At.push("C",lt(yt[xt]),lt(yt[xt+1]),lt(vt),lt(St),lt(vt),lt(St)),xt+=4;break;case j.OPS.closePath:At.push("Z");break}At=At.join(" "),gt.path&&pt.length>0&&pt[0]!==j.OPS.rectangle&&pt[0]!==j.OPS.moveTo?At=gt.path.getAttributeNS(null,"d")+At:(gt.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(gt.path)),gt.path.setAttributeNS(null,"d",At),gt.path.setAttributeNS(null,"fill","none"),gt.element=gt.path,gt.setCurrentPoint(vt,St)}endPath(){const pt=this.current;if(pt.path=null,!this.pendingClip)return;if(!pt.element){this.pendingClip=null;return}const yt=`clippath${ft++}`,gt=this.svgFactory.createElement("svg:clipPath");gt.setAttributeNS(null,"id",yt),gt.setAttributeNS(null,"transform",ct(this.transformMatrix));const vt=pt.element.cloneNode(!0);if(this.pendingClip==="evenodd"?vt.setAttributeNS(null,"clip-rule","evenodd"):vt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,gt.append(vt),this.defs.append(gt),pt.activeClipUrl){pt.clipGroup=null;for(const St of this.extraStack)St.clipGroup=null;gt.setAttributeNS(null,"clip-path",pt.activeClipUrl)}pt.activeClipUrl=`url(#${yt})`,this.tgrp=null}clip(pt){this.pendingClip=pt}closePath(){const pt=this.current;if(pt.path){const yt=`${pt.path.getAttributeNS(null,"d")}Z`;pt.path.setAttributeNS(null,"d",yt)}}setLeading(pt){this.current.leading=-pt}setTextRise(pt){this.current.textRise=pt}setTextRenderingMode(pt){this.current.textRenderingMode=pt}setHScale(pt){this.current.textHScale=pt/100}setRenderingIntent(pt){}setFlatness(pt){}setGState(pt){for(const[yt,gt]of pt)switch(yt){case"LW":this.setLineWidth(gt);break;case"LC":this.setLineCap(gt);break;case"LJ":this.setLineJoin(gt);break;case"ML":this.setMiterLimit(gt);break;case"D":this.setDash(gt[0],gt[1]);break;case"RI":this.setRenderingIntent(gt);break;case"FL":this.setFlatness(gt);break;case"Font":this.setFont(gt);break;case"CA":this.setStrokeAlpha(gt);break;case"ca":this.setFillAlpha(gt);break;default:(0,j.warn)(`Unimplemented graphic state operator ${yt}`);break}}fill(){const pt=this.current;pt.element&&(pt.element.setAttributeNS(null,"fill",pt.fillColor),pt.element.setAttributeNS(null,"fill-opacity",pt.fillAlpha),this.endPath())}stroke(){const pt=this.current;pt.element&&(this._setStrokeAttributes(pt.element),pt.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(pt,yt=1){const gt=this.current;let vt=gt.dashArray;yt!==1&&vt.length>0&&(vt=vt.map(function(St){return yt*St})),pt.setAttributeNS(null,"stroke",gt.strokeColor),pt.setAttributeNS(null,"stroke-opacity",gt.strokeAlpha),pt.setAttributeNS(null,"stroke-miterlimit",lt(gt.miterLimit)),pt.setAttributeNS(null,"stroke-linecap",gt.lineCap),pt.setAttributeNS(null,"stroke-linejoin",gt.lineJoin),pt.setAttributeNS(null,"stroke-width",lt(yt*gt.lineWidth)+"px"),pt.setAttributeNS(null,"stroke-dasharray",vt.map(lt).join(" ")),pt.setAttributeNS(null,"stroke-dashoffset",lt(yt*gt.dashPhase)+"px")}eoFill(){var pt;(pt=this.current.element)==null||pt.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var pt;(pt=this.current.element)==null||pt.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const pt=this.svgFactory.createElement("svg:rect");pt.setAttributeNS(null,"x","0"),pt.setAttributeNS(null,"y","0"),pt.setAttributeNS(null,"width","1px"),pt.setAttributeNS(null,"height","1px"),pt.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(pt)}paintImageXObject(pt){const yt=this.getObject(pt);if(!yt){(0,j.warn)(`Dependent image with object ID ${pt} is not ready yet`);return}this.paintInlineImageXObject(yt)}paintInlineImageXObject(pt,yt){const gt=pt.width,vt=pt.height,St=st(pt,this.forceDataSchema,!!yt),At=this.svgFactory.createElement("svg:rect");At.setAttributeNS(null,"x","0"),At.setAttributeNS(null,"y","0"),At.setAttributeNS(null,"width",lt(gt)),At.setAttributeNS(null,"height",lt(vt)),this.current.element=At,this.clip("nonzero");const xt=this.svgFactory.createElement("svg:image");xt.setAttributeNS(tt,"xlink:href",St),xt.setAttributeNS(null,"x","0"),xt.setAttributeNS(null,"y",lt(-vt)),xt.setAttributeNS(null,"width",lt(gt)+"px"),xt.setAttributeNS(null,"height",lt(vt)+"px"),xt.setAttributeNS(null,"transform",`scale(${lt(1/gt)} ${lt(-1/vt)})`),yt?yt.append(xt):this._ensureTransformGroup().append(xt)}paintImageMaskXObject(pt){const yt=this.getObject(pt.data,pt);if(yt.bitmap){(0,j.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const gt=this.current,vt=yt.width,St=yt.height,At=gt.fillColor;gt.maskId=`mask${ut++}`;const xt=this.svgFactory.createElement("svg:mask");xt.setAttributeNS(null,"id",gt.maskId);const wt=this.svgFactory.createElement("svg:rect");wt.setAttributeNS(null,"x","0"),wt.setAttributeNS(null,"y","0"),wt.setAttributeNS(null,"width",lt(vt)),wt.setAttributeNS(null,"height",lt(St)),wt.setAttributeNS(null,"fill",At),wt.setAttributeNS(null,"mask",`url(#${gt.maskId})`),this.defs.append(xt),this._ensureTransformGroup().append(wt),this.paintInlineImageXObject(yt,xt)}paintFormXObjectBegin(pt,yt){if(Array.isArray(pt)&&pt.length===6&&this.transform(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]),yt){const gt=yt[2]-yt[0],vt=yt[3]-yt[1],St=this.svgFactory.createElement("svg:rect");St.setAttributeNS(null,"x",yt[0]),St.setAttributeNS(null,"y",yt[1]),St.setAttributeNS(null,"width",lt(gt)),St.setAttributeNS(null,"height",lt(vt)),this.current.element=St,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(pt){const yt=this.svgFactory.create(pt.width,pt.height),gt=this.svgFactory.createElement("svg:defs");yt.append(gt),this.defs=gt;const vt=this.svgFactory.createElement("svg:g");return vt.setAttributeNS(null,"transform",ct(pt.transform)),yt.append(vt),this.svg=vt,yt}_ensureClipGroup(){if(!this.current.clipGroup){const pt=this.svgFactory.createElement("svg:g");pt.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(pt),this.current.clipGroup=pt}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",ct(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}i.SVGGraphics=dt},(o,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class _{static textContent(j){const _e=[],et={items:_e,styles:Object.create(null)};function tt(rt){var st;if(!rt)return;let nt=null;const it=rt.name;if(it==="#text")nt=rt.value;else if(_.shouldBuildText(it))(st=rt==null?void 0:rt.attributes)!=null&&st.textContent?nt=rt.attributes.textContent:rt.value&&(nt=rt.value);else return;if(nt!==null&&_e.push({str:nt}),!!rt.children)for(const at of rt.children)tt(at)}return tt(j),et}static shouldBuildText(j){return!(j==="textarea"||j==="input"||j==="option"||j==="select")}}i.XfaText=_},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=ct,i.updateTextLayer=ft;var $=_(1),j=_(6);const _e=1e5,et=30,tt=.8,rt=new Map;function nt(ut,ht){let dt;if(ht&&$.FeatureTest.isOffscreenCanvasSupported)dt=new OffscreenCanvas(ut,ut).getContext("2d",{alpha:!1});else{const mt=document.createElement("canvas");mt.width=mt.height=ut,dt=mt.getContext("2d",{alpha:!1})}return dt}function it(ut,ht){const dt=rt.get(ut);if(dt)return dt;const mt=nt(et,ht);mt.font=`${et}px ${ut}`;const pt=mt.measureText("");let yt=pt.fontBoundingBoxAscent,gt=Math.abs(pt.fontBoundingBoxDescent);if(yt){const St=yt/(yt+gt);return rt.set(ut,St),mt.canvas.width=mt.canvas.height=0,St}mt.strokeStyle="red",mt.clearRect(0,0,et,et),mt.strokeText("g",0,0);let vt=mt.getImageData(0,0,et,et).data;gt=0;for(let St=vt.length-1-3;St>=0;St-=4)if(vt[St]>0){gt=Math.ceil(St/4/et);break}mt.clearRect(0,0,et,et),mt.strokeText("A",0,et),vt=mt.getImageData(0,0,et,et).data,yt=0;for(let St=0,At=vt.length;St<At;St+=4)if(vt[St]>0){yt=et-Math.floor(St/4/et);break}if(mt.canvas.width=mt.canvas.height=0,yt){const St=yt/(yt+gt);return rt.set(ut,St),St}return rt.set(ut,tt),tt}function st(ut,ht,dt){const mt=document.createElement("span"),pt={angle:0,canvasWidth:0,hasText:ht.str!=="",hasEOL:ht.hasEOL,fontSize:0};ut._textDivs.push(mt);const yt=$.Util.transform(ut._transform,ht.transform);let gt=Math.atan2(yt[1],yt[0]);const vt=dt[ht.fontName];vt.vertical&&(gt+=Math.PI/2);const St=Math.hypot(yt[2],yt[3]),At=St*it(vt.fontFamily,ut._isOffscreenCanvasSupported);let xt,wt;gt===0?(xt=yt[4],wt=yt[5]-At):(xt=yt[4]+At*Math.sin(gt),wt=yt[5]-At*Math.cos(gt));const Ot="calc(var(--scale-factor)*",Bt=mt.style;ut._container===ut._rootContainer?(Bt.left=`${(100*xt/ut._pageWidth).toFixed(2)}%`,Bt.top=`${(100*wt/ut._pageHeight).toFixed(2)}%`):(Bt.left=`${Ot}${xt.toFixed(2)}px)`,Bt.top=`${Ot}${wt.toFixed(2)}px)`),Bt.fontSize=`${Ot}${St.toFixed(2)}px)`,Bt.fontFamily=vt.fontFamily,pt.fontSize=St,mt.setAttribute("role","presentation"),mt.textContent=ht.str,mt.dir=ht.dir,ut._fontInspectorEnabled&&(mt.dataset.fontName=ht.fontName),gt!==0&&(pt.angle=gt*(180/Math.PI));let Ft=!1;if(ht.str.length>1)Ft=!0;else if(ht.str!==" "&&ht.transform[0]!==ht.transform[3]){const Pt=Math.abs(ht.transform[0]),Rt=Math.abs(ht.transform[3]);Pt!==Rt&&Math.max(Pt,Rt)/Math.min(Pt,Rt)>1.5&&(Ft=!0)}Ft&&(pt.canvasWidth=vt.vertical?ht.height:ht.width),ut._textDivProperties.set(mt,pt),ut._isReadableStream&&ut._layoutText(mt)}function at(ut){const{div:ht,scale:dt,properties:mt,ctx:pt,prevFontSize:yt,prevFontFamily:gt}=ut,{style:vt}=ht;let St="";if(mt.canvasWidth!==0&&mt.hasText){const{fontFamily:At}=vt,{canvasWidth:xt,fontSize:wt}=mt;(yt!==wt||gt!==At)&&(pt.font=`${wt*dt}px ${At}`,ut.prevFontSize=wt,ut.prevFontFamily=At);const{width:Ot}=pt.measureText(ht.textContent);Ot>0&&(St=`scaleX(${xt*dt/Ot})`)}mt.angle!==0&&(St=`rotate(${mt.angle}deg) ${St}`),St.length>0&&(vt.transform=St)}function ot(ut){if(ut._canceled)return;const ht=ut._textDivs,dt=ut._capability;if(ht.length>_e){dt.resolve();return}if(!ut._isReadableStream)for(const pt of ht)ut._layoutText(pt);dt.resolve()}class lt{constructor({textContentSource:ht,container:dt,viewport:mt,textDivs:pt,textDivProperties:yt,textContentItemsStr:gt,isOffscreenCanvasSupported:vt}){var Ot;this._textContentSource=ht,this._isReadableStream=ht instanceof ReadableStream,this._container=this._rootContainer=dt,this._textDivs=pt||[],this._textContentItemsStr=gt||[],this._isOffscreenCanvasSupported=vt,this._fontInspectorEnabled=!!((Ot=globalThis.FontInspector)!=null&&Ot.enabled),this._reader=null,this._textDivProperties=yt||new WeakMap,this._canceled=!1,this._capability=new $.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:mt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:nt(0,vt)};const{pageWidth:St,pageHeight:At,pageX:xt,pageY:wt}=mt.rawDims;this._transform=[1,0,0,-1,-xt,wt+At],this._pageWidth=St,this._pageHeight=At,(0,j.setLayerDimensions)(dt,mt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new $.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new $.AbortException("TextLayer task cancelled."))}_processItems(ht,dt){for(const mt of ht){if(mt.str===void 0){if(mt.type==="beginMarkedContentProps"||mt.type==="beginMarkedContent"){const pt=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),mt.id!==null&&this._container.setAttribute("id",`${mt.id}`),pt.append(this._container)}else mt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(mt.str),st(this,mt,dt)}}_layoutText(ht){const dt=this._layoutTextParams.properties=this._textDivProperties.get(ht);if(this._layoutTextParams.div=ht,at(this._layoutTextParams),dt.hasText&&this._container.append(ht),dt.hasEOL){const mt=document.createElement("br");mt.setAttribute("role","presentation"),this._container.append(mt)}}_render(){const ht=new $.PromiseCapability;let dt=Object.create(null);if(this._isReadableStream){const mt=()=>{this._reader.read().then(({value:pt,done:yt})=>{if(yt){ht.resolve();return}Object.assign(dt,pt.styles),this._processItems(pt.items,dt),mt()},ht.reject)};this._reader=this._textContentSource.getReader(),mt()}else if(this._textContentSource){const{items:mt,styles:pt}=this._textContentSource;this._processItems(mt,pt),ht.resolve()}else throw new Error('No "textContentSource" parameter specified.');ht.promise.then(()=>{dt=null,ot(this)},this._capability.reject)}}i.TextLayerRenderTask=lt;function ct(ut){!ut.textContentSource&&(ut.textContent||ut.textContentStream)&&((0,j.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),ut.textContentSource=ut.textContent||ut.textContentStream);const{container:ht,viewport:dt}=ut,mt=getComputedStyle(ht),pt=mt.getPropertyValue("visibility"),yt=parseFloat(mt.getPropertyValue("--scale-factor"));pt==="visible"&&(!yt||Math.abs(yt-dt.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const gt=new lt(ut);return gt._render(),gt}function ft({container:ut,viewport:ht,textDivs:dt,textDivProperties:mt,isOffscreenCanvasSupported:pt,mustRotate:yt=!0,mustRescale:gt=!0}){if(yt&&(0,j.setLayerDimensions)(ut,{rotation:ht.rotation}),gt){const vt=nt(0,pt),At={prevFontSize:null,prevFontFamily:null,div:null,scale:ht.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:vt};for(const xt of dt)At.properties=mt.get(xt),At.div=xt,at(At)}}},(o,i,_)=>{var it,st,at,ot,lt,ct,ft,ut,ht,dt,mt,yl,no,Sl,El;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var $=_(1),j=_(4),_e=_(28),et=_(33),tt=_(6),rt=_(34);const St=class St{constructor({uiManager:xt,pageIndex:wt,div:Ot,accessibilityManager:Bt,annotationLayer:Ft,viewport:Pt,l10n:Rt}){Er(this,mt);Er(this,it);Er(this,st,!1);Er(this,at,null);Er(this,ot,this.pointerup.bind(this));Er(this,lt,this.pointerdown.bind(this));Er(this,ct,new Map);Er(this,ft,!1);Er(this,ut,!1);Er(this,ht,!1);Er(this,dt);const Et=[_e.FreeTextEditor,et.InkEditor,rt.StampEditor];if(!St._initialized){St._initialized=!0;for(const _t of Et)_t.initialize(Rt)}xt.registerEditorTypes(Et),Tr(this,dt,xt),this.pageIndex=wt,this.div=Ot,Tr(this,it,Bt),Tr(this,at,Ft),this.viewport=Pt,$t(this,dt).addLayer(this)}get isEmpty(){return $t(this,ct).size===0}updateToolbar(xt){$t(this,dt).updateToolbar(xt)}updateMode(xt=$t(this,dt).getMode()){mr(this,mt,El).call(this),xt===$.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),xt!==$.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",xt===$.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",xt===$.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",xt===$.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(xt){if(!xt&&$t(this,dt).getMode()!==$.AnnotationEditorType.INK)return;if(!xt){for(const Ot of $t(this,ct).values())if(Ot.isEmpty()){Ot.setInBackground();return}}mr(this,mt,no).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(xt){$t(this,dt).setEditingState(xt)}addCommands(xt){$t(this,dt).addCommands(xt)}enable(){this.div.style.pointerEvents="auto";const xt=new Set;for(const Ot of $t(this,ct).values())Ot.enableEditing(),Ot.annotationElementId&&xt.add(Ot.annotationElementId);if(!$t(this,at))return;const wt=$t(this,at).getEditableAnnotations();for(const Ot of wt){if(Ot.hide(),$t(this,dt).isDeletedAnnotationElement(Ot.data.id)||xt.has(Ot.data.id))continue;const Bt=this.deserialize(Ot);Bt&&(this.addOrRebuild(Bt),Bt.enableEditing())}}disable(){var wt;Tr(this,ht,!0),this.div.style.pointerEvents="none";const xt=new Set;for(const Ot of $t(this,ct).values()){if(Ot.disableEditing(),!Ot.annotationElementId||Ot.serialize()!==null){xt.add(Ot.annotationElementId);continue}(wt=this.getEditableAnnotation(Ot.annotationElementId))==null||wt.show(),Ot.remove()}if($t(this,at)){const Ot=$t(this,at).getEditableAnnotations();for(const Bt of Ot){const{id:Ft}=Bt.data;xt.has(Ft)||$t(this,dt).isDeletedAnnotationElement(Ft)||Bt.show()}}mr(this,mt,El).call(this),this.isEmpty&&(this.div.hidden=!0),Tr(this,ht,!1)}getEditableAnnotation(xt){var wt;return((wt=$t(this,at))==null?void 0:wt.getEditableAnnotation(xt))||null}setActiveEditor(xt){$t(this,dt).getActive()!==xt&&$t(this,dt).setActiveEditor(xt)}enableClick(){this.div.addEventListener("pointerdown",$t(this,lt)),this.div.addEventListener("pointerup",$t(this,ot))}disableClick(){this.div.removeEventListener("pointerdown",$t(this,lt)),this.div.removeEventListener("pointerup",$t(this,ot))}attach(xt){$t(this,ct).set(xt.id,xt);const{annotationElementId:wt}=xt;wt&&$t(this,dt).isDeletedAnnotationElement(wt)&&$t(this,dt).removeDeletedAnnotationElement(xt)}detach(xt){var wt;$t(this,ct).delete(xt.id),(wt=$t(this,it))==null||wt.removePointerInTextLayer(xt.contentDiv),!$t(this,ht)&&xt.annotationElementId&&$t(this,dt).addDeletedAnnotationElement(xt)}remove(xt){this.detach(xt),$t(this,dt).removeEditor(xt),xt.div.contains(document.activeElement)&&setTimeout(()=>{$t(this,dt).focusMainContainer()},0),xt.div.remove(),xt.isAttachedToDOM=!1,$t(this,ut)||this.addInkEditorIfNeeded(!1)}changeParent(xt){var wt;xt.parent!==this&&(xt.annotationElementId&&($t(this,dt).addDeletedAnnotationElement(xt.annotationElementId),j.AnnotationEditor.deleteAnnotationElement(xt),xt.annotationElementId=null),this.attach(xt),(wt=xt.parent)==null||wt.detach(xt),xt.setParent(this),xt.div&&xt.isAttachedToDOM&&(xt.div.remove(),this.div.append(xt.div)))}add(xt){if(this.changeParent(xt),$t(this,dt).addEditor(xt),this.attach(xt),!xt.isAttachedToDOM){const wt=xt.render();this.div.append(wt),xt.isAttachedToDOM=!0}xt.fixAndSetPosition(),xt.onceAdded(),$t(this,dt).addToAnnotationStorage(xt)}moveEditorInDOM(xt){var Ot;if(!xt.isAttachedToDOM)return;const{activeElement:wt}=document;xt.div.contains(wt)&&(xt._focusEventsAllowed=!1,setTimeout(()=>{xt.div.contains(document.activeElement)?xt._focusEventsAllowed=!0:(xt.div.addEventListener("focusin",()=>{xt._focusEventsAllowed=!0},{once:!0}),wt.focus())},0)),xt._structTreeParentId=(Ot=$t(this,it))==null?void 0:Ot.moveElementInDOM(this.div,xt.div,xt.contentDiv,!0)}addOrRebuild(xt){xt.needsToBeRebuilt()?xt.rebuild():this.add(xt)}addUndoableEditor(xt){const wt=()=>xt._uiManager.rebuild(xt),Ot=()=>{xt.remove()};this.addCommands({cmd:wt,undo:Ot,mustExec:!1})}getNextId(){return $t(this,dt).getId()}pasteEditor(xt,wt){$t(this,dt).updateToolbar(xt),$t(this,dt).updateMode(xt);const{offsetX:Ot,offsetY:Bt}=mr(this,mt,Sl).call(this),Ft=this.getNextId(),Pt=mr(this,mt,yl).call(this,{parent:this,id:Ft,x:Ot,y:Bt,uiManager:$t(this,dt),isCentered:!0,...wt});Pt&&this.add(Pt)}deserialize(xt){switch(xt.annotationType??xt.annotationEditorType){case $.AnnotationEditorType.FREETEXT:return _e.FreeTextEditor.deserialize(xt,this,$t(this,dt));case $.AnnotationEditorType.INK:return et.InkEditor.deserialize(xt,this,$t(this,dt));case $.AnnotationEditorType.STAMP:return rt.StampEditor.deserialize(xt,this,$t(this,dt))}return null}addNewEditor(){mr(this,mt,no).call(this,mr(this,mt,Sl).call(this),!0)}setSelected(xt){$t(this,dt).setSelected(xt)}toggleSelected(xt){$t(this,dt).toggleSelected(xt)}isSelected(xt){return $t(this,dt).isSelected(xt)}unselect(xt){$t(this,dt).unselect(xt)}pointerup(xt){const{isMac:wt}=$.FeatureTest.platform;if(!(xt.button!==0||xt.ctrlKey&&wt)&&xt.target===this.div&&$t(this,ft)){if(Tr(this,ft,!1),!$t(this,st)){Tr(this,st,!0);return}if($t(this,dt).getMode()===$.AnnotationEditorType.STAMP){$t(this,dt).unselectAll();return}mr(this,mt,no).call(this,xt,!1)}}pointerdown(xt){if($t(this,ft)){Tr(this,ft,!1);return}const{isMac:wt}=$.FeatureTest.platform;if(xt.button!==0||xt.ctrlKey&&wt||xt.target!==this.div)return;Tr(this,ft,!0);const Ot=$t(this,dt).getActive();Tr(this,st,!Ot||Ot.isEmpty())}findNewParent(xt,wt,Ot){const Bt=$t(this,dt).findParent(wt,Ot);return Bt===null||Bt===this?!1:(Bt.changeParent(xt),!0)}destroy(){var xt,wt;((xt=$t(this,dt).getActive())==null?void 0:xt.parent)===this&&($t(this,dt).commitOrRemove(),$t(this,dt).setActiveEditor(null));for(const Ot of $t(this,ct).values())(wt=$t(this,it))==null||wt.removePointerInTextLayer(Ot.contentDiv),Ot.setParent(null),Ot.isAttachedToDOM=!1,Ot.div.remove();this.div=null,$t(this,ct).clear(),$t(this,dt).removeLayer(this)}render({viewport:xt}){this.viewport=xt,(0,tt.setLayerDimensions)(this.div,xt);for(const wt of $t(this,dt).getEditors(this.pageIndex))this.add(wt);this.updateMode()}update({viewport:xt}){$t(this,dt).commitOrRemove(),this.viewport=xt,(0,tt.setLayerDimensions)(this.div,{rotation:xt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:xt,pageHeight:wt}=this.viewport.rawDims;return[xt,wt]}};it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakMap,ht=new WeakMap,dt=new WeakMap,mt=new WeakSet,yl=function(xt){switch($t(this,dt).getMode()){case $.AnnotationEditorType.FREETEXT:return new _e.FreeTextEditor(xt);case $.AnnotationEditorType.INK:return new et.InkEditor(xt);case $.AnnotationEditorType.STAMP:return new rt.StampEditor(xt)}return null},no=function(xt,wt){const Ot=this.getNextId(),Bt=mr(this,mt,yl).call(this,{parent:this,id:Ot,x:xt.offsetX,y:xt.offsetY,uiManager:$t(this,dt),isCentered:wt});return Bt&&this.add(Bt),Bt},Sl=function(){const{x:xt,y:wt,width:Ot,height:Bt}=this.div.getBoundingClientRect(),Ft=Math.max(0,xt),Pt=Math.max(0,wt),Rt=Math.min(window.innerWidth,xt+Ot),Et=Math.min(window.innerHeight,wt+Bt),_t=(Ft+Rt)/2-xt,Mt=(Pt+Et)/2-wt,[Dt,Lt]=this.viewport.rotation%180===0?[_t,Mt]:[Mt,_t];return{offsetX:Dt,offsetY:Lt}},El=function(){Tr(this,ut,!0);for(const xt of $t(this,ct).values())xt.isEmpty()&&xt.remove();Tr(this,ut,!1)},Rn(St,"_initialized",!1);let nt=St;i.AnnotationEditorLayer=nt},(o,i,_)=>{var rt,nt,it,st,at,ot,lt,ct,ft,ut,bu,Su,Eu,js,_l,_u,xl;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var $=_(1),j=_(5),_e=_(4),et=_(29);const St=class St extends _e.AnnotationEditor{constructor(wt){super({...wt,name:"freeTextEditor"});Er(this,ut);Er(this,rt,this.editorDivBlur.bind(this));Er(this,nt,this.editorDivFocus.bind(this));Er(this,it,this.editorDivInput.bind(this));Er(this,st,this.editorDivKeydown.bind(this));Er(this,at);Er(this,ot,"");Er(this,lt,`${this.id}-editor`);Er(this,ct);Er(this,ft,null);Tr(this,at,wt.color||St._defaultColor||_e.AnnotationEditor._defaultLineColor),Tr(this,ct,wt.fontSize||St._defaultFontSize)}static get _keyboardManager(){const wt=St.prototype,Ot=Pt=>Pt.isEmpty(),Bt=j.AnnotationEditorUIManager.TRANSLATE_SMALL,Ft=j.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,$.shadow)(this,"_keyboardManager",new j.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],wt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],wt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],wt._translateEmpty,{args:[-Bt,0],checker:Ot}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],wt._translateEmpty,{args:[-Ft,0],checker:Ot}],[["ArrowRight","mac+ArrowRight"],wt._translateEmpty,{args:[Bt,0],checker:Ot}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],wt._translateEmpty,{args:[Ft,0],checker:Ot}],[["ArrowUp","mac+ArrowUp"],wt._translateEmpty,{args:[0,-Bt],checker:Ot}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],wt._translateEmpty,{args:[0,-Ft],checker:Ot}],[["ArrowDown","mac+ArrowDown"],wt._translateEmpty,{args:[0,Bt],checker:Ot}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],wt._translateEmpty,{args:[0,Ft],checker:Ot}]]))}static initialize(wt){_e.AnnotationEditor.initialize(wt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Ot=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Ot.getPropertyValue("--freetext-padding"))}static updateDefaultParams(wt,Ot){switch(wt){case $.AnnotationEditorParamsType.FREETEXT_SIZE:St._defaultFontSize=Ot;break;case $.AnnotationEditorParamsType.FREETEXT_COLOR:St._defaultColor=Ot;break}}updateParams(wt,Ot){switch(wt){case $.AnnotationEditorParamsType.FREETEXT_SIZE:mr(this,ut,bu).call(this,Ot);break;case $.AnnotationEditorParamsType.FREETEXT_COLOR:mr(this,ut,Su).call(this,Ot);break}}static get defaultPropertiesToUpdate(){return[[$.AnnotationEditorParamsType.FREETEXT_SIZE,St._defaultFontSize],[$.AnnotationEditorParamsType.FREETEXT_COLOR,St._defaultColor||_e.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[$.AnnotationEditorParamsType.FREETEXT_SIZE,$t(this,ct)],[$.AnnotationEditorParamsType.FREETEXT_COLOR,$t(this,at)]]}_translateEmpty(wt,Ot){this._uiManager.translateSelectedEditors(wt,Ot,!0)}getInitialTranslation(){const wt=this.parentScale;return[-St._internalPadding*wt,-(St._internalPadding+$t(this,ct))*wt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar($.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",$t(this,st)),this.editorDiv.addEventListener("focus",$t(this,nt)),this.editorDiv.addEventListener("blur",$t(this,rt)),this.editorDiv.addEventListener("input",$t(this,it)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",$t(this,lt)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",$t(this,st)),this.editorDiv.removeEventListener("focus",$t(this,nt)),this.editorDiv.removeEventListener("blur",$t(this,rt)),this.editorDiv.removeEventListener("input",$t(this,it)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(wt){this._focusEventsAllowed&&(super.focusin(wt),wt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var wt;if(this.width){mr(this,ut,xl).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(wt=this._initialOptions)!=null&&wt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const wt=$t(this,ot),Ot=Tr(this,ot,mr(this,ut,Eu).call(this).trimEnd());if(wt===Ot)return;const Bt=Ft=>{if(Tr(this,ot,Ft),!Ft){this.remove();return}mr(this,ut,_l).call(this),this._uiManager.rebuild(this),mr(this,ut,js).call(this)};this.addCommands({cmd:()=>{Bt(Ot)},undo:()=>{Bt(wt)},mustExec:!1}),mr(this,ut,js).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(wt){this.enterInEditMode()}keydown(wt){wt.target===this.div&&wt.key==="Enter"&&(this.enterInEditMode(),wt.preventDefault())}editorDivKeydown(wt){St._keyboardManager.exec(this,wt)}editorDivFocus(wt){this.isEditing=!0}editorDivBlur(wt){this.isEditing=!1}editorDivInput(wt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let wt,Ot;this.width&&(wt=this.x,Ot=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",$t(this,lt)),this.enableEditing(),_e.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Ft=>{var Pt;return(Pt=this.editorDiv)==null?void 0:Pt.setAttribute("aria-label",Ft)}),_e.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Ft=>{var Pt;return(Pt=this.editorDiv)==null?void 0:Pt.setAttribute("default-content",Ft)}),this.editorDiv.contentEditable=!0;const{style:Bt}=this.editorDiv;if(Bt.fontSize=`calc(${$t(this,ct)}px * var(--scale-factor))`,Bt.color=$t(this,at),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,j.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Ft,Pt]=this.parentDimensions;if(this.annotationElementId){const{position:Rt}=$t(this,ft);let[Et,_t]=this.getInitialTranslation();[Et,_t]=this.pageTranslationToScreen(Et,_t);const[Mt,Dt]=this.pageDimensions,[Lt,Ct]=this.pageTranslation;let kt,jt;switch(this.rotation){case 0:kt=wt+(Rt[0]-Lt)/Mt,jt=Ot+this.height-(Rt[1]-Ct)/Dt;break;case 90:kt=wt+(Rt[0]-Lt)/Mt,jt=Ot-(Rt[1]-Ct)/Dt,[Et,_t]=[_t,-Et];break;case 180:kt=wt-this.width+(Rt[0]-Lt)/Mt,jt=Ot-(Rt[1]-Ct)/Dt,[Et,_t]=[-Et,-_t];break;case 270:kt=wt+(Rt[0]-Lt-this.height*Dt)/Mt,jt=Ot+(Rt[1]-Ct-this.width*Mt)/Dt,[Et,_t]=[-_t,Et];break}this.setAt(kt*Ft,jt*Pt,Et,_t)}else this.setAt(wt*Ft,Ot*Pt,this.width*Ft,this.height*Pt);mr(this,ut,_l).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(wt,Ot,Bt){let Ft=null;if(wt instanceof et.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Rt,fontColor:Et},rect:_t,rotation:Mt,id:Dt},textContent:Lt,textPosition:Ct,parent:{page:{pageNumber:kt}}}=wt;if(!Lt||Lt.length===0)return null;Ft=wt={annotationType:$.AnnotationEditorType.FREETEXT,color:Array.from(Et),fontSize:Rt,value:Lt.join(`
`),position:Ct,pageIndex:kt-1,rect:_t,rotation:Mt,id:Dt,deleted:!1}}const Pt=super.deserialize(wt,Ot,Bt);return Tr(Pt,ct,wt.fontSize),Tr(Pt,at,$.Util.makeHexColor(...wt.color)),Tr(Pt,ot,wt.value),Pt.annotationElementId=wt.id||null,Tr(Pt,ft,Ft),Pt}serialize(wt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Ot=St._internalPadding*this.parentScale,Bt=this.getRect(Ot,Ot),Ft=_e.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:$t(this,at)),Pt={annotationType:$.AnnotationEditorType.FREETEXT,color:Ft,fontSize:$t(this,ct),value:$t(this,ot),pageIndex:this.pageIndex,rect:Bt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return wt?Pt:this.annotationElementId&&!mr(this,ut,_u).call(this,Pt)?null:(Pt.id=this.annotationElementId,Pt)}};rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakSet,bu=function(wt){const Ot=Ft=>{this.editorDiv.style.fontSize=`calc(${Ft}px * var(--scale-factor))`,this.translate(0,-(Ft-$t(this,ct))*this.parentScale),Tr(this,ct,Ft),mr(this,ut,js).call(this)},Bt=$t(this,ct);this.addCommands({cmd:()=>{Ot(wt)},undo:()=>{Ot(Bt)},mustExec:!0,type:$.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Su=function(wt){const Ot=$t(this,at);this.addCommands({cmd:()=>{Tr(this,at,this.editorDiv.style.color=wt)},undo:()=>{Tr(this,at,this.editorDiv.style.color=Ot)},mustExec:!0,type:$.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Eu=function(){const wt=this.editorDiv.getElementsByTagName("div");if(wt.length===0)return this.editorDiv.innerText;const Ot=[];for(const Bt of wt)Ot.push(Bt.innerText.replace(/\r\n?|\n/,""));return Ot.join(`
`)},js=function(){const[wt,Ot]=this.parentDimensions;let Bt;if(this.isAttachedToDOM)Bt=this.div.getBoundingClientRect();else{const{currentLayer:Ft,div:Pt}=this,Rt=Pt.style.display;Pt.style.display="hidden",Ft.div.append(this.div),Bt=Pt.getBoundingClientRect(),Pt.remove(),Pt.style.display=Rt}this.rotation%180===this.parentRotation%180?(this.width=Bt.width/wt,this.height=Bt.height/Ot):(this.width=Bt.height/wt,this.height=Bt.width/Ot),this.fixAndSetPosition()},_l=function(){if(this.editorDiv.replaceChildren(),!!$t(this,ot))for(const wt of $t(this,ot).split(`
`)){const Ot=document.createElement("div");Ot.append(wt?document.createTextNode(wt):document.createElement("br")),this.editorDiv.append(Ot)}},_u=function(wt){const{value:Ot,fontSize:Bt,color:Ft,rect:Pt,pageIndex:Rt}=$t(this,ft);return wt.value!==Ot||wt.fontSize!==Bt||wt.rect.some((Et,_t)=>Math.abs(Et-Pt[_t])>=1)||wt.color.some((Et,_t)=>Et!==Ft[_t])||wt.pageIndex!==Rt},xl=function(wt=!1){if(!this.annotationElementId)return;if(mr(this,ut,js).call(this),!wt&&(this.width===0||this.height===0)){setTimeout(()=>mr(this,ut,xl).call(this,!0),0);return}const Ot=St._internalPadding*this.parentScale;$t(this,ft).rect=this.getRect(Ot,Ot)},Rn(St,"_freeTextDefaultContent",""),Rn(St,"_internalPadding",0),Rn(St,"_defaultColor",null),Rn(St,"_defaultFontSize",10),Rn(St,"_type","freetext");let tt=St;i.FreeTextEditor=tt},(o,i,_)=>{var jt,zt,fs,xu,ir,or,Qt,gr,ar,Ar,er,sr,Gt,Jt,lr,dr,xr,Mr,Or,fr,Hr,Gr,Tu,io,Tl,Al,an,yn,_n,jr,cr,Sr,en,Pl,qr,rr,Fr,Xr,Au,wl;Object.defineProperty(i,"__esModule",{value:!0}),i.StampAnnotationElement=i.InkAnnotationElement=i.FreeTextAnnotationElement=i.AnnotationLayer=void 0;var $=_(1),j=_(6),_e=_(3),et=_(30),tt=_(31),rt=_(32);const nt=1e3,it=9,st=new WeakSet;function at(rn){return{width:rn[2]-rn[0],height:rn[3]-rn[1]}}class ot{static create(Zt){switch(Zt.data.annotationType){case $.AnnotationType.LINK:return new ct(Zt);case $.AnnotationType.TEXT:return new ft(Zt);case $.AnnotationType.WIDGET:switch(Zt.data.fieldType){case"Tx":return new ht(Zt);case"Btn":return Zt.data.radioButton?new pt(Zt):Zt.data.checkBox?new mt(Zt):new yt(Zt);case"Ch":return new gt(Zt);case"Sig":return new dt(Zt)}return new ut(Zt);case $.AnnotationType.POPUP:return new vt(Zt);case $.AnnotationType.FREETEXT:return new At(Zt);case $.AnnotationType.LINE:return new xt(Zt);case $.AnnotationType.SQUARE:return new wt(Zt);case $.AnnotationType.CIRCLE:return new Ot(Zt);case $.AnnotationType.POLYLINE:return new Bt(Zt);case $.AnnotationType.CARET:return new Pt(Zt);case $.AnnotationType.INK:return new Rt(Zt);case $.AnnotationType.POLYGON:return new Ft(Zt);case $.AnnotationType.HIGHLIGHT:return new Et(Zt);case $.AnnotationType.UNDERLINE:return new _t(Zt);case $.AnnotationType.SQUIGGLY:return new Mt(Zt);case $.AnnotationType.STRIKEOUT:return new Dt(Zt);case $.AnnotationType.STAMP:return new Lt(Zt);case $.AnnotationType.FILEATTACHMENT:return new Ct(Zt);default:return new lt(Zt)}}}const Vt=class Vt{constructor(Zt,{isRenderable:Yt=!1,ignoreBorder:hr=!1,createQuadrilaterals:Lr=!1}={}){Er(this,jt,!1);this.isRenderable=Yt,this.data=Zt.data,this.layer=Zt.layer,this.linkService=Zt.linkService,this.downloadManager=Zt.downloadManager,this.imageResourcesPath=Zt.imageResourcesPath,this.renderForms=Zt.renderForms,this.svgFactory=Zt.svgFactory,this.annotationStorage=Zt.annotationStorage,this.enableScripting=Zt.enableScripting,this.hasJSActions=Zt.hasJSActions,this._fieldObjects=Zt.fieldObjects,this.parent=Zt.parent,Yt&&(this.container=this._createContainer(hr)),Lr&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Zt,contentsObj:Yt,richText:hr}){return!!(Zt!=null&&Zt.str||Yt!=null&&Yt.str||hr!=null&&hr.str)}get hasPopupData(){return Vt._hasPopupData(this.data)}_createContainer(Zt){const{data:Yt,parent:{page:hr,viewport:Lr}}=this,Ht=document.createElement("section");Ht.setAttribute("data-annotation-id",Yt.id),this instanceof ut||(Ht.tabIndex=nt),Ht.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Ht.setAttribute("aria-haspopup","dialog"),Yt.noRotate&&Ht.classList.add("norotate");const{pageWidth:Xt,pageHeight:tr,pageX:wr,pageY:Dr}=Lr.rawDims;if(!Yt.rect||this instanceof vt){const{rotation:Kr}=Yt;return!Yt.hasOwnCanvas&&Kr!==0&&this.setRotation(Kr,Ht),Ht}const{width:Nr,height:Qr}=at(Yt.rect),Ur=$.Util.normalizeRect([Yt.rect[0],hr.view[3]-Yt.rect[1]+hr.view[1],Yt.rect[2],hr.view[3]-Yt.rect[3]+hr.view[1]]);if(!Zt&&Yt.borderStyle.width>0){Ht.style.borderWidth=`${Yt.borderStyle.width}px`;const Kr=Yt.borderStyle.horizontalCornerRadius,Yr=Yt.borderStyle.verticalCornerRadius;if(Kr>0||Yr>0){const gn=`calc(${Kr}px * var(--scale-factor)) / calc(${Yr}px * var(--scale-factor))`;Ht.style.borderRadius=gn}else if(this instanceof pt){const gn=`calc(${Nr}px * var(--scale-factor)) / calc(${Qr}px * var(--scale-factor))`;Ht.style.borderRadius=gn}switch(Yt.borderStyle.style){case $.AnnotationBorderStyleType.SOLID:Ht.style.borderStyle="solid";break;case $.AnnotationBorderStyleType.DASHED:Ht.style.borderStyle="dashed";break;case $.AnnotationBorderStyleType.BEVELED:(0,$.warn)("Unimplemented border style: beveled");break;case $.AnnotationBorderStyleType.INSET:(0,$.warn)("Unimplemented border style: inset");break;case $.AnnotationBorderStyleType.UNDERLINE:Ht.style.borderBottomStyle="solid";break}const on=Yt.borderColor||null;on?(Tr(this,jt,!0),Ht.style.borderColor=$.Util.makeHexColor(on[0]|0,on[1]|0,on[2]|0)):Ht.style.borderWidth=0}Ht.style.left=`${100*(Ur[0]-wr)/Xt}%`,Ht.style.top=`${100*(Ur[1]-Dr)/tr}%`;const{rotation:Br}=Yt;return Yt.hasOwnCanvas||Br===0?(Ht.style.width=`${100*Nr/Xt}%`,Ht.style.height=`${100*Qr/tr}%`):this.setRotation(Br,Ht),Ht}setRotation(Zt,Yt=this.container){if(!this.data.rect)return;const{pageWidth:hr,pageHeight:Lr}=this.parent.viewport.rawDims,{width:Ht,height:Xt}=at(this.data.rect);let tr,wr;Zt%180===0?(tr=100*Ht/hr,wr=100*Xt/Lr):(tr=100*Xt/hr,wr=100*Ht/Lr),Yt.style.width=`${tr}%`,Yt.style.height=`${wr}%`,Yt.setAttribute("data-main-rotation",(360-Zt)%360)}get _commonActions(){const Zt=(Yt,hr,Lr)=>{const Ht=Lr.detail[Yt],Xt=Ht[0],tr=Ht.slice(1);Lr.target.style[hr]=et.ColorConverters[`${Xt}_HTML`](tr),this.annotationStorage.setValue(this.data.id,{[hr]:et.ColorConverters[`${Xt}_rgb`](tr)})};return(0,$.shadow)(this,"_commonActions",{display:Yt=>{const{display:hr}=Yt.detail,Lr=hr%2===1;this.container.style.visibility=Lr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Lr,noPrint:hr===1||hr===2})},print:Yt=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Yt.detail.print})},hidden:Yt=>{const{hidden:hr}=Yt.detail;this.container.style.visibility=hr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:hr,noView:hr})},focus:Yt=>{setTimeout(()=>Yt.target.focus({preventScroll:!1}),0)},userName:Yt=>{Yt.target.title=Yt.detail.userName},readonly:Yt=>{Yt.target.disabled=Yt.detail.readonly},required:Yt=>{this._setRequired(Yt.target,Yt.detail.required)},bgColor:Yt=>{Zt("bgColor","backgroundColor",Yt)},fillColor:Yt=>{Zt("fillColor","backgroundColor",Yt)},fgColor:Yt=>{Zt("fgColor","color",Yt)},textColor:Yt=>{Zt("textColor","color",Yt)},borderColor:Yt=>{Zt("borderColor","borderColor",Yt)},strokeColor:Yt=>{Zt("strokeColor","borderColor",Yt)},rotation:Yt=>{const hr=Yt.detail.rotation;this.setRotation(hr),this.annotationStorage.setValue(this.data.id,{rotation:hr})}})}_dispatchEventFromSandbox(Zt,Yt){const hr=this._commonActions;for(const Lr of Object.keys(Yt.detail)){const Ht=Zt[Lr]||hr[Lr];Ht==null||Ht(Yt)}}_setDefaultPropertiesFromJS(Zt){if(!this.enableScripting)return;const Yt=this.annotationStorage.getRawValue(this.data.id);if(!Yt)return;const hr=this._commonActions;for(const[Lr,Ht]of Object.entries(Yt)){const Xt=hr[Lr];if(Xt){const tr={detail:{[Lr]:Ht},target:Zt};Xt(tr),delete Yt[Lr]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Zt}=this.data;if(!Zt)return;const[Yt,hr,Lr,Ht]=this.data.rect;if(Zt.length===1){const[,{x:Yr,y:on},{x:gn,y:Tn}]=Zt[0];if(Lr===Yr&&Ht===on&&Yt===gn&&hr===Tn)return}const{style:Xt}=this.container;let tr;if($t(this,jt)){const{borderColor:Yr,borderWidth:on}=Xt;Xt.borderWidth=0,tr=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Yr}" stroke-width="${on}">`],this.container.classList.add("hasBorder")}const wr=Lr-Yt,Dr=Ht-hr,{svgFactory:Nr}=this,Qr=Nr.createElement("svg");Qr.classList.add("quadrilateralsContainer"),Qr.setAttribute("width",0),Qr.setAttribute("height",0);const Ur=Nr.createElement("defs");Qr.append(Ur);const Br=Nr.createElement("clipPath"),Kr=`clippath_${this.data.id}`;Br.setAttribute("id",Kr),Br.setAttribute("clipPathUnits","objectBoundingBox"),Ur.append(Br);for(const[,{x:Yr,y:on},{x:gn,y:Tn}]of Zt){const En=Nr.createElement("rect"),xn=(gn-Yt)/wr,In=(Ht-on)/Dr,jn=(Yr-gn)/wr,$n=(on-Tn)/Dr;En.setAttribute("x",xn),En.setAttribute("y",In),En.setAttribute("width",jn),En.setAttribute("height",$n),Br.append(En),tr==null||tr.push(`<rect vector-effect="non-scaling-stroke" x="${xn}" y="${In}" width="${jn}" height="${$n}"/>`)}$t(this,jt)&&(tr.push("</g></svg>')"),Xt.backgroundImage=tr.join("")),this.container.append(Qr),this.container.style.clipPath=`url(#${Kr})`}_createPopup(){const{container:Zt,data:Yt}=this;Zt.setAttribute("aria-haspopup","dialog");const hr=new vt({data:{color:Yt.color,titleObj:Yt.titleObj,modificationDate:Yt.modificationDate,contentsObj:Yt.contentsObj,richText:Yt.richText,parentRect:Yt.rect,borderStyle:0,id:`popup_${Yt.id}`,rotation:Yt.rotation},parent:this.parent,elements:[this]});this.parent.div.append(hr.render())}render(){(0,$.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Zt,Yt=null){const hr=[];if(this._fieldObjects){const Lr=this._fieldObjects[Zt];if(Lr)for(const{page:Ht,id:Xt,exportValues:tr}of Lr){if(Ht===-1||Xt===Yt)continue;const wr=typeof tr=="string"?tr:null,Dr=document.querySelector(`[data-element-id="${Xt}"]`);if(Dr&&!st.has(Dr)){(0,$.warn)(`_getElementsByName - element not allowed: ${Xt}`);continue}hr.push({id:Xt,exportValue:wr,domElement:Dr})}return hr}for(const Lr of document.getElementsByName(Zt)){const{exportValue:Ht}=Lr,Xt=Lr.getAttribute("data-element-id");Xt!==Yt&&st.has(Lr)&&hr.push({id:Xt,exportValue:Ht,domElement:Lr})}return hr}show(){var Zt;this.container&&(this.container.hidden=!1),(Zt=this.popup)==null||Zt.maybeShow()}hide(){var Zt;this.container&&(this.container.hidden=!0),(Zt=this.popup)==null||Zt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Zt=this.getElementsToTriggerPopup();if(Array.isArray(Zt))for(const Yt of Zt)Yt.classList.add("highlightArea");else Zt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Zt,data:{id:Yt}}=this;this.container.addEventListener("dblclick",()=>{var hr;(hr=this.linkService.eventBus)==null||hr.dispatch("switchannotationeditormode",{source:this,mode:Zt,editId:Yt})})}};jt=new WeakMap;let lt=Vt;class ct extends lt{constructor(Yt,hr=null){super(Yt,{isRenderable:!0,ignoreBorder:!!(hr!=null&&hr.ignoreBorder),createQuadrilaterals:!0});Er(this,zt);this.isTooltipOnly=Yt.data.isTooltipOnly}render(){const{data:Yt,linkService:hr}=this,Lr=document.createElement("a");Lr.setAttribute("data-element-id",Yt.id);let Ht=!1;return Yt.url?(hr.addLinkAttributes(Lr,Yt.url,Yt.newWindow),Ht=!0):Yt.action?(this._bindNamedAction(Lr,Yt.action),Ht=!0):Yt.attachment?(this._bindAttachment(Lr,Yt.attachment),Ht=!0):Yt.setOCGState?(mr(this,zt,xu).call(this,Lr,Yt.setOCGState),Ht=!0):Yt.dest?(this._bindLink(Lr,Yt.dest),Ht=!0):(Yt.actions&&(Yt.actions.Action||Yt.actions["Mouse Up"]||Yt.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Lr,Yt),Ht=!0),Yt.resetForm?(this._bindResetFormAction(Lr,Yt.resetForm),Ht=!0):this.isTooltipOnly&&!Ht&&(this._bindLink(Lr,""),Ht=!0)),this.container.classList.add("linkAnnotation"),Ht&&this.container.append(Lr),this.container}_bindLink(Yt,hr){Yt.href=this.linkService.getDestinationHash(hr),Yt.onclick=()=>(hr&&this.linkService.goToDestination(hr),!1),(hr||hr==="")&&mr(this,zt,fs).call(this)}_bindNamedAction(Yt,hr){Yt.href=this.linkService.getAnchorUrl(""),Yt.onclick=()=>(this.linkService.executeNamedAction(hr),!1),mr(this,zt,fs).call(this)}_bindAttachment(Yt,hr){Yt.href=this.linkService.getAnchorUrl(""),Yt.onclick=()=>{var Lr;return(Lr=this.downloadManager)==null||Lr.openOrDownloadData(this.container,hr.content,hr.filename),!1},mr(this,zt,fs).call(this)}_bindJSAction(Yt,hr){Yt.href=this.linkService.getAnchorUrl("");const Lr=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Ht of Object.keys(hr.actions)){const Xt=Lr.get(Ht);Xt&&(Yt[Xt]=()=>{var tr;return(tr=this.linkService.eventBus)==null||tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:hr.id,name:Ht}}),!1})}Yt.onclick||(Yt.onclick=()=>!1),mr(this,zt,fs).call(this)}_bindResetFormAction(Yt,hr){const Lr=Yt.onclick;if(Lr||(Yt.href=this.linkService.getAnchorUrl("")),mr(this,zt,fs).call(this),!this._fieldObjects){(0,$.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Lr||(Yt.onclick=()=>!1);return}Yt.onclick=()=>{var Qr;Lr==null||Lr();const{fields:Ht,refs:Xt,include:tr}=hr,wr=[];if(Ht.length!==0||Xt.length!==0){const Ur=new Set(Xt);for(const Br of Ht){const Kr=this._fieldObjects[Br]||[];for(const{id:Yr}of Kr)Ur.add(Yr)}for(const Br of Object.values(this._fieldObjects))for(const Kr of Br)Ur.has(Kr.id)===tr&&wr.push(Kr)}else for(const Ur of Object.values(this._fieldObjects))wr.push(...Ur);const Dr=this.annotationStorage,Nr=[];for(const Ur of wr){const{id:Br}=Ur;switch(Nr.push(Br),Ur.type){case"text":{const Yr=Ur.defaultValue||"";Dr.setValue(Br,{value:Yr});break}case"checkbox":case"radiobutton":{const Yr=Ur.defaultValue===Ur.exportValues;Dr.setValue(Br,{value:Yr});break}case"combobox":case"listbox":{const Yr=Ur.defaultValue||"";Dr.setValue(Br,{value:Yr});break}default:continue}const Kr=document.querySelector(`[data-element-id="${Br}"]`);if(Kr){if(!st.has(Kr)){(0,$.warn)(`_bindResetFormAction - element not allowed: ${Br}`);continue}}else continue;Kr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Qr=this.linkService.eventBus)==null||Qr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Nr,name:"ResetForm"}})),!1}}}zt=new WeakSet,fs=function(){this.container.setAttribute("data-internal-link","")},xu=function(Yt,hr){Yt.href=this.linkService.getAnchorUrl(""),Yt.onclick=()=>(this.linkService.executeSetOCGState(hr),!1),mr(this,zt,fs).call(this)};class ft extends lt{constructor(Zt){super(Zt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Zt=document.createElement("img");return Zt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Zt.alt="[{{type}} Annotation]",Zt.dataset.l10nId="text_annotation_type",Zt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Zt),this.container}}class ut extends lt{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Zt){var Yt;this.data.hasOwnCanvas&&(((Yt=Zt.previousSibling)==null?void 0:Yt.nodeName)==="CANVAS"&&(Zt.previousSibling.hidden=!0),Zt.hidden=!1)}_getKeyModifier(Zt){const{isWin:Yt,isMac:hr}=$.FeatureTest.platform;return Yt&&Zt.ctrlKey||hr&&Zt.metaKey}_setEventListener(Zt,Yt,hr,Lr,Ht){hr.includes("mouse")?Zt.addEventListener(hr,Xt=>{var tr;(tr=this.linkService.eventBus)==null||tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Lr,value:Ht(Xt),shift:Xt.shiftKey,modifier:this._getKeyModifier(Xt)}})}):Zt.addEventListener(hr,Xt=>{var tr;if(hr==="blur"){if(!Yt.focused||!Xt.relatedTarget)return;Yt.focused=!1}else if(hr==="focus"){if(Yt.focused)return;Yt.focused=!0}Ht&&((tr=this.linkService.eventBus)==null||tr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Lr,value:Ht(Xt)}}))})}_setEventListeners(Zt,Yt,hr,Lr){var Ht,Xt,tr;for(const[wr,Dr]of hr)(Dr==="Action"||(Ht=this.data.actions)!=null&&Ht[Dr])&&((Dr==="Focus"||Dr==="Blur")&&(Yt||(Yt={focused:!1})),this._setEventListener(Zt,Yt,wr,Dr,Lr),Dr==="Focus"&&!((Xt=this.data.actions)!=null&&Xt.Blur)?this._setEventListener(Zt,Yt,"blur","Blur",null):Dr==="Blur"&&!((tr=this.data.actions)!=null&&tr.Focus)&&this._setEventListener(Zt,Yt,"focus","Focus",null))}_setBackgroundColor(Zt){const Yt=this.data.backgroundColor||null;Zt.style.backgroundColor=Yt===null?"transparent":$.Util.makeHexColor(Yt[0],Yt[1],Yt[2])}_setTextStyle(Zt){const Yt=["left","center","right"],{fontColor:hr}=this.data.defaultAppearanceData,Lr=this.data.defaultAppearanceData.fontSize||it,Ht=Zt.style;let Xt;const tr=2,wr=Dr=>Math.round(10*Dr)/10;if(this.data.multiLine){const Dr=Math.abs(this.data.rect[3]-this.data.rect[1]-tr),Nr=Math.round(Dr/($.LINE_FACTOR*Lr))||1,Qr=Dr/Nr;Xt=Math.min(Lr,wr(Qr/$.LINE_FACTOR))}else{const Dr=Math.abs(this.data.rect[3]-this.data.rect[1]-tr);Xt=Math.min(Lr,wr(Dr/$.LINE_FACTOR))}Ht.fontSize=`calc(${Xt}px * var(--scale-factor))`,Ht.color=$.Util.makeHexColor(hr[0],hr[1],hr[2]),this.data.textAlignment!==null&&(Ht.textAlign=Yt[this.data.textAlignment])}_setRequired(Zt,Yt){Yt?Zt.setAttribute("required",!0):Zt.removeAttribute("required"),Zt.setAttribute("aria-required",Yt)}}class ht extends ut{constructor(Zt){const Yt=Zt.renderForms||!Zt.data.hasAppearance&&!!Zt.data.fieldValue;super(Zt,{isRenderable:Yt})}setPropertyOnSiblings(Zt,Yt,hr,Lr){const Ht=this.annotationStorage;for(const Xt of this._getElementsByName(Zt.name,Zt.id))Xt.domElement&&(Xt.domElement[Yt]=hr),Ht.setValue(Xt.id,{[Lr]:hr})}render(){var Lr,Ht;const Zt=this.annotationStorage,Yt=this.data.id;this.container.classList.add("textWidgetAnnotation");let hr=null;if(this.renderForms){const Xt=Zt.getValue(Yt,{value:this.data.fieldValue});let tr=Xt.value||"";const wr=Zt.getValue(Yt,{charLimit:this.data.maxLen}).charLimit;wr&&tr.length>wr&&(tr=tr.slice(0,wr));let Dr=Xt.formattedValue||((Lr=this.data.textContent)==null?void 0:Lr.join(`
`))||null;Dr&&this.data.comb&&(Dr=Dr.replaceAll(/\s+/g,""));const Nr={userValue:tr,formattedValue:Dr,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(hr=document.createElement("textarea"),hr.textContent=Dr??tr,this.data.doNotScroll&&(hr.style.overflowY="hidden")):(hr=document.createElement("input"),hr.type="text",hr.setAttribute("value",Dr??tr),this.data.doNotScroll&&(hr.style.overflowX="hidden")),this.data.hasOwnCanvas&&(hr.hidden=!0),st.add(hr),hr.setAttribute("data-element-id",Yt),hr.disabled=this.data.readOnly,hr.name=this.data.fieldName,hr.tabIndex=nt,this._setRequired(hr,this.data.required),wr&&(hr.maxLength=wr),hr.addEventListener("input",Ur=>{Zt.setValue(Yt,{value:Ur.target.value}),this.setPropertyOnSiblings(hr,"value",Ur.target.value,"value"),Nr.formattedValue=null}),hr.addEventListener("resetform",Ur=>{const Br=this.data.defaultFieldValue??"";hr.value=Nr.userValue=Br,Nr.formattedValue=null});let Qr=Ur=>{const{formattedValue:Br}=Nr;Br!=null&&(Ur.target.value=Br),Ur.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){hr.addEventListener("focus",Br=>{if(Nr.focused)return;const{target:Kr}=Br;Nr.userValue&&(Kr.value=Nr.userValue),Nr.lastCommittedValue=Kr.value,Nr.commitKey=1,Nr.focused=!0}),hr.addEventListener("updatefromsandbox",Br=>{this.showElementAndHideCanvas(Br.target);const Kr={value(Yr){Nr.userValue=Yr.detail.value??"",Zt.setValue(Yt,{value:Nr.userValue.toString()}),Yr.target.value=Nr.userValue},formattedValue(Yr){const{formattedValue:on}=Yr.detail;Nr.formattedValue=on,on!=null&&Yr.target!==document.activeElement&&(Yr.target.value=on),Zt.setValue(Yt,{formattedValue:on})},selRange(Yr){Yr.target.setSelectionRange(...Yr.detail.selRange)},charLimit:Yr=>{var En;const{charLimit:on}=Yr.detail,{target:gn}=Yr;if(on===0){gn.removeAttribute("maxLength");return}gn.setAttribute("maxLength",on);let Tn=Nr.userValue;!Tn||Tn.length<=on||(Tn=Tn.slice(0,on),gn.value=Nr.userValue=Tn,Zt.setValue(Yt,{value:Tn}),(En=this.linkService.eventBus)==null||En.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Yt,name:"Keystroke",value:Tn,willCommit:!0,commitKey:1,selStart:gn.selectionStart,selEnd:gn.selectionEnd}}))}};this._dispatchEventFromSandbox(Kr,Br)}),hr.addEventListener("keydown",Br=>{var on;Nr.commitKey=1;let Kr=-1;if(Br.key==="Escape"?Kr=0:Br.key==="Enter"&&!this.data.multiLine?Kr=2:Br.key==="Tab"&&(Nr.commitKey=3),Kr===-1)return;const{value:Yr}=Br.target;Nr.lastCommittedValue!==Yr&&(Nr.lastCommittedValue=Yr,Nr.userValue=Yr,(on=this.linkService.eventBus)==null||on.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Yt,name:"Keystroke",value:Yr,willCommit:!0,commitKey:Kr,selStart:Br.target.selectionStart,selEnd:Br.target.selectionEnd}}))});const Ur=Qr;Qr=null,hr.addEventListener("blur",Br=>{var Yr;if(!Nr.focused||!Br.relatedTarget)return;Nr.focused=!1;const{value:Kr}=Br.target;Nr.userValue=Kr,Nr.lastCommittedValue!==Kr&&((Yr=this.linkService.eventBus)==null||Yr.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Yt,name:"Keystroke",value:Kr,willCommit:!0,commitKey:Nr.commitKey,selStart:Br.target.selectionStart,selEnd:Br.target.selectionEnd}})),Ur(Br)}),(Ht=this.data.actions)!=null&&Ht.Keystroke&&hr.addEventListener("beforeinput",Br=>{var In;Nr.lastCommittedValue=null;const{data:Kr,target:Yr}=Br,{value:on,selectionStart:gn,selectionEnd:Tn}=Yr;let En=gn,xn=Tn;switch(Br.inputType){case"deleteWordBackward":{const jn=on.substring(0,gn).match(/\w*[^\w]*$/);jn&&(En-=jn[0].length);break}case"deleteWordForward":{const jn=on.substring(gn).match(/^[^\w]*\w*/);jn&&(xn+=jn[0].length);break}case"deleteContentBackward":gn===Tn&&(En-=1);break;case"deleteContentForward":gn===Tn&&(xn+=1);break}Br.preventDefault(),(In=this.linkService.eventBus)==null||In.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Yt,name:"Keystroke",value:on,change:Kr||"",willCommit:!1,selStart:En,selEnd:xn}})}),this._setEventListeners(hr,Nr,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Br=>Br.target.value)}if(Qr&&hr.addEventListener("blur",Qr),this.data.comb){const Br=(this.data.rect[2]-this.data.rect[0])/wr;hr.classList.add("comb"),hr.style.letterSpacing=`calc(${Br}px * var(--scale-factor) - 1ch)`}}else hr=document.createElement("div"),hr.textContent=this.data.fieldValue,hr.style.verticalAlign="middle",hr.style.display="table-cell";return this._setTextStyle(hr),this._setBackgroundColor(hr),this._setDefaultPropertiesFromJS(hr),this.container.append(hr),this.container}}class dt extends ut{constructor(Zt){super(Zt,{isRenderable:!!Zt.data.hasOwnCanvas})}}class mt extends ut{constructor(Zt){super(Zt,{isRenderable:Zt.renderForms})}render(){const Zt=this.annotationStorage,Yt=this.data,hr=Yt.id;let Lr=Zt.getValue(hr,{value:Yt.exportValue===Yt.fieldValue}).value;typeof Lr=="string"&&(Lr=Lr!=="Off",Zt.setValue(hr,{value:Lr})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Ht=document.createElement("input");return st.add(Ht),Ht.setAttribute("data-element-id",hr),Ht.disabled=Yt.readOnly,this._setRequired(Ht,this.data.required),Ht.type="checkbox",Ht.name=Yt.fieldName,Lr&&Ht.setAttribute("checked",!0),Ht.setAttribute("exportValue",Yt.exportValue),Ht.tabIndex=nt,Ht.addEventListener("change",Xt=>{const{name:tr,checked:wr}=Xt.target;for(const Dr of this._getElementsByName(tr,hr)){const Nr=wr&&Dr.exportValue===Yt.exportValue;Dr.domElement&&(Dr.domElement.checked=Nr),Zt.setValue(Dr.id,{value:Nr})}Zt.setValue(hr,{value:wr})}),Ht.addEventListener("resetform",Xt=>{const tr=Yt.defaultFieldValue||"Off";Xt.target.checked=tr===Yt.exportValue}),this.enableScripting&&this.hasJSActions&&(Ht.addEventListener("updatefromsandbox",Xt=>{const tr={value(wr){wr.target.checked=wr.detail.value!=="Off",Zt.setValue(hr,{value:wr.target.checked})}};this._dispatchEventFromSandbox(tr,Xt)}),this._setEventListeners(Ht,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Xt=>Xt.target.checked)),this._setBackgroundColor(Ht),this._setDefaultPropertiesFromJS(Ht),this.container.append(Ht),this.container}}class pt extends ut{constructor(Zt){super(Zt,{isRenderable:Zt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Zt=this.annotationStorage,Yt=this.data,hr=Yt.id;let Lr=Zt.getValue(hr,{value:Yt.fieldValue===Yt.buttonValue}).value;typeof Lr=="string"&&(Lr=Lr!==Yt.buttonValue,Zt.setValue(hr,{value:Lr}));const Ht=document.createElement("input");if(st.add(Ht),Ht.setAttribute("data-element-id",hr),Ht.disabled=Yt.readOnly,this._setRequired(Ht,this.data.required),Ht.type="radio",Ht.name=Yt.fieldName,Lr&&Ht.setAttribute("checked",!0),Ht.tabIndex=nt,Ht.addEventListener("change",Xt=>{const{name:tr,checked:wr}=Xt.target;for(const Dr of this._getElementsByName(tr,hr))Zt.setValue(Dr.id,{value:!1});Zt.setValue(hr,{value:wr})}),Ht.addEventListener("resetform",Xt=>{const tr=Yt.defaultFieldValue;Xt.target.checked=tr!=null&&tr===Yt.buttonValue}),this.enableScripting&&this.hasJSActions){const Xt=Yt.buttonValue;Ht.addEventListener("updatefromsandbox",tr=>{const wr={value:Dr=>{const Nr=Xt===Dr.detail.value;for(const Qr of this._getElementsByName(Dr.target.name)){const Ur=Nr&&Qr.id===hr;Qr.domElement&&(Qr.domElement.checked=Ur),Zt.setValue(Qr.id,{value:Ur})}}};this._dispatchEventFromSandbox(wr,tr)}),this._setEventListeners(Ht,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],tr=>tr.target.checked)}return this._setBackgroundColor(Ht),this._setDefaultPropertiesFromJS(Ht),this.container.append(Ht),this.container}}class yt extends ct{constructor(Zt){super(Zt,{ignoreBorder:Zt.data.hasAppearance})}render(){const Zt=super.render();Zt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Zt.title=this.data.alternativeText);const Yt=Zt.lastChild;return this.enableScripting&&this.hasJSActions&&Yt&&(this._setDefaultPropertiesFromJS(Yt),Yt.addEventListener("updatefromsandbox",hr=>{this._dispatchEventFromSandbox({},hr)})),Zt}}class gt extends ut{constructor(Zt){super(Zt,{isRenderable:Zt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Zt=this.annotationStorage,Yt=this.data.id,hr=Zt.getValue(Yt,{value:this.data.fieldValue}),Lr=document.createElement("select");st.add(Lr),Lr.setAttribute("data-element-id",Yt),Lr.disabled=this.data.readOnly,this._setRequired(Lr,this.data.required),Lr.name=this.data.fieldName,Lr.tabIndex=nt;let Ht=this.data.combo&&this.data.options.length>0;this.data.combo||(Lr.size=this.data.options.length,this.data.multiSelect&&(Lr.multiple=!0)),Lr.addEventListener("resetform",Nr=>{const Qr=this.data.defaultFieldValue;for(const Ur of Lr.options)Ur.selected=Ur.value===Qr});for(const Nr of this.data.options){const Qr=document.createElement("option");Qr.textContent=Nr.displayValue,Qr.value=Nr.exportValue,hr.value.includes(Nr.exportValue)&&(Qr.setAttribute("selected",!0),Ht=!1),Lr.append(Qr)}let Xt=null;if(Ht){const Nr=document.createElement("option");Nr.value=" ",Nr.setAttribute("hidden",!0),Nr.setAttribute("selected",!0),Lr.prepend(Nr),Xt=()=>{Nr.remove(),Lr.removeEventListener("input",Xt),Xt=null},Lr.addEventListener("input",Xt)}const tr=Nr=>{const Qr=Nr?"value":"textContent",{options:Ur,multiple:Br}=Lr;return Br?Array.prototype.filter.call(Ur,Kr=>Kr.selected).map(Kr=>Kr[Qr]):Ur.selectedIndex===-1?null:Ur[Ur.selectedIndex][Qr]};let wr=tr(!1);const Dr=Nr=>{const Qr=Nr.target.options;return Array.prototype.map.call(Qr,Ur=>({displayValue:Ur.textContent,exportValue:Ur.value}))};return this.enableScripting&&this.hasJSActions?(Lr.addEventListener("updatefromsandbox",Nr=>{const Qr={value(Ur){Xt==null||Xt();const Br=Ur.detail.value,Kr=new Set(Array.isArray(Br)?Br:[Br]);for(const Yr of Lr.options)Yr.selected=Kr.has(Yr.value);Zt.setValue(Yt,{value:tr(!0)}),wr=tr(!1)},multipleSelection(Ur){Lr.multiple=!0},remove(Ur){const Br=Lr.options,Kr=Ur.detail.remove;Br[Kr].selected=!1,Lr.remove(Kr),Br.length>0&&Array.prototype.findIndex.call(Br,on=>on.selected)===-1&&(Br[0].selected=!0),Zt.setValue(Yt,{value:tr(!0),items:Dr(Ur)}),wr=tr(!1)},clear(Ur){for(;Lr.length!==0;)Lr.remove(0);Zt.setValue(Yt,{value:null,items:[]}),wr=tr(!1)},insert(Ur){const{index:Br,displayValue:Kr,exportValue:Yr}=Ur.detail.insert,on=Lr.children[Br],gn=document.createElement("option");gn.textContent=Kr,gn.value=Yr,on?on.before(gn):Lr.append(gn),Zt.setValue(Yt,{value:tr(!0),items:Dr(Ur)}),wr=tr(!1)},items(Ur){const{items:Br}=Ur.detail;for(;Lr.length!==0;)Lr.remove(0);for(const Kr of Br){const{displayValue:Yr,exportValue:on}=Kr,gn=document.createElement("option");gn.textContent=Yr,gn.value=on,Lr.append(gn)}Lr.options.length>0&&(Lr.options[0].selected=!0),Zt.setValue(Yt,{value:tr(!0),items:Dr(Ur)}),wr=tr(!1)},indices(Ur){const Br=new Set(Ur.detail.indices);for(const Kr of Ur.target.options)Kr.selected=Br.has(Kr.index);Zt.setValue(Yt,{value:tr(!0)}),wr=tr(!1)},editable(Ur){Ur.target.disabled=!Ur.detail.editable}};this._dispatchEventFromSandbox(Qr,Nr)}),Lr.addEventListener("input",Nr=>{var Ur;const Qr=tr(!0);Zt.setValue(Yt,{value:Qr}),Nr.preventDefault(),(Ur=this.linkService.eventBus)==null||Ur.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Yt,name:"Keystroke",value:wr,changeEx:Qr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Lr,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Nr=>Nr.target.value)):Lr.addEventListener("input",function(Nr){Zt.setValue(Yt,{value:tr(!0)})}),this.data.combo&&this._setTextStyle(Lr),this._setBackgroundColor(Lr),this._setDefaultPropertiesFromJS(Lr),this.container.append(Lr),this.container}}class vt extends lt{constructor(Zt){const{data:Yt,elements:hr}=Zt;super(Zt,{isRenderable:lt._hasPopupData(Yt)}),this.elements=hr}render(){this.container.classList.add("popupAnnotation");const Zt=new St({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Yt=[];for(const hr of this.elements)hr.popup=Zt,Yt.push(hr.data.id),hr.addHighlightArea();return this.container.setAttribute("aria-controls",Yt.map(hr=>`${$.AnnotationPrefix}${hr}`).join(",")),this.container}}class St{constructor({container:Zt,color:Yt,elements:hr,titleObj:Lr,modificationDate:Ht,contentsObj:Xt,richText:tr,parent:wr,rect:Dr,parentRect:Nr,open:Qr}){Er(this,Gr);Er(this,ir,null);Er(this,or,mr(this,Gr,Tu).bind(this));Er(this,Qt,mr(this,Gr,Al).bind(this));Er(this,gr,mr(this,Gr,Tl).bind(this));Er(this,ar,mr(this,Gr,io).bind(this));Er(this,Ar,null);Er(this,er,null);Er(this,sr,null);Er(this,Gt,null);Er(this,Jt,null);Er(this,lr,null);Er(this,dr,!1);Er(this,xr,null);Er(this,Mr,null);Er(this,Or,null);Er(this,fr,null);Er(this,Hr,!1);var Br;Tr(this,er,Zt),Tr(this,fr,Lr),Tr(this,sr,Xt),Tr(this,Or,tr),Tr(this,Jt,wr),Tr(this,Ar,Yt),Tr(this,Mr,Dr),Tr(this,lr,Nr),Tr(this,Gt,hr);const Ur=j.PDFDateString.toDateObject(Ht);Ur&&Tr(this,ir,wr.l10n.get("annotation_date_string",{date:Ur.toLocaleDateString(),time:Ur.toLocaleTimeString()})),this.trigger=hr.flatMap(Kr=>Kr.getElementsToTriggerPopup());for(const Kr of this.trigger)Kr.addEventListener("click",$t(this,ar)),Kr.addEventListener("mouseenter",$t(this,gr)),Kr.addEventListener("mouseleave",$t(this,Qt)),Kr.classList.add("popupTriggerArea");for(const Kr of hr)(Br=Kr.container)==null||Br.addEventListener("keydown",$t(this,or));$t(this,er).hidden=!0,Qr&&mr(this,Gr,io).call(this)}render(){if($t(this,xr))return;const{page:{view:Zt},viewport:{rawDims:{pageWidth:Yt,pageHeight:hr,pageX:Lr,pageY:Ht}}}=$t(this,Jt),Xt=Tr(this,xr,document.createElement("div"));if(Xt.className="popup",$t(this,Ar)){const En=Xt.style.outlineColor=$.Util.makeHexColor(...$t(this,Ar));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Xt.style.backgroundColor=`color-mix(in srgb, ${En} 30%, white)`:Xt.style.backgroundColor=$.Util.makeHexColor(...$t(this,Ar).map(In=>Math.floor(.7*(255-In)+In)))}const tr=document.createElement("span");tr.className="header";const wr=document.createElement("h1");if(tr.append(wr),{dir:wr.dir,str:wr.textContent}=$t(this,fr),Xt.append(tr),$t(this,ir)){const En=document.createElement("span");En.classList.add("popupDate"),$t(this,ir).then(xn=>{En.textContent=xn}),tr.append(En)}const Dr=$t(this,sr),Nr=$t(this,Or);if(Nr!=null&&Nr.str&&(!(Dr!=null&&Dr.str)||Dr.str===Nr.str))rt.XfaLayer.render({xfaHtml:Nr.html,intent:"richText",div:Xt}),Xt.lastChild.classList.add("richText","popupContent");else{const En=this._formatContents(Dr);Xt.append(En)}let Qr=!!$t(this,lr),Ur=Qr?$t(this,lr):$t(this,Mr);for(const En of $t(this,Gt))if(!Ur||$.Util.intersect(En.data.rect,Ur)!==null){Ur=En.data.rect,Qr=!0;break}const Br=$.Util.normalizeRect([Ur[0],Zt[3]-Ur[1]+Zt[1],Ur[2],Zt[3]-Ur[3]+Zt[1]]),Yr=Qr?Ur[2]-Ur[0]+5:0,on=Br[0]+Yr,gn=Br[1],{style:Tn}=$t(this,er);Tn.left=`${100*(on-Lr)/Yt}%`,Tn.top=`${100*(gn-Ht)/hr}%`,$t(this,er).append(Xt)}_formatContents({str:Zt,dir:Yt}){const hr=document.createElement("p");hr.classList.add("popupContent"),hr.dir=Yt;const Lr=Zt.split(/(?:\r\n?|\n)/);for(let Ht=0,Xt=Lr.length;Ht<Xt;++Ht){const tr=Lr[Ht];hr.append(document.createTextNode(tr)),Ht<Xt-1&&hr.append(document.createElement("br"))}return hr}forceHide(){Tr(this,Hr,this.isVisible),$t(this,Hr)&&($t(this,er).hidden=!0)}maybeShow(){$t(this,Hr)&&(Tr(this,Hr,!1),$t(this,er).hidden=!1)}get isVisible(){return $t(this,er).hidden===!1}}ir=new WeakMap,or=new WeakMap,Qt=new WeakMap,gr=new WeakMap,ar=new WeakMap,Ar=new WeakMap,er=new WeakMap,sr=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,lr=new WeakMap,dr=new WeakMap,xr=new WeakMap,Mr=new WeakMap,Or=new WeakMap,fr=new WeakMap,Hr=new WeakMap,Gr=new WeakSet,Tu=function(Zt){Zt.altKey||Zt.shiftKey||Zt.ctrlKey||Zt.metaKey||(Zt.key==="Enter"||Zt.key==="Escape"&&$t(this,dr))&&mr(this,Gr,io).call(this)},io=function(){Tr(this,dr,!$t(this,dr)),$t(this,dr)?(mr(this,Gr,Tl).call(this),$t(this,er).addEventListener("click",$t(this,ar)),$t(this,er).addEventListener("keydown",$t(this,or))):(mr(this,Gr,Al).call(this),$t(this,er).removeEventListener("click",$t(this,ar)),$t(this,er).removeEventListener("keydown",$t(this,or)))},Tl=function(){$t(this,xr)||this.render(),this.isVisible?$t(this,dr)&&$t(this,er).classList.add("focused"):($t(this,er).hidden=!1,$t(this,er).style.zIndex=parseInt($t(this,er).style.zIndex)+1e3)},Al=function(){$t(this,er).classList.remove("focused"),!($t(this,dr)||!this.isVisible)&&($t(this,er).hidden=!0,$t(this,er).style.zIndex=parseInt($t(this,er).style.zIndex)-1e3)};class At extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Zt.data.textContent,this.textPosition=Zt.data.textPosition,this.annotationEditorType=$.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Zt=document.createElement("div");Zt.classList.add("annotationTextContent"),Zt.setAttribute("role","comment");for(const Yt of this.textContent){const hr=document.createElement("span");hr.textContent=Yt,Zt.append(hr)}this.container.append(Zt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}i.FreeTextAnnotationElement=At;class xt extends lt{constructor(Yt){super(Yt,{isRenderable:!0,ignoreBorder:!0});Er(this,an,null)}render(){this.container.classList.add("lineAnnotation");const Yt=this.data,{width:hr,height:Lr}=at(Yt.rect),Ht=this.svgFactory.create(hr,Lr,!0),Xt=Tr(this,an,this.svgFactory.createElement("svg:line"));return Xt.setAttribute("x1",Yt.rect[2]-Yt.lineCoordinates[0]),Xt.setAttribute("y1",Yt.rect[3]-Yt.lineCoordinates[1]),Xt.setAttribute("x2",Yt.rect[2]-Yt.lineCoordinates[2]),Xt.setAttribute("y2",Yt.rect[3]-Yt.lineCoordinates[3]),Xt.setAttribute("stroke-width",Yt.borderStyle.width||1),Xt.setAttribute("stroke","transparent"),Xt.setAttribute("fill","transparent"),Ht.append(Xt),this.container.append(Ht),!Yt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $t(this,an)}addHighlightArea(){this.container.classList.add("highlightArea")}}an=new WeakMap;class wt extends lt{constructor(Yt){super(Yt,{isRenderable:!0,ignoreBorder:!0});Er(this,yn,null)}render(){this.container.classList.add("squareAnnotation");const Yt=this.data,{width:hr,height:Lr}=at(Yt.rect),Ht=this.svgFactory.create(hr,Lr,!0),Xt=Yt.borderStyle.width,tr=Tr(this,yn,this.svgFactory.createElement("svg:rect"));return tr.setAttribute("x",Xt/2),tr.setAttribute("y",Xt/2),tr.setAttribute("width",hr-Xt),tr.setAttribute("height",Lr-Xt),tr.setAttribute("stroke-width",Xt||1),tr.setAttribute("stroke","transparent"),tr.setAttribute("fill","transparent"),Ht.append(tr),this.container.append(Ht),!Yt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $t(this,yn)}addHighlightArea(){this.container.classList.add("highlightArea")}}yn=new WeakMap;class Ot extends lt{constructor(Yt){super(Yt,{isRenderable:!0,ignoreBorder:!0});Er(this,_n,null)}render(){this.container.classList.add("circleAnnotation");const Yt=this.data,{width:hr,height:Lr}=at(Yt.rect),Ht=this.svgFactory.create(hr,Lr,!0),Xt=Yt.borderStyle.width,tr=Tr(this,_n,this.svgFactory.createElement("svg:ellipse"));return tr.setAttribute("cx",hr/2),tr.setAttribute("cy",Lr/2),tr.setAttribute("rx",hr/2-Xt/2),tr.setAttribute("ry",Lr/2-Xt/2),tr.setAttribute("stroke-width",Xt||1),tr.setAttribute("stroke","transparent"),tr.setAttribute("fill","transparent"),Ht.append(tr),this.container.append(Ht),!Yt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $t(this,_n)}addHighlightArea(){this.container.classList.add("highlightArea")}}_n=new WeakMap;class Bt extends lt{constructor(Yt){super(Yt,{isRenderable:!0,ignoreBorder:!0});Er(this,jr,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Yt=this.data,{width:hr,height:Lr}=at(Yt.rect),Ht=this.svgFactory.create(hr,Lr,!0);let Xt=[];for(const wr of Yt.vertices){const Dr=wr.x-Yt.rect[0],Nr=Yt.rect[3]-wr.y;Xt.push(Dr+","+Nr)}Xt=Xt.join(" ");const tr=Tr(this,jr,this.svgFactory.createElement(this.svgElementName));return tr.setAttribute("points",Xt),tr.setAttribute("stroke-width",Yt.borderStyle.width||1),tr.setAttribute("stroke","transparent"),tr.setAttribute("fill","transparent"),Ht.append(tr),this.container.append(Ht),!Yt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $t(this,jr)}addHighlightArea(){this.container.classList.add("highlightArea")}}jr=new WeakMap;class Ft extends Bt{constructor(Zt){super(Zt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Pt extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Rt extends lt{constructor(Yt){super(Yt,{isRenderable:!0,ignoreBorder:!0});Er(this,cr,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=$.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Yt=this.data,{width:hr,height:Lr}=at(Yt.rect),Ht=this.svgFactory.create(hr,Lr,!0);for(const Xt of Yt.inkLists){let tr=[];for(const Dr of Xt){const Nr=Dr.x-Yt.rect[0],Qr=Yt.rect[3]-Dr.y;tr.push(`${Nr},${Qr}`)}tr=tr.join(" ");const wr=this.svgFactory.createElement(this.svgElementName);$t(this,cr).push(wr),wr.setAttribute("points",tr),wr.setAttribute("stroke-width",Yt.borderStyle.width||1),wr.setAttribute("stroke","transparent"),wr.setAttribute("fill","transparent"),!Yt.popupRef&&this.hasPopupData&&this._createPopup(),Ht.append(wr)}return this.container.append(Ht),this.container}getElementsToTriggerPopup(){return $t(this,cr)}addHighlightArea(){this.container.classList.add("highlightArea")}}cr=new WeakMap,i.InkAnnotationElement=Rt;class Et extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class _t extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Mt extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Dt extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Lt extends lt{constructor(Zt){super(Zt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}i.StampAnnotationElement=Lt;class Ct extends lt{constructor(Yt){var Ht;super(Yt,{isRenderable:!0});Er(this,en);Er(this,Sr,null);const{filename:hr,content:Lr}=this.data.file;this.filename=(0,j.getFilenameFromUrl)(hr,!0),this.content=Lr,(Ht=this.linkService.eventBus)==null||Ht.dispatch("fileattachmentannotation",{source:this,filename:hr,content:Lr})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Yt,data:hr}=this;let Lr;hr.hasAppearance||hr.fillAlpha===0?Lr=document.createElement("div"):(Lr=document.createElement("img"),Lr.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(hr.name)?"paperclip":"pushpin"}.svg`,hr.fillAlpha&&hr.fillAlpha<1&&(Lr.style=`filter: opacity(${Math.round(hr.fillAlpha*100)}%);`)),Lr.addEventListener("dblclick",mr(this,en,Pl).bind(this)),Tr(this,Sr,Lr);const{isMac:Ht}=$.FeatureTest.platform;return Yt.addEventListener("keydown",Xt=>{Xt.key==="Enter"&&(Ht?Xt.metaKey:Xt.ctrlKey)&&mr(this,en,Pl).call(this)}),!hr.popupRef&&this.hasPopupData?this._createPopup():Lr.classList.add("popupTriggerArea"),Yt.append(Lr),Yt}getElementsToTriggerPopup(){return $t(this,Sr)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sr=new WeakMap,en=new WeakSet,Pl=function(){var Yt;(Yt=this.downloadManager)==null||Yt.openOrDownloadData(this.container,this.content,this.filename)};class kt{constructor({div:Zt,accessibilityManager:Yt,annotationCanvasMap:hr,l10n:Lr,page:Ht,viewport:Xt}){Er(this,Xr);Er(this,qr,null);Er(this,rr,null);Er(this,Fr,new Map);this.div=Zt,Tr(this,qr,Yt),Tr(this,rr,hr),this.l10n=Lr,this.page=Ht,this.viewport=Xt,this.zIndex=0,this.l10n||(this.l10n=tt.NullL10n)}async render(Zt){const{annotations:Yt}=Zt,hr=this.div;(0,j.setLayerDimensions)(hr,this.viewport);const Lr=new Map,Ht={data:null,layer:hr,linkService:Zt.linkService,downloadManager:Zt.downloadManager,imageResourcesPath:Zt.imageResourcesPath||"",renderForms:Zt.renderForms!==!1,svgFactory:new j.DOMSVGFactory,annotationStorage:Zt.annotationStorage||new _e.AnnotationStorage,enableScripting:Zt.enableScripting===!0,hasJSActions:Zt.hasJSActions,fieldObjects:Zt.fieldObjects,parent:this,elements:null};for(const Xt of Yt){if(Xt.noHTML)continue;const tr=Xt.annotationType===$.AnnotationType.POPUP;if(tr){const Nr=Lr.get(Xt.id);if(!Nr)continue;Ht.elements=Nr}else{const{width:Nr,height:Qr}=at(Xt.rect);if(Nr<=0||Qr<=0)continue}Ht.data=Xt;const wr=ot.create(Ht);if(!wr.isRenderable)continue;if(!tr&&Xt.popupRef){const Nr=Lr.get(Xt.popupRef);Nr?Nr.push(wr):Lr.set(Xt.popupRef,[wr])}wr.annotationEditorType>0&&$t(this,Fr).set(wr.data.id,wr);const Dr=wr.render();Xt.hidden&&(Dr.style.visibility="hidden"),mr(this,Xr,Au).call(this,Dr,Xt.id)}mr(this,Xr,wl).call(this),await this.l10n.translate(hr)}update({viewport:Zt}){const Yt=this.div;this.viewport=Zt,(0,j.setLayerDimensions)(Yt,{rotation:Zt.rotation}),mr(this,Xr,wl).call(this),Yt.hidden=!1}getEditableAnnotations(){return Array.from($t(this,Fr).values())}getEditableAnnotation(Zt){return $t(this,Fr).get(Zt)}}qr=new WeakMap,rr=new WeakMap,Fr=new WeakMap,Xr=new WeakSet,Au=function(Zt,Yt){var Lr;const hr=Zt.firstChild||Zt;hr.id=`${$.AnnotationPrefix}${Yt}`,this.div.append(Zt),(Lr=$t(this,qr))==null||Lr.moveElementInDOM(this.div,Zt,hr,!1)},wl=function(){if(!$t(this,rr))return;const Zt=this.div;for(const[Yt,hr]of $t(this,rr)){const Lr=Zt.querySelector(`[data-annotation-id="${Yt}"]`);if(!Lr)continue;const{firstChild:Ht}=Lr;Ht?Ht.nodeName==="CANVAS"?Ht.replaceWith(hr):Ht.before(hr):Lr.append(hr)}$t(this,rr).clear()},i.AnnotationLayer=kt},(o,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function _(_e){return Math.floor(Math.max(0,Math.min(1,_e))*255).toString(16).padStart(2,"0")}function $(_e){return Math.max(0,Math.min(255,255*_e))}class j{static CMYK_G([et,tt,rt,nt]){return["G",1-Math.min(1,.3*et+.59*rt+.11*tt+nt)]}static G_CMYK([et]){return["CMYK",0,0,0,1-et]}static G_RGB([et]){return["RGB",et,et,et]}static G_rgb([et]){return et=$(et),[et,et,et]}static G_HTML([et]){const tt=_(et);return`#${tt}${tt}${tt}`}static RGB_G([et,tt,rt]){return["G",.3*et+.59*tt+.11*rt]}static RGB_rgb(et){return et.map($)}static RGB_HTML(et){return`#${et.map(_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([et,tt,rt,nt]){return["RGB",1-Math.min(1,et+nt),1-Math.min(1,rt+nt),1-Math.min(1,tt+nt)]}static CMYK_rgb([et,tt,rt,nt]){return[$(1-Math.min(1,et+nt)),$(1-Math.min(1,rt+nt)),$(1-Math.min(1,tt+nt))]}static CMYK_HTML(et){const tt=this.CMYK_RGB(et).slice(1);return this.RGB_HTML(tt)}static RGB_CMYK([et,tt,rt]){const nt=1-et,it=1-tt,st=1-rt,at=Math.min(nt,it,st);return["CMYK",nt,it,st,at]}}i.ColorConverters=j},(o,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NullL10n=void 0,i.getL10nFallback=$;const _={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};_.print_progress_percent="{{progress}}%";function $(et,tt){switch(et){case"find_match_count":et=`find_match_count[${tt.total===1?"one":"other"}]`;break;case"find_match_count_limit":et=`find_match_count_limit[${tt.limit===1?"one":"other"}]`;break}return _[et]||""}function j(et,tt){return tt?et.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(rt,nt)=>nt in tt?tt[nt]:"{{"+nt+"}}"):et}const _e={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(et,tt=null,rt=$(et,tt)){return j(rt,tt)},async translate(et){}};i.NullL10n=_e},(o,i,_)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var $=_(25);class j{static setupStorage(et,tt,rt,nt,it){const st=nt.getValue(tt,{value:null});switch(rt.name){case"textarea":if(st.value!==null&&(et.textContent=st.value),it==="print")break;et.addEventListener("input",at=>{nt.setValue(tt,{value:at.target.value})});break;case"input":if(rt.attributes.type==="radio"||rt.attributes.type==="checkbox"){if(st.value===rt.attributes.xfaOn?et.setAttribute("checked",!0):st.value===rt.attributes.xfaOff&&et.removeAttribute("checked"),it==="print")break;et.addEventListener("change",at=>{nt.setValue(tt,{value:at.target.checked?at.target.getAttribute("xfaOn"):at.target.getAttribute("xfaOff")})})}else{if(st.value!==null&&et.setAttribute("value",st.value),it==="print")break;et.addEventListener("input",at=>{nt.setValue(tt,{value:at.target.value})})}break;case"select":if(st.value!==null){et.setAttribute("value",st.value);for(const at of rt.children)at.attributes.value===st.value?at.attributes.selected=!0:at.attributes.hasOwnProperty("selected")&&delete at.attributes.selected}et.addEventListener("input",at=>{const ot=at.target.options,lt=ot.selectedIndex===-1?"":ot[ot.selectedIndex].value;nt.setValue(tt,{value:lt})});break}}static setAttributes({html:et,element:tt,storage:rt=null,intent:nt,linkService:it}){const{attributes:st}=tt,at=et instanceof HTMLAnchorElement;st.type==="radio"&&(st.name=`${st.name}-${nt}`);for(const[ot,lt]of Object.entries(st))if(lt!=null)switch(ot){case"class":lt.length&&et.setAttribute(ot,lt.join(" "));break;case"dataId":break;case"id":et.setAttribute("data-element-id",lt);break;case"style":Object.assign(et.style,lt);break;case"textContent":et.textContent=lt;break;default:(!at||ot!=="href"&&ot!=="newWindow")&&et.setAttribute(ot,lt)}at&&it.addLinkAttributes(et,st.href,st.newWindow),rt&&st.dataId&&this.setupStorage(et,st.dataId,tt,rt)}static render(et){var ct;const tt=et.annotationStorage,rt=et.linkService,nt=et.xfaHtml,it=et.intent||"display",st=document.createElement(nt.name);nt.attributes&&this.setAttributes({html:st,element:nt,intent:it,linkService:rt});const at=[[nt,-1,st]],ot=et.div;if(ot.append(st),et.viewport){const ft=`matrix(${et.viewport.transform.join(",")})`;ot.style.transform=ft}it!=="richText"&&ot.setAttribute("class","xfaLayer xfaFont");const lt=[];for(;at.length>0;){const[ft,ut,ht]=at.at(-1);if(ut+1===ft.children.length){at.pop();continue}const dt=ft.children[++at.at(-1)[1]];if(dt===null)continue;const{name:mt}=dt;if(mt==="#text"){const yt=document.createTextNode(dt.value);lt.push(yt),ht.append(yt);continue}const pt=(ct=dt==null?void 0:dt.attributes)!=null&&ct.xmlns?document.createElementNS(dt.attributes.xmlns,mt):document.createElement(mt);if(ht.append(pt),dt.attributes&&this.setAttributes({html:pt,element:dt,storage:tt,intent:it,linkService:rt}),dt.children&&dt.children.length>0)at.push([dt,-1,pt]);else if(dt.value){const yt=document.createTextNode(dt.value);$.XfaText.shouldBuildText(mt)&&lt.push(yt),pt.append(yt)}}for(const ft of ot.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))ft.setAttribute("readOnly",!0);return{textDivs:lt}}static update(et){const tt=`matrix(${et.viewport.transform.join(",")})`;et.div.style.transform=tt,et.div.hidden=!1}}i.XfaLayer=j},(o,i,_)=>{var nt,it,st,at,ot,lt,ct,ft,ut,ht,dt,mt,pt,yt,gt,Pu,wu,Cu,Ru,Cl,Iu,Rl,ku,Lu,$u,Ou,Du,ts,Il,so,ao,_s,Ll,oo,zt,Mu,$l,Fu,Nu,Ol,lo,xs;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0;var $=_(1),j=_(4),_e=_(29),et=_(6),tt=_(5);const Ar=class Ar extends j.AnnotationEditor{constructor(Gt){super({...Gt,name:"inkEditor"});Er(this,gt);Er(this,nt,0);Er(this,it,0);Er(this,st,this.canvasPointermove.bind(this));Er(this,at,this.canvasPointerleave.bind(this));Er(this,ot,this.canvasPointerup.bind(this));Er(this,lt,this.canvasPointerdown.bind(this));Er(this,ct,new Path2D);Er(this,ft,!1);Er(this,ut,!1);Er(this,ht,!1);Er(this,dt,null);Er(this,mt,0);Er(this,pt,0);Er(this,yt,null);this.color=Gt.color||null,this.thickness=Gt.thickness||null,this.opacity=Gt.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Gt){j.AnnotationEditor.initialize(Gt,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Gt,Jt){switch(Gt){case $.AnnotationEditorParamsType.INK_THICKNESS:Ar._defaultThickness=Jt;break;case $.AnnotationEditorParamsType.INK_COLOR:Ar._defaultColor=Jt;break;case $.AnnotationEditorParamsType.INK_OPACITY:Ar._defaultOpacity=Jt/100;break}}updateParams(Gt,Jt){switch(Gt){case $.AnnotationEditorParamsType.INK_THICKNESS:mr(this,gt,Pu).call(this,Jt);break;case $.AnnotationEditorParamsType.INK_COLOR:mr(this,gt,wu).call(this,Jt);break;case $.AnnotationEditorParamsType.INK_OPACITY:mr(this,gt,Cu).call(this,Jt);break}}static get defaultPropertiesToUpdate(){return[[$.AnnotationEditorParamsType.INK_THICKNESS,Ar._defaultThickness],[$.AnnotationEditorParamsType.INK_COLOR,Ar._defaultColor||j.AnnotationEditor._defaultLineColor],[$.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ar._defaultOpacity*100)]]}get propertiesToUpdate(){return[[$.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ar._defaultThickness],[$.AnnotationEditorParamsType.INK_COLOR,this.color||Ar._defaultColor||j.AnnotationEditor._defaultLineColor],[$.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ar._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(mr(this,gt,so).call(this),mr(this,gt,ao).call(this)),this.isAttachedToDOM||(this.parent.add(this),mr(this,gt,_s).call(this)),mr(this,gt,xs).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,$t(this,dt).disconnect(),Tr(this,dt,null),super.remove())}setParent(Gt){!this.parent&&Gt?this._uiManager.removeShouldRescale(this):this.parent&&Gt===null&&this._uiManager.addShouldRescale(this),super.setParent(Gt)}onScaleChanging(){const[Gt,Jt]=this.parentDimensions,lr=this.width*Gt,dr=this.height*Jt;this.setDimensions(lr,dr)}enableEditMode(){$t(this,ft)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",$t(this,lt)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",$t(this,lt)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){$t(this,ft)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Tr(this,ft,!0),this.div.classList.add("disabled"),mr(this,gt,xs).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Gt){this._focusEventsAllowed&&(super.focusin(Gt),this.enableEditMode())}canvasPointerdown(Gt){Gt.button!==0||!this.isInEditMode()||$t(this,ft)||(this.setInForeground(),Gt.preventDefault(),Gt.type!=="mouse"&&this.div.focus(),mr(this,gt,Iu).call(this,Gt.offsetX,Gt.offsetY))}canvasPointermove(Gt){Gt.preventDefault(),mr(this,gt,Rl).call(this,Gt.offsetX,Gt.offsetY)}canvasPointerup(Gt){Gt.preventDefault(),mr(this,gt,Il).call(this,Gt)}canvasPointerleave(Gt){mr(this,gt,Il).call(this,Gt)}get isResizable(){return!this.isEmpty()&&$t(this,ft)}render(){if(this.div)return this.div;let Gt,Jt;this.width&&(Gt=this.x,Jt=this.y),super.render(),j.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Or=>{var fr;return(fr=this.div)==null?void 0:fr.setAttribute("aria-label",Or)});const[lr,dr,xr,Mr]=mr(this,gt,Ru).call(this);if(this.setAt(lr,dr,0,0),this.setDims(xr,Mr),mr(this,gt,so).call(this),this.width){const[Or,fr]=this.parentDimensions;this.setAspectRatio(this.width*Or,this.height*fr),this.setAt(Gt*Or,Jt*fr,this.width*Or,this.height*fr),Tr(this,ht,!0),mr(this,gt,_s).call(this),this.setDims(this.width*Or,this.height*fr),mr(this,gt,ts).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return mr(this,gt,ao).call(this),this.div}setDimensions(Gt,Jt){const lr=Math.round(Gt),dr=Math.round(Jt);if($t(this,mt)===lr&&$t(this,pt)===dr)return;Tr(this,mt,lr),Tr(this,pt,dr),this.canvas.style.visibility="hidden";const[xr,Mr]=this.parentDimensions;this.width=Gt/xr,this.height=Jt/Mr,this.fixAndSetPosition(),$t(this,ft)&&mr(this,gt,Ll).call(this,Gt,Jt),mr(this,gt,_s).call(this),mr(this,gt,ts).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Gt,Jt,lr){var an,yn,_n;if(Gt instanceof _e.InkAnnotationElement)return null;const dr=super.deserialize(Gt,Jt,lr);dr.thickness=Gt.thickness,dr.color=$.Util.makeHexColor(...Gt.color),dr.opacity=Gt.opacity;const[xr,Mr]=dr.pageDimensions,Or=dr.width*xr,fr=dr.height*Mr,Hr=dr.parentScale,Gr=Gt.thickness/2;Tr(dr,ft,!0),Tr(dr,mt,Math.round(Or)),Tr(dr,pt,Math.round(fr));const{paths:dn,rect:nn,rotation:vn}=Gt;for(let{bezier:jr}of dn){jr=mr(an=Ar,zt,Fu).call(an,jr,nn,vn);const cr=[];dr.paths.push(cr);let Sr=Hr*(jr[0]-Gr),en=Hr*(jr[1]-Gr);for(let qr=2,rr=jr.length;qr<rr;qr+=6){const Fr=Hr*(jr[qr]-Gr),Xr=Hr*(jr[qr+1]-Gr),un=Hr*(jr[qr+2]-Gr),hn=Hr*(jr[qr+3]-Gr),rn=Hr*(jr[qr+4]-Gr),Zt=Hr*(jr[qr+5]-Gr);cr.push([[Sr,en],[Fr,Xr],[un,hn],[rn,Zt]]),Sr=rn,en=Zt}const bn=mr(this,zt,Mu).call(this,cr);dr.bezierPath2D.push(bn)}const Jr=mr(yn=dr,gt,Ol).call(yn);return Tr(dr,it,Math.max(j.AnnotationEditor.MIN_SIZE,Jr[2]-Jr[0])),Tr(dr,nt,Math.max(j.AnnotationEditor.MIN_SIZE,Jr[3]-Jr[1])),mr(_n=dr,gt,Ll).call(_n,Or,fr),dr}serialize(){if(this.isEmpty())return null;const Gt=this.getRect(0,0),Jt=j.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:$.AnnotationEditorType.INK,color:Jt,thickness:this.thickness,opacity:this.opacity,paths:mr(this,gt,Nu).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Gt),pageIndex:this.pageIndex,rect:Gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};nt=new WeakMap,it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakMap,ht=new WeakMap,dt=new WeakMap,mt=new WeakMap,pt=new WeakMap,yt=new WeakMap,gt=new WeakSet,Pu=function(Gt){const Jt=this.thickness;this.addCommands({cmd:()=>{this.thickness=Gt,mr(this,gt,xs).call(this)},undo:()=>{this.thickness=Jt,mr(this,gt,xs).call(this)},mustExec:!0,type:$.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},wu=function(Gt){const Jt=this.color;this.addCommands({cmd:()=>{this.color=Gt,mr(this,gt,ts).call(this)},undo:()=>{this.color=Jt,mr(this,gt,ts).call(this)},mustExec:!0,type:$.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Cu=function(Gt){Gt/=100;const Jt=this.opacity;this.addCommands({cmd:()=>{this.opacity=Gt,mr(this,gt,ts).call(this)},undo:()=>{this.opacity=Jt,mr(this,gt,ts).call(this)},mustExec:!0,type:$.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Ru=function(){const{parentRotation:Gt,parentDimensions:[Jt,lr]}=this;switch(Gt){case 90:return[0,lr,lr,Jt];case 180:return[Jt,lr,Jt,lr];case 270:return[Jt,0,lr,Jt];default:return[0,0,Jt,lr]}},Cl=function(){const{ctx:Gt,color:Jt,opacity:lr,thickness:dr,parentScale:xr,scaleFactor:Mr}=this;Gt.lineWidth=dr*xr/Mr,Gt.lineCap="round",Gt.lineJoin="round",Gt.miterLimit=10,Gt.strokeStyle=`${Jt}${(0,tt.opacityToHex)(lr)}`},Iu=function(Gt,Jt){this.canvas.addEventListener("contextmenu",et.noContextMenu),this.canvas.addEventListener("pointerleave",$t(this,at)),this.canvas.addEventListener("pointermove",$t(this,st)),this.canvas.addEventListener("pointerup",$t(this,ot)),this.canvas.removeEventListener("pointerdown",$t(this,lt)),this.isEditing=!0,$t(this,ht)||(Tr(this,ht,!0),mr(this,gt,_s).call(this),this.thickness||(this.thickness=Ar._defaultThickness),this.color||(this.color=Ar._defaultColor||j.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ar._defaultOpacity)),this.currentPath.push([Gt,Jt]),Tr(this,ut,!1),mr(this,gt,Cl).call(this),Tr(this,yt,()=>{mr(this,gt,$u).call(this),$t(this,yt)&&window.requestAnimationFrame($t(this,yt))}),window.requestAnimationFrame($t(this,yt))},Rl=function(Gt,Jt){const[lr,dr]=this.currentPath.at(-1);if(this.currentPath.length>1&&Gt===lr&&Jt===dr)return;const xr=this.currentPath;let Mr=$t(this,ct);if(xr.push([Gt,Jt]),Tr(this,ut,!0),xr.length<=2){Mr.moveTo(...xr[0]),Mr.lineTo(Gt,Jt);return}xr.length===3&&(Tr(this,ct,Mr=new Path2D),Mr.moveTo(...xr[0])),mr(this,gt,Ou).call(this,Mr,...xr.at(-3),...xr.at(-2),Gt,Jt)},ku=function(){if(this.currentPath.length===0)return;const Gt=this.currentPath.at(-1);$t(this,ct).lineTo(...Gt)},Lu=function(Gt,Jt){Tr(this,yt,null),Gt=Math.min(Math.max(Gt,0),this.canvas.width),Jt=Math.min(Math.max(Jt,0),this.canvas.height),mr(this,gt,Rl).call(this,Gt,Jt),mr(this,gt,ku).call(this);let lr;if(this.currentPath.length!==1)lr=mr(this,gt,Du).call(this);else{const fr=[Gt,Jt];lr=[[fr,fr.slice(),fr.slice(),fr]]}const dr=$t(this,ct),xr=this.currentPath;this.currentPath=[],Tr(this,ct,new Path2D);const Mr=()=>{this.allRawPaths.push(xr),this.paths.push(lr),this.bezierPath2D.push(dr),this.rebuild()},Or=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(mr(this,gt,so).call(this),mr(this,gt,ao).call(this)),mr(this,gt,xs).call(this))};this.addCommands({cmd:Mr,undo:Or,mustExec:!0})},$u=function(){if(!$t(this,ut))return;Tr(this,ut,!1);const Gt=Math.ceil(this.thickness*this.parentScale),Jt=this.currentPath.slice(-3),lr=Jt.map(Mr=>Mr[0]),dr=Jt.map(Mr=>Mr[1]);Math.min(...lr)-Gt,Math.max(...lr)+Gt,Math.min(...dr)-Gt,Math.max(...dr)+Gt;const{ctx:xr}=this;xr.save(),xr.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Mr of this.bezierPath2D)xr.stroke(Mr);xr.stroke($t(this,ct)),xr.restore()},Ou=function(Gt,Jt,lr,dr,xr,Mr,Or){const fr=(Jt+dr)/2,Hr=(lr+xr)/2,Gr=(dr+Mr)/2,dn=(xr+Or)/2;Gt.bezierCurveTo(fr+2*(dr-fr)/3,Hr+2*(xr-Hr)/3,Gr+2*(dr-Gr)/3,dn+2*(xr-dn)/3,Gr,dn)},Du=function(){const Gt=this.currentPath;if(Gt.length<=2)return[[Gt[0],Gt[0],Gt.at(-1),Gt.at(-1)]];const Jt=[];let lr,[dr,xr]=Gt[0];for(lr=1;lr<Gt.length-2;lr++){const[nn,vn]=Gt[lr],[Jr,an]=Gt[lr+1],yn=(nn+Jr)/2,_n=(vn+an)/2,jr=[dr+2*(nn-dr)/3,xr+2*(vn-xr)/3],cr=[yn+2*(nn-yn)/3,_n+2*(vn-_n)/3];Jt.push([[dr,xr],jr,cr,[yn,_n]]),[dr,xr]=[yn,_n]}const[Mr,Or]=Gt[lr],[fr,Hr]=Gt[lr+1],Gr=[dr+2*(Mr-dr)/3,xr+2*(Or-xr)/3],dn=[fr+2*(Mr-fr)/3,Hr+2*(Or-Hr)/3];return Jt.push([[dr,xr],Gr,dn,[fr,Hr]]),Jt},ts=function(){if(this.isEmpty()){mr(this,gt,oo).call(this);return}mr(this,gt,Cl).call(this);const{canvas:Gt,ctx:Jt}=this;Jt.setTransform(1,0,0,1,0,0),Jt.clearRect(0,0,Gt.width,Gt.height),mr(this,gt,oo).call(this);for(const lr of this.bezierPath2D)Jt.stroke(lr)},Il=function(Gt){this.canvas.removeEventListener("pointerleave",$t(this,at)),this.canvas.removeEventListener("pointermove",$t(this,st)),this.canvas.removeEventListener("pointerup",$t(this,ot)),this.canvas.addEventListener("pointerdown",$t(this,lt)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",et.noContextMenu)},10),mr(this,gt,Lu).call(this,Gt.offsetX,Gt.offsetY),this.addToAnnotationStorage(),this.setInBackground()},so=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",j.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Gt=>{var Jt;return(Jt=this.canvas)==null?void 0:Jt.setAttribute("aria-label",Gt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ao=function(){Tr(this,dt,new ResizeObserver(Gt=>{const Jt=Gt[0].contentRect;Jt.width&&Jt.height&&this.setDimensions(Jt.width,Jt.height)})),$t(this,dt).observe(this.div)},_s=function(){if(!$t(this,ht))return;const[Gt,Jt]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Gt),this.canvas.height=Math.ceil(this.height*Jt),mr(this,gt,oo).call(this)},Ll=function(Gt,Jt){const lr=mr(this,gt,lo).call(this),dr=(Gt-lr)/$t(this,it),xr=(Jt-lr)/$t(this,nt);this.scaleFactor=Math.min(dr,xr)},oo=function(){const Gt=mr(this,gt,lo).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Gt,this.translationY*this.scaleFactor+Gt)},zt=new WeakSet,Mu=function(Gt){const Jt=new Path2D;for(let lr=0,dr=Gt.length;lr<dr;lr++){const[xr,Mr,Or,fr]=Gt[lr];lr===0&&Jt.moveTo(...xr),Jt.bezierCurveTo(Mr[0],Mr[1],Or[0],Or[1],fr[0],fr[1])}return Jt},$l=function(Gt,Jt,lr){const[dr,xr,Mr,Or]=Jt;switch(lr){case 0:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2)Gt[fr]+=dr,Gt[fr+1]=Or-Gt[fr+1];break;case 90:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2){const Gr=Gt[fr];Gt[fr]=Gt[fr+1]+dr,Gt[fr+1]=Gr+xr}break;case 180:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2)Gt[fr]=Mr-Gt[fr],Gt[fr+1]+=xr;break;case 270:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2){const Gr=Gt[fr];Gt[fr]=Mr-Gt[fr+1],Gt[fr+1]=Or-Gr}break;default:throw new Error("Invalid rotation")}return Gt},Fu=function(Gt,Jt,lr){const[dr,xr,Mr,Or]=Jt;switch(lr){case 0:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2)Gt[fr]-=dr,Gt[fr+1]=Or-Gt[fr+1];break;case 90:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2){const Gr=Gt[fr];Gt[fr]=Gt[fr+1]-xr,Gt[fr+1]=Gr-dr}break;case 180:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2)Gt[fr]=Mr-Gt[fr],Gt[fr+1]-=xr;break;case 270:for(let fr=0,Hr=Gt.length;fr<Hr;fr+=2){const Gr=Gt[fr];Gt[fr]=Or-Gt[fr+1],Gt[fr+1]=Mr-Gr}break;default:throw new Error("Invalid rotation")}return Gt},Nu=function(Gt,Jt,lr,dr){var Hr,Gr;const xr=[],Mr=this.thickness/2,Or=Gt*Jt+Mr,fr=Gt*lr+Mr;for(const dn of this.paths){const nn=[],vn=[];for(let Jr=0,an=dn.length;Jr<an;Jr++){const[yn,_n,jr,cr]=dn[Jr],Sr=Gt*yn[0]+Or,en=Gt*yn[1]+fr,bn=Gt*_n[0]+Or,qr=Gt*_n[1]+fr,rr=Gt*jr[0]+Or,Fr=Gt*jr[1]+fr,Xr=Gt*cr[0]+Or,un=Gt*cr[1]+fr;Jr===0&&(nn.push(Sr,en),vn.push(Sr,en)),nn.push(bn,qr,rr,Fr,Xr,un),vn.push(bn,qr),Jr===an-1&&vn.push(Xr,un)}xr.push({bezier:mr(Hr=Ar,zt,$l).call(Hr,nn,dr,this.rotation),points:mr(Gr=Ar,zt,$l).call(Gr,vn,dr,this.rotation)})}return xr},Ol=function(){let Gt=1/0,Jt=-1/0,lr=1/0,dr=-1/0;for(const xr of this.paths)for(const[Mr,Or,fr,Hr]of xr){const Gr=$.Util.bezierBoundingBox(...Mr,...Or,...fr,...Hr);Gt=Math.min(Gt,Gr[0]),lr=Math.min(lr,Gr[1]),Jt=Math.max(Jt,Gr[2]),dr=Math.max(dr,Gr[3])}return[Gt,lr,Jt,dr]},lo=function(){return $t(this,ft)?Math.ceil(this.thickness*this.parentScale):0},xs=function(Gt=!1){if(this.isEmpty())return;if(!$t(this,ft)){mr(this,gt,ts).call(this);return}const Jt=mr(this,gt,Ol).call(this),lr=mr(this,gt,lo).call(this);Tr(this,it,Math.max(j.AnnotationEditor.MIN_SIZE,Jt[2]-Jt[0])),Tr(this,nt,Math.max(j.AnnotationEditor.MIN_SIZE,Jt[3]-Jt[1]));const dr=Math.ceil(lr+$t(this,it)*this.scaleFactor),xr=Math.ceil(lr+$t(this,nt)*this.scaleFactor),[Mr,Or]=this.parentDimensions;this.width=dr/Mr,this.height=xr/Or,this.setAspectRatio(dr,xr);const fr=this.translationX,Hr=this.translationY;this.translationX=-Jt[0],this.translationY=-Jt[1],mr(this,gt,_s).call(this),mr(this,gt,ts).call(this),Tr(this,mt,dr),Tr(this,pt,xr),this.setDims(dr,xr);const Gr=Gt?lr/this.scaleFactor/2:0;this.translate(fr-this.translationX-Gr,Hr-this.translationY-Gr)},Er(Ar,zt),Rn(Ar,"_defaultColor",null),Rn(Ar,"_defaultOpacity",1),Rn(Ar,"_defaultThickness",1),Rn(Ar,"_type","ink");let rt=Ar;i.InkEditor=rt},(o,i,_)=>{var rt,nt,it,st,at,ot,lt,ct,ft,ut,ht,Bs,Us,co,Dl,ju,Bu,Ml,uo,Uu;Object.defineProperty(i,"__esModule",{value:!0}),i.StampEditor=void 0;var $=_(1),j=_(4),_e=_(6),et=_(29);const wt=class wt extends j.AnnotationEditor{constructor(Ft){super({...Ft,name:"stampEditor"});Er(this,ht);Er(this,rt,null);Er(this,nt,null);Er(this,it,null);Er(this,st,null);Er(this,at,null);Er(this,ot,null);Er(this,lt,null);Er(this,ct,null);Er(this,ft,!1);Er(this,ut,!1);Tr(this,st,Ft.bitmapUrl),Tr(this,at,Ft.bitmapFile)}static initialize(Ft){j.AnnotationEditor.initialize(Ft)}static get supportedTypes(){const Ft=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,$.shadow)(this,"supportedTypes",Ft.map(Pt=>`image/${Pt}`))}static get supportedTypesStr(){return(0,$.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Ft){return this.supportedTypes.includes(Ft)}static paste(Ft,Pt){Pt.pasteEditor($.AnnotationEditorType.STAMP,{bitmapFile:Ft.getAsFile()})}remove(){var Ft,Pt;$t(this,nt)&&(Tr(this,rt,null),this._uiManager.imageManager.deleteId($t(this,nt)),(Ft=$t(this,ot))==null||Ft.remove(),Tr(this,ot,null),(Pt=$t(this,lt))==null||Pt.disconnect(),Tr(this,lt,null)),super.remove()}rebuild(){if(!this.parent){$t(this,nt)&&mr(this,ht,co).call(this);return}super.rebuild(),this.div!==null&&($t(this,nt)&&mr(this,ht,co).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!($t(this,it)||$t(this,rt)||$t(this,st)||$t(this,at))}get isResizable(){return!0}render(){if(this.div)return this.div;let Ft,Pt;if(this.width&&(Ft=this.x,Pt=this.y),super.render(),this.div.hidden=!0,$t(this,rt)?mr(this,ht,Dl).call(this):mr(this,ht,co).call(this),this.width){const[Rt,Et]=this.parentDimensions;this.setAt(Ft*Rt,Pt*Et,this.width*Rt,this.height*Et)}return this.div}static deserialize(Ft,Pt,Rt){if(Ft instanceof et.StampAnnotationElement)return null;const Et=super.deserialize(Ft,Pt,Rt),{rect:_t,bitmapUrl:Mt,bitmapId:Dt,isSvg:Lt,accessibilityData:Ct}=Ft;Dt&&Rt.imageManager.isValidId(Dt)?Tr(Et,nt,Dt):Tr(Et,st,Mt),Tr(Et,ft,Lt);const[kt,jt]=Et.pageDimensions;return Et.width=(_t[2]-_t[0])/kt,Et.height=(_t[3]-_t[1])/jt,Ct&&(Et.altTextData=Ct),Et}serialize(Ft=!1,Pt=null){if(this.isEmpty())return null;const Rt={annotationType:$.AnnotationEditorType.STAMP,bitmapId:$t(this,nt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:$t(this,ft),structTreeParentId:this._structTreeParentId};if(Ft)return Rt.bitmapUrl=mr(this,ht,uo).call(this,!0),Rt.accessibilityData=this.altTextData,Rt;const{decorative:Et,altText:_t}=this.altTextData;if(!Et&&_t&&(Rt.accessibilityData={type:"Figure",alt:_t}),Pt===null)return Rt;Pt.stamps||(Pt.stamps=new Map);const Mt=$t(this,ft)?(Rt.rect[2]-Rt.rect[0])*(Rt.rect[3]-Rt.rect[1]):null;if(!Pt.stamps.has($t(this,nt)))Pt.stamps.set($t(this,nt),{area:Mt,serialized:Rt}),Rt.bitmap=mr(this,ht,uo).call(this,!1);else if($t(this,ft)){const Dt=Pt.stamps.get($t(this,nt));Mt>Dt.area&&(Dt.area=Mt,Dt.serialized.bitmap.close(),Dt.serialized.bitmap=mr(this,ht,uo).call(this,!1))}return Rt}};rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ft=new WeakMap,ut=new WeakMap,ht=new WeakSet,Bs=function(Ft,Pt=!1){if(!Ft){this.remove();return}Tr(this,rt,Ft.bitmap),Pt||(Tr(this,nt,Ft.id),Tr(this,ft,Ft.isSvg)),mr(this,ht,Dl).call(this)},Us=function(){Tr(this,it,null),this._uiManager.enableWaiting(!1),$t(this,ot)&&this.div.focus()},co=function(){if($t(this,nt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId($t(this,nt)).then(Pt=>mr(this,ht,Bs).call(this,Pt,!0)).finally(()=>mr(this,ht,Us).call(this));return}if($t(this,st)){const Pt=$t(this,st);Tr(this,st,null),this._uiManager.enableWaiting(!0),Tr(this,it,this._uiManager.imageManager.getFromUrl(Pt).then(Rt=>mr(this,ht,Bs).call(this,Rt)).finally(()=>mr(this,ht,Us).call(this)));return}if($t(this,at)){const Pt=$t(this,at);Tr(this,at,null),this._uiManager.enableWaiting(!0),Tr(this,it,this._uiManager.imageManager.getFromFile(Pt).then(Rt=>mr(this,ht,Bs).call(this,Rt)).finally(()=>mr(this,ht,Us).call(this)));return}const Ft=document.createElement("input");Ft.type="file",Ft.accept=wt.supportedTypesStr,Tr(this,it,new Promise(Pt=>{Ft.addEventListener("change",async()=>{if(!Ft.files||Ft.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Rt=await this._uiManager.imageManager.getFromFile(Ft.files[0]);mr(this,ht,Bs).call(this,Rt)}Pt()}),Ft.addEventListener("cancel",()=>{this.remove(),Pt()})}).finally(()=>mr(this,ht,Us).call(this))),Ft.click()},Dl=function(){const{div:Ft}=this;let{width:Pt,height:Rt}=$t(this,rt);const[Et,_t]=this.pageDimensions,Mt=.75;if(this.width)Pt=this.width*Et,Rt=this.height*_t;else if(Pt>Mt*Et||Rt>Mt*_t){const kt=Math.min(Mt*Et/Pt,Mt*_t/Rt);Pt*=kt,Rt*=kt}const[Dt,Lt]=this.parentDimensions;this.setDims(Pt*Dt/Et,Rt*Lt/_t),this._uiManager.enableWaiting(!1);const Ct=Tr(this,ot,document.createElement("canvas"));Ft.append(Ct),Ft.hidden=!1,mr(this,ht,Ml).call(this,Pt,Rt),mr(this,ht,Uu).call(this),$t(this,ut)||(this.parent.addUndoableEditor(this),Tr(this,ut,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},ju=function(Ft,Pt){var Mt;const[Rt,Et]=this.parentDimensions;this.width=Ft/Rt,this.height=Pt/Et,this.setDims(Ft,Pt),(Mt=this._initialOptions)!=null&&Mt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,$t(this,ct)!==null&&clearTimeout($t(this,ct)),Tr(this,ct,setTimeout(()=>{Tr(this,ct,null),mr(this,ht,Ml).call(this,Ft,Pt)},200))},Bu=function(Ft,Pt){const{width:Rt,height:Et}=$t(this,rt);let _t=Rt,Mt=Et,Dt=$t(this,rt);for(;_t>2*Ft||Mt>2*Pt;){const Lt=_t,Ct=Mt;_t>2*Ft&&(_t=_t>=16384?Math.floor(_t/2)-1:Math.ceil(_t/2)),Mt>2*Pt&&(Mt=Mt>=16384?Math.floor(Mt/2)-1:Math.ceil(Mt/2));const kt=new OffscreenCanvas(_t,Mt);kt.getContext("2d").drawImage(Dt,0,0,Lt,Ct,0,0,_t,Mt),Dt=kt.transferToImageBitmap()}return Dt},Ml=function(Ft,Pt){Ft=Math.ceil(Ft),Pt=Math.ceil(Pt);const Rt=$t(this,ot);if(!Rt||Rt.width===Ft&&Rt.height===Pt)return;Rt.width=Ft,Rt.height=Pt;const Et=$t(this,ft)?$t(this,rt):mr(this,ht,Bu).call(this,Ft,Pt),_t=Rt.getContext("2d");_t.filter=this._uiManager.hcmFilter,_t.drawImage(Et,0,0,Et.width,Et.height,0,0,Ft,Pt)},uo=function(Ft){if(Ft){if($t(this,ft)){const Et=this._uiManager.imageManager.getSvgUrl($t(this,nt));if(Et)return Et}const Pt=document.createElement("canvas");return{width:Pt.width,height:Pt.height}=$t(this,rt),Pt.getContext("2d").drawImage($t(this,rt),0,0),Pt.toDataURL()}if($t(this,ft)){const[Pt,Rt]=this.pageDimensions,Et=Math.round(this.width*Pt*_e.PixelsPerInch.PDF_TO_CSS_UNITS),_t=Math.round(this.height*Rt*_e.PixelsPerInch.PDF_TO_CSS_UNITS),Mt=new OffscreenCanvas(Et,_t);return Mt.getContext("2d").drawImage($t(this,rt),0,0,$t(this,rt).width,$t(this,rt).height,0,0,Et,_t),Mt.transferToImageBitmap()}return structuredClone($t(this,rt))},Uu=function(){Tr(this,lt,new ResizeObserver(Ft=>{const Pt=Ft[0].contentRect;Pt.width&&Pt.height&&mr(this,ht,ju).call(this,Pt.width,Pt.height)})),$t(this,lt).observe(this.div)},Rn(wt,"_type","stamp");let tt=wt;i.StampEditor=tt}],__webpack_module_cache__={};function __w_pdfjs_require__(o){var i=__webpack_module_cache__[o];if(i!==void 0)return i.exports;var _=__webpack_module_cache__[o]={exports:{}};return __webpack_modules__[o](_,_.exports,__w_pdfjs_require__),_.exports}var __webpack_exports__={};return(()=>{var o=__webpack_exports__;Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(o,"AnnotationEditorLayer",{enumerable:!0,get:function(){return _e.AnnotationEditorLayer}}),Object.defineProperty(o,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(o,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(o,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return et.AnnotationEditorUIManager}}),Object.defineProperty(o,"AnnotationLayer",{enumerable:!0,get:function(){return tt.AnnotationLayer}}),Object.defineProperty(o,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(o,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(o,"DOMSVGFactory",{enumerable:!0,get:function(){return $.DOMSVGFactory}}),Object.defineProperty(o,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(o,"GlobalWorkerOptions",{enumerable:!0,get:function(){return rt.GlobalWorkerOptions}}),Object.defineProperty(o,"ImageKind",{enumerable:!0,get:function(){return i.ImageKind}}),Object.defineProperty(o,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(o,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(o,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(o,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _.PDFDataRangeTransport}}),Object.defineProperty(o,"PDFDateString",{enumerable:!0,get:function(){return $.PDFDateString}}),Object.defineProperty(o,"PDFWorker",{enumerable:!0,get:function(){return _.PDFWorker}}),Object.defineProperty(o,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(o,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(o,"PixelsPerInch",{enumerable:!0,get:function(){return $.PixelsPerInch}}),Object.defineProperty(o,"PromiseCapability",{enumerable:!0,get:function(){return i.PromiseCapability}}),Object.defineProperty(o,"RenderingCancelledException",{enumerable:!0,get:function(){return $.RenderingCancelledException}}),Object.defineProperty(o,"SVGGraphics",{enumerable:!0,get:function(){return _.SVGGraphics}}),Object.defineProperty(o,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(o,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(o,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(o,"XfaLayer",{enumerable:!0,get:function(){return nt.XfaLayer}}),Object.defineProperty(o,"build",{enumerable:!0,get:function(){return _.build}}),Object.defineProperty(o,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(o,"getDocument",{enumerable:!0,get:function(){return _.getDocument}}),Object.defineProperty(o,"getFilenameFromUrl",{enumerable:!0,get:function(){return $.getFilenameFromUrl}}),Object.defineProperty(o,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return $.getPdfFilenameFromUrl}}),Object.defineProperty(o,"getXfaPageViewport",{enumerable:!0,get:function(){return $.getXfaPageViewport}}),Object.defineProperty(o,"isDataScheme",{enumerable:!0,get:function(){return $.isDataScheme}}),Object.defineProperty(o,"isPdfFile",{enumerable:!0,get:function(){return $.isPdfFile}}),Object.defineProperty(o,"loadScript",{enumerable:!0,get:function(){return $.loadScript}}),Object.defineProperty(o,"noContextMenu",{enumerable:!0,get:function(){return $.noContextMenu}}),Object.defineProperty(o,"normalizeUnicode",{enumerable:!0,get:function(){return i.normalizeUnicode}}),Object.defineProperty(o,"renderTextLayer",{enumerable:!0,get:function(){return j.renderTextLayer}}),Object.defineProperty(o,"setLayerDimensions",{enumerable:!0,get:function(){return $.setLayerDimensions}}),Object.defineProperty(o,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(o,"updateTextLayer",{enumerable:!0,get:function(){return j.updateTextLayer}}),Object.defineProperty(o,"version",{enumerable:!0,get:function(){return _.version}});var i=__w_pdfjs_require__(1),_=__w_pdfjs_require__(2),$=__w_pdfjs_require__(6),j=__w_pdfjs_require__(26),_e=__w_pdfjs_require__(27),et=__w_pdfjs_require__(5),tt=__w_pdfjs_require__(29),rt=__w_pdfjs_require__(14),nt=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$3);var pdfExports=pdf$3.exports;const pdf$2=getDefaultExportFromCjs$1(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf$2},[pdfExports]),pdfjs="default"in pdfjsModule?pdf$2:pdfjsModule;var __spreadArray=function(o,i,_){if(_||arguments.length===2)for(var $=0,j=i.length,_e;$<j;$++)(_e||!($ in i))&&(_e||(_e=Array.prototype.slice.call(i,0,$)),_e[$]=i[$]);return o.concat(_e||Array.prototype.slice.call(i))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(o,i){var _={};return allEvents.forEach(function($){var j=o[$];j&&(i?_[$]=function(_e){return j(_e,i($))}:_[$]=j)}),_}function makeCancellablePromise(o){var i=!1,_=new Promise(function($,j){o.then(function(_e){return!i&&$(_e)}).catch(function(_e){return!i&&j(_e)})});return{promise:_,cancel:function(){i=!0}}}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs$1(warning_1);var has=Object.prototype.hasOwnProperty;function find(o,i,_){for(_ of o.keys())if(dequal(_,i))return _}function dequal(o,i){var _,$,j;if(o===i)return!0;if(o&&i&&(_=o.constructor)===i.constructor){if(_===Date)return o.getTime()===i.getTime();if(_===RegExp)return o.toString()===i.toString();if(_===Array){if(($=o.length)===i.length)for(;$--&&dequal(o[$],i[$]););return $===-1}if(_===Set){if(o.size!==i.size)return!1;for($ of o)if(j=$,j&&typeof j=="object"&&(j=find(i,j),!j)||!i.has(j))return!1;return!0}if(_===Map){if(o.size!==i.size)return!1;for($ of o)if(j=$[0],j&&typeof j=="object"&&(j=find(i,j),!j)||!dequal($[1],i.get(j)))return!1;return!0}if(_===ArrayBuffer)o=new Uint8Array(o),i=new Uint8Array(i);else if(_===DataView){if(($=o.byteLength)===i.byteLength)for(;$--&&o.getInt8($)===i.getInt8($););return $===-1}if(ArrayBuffer.isView(o)){if(($=o.byteLength)===i.byteLength)for(;$--&&o[$]===i[$];);return $===-1}if(!_||typeof o=="object"){$=0;for(_ in o)if(has.call(o,_)&&++$&&!has.call(i,_)||!(_ in i)||!dequal(o[_],i[_]))return!1;return Object.keys(i).length===$}}return o!==o&&i!==i}const DocumentContext=reactExports.createContext(null);function Message({children:o,type:i}){return React$2.createElement("div",{className:`react-pdf__message react-pdf__message--${i}`},o)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(i){this.pdfDocument=i}setViewer(i){this.pdfViewer=i}setExternalLinkRel(i){this.externalLinkRel=i}setExternalLinkTarget(i){this.externalLinkTarget=i}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(i){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=i}get rotation(){return 0}set rotation(i){}goToDestination(i){return new Promise(_=>{invariant(this.pdfDocument),invariant(i),typeof i=="string"?this.pdfDocument.getDestination(i).then(_):Array.isArray(i)?_(i):i.then(_)}).then(_=>{invariant(Array.isArray(_));const $=_[0];new Promise(j=>{invariant(this.pdfDocument),$ instanceof Object?this.pdfDocument.getPageIndex($).then(_e=>{j(_e)}).catch(()=>{invariant(!1)}):typeof $=="number"?j($):invariant(!1)}).then(j=>{const _e=j+1;invariant(this.pdfViewer),invariant(_e>=1&&_e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:_,pageIndex:j,pageNumber:_e})})})}navigateTo(i){this.goToDestination(i)}goToPage(i){const _=i-1;invariant(this.pdfViewer),invariant(i>=1&&i<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:_,pageNumber:i})}addLinkAttributes(i,_,$){i.href=_,i.rel=this.externalLinkRel||DEFAULT_LINK_REL,i.target=$?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser$1=typeof document<"u",isLocalFileSystem=isBrowser$1&&window.location.protocol==="file:";function isDefined(o){return typeof o<"u"}function isProvided(o){return isDefined(o)&&o!==null}function isString$1(o){return typeof o=="string"}function isArrayBuffer(o){return o instanceof ArrayBuffer}function isBlob(o){return invariant(isBrowser$1),o instanceof Blob}function isDataURI(o){return isString$1(o)&&/^data:/.test(o)}function dataURItoByteString(o){invariant(isDataURI(o));const[i="",_=""]=o.split(",");return i.split(";").indexOf("base64")!==-1?atob(_):unescape(_)}function getDevicePixelRatio(){return isBrowser$1&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(o){o&&o.cancel&&o.cancel()}function makePageCallback(o,i){return Object.defineProperty(o,"width",{get(){return this.view[2]*i},configurable:!0}),Object.defineProperty(o,"height",{get(){return this.view[3]*i},configurable:!0}),Object.defineProperty(o,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(o,"originalHeight",{get(){return this.view[3]},configurable:!0}),o}function isCancelException(o){return o.name==="RenderingCancelledException"}function loadFromFile(o){return new Promise((i,_)=>{const $=new FileReader;$.onload=()=>{if(!$.result)return _(new Error("Error while reading a file."));i($.result)},$.onerror=j=>{if(!j.target)return _(new Error("Error while reading a file."));const{error:_e}=j.target;if(!_e)return _(new Error("Error while reading a file."));switch(_e.code){case _e.NOT_FOUND_ERR:return _(new Error("Error while reading a file: File not found."));case _e.SECURITY_ERR:return _(new Error("Error while reading a file: Security error."));case _e.ABORT_ERR:return _(new Error("Error while reading a file: Aborted."));default:return _(new Error("Error while reading a file."))}},$.readAsArrayBuffer(o)})}function reducer(o,i){switch(i.type){case"RESOLVE":return{value:i.value,error:void 0};case"REJECT":return{value:!1,error:i.error};case"RESET":return{value:void 0,error:void 0};default:return o}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const o={};return allEvents.forEach(i=>{o[i]=PropTypes.func}),o})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function o(i,_,$){const{[_]:j,pageNumber:_e,pdf:et}=i;if(!isDefined(et))return null;if(isDefined(j)){if(typeof j!="number")return new Error(`\`${_}\` of type \`${typeof j}\` supplied to \`${$}\`, expected \`number\`.`);if(j<0)return new Error(`Expected \`${_}\` to be greater or equal to 0.`);const{numPages:tt}=et;if(j+1>tt)return new Error(`Expected \`${_}\` to be less or equal to ${tt-1}.`)}else if(!isDefined(_e))return new Error(`\`${_}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${$}\`.`);return null},isPageNumber=function o(i,_,$){const{[_]:j,pageIndex:_e,pdf:et}=i;if(!isDefined(et))return null;if(isDefined(j)){if(typeof j!="number")return new Error(`\`${_}\` of type \`${typeof j}\` supplied to \`${$}\`, expected \`number\`.`);if(j<1)return new Error(`Expected \`${_}\` to be greater or equal to 1.`);const{numPages:tt}=et;if(j>tt)return new Error(`Expected \`${_}\` to be less or equal to ${tt}.`)}else if(!isDefined(_e))return new Error(`\`${_}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${$}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter$8=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})},__rest$3=function(o,i){var _={};for(var $ in o)Object.prototype.hasOwnProperty.call(o,$)&&i.indexOf($)<0&&(_[$]=o[$]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,$=Object.getOwnPropertySymbols(o);j<$.length;j++)i.indexOf($[j])<0&&Object.prototype.propertyIsEnumerable.call(o,$[j])&&(_[$[j]]=o[$[j]]);return _};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(o,i)=>{switch(i){case PasswordResponses.NEED_PASSWORD:{const _=prompt("Enter the password to open this PDF file.");o(_);break}case PasswordResponses.INCORRECT_PASSWORD:{const _=prompt("Invalid password. Please try again.");o(_);break}}};function isParameterObject(o){return typeof o=="object"&&o!==null&&("data"in o||"range"in o||"url"in o)}const Document=reactExports.forwardRef(function o(i,_){var{children:$,className:j,error:_e="Failed to load PDF file.",externalLinkRel:et,externalLinkTarget:tt,file:rt,inputRef:nt,imageResourcesPath:it,loading:st="Loading PDF",noData:at="No PDF file specified.",onItemClick:ot,onLoadError:lt,onLoadProgress:ct,onLoadSuccess:ft,onPassword:ut=defaultOnPassword,onSourceError:ht,onSourceSuccess:dt,options:mt,renderMode:pt,rotate:yt}=i,gt=__rest$3(i,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[vt,St]=useResolver(),{value:At,error:xt}=vt,[wt,Ot]=useResolver(),{value:Bt,error:Ft}=wt,Pt=reactExports.useRef(new LinkService),Rt=reactExports.useRef([]),Et=reactExports.useRef(),_t=reactExports.useRef();reactExports.useEffect(()=>{rt&&rt!==Et.current&&isParameterObject(rt)&&(warning$1(!dequal(rt,Et.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),Et.current=rt)},[rt]),reactExports.useEffect(()=>{mt&&mt!==_t.current&&(warning$1(!dequal(mt,_t.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),_t.current=mt)},[mt]);const Mt=reactExports.useRef({scrollPageIntoView:er=>{const{dest:sr,pageNumber:Gt,pageIndex:Jt=Gt-1}=er;if(ot){ot({dest:sr,pageIndex:Jt,pageNumber:Gt});return}const lr=Rt.current[Jt];if(lr){lr.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${Gt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(_,()=>({linkService:Pt,pages:Rt,viewer:Mt}),[]);function Dt(){dt&&dt()}function Lt(){xt&&(warning$1(!1,xt.toString()),ht&&ht(xt))}function Ct(){St({type:"RESET"})}reactExports.useEffect(Ct,[rt,St]);const kt=reactExports.useCallback(()=>__awaiter$8(this,void 0,void 0,function*(){if(!rt)return null;if(typeof rt=="string")return isDataURI(rt)?{data:dataURItoByteString(rt)}:(displayCORSWarning(),{url:rt});if(rt instanceof PDFDataRangeTransport)return{range:rt};if(isArrayBuffer(rt))return{data:rt};if(isBrowser$1&&isBlob(rt))return{data:yield loadFromFile(rt)};if(invariant(typeof rt=="object"),invariant(isParameterObject(rt)),"url"in rt&&typeof rt.url=="string"){if(isDataURI(rt.url)){const{url:er}=rt,sr=__rest$3(rt,["url"]),Gt=dataURItoByteString(er);return Object.assign({data:Gt},sr)}displayCORSWarning()}return rt}),[rt]);reactExports.useEffect(()=>{const er=makeCancellablePromise(kt());return er.promise.then(sr=>{St({type:"RESOLVE",value:sr})}).catch(sr=>{St({type:"REJECT",error:sr})}),()=>{cancelRunningTask(er)}},[kt,St]),reactExports.useEffect(()=>{if(!(typeof At>"u")){if(At===!1){Lt();return}Dt()}},[At]);function jt(){Bt&&(ft&&ft(Bt),Rt.current=new Array(Bt.numPages),Pt.current.setDocument(Bt))}function Vt(){Ft&&(warning$1(!1,Ft.toString()),lt&&lt(Ft))}function zt(){Ot({type:"RESET"})}reactExports.useEffect(zt,[Ot,At]);function qt(){if(!At)return;const er=Object.assign(Object.assign({},mt),{isEvalSupported:!1}),sr=Object.assign(Object.assign({},At),er),Gt=pdfjs.getDocument(sr);ct&&(Gt.onProgress=ct),ut&&(Gt.onPassword=ut);const Jt=Gt;return Jt.promise.then(lr=>{Ot({type:"RESOLVE",value:lr})}).catch(lr=>{Jt.destroyed||Ot({type:"REJECT",error:lr})}),()=>{Jt.destroy()}}reactExports.useEffect(qt,[mt,Ot,At]),reactExports.useEffect(()=>{if(!(typeof Bt>"u")){if(Bt===!1){Vt();return}jt()}},[Bt]);function Wt(){Pt.current.setViewer(Mt.current),Pt.current.setExternalLinkRel(et),Pt.current.setExternalLinkTarget(tt)}reactExports.useEffect(Wt,[et,tt]);function ir(er,sr){Rt.current[er]=sr}function or(er){delete Rt.current[er]}const Qt=reactExports.useMemo(()=>({imageResourcesPath:it,linkService:Pt.current,onItemClick:ot,pdf:Bt,registerPage:ir,renderMode:pt,rotate:yt,unregisterPage:or}),[it,ot,Bt,pt,yt]),gr=reactExports.useMemo(()=>makeEventProps(gt,()=>Bt),[gt,Bt]);function ar(){return React$2.createElement(DocumentContext.Provider,{value:Qt},$)}function Ar(){return rt?Bt==null?React$2.createElement(Message,{type:"loading"},typeof st=="function"?st():st):Bt===!1?React$2.createElement(Message,{type:"error"},typeof _e=="function"?_e():_e):ar():React$2.createElement(Message,{type:"no-data"},typeof at=="function"?at():at)}return React$2.createElement("div",Object.assign({className:clsx("react-pdf__Document",j),ref:nt,style:{"--scale-factor":"1"}},gr),Ar())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var _=o.filter(Boolean);if(_.length<=1){var $=_[0];return $||null}return function(_e){_.forEach(function(et){typeof et=="function"?et(_e):et&&(et.current=_e)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(o){return o in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(o){return"children"in o}function isStructTreeNodeWithOnlyContentChild(o){return isStructTreeNode(o)?o.children.length===1&&0 in o.children&&"id"in o.children[0]:!1}function getRoleAttributes(o){const i={};if(isStructTreeNode(o)){const{role:_}=o,$=_.match(HEADING_PATTERN);if($)i.role="heading",i["aria-level"]=Number($[1]);else if(isPdfRole(_)){const j=PDF_ROLE_TO_HTML_ROLE[_];j&&(i.role=j)}}return i}function getBaseAttributes(o){const i={};if(isStructTreeNode(o)){if(o.alt!==void 0&&(i["aria-label"]=o.alt),o.lang!==void 0&&(i.lang=o.lang),isStructTreeNodeWithOnlyContentChild(o)){const[_]=o.children;if(_){const $=getBaseAttributes(_);return Object.assign(Object.assign({},i),$)}}}else"id"in o&&(i["aria-owns"]=o.id);return i}function getAttributes(o){return o?Object.assign(Object.assign({},getRoleAttributes(o)),getBaseAttributes(o)):null}function StructTreeItem({className:o,node:i}){const _=reactExports.useMemo(()=>getAttributes(i),[i]),$=reactExports.useMemo(()=>!isStructTreeNode(i)||isStructTreeNodeWithOnlyContentChild(i)?null:i.children.map((j,_e)=>React$2.createElement(StructTreeItem,{key:_e,node:j})),[i]);return React$2.createElement("span",Object.assign({className:o},_),$)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const o=usePageContext();invariant(o);const{onGetStructTreeError:i,onGetStructTreeSuccess:_}=o,[$,j]=useResolver(),{value:_e,error:et}=$,{customTextRenderer:tt,page:rt}=o;function nt(){_e&&_&&_(_e)}function it(){et&&(warning$1(!1,et.toString()),i&&i(et))}function st(){j({type:"RESET"})}reactExports.useEffect(st,[j,rt]);function at(){if(tt||!rt)return;const ot=makeCancellablePromise(rt.getStructTree()),lt=ot;return ot.promise.then(ct=>{j({type:"RESOLVE",value:ct})}).catch(ct=>{j({type:"REJECT",error:ct})}),()=>cancelRunningTask(lt)}return reactExports.useEffect(at,[tt,rt,j]),reactExports.useEffect(()=>{if(_e!==void 0){if(_e===!1){it();return}nt()}},[_e]),_e?React$2.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:_e}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(o){const i=usePageContext();invariant(i);const _=Object.assign(Object.assign({},i),o),{_className:$,canvasBackground:j,devicePixelRatio:_e=getDevicePixelRatio(),onRenderError:et,onRenderSuccess:tt,page:rt,renderForms:nt,renderTextLayer:it,rotate:st,scale:at}=_,{canvasRef:ot}=o;invariant(rt);const lt=reactExports.useRef(null);function ct(){rt&&tt&&tt(makePageCallback(rt,at))}function ft(pt){isCancelException(pt)||(warning$1(!1,pt.toString()),et&&et(pt))}const ut=reactExports.useMemo(()=>rt.getViewport({scale:at*_e,rotation:st}),[_e,rt,st,at]),ht=reactExports.useMemo(()=>rt.getViewport({scale:at,rotation:st}),[rt,st,at]);function dt(){if(!rt)return;rt.cleanup();const{current:pt}=lt;if(!pt)return;pt.width=ut.width,pt.height=ut.height,pt.style.width=`${Math.floor(ht.width)}px`,pt.style.height=`${Math.floor(ht.height)}px`,pt.style.visibility="hidden";const yt={annotationMode:nt?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:pt.getContext("2d",{alpha:!1}),viewport:ut};j&&(yt.background=j);const gt=rt.render(yt),vt=gt;return gt.promise.then(()=>{pt.style.visibility="",ct()}).catch(ft),()=>cancelRunningTask(vt)}reactExports.useEffect(dt,[j,lt,_e,rt,nt,ut,ht]);const mt=reactExports.useCallback(()=>{const{current:pt}=lt;pt&&(pt.width=0,pt.height=0)},[lt]);return reactExports.useEffect(()=>mt,[mt]),React$2.createElement("canvas",{className:`${$}__canvas`,dir:"ltr",ref:mergeRefs(ot,lt),style:{display:"block",userSelect:"none"}},it?React$2.createElement(StructTree,null):null)}function PageSVG(){const o=usePageContext();invariant(o);const{_className:i,onRenderSuccess:_,onRenderError:$,page:j,rotate:_e,scale:et}=o;invariant(j);const[tt,rt]=useResolver(),{value:nt,error:it}=tt;function st(){j&&_&&_(makePageCallback(j,et))}function at(){it&&(isCancelException(it)||(warning$1(!1,it.toString()),$&&$(it)))}const ot=reactExports.useMemo(()=>j.getViewport({scale:et,rotation:_e}),[j,_e,et]);function lt(){rt({type:"RESET"})}reactExports.useEffect(lt,[j,rt,ot]);function ct(){if(!j)return;const dt=makeCancellablePromise(j.getOperatorList());return dt.promise.then(mt=>{new pdfjs.SVGGraphics(j.commonObjs,j.objs).getSVG(mt,ot).then(yt=>{if(!(yt instanceof SVGElement))throw new Error("getSVG returned unexpected result.");rt({type:"RESOLVE",value:yt})}).catch(yt=>{rt({type:"REJECT",error:yt})})}).catch(mt=>{rt({type:"REJECT",error:mt})}),()=>cancelRunningTask(dt)}reactExports.useEffect(ct,[j,rt,ot]),reactExports.useEffect(()=>{if(nt!==void 0){if(nt===!1){at();return}st()}},[nt]);function ft(dt){if(!dt||!nt)return;dt.firstElementChild||dt.appendChild(nt);const{width:mt,height:pt}=ot;nt.setAttribute("width",`${mt}`),nt.setAttribute("height",`${pt}`)}const{width:ut,height:ht}=ot;return React$2.createElement("div",{className:`${i}__svg`,ref:dt=>ft(dt),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:ut,height:ht,userSelect:"none"}})}function isTextItem(o){return"str"in o}function TextLayer(){const o=usePageContext();invariant(o);const{customTextRenderer:i,onGetTextError:_,onGetTextSuccess:$,onRenderTextLayerError:j,onRenderTextLayerSuccess:_e,page:et,pageIndex:tt,pageNumber:rt,rotate:nt,scale:it}=o;invariant(et);const[st,at]=useResolver(),{value:ot,error:lt}=st,ct=reactExports.useRef(null),ft=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function ut(){ot&&$&&$(ot)}function ht(){lt&&(warning$1(!1,lt.toString()),_&&_(lt))}function dt(){at({type:"RESET"})}reactExports.useEffect(dt,[et,at]);function mt(){if(!et)return;const xt=makeCancellablePromise(et.getTextContent()),wt=xt;return xt.promise.then(Ot=>{at({type:"RESOLVE",value:Ot})}).catch(Ot=>{at({type:"REJECT",error:Ot})}),()=>cancelRunningTask(wt)}reactExports.useEffect(mt,[et,at]),reactExports.useEffect(()=>{if(ot!==void 0){if(ot===!1){ht();return}ut()}},[ot]);const pt=reactExports.useCallback(()=>{_e&&_e()},[_e]),yt=reactExports.useCallback(xt=>{warning$1(!1,xt.toString()),j&&j(xt)},[j]);function gt(){const xt=ft.current;xt&&xt.classList.add("active")}function vt(){const xt=ft.current;xt&&xt.classList.remove("active")}const St=reactExports.useMemo(()=>et.getViewport({scale:it,rotation:nt}),[et,nt,it]);function At(){if(!et||!ot)return;const{current:xt}=ct;if(!xt)return;xt.innerHTML="";const wt=et.streamTextContent({includeMarkedContent:!0}),Ot={container:xt,textContentSource:wt,viewport:St},Bt=pdfjs.renderTextLayer(Ot),Ft=Bt;return Bt.promise.then(()=>{const Pt=document.createElement("div");Pt.className="endOfContent",xt.append(Pt),ft.current=Pt;const Rt=xt.querySelectorAll('[role="presentation"]');if(i){let Et=0;ot.items.forEach((_t,Mt)=>{if(!isTextItem(_t))return;const Dt=Rt[Et];if(!Dt)return;const Lt=i(Object.assign({pageIndex:tt,pageNumber:rt,itemIndex:Mt},_t));Dt.innerHTML=Lt,Et+=_t.str&&_t.hasEOL?2:1})}pt()}).catch(yt),()=>cancelRunningTask(Ft)}return reactExports.useLayoutEffect(At,[i,yt,pt,et,tt,rt,ot,St]),React$2.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:vt,onMouseDown:gt,ref:ct})}function AnnotationLayer(){const o=useDocumentContext(),i=usePageContext();invariant(i);const _=Object.assign(Object.assign({},o),i),{imageResourcesPath:$,linkService:j,onGetAnnotationsError:_e,onGetAnnotationsSuccess:et,onRenderAnnotationLayerError:tt,onRenderAnnotationLayerSuccess:rt,page:nt,pdf:it,renderForms:st,rotate:at,scale:ot=1}=_;invariant(it),invariant(nt),invariant(j);const[lt,ct]=useResolver(),{value:ft,error:ut}=lt,ht=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function dt(){ft&&et&&et(ft)}function mt(){ut&&(warning$1(!1,ut.toString()),_e&&_e(ut))}function pt(){ct({type:"RESET"})}reactExports.useEffect(pt,[ct,nt]);function yt(){if(!nt)return;const xt=makeCancellablePromise(nt.getAnnotations()),wt=xt;return xt.promise.then(Ot=>{ct({type:"RESOLVE",value:Ot})}).catch(Ot=>{ct({type:"REJECT",error:Ot})}),()=>{cancelRunningTask(wt)}}reactExports.useEffect(yt,[ct,nt,st]),reactExports.useEffect(()=>{if(ft!==void 0){if(ft===!1){mt();return}dt()}},[ft]);function gt(){rt&&rt()}function vt(xt){warning$1(!1,`${xt}`),tt&&tt(xt)}const St=reactExports.useMemo(()=>nt.getViewport({scale:ot,rotation:at}),[nt,at,ot]);function At(){if(!it||!nt||!j||!ft)return;const{current:xt}=ht;if(!xt)return;const wt=St.clone({dontFlip:!0}),Ot={accessibilityManager:null,annotationCanvasMap:null,div:xt,l10n:null,page:nt,viewport:wt},Bt={annotations:ft,annotationStorage:it.annotationStorage,div:xt,downloadManager:null,imageResourcesPath:$,linkService:j,page:nt,renderForms:st,viewport:wt};xt.innerHTML="";try{new pdfjs.AnnotationLayer(Ot).render(Bt),gt()}catch(Ft){vt(Ft)}return()=>{}}return reactExports.useEffect(At,[ft,$,j,nt,st,St]),React$2.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:ht})}var __rest$2=function(o,i){var _={};for(var $ in o)Object.prototype.hasOwnProperty.call(o,$)&&i.indexOf($)<0&&(_[$]=o[$]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,$=Object.getOwnPropertySymbols(o);j<$.length;j++)i.indexOf($[j])<0&&Object.prototype.propertyIsEnumerable.call(o,$[j])&&(_[$[j]]=o[$[j]]);return _};const defaultScale=1,Page=function o(i){const _=useDocumentContext(),$=Object.assign(Object.assign({},_),i),{_className:j="react-pdf__Page",_enableRegisterUnregisterPage:_e=!0,canvasBackground:et,canvasRef:tt,children:rt,className:nt,customRenderer:it,customTextRenderer:st,devicePixelRatio:at,error:ot="Failed to load the page.",height:lt,inputRef:ct,loading:ft="Loading page",noData:ut="No page specified.",onGetAnnotationsError:ht,onGetAnnotationsSuccess:dt,onGetStructTreeError:mt,onGetStructTreeSuccess:pt,onGetTextError:yt,onGetTextSuccess:gt,onLoadError:vt,onLoadSuccess:St,onRenderAnnotationLayerError:At,onRenderAnnotationLayerSuccess:xt,onRenderError:wt,onRenderSuccess:Ot,onRenderTextLayerError:Bt,onRenderTextLayerSuccess:Ft,pageIndex:Pt,pageNumber:Rt,pdf:Et,registerPage:_t,renderAnnotationLayer:Mt=!0,renderForms:Dt=!1,renderMode:Lt="canvas",renderTextLayer:Ct=!0,rotate:kt,scale:jt=defaultScale,unregisterPage:Vt,width:zt}=$,qt=__rest$2($,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[Wt,ir]=useResolver(),{value:or,error:Qt}=Wt,gr=reactExports.useRef(null);invariant(Et);const ar=isProvided(Rt)?Rt-1:Pt??null,Ar=Rt??(isProvided(Pt)?Pt+1:null),er=kt??(or?or.rotate:null),sr=reactExports.useMemo(()=>{if(!or)return null;let an=1;const yn=jt??defaultScale;if(zt||lt){const _n=or.getViewport({scale:1,rotation:er});zt?an=zt/_n.width:lt&&(an=lt/_n.height)}return yn*an},[lt,or,er,jt,zt]);function Gt(){return()=>{isProvided(ar)&&_e&&Vt&&Vt(ar)}}reactExports.useEffect(Gt,[_e,Et,ar,Vt]);function Jt(){if(St){if(!or||!sr)return;St(makePageCallback(or,sr))}if(_e&&_t){if(!isProvided(ar)||!gr.current)return;_t(ar,gr.current)}}function lr(){Qt&&(warning$1(!1,Qt.toString()),vt&&vt(Qt))}function dr(){ir({type:"RESET"})}reactExports.useEffect(dr,[ir,Et,ar]);function xr(){if(!Et||!Ar)return;const an=makeCancellablePromise(Et.getPage(Ar)),yn=an;return an.promise.then(_n=>{ir({type:"RESOLVE",value:_n})}).catch(_n=>{ir({type:"REJECT",error:_n})}),()=>cancelRunningTask(yn)}reactExports.useEffect(xr,[ir,Et,ar,Ar,_t]),reactExports.useEffect(()=>{if(or!==void 0){if(or===!1){lr();return}Jt()}},[or,sr]);const Mr=reactExports.useMemo(()=>or&&isProvided(ar)&&Ar&&isProvided(er)&&isProvided(sr)?{_className:j,canvasBackground:et,customTextRenderer:st,devicePixelRatio:at,onGetAnnotationsError:ht,onGetAnnotationsSuccess:dt,onGetStructTreeError:mt,onGetStructTreeSuccess:pt,onGetTextError:yt,onGetTextSuccess:gt,onRenderAnnotationLayerError:At,onRenderAnnotationLayerSuccess:xt,onRenderError:wt,onRenderSuccess:Ot,onRenderTextLayerError:Bt,onRenderTextLayerSuccess:Ft,page:or,pageIndex:ar,pageNumber:Ar,renderForms:Dt,renderTextLayer:Ct,rotate:er,scale:sr}:null,[j,et,st,at,ht,dt,mt,pt,yt,gt,At,xt,wt,Ot,Bt,Ft,or,ar,Ar,Dt,Ct,er,sr]),Or=reactExports.useMemo(()=>makeEventProps(qt,()=>or&&(sr?makePageCallback(or,sr):void 0)),[qt,or,sr]),fr=`${ar}@${sr}/${er}`,Hr=`${ar}/${er}`;function Gr(){switch(Lt){case"custom":return invariant(it),React$2.createElement(it,{key:`${fr}_custom`});case"none":return null;case"svg":return React$2.createElement(PageSVG,{key:`${Hr}_svg`});case"canvas":default:return React$2.createElement(PageCanvas,{key:`${fr}_canvas`,canvasRef:tt})}}function dn(){return Ct?React$2.createElement(TextLayer,{key:`${fr}_text`}):null}function nn(){return Mt?React$2.createElement(AnnotationLayer,{key:`${fr}_annotations`}):null}function vn(){return React$2.createElement(PageContext.Provider,{value:Mr},Gr(),dn(),nn(),rt)}function Jr(){return Ar?Et===null||or===void 0||or===null?React$2.createElement(Message,{type:"loading"},typeof ft=="function"?ft():ft):Et===!1||or===!1?React$2.createElement(Message,{type:"error"},typeof ot=="function"?ot():ot):vn():React$2.createElement(Message,{type:"no-data"},typeof ut=="function"?ut():ut)}return React$2.createElement("div",Object.assign({className:clsx(j,nt),"data-page-number":Ar,ref:mergeRefs(ct,gr),style:{"--scale-factor":`${sr}`,backgroundColor:et||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Or),Jr())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;function PDFViewer({url:o}){const[i,_]=reactExports.useState(0),[$,j]=reactExports.useState(1);return reactExports.useEffect(()=>j(1),[o]),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>j(_e=>Math.max(1,_e-1)),children:""}),jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[" ",$," / ",i||"?"]}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>j(_e=>Math.min(i,_e+1)),children:""})]}),jsxRuntimeExports.jsx(Document,{file:o,onLoadSuccess:_e=>_(_e.numPages),children:jsxRuntimeExports.jsx(Page,{pageNumber:$,renderAnnotationLayer:!0,renderTextLayer:!0,className:"rounded-xl shadow-soft-warm"})})]})}function NotesPanel({lessonId:o}){const[i,_]=reactExports.useState("");reactExports.useEffect(()=>{(async()=>{const j=await db.notes.where("lesson_id").equals(o).first();_((j==null?void 0:j.content_md)??"")})()},[o]);const $=async()=>{await db.notes.put({id:o,user_id:"local",lesson_id:o,content_md:i,last_updated:new Date().toISOString()})};return jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-3 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("textarea",{className:"h-40 w-full rounded-lg border border-border p-2",value:i,onChange:j=>_(j.target.value),"aria-label":"Notes"}),jsxRuntimeExports.jsx("div",{className:"mt-2 flex justify-end",children:jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onClick:$,children:""})})]})}function ThemeController(){const{theme:o}=useSettingsStore(),[i,_]=reactExports.useState(getComputedStyle(document.documentElement).getPropertyValue("--color-primary").trim()),[$,j]=reactExports.useState(getComputedStyle(document.documentElement).getPropertyValue("--color-secondary").trim()),[_e,et]=reactExports.useState(getComputedStyle(document.documentElement).getPropertyValue("--color-accent").trim());reactExports.useEffect(()=>{const rt=getComputedStyle(document.documentElement);_(rt.getPropertyValue("--color-primary").trim()),j(rt.getPropertyValue("--color-secondary").trim()),et(rt.getPropertyValue("--color-accent").trim())},[o]);const tt=()=>{document.documentElement.style.setProperty("--color-primary",i),document.documentElement.style.setProperty("--color-secondary",$),document.documentElement.style.setProperty("--color-accent",_e)};return jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-3 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Primary"}),jsxRuntimeExports.jsx("input",{type:"color",value:i,onChange:rt=>_(rt.target.value)})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Secondary"}),jsxRuntimeExports.jsx("input",{type:"color",value:$,onChange:rt=>j(rt.target.value)})]}),jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{children:"Accent"}),jsxRuntimeExports.jsx("input",{type:"color",value:_e,onChange:rt=>et(rt.target.value)})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 flex justify-end",children:jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:tt,children:""})})]})}function Lesson(){const{lessonId:o}=useParams();return jsxRuntimeExports.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold",children:[": ",o]}),jsxRuntimeExports.jsx("div",{className:"rounded-xl bg-surface p-3 shadow-soft-warm",children:jsxRuntimeExports.jsx(VideoPlayer,{src:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",captionUrl:"/captions/sample.vtt"})}),jsxRuntimeExports.jsx("div",{className:"rounded-xl bg-surface p-3 shadow-soft-warm",children:jsxRuntimeExports.jsx(PDFViewer,{url:"/sample.pdf"})}),jsxRuntimeExports.jsx("div",{className:"rounded-xl bg-surface p-3 shadow-soft-warm",children:jsxRuntimeExports.jsx(AudioPlayer,{src:"/sample.mp3"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx(NotesPanel,{lessonId:o??""}),jsxRuntimeExports.jsx(ThemeController,{})]})]})}function ProgressBar({value:o}){return jsxRuntimeExports.jsx("div",{className:"h-2 w-full rounded-full bg-bg",children:jsxRuntimeExports.jsx("div",{className:"h-full rounded-full bg-primary transition-all",style:{width:`${Math.min(100,Math.max(0,o))}%`},"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":o,role:"progressbar"})})}function QuickQuizWidget({question:o,onAnswer:i}){const[_,$]=reactExports.useState(null),[j,_e]=reactExports.useState("idle"),et=()=>{if(!_)return;const tt=_===o.correct;_e(tt?"correct":"wrong"),i(tt)};return jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold",children:""}),o.related&&jsxRuntimeExports.jsx("span",{title:` : ${o.related.name}`,"aria-label":" ",className:`inline-flex h-8 w-8 items-center justify-center rounded-full text-xs ${j==="correct"?"bg-primary text-white":"bg-accent text-white"}`,children:""})]}),jsxRuntimeExports.jsx("p",{className:"mb-3 text-sm",children:o.body}),jsxRuntimeExports.jsx("div",{className:"grid gap-2",children:o.options.map(tt=>jsxRuntimeExports.jsxs("label",{className:`flex cursor-pointer items-center gap-2 rounded-lg border border-border p-2 hover:bg-warm-gradient ${_===tt?"ring-2 ring-accent":""}`,children:[jsxRuntimeExports.jsx("input",{type:"radio",name:o.id,value:tt,onChange:()=>$(tt)}),jsxRuntimeExports.jsx("span",{children:tt})]},tt))}),jsxRuntimeExports.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onClick:et,children:""}),j!=="idle"&&jsxRuntimeExports.jsx("span",{className:`text-sm ${j==="correct"?"text-primary":"text-red-600"}`,children:j==="correct"?" ":" "})]}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx(ProgressBar,{value:_?100:0})})]})}function Quiz(){const[o,i]=reactExports.useState(0),_=reactExports.useMemo(()=>[{id:"q1",body:"   f(x) = x^2  x   2",options:["2","4","8","   "],correct:"4",related:{name:" ",id:"lesson-limit-def"}},{id:"q2",body:"True/False:        .",options:["",""],correct:"",related:{name:" ",id:"lesson-waves"}}],[]),$=_[o];return jsxRuntimeExports.jsxs("div",{className:"mx-auto max-w-2xl",children:[jsxRuntimeExports.jsx(QuickQuizWidget,{question:$,onAnswer:j=>{setTimeout(()=>i(_e=>Math.min(_e+1,_.length-1)),600)}},$.id),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-center text-sm text-muted",children:[o+1," / ",_.length]})]})}function Settings(){const{theme:o,setTheme:i,language:_,setLanguage:$,disableMotion:j,setDisableMotion:_e}=useSettingsStore();return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold",children:""}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm text-muted",children:""}),jsxRuntimeExports.jsxs("select",{className:"btn btn-secondary mt-2",value:o,onChange:et=>i(et.target.value),children:[jsxRuntimeExports.jsx("option",{value:"light",children:""}),jsxRuntimeExports.jsx("option",{value:"dark",children:""}),jsxRuntimeExports.jsx("option",{value:"high-contrast",children:" "})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm text-muted",children:""}),jsxRuntimeExports.jsxs("select",{className:"btn btn-secondary mt-2",value:_,onChange:et=>$(et.target.value),children:[jsxRuntimeExports.jsx("option",{value:"ar",children:""}),jsxRuntimeExports.jsx("option",{value:"en",children:"English"})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm text-muted",children:""}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx("input",{id:"disableMotion",type:"checkbox",checked:j,onChange:et=>_e(et.target.checked)}),jsxRuntimeExports.jsx("label",{htmlFor:"disableMotion",children:" "})]})]})]})]})}function Onboarding(){const o=useReducedMotionPref(),[i,_]=reactExports.useState(null);return reactExports.useEffect(()=>{o||fetch("/lottie/soft-floating-cards.json").then($=>$.json()).then(_).catch(()=>_(null))},[o]),jsxRuntimeExports.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold",children:"   StudyForge"}),jsxRuntimeExports.jsx("p",{className:"text-muted",children:"         ."}),jsxRuntimeExports.jsxs("ul",{className:"list-disc pr-5 text-sm text-muted",children:[jsxRuntimeExports.jsx("li",{children:"      "}),jsxRuntimeExports.jsx("li",{children:"     "}),jsxRuntimeExports.jsx("li",{children:"    "})]})]}),jsxRuntimeExports.jsx("div",{className:"rounded-xl bg-surface/60 p-4 backdrop-blur shadow-soft-warm",children:!o&&i&&jsxRuntimeExports.jsx(Lottie,{animationData:i,loop:!0,autoplay:!0,speed:.9,style:{height:300}})})]})}function TeacherDashboard(){return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold",children:" "}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsxs("form",{className:"space-y-3",onSubmit:o=>o.preventDefault(),children:[jsxRuntimeExports.jsx("input",{className:"w-full rounded-lg border border-border p-2",placeholder:" "}),jsxRuntimeExports.jsxs("select",{className:"w-full rounded-lg border border-border p-2",children:[jsxRuntimeExports.jsx("option",{children:""}),jsxRuntimeExports.jsx("option",{children:""}),jsxRuntimeExports.jsx("option",{children:"PDF"}),jsxRuntimeExports.jsx("option",{children:"/ "})]}),jsxRuntimeExports.jsx("input",{type:"file",className:"w-full rounded-lg border border-border p-2 file:mr-4 file:rounded-md file:border-0 file:bg-primary file:px-3 file:py-1.5 file:text-white"}),jsxRuntimeExports.jsx("button",{className:"btn btn-primary",children:" "})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-2 text-sm text-muted",children:" "}),jsxRuntimeExports.jsxs("form",{className:"space-y-3",onSubmit:o=>o.preventDefault(),children:[jsxRuntimeExports.jsx("input",{className:"w-full rounded-lg border border-border p-2",placeholder:" "}),jsxRuntimeExports.jsx("textarea",{className:"w-full rounded-lg border border-border p-2",placeholder:"  JSON "}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",children:""})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("h3",{className:"mb-3 text-sm text-muted",children:" "}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-sm",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"border-b border-border/60 text-muted",children:[jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:" "}),jsxRuntimeExports.jsx("th",{className:"p-2 text-start",children:""})]})}),jsxRuntimeExports.jsx("tbody",{children:[1,2].map(o=>jsxRuntimeExports.jsxs("tr",{className:"border-b border-border/40 hover:bg-warm-gradient",children:[jsxRuntimeExports.jsxs("td",{className:"p-2",children:[" ",o]}),jsxRuntimeExports.jsx("td",{className:"p-2",children:""}),jsxRuntimeExports.jsx("td",{className:"p-2",children:"2025-09-10"}),jsxRuntimeExports.jsx("td",{className:"p-2",children:jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",children:" "})})]},o))})]})})]})]})}const scriptRel="modulepreload",assetsURL=function(o){return"/"+o},seen={},__vitePreload=function o(i,_,$){let j=Promise.resolve();if(_&&_.length>0){document.getElementsByTagName("link");const et=document.querySelector("meta[property=csp-nonce]"),tt=(et==null?void 0:et.nonce)||(et==null?void 0:et.getAttribute("nonce"));j=Promise.allSettled(_.map(rt=>{if(rt=assetsURL(rt),rt in seen)return;seen[rt]=!0;const nt=rt.endsWith(".css"),it=nt?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${rt}"]${it}`))return;const st=document.createElement("link");if(st.rel=nt?"stylesheet":scriptRel,nt||(st.as="script"),st.crossOrigin="",st.href=rt,tt&&st.setAttribute("nonce",tt),document.head.appendChild(st),nt)return new Promise((at,ot)=>{st.addEventListener("load",at),st.addEventListener("error",()=>ot(new Error(`Unable to preload CSS for ${rt}`)))})}))}function _e(et){const tt=new Event("vite:preloadError",{cancelable:!0});if(tt.payload=et,window.dispatchEvent(tt),!tt.defaultPrevented)throw et}return j.then(et=>{for(const tt of et||[])tt.status==="rejected"&&_e(tt.reason);return i().catch(_e)})},resolveFetch$3=o=>{let i;return o?i=o:typeof fetch>"u"?i=(..._)=>__vitePreload(async()=>{const{default:$}=await Promise.resolve().then(()=>browser);return{default:$}},void 0).then(({default:$})=>$(..._)):i=fetch,(..._)=>i(..._)};class FunctionsError extends Error{constructor(i,_="FunctionsError",$){super(i),this.name=_,this.context=$}}class FunctionsFetchError extends FunctionsError{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}}class FunctionsRelayError extends FunctionsError{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}}class FunctionsHttpError extends FunctionsError{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}}var FunctionRegion;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$7=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};class FunctionsClient{constructor(i,{headers:_={},customFetch:$,region:j=FunctionRegion.Any}={}){this.url=i,this.headers=_,this.region=j,this.fetch=resolveFetch$3($)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i,_={}){var $;return __awaiter$7(this,void 0,void 0,function*(){try{const{headers:j,method:_e,body:et}=_;let tt={},{region:rt}=_;rt||(rt=this.region);const nt=new URL(`${this.url}/${i}`);rt&&rt!=="any"&&(tt["x-region"]=rt,nt.searchParams.set("forceFunctionRegion",rt));let it;et&&(j&&!Object.prototype.hasOwnProperty.call(j,"Content-Type")||!j)&&(typeof Blob<"u"&&et instanceof Blob||et instanceof ArrayBuffer?(tt["Content-Type"]="application/octet-stream",it=et):typeof et=="string"?(tt["Content-Type"]="text/plain",it=et):typeof FormData<"u"&&et instanceof FormData?it=et:(tt["Content-Type"]="application/json",it=JSON.stringify(et)));const st=yield this.fetch(nt.toString(),{method:_e||"POST",headers:Object.assign(Object.assign(Object.assign({},tt),this.headers),j),body:it}).catch(ct=>{throw new FunctionsFetchError(ct)}),at=st.headers.get("x-relay-error");if(at&&at==="true")throw new FunctionsRelayError(st);if(!st.ok)throw new FunctionsHttpError(st);let ot=(($=st.headers.get("Content-Type"))!==null&&$!==void 0?$:"text/plain").split(";")[0].trim(),lt;return ot==="application/json"?lt=yield st.json():ot==="application/octet-stream"?lt=yield st.blob():ot==="text/event-stream"?lt=st:ot==="multipart/form-data"?lt=yield st.formData():lt=yield st.text(),{data:lt,error:null,response:st}}catch(j){return{data:null,error:j,response:j instanceof FunctionsHttpError||j instanceof FunctionsRelayError?j.context:void 0}}})}}var cjs={},PostgrestClient$2={},PostgrestQueryBuilder$2={},PostgrestFilterBuilder$2={},PostgrestTransformBuilder$2={},PostgrestBuilder$2={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request$1=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request:Request$1,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(browser);var PostgrestError$2={};Object.defineProperty(PostgrestError$2,"__esModule",{value:!0});let PostgrestError$1=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}};PostgrestError$2.default=PostgrestError$1;var __importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(PostgrestBuilder$2,"__esModule",{value:!0});const node_fetch_1=__importDefault$5(require$$0),PostgrestError_1$1=__importDefault$5(PostgrestError$2);let PostgrestBuilder$1=class{constructor(i){var _,$;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(_=i.shouldThrowOnError)!==null&&_!==void 0?_:!1,this.signal=i.signal,this.isMaybeSingle=($=i.isMaybeSingle)!==null&&$!==void 0?$:!1,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=node_fetch_1.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,_){return this.headers=new Headers(this.headers),this.headers.set(i,_),this}then(i,_){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const $=this.fetch;let j=$(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async _e=>{var et,tt,rt,nt;let it=null,st=null,at=null,ot=_e.status,lt=_e.statusText;if(_e.ok){if(this.method!=="HEAD"){const ht=await _e.text();ht===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((et=this.headers.get("Accept"))===null||et===void 0)&&et.includes("application/vnd.pgrst.plan+text"))?st=ht:st=JSON.parse(ht))}const ft=(tt=this.headers.get("Prefer"))===null||tt===void 0?void 0:tt.match(/count=(exact|planned|estimated)/),ut=(rt=_e.headers.get("content-range"))===null||rt===void 0?void 0:rt.split("/");ft&&ut&&ut.length>1&&(at=parseInt(ut[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(st)&&(st.length>1?(it={code:"PGRST116",details:`Results contain ${st.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},st=null,at=null,ot=406,lt="Not Acceptable"):st.length===1?st=st[0]:st=null)}else{const ft=await _e.text();try{it=JSON.parse(ft),Array.isArray(it)&&_e.status===404&&(st=[],it=null,ot=200,lt="OK")}catch{_e.status===404&&ft===""?(ot=204,lt="No Content"):it={message:ft}}if(it&&this.isMaybeSingle&&(!((nt=it==null?void 0:it.details)===null||nt===void 0)&&nt.includes("0 rows"))&&(it=null,ot=200,lt="OK"),it&&this.shouldThrowOnError)throw new PostgrestError_1$1.default(it)}return{error:it,data:st,count:at,status:ot,statusText:lt}});return this.shouldThrowOnError||(j=j.catch(_e=>{var et,tt,rt;return{error:{message:`${(et=_e==null?void 0:_e.name)!==null&&et!==void 0?et:"FetchError"}: ${_e==null?void 0:_e.message}`,details:`${(tt=_e==null?void 0:_e.stack)!==null&&tt!==void 0?tt:""}`,hint:"",code:`${(rt=_e==null?void 0:_e.code)!==null&&rt!==void 0?rt:""}`},data:null,count:null,status:0,statusText:""}})),j.then(i,_)}returns(){return this}overrideTypes(){return this}};PostgrestBuilder$2.default=PostgrestBuilder$1;var __importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(PostgrestTransformBuilder$2,"__esModule",{value:!0});const PostgrestBuilder_1$1=__importDefault$4(PostgrestBuilder$2);let PostgrestTransformBuilder$1=class extends PostgrestBuilder_1$1.default{select(i){let _=!1;const $=(i??"*").split("").map(j=>/\s/.test(j)&&!_?"":(j==='"'&&(_=!_),j)).join("");return this.url.searchParams.set("select",$),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:_=!0,nullsFirst:$,foreignTable:j,referencedTable:_e=j}={}){const et=_e?`${_e}.order`:"order",tt=this.url.searchParams.get(et);return this.url.searchParams.set(et,`${tt?`${tt},`:""}${i}.${_?"asc":"desc"}${$===void 0?"":$?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:_,referencedTable:$=_}={}){const j=typeof $>"u"?"limit":`${$}.limit`;return this.url.searchParams.set(j,`${i}`),this}range(i,_,{foreignTable:$,referencedTable:j=$}={}){const _e=typeof j>"u"?"offset":`${j}.offset`,et=typeof j>"u"?"limit":`${j}.limit`;return this.url.searchParams.set(_e,`${i}`),this.url.searchParams.set(et,`${_-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:_=!1,settings:$=!1,buffers:j=!1,wal:_e=!1,format:et="text"}={}){var tt;const rt=[i?"analyze":null,_?"verbose":null,$?"settings":null,j?"buffers":null,_e?"wal":null].filter(Boolean).join("|"),nt=(tt=this.headers.get("Accept"))!==null&&tt!==void 0?tt:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${et}; for="${nt}"; options=${rt};`),et==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};PostgrestTransformBuilder$2.default=PostgrestTransformBuilder$1;var __importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(PostgrestFilterBuilder$2,"__esModule",{value:!0});const PostgrestTransformBuilder_1$1=__importDefault$3(PostgrestTransformBuilder$2);let PostgrestFilterBuilder$1=class extends PostgrestTransformBuilder_1$1.default{eq(i,_){return this.url.searchParams.append(i,`eq.${_}`),this}neq(i,_){return this.url.searchParams.append(i,`neq.${_}`),this}gt(i,_){return this.url.searchParams.append(i,`gt.${_}`),this}gte(i,_){return this.url.searchParams.append(i,`gte.${_}`),this}lt(i,_){return this.url.searchParams.append(i,`lt.${_}`),this}lte(i,_){return this.url.searchParams.append(i,`lte.${_}`),this}like(i,_){return this.url.searchParams.append(i,`like.${_}`),this}likeAllOf(i,_){return this.url.searchParams.append(i,`like(all).{${_.join(",")}}`),this}likeAnyOf(i,_){return this.url.searchParams.append(i,`like(any).{${_.join(",")}}`),this}ilike(i,_){return this.url.searchParams.append(i,`ilike.${_}`),this}ilikeAllOf(i,_){return this.url.searchParams.append(i,`ilike(all).{${_.join(",")}}`),this}ilikeAnyOf(i,_){return this.url.searchParams.append(i,`ilike(any).{${_.join(",")}}`),this}is(i,_){return this.url.searchParams.append(i,`is.${_}`),this}in(i,_){const $=Array.from(new Set(_)).map(j=>typeof j=="string"&&new RegExp("[,()]").test(j)?`"${j}"`:`${j}`).join(",");return this.url.searchParams.append(i,`in.(${$})`),this}contains(i,_){return typeof _=="string"?this.url.searchParams.append(i,`cs.${_}`):Array.isArray(_)?this.url.searchParams.append(i,`cs.{${_.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(_)}`),this}containedBy(i,_){return typeof _=="string"?this.url.searchParams.append(i,`cd.${_}`):Array.isArray(_)?this.url.searchParams.append(i,`cd.{${_.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(_)}`),this}rangeGt(i,_){return this.url.searchParams.append(i,`sr.${_}`),this}rangeGte(i,_){return this.url.searchParams.append(i,`nxl.${_}`),this}rangeLt(i,_){return this.url.searchParams.append(i,`sl.${_}`),this}rangeLte(i,_){return this.url.searchParams.append(i,`nxr.${_}`),this}rangeAdjacent(i,_){return this.url.searchParams.append(i,`adj.${_}`),this}overlaps(i,_){return typeof _=="string"?this.url.searchParams.append(i,`ov.${_}`):this.url.searchParams.append(i,`ov.{${_.join(",")}}`),this}textSearch(i,_,{config:$,type:j}={}){let _e="";j==="plain"?_e="pl":j==="phrase"?_e="ph":j==="websearch"&&(_e="w");const et=$===void 0?"":`(${$})`;return this.url.searchParams.append(i,`${_e}fts${et}.${_}`),this}match(i){return Object.entries(i).forEach(([_,$])=>{this.url.searchParams.append(_,`eq.${$}`)}),this}not(i,_,$){return this.url.searchParams.append(i,`not.${_}.${$}`),this}or(i,{foreignTable:_,referencedTable:$=_}={}){const j=$?`${$}.or`:"or";return this.url.searchParams.append(j,`(${i})`),this}filter(i,_,$){return this.url.searchParams.append(i,`${_}.${$}`),this}};PostgrestFilterBuilder$2.default=PostgrestFilterBuilder$1;var __importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(PostgrestQueryBuilder$2,"__esModule",{value:!0});const PostgrestFilterBuilder_1$2=__importDefault$2(PostgrestFilterBuilder$2);let PostgrestQueryBuilder$1=class{constructor(i,{headers:_={},schema:$,fetch:j}){this.url=i,this.headers=new Headers(_),this.schema=$,this.fetch=j}select(i,{head:_=!1,count:$}={}){const j=_?"HEAD":"GET";let _e=!1;const et=(i??"*").split("").map(tt=>/\s/.test(tt)&&!_e?"":(tt==='"'&&(_e=!_e),tt)).join("");return this.url.searchParams.set("select",et),$&&this.headers.append("Prefer",`count=${$}`),new PostgrestFilterBuilder_1$2.default({method:j,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:_,defaultToNull:$=!0}={}){var j;const _e="POST";if(_&&this.headers.append("Prefer",`count=${_}`),$||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const et=i.reduce((tt,rt)=>tt.concat(Object.keys(rt)),[]);if(et.length>0){const tt=[...new Set(et)].map(rt=>`"${rt}"`);this.url.searchParams.set("columns",tt.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:_e,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(j=this.fetch)!==null&&j!==void 0?j:fetch})}upsert(i,{onConflict:_,ignoreDuplicates:$=!1,count:j,defaultToNull:_e=!0}={}){var et;const tt="POST";if(this.headers.append("Prefer",`resolution=${$?"ignore":"merge"}-duplicates`),_!==void 0&&this.url.searchParams.set("on_conflict",_),j&&this.headers.append("Prefer",`count=${j}`),_e||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const rt=i.reduce((nt,it)=>nt.concat(Object.keys(it)),[]);if(rt.length>0){const nt=[...new Set(rt)].map(it=>`"${it}"`);this.url.searchParams.set("columns",nt.join(","))}}return new PostgrestFilterBuilder_1$2.default({method:tt,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(et=this.fetch)!==null&&et!==void 0?et:fetch})}update(i,{count:_}={}){var $;const j="PATCH";return _&&this.headers.append("Prefer",`count=${_}`),new PostgrestFilterBuilder_1$2.default({method:j,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:($=this.fetch)!==null&&$!==void 0?$:fetch})}delete({count:i}={}){var _;const $="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new PostgrestFilterBuilder_1$2.default({method:$,url:this.url,headers:this.headers,schema:this.schema,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}};PostgrestQueryBuilder$2.default=PostgrestQueryBuilder$1;var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(PostgrestClient$2,"__esModule",{value:!0});const PostgrestQueryBuilder_1$1=__importDefault$1(PostgrestQueryBuilder$2),PostgrestFilterBuilder_1$1=__importDefault$1(PostgrestFilterBuilder$2);let PostgrestClient$1=class Vu{constructor(i,{headers:_={},schema:$,fetch:j}={}){this.url=i,this.headers=new Headers(_),this.schemaName=$,this.fetch=j}from(i){const _=new URL(`${this.url}/${i}`);return new PostgrestQueryBuilder_1$1.default(_,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new Vu(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,_={},{head:$=!1,get:j=!1,count:_e}={}){var et;let tt;const rt=new URL(`${this.url}/rpc/${i}`);let nt;$||j?(tt=$?"HEAD":"GET",Object.entries(_).filter(([st,at])=>at!==void 0).map(([st,at])=>[st,Array.isArray(at)?`{${at.join(",")}}`:`${at}`]).forEach(([st,at])=>{rt.searchParams.append(st,at)})):(tt="POST",nt=_);const it=new Headers(this.headers);return _e&&it.set("Prefer",`count=${_e}`),new PostgrestFilterBuilder_1$1.default({method:tt,url:rt,headers:it,schema:this.schemaName,body:nt,fetch:(et=this.fetch)!==null&&et!==void 0?et:fetch})}};PostgrestClient$2.default=PostgrestClient$1;var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(cjs,"__esModule",{value:!0});cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const PostgrestClient_1=__importDefault(PostgrestClient$2);cjs.PostgrestClient=PostgrestClient_1.default;const PostgrestQueryBuilder_1=__importDefault(PostgrestQueryBuilder$2);cjs.PostgrestQueryBuilder=PostgrestQueryBuilder_1.default;const PostgrestFilterBuilder_1=__importDefault(PostgrestFilterBuilder$2);cjs.PostgrestFilterBuilder=PostgrestFilterBuilder_1.default;const PostgrestTransformBuilder_1=__importDefault(PostgrestTransformBuilder$2);cjs.PostgrestTransformBuilder=PostgrestTransformBuilder_1.default;const PostgrestBuilder_1=__importDefault(PostgrestBuilder$2);cjs.PostgrestBuilder=PostgrestBuilder_1.default;const PostgrestError_1=__importDefault(PostgrestError$2);cjs.PostgrestError=PostgrestError_1.default;var _default=cjs.default={PostgrestClient:PostgrestClient_1.default,PostgrestQueryBuilder:PostgrestQueryBuilder_1.default,PostgrestFilterBuilder:PostgrestFilterBuilder_1.default,PostgrestTransformBuilder:PostgrestTransformBuilder_1.default,PostgrestBuilder:PostgrestBuilder_1.default,PostgrestError:PostgrestError_1.default};const{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=_default;class WebSocketFactory{static detectEnvironment(){var i;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((i=navigator.userAgent)===null||i===void 0)&&i.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const _=process.versions;if(_&&_.node){const $=_.node,j=parseInt($.replace(/^v/,"").split(".")[0]);return j>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${j} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${j} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const i=this.detectEnvironment();if(i.constructor)return i.constructor;let _=i.error||"WebSocket not supported in this environment.";throw i.workaround&&(_+=`

Suggested solution: ${i.workaround}`),new Error(_)}static createWebSocket(i,_){const $=this.getWebSocketConstructor();return new $(i,_)}static isWebSocketSupported(){try{const i=this.detectEnvironment();return i.type==="native"||i.type==="ws"}catch{return!1}}}const version$3="2.15.5",DEFAULT_VERSION=`realtime-js/${version$3}`,VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3,MAX_PUSH_BUFFER_SIZE=100;var SOCKET_STATES;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(o){o.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(i,_){return i.constructor===ArrayBuffer?_(this._binaryDecode(i)):_(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){const _=new DataView(i),$=new TextDecoder;return this._decodeBroadcast(i,_,$)}_decodeBroadcast(i,_,$){const j=_.getUint8(1),_e=_.getUint8(2);let et=this.HEADER_LENGTH+2;const tt=$.decode(i.slice(et,et+j));et=et+j;const rt=$.decode(i.slice(et,et+_e));et=et+_e;const nt=JSON.parse($.decode(i.slice(et,i.byteLength)));return{ref:null,topic:tt,event:rt,payload:nt}}}class Timer{constructor(i,_){this.callback=i,this.timerCalc=_,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=_}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(o,i,_={})=>{var $;const j=($=_.skipTypes)!==null&&$!==void 0?$:[];return Object.keys(i).reduce((_e,et)=>(_e[et]=convertColumn(et,o,i,j),_e),{})},convertColumn=(o,i,_,$)=>{const j=i.find(tt=>tt.name===o),_e=j==null?void 0:j.type,et=_[o];return _e&&!$.includes(_e)?convertCell(_e,et):noop$2(et)},convertCell=(o,i)=>{if(o.charAt(0)==="_"){const _=o.slice(1,o.length);return toArray(i,_)}switch(o){case PostgresTypes.bool:return toBoolean(i);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(i);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(i);case PostgresTypes.timestamp:return toTimestampString(i);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$2(i);default:return noop$2(i)}},noop$2=o=>o,toBoolean=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},toNumber=o=>{if(typeof o=="string"){const i=parseFloat(o);if(!Number.isNaN(i))return i}return o},toJson=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(i){return console.log(`JSON parse error: ${i}`),o}return o},toArray=(o,i)=>{if(typeof o!="string")return o;const _=o.length-1,$=o[_];if(o[0]==="{"&&$==="}"){let _e;const et=o.slice(1,_);try{_e=JSON.parse("["+et+"]")}catch{_e=et?et.split(","):[]}return _e.map(tt=>convertCell(i,tt))}return o},toTimestampString=o=>typeof o=="string"?o.replace(" ","T"):o,httpEndpointURL=o=>{let i=o;return i=i.replace(/^ws/i,"http"),i=i.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),i.replace(/\/+$/,"")+"/api/broadcast"};class Push{constructor(i,_,$={},j=DEFAULT_TIMEOUT){this.channel=i,this.event=_,this.payload=$,this.timeout=j,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,_){var $;return this._hasReceived(i)&&_(($=this.receivedResp)===null||$===void 0?void 0:$.response),this.recHooks.push({status:i,callback:_}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const i=_=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=_,this._matchReceive(_)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,_){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:_})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:_}){this.recHooks.filter($=>$.status===i).forEach($=>$.callback(_))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(i,_){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const $=(_==null?void 0:_.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on($.state,{},j=>{const{onJoin:_e,onLeave:et,onSync:tt}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,j,_e,et),this.pendingDiffs.forEach(rt=>{this.state=RealtimePresence.syncDiff(this.state,rt,_e,et)}),this.pendingDiffs=[],tt()}),this.channel._on($.diff,{},j=>{const{onJoin:_e,onLeave:et,onSync:tt}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(j):(this.state=RealtimePresence.syncDiff(this.state,j,_e,et),tt())}),this.onJoin((j,_e,et)=>{this.channel._trigger("presence",{event:"join",key:j,currentPresences:_e,newPresences:et})}),this.onLeave((j,_e,et)=>{this.channel._trigger("presence",{event:"leave",key:j,currentPresences:_e,leftPresences:et})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,_,$,j){const _e=this.cloneDeep(i),et=this.transformState(_),tt={},rt={};return this.map(_e,(nt,it)=>{et[nt]||(rt[nt]=it)}),this.map(et,(nt,it)=>{const st=_e[nt];if(st){const at=it.map(ft=>ft.presence_ref),ot=st.map(ft=>ft.presence_ref),lt=it.filter(ft=>ot.indexOf(ft.presence_ref)<0),ct=st.filter(ft=>at.indexOf(ft.presence_ref)<0);lt.length>0&&(tt[nt]=lt),ct.length>0&&(rt[nt]=ct)}else tt[nt]=it}),this.syncDiff(_e,{joins:tt,leaves:rt},$,j)}static syncDiff(i,_,$,j){const{joins:_e,leaves:et}={joins:this.transformState(_.joins),leaves:this.transformState(_.leaves)};return $||($=()=>{}),j||(j=()=>{}),this.map(_e,(tt,rt)=>{var nt;const it=(nt=i[tt])!==null&&nt!==void 0?nt:[];if(i[tt]=this.cloneDeep(rt),it.length>0){const st=i[tt].map(ot=>ot.presence_ref),at=it.filter(ot=>st.indexOf(ot.presence_ref)<0);i[tt].unshift(...at)}$(tt,it,rt)}),this.map(et,(tt,rt)=>{let nt=i[tt];if(!nt)return;const it=rt.map(st=>st.presence_ref);nt=nt.filter(st=>it.indexOf(st.presence_ref)<0),i[tt]=nt,j(tt,nt,rt),nt.length===0&&delete i[tt]}),i}static map(i,_){return Object.getOwnPropertyNames(i).map($=>_($,i[$]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((_,$)=>{const j=i[$];return"metas"in j?_[$]=j.metas.map(_e=>(_e.presence_ref=_e.phx_ref,delete _e.phx_ref,delete _e.phx_ref_prev,_e)):_[$]=j,_},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(i,_={config:{}},$){this.topic=i,this.params=_,this.socket=$,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},_.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(j=>j.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(j=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,j),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",j=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,j),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(j,_e)=>{this._trigger(this._replyEventName(_e),j)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(i,_=this.timeout){var $,j,_e;if(this.socket.isConnected()||this.socket.connect(),this.state==CHANNEL_STATES.closed){const{config:{broadcast:et,presence:tt,private:rt}}=this.params,nt=(j=($=this.bindings.postgres_changes)===null||$===void 0?void 0:$.map(ot=>ot.filter))!==null&&j!==void 0?j:[],it=!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE]&&this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length>0||((_e=this.params.config.presence)===null||_e===void 0?void 0:_e.enabled)===!0,st={},at={broadcast:et,presence:Object.assign(Object.assign({},tt),{enabled:it}),postgres_changes:nt,private:rt};this.socket.accessTokenValue&&(st.access_token=this.socket.accessTokenValue),this._onError(ot=>i==null?void 0:i(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,ot)),this._onClose(()=>i==null?void 0:i(REALTIME_SUBSCRIBE_STATES.CLOSED)),this.updateJoinPayload(Object.assign({config:at},st)),this.joinedOnce=!0,this._rejoin(_),this.joinPush.receive("ok",async({postgres_changes:ot})=>{var lt;if(this.socket.setAuth(),ot===void 0){i==null||i(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const ct=this.bindings.postgres_changes,ft=(lt=ct==null?void 0:ct.length)!==null&&lt!==void 0?lt:0,ut=[];for(let ht=0;ht<ft;ht++){const dt=ct[ht],{filter:{event:mt,schema:pt,table:yt,filter:gt}}=dt,vt=ot&&ot[ht];if(vt&&vt.event===mt&&vt.schema===pt&&vt.table===yt&&vt.filter===gt)ut.push(Object.assign(Object.assign({},dt),{id:vt.id}));else{this.unsubscribe(),this.state=CHANNEL_STATES.errored,i==null||i(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=ut,i&&i(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",ot=>{this.state=CHANNEL_STATES.errored,i==null||i(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(ot).join(", ")||"error")))}).receive("timeout",()=>{i==null||i(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(i,_={}){return await this.send({type:"presence",event:"track",payload:i},_.timeout||this.timeout)}async untrack(i={}){return await this.send({type:"presence",event:"untrack"},i)}on(i,_,$){return this.state===CHANNEL_STATES.joined&&i===REALTIME_LISTEN_TYPES.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(i,_,$)}async send(i,_={}){var $,j;if(!this._canPush()&&i.type==="broadcast"){const{event:_e,payload:et}=i,rt={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:_e,payload:et,private:this.private}]})};try{const nt=await this._fetchWithTimeout(this.broadcastEndpointURL,rt,($=_.timeout)!==null&&$!==void 0?$:this.timeout);return await((j=nt.body)===null||j===void 0?void 0:j.cancel()),nt.ok?"ok":"error"}catch(nt){return nt.name==="AbortError"?"timed out":"error"}}else return new Promise(_e=>{var et,tt,rt;const nt=this._push(i.type,i,_.timeout||this.timeout);i.type==="broadcast"&&!(!((rt=(tt=(et=this.params)===null||et===void 0?void 0:et.config)===null||tt===void 0?void 0:tt.broadcast)===null||rt===void 0)&&rt.ack)&&_e("ok"),nt.receive("ok",()=>_e("ok")),nt.receive("error",()=>_e("error")),nt.receive("timeout",()=>_e("timed out"))})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=CHANNEL_STATES.leaving;const _=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};this.joinPush.destroy();let $=null;return new Promise(j=>{$=new Push(this,CHANNEL_EVENTS.leave,{},i),$.receive("ok",()=>{_(),j("ok")}).receive("timeout",()=>{_(),j("timed out")}).receive("error",()=>{j("error")}),$.send(),this._canPush()||$.trigger("ok",{})}).finally(()=>{$==null||$.destroy()})}teardown(){this.pushBuffer.forEach(i=>i.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=CHANNEL_STATES.closed,this.bindings={}}async _fetchWithTimeout(i,_,$){const j=new AbortController,_e=setTimeout(()=>j.abort(),$),et=await this.socket.fetch(i,Object.assign(Object.assign({},_),{signal:j.signal}));return clearTimeout(_e),et}_push(i,_,$=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let j=new Push(this,i,_,$);return this._canPush()?j.send():this._addToPushBuffer(j),j}_addToPushBuffer(i){if(i.startTimeout(),this.pushBuffer.push(i),this.pushBuffer.length>MAX_PUSH_BUFFER_SIZE){const _=this.pushBuffer.shift();_&&(_.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${_.event}`,_.payload))}}_onMessage(i,_,$){return _}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,_,$){var j,_e;const et=i.toLocaleLowerCase(),{close:tt,error:rt,leave:nt,join:it}=CHANNEL_EVENTS;if($&&[tt,rt,nt,it].indexOf(et)>=0&&$!==this._joinRef())return;let at=this._onMessage(et,_,$);if(_&&!at)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(et)?(j=this.bindings.postgres_changes)===null||j===void 0||j.filter(ot=>{var lt,ct,ft;return((lt=ot.filter)===null||lt===void 0?void 0:lt.event)==="*"||((ft=(ct=ot.filter)===null||ct===void 0?void 0:ct.event)===null||ft===void 0?void 0:ft.toLocaleLowerCase())===et}).map(ot=>ot.callback(at,$)):(_e=this.bindings[et])===null||_e===void 0||_e.filter(ot=>{var lt,ct,ft,ut,ht,dt;if(["broadcast","presence","postgres_changes"].includes(et))if("id"in ot){const mt=ot.id,pt=(lt=ot.filter)===null||lt===void 0?void 0:lt.event;return mt&&((ct=_.ids)===null||ct===void 0?void 0:ct.includes(mt))&&(pt==="*"||(pt==null?void 0:pt.toLocaleLowerCase())===((ft=_.data)===null||ft===void 0?void 0:ft.type.toLocaleLowerCase()))}else{const mt=(ht=(ut=ot==null?void 0:ot.filter)===null||ut===void 0?void 0:ut.event)===null||ht===void 0?void 0:ht.toLocaleLowerCase();return mt==="*"||mt===((dt=_==null?void 0:_.event)===null||dt===void 0?void 0:dt.toLocaleLowerCase())}else return ot.type.toLocaleLowerCase()===et}).map(ot=>{if(typeof at=="object"&&"ids"in at){const lt=at.data,{schema:ct,table:ft,commit_timestamp:ut,type:ht,errors:dt}=lt;at=Object.assign(Object.assign({},{schema:ct,table:ft,commit_timestamp:ut,eventType:ht,new:{},old:{},errors:dt}),this._getPayloadRecords(lt))}ot.callback(at,$)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,_,$){const j=i.toLocaleLowerCase(),_e={type:j,filter:_,callback:$};return this.bindings[j]?this.bindings[j].push(_e):this.bindings[j]=[_e],this}_off(i,_){const $=i.toLocaleLowerCase();return this.bindings[$]&&(this.bindings[$]=this.bindings[$].filter(j=>{var _e;return!(((_e=j.type)===null||_e===void 0?void 0:_e.toLocaleLowerCase())===$&&RealtimeChannel.isEqual(j.filter,_))})),this}static isEqual(i,_){if(Object.keys(i).length!==Object.keys(_).length)return!1;for(const $ in i)if(i[$]!==_[$])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(CHANNEL_EVENTS.close,{},i)}_onError(i){this._on(CHANNEL_EVENTS.error,{},_=>i(_))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(i))}_getPayloadRecords(i){const _={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(_.new=convertChangeData(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(_.old=convertChangeData(i.columns,i.old_record)),_}}const noop$1=()=>{},CONNECTION_TIMEOUTS={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},RECONNECT_INTERVALS=[1e3,2e3,5e3,1e4],DEFAULT_RECONNECT_FALLBACK=1e4,WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(i,_){var $;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DEFAULT_TIMEOUT,this.transport=null,this.heartbeatIntervalMs=CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop$1,this.ref=0,this.reconnectTimer=null,this.logger=noop$1,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=j=>{let _e;return j?_e=j:typeof fetch>"u"?_e=(...et)=>__vitePreload(async()=>{const{default:tt}=await Promise.resolve().then(()=>browser);return{default:tt}},void 0).then(({default:tt})=>tt(...et)).catch(tt=>{throw new Error(`Failed to load @supabase/node-fetch: ${tt.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):_e=fetch,(...et)=>_e(...et)},!(!(($=_==null?void 0:_.params)===null||$===void 0)&&$.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=_.params.apikey,this.endPoint=`${i}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(i),this._initializeOptions(_),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(_==null?void 0:_.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WebSocketFactory.createWebSocket(this.endpointURL())}catch(i){this._setConnectionState("disconnected");const _=i.message;throw _.includes("Node.js")?new Error(`${_}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${_}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(i,_){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const $=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout($),this._setConnectionState("disconnected")},i?this.conn.close(i,_??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(i){const _=await i.unsubscribe();return this.channels.length===0&&this.disconnect(),_}async removeAllChannels(){const i=await Promise.all(this.channels.map(_=>_.unsubscribe()));return this.channels=[],this.disconnect(),i}log(i,_,$){this.logger(i,_,$)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(i,_={config:{}}){const $=`realtime:${i}`,j=this.getChannels().find(_e=>_e.topic===$);if(j)return j;{const _e=new RealtimeChannel(`realtime:${i}`,_,this);return this.channels.push(_e),_e}}push(i){const{topic:_,event:$,payload:j,ref:_e}=i,et=()=>{this.encode(i,tt=>{var rt;(rt=this.conn)===null||rt===void 0||rt.send(tt)})};this.log("push",`${_} ${$} (${_e})`,j),this.isConnected()?et():this.sendBuffer.push(et)}async setAuth(i=null){this._authPromise=this._performAuth(i);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var i;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(_){this.log("error","error in heartbeat callback",_)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(_){this.log("error","error in heartbeat callback",_)}this._wasManualDisconnect=!1,(i=this.conn)===null||i===void 0||i.close(WS_CLOSE_NORMAL,"heartbeat timeout"),setTimeout(()=>{var _;this.isConnected()||(_=this.reconnectTimer)===null||_===void 0||_.scheduleTimeout()},CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(_){this.log("error","error in heartbeat callback",_)}this._setAuthSafely("heartbeat")}onHeartbeat(i){this.heartbeatCallback=i}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let _=this.channels.find($=>$.topic===i&&($._isJoined()||$._isJoining()));_&&(this.log("transport",`leaving duplicate topic "${i}"`),_.unsubscribe())}_remove(i){this.channels=this.channels.filter(_=>_.topic!==i.topic)}_onConnMessage(i){this.decode(i.data,_=>{if(_.topic==="phoenix"&&_.event==="phx_reply")try{this.heartbeatCallback(_.payload.status==="ok"?"ok":"error")}catch(nt){this.log("error","error in heartbeat callback",nt)}_.ref&&_.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:$,event:j,payload:_e,ref:et}=_,tt=et?`(${et})`:"",rt=_e.status||"";this.log("receive",`${rt} ${$} ${j} ${tt}`.trim(),_e),this.channels.filter(nt=>nt._isMember($)).forEach(nt=>nt._trigger(j,_e,et)),this._triggerStateCallbacks("message",_)})}_clearTimer(i){var _;i==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):i==="reconnect"&&((_=this.reconnectTimer)===null||_===void 0||_.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(i=>i.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const i=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(i),this.workerRef.onerror=_=>{this.log("worker","worker error",_.message),this.workerRef.terminate()},this.workerRef.onmessage=_=>{_.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(i){var _;this._setConnectionState("disconnected"),this.log("transport","close",i),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(_=this.reconnectTimer)===null||_===void 0||_.scheduleTimeout(),this._triggerStateCallbacks("close",i)}_onConnError(i){this._setConnectionState("disconnected"),this.log("transport",`${i}`),this._triggerChanError(),this._triggerStateCallbacks("error",i)}_triggerChanError(){this.channels.forEach(i=>i._trigger(CHANNEL_EVENTS.error))}_appendParams(i,_){if(Object.keys(_).length===0)return i;const $=i.match(/\?/)?"&":"?",j=new URLSearchParams(_);return`${i}${$}${j}`}_workerObjectUrl(i){let _;if(i)_=i;else{const $=new Blob([WORKER_SCRIPT],{type:"application/javascript"});_=URL.createObjectURL($)}return _}_setConnectionState(i,_=!1){this._connectionState=i,i==="connecting"?this._wasManualDisconnect=!1:i==="disconnecting"&&(this._wasManualDisconnect=_)}async _performAuth(i=null){let _;i?_=i:this.accessToken?_=await this.accessToken():_=this.accessTokenValue,this.accessTokenValue!=_&&(this.accessTokenValue=_,this.channels.forEach($=>{const j={access_token:_,version:DEFAULT_VERSION};_&&$.updateJoinPayload(j),$.joinedOnce&&$._isJoined()&&$._push(CHANNEL_EVENTS.access_token,{access_token:_})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(i="general"){this.setAuth().catch(_=>{this.log("error",`error setting auth in ${i}`,_)})}_triggerStateCallbacks(i,_){try{this.stateChangeCallbacks[i].forEach($=>{try{$(_)}catch(j){this.log("error",`error in ${i} callback`,j)}})}catch($){this.log("error",`error triggering ${i} callbacks`,$)}}_setupReconnectionTimer(){this.reconnectTimer=new Timer(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},CONNECTION_TIMEOUTS.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(i){var _,$,j,_e,et,tt,rt,nt,it;if(this.transport=(_=i==null?void 0:i.transport)!==null&&_!==void 0?_:null,this.timeout=($=i==null?void 0:i.timeout)!==null&&$!==void 0?$:DEFAULT_TIMEOUT,this.heartbeatIntervalMs=(j=i==null?void 0:i.heartbeatIntervalMs)!==null&&j!==void 0?j:CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.worker=(_e=i==null?void 0:i.worker)!==null&&_e!==void 0?_e:!1,this.accessToken=(et=i==null?void 0:i.accessToken)!==null&&et!==void 0?et:null,this.heartbeatCallback=(tt=i==null?void 0:i.heartbeatCallback)!==null&&tt!==void 0?tt:noop$1,i!=null&&i.params&&(this.params=i.params),i!=null&&i.logger&&(this.logger=i.logger),(i!=null&&i.logLevel||i!=null&&i.log_level)&&(this.logLevel=i.logLevel||i.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(rt=i==null?void 0:i.reconnectAfterMs)!==null&&rt!==void 0?rt:st=>RECONNECT_INTERVALS[st-1]||DEFAULT_RECONNECT_FALLBACK,this.encode=(nt=i==null?void 0:i.encode)!==null&&nt!==void 0?nt:(st,at)=>at(JSON.stringify(st)),this.decode=(it=i==null?void 0:i.decode)!==null&&it!==void 0?it:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=i==null?void 0:i.workerUrl}}}class StorageError extends Error{constructor(i){super(i),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class StorageApiError extends StorageError{constructor(i,_,$){super(i),this.name="StorageApiError",this.status=_,this.statusCode=$}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class StorageUnknownError extends StorageError{constructor(i,_){super(i),this.name="StorageUnknownError",this.originalError=_}}var __awaiter$6=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};const resolveFetch$2=o=>{let i;return o?i=o:typeof fetch>"u"?i=(..._)=>__vitePreload(async()=>{const{default:$}=await Promise.resolve().then(()=>browser);return{default:$}},void 0).then(({default:$})=>$(..._)):i=fetch,(..._)=>i(..._)},resolveResponse=()=>__awaiter$6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=o=>{if(Array.isArray(o))return o.map(_=>recursiveToCamel(_));if(typeof o=="function"||o!==Object(o))return o;const i={};return Object.entries(o).forEach(([_,$])=>{const j=_.replace(/([-_][a-z])/gi,_e=>_e.toUpperCase().replace(/[-_]/g,""));i[j]=recursiveToCamel($)}),i},isPlainObject=o=>{if(typeof o!="object"||o===null)return!1;const i=Object.getPrototypeOf(o);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)};var __awaiter$5=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};const _getErrorMessage$1=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),handleError$1=(o,i,_)=>__awaiter$5(void 0,void 0,void 0,function*(){const $=yield resolveResponse();o instanceof $&&!(_!=null&&_.noResolveJson)?o.json().then(j=>{const _e=o.status||500,et=(j==null?void 0:j.statusCode)||_e+"";i(new StorageApiError(_getErrorMessage$1(j),_e,et))}).catch(j=>{i(new StorageUnknownError(_getErrorMessage$1(j),j))}):i(new StorageUnknownError(_getErrorMessage$1(o),o))}),_getRequestParams$1=(o,i,_,$)=>{const j={method:o,headers:(i==null?void 0:i.headers)||{}};return o==="GET"||!$?j:(isPlainObject($)?(j.headers=Object.assign({"Content-Type":"application/json"},i==null?void 0:i.headers),j.body=JSON.stringify($)):j.body=$,i!=null&&i.duplex&&(j.duplex=i.duplex),Object.assign(Object.assign({},j),_))};function _handleRequest$1(o,i,_,$,j,_e){return __awaiter$5(this,void 0,void 0,function*(){return new Promise((et,tt)=>{o(_,_getRequestParams$1(i,$,j,_e)).then(rt=>{if(!rt.ok)throw rt;return $!=null&&$.noResolveJson?rt:rt.json()}).then(rt=>et(rt)).catch(rt=>handleError$1(rt,tt,$))})})}function get$1(o,i,_,$){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(o,"GET",i,_,$)})}function post(o,i,_,$,j){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(o,"POST",i,$,j,_)})}function put(o,i,_,$,j){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(o,"PUT",i,$,j,_)})}function head(o,i,_,$){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(o,"HEAD",i,Object.assign(Object.assign({},_),{noResolveJson:!0}),$)})}function remove(o,i,_,$,j){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(o,"DELETE",i,$,j,_)})}var __awaiter$4=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(i,_={},$,j){this.shouldThrowOnError=!1,this.url=i,this.headers=_,this.bucketId=$,this.fetch=resolveFetch$2(j)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(i,_,$,j){return __awaiter$4(this,void 0,void 0,function*(){try{let _e;const et=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),j);let tt=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String(et.upsert)});const rt=et.metadata;typeof Blob<"u"&&$ instanceof Blob?(_e=new FormData,_e.append("cacheControl",et.cacheControl),rt&&_e.append("metadata",this.encodeMetadata(rt)),_e.append("",$)):typeof FormData<"u"&&$ instanceof FormData?(_e=$,_e.append("cacheControl",et.cacheControl),rt&&_e.append("metadata",this.encodeMetadata(rt))):(_e=$,tt["cache-control"]=`max-age=${et.cacheControl}`,tt["content-type"]=et.contentType,rt&&(tt["x-metadata"]=this.toBase64(this.encodeMetadata(rt)))),j!=null&&j.headers&&(tt=Object.assign(Object.assign({},tt),j.headers));const nt=this._removeEmptyFolders(_),it=this._getFinalPath(nt),st=yield(i=="PUT"?put:post)(this.fetch,`${this.url}/object/${it}`,_e,Object.assign({headers:tt},et!=null&&et.duplex?{duplex:et.duplex}:{}));return{data:{path:nt,id:st.Id,fullPath:st.Key},error:null}}catch(_e){if(this.shouldThrowOnError)throw _e;if(isStorageError(_e))return{data:null,error:_e};throw _e}})}upload(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,_,$)})}uploadToSignedUrl(i,_,$,j){return __awaiter$4(this,void 0,void 0,function*(){const _e=this._removeEmptyFolders(i),et=this._getFinalPath(_e),tt=new URL(this.url+`/object/upload/sign/${et}`);tt.searchParams.set("token",_);try{let rt;const nt=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},j),it=Object.assign(Object.assign({},this.headers),{"x-upsert":String(nt.upsert)});typeof Blob<"u"&&$ instanceof Blob?(rt=new FormData,rt.append("cacheControl",nt.cacheControl),rt.append("",$)):typeof FormData<"u"&&$ instanceof FormData?(rt=$,rt.append("cacheControl",nt.cacheControl)):(rt=$,it["cache-control"]=`max-age=${nt.cacheControl}`,it["content-type"]=nt.contentType);const st=yield put(this.fetch,tt.toString(),rt,{headers:it});return{data:{path:_e,fullPath:st.Key},error:null}}catch(rt){if(this.shouldThrowOnError)throw rt;if(isStorageError(rt))return{data:null,error:rt};throw rt}})}createSignedUploadUrl(i,_){return __awaiter$4(this,void 0,void 0,function*(){try{let $=this._getFinalPath(i);const j=Object.assign({},this.headers);_!=null&&_.upsert&&(j["x-upsert"]="true");const _e=yield post(this.fetch,`${this.url}/object/upload/sign/${$}`,{},{headers:j}),et=new URL(this.url+_e.url),tt=et.searchParams.get("token");if(!tt)throw new StorageError("No token returned by API");return{data:{signedUrl:et.toString(),path:i,token:tt},error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($))return{data:null,error:$};throw $}})}update(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,_,$)})}move(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:_,destinationBucket:$==null?void 0:$.destinationBucket},{headers:this.headers}),error:null}}catch(j){if(this.shouldThrowOnError)throw j;if(isStorageError(j))return{data:null,error:j};throw j}})}copy(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:i,destinationKey:_,destinationBucket:$==null?void 0:$.destinationBucket},{headers:this.headers})).Key},error:null}}catch(j){if(this.shouldThrowOnError)throw j;if(isStorageError(j))return{data:null,error:j};throw j}})}createSignedUrl(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){try{let j=this._getFinalPath(i),_e=yield post(this.fetch,`${this.url}/object/sign/${j}`,Object.assign({expiresIn:_},$!=null&&$.transform?{transform:$.transform}:{}),{headers:this.headers});const et=$!=null&&$.download?`&download=${$.download===!0?"":$.download}`:"";return _e={signedUrl:encodeURI(`${this.url}${_e.signedURL}${et}`)},{data:_e,error:null}}catch(j){if(this.shouldThrowOnError)throw j;if(isStorageError(j))return{data:null,error:j};throw j}})}createSignedUrls(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){try{const j=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:_,paths:i},{headers:this.headers}),_e=$!=null&&$.download?`&download=${$.download===!0?"":$.download}`:"";return{data:j.map(et=>Object.assign(Object.assign({},et),{signedUrl:et.signedURL?encodeURI(`${this.url}${et.signedURL}${_e}`):null})),error:null}}catch(j){if(this.shouldThrowOnError)throw j;if(isStorageError(j))return{data:null,error:j};throw j}})}download(i,_){return __awaiter$4(this,void 0,void 0,function*(){const j=typeof(_==null?void 0:_.transform)<"u"?"render/image/authenticated":"object",_e=this.transformOptsToQueryString((_==null?void 0:_.transform)||{}),et=_e?`?${_e}`:"";try{const tt=this._getFinalPath(i);return{data:yield(yield get$1(this.fetch,`${this.url}/${j}/${tt}${et}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(tt){if(this.shouldThrowOnError)throw tt;if(isStorageError(tt))return{data:null,error:tt};throw tt}})}info(i){return __awaiter$4(this,void 0,void 0,function*(){const _=this._getFinalPath(i);try{const $=yield get$1(this.fetch,`${this.url}/object/info/${_}`,{headers:this.headers});return{data:recursiveToCamel($),error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($))return{data:null,error:$};throw $}})}exists(i){return __awaiter$4(this,void 0,void 0,function*(){const _=this._getFinalPath(i);try{return yield head(this.fetch,`${this.url}/object/${_}`,{headers:this.headers}),{data:!0,error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($)&&$ instanceof StorageUnknownError){const j=$.originalError;if([400,404].includes(j==null?void 0:j.status))return{data:!1,error:$}}throw $}})}getPublicUrl(i,_){const $=this._getFinalPath(i),j=[],_e=_!=null&&_.download?`download=${_.download===!0?"":_.download}`:"";_e!==""&&j.push(_e);const tt=typeof(_==null?void 0:_.transform)<"u"?"render/image":"object",rt=this.transformOptsToQueryString((_==null?void 0:_.transform)||{});rt!==""&&j.push(rt);let nt=j.join("&");return nt!==""&&(nt=`?${nt}`),{data:{publicUrl:encodeURI(`${this.url}/${tt}/public/${$}${nt}`)}}}remove(i){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(_){if(this.shouldThrowOnError)throw _;if(isStorageError(_))return{data:null,error:_};throw _}})}list(i,_,$){return __awaiter$4(this,void 0,void 0,function*(){try{const j=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),_),{prefix:i||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,j,{headers:this.headers},$),error:null}}catch(j){if(this.shouldThrowOnError)throw j;if(isStorageError(j))return{data:null,error:j};throw j}})}listV2(i,_){return __awaiter$4(this,void 0,void 0,function*(){try{const $=Object.assign({},i);return{data:yield post(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,$,{headers:this.headers},_),error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($))return{data:null,error:$};throw $}})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const _=[];return i.width&&_.push(`width=${i.width}`),i.height&&_.push(`height=${i.height}`),i.resize&&_.push(`resize=${i.resize}`),i.format&&_.push(`format=${i.format}`),i.quality&&_.push(`quality=${i.quality}`),_.join("&")}}const version$2="2.12.1",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$2}`};var __awaiter$3=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};class StorageBucketApi{constructor(i,_={},$,j){this.shouldThrowOnError=!1;const _e=new URL(i);j!=null&&j.useNewHostname&&/supabase\.(co|in|red)$/.test(_e.hostname)&&!_e.hostname.includes("storage.supabase.")&&(_e.hostname=_e.hostname.replace("supabase.","storage.supabase.")),this.url=_e.href,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),_),this.fetch=resolveFetch$2($)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}getBucket(i){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get$1(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(_){if(this.shouldThrowOnError)throw _;if(isStorageError(_))return{data:null,error:_};throw _}})}createBucket(i,_={public:!1}){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:i,name:i,type:_.type,public:_.public,file_size_limit:_.fileSizeLimit,allowed_mime_types:_.allowedMimeTypes},{headers:this.headers}),error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($))return{data:null,error:$};throw $}})}updateBucket(i,_){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:_.public,file_size_limit:_.fileSizeLimit,allowed_mime_types:_.allowedMimeTypes},{headers:this.headers}),error:null}}catch($){if(this.shouldThrowOnError)throw $;if(isStorageError($))return{data:null,error:$};throw $}})}emptyBucket(i){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(_){if(this.shouldThrowOnError)throw _;if(isStorageError(_))return{data:null,error:_};throw _}})}deleteBucket(i){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(_){if(this.shouldThrowOnError)throw _;if(isStorageError(_))return{data:null,error:_};throw _}})}}class StorageClient extends StorageBucketApi{constructor(i,_={},$,j){super(i,_,$,j)}from(i){return new StorageFileApi(this.url,this.headers,i,this.fetch)}}const version$1="2.57.4";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$1}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$2=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};const resolveFetch$1=o=>{let i;return o?i=o:typeof fetch>"u"?i=nodeFetch:i=fetch,(..._)=>i(..._)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(o,i,_)=>{const $=resolveFetch$1(_),j=resolveHeadersConstructor();return(_e,et)=>__awaiter$2(void 0,void 0,void 0,function*(){var tt;const rt=(tt=yield i())!==null&&tt!==void 0?tt:o;let nt=new j(et==null?void 0:et.headers);return nt.has("apikey")||nt.set("apikey",o),nt.has("Authorization")||nt.set("Authorization",`Bearer ${rt}`),$(_e,Object.assign(Object.assign({},et),{headers:nt}))})};var __awaiter$1=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};function ensureTrailingSlash(o){return o.endsWith("/")?o:o+"/"}function applySettingDefaults(o,i){var _,$;const{db:j,auth:_e,realtime:et,global:tt}=o,{db:rt,auth:nt,realtime:it,global:st}=i,at={db:Object.assign(Object.assign({},rt),j),auth:Object.assign(Object.assign({},nt),_e),realtime:Object.assign(Object.assign({},it),et),storage:{},global:Object.assign(Object.assign(Object.assign({},st),tt),{headers:Object.assign(Object.assign({},(_=st==null?void 0:st.headers)!==null&&_!==void 0?_:{}),($=tt==null?void 0:tt.headers)!==null&&$!==void 0?$:{})}),accessToken:()=>__awaiter$1(this,void 0,void 0,function*(){return""})};return o.accessToken?at.accessToken=o.accessToken:delete at.accessToken,at}function validateSupabaseUrl(o){const i=o==null?void 0:o.trim();if(!i)throw new Error("supabaseUrl is required.");if(!i.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ensureTrailingSlash(i))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const version="2.71.1",AUTO_REFRESH_TICK_DURATION_MS=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3,EXPIRY_MARGIN_MS=AUTO_REFRESH_TICK_THRESHOLD*AUTO_REFRESH_TICK_DURATION_MS,GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version}`},API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},BASE64URL_REGEX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JWKS_TTL=10*60*1e3;class AuthError extends Error{constructor(i,_,$){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=_,this.code=$}}function isAuthError(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class AuthApiError extends AuthError{constructor(i,_,$){super(i,_,$),this.name="AuthApiError",this.status=_,this.code=$}}function isAuthApiError(o){return isAuthError(o)&&o.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(i,_){super(i),this.name="AuthUnknownError",this.originalError=_}}class CustomAuthError extends AuthError{constructor(i,_,$,j){super(i,$,j),this.name=_,this.status=$}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(o){return isAuthError(o)&&o.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(i,_=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=_}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(o){return isAuthError(o)&&o.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(i,_=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=_}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(i,_){super(i,"AuthRetryableFetchError",_,void 0)}}function isAuthRetryableFetchError(o){return isAuthError(o)&&o.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(i,_,$){super(i,"AuthWeakPasswordError",_,"weak_password"),this.reasons=$}}class AuthInvalidJwtError extends CustomAuthError{constructor(i){super(i,"AuthInvalidJwtError",400,"invalid_jwt")}}const TO_BASE64URL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),IGNORE_BASE64URL=` 	
\r=`.split(""),FROM_BASE64URL=(()=>{const o=new Array(128);for(let i=0;i<o.length;i+=1)o[i]=-1;for(let i=0;i<IGNORE_BASE64URL.length;i+=1)o[IGNORE_BASE64URL[i].charCodeAt(0)]=-2;for(let i=0;i<TO_BASE64URL.length;i+=1)o[TO_BASE64URL[i].charCodeAt(0)]=i;return o})();function byteToBase64URL(o,i,_){if(o!==null)for(i.queue=i.queue<<8|o,i.queuedBits+=8;i.queuedBits>=6;){const $=i.queue>>i.queuedBits-6&63;_(TO_BASE64URL[$]),i.queuedBits-=6}else if(i.queuedBits>0)for(i.queue=i.queue<<6-i.queuedBits,i.queuedBits=6;i.queuedBits>=6;){const $=i.queue>>i.queuedBits-6&63;_(TO_BASE64URL[$]),i.queuedBits-=6}}function byteFromBase64URL(o,i,_){const $=FROM_BASE64URL[o];if($>-1)for(i.queue=i.queue<<6|$,i.queuedBits+=6;i.queuedBits>=8;)_(i.queue>>i.queuedBits-8&255),i.queuedBits-=8;else{if($===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function stringFromBase64URL(o){const i=[],_=et=>{i.push(String.fromCodePoint(et))},$={utf8seq:0,codepoint:0},j={queue:0,queuedBits:0},_e=et=>{stringFromUTF8(et,$,_)};for(let et=0;et<o.length;et+=1)byteFromBase64URL(o.charCodeAt(et),j,_e);return i.join("")}function codepointToUTF8(o,i){if(o<=127){i(o);return}else if(o<=2047){i(192|o>>6),i(128|o&63);return}else if(o<=65535){i(224|o>>12),i(128|o>>6&63),i(128|o&63);return}else if(o<=1114111){i(240|o>>18),i(128|o>>12&63),i(128|o>>6&63),i(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function stringToUTF8(o,i){for(let _=0;_<o.length;_+=1){let $=o.charCodeAt(_);if($>55295&&$<=56319){const j=($-55296)*1024&65535;$=(o.charCodeAt(_+1)-56320&65535|j)+65536,_+=1}codepointToUTF8($,i)}}function stringFromUTF8(o,i,_){if(i.utf8seq===0){if(o<=127){_(o);return}for(let $=1;$<6;$+=1)if(!(o>>7-$&1)){i.utf8seq=$;break}if(i.utf8seq===2)i.codepoint=o&31;else if(i.utf8seq===3)i.codepoint=o&15;else if(i.utf8seq===4)i.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");i.utf8seq-=1}else if(i.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");i.codepoint=i.codepoint<<6|o&63,i.utf8seq-=1,i.utf8seq===0&&_(i.codepoint)}}function base64UrlToUint8Array(o){const i=[],_={queue:0,queuedBits:0},$=j=>{i.push(j)};for(let j=0;j<o.length;j+=1)byteFromBase64URL(o.charCodeAt(j),_,$);return new Uint8Array(i)}function stringToUint8Array(o){const i=[];return stringToUTF8(o,_=>i.push(_)),new Uint8Array(i)}function bytesToBase64URL(o){const i=[],_={queue:0,queuedBits:0},$=j=>{i.push(j)};return o.forEach(j=>byteToBase64URL(j,_,$)),byteToBase64URL(null,_,$),i.join("")}function expiresAt(o){return Math.round(Date.now()/1e3)+o}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const i=Math.random()*16|0;return(o=="x"?i:i&3|8).toString(16)})}const isBrowser=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(o){const i={},_=new URL(o);if(_.hash&&_.hash[0]==="#")try{new URLSearchParams(_.hash.substring(1)).forEach((j,_e)=>{i[_e]=j})}catch{}return _.searchParams.forEach(($,j)=>{i[j]=$}),i}const resolveFetch=o=>{let i;return o?i=o:typeof fetch>"u"?i=(..._)=>__vitePreload(async()=>{const{default:$}=await Promise.resolve().then(()=>browser);return{default:$}},void 0).then(({default:$})=>$(..._)):i=fetch,(..._)=>i(..._)},looksLikeFetchResponse=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",setItemAsync=async(o,i,_)=>{await o.setItem(i,JSON.stringify(_))},getItemAsync=async(o,i)=>{const _=await o.getItem(i);if(!_)return null;try{return JSON.parse(_)}catch{return _}},removeItemAsync=async(o,i)=>{await o.removeItem(i)};class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((i,_)=>{this.resolve=i,this.reject=_})}}Deferred.promiseConstructor=Promise;function decodeJWT(o){const i=o.split(".");if(i.length!==3)throw new AuthInvalidJwtError("Invalid JWT structure");for(let $=0;$<i.length;$++)if(!BASE64URL_REGEX.test(i[$]))throw new AuthInvalidJwtError("JWT not in base64url format");return{header:JSON.parse(stringFromBase64URL(i[0])),payload:JSON.parse(stringFromBase64URL(i[1])),signature:base64UrlToUint8Array(i[2]),raw:{header:i[0],payload:i[1]}}}async function sleep(o){return await new Promise(i=>{setTimeout(()=>i(null),o)})}function retryable(o,i){return new Promise(($,j)=>{(async()=>{for(let _e=0;_e<1/0;_e++)try{const et=await o(_e);if(!i(_e,null,et)){$(et);return}}catch(et){if(!i(_e,et)){j(et);return}}})()})}function dec2hex(o){return("0"+o.toString(16)).substr(-2)}function generatePKCEVerifier(){const i=new Uint32Array(56);if(typeof crypto>"u"){const _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",$=_.length;let j="";for(let _e=0;_e<56;_e++)j+=_.charAt(Math.floor(Math.random()*$));return j}return crypto.getRandomValues(i),Array.from(i,dec2hex).join("")}async function sha256(o){const _=new TextEncoder().encode(o),$=await crypto.subtle.digest("SHA-256",_),j=new Uint8Array($);return Array.from(j).map(_e=>String.fromCharCode(_e)).join("")}async function generatePKCEChallenge(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const _=await sha256(o);return btoa(_).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function getCodeChallengeAndMethod(o,i,_=!1){const $=generatePKCEVerifier();let j=$;_&&(j+="/PASSWORD_RECOVERY"),await setItemAsync(o,`${i}-code-verifier`,j);const _e=await generatePKCEChallenge($);return[_e,$===_e?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(o){const i=o.headers.get(API_VERSION_HEADER_NAME);if(!i||!i.match(API_VERSION_REGEX))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}function validateExp(o){if(!o)throw new Error("Missing exp claim");const i=Math.floor(Date.now()/1e3);if(o<=i)throw new Error("JWT has expired")}function getAlgorithm(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const UUID_REGEX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function validateUUID(o){if(!UUID_REGEX.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function userNotAvailableProxy(){const o={};return new Proxy(o,{get:(i,_)=>{if(_==="__isUserNotAvailableProxy")return!0;if(typeof _=="symbol"){const $=_.toString();if($==="Symbol(Symbol.toPrimitive)"||$==="Symbol(Symbol.toStringTag)"||$==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${_}" property of the session object is not supported. Please use getUser() instead.`)},set:(i,_)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${_}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(i,_)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${_}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function deepClone(o){return JSON.parse(JSON.stringify(o))}var __rest$1=function(o,i){var _={};for(var $ in o)Object.prototype.hasOwnProperty.call(o,$)&&i.indexOf($)<0&&(_[$]=o[$]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,$=Object.getOwnPropertySymbols(o);j<$.length;j++)i.indexOf($[j])<0&&Object.prototype.propertyIsEnumerable.call(o,$[j])&&(_[$[j]]=o[$[j]]);return _};const _getErrorMessage=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),NETWORK_ERROR_CODES=[502,503,504];async function handleError(o){var i;if(!looksLikeFetchResponse(o))throw new AuthRetryableFetchError(_getErrorMessage(o),0);if(NETWORK_ERROR_CODES.includes(o.status))throw new AuthRetryableFetchError(_getErrorMessage(o),o.status);let _;try{_=await o.json()}catch(_e){throw new AuthUnknownError(_getErrorMessage(_e),_e)}let $;const j=parseResponseAPIVersion(o);if(j&&j.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof _=="object"&&_&&typeof _.code=="string"?$=_.code:typeof _=="object"&&_&&typeof _.error_code=="string"&&($=_.error_code),$){if($==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(_),o.status,((i=_.weak_password)===null||i===void 0?void 0:i.reasons)||[]);if($==="session_not_found")throw new AuthSessionMissingError}else if(typeof _=="object"&&_&&typeof _.weak_password=="object"&&_.weak_password&&Array.isArray(_.weak_password.reasons)&&_.weak_password.reasons.length&&_.weak_password.reasons.reduce((_e,et)=>_e&&typeof et=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(_),o.status,_.weak_password.reasons);throw new AuthApiError(_getErrorMessage(_),o.status||500,$)}const _getRequestParams=(o,i,_,$)=>{const j={method:o,headers:(i==null?void 0:i.headers)||{}};return o==="GET"?j:(j.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i==null?void 0:i.headers),j.body=JSON.stringify($),Object.assign(Object.assign({},j),_))};async function _request(o,i,_,$){var j;const _e=Object.assign({},$==null?void 0:$.headers);_e[API_VERSION_HEADER_NAME]||(_e[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),$!=null&&$.jwt&&(_e.Authorization=`Bearer ${$.jwt}`);const et=(j=$==null?void 0:$.query)!==null&&j!==void 0?j:{};$!=null&&$.redirectTo&&(et.redirect_to=$.redirectTo);const tt=Object.keys(et).length?"?"+new URLSearchParams(et).toString():"",rt=await _handleRequest(o,i,_+tt,{headers:_e,noResolveJson:$==null?void 0:$.noResolveJson},{},$==null?void 0:$.body);return $!=null&&$.xform?$==null?void 0:$.xform(rt):{data:Object.assign({},rt),error:null}}async function _handleRequest(o,i,_,$,j,_e){const et=_getRequestParams(i,$,j,_e);let tt;try{tt=await o(_,Object.assign({},et))}catch(rt){throw console.error(rt),new AuthRetryableFetchError(_getErrorMessage(rt),0)}if(tt.ok||await handleError(tt),$!=null&&$.noResolveJson)return tt;try{return await tt.json()}catch(rt){await handleError(rt)}}function _sessionResponse(o){var i;let _=null;hasSession(o)&&(_=Object.assign({},o),o.expires_at||(_.expires_at=expiresAt(o.expires_in)));const $=(i=o.user)!==null&&i!==void 0?i:o;return{data:{session:_,user:$},error:null}}function _sessionResponsePassword(o){const i=_sessionResponse(o);return!i.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((_,$)=>_&&typeof $=="string",!0)&&(i.data.weak_password=o.weak_password),i}function _userResponse(o){var i;return{data:{user:(i=o.user)!==null&&i!==void 0?i:o},error:null}}function _ssoResponse(o){return{data:o,error:null}}function _generateLinkResponse(o){const{action_link:i,email_otp:_,hashed_token:$,redirect_to:j,verification_type:_e}=o,et=__rest$1(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),tt={action_link:i,email_otp:_,hashed_token:$,redirect_to:j,verification_type:_e},rt=Object.assign({},et);return{data:{properties:tt,user:rt},error:null}}function _noResolveJsonResponse(o){return o}function hasSession(o){return o.access_token&&o.refresh_token&&o.expires_in}const SIGN_OUT_SCOPES=["global","local","others"];var __rest=function(o,i){var _={};for(var $ in o)Object.prototype.hasOwnProperty.call(o,$)&&i.indexOf($)<0&&(_[$]=o[$]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,$=Object.getOwnPropertySymbols(o);j<$.length;j++)i.indexOf($[j])<0&&Object.prototype.propertyIsEnumerable.call(o,$[j])&&(_[$[j]]=o[$[j]]);return _};class GoTrueAdminApi{constructor({url:i="",headers:_={},fetch:$}){this.url=i,this.headers=_,this.fetch=resolveFetch($),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(i,_=SIGN_OUT_SCOPES[0]){if(SIGN_OUT_SCOPES.indexOf(_)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(", ")}`);try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${_}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch($){if(isAuthError($))return{data:null,error:$};throw $}}async inviteUserByEmail(i,_={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:_.data},headers:this.headers,redirectTo:_.redirectTo,xform:_userResponse})}catch($){if(isAuthError($))return{data:{user:null},error:$};throw $}}async generateLink(i){try{const{options:_}=i,$=__rest(i,["options"]),j=Object.assign(Object.assign({},$),_);return"newEmail"in $&&(j.new_email=$==null?void 0:$.newEmail,delete j.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:j,headers:this.headers,xform:_generateLinkResponse,redirectTo:_==null?void 0:_.redirectTo})}catch(_){if(isAuthError(_))return{data:{properties:null,user:null},error:_};throw _}}async createUser(i){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:_userResponse})}catch(_){if(isAuthError(_))return{data:{user:null},error:_};throw _}}async listUsers(i){var _,$,j,_e,et,tt,rt;try{const nt={nextPage:null,lastPage:0,total:0},it=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:($=(_=i==null?void 0:i.page)===null||_===void 0?void 0:_.toString())!==null&&$!==void 0?$:"",per_page:(_e=(j=i==null?void 0:i.perPage)===null||j===void 0?void 0:j.toString())!==null&&_e!==void 0?_e:""},xform:_noResolveJsonResponse});if(it.error)throw it.error;const st=await it.json(),at=(et=it.headers.get("x-total-count"))!==null&&et!==void 0?et:0,ot=(rt=(tt=it.headers.get("link"))===null||tt===void 0?void 0:tt.split(","))!==null&&rt!==void 0?rt:[];return ot.length>0&&(ot.forEach(lt=>{const ct=parseInt(lt.split(";")[0].split("=")[1].substring(0,1)),ft=JSON.parse(lt.split(";")[1].split("=")[1]);nt[`${ft}Page`]=ct}),nt.total=parseInt(at)),{data:Object.assign(Object.assign({},st),nt),error:null}}catch(nt){if(isAuthError(nt))return{data:{users:[]},error:nt};throw nt}}async getUserById(i){validateUUID(i);try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:_userResponse})}catch(_){if(isAuthError(_))return{data:{user:null},error:_};throw _}}async updateUserById(i,_){validateUUID(i);try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:_,headers:this.headers,xform:_userResponse})}catch($){if(isAuthError($))return{data:{user:null},error:$};throw $}}async deleteUser(i,_=!1){validateUUID(i);try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:_},xform:_userResponse})}catch($){if(isAuthError($))return{data:{user:null},error:$};throw $}}async _listFactors(i){validateUUID(i.userId);try{const{data:_,error:$}=await _request(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:j=>({data:{factors:j},error:null})});return{data:_,error:$}}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}async _deleteFactor(i){validateUUID(i.userId),validateUUID(i.id);try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}}function memoryLocalStorageAdapter(o={}){return{getItem:i=>o[i]||null,setItem:(i,_)=>{o[i]=_},removeItem:i=>{delete o[i]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(o,i,_){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,i);const $=new globalThis.AbortController;return i>0&&setTimeout(()=>{$.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},i),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:$.signal},async j=>{if(j){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,j.name);try{return await _()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,j.name)}}else{if(i===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(internals.debug)try{const _e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(_e,null,"  "))}catch(_e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",_e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await _()}}))}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lockNoOp(o,i,_){return await _()}const GLOBAL_JWKS={};class GoTrueClient{constructor(i){var _,$;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const j=Object.assign(Object.assign({},DEFAULT_OPTIONS),i);if(this.logDebugMessages=!!j.debug,typeof j.debug=="function"&&(this.logger=j.debug),this.persistSession=j.persistSession,this.storageKey=j.storageKey,this.autoRefreshToken=j.autoRefreshToken,this.admin=new GoTrueAdminApi({url:j.url,headers:j.headers,fetch:j.fetch}),this.url=j.url,this.headers=j.headers,this.fetch=resolveFetch(j.fetch),this.lock=j.lock||lockNoOp,this.detectSessionInUrl=j.detectSessionInUrl,this.flowType=j.flowType,this.hasCustomAuthorizationHeader=j.hasCustomAuthorizationHeader,j.lock?this.lock=j.lock:isBrowser()&&(!((_=globalThis==null?void 0:globalThis.navigator)===null||_===void 0)&&_.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(j.storage?this.storage=j.storage:supportsLocalStorage()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),j.userStorage&&(this.userStorage=j.userStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(_e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",_e)}($=this.broadcastChannel)===null||$===void 0||$.addEventListener("message",async _e=>{this._debug("received broadcast notification from other tab or client",_e),await this._notifyAllSubscribers(_e.data.event,_e.data.session,!1)})}this.initialize()}get jwks(){var i,_;return(_=(i=GLOBAL_JWKS[this.storageKey])===null||i===void 0?void 0:i.jwks)!==null&&_!==void 0?_:{keys:[]}}set jwks(i){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{jwks:i})}get jwks_cached_at(){var i,_;return(_=(i=GLOBAL_JWKS[this.storageKey])===null||i===void 0?void 0:i.cachedAt)!==null&&_!==void 0?_:Number.MIN_SAFE_INTEGER}set jwks_cached_at(i){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{cachedAt:i})}_debug(...i){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version}) ${new Date().toISOString()}`,...i),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var i;try{const _=parseParametersFromURL(window.location.href);let $="none";if(this._isImplicitGrantCallback(_)?$="implicit":await this._isPKCECallback(_)&&($="pkce"),isBrowser()&&this.detectSessionInUrl&&$!=="none"){const{data:j,error:_e}=await this._getSessionFromURL(_,$);if(_e){if(this._debug("#_initialize()","error detecting session from URL",_e),isAuthImplicitGrantRedirectError(_e)){const rt=(i=_e.details)===null||i===void 0?void 0:i.code;if(rt==="identity_already_exists"||rt==="identity_not_found"||rt==="single_identity_not_deletable")return{error:_e}}return await this._removeSession(),{error:_e}}const{session:et,redirectType:tt}=j;return this._debug("#_initialize()","detected session in URL",et,"redirect type",tt),await this._saveSession(et),setTimeout(async()=>{tt==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",et):await this._notifyAllSubscribers("SIGNED_IN",et)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(_){return isAuthError(_)?{error:_}:{error:new AuthUnknownError("Unexpected error during initialization",_)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(i){var _,$,j;try{const _e=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:($=(_=i==null?void 0:i.options)===null||_===void 0?void 0:_.data)!==null&&$!==void 0?$:{},gotrue_meta_security:{captcha_token:(j=i==null?void 0:i.options)===null||j===void 0?void 0:j.captchaToken}},xform:_sessionResponse}),{data:et,error:tt}=_e;if(tt||!et)return{data:{user:null,session:null},error:tt};const rt=et.session,nt=et.user;return et.session&&(await this._saveSession(et.session),await this._notifyAllSubscribers("SIGNED_IN",rt)),{data:{user:nt,session:rt},error:null}}catch(_e){if(isAuthError(_e))return{data:{user:null,session:null},error:_e};throw _e}}async signUp(i){var _,$,j;try{let _e;if("email"in i){const{email:it,password:st,options:at}=i;let ot=null,lt=null;this.flowType==="pkce"&&([ot,lt]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),_e=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:at==null?void 0:at.emailRedirectTo,body:{email:it,password:st,data:(_=at==null?void 0:at.data)!==null&&_!==void 0?_:{},gotrue_meta_security:{captcha_token:at==null?void 0:at.captchaToken},code_challenge:ot,code_challenge_method:lt},xform:_sessionResponse})}else if("phone"in i){const{phone:it,password:st,options:at}=i;_e=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:it,password:st,data:($=at==null?void 0:at.data)!==null&&$!==void 0?$:{},channel:(j=at==null?void 0:at.channel)!==null&&j!==void 0?j:"sms",gotrue_meta_security:{captcha_token:at==null?void 0:at.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:et,error:tt}=_e;if(tt||!et)return{data:{user:null,session:null},error:tt};const rt=et.session,nt=et.user;return et.session&&(await this._saveSession(et.session),await this._notifyAllSubscribers("SIGNED_IN",rt)),{data:{user:nt,session:rt},error:null}}catch(_e){if(isAuthError(_e))return{data:{user:null,session:null},error:_e};throw _e}}async signInWithPassword(i){try{let _;if("email"in i){const{email:_e,password:et,options:tt}=i;_=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:_e,password:et,gotrue_meta_security:{captcha_token:tt==null?void 0:tt.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in i){const{phone:_e,password:et,options:tt}=i;_=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:_e,password:et,gotrue_meta_security:{captcha_token:tt==null?void 0:tt.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:$,error:j}=_;return j?{data:{user:null,session:null},error:j}:!$||!$.session||!$.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:($.session&&(await this._saveSession($.session),await this._notifyAllSubscribers("SIGNED_IN",$.session)),{data:Object.assign({user:$.user,session:$.session},$.weak_password?{weakPassword:$.weak_password}:null),error:j})}catch(_){if(isAuthError(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithOAuth(i){var _,$,j,_e;return await this._handleProviderSignIn(i.provider,{redirectTo:(_=i.options)===null||_===void 0?void 0:_.redirectTo,scopes:($=i.options)===null||$===void 0?void 0:$.scopes,queryParams:(j=i.options)===null||j===void 0?void 0:j.queryParams,skipBrowserRedirect:(_e=i.options)===null||_e===void 0?void 0:_e.skipBrowserRedirect})}async exchangeCodeForSession(i){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(i))}async signInWithWeb3(i){const{chain:_}=i;if(_==="solana")return await this.signInWithSolana(i);throw new Error(`@supabase/auth-js: Unsupported chain "${_}"`)}async signInWithSolana(i){var _,$,j,_e,et,tt,rt,nt,it,st,at,ot;let lt,ct;if("message"in i)lt=i.message,ct=i.signature;else{const{chain:ft,wallet:ut,statement:ht,options:dt}=i;let mt;if(isBrowser())if(typeof ut=="object")mt=ut;else{const yt=window;if("solana"in yt&&typeof yt.solana=="object"&&("signIn"in yt.solana&&typeof yt.solana.signIn=="function"||"signMessage"in yt.solana&&typeof yt.solana.signMessage=="function"))mt=yt.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof ut!="object"||!(dt!=null&&dt.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");mt=ut}const pt=new URL((_=dt==null?void 0:dt.url)!==null&&_!==void 0?_:window.location.href);if("signIn"in mt&&mt.signIn){const yt=await mt.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},dt==null?void 0:dt.signInWithSolana),{version:"1",domain:pt.host,uri:pt.href}),ht?{statement:ht}:null));let gt;if(Array.isArray(yt)&&yt[0]&&typeof yt[0]=="object")gt=yt[0];else if(yt&&typeof yt=="object"&&"signedMessage"in yt&&"signature"in yt)gt=yt;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in gt&&"signature"in gt&&(typeof gt.signedMessage=="string"||gt.signedMessage instanceof Uint8Array)&&gt.signature instanceof Uint8Array)lt=typeof gt.signedMessage=="string"?gt.signedMessage:new TextDecoder().decode(gt.signedMessage),ct=gt.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in mt)||typeof mt.signMessage!="function"||!("publicKey"in mt)||typeof mt!="object"||!mt.publicKey||!("toBase58"in mt.publicKey)||typeof mt.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");lt=[`${pt.host} wants you to sign in with your Solana account:`,mt.publicKey.toBase58(),...ht?["",ht,""]:[""],"Version: 1",`URI: ${pt.href}`,`Issued At: ${(j=($=dt==null?void 0:dt.signInWithSolana)===null||$===void 0?void 0:$.issuedAt)!==null&&j!==void 0?j:new Date().toISOString()}`,...!((_e=dt==null?void 0:dt.signInWithSolana)===null||_e===void 0)&&_e.notBefore?[`Not Before: ${dt.signInWithSolana.notBefore}`]:[],...!((et=dt==null?void 0:dt.signInWithSolana)===null||et===void 0)&&et.expirationTime?[`Expiration Time: ${dt.signInWithSolana.expirationTime}`]:[],...!((tt=dt==null?void 0:dt.signInWithSolana)===null||tt===void 0)&&tt.chainId?[`Chain ID: ${dt.signInWithSolana.chainId}`]:[],...!((rt=dt==null?void 0:dt.signInWithSolana)===null||rt===void 0)&&rt.nonce?[`Nonce: ${dt.signInWithSolana.nonce}`]:[],...!((nt=dt==null?void 0:dt.signInWithSolana)===null||nt===void 0)&&nt.requestId?[`Request ID: ${dt.signInWithSolana.requestId}`]:[],...!((st=(it=dt==null?void 0:dt.signInWithSolana)===null||it===void 0?void 0:it.resources)===null||st===void 0)&&st.length?["Resources",...dt.signInWithSolana.resources.map(gt=>`- ${gt}`)]:[]].join(`
`);const yt=await mt.signMessage(new TextEncoder().encode(lt),"utf8");if(!yt||!(yt instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");ct=yt}}try{const{data:ft,error:ut}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:lt,signature:bytesToBase64URL(ct)},!((at=i.options)===null||at===void 0)&&at.captchaToken?{gotrue_meta_security:{captcha_token:(ot=i.options)===null||ot===void 0?void 0:ot.captchaToken}}:null),xform:_sessionResponse});if(ut)throw ut;return!ft||!ft.session||!ft.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(ft.session&&(await this._saveSession(ft.session),await this._notifyAllSubscribers("SIGNED_IN",ft.session)),{data:Object.assign({},ft),error:ut})}catch(ft){if(isAuthError(ft))return{data:{user:null,session:null},error:ft};throw ft}}async _exchangeCodeForSession(i){const _=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[$,j]=(_??"").split("/");try{const{data:_e,error:et}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:i,code_verifier:$},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),et)throw et;return!_e||!_e.session||!_e.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(_e.session&&(await this._saveSession(_e.session),await this._notifyAllSubscribers("SIGNED_IN",_e.session)),{data:Object.assign(Object.assign({},_e),{redirectType:j??null}),error:et})}catch(_e){if(isAuthError(_e))return{data:{user:null,session:null,redirectType:null},error:_e};throw _e}}async signInWithIdToken(i){try{const{options:_,provider:$,token:j,access_token:_e,nonce:et}=i,tt=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:$,id_token:j,access_token:_e,nonce:et,gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:_sessionResponse}),{data:rt,error:nt}=tt;return nt?{data:{user:null,session:null},error:nt}:!rt||!rt.session||!rt.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(rt.session&&(await this._saveSession(rt.session),await this._notifyAllSubscribers("SIGNED_IN",rt.session)),{data:rt,error:nt})}catch(_){if(isAuthError(_))return{data:{user:null,session:null},error:_};throw _}}async signInWithOtp(i){var _,$,j,_e,et;try{if("email"in i){const{email:tt,options:rt}=i;let nt=null,it=null;this.flowType==="pkce"&&([nt,it]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:st}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:tt,data:(_=rt==null?void 0:rt.data)!==null&&_!==void 0?_:{},create_user:($=rt==null?void 0:rt.shouldCreateUser)!==null&&$!==void 0?$:!0,gotrue_meta_security:{captcha_token:rt==null?void 0:rt.captchaToken},code_challenge:nt,code_challenge_method:it},redirectTo:rt==null?void 0:rt.emailRedirectTo});return{data:{user:null,session:null},error:st}}if("phone"in i){const{phone:tt,options:rt}=i,{data:nt,error:it}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:tt,data:(j=rt==null?void 0:rt.data)!==null&&j!==void 0?j:{},create_user:(_e=rt==null?void 0:rt.shouldCreateUser)!==null&&_e!==void 0?_e:!0,gotrue_meta_security:{captcha_token:rt==null?void 0:rt.captchaToken},channel:(et=rt==null?void 0:rt.channel)!==null&&et!==void 0?et:"sms"}});return{data:{user:null,session:null,messageId:nt==null?void 0:nt.message_id},error:it}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(tt){if(isAuthError(tt))return{data:{user:null,session:null},error:tt};throw tt}}async verifyOtp(i){var _,$;try{let j,_e;"options"in i&&(j=(_=i.options)===null||_===void 0?void 0:_.redirectTo,_e=($=i.options)===null||$===void 0?void 0:$.captchaToken);const{data:et,error:tt}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},i),{gotrue_meta_security:{captcha_token:_e}}),redirectTo:j,xform:_sessionResponse});if(tt)throw tt;if(!et)throw new Error("An error occurred on token verification.");const rt=et.session,nt=et.user;return rt!=null&&rt.access_token&&(await this._saveSession(rt),await this._notifyAllSubscribers(i.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",rt)),{data:{user:nt,session:rt},error:null}}catch(j){if(isAuthError(j))return{data:{user:null,session:null},error:j};throw j}}async signInWithSSO(i){var _,$,j;try{let _e=null,et=null;return this.flowType==="pkce"&&([_e,et]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in i?{provider_id:i.providerId}:null),"domain"in i?{domain:i.domain}:null),{redirect_to:($=(_=i.options)===null||_===void 0?void 0:_.redirectTo)!==null&&$!==void 0?$:void 0}),!((j=i==null?void 0:i.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:i.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:_e,code_challenge_method:et}),headers:this.headers,xform:_ssoResponse})}catch(_e){if(isAuthError(_e))return{data:null,error:_e};throw _e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async i=>{const{data:{session:_},error:$}=i;if($)throw $;if(!_)throw new AuthSessionMissingError;const{error:j}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:_.access_token});return{data:{user:null,session:null},error:j}})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async resend(i){try{const _=`${this.url}/resend`;if("email"in i){const{email:$,type:j,options:_e}=i,{error:et}=await _request(this.fetch,"POST",_,{headers:this.headers,body:{email:$,type:j,gotrue_meta_security:{captcha_token:_e==null?void 0:_e.captchaToken}},redirectTo:_e==null?void 0:_e.emailRedirectTo});return{data:{user:null,session:null},error:et}}else if("phone"in i){const{phone:$,type:j,options:_e}=i,{data:et,error:tt}=await _request(this.fetch,"POST",_,{headers:this.headers,body:{phone:$,type:j,gotrue_meta_security:{captcha_token:_e==null?void 0:_e.captchaToken}}});return{data:{user:null,session:null,messageId:et==null?void 0:et.message_id},error:tt}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(_){if(isAuthError(_))return{data:{user:null,session:null},error:_};throw _}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async _=>_))}async _acquireLock(i,_){this._debug("#_acquireLock","begin",i);try{if(this.lockAcquired){const $=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),j=(async()=>(await $,await _()))();return this.pendingInLock.push((async()=>{try{await j}catch{}})()),j}return await this.lock(`lock:${this.storageKey}`,i,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const $=_();for(this.pendingInLock.push((async()=>{try{await $}catch{}})()),await $;this.pendingInLock.length;){const j=[...this.pendingInLock];await Promise.all(j),this.pendingInLock.splice(0,j.length)}return await $}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(i){this._debug("#_useSession","begin");try{const _=await this.__loadSession();return await i(_)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let i=null;const _=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",_),_!==null&&(this._isValidSession(_)?i=_:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!i)return{data:{session:null},error:null};const $=i.expires_at?i.expires_at*1e3-Date.now()<EXPIRY_MARGIN_MS:!1;if(this._debug("#__loadSession()",`session has${$?"":" not"} expired`,"expires_at",i.expires_at),!$){if(this.userStorage){const et=await getItemAsync(this.userStorage,this.storageKey+"-user");et!=null&&et.user?i.user=et.user:i.user=userNotAvailableProxy()}if(this.storage.isServer&&i.user){let et=this.suppressGetSessionWarning;i=new Proxy(i,{get:(rt,nt,it)=>(!et&&nt==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),et=!0,this.suppressGetSessionWarning=!0),Reflect.get(rt,nt,it))})}return{data:{session:i},error:null}}const{session:j,error:_e}=await this._callRefreshToken(i.refresh_token);return _e?{data:{session:null},error:_e}:{data:{session:j},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(i){return i?await this._getUser(i):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(i){try{return i?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:i,xform:_userResponse}):await this._useSession(async _=>{var $,j,_e;const{data:et,error:tt}=_;if(tt)throw tt;return!(!(($=et.session)===null||$===void 0)&&$.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(_e=(j=et.session)===null||j===void 0?void 0:j.access_token)!==null&&_e!==void 0?_e:void 0,xform:_userResponse})})}catch(_){if(isAuthError(_))return isAuthSessionMissingError(_)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:_};throw _}}async updateUser(i,_={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(i,_))}async _updateUser(i,_={}){try{return await this._useSession(async $=>{const{data:j,error:_e}=$;if(_e)throw _e;if(!j.session)throw new AuthSessionMissingError;const et=j.session;let tt=null,rt=null;this.flowType==="pkce"&&i.email!=null&&([tt,rt]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:nt,error:it}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:Object.assign(Object.assign({},i),{code_challenge:tt,code_challenge_method:rt}),jwt:et.access_token,xform:_userResponse});if(it)throw it;return et.user=nt.user,await this._saveSession(et),await this._notifyAllSubscribers("USER_UPDATED",et),{data:{user:et.user},error:null}})}catch($){if(isAuthError($))return{data:{user:null},error:$};throw $}}async setSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(i))}async _setSession(i){try{if(!i.access_token||!i.refresh_token)throw new AuthSessionMissingError;const _=Date.now()/1e3;let $=_,j=!0,_e=null;const{payload:et}=decodeJWT(i.access_token);if(et.exp&&($=et.exp,j=$<=_),j){const{session:tt,error:rt}=await this._callRefreshToken(i.refresh_token);if(rt)return{data:{user:null,session:null},error:rt};if(!tt)return{data:{user:null,session:null},error:null};_e=tt}else{const{data:tt,error:rt}=await this._getUser(i.access_token);if(rt)throw rt;_e={access_token:i.access_token,refresh_token:i.refresh_token,user:tt.user,token_type:"bearer",expires_in:$-_,expires_at:$},await this._saveSession(_e),await this._notifyAllSubscribers("SIGNED_IN",_e)}return{data:{user:_e.user,session:_e},error:null}}catch(_){if(isAuthError(_))return{data:{session:null,user:null},error:_};throw _}}async refreshSession(i){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(i))}async _refreshSession(i){try{return await this._useSession(async _=>{var $;if(!i){const{data:et,error:tt}=_;if(tt)throw tt;i=($=et.session)!==null&&$!==void 0?$:void 0}if(!(i!=null&&i.refresh_token))throw new AuthSessionMissingError;const{session:j,error:_e}=await this._callRefreshToken(i.refresh_token);return _e?{data:{user:null,session:null},error:_e}:j?{data:{user:j.user,session:j},error:null}:{data:{user:null,session:null},error:null}})}catch(_){if(isAuthError(_))return{data:{user:null,session:null},error:_};throw _}}async _getSessionFromURL(i,_){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(i.error||i.error_description||i.error_code)throw new AuthImplicitGrantRedirectError(i.error_description||"Error in URL with unspecified error_description",{error:i.error||"unspecified_error",code:i.error_code||"unspecified_code"});switch(_){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(_==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!i.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:ht,error:dt}=await this._exchangeCodeForSession(i.code);if(dt)throw dt;const mt=new URL(window.location.href);return mt.searchParams.delete("code"),window.history.replaceState(window.history.state,"",mt.toString()),{data:{session:ht.session,redirectType:null},error:null}}const{provider_token:$,provider_refresh_token:j,access_token:_e,refresh_token:et,expires_in:tt,expires_at:rt,token_type:nt}=i;if(!_e||!tt||!et||!nt)throw new AuthImplicitGrantRedirectError("No session defined in URL");const it=Math.round(Date.now()/1e3),st=parseInt(tt);let at=it+st;rt&&(at=parseInt(rt));const ot=at-it;ot*1e3<=AUTO_REFRESH_TICK_DURATION_MS&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${ot}s, should have been closer to ${st}s`);const lt=at-st;it-lt>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",lt,at,it):it-lt<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",lt,at,it);const{data:ct,error:ft}=await this._getUser(_e);if(ft)throw ft;const ut={provider_token:$,provider_refresh_token:j,access_token:_e,expires_in:st,expires_at:at,refresh_token:et,token_type:nt,user:ct.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:ut,redirectType:i.type},error:null}}catch($){if(isAuthError($))return{data:{session:null,redirectType:null},error:$};throw $}}_isImplicitGrantCallback(i){return!!(i.access_token||i.error_description)}async _isPKCECallback(i){const _=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(i.code&&_)}async signOut(i={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(i))}async _signOut({scope:i}={scope:"global"}){return await this._useSession(async _=>{var $;const{data:j,error:_e}=_;if(_e)return{error:_e};const et=($=j.session)===null||$===void 0?void 0:$.access_token;if(et){const{error:tt}=await this.admin.signOut(et,i);if(tt&&!(isAuthApiError(tt)&&(tt.status===404||tt.status===401||tt.status===403)))return{error:tt}}return i!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(i){const _=uuid(),$={id:_,callback:i,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",_),this.stateChangeEmitters.delete(_)}};return this._debug("#onAuthStateChange()","registered callback with id",_),this.stateChangeEmitters.set(_,$),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(_)})))(),{data:{subscription:$}}}async _emitInitialSession(i){return await this._useSession(async _=>{var $,j;try{const{data:{session:_e},error:et}=_;if(et)throw et;await(($=this.stateChangeEmitters.get(i))===null||$===void 0?void 0:$.callback("INITIAL_SESSION",_e)),this._debug("INITIAL_SESSION","callback id",i,"session",_e)}catch(_e){await((j=this.stateChangeEmitters.get(i))===null||j===void 0?void 0:j.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",i,"error",_e),console.error(_e)}})}async resetPasswordForEmail(i,_={}){let $=null,j=null;this.flowType==="pkce"&&([$,j]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:i,code_challenge:$,code_challenge_method:j,gotrue_meta_security:{captcha_token:_.captchaToken}},headers:this.headers,redirectTo:_.redirectTo})}catch(_e){if(isAuthError(_e))return{data:null,error:_e};throw _e}}async getUserIdentities(){var i;try{const{data:_,error:$}=await this.getUser();if($)throw $;return{data:{identities:(i=_.user.identities)!==null&&i!==void 0?i:[]},error:null}}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}async linkIdentity(i){var _;try{const{data:$,error:j}=await this._useSession(async _e=>{var et,tt,rt,nt,it;const{data:st,error:at}=_e;if(at)throw at;const ot=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,i.provider,{redirectTo:(et=i.options)===null||et===void 0?void 0:et.redirectTo,scopes:(tt=i.options)===null||tt===void 0?void 0:tt.scopes,queryParams:(rt=i.options)===null||rt===void 0?void 0:rt.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",ot,{headers:this.headers,jwt:(it=(nt=st.session)===null||nt===void 0?void 0:nt.access_token)!==null&&it!==void 0?it:void 0})});if(j)throw j;return isBrowser()&&!(!((_=i.options)===null||_===void 0)&&_.skipBrowserRedirect)&&window.location.assign($==null?void 0:$.url),{data:{provider:i.provider,url:$==null?void 0:$.url},error:null}}catch($){if(isAuthError($))return{data:{provider:i.provider,url:null},error:$};throw $}}async unlinkIdentity(i){try{return await this._useSession(async _=>{var $,j;const{data:_e,error:et}=_;if(et)throw et;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${i.identity_id}`,{headers:this.headers,jwt:(j=($=_e.session)===null||$===void 0?void 0:$.access_token)!==null&&j!==void 0?j:void 0})})}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}async _refreshAccessToken(i){const _=`#_refreshAccessToken(${i.substring(0,5)}...)`;this._debug(_,"begin");try{const $=Date.now();return await retryable(async j=>(j>0&&await sleep(200*Math.pow(2,j-1)),this._debug(_,"refreshing attempt",j),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:i},headers:this.headers,xform:_sessionResponse})),(j,_e)=>{const et=200*Math.pow(2,j);return _e&&isAuthRetryableFetchError(_e)&&Date.now()+et-$<AUTO_REFRESH_TICK_DURATION_MS})}catch($){if(this._debug(_,"error",$),isAuthError($))return{data:{session:null,user:null},error:$};throw $}finally{this._debug(_,"end")}}_isValidSession(i){return typeof i=="object"&&i!==null&&"access_token"in i&&"refresh_token"in i&&"expires_at"in i}async _handleProviderSignIn(i,_){const $=await this._getUrlForProvider(`${this.url}/authorize`,i,{redirectTo:_.redirectTo,scopes:_.scopes,queryParams:_.queryParams});return this._debug("#_handleProviderSignIn()","provider",i,"options",_,"url",$),isBrowser()&&!_.skipBrowserRedirect&&window.location.assign($),{data:{provider:i,url:$},error:null}}async _recoverAndRefresh(){var i,_;const $="#_recoverAndRefresh()";this._debug($,"begin");try{const j=await getItemAsync(this.storage,this.storageKey);if(j&&this.userStorage){let et=await getItemAsync(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!et&&(et={user:j.user},await setItemAsync(this.userStorage,this.storageKey+"-user",et)),j.user=(i=et==null?void 0:et.user)!==null&&i!==void 0?i:userNotAvailableProxy()}else if(j&&!j.user&&!j.user){const et=await getItemAsync(this.storage,this.storageKey+"-user");et&&(et!=null&&et.user)?(j.user=et.user,await removeItemAsync(this.storage,this.storageKey+"-user"),await setItemAsync(this.storage,this.storageKey,j)):j.user=userNotAvailableProxy()}if(this._debug($,"session from storage",j),!this._isValidSession(j)){this._debug($,"session is not valid"),j!==null&&await this._removeSession();return}const _e=((_=j.expires_at)!==null&&_!==void 0?_:1/0)*1e3-Date.now()<EXPIRY_MARGIN_MS;if(this._debug($,`session has${_e?"":" not"} expired with margin of ${EXPIRY_MARGIN_MS}s`),_e){if(this.autoRefreshToken&&j.refresh_token){const{error:et}=await this._callRefreshToken(j.refresh_token);et&&(console.error(et),isAuthRetryableFetchError(et)||(this._debug($,"refresh failed with a non-retryable error, removing the session",et),await this._removeSession()))}}else if(j.user&&j.user.__isUserNotAvailableProxy===!0)try{const{data:et,error:tt}=await this._getUser(j.access_token);!tt&&(et!=null&&et.user)?(j.user=et.user,await this._saveSession(j),await this._notifyAllSubscribers("SIGNED_IN",j)):this._debug($,"could not get user data, skipping SIGNED_IN notification")}catch(et){console.error("Error getting user data:",et),this._debug($,"error getting user data, skipping SIGNED_IN notification",et)}else await this._notifyAllSubscribers("SIGNED_IN",j)}catch(j){this._debug($,"error",j),console.error(j);return}finally{this._debug($,"end")}}async _callRefreshToken(i){var _,$;if(!i)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const j=`#_callRefreshToken(${i.substring(0,5)}...)`;this._debug(j,"begin");try{this.refreshingDeferred=new Deferred;const{data:_e,error:et}=await this._refreshAccessToken(i);if(et)throw et;if(!_e.session)throw new AuthSessionMissingError;await this._saveSession(_e.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",_e.session);const tt={session:_e.session,error:null};return this.refreshingDeferred.resolve(tt),tt}catch(_e){if(this._debug(j,"error",_e),isAuthError(_e)){const et={session:null,error:_e};return isAuthRetryableFetchError(_e)||await this._removeSession(),(_=this.refreshingDeferred)===null||_===void 0||_.resolve(et),et}throw($=this.refreshingDeferred)===null||$===void 0||$.reject(_e),_e}finally{this.refreshingDeferred=null,this._debug(j,"end")}}async _notifyAllSubscribers(i,_,$=!0){const j=`#_notifyAllSubscribers(${i})`;this._debug(j,"begin",_,`broadcast = ${$}`);try{this.broadcastChannel&&$&&this.broadcastChannel.postMessage({event:i,session:_});const _e=[],et=Array.from(this.stateChangeEmitters.values()).map(async tt=>{try{await tt.callback(i,_)}catch(rt){_e.push(rt)}});if(await Promise.all(et),_e.length>0){for(let tt=0;tt<_e.length;tt+=1)console.error(_e[tt]);throw _e[0]}}finally{this._debug(j,"end")}}async _saveSession(i){this._debug("#_saveSession()",i),this.suppressGetSessionWarning=!0;const _=Object.assign({},i),$=_.user&&_.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!$&&_.user&&await setItemAsync(this.userStorage,this.storageKey+"-user",{user:_.user});const j=Object.assign({},_);delete j.user;const _e=deepClone(j);await setItemAsync(this.storage,this.storageKey,_e)}else{const j=deepClone(_);await setItemAsync(this.storage,this.storageKey,j)}}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await removeItemAsync(this.storage,this.storageKey+"-code-verifier"),await removeItemAsync(this.storage,this.storageKey+"-user"),this.userStorage&&await removeItemAsync(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const i=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{i&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",i)}catch(_){console.error("removing visibilitychange callback failed",_)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const i=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION_MS);this.autoRefreshTicker=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const i=this.autoRefreshTicker;this.autoRefreshTicker=null,i&&clearInterval(i)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const i=Date.now();try{return await this._useSession(async _=>{const{data:{session:$}}=_;if(!$||!$.refresh_token||!$.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const j=Math.floor(($.expires_at*1e3-i)/AUTO_REFRESH_TICK_DURATION_MS);this._debug("#_autoRefreshTokenTick()",`access token expires in ${j} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),j<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken($.refresh_token)})}catch(_){console.error("Auto refresh tick failed with error. This is likely a transient error.",_)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(i){if(i.isAcquireTimeout||i instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw i}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(i){console.error("_handleVisibilityChange",i)}}async _onVisibilityChanged(i){const _=`#_onVisibilityChanged(${i})`;this._debug(_,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),i||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(_,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(i,_,$){const j=[`provider=${encodeURIComponent(_)}`];if($!=null&&$.redirectTo&&j.push(`redirect_to=${encodeURIComponent($.redirectTo)}`),$!=null&&$.scopes&&j.push(`scopes=${encodeURIComponent($.scopes)}`),this.flowType==="pkce"){const[_e,et]=await getCodeChallengeAndMethod(this.storage,this.storageKey),tt=new URLSearchParams({code_challenge:`${encodeURIComponent(_e)}`,code_challenge_method:`${encodeURIComponent(et)}`});j.push(tt.toString())}if($!=null&&$.queryParams){const _e=new URLSearchParams($.queryParams);j.push(_e.toString())}return $!=null&&$.skipBrowserRedirect&&j.push(`skip_http_redirect=${$.skipBrowserRedirect}`),`${i}?${j.join("&")}`}async _unenroll(i){try{return await this._useSession(async _=>{var $;const{data:j,error:_e}=_;return _e?{data:null,error:_e}:await _request(this.fetch,"DELETE",`${this.url}/factors/${i.factorId}`,{headers:this.headers,jwt:($=j==null?void 0:j.session)===null||$===void 0?void 0:$.access_token})})}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}async _enroll(i){try{return await this._useSession(async _=>{var $,j;const{data:_e,error:et}=_;if(et)return{data:null,error:et};const tt=Object.assign({friendly_name:i.friendlyName,factor_type:i.factorType},i.factorType==="phone"?{phone:i.phone}:{issuer:i.issuer}),{data:rt,error:nt}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:tt,headers:this.headers,jwt:($=_e==null?void 0:_e.session)===null||$===void 0?void 0:$.access_token});return nt?{data:null,error:nt}:(i.factorType==="totp"&&(!((j=rt==null?void 0:rt.totp)===null||j===void 0)&&j.qr_code)&&(rt.totp.qr_code=`data:image/svg+xml;utf-8,${rt.totp.qr_code}`),{data:rt,error:null})})}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}}async _verify(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async _=>{var $;const{data:j,error:_e}=_;if(_e)return{data:null,error:_e};const{data:et,error:tt}=await _request(this.fetch,"POST",`${this.url}/factors/${i.factorId}/verify`,{body:{code:i.code,challenge_id:i.challengeId},headers:this.headers,jwt:($=j==null?void 0:j.session)===null||$===void 0?void 0:$.access_token});return tt?{data:null,error:tt}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+et.expires_in},et)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",et),{data:et,error:tt})})}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}})}async _challenge(i){return this._acquireLock(-1,async()=>{try{return await this._useSession(async _=>{var $;const{data:j,error:_e}=_;return _e?{data:null,error:_e}:await _request(this.fetch,"POST",`${this.url}/factors/${i.factorId}/challenge`,{body:{channel:i.channel},headers:this.headers,jwt:($=j==null?void 0:j.session)===null||$===void 0?void 0:$.access_token})})}catch(_){if(isAuthError(_))return{data:null,error:_};throw _}})}async _challengeAndVerify(i){const{data:_,error:$}=await this._challenge({factorId:i.factorId});return $?{data:null,error:$}:await this._verify({factorId:i.factorId,challengeId:_.id,code:i.code})}async _listFactors(){const{data:{user:i},error:_}=await this.getUser();if(_)return{data:null,error:_};const $=(i==null?void 0:i.factors)||[],j=$.filter(et=>et.factor_type==="totp"&&et.status==="verified"),_e=$.filter(et=>et.factor_type==="phone"&&et.status==="verified");return{data:{all:$,totp:j,phone:_e},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async i=>{var _,$;const{data:{session:j},error:_e}=i;if(_e)return{data:null,error:_e};if(!j)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:et}=decodeJWT(j.access_token);let tt=null;et.aal&&(tt=et.aal);let rt=tt;(($=(_=j.user.factors)===null||_===void 0?void 0:_.filter(st=>st.status==="verified"))!==null&&$!==void 0?$:[]).length>0&&(rt="aal2");const it=et.amr||[];return{data:{currentLevel:tt,nextLevel:rt,currentAuthenticationMethods:it},error:null}}))}async fetchJwk(i,_={keys:[]}){let $=_.keys.find(tt=>tt.kid===i);if($)return $;const j=Date.now();if($=this.jwks.keys.find(tt=>tt.kid===i),$&&this.jwks_cached_at+JWKS_TTL>j)return $;const{data:_e,error:et}=await _request(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(et)throw et;return!_e.keys||_e.keys.length===0||(this.jwks=_e,this.jwks_cached_at=j,$=_e.keys.find(tt=>tt.kid===i),!$)?null:$}async getClaims(i,_={}){try{let $=i;if(!$){const{data:ot,error:lt}=await this.getSession();if(lt||!ot.session)return{data:null,error:lt};$=ot.session.access_token}const{header:j,payload:_e,signature:et,raw:{header:tt,payload:rt}}=decodeJWT($);_!=null&&_.allowExpired||validateExp(_e.exp);const nt=!j.alg||j.alg.startsWith("HS")||!j.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(j.kid,_!=null&&_.keys?{keys:_.keys}:_==null?void 0:_.jwks);if(!nt){const{error:ot}=await this.getUser($);if(ot)throw ot;return{data:{claims:_e,header:j,signature:et},error:null}}const it=getAlgorithm(j.alg),st=await crypto.subtle.importKey("jwk",nt,it,!0,["verify"]);if(!await crypto.subtle.verify(it,st,et,stringToUint8Array(`${tt}.${rt}`)))throw new AuthInvalidJwtError("Invalid JWT signature");return{data:{claims:_e,header:j,signature:et},error:null}}catch($){if(isAuthError($))return{data:null,error:$};throw $}}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(i){super(i)}}var __awaiter=function(o,i,_,$){function j(_e){return _e instanceof _?_e:new _(function(et){et(_e)})}return new(_||(_=Promise))(function(_e,et){function tt(it){try{nt($.next(it))}catch(st){et(st)}}function rt(it){try{nt($.throw(it))}catch(st){et(st)}}function nt(it){it.done?_e(it.value):j(it.value).then(tt,rt)}nt(($=$.apply(o,i||[])).next())})};class SupabaseClient{constructor(i,_,$){var j,_e,et;this.supabaseUrl=i,this.supabaseKey=_;const tt=validateSupabaseUrl(i);if(!_)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",tt),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",tt),this.storageUrl=new URL("storage/v1",tt),this.functionsUrl=new URL("functions/v1",tt);const rt=`sb-${tt.hostname.split(".")[0]}-auth-token`,nt={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:rt}),global:DEFAULT_GLOBAL_OPTIONS},it=applySettingDefaults($??{},nt);this.storageKey=(j=it.auth.storageKey)!==null&&j!==void 0?j:"",this.headers=(_e=it.global.headers)!==null&&_e!==void 0?_e:{},it.accessToken?(this.accessToken=it.accessToken,this.auth=new Proxy({},{get:(st,at)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(at)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((et=it.auth)!==null&&et!==void 0?et:{},this.headers,it.global.fetch),this.fetch=fetchWithAuth(_,this._getAccessToken.bind(this),it.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},it.realtime)),this.rest=new PostgrestClient(new URL("rest/v1",tt).href,{headers:this.headers,schema:it.db.schema,fetch:this.fetch}),this.storage=new StorageClient(this.storageUrl.href,this.headers,this.fetch,$==null?void 0:$.storage),it.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,_={},$={}){return this.rest.rpc(i,_,$)}channel(i,_={config:{}}){return this.realtime.channel(i,_)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var i,_;return __awaiter(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:$}=yield this.auth.getSession();return(_=(i=$.session)===null||i===void 0?void 0:i.access_token)!==null&&_!==void 0?_:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:_,detectSessionInUrl:$,storage:j,userStorage:_e,storageKey:et,flowType:tt,lock:rt,debug:nt},it,st){const at={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},at),it),storageKey:et,autoRefreshToken:i,persistSession:_,detectSessionInUrl:$,storage:j,userStorage:_e,flowType:tt,lock:rt,debug:nt,fetch:st,hasCustomAuthorizationHeader:Object.keys(this.headers).some(ot=>ot.toLowerCase()==="authorization")})}_initRealtimeClient(i){return new RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},i),{params:Object.assign({apikey:this.supabaseKey},i==null?void 0:i.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((_,$)=>{this._handleTokenChanged(_,"CLIENT",$==null?void 0:$.access_token)})}_handleTokenChanged(i,_,$){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==$?this.changedAccessToken=$:i==="SIGNED_OUT"&&(this.realtime.setAuth(),_=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(o,i,_)=>new SupabaseClient(o,i,_);function shouldShowDeprecationWarning(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const i=o.match(/^v(\d+)\./);return i?parseInt(i[1],10)<=18:!1}shouldShowDeprecationWarning()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");class SupabaseServiceClass{constructor(){Rn(this,"client");this.client=createClient("","",{auth:{persistSession:!0,autoRefreshToken:!0}})}onAuthStateChange(i){this.client.auth.onAuthStateChange((_,$)=>i($))}async signIn(i,_){const{data:$,error:j}=await this.client.auth.signInWithPassword({email:i,password:_});if(j)throw j;return $.session}async signUp(i,_){const{data:$,error:j}=await this.client.auth.signUp({email:i,password:_});if(j)throw j;return $.session}async signOut(){await this.client.auth.signOut()}newer(i,_){return new Date(i.last_updated).getTime()>=new Date(_.last_updated).getTime()?i:_}async syncAll(i){await this.syncTable("notes",i),await this.syncTable("progress",i),await this.syncTable("media_assets",i),await this.syncTable("quizzes",i),await this.syncTable("questions",i),await this.syncTable("attempts",i)}async syncTable(i,_){const{data:$,error:j}=await this.client.from(i).select("*").eq("user_id",_);if(j)throw j;const _e=await db[i==="media_assets"?"media":i].toArray(),et=new Map;for(const rt of $)et.set(rt.id,rt);for(const rt of _e){const nt=et.get(rt.id);et.set(rt.id,nt?this.newer(nt,rt):rt)}const tt=Array.from(et.values());if(tt.length){const rt=tt.map(it=>({...it,user_id:it.user_id??_})),{error:nt}=await this.client.from(i).upsert(rt,{onConflict:"id"});if(nt)throw nt}await db[i==="media_assets"?"media":i].clear(),await db[i==="media_assets"?"media":i].bulkAdd(tt)}}const SupabaseService=new SupabaseServiceClass,useAuthStore=create()(persist(o=>({session:null,user:null,init:()=>{SupabaseService.onAuthStateChange(i=>o({session:i,user:(i==null?void 0:i.user)??null}))},signIn:async(i,_)=>{const $=await SupabaseService.signIn(i,_);o({session:$,user:($==null?void 0:$.user)??null})},signUp:async(i,_)=>{const $=await SupabaseService.signUp(i,_);o({session:$,user:($==null?void 0:$.user)??null})},signOut:async()=>{await SupabaseService.signOut(),o({session:null,user:null})}}),{name:"auth-store"}));function Auth(){const[o,i]=reactExports.useState(""),[_,$]=reactExports.useState(""),[j,_e]=reactExports.useState("login"),[et,tt]=reactExports.useState(!1),[rt,nt]=reactExports.useState(null),{signIn:it,signUp:st}=useAuthStore(),at=async()=>{nt(null),tt(!0);try{j==="login"?await it(o,_):await st(o,_)}catch(ot){nt(ot.message||"")}finally{tt(!1)}};return jsxRuntimeExports.jsxs("div",{className:"mx-auto max-w-sm space-y-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold",children:j==="login"?" ":" "}),jsxRuntimeExports.jsxs("div",{className:"rounded-xl bg-surface p-4 shadow-soft-warm",children:[jsxRuntimeExports.jsx("label",{className:"mb-2 block text-sm",children:" "}),jsxRuntimeExports.jsx("input",{className:"mb-3 w-full rounded-lg border border-border p-2",type:"email",value:o,onChange:ot=>i(ot.target.value)}),jsxRuntimeExports.jsx("label",{className:"mb-2 block text-sm",children:" "}),jsxRuntimeExports.jsx("input",{className:"mb-3 w-full rounded-lg border border-border p-2",type:"password",value:_,onChange:ot=>$(ot.target.value)}),rt&&jsxRuntimeExports.jsx("div",{className:"mb-2 rounded-md bg-red-50 p-2 text-sm text-red-700",children:rt}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-primary",onClick:at,disabled:et,children:et?"...":""}),jsxRuntimeExports.jsx("button",{className:"btn btn-secondary",onClick:()=>_e(j==="login"?"signup":"login"),children:j==="login"?" ":" "})]})]})]})}const router=createBrowserRouter([{path:"/",element:jsxRuntimeExports.jsx(AppLayout,{}),children:[{index:!0,element:jsxRuntimeExports.jsx(Home,{})},{path:"dashboard",element:jsxRuntimeExports.jsx(Dashboard,{})},{path:"subjects/:subjectId",element:jsxRuntimeExports.jsx(Subject,{})},{path:"sections/:sectionId",element:jsxRuntimeExports.jsx(Section,{})},{path:"lessons/:lessonId",element:jsxRuntimeExports.jsx(Lesson,{})},{path:"quiz/:quizId",element:jsxRuntimeExports.jsx(Quiz,{})},{path:"settings",element:jsxRuntimeExports.jsx(Settings,{})},{path:"onboarding",element:jsxRuntimeExports.jsx(Onboarding,{})},{path:"teacher",element:jsxRuntimeExports.jsx(TeacherDashboard,{})},{path:"login",element:jsxRuntimeExports.jsx(Auth,{})}]}]),isString=o=>typeof o=="string",defer=()=>{let o,i;const _=new Promise(($,j)=>{o=$,i=j});return _.resolve=o,_.reject=i,_},makeString=o=>o==null?"":""+o,copy=(o,i,_)=>{o.forEach($=>{i[$]&&(_[$]=i[$])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=o=>o&&o.indexOf("###")>-1?o.replace(lastOfPathSeparatorRegExp,"."):o,canNotTraverseDeeper=o=>!o||isString(o),getLastOfPath=(o,i,_)=>{const $=isString(i)?i.split("."):i;let j=0;for(;j<$.length-1;){if(canNotTraverseDeeper(o))return{};const _e=cleanKey($[j]);!o[_e]&&_&&(o[_e]=new _),Object.prototype.hasOwnProperty.call(o,_e)?o=o[_e]:o={},++j}return canNotTraverseDeeper(o)?{}:{obj:o,k:cleanKey($[j])}},setPath=(o,i,_)=>{const{obj:$,k:j}=getLastOfPath(o,i,Object);if($!==void 0||i.length===1){$[j]=_;return}let _e=i[i.length-1],et=i.slice(0,i.length-1),tt=getLastOfPath(o,et,Object);for(;tt.obj===void 0&&et.length;)_e=`${et[et.length-1]}.${_e}`,et=et.slice(0,et.length-1),tt=getLastOfPath(o,et,Object),tt!=null&&tt.obj&&typeof tt.obj[`${tt.k}.${_e}`]<"u"&&(tt.obj=void 0);tt.obj[`${tt.k}.${_e}`]=_},pushPath=(o,i,_,$)=>{const{obj:j,k:_e}=getLastOfPath(o,i,Object);j[_e]=j[_e]||[],j[_e].push(_)},getPath=(o,i)=>{const{obj:_,k:$}=getLastOfPath(o,i);if(_&&Object.prototype.hasOwnProperty.call(_,$))return _[$]},getPathWithDefaults=(o,i,_)=>{const $=getPath(o,_);return $!==void 0?$:getPath(i,_)},deepExtend=(o,i,_)=>{for(const $ in i)$!=="__proto__"&&$!=="constructor"&&($ in o?isString(o[$])||o[$]instanceof String||isString(i[$])||i[$]instanceof String?_&&(o[$]=i[$]):deepExtend(o[$],i[$],_):o[$]=i[$]);return o},regexEscape=o=>o.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape$1=o=>isString(o)?o.replace(/[&<>"'\/]/g,i=>_entityMap[i]):o;class RegExpCache{constructor(i){this.capacity=i,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(i){const _=this.regExpMap.get(i);if(_!==void 0)return _;const $=new RegExp(i);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(i,$),this.regExpQueue.push(i),$}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(o,i,_)=>{i=i||"",_=_||"";const $=chars.filter(et=>i.indexOf(et)<0&&_.indexOf(et)<0);if($.length===0)return!0;const j=looksLikeObjectPathRegExpCache.getRegExp(`(${$.map(et=>et==="?"?"\\?":et).join("|")})`);let _e=!j.test(o);if(!_e){const et=o.indexOf(_);et>0&&!j.test(o.substring(0,et))&&(_e=!0)}return _e},deepFind=(o,i,_=".")=>{if(!o)return;if(o[i])return Object.prototype.hasOwnProperty.call(o,i)?o[i]:void 0;const $=i.split(_);let j=o;for(let _e=0;_e<$.length;){if(!j||typeof j!="object")return;let et,tt="";for(let rt=_e;rt<$.length;++rt)if(rt!==_e&&(tt+=_),tt+=$[rt],et=j[tt],et!==void 0){if(["string","number","boolean"].indexOf(typeof et)>-1&&rt<$.length-1)continue;_e+=rt-_e+1;break}j=et}return j},getCleanedCode=o=>o==null?void 0:o.replace("_","-"),consoleLogger={type:"logger",log(o){this.output("log",o)},warn(o){this.output("warn",o)},error(o){this.output("error",o)},output(o,i){var _,$;($=(_=console==null?void 0:console[o])==null?void 0:_.apply)==null||$.call(_,console,i)}};class Logger{constructor(i,_={}){this.init(i,_)}init(i,_={}){this.prefix=_.prefix||"i18next:",this.logger=i||consoleLogger,this.options=_,this.debug=_.debug}log(...i){return this.forward(i,"log","",!0)}warn(...i){return this.forward(i,"warn","",!0)}error(...i){return this.forward(i,"error","")}deprecate(...i){return this.forward(i,"warn","WARNING DEPRECATED: ",!0)}forward(i,_,$,j){return j&&!this.debug?null:(isString(i[0])&&(i[0]=`${$}${this.prefix} ${i[0]}`),this.logger[_](i))}create(i){return new Logger(this.logger,{prefix:`${this.prefix}:${i}:`,...this.options})}clone(i){return i=i||this.options,i.prefix=i.prefix||this.prefix,new Logger(this.logger,i)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(i,_){return i.split(" ").forEach($=>{this.observers[$]||(this.observers[$]=new Map);const j=this.observers[$].get(_)||0;this.observers[$].set(_,j+1)}),this}off(i,_){if(this.observers[i]){if(!_){delete this.observers[i];return}this.observers[i].delete(_)}}emit(i,..._){this.observers[i]&&Array.from(this.observers[i].entries()).forEach(([j,_e])=>{for(let et=0;et<_e;et++)j(..._)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([j,_e])=>{for(let et=0;et<_e;et++)j.apply(j,[i,..._])})}}class ResourceStore extends EventEmitter{constructor(i,_={ns:["translation"],defaultNS:"translation"}){super(),this.data=i||{},this.options=_,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(i){this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}removeNamespaces(i){const _=this.options.ns.indexOf(i);_>-1&&this.options.ns.splice(_,1)}getResource(i,_,$,j={}){var nt,it;const _e=j.keySeparator!==void 0?j.keySeparator:this.options.keySeparator,et=j.ignoreJSONStructure!==void 0?j.ignoreJSONStructure:this.options.ignoreJSONStructure;let tt;i.indexOf(".")>-1?tt=i.split("."):(tt=[i,_],$&&(Array.isArray($)?tt.push(...$):isString($)&&_e?tt.push(...$.split(_e)):tt.push($)));const rt=getPath(this.data,tt);return!rt&&!_&&!$&&i.indexOf(".")>-1&&(i=tt[0],_=tt[1],$=tt.slice(2).join(".")),rt||!et||!isString($)?rt:deepFind((it=(nt=this.data)==null?void 0:nt[i])==null?void 0:it[_],$,_e)}addResource(i,_,$,j,_e={silent:!1}){const et=_e.keySeparator!==void 0?_e.keySeparator:this.options.keySeparator;let tt=[i,_];$&&(tt=tt.concat(et?$.split(et):$)),i.indexOf(".")>-1&&(tt=i.split("."),j=_,_=tt[1]),this.addNamespaces(_),setPath(this.data,tt,j),_e.silent||this.emit("added",i,_,$,j)}addResources(i,_,$,j={silent:!1}){for(const _e in $)(isString($[_e])||Array.isArray($[_e]))&&this.addResource(i,_,_e,$[_e],{silent:!0});j.silent||this.emit("added",i,_,$)}addResourceBundle(i,_,$,j,_e,et={silent:!1,skipCopy:!1}){let tt=[i,_];i.indexOf(".")>-1&&(tt=i.split("."),j=$,$=_,_=tt[1]),this.addNamespaces(_);let rt=getPath(this.data,tt)||{};et.skipCopy||($=JSON.parse(JSON.stringify($))),j?deepExtend(rt,$,_e):rt={...rt,...$},setPath(this.data,tt,rt),et.silent||this.emit("added",i,_,$)}removeResourceBundle(i,_){this.hasResourceBundle(i,_)&&delete this.data[i][_],this.removeNamespaces(_),this.emit("removed",i,_)}hasResourceBundle(i,_){return this.getResource(i,_)!==void 0}getResourceBundle(i,_){return _||(_=this.options.defaultNS),this.getResource(i,_)}getDataByLanguage(i){return this.data[i]}hasLanguageSomeTranslations(i){const _=this.getDataByLanguage(i);return!!(_&&Object.keys(_)||[]).find(j=>_[j]&&Object.keys(_[j]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(o){this.processors[o.name]=o},handle(o,i,_,$,j){return o.forEach(_e=>{var et;i=((et=this.processors[_e])==null?void 0:et.process(i,_,$,j))??i}),i}};const PATH_KEY=Symbol("i18next/PATH_KEY");function createProxy(){const o=[],i=Object.create(null);let _;return i.get=($,j)=>{var _e;return(_e=_==null?void 0:_.revoke)==null||_e.call(_),j===PATH_KEY?o:(o.push(j),_=Proxy.revocable($,i),_.proxy)},Proxy.revocable(Object.create(null),i).proxy}function keysFromSelector(o,i){const{[PATH_KEY]:_}=o(createProxy());return _.join((i==null?void 0:i.keySeparator)??".")}const checkedLoadedFor={},shouldHandleAsObject=o=>!isString(o)&&typeof o!="boolean"&&typeof o!="number";class Translator extends EventEmitter{constructor(i,_={}){super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],i,this),this.options=_,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(i){i&&(this.language=i)}exists(i,_={interpolation:{}}){const $={..._};if(i==null)return!1;const j=this.resolve(i,$);return(j==null?void 0:j.res)!==void 0}extractFromKey(i,_){let $=_.nsSeparator!==void 0?_.nsSeparator:this.options.nsSeparator;$===void 0&&($=":");const j=_.keySeparator!==void 0?_.keySeparator:this.options.keySeparator;let _e=_.ns||this.options.defaultNS||[];const et=$&&i.indexOf($)>-1,tt=!this.options.userDefinedKeySeparator&&!_.keySeparator&&!this.options.userDefinedNsSeparator&&!_.nsSeparator&&!looksLikeObjectPath(i,$,j);if(et&&!tt){const rt=i.match(this.interpolator.nestingRegexp);if(rt&&rt.length>0)return{key:i,namespaces:isString(_e)?[_e]:_e};const nt=i.split($);($!==j||$===j&&this.options.ns.indexOf(nt[0])>-1)&&(_e=nt.shift()),i=nt.join(j)}return{key:i,namespaces:isString(_e)?[_e]:_e}}translate(i,_,$){let j=typeof _=="object"?{..._}:_;if(typeof j!="object"&&this.options.overloadTranslationOptionHandler&&(j=this.options.overloadTranslationOptionHandler(arguments)),typeof j=="object"&&(j={...j}),j||(j={}),i==null)return"";typeof i=="function"&&(i=keysFromSelector(i,{...this.options,...j})),Array.isArray(i)||(i=[String(i)]);const _e=j.returnDetails!==void 0?j.returnDetails:this.options.returnDetails,et=j.keySeparator!==void 0?j.keySeparator:this.options.keySeparator,{key:tt,namespaces:rt}=this.extractFromKey(i[i.length-1],j),nt=rt[rt.length-1];let it=j.nsSeparator!==void 0?j.nsSeparator:this.options.nsSeparator;it===void 0&&(it=":");const st=j.lng||this.language,at=j.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((st==null?void 0:st.toLowerCase())==="cimode")return at?_e?{res:`${nt}${it}${tt}`,usedKey:tt,exactUsedKey:tt,usedLng:st,usedNS:nt,usedParams:this.getUsedParamsDetails(j)}:`${nt}${it}${tt}`:_e?{res:tt,usedKey:tt,exactUsedKey:tt,usedLng:st,usedNS:nt,usedParams:this.getUsedParamsDetails(j)}:tt;const ot=this.resolve(i,j);let lt=ot==null?void 0:ot.res;const ct=(ot==null?void 0:ot.usedKey)||tt,ft=(ot==null?void 0:ot.exactUsedKey)||tt,ut=["[object Number]","[object Function]","[object RegExp]"],ht=j.joinArrays!==void 0?j.joinArrays:this.options.joinArrays,dt=!this.i18nFormat||this.i18nFormat.handleAsObject,mt=j.count!==void 0&&!isString(j.count),pt=Translator.hasDefaultValue(j),yt=mt?this.pluralResolver.getSuffix(st,j.count,j):"",gt=j.ordinal&&mt?this.pluralResolver.getSuffix(st,j.count,{ordinal:!1}):"",vt=mt&&!j.ordinal&&j.count===0,St=vt&&j[`defaultValue${this.options.pluralSeparator}zero`]||j[`defaultValue${yt}`]||j[`defaultValue${gt}`]||j.defaultValue;let At=lt;dt&&!lt&&pt&&(At=St);const xt=shouldHandleAsObject(At),wt=Object.prototype.toString.apply(At);if(dt&&At&&xt&&ut.indexOf(wt)<0&&!(isString(ht)&&Array.isArray(At))){if(!j.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Ot=this.options.returnedObjectHandler?this.options.returnedObjectHandler(ct,At,{...j,ns:rt}):`key '${tt} (${this.language})' returned an object instead of string.`;return _e?(ot.res=Ot,ot.usedParams=this.getUsedParamsDetails(j),ot):Ot}if(et){const Ot=Array.isArray(At),Bt=Ot?[]:{},Ft=Ot?ft:ct;for(const Pt in At)if(Object.prototype.hasOwnProperty.call(At,Pt)){const Rt=`${Ft}${et}${Pt}`;pt&&!lt?Bt[Pt]=this.translate(Rt,{...j,defaultValue:shouldHandleAsObject(St)?St[Pt]:void 0,joinArrays:!1,ns:rt}):Bt[Pt]=this.translate(Rt,{...j,joinArrays:!1,ns:rt}),Bt[Pt]===Rt&&(Bt[Pt]=At[Pt])}lt=Bt}}else if(dt&&isString(ht)&&Array.isArray(lt))lt=lt.join(ht),lt&&(lt=this.extendTranslation(lt,i,j,$));else{let Ot=!1,Bt=!1;!this.isValidLookup(lt)&&pt&&(Ot=!0,lt=St),this.isValidLookup(lt)||(Bt=!0,lt=tt);const Pt=(j.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Bt?void 0:lt,Rt=pt&&St!==lt&&this.options.updateMissing;if(Bt||Ot||Rt){if(this.logger.log(Rt?"updateKey":"missingKey",st,nt,tt,Rt?St:lt),et){const Dt=this.resolve(tt,{...j,keySeparator:!1});Dt&&Dt.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Et=[];const _t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,j.lng||this.language);if(this.options.saveMissingTo==="fallback"&&_t&&_t[0])for(let Dt=0;Dt<_t.length;Dt++)Et.push(_t[Dt]);else this.options.saveMissingTo==="all"?Et=this.languageUtils.toResolveHierarchy(j.lng||this.language):Et.push(j.lng||this.language);const Mt=(Dt,Lt,Ct)=>{var jt;const kt=pt&&Ct!==lt?Ct:Pt;this.options.missingKeyHandler?this.options.missingKeyHandler(Dt,nt,Lt,kt,Rt,j):(jt=this.backendConnector)!=null&&jt.saveMissing&&this.backendConnector.saveMissing(Dt,nt,Lt,kt,Rt,j),this.emit("missingKey",Dt,nt,Lt,lt)};this.options.saveMissing&&(this.options.saveMissingPlurals&&mt?Et.forEach(Dt=>{const Lt=this.pluralResolver.getSuffixes(Dt,j);vt&&j[`defaultValue${this.options.pluralSeparator}zero`]&&Lt.indexOf(`${this.options.pluralSeparator}zero`)<0&&Lt.push(`${this.options.pluralSeparator}zero`),Lt.forEach(Ct=>{Mt([Dt],tt+Ct,j[`defaultValue${Ct}`]||St)})}):Mt(Et,tt,St))}lt=this.extendTranslation(lt,i,j,ot,$),Bt&&lt===tt&&this.options.appendNamespaceToMissingKey&&(lt=`${nt}${it}${tt}`),(Bt||Ot)&&this.options.parseMissingKeyHandler&&(lt=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${nt}${it}${tt}`:tt,Ot?lt:void 0,j))}return _e?(ot.res=lt,ot.usedParams=this.getUsedParamsDetails(j),ot):lt}extendTranslation(i,_,$,j,_e){var rt,nt;if((rt=this.i18nFormat)!=null&&rt.parse)i=this.i18nFormat.parse(i,{...this.options.interpolation.defaultVariables,...$},$.lng||this.language||j.usedLng,j.usedNS,j.usedKey,{resolved:j});else if(!$.skipInterpolation){$.interpolation&&this.interpolator.init({...$,interpolation:{...this.options.interpolation,...$.interpolation}});const it=isString(i)&&(((nt=$==null?void 0:$.interpolation)==null?void 0:nt.skipOnVariables)!==void 0?$.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let st;if(it){const ot=i.match(this.interpolator.nestingRegexp);st=ot&&ot.length}let at=$.replace&&!isString($.replace)?$.replace:$;if(this.options.interpolation.defaultVariables&&(at={...this.options.interpolation.defaultVariables,...at}),i=this.interpolator.interpolate(i,at,$.lng||this.language||j.usedLng,$),it){const ot=i.match(this.interpolator.nestingRegexp),lt=ot&&ot.length;st<lt&&($.nest=!1)}!$.lng&&j&&j.res&&($.lng=this.language||j.usedLng),$.nest!==!1&&(i=this.interpolator.nest(i,(...ot)=>(_e==null?void 0:_e[0])===ot[0]&&!$.context?(this.logger.warn(`It seems you are nesting recursively key: ${ot[0]} in key: ${_[0]}`),null):this.translate(...ot,_),$)),$.interpolation&&this.interpolator.reset()}const et=$.postProcess||this.options.postProcess,tt=isString(et)?[et]:et;return i!=null&&(tt!=null&&tt.length)&&$.applyPostProcessor!==!1&&(i=postProcessor.handle(tt,i,_,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...j,usedParams:this.getUsedParamsDetails($)},...$}:$,this)),i}resolve(i,_={}){let $,j,_e,et,tt;return isString(i)&&(i=[i]),i.forEach(rt=>{if(this.isValidLookup($))return;const nt=this.extractFromKey(rt,_),it=nt.key;j=it;let st=nt.namespaces;this.options.fallbackNS&&(st=st.concat(this.options.fallbackNS));const at=_.count!==void 0&&!isString(_.count),ot=at&&!_.ordinal&&_.count===0,lt=_.context!==void 0&&(isString(_.context)||typeof _.context=="number")&&_.context!=="",ct=_.lngs?_.lngs:this.languageUtils.toResolveHierarchy(_.lng||this.language,_.fallbackLng);st.forEach(ft=>{var ut,ht;this.isValidLookup($)||(tt=ft,!checkedLoadedFor[`${ct[0]}-${ft}`]&&((ut=this.utils)!=null&&ut.hasLoadedNamespace)&&!((ht=this.utils)!=null&&ht.hasLoadedNamespace(tt))&&(checkedLoadedFor[`${ct[0]}-${ft}`]=!0,this.logger.warn(`key "${j}" for languages "${ct.join(", ")}" won't get resolved as namespace "${tt}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),ct.forEach(dt=>{var yt;if(this.isValidLookup($))return;et=dt;const mt=[it];if((yt=this.i18nFormat)!=null&&yt.addLookupKeys)this.i18nFormat.addLookupKeys(mt,it,dt,ft,_);else{let gt;at&&(gt=this.pluralResolver.getSuffix(dt,_.count,_));const vt=`${this.options.pluralSeparator}zero`,St=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(at&&(_.ordinal&&gt.indexOf(St)===0&&mt.push(it+gt.replace(St,this.options.pluralSeparator)),mt.push(it+gt),ot&&mt.push(it+vt)),lt){const At=`${it}${this.options.contextSeparator||"_"}${_.context}`;mt.push(At),at&&(_.ordinal&&gt.indexOf(St)===0&&mt.push(At+gt.replace(St,this.options.pluralSeparator)),mt.push(At+gt),ot&&mt.push(At+vt))}}let pt;for(;pt=mt.pop();)this.isValidLookup($)||(_e=pt,$=this.getResource(dt,ft,pt,_))}))})}),{res:$,usedKey:j,exactUsedKey:_e,usedLng:et,usedNS:tt}}isValidLookup(i){return i!==void 0&&!(!this.options.returnNull&&i===null)&&!(!this.options.returnEmptyString&&i==="")}getResource(i,_,$,j={}){var _e;return(_e=this.i18nFormat)!=null&&_e.getResource?this.i18nFormat.getResource(i,_,$,j):this.resourceStore.getResource(i,_,$,j)}getUsedParamsDetails(i={}){const _=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],$=i.replace&&!isString(i.replace);let j=$?i.replace:i;if($&&typeof i.count<"u"&&(j.count=i.count),this.options.interpolation.defaultVariables&&(j={...this.options.interpolation.defaultVariables,...j}),!$){j={...j};for(const _e of _)delete j[_e]}return j}static hasDefaultValue(i){const _="defaultValue";for(const $ in i)if(Object.prototype.hasOwnProperty.call(i,$)&&_===$.substring(0,_.length)&&i[$]!==void 0)return!0;return!1}}class LanguageUtil{constructor(i){this.options=i,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(i){if(i=getCleanedCode(i),!i||i.indexOf("-")<0)return null;const _=i.split("-");return _.length===2||(_.pop(),_[_.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(_.join("-"))}getLanguagePartFromCode(i){if(i=getCleanedCode(i),!i||i.indexOf("-")<0)return i;const _=i.split("-");return this.formatLanguageCode(_[0])}formatLanguageCode(i){if(isString(i)&&i.indexOf("-")>-1){let _;try{_=Intl.getCanonicalLocales(i)[0]}catch{}return _&&this.options.lowerCaseLng&&(_=_.toLowerCase()),_||(this.options.lowerCaseLng?i.toLowerCase():i)}return this.options.cleanCode||this.options.lowerCaseLng?i.toLowerCase():i}isSupportedCode(i){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(i=this.getLanguagePartFromCode(i)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(i)>-1}getBestMatchFromCodes(i){if(!i)return null;let _;return i.forEach($=>{if(_)return;const j=this.formatLanguageCode($);(!this.options.supportedLngs||this.isSupportedCode(j))&&(_=j)}),!_&&this.options.supportedLngs&&i.forEach($=>{if(_)return;const j=this.getScriptPartFromCode($);if(this.isSupportedCode(j))return _=j;const _e=this.getLanguagePartFromCode($);if(this.isSupportedCode(_e))return _=_e;_=this.options.supportedLngs.find(et=>{if(et===_e)return et;if(!(et.indexOf("-")<0&&_e.indexOf("-")<0)&&(et.indexOf("-")>0&&_e.indexOf("-")<0&&et.substring(0,et.indexOf("-"))===_e||et.indexOf(_e)===0&&_e.length>1))return et})}),_||(_=this.getFallbackCodes(this.options.fallbackLng)[0]),_}getFallbackCodes(i,_){if(!i)return[];if(typeof i=="function"&&(i=i(_)),isString(i)&&(i=[i]),Array.isArray(i))return i;if(!_)return i.default||[];let $=i[_];return $||($=i[this.getScriptPartFromCode(_)]),$||($=i[this.formatLanguageCode(_)]),$||($=i[this.getLanguagePartFromCode(_)]),$||($=i.default),$||[]}toResolveHierarchy(i,_){const $=this.getFallbackCodes((_===!1?[]:_)||this.options.fallbackLng||[],i),j=[],_e=et=>{et&&(this.isSupportedCode(et)?j.push(et):this.logger.warn(`rejecting language code not found in supportedLngs: ${et}`))};return isString(i)&&(i.indexOf("-")>-1||i.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&_e(this.formatLanguageCode(i)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&_e(this.getScriptPartFromCode(i)),this.options.load!=="currentOnly"&&_e(this.getLanguagePartFromCode(i))):isString(i)&&_e(this.formatLanguageCode(i)),$.forEach(et=>{j.indexOf(et)<0&&_e(this.formatLanguageCode(et))}),j}}const suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},dummyRule={select:o=>o===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class PluralResolver{constructor(i,_={}){this.languageUtils=i,this.options=_,this.logger=baseLogger.create("pluralResolver"),this.pluralRulesCache={}}addRule(i,_){this.rules[i]=_}clearCache(){this.pluralRulesCache={}}getRule(i,_={}){const $=getCleanedCode(i==="dev"?"en":i),j=_.ordinal?"ordinal":"cardinal",_e=JSON.stringify({cleanedCode:$,type:j});if(_e in this.pluralRulesCache)return this.pluralRulesCache[_e];let et;try{et=new Intl.PluralRules($,{type:j})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dummyRule;if(!i.match(/-|_/))return dummyRule;const rt=this.languageUtils.getLanguagePartFromCode(i);et=this.getRule(rt,_)}return this.pluralRulesCache[_e]=et,et}needsPlural(i,_={}){let $=this.getRule(i,_);return $||($=this.getRule("dev",_)),($==null?void 0:$.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(i,_,$={}){return this.getSuffixes(i,$).map(j=>`${_}${j}`)}getSuffixes(i,_={}){let $=this.getRule(i,_);return $||($=this.getRule("dev",_)),$?$.resolvedOptions().pluralCategories.sort((j,_e)=>suffixesOrder[j]-suffixesOrder[_e]).map(j=>`${this.options.prepend}${_.ordinal?`ordinal${this.options.prepend}`:""}${j}`):[]}getSuffix(i,_,$={}){const j=this.getRule(i,$);return j?`${this.options.prepend}${$.ordinal?`ordinal${this.options.prepend}`:""}${j.select(_)}`:(this.logger.warn(`no plural rule found for: ${i}`),this.getSuffix("dev",_,$))}}const deepFindWithDefaults=(o,i,_,$=".",j=!0)=>{let _e=getPathWithDefaults(o,i,_);return!_e&&j&&isString(_)&&(_e=deepFind(o,_,$),_e===void 0&&(_e=deepFind(i,_,$))),_e},regexSafe=o=>o.replace(/\$/g,"$$$$");class Interpolator{constructor(i={}){var _;this.logger=baseLogger.create("interpolator"),this.options=i,this.format=((_=i==null?void 0:i.interpolation)==null?void 0:_.format)||($=>$),this.init(i)}init(i={}){i.interpolation||(i.interpolation={escapeValue:!0});const{escape:_,escapeValue:$,useRawValueToEscape:j,prefix:_e,prefixEscaped:et,suffix:tt,suffixEscaped:rt,formatSeparator:nt,unescapeSuffix:it,unescapePrefix:st,nestingPrefix:at,nestingPrefixEscaped:ot,nestingSuffix:lt,nestingSuffixEscaped:ct,nestingOptionsSeparator:ft,maxReplaces:ut,alwaysFormat:ht}=i.interpolation;this.escape=_!==void 0?_:escape$1,this.escapeValue=$!==void 0?$:!0,this.useRawValueToEscape=j!==void 0?j:!1,this.prefix=_e?regexEscape(_e):et||"{{",this.suffix=tt?regexEscape(tt):rt||"}}",this.formatSeparator=nt||",",this.unescapePrefix=it?"":st||"-",this.unescapeSuffix=this.unescapePrefix?"":it||"",this.nestingPrefix=at?regexEscape(at):ot||regexEscape("$t("),this.nestingSuffix=lt?regexEscape(lt):ct||regexEscape(")"),this.nestingOptionsSeparator=ft||",",this.maxReplaces=ut||1e3,this.alwaysFormat=ht!==void 0?ht:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const i=(_,$)=>(_==null?void 0:_.source)===$?(_.lastIndex=0,_):new RegExp($,"g");this.regexp=i(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=i(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=i(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(i,_,$,j){var ot;let _e,et,tt;const rt=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},nt=lt=>{if(lt.indexOf(this.formatSeparator)<0){const ht=deepFindWithDefaults(_,rt,lt,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(ht,void 0,$,{...j,..._,interpolationkey:lt}):ht}const ct=lt.split(this.formatSeparator),ft=ct.shift().trim(),ut=ct.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(_,rt,ft,this.options.keySeparator,this.options.ignoreJSONStructure),ut,$,{...j,..._,interpolationkey:ft})};this.resetRegExp();const it=(j==null?void 0:j.missingInterpolationHandler)||this.options.missingInterpolationHandler,st=((ot=j==null?void 0:j.interpolation)==null?void 0:ot.skipOnVariables)!==void 0?j.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:lt=>regexSafe(lt)},{regex:this.regexp,safeValue:lt=>this.escapeValue?regexSafe(this.escape(lt)):regexSafe(lt)}].forEach(lt=>{for(tt=0;_e=lt.regex.exec(i);){const ct=_e[1].trim();if(et=nt(ct),et===void 0)if(typeof it=="function"){const ut=it(i,_e,j);et=isString(ut)?ut:""}else if(j&&Object.prototype.hasOwnProperty.call(j,ct))et="";else if(st){et=_e[0];continue}else this.logger.warn(`missed to pass in variable ${ct} for interpolating ${i}`),et="";else!isString(et)&&!this.useRawValueToEscape&&(et=makeString(et));const ft=lt.safeValue(et);if(i=i.replace(_e[0],ft),st?(lt.regex.lastIndex+=et.length,lt.regex.lastIndex-=_e[0].length):lt.regex.lastIndex=0,tt++,tt>=this.maxReplaces)break}}),i}nest(i,_,$={}){let j,_e,et;const tt=(rt,nt)=>{const it=this.nestingOptionsSeparator;if(rt.indexOf(it)<0)return rt;const st=rt.split(new RegExp(`${it}[ ]*{`));let at=`{${st[1]}`;rt=st[0],at=this.interpolate(at,et);const ot=at.match(/'/g),lt=at.match(/"/g);(((ot==null?void 0:ot.length)??0)%2===0&&!lt||lt.length%2!==0)&&(at=at.replace(/'/g,'"'));try{et=JSON.parse(at),nt&&(et={...nt,...et})}catch(ct){return this.logger.warn(`failed parsing options string in nesting for key ${rt}`,ct),`${rt}${it}${at}`}return et.defaultValue&&et.defaultValue.indexOf(this.prefix)>-1&&delete et.defaultValue,rt};for(;j=this.nestingRegexp.exec(i);){let rt=[];et={...$},et=et.replace&&!isString(et.replace)?et.replace:et,et.applyPostProcessor=!1,delete et.defaultValue;const nt=/{.*}/.test(j[1])?j[1].lastIndexOf("}")+1:j[1].indexOf(this.formatSeparator);if(nt!==-1&&(rt=j[1].slice(nt).split(this.formatSeparator).map(it=>it.trim()).filter(Boolean),j[1]=j[1].slice(0,nt)),_e=_(tt.call(this,j[1].trim(),et),et),_e&&j[0]===i&&!isString(_e))return _e;isString(_e)||(_e=makeString(_e)),_e||(this.logger.warn(`missed to resolve ${j[1]} for nesting ${i}`),_e=""),rt.length&&(_e=rt.reduce((it,st)=>this.format(it,st,$.lng,{...$,interpolationkey:j[1].trim()}),_e.trim())),i=i.replace(j[0],_e),this.regexp.lastIndex=0}return i}}const parseFormatStr=o=>{let i=o.toLowerCase().trim();const _={};if(o.indexOf("(")>-1){const $=o.split("(");i=$[0].toLowerCase().trim();const j=$[1].substring(0,$[1].length-1);i==="currency"&&j.indexOf(":")<0?_.currency||(_.currency=j.trim()):i==="relativetime"&&j.indexOf(":")<0?_.range||(_.range=j.trim()):j.split(";").forEach(et=>{if(et){const[tt,...rt]=et.split(":"),nt=rt.join(":").trim().replace(/^'+|'+$/g,""),it=tt.trim();_[it]||(_[it]=nt),nt==="false"&&(_[it]=!1),nt==="true"&&(_[it]=!0),isNaN(nt)||(_[it]=parseInt(nt,10))}})}return{formatName:i,formatOptions:_}},createCachedFormatter=o=>{const i={};return(_,$,j)=>{let _e=j;j&&j.interpolationkey&&j.formatParams&&j.formatParams[j.interpolationkey]&&j[j.interpolationkey]&&(_e={..._e,[j.interpolationkey]:void 0});const et=$+JSON.stringify(_e);let tt=i[et];return tt||(tt=o(getCleanedCode($),j),i[et]=tt),tt(_)}},createNonCachedFormatter=o=>(i,_,$)=>o(getCleanedCode(_),$)(i);class Formatter{constructor(i={}){this.logger=baseLogger.create("formatter"),this.options=i,this.init(i)}init(i,_={interpolation:{}}){this.formatSeparator=_.interpolation.formatSeparator||",";const $=_.cacheInBuiltFormats?createCachedFormatter:createNonCachedFormatter;this.formats={number:$((j,_e)=>{const et=new Intl.NumberFormat(j,{..._e});return tt=>et.format(tt)}),currency:$((j,_e)=>{const et=new Intl.NumberFormat(j,{..._e,style:"currency"});return tt=>et.format(tt)}),datetime:$((j,_e)=>{const et=new Intl.DateTimeFormat(j,{..._e});return tt=>et.format(tt)}),relativetime:$((j,_e)=>{const et=new Intl.RelativeTimeFormat(j,{..._e});return tt=>et.format(tt,_e.range||"day")}),list:$((j,_e)=>{const et=new Intl.ListFormat(j,{..._e});return tt=>et.format(tt)})}}add(i,_){this.formats[i.toLowerCase().trim()]=_}addCached(i,_){this.formats[i.toLowerCase().trim()]=createCachedFormatter(_)}format(i,_,$,j={}){const _e=_.split(this.formatSeparator);if(_e.length>1&&_e[0].indexOf("(")>1&&_e[0].indexOf(")")<0&&_e.find(tt=>tt.indexOf(")")>-1)){const tt=_e.findIndex(rt=>rt.indexOf(")")>-1);_e[0]=[_e[0],..._e.splice(1,tt)].join(this.formatSeparator)}return _e.reduce((tt,rt)=>{var st;const{formatName:nt,formatOptions:it}=parseFormatStr(rt);if(this.formats[nt]){let at=tt;try{const ot=((st=j==null?void 0:j.formatParams)==null?void 0:st[j.interpolationkey])||{},lt=ot.locale||ot.lng||j.locale||j.lng||$;at=this.formats[nt](tt,lt,{...it,...j,...ot})}catch(ot){this.logger.warn(ot)}return at}else this.logger.warn(`there was no format function for ${nt}`);return tt},i)}}const removePending=(o,i)=>{o.pending[i]!==void 0&&(delete o.pending[i],o.pendingCount--)};class Connector extends EventEmitter{constructor(i,_,$,j={}){var _e,et;super(),this.backend=i,this.store=_,this.services=$,this.languageUtils=$.languageUtils,this.options=j,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=j.maxParallelReads||10,this.readingCalls=0,this.maxRetries=j.maxRetries>=0?j.maxRetries:5,this.retryTimeout=j.retryTimeout>=1?j.retryTimeout:350,this.state={},this.queue=[],(et=(_e=this.backend)==null?void 0:_e.init)==null||et.call(_e,$,j.backend,j)}queueLoad(i,_,$,j){const _e={},et={},tt={},rt={};return i.forEach(nt=>{let it=!0;_.forEach(st=>{const at=`${nt}|${st}`;!$.reload&&this.store.hasResourceBundle(nt,st)?this.state[at]=2:this.state[at]<0||(this.state[at]===1?et[at]===void 0&&(et[at]=!0):(this.state[at]=1,it=!1,et[at]===void 0&&(et[at]=!0),_e[at]===void 0&&(_e[at]=!0),rt[st]===void 0&&(rt[st]=!0)))}),it||(tt[nt]=!0)}),(Object.keys(_e).length||Object.keys(et).length)&&this.queue.push({pending:et,pendingCount:Object.keys(et).length,loaded:{},errors:[],callback:j}),{toLoad:Object.keys(_e),pending:Object.keys(et),toLoadLanguages:Object.keys(tt),toLoadNamespaces:Object.keys(rt)}}loaded(i,_,$){const j=i.split("|"),_e=j[0],et=j[1];_&&this.emit("failedLoading",_e,et,_),!_&&$&&this.store.addResourceBundle(_e,et,$,void 0,void 0,{skipCopy:!0}),this.state[i]=_?-1:2,_&&$&&(this.state[i]=0);const tt={};this.queue.forEach(rt=>{pushPath(rt.loaded,[_e],et),removePending(rt,i),_&&rt.errors.push(_),rt.pendingCount===0&&!rt.done&&(Object.keys(rt.loaded).forEach(nt=>{tt[nt]||(tt[nt]={});const it=rt.loaded[nt];it.length&&it.forEach(st=>{tt[nt][st]===void 0&&(tt[nt][st]=!0)})}),rt.done=!0,rt.errors.length?rt.callback(rt.errors):rt.callback())}),this.emit("loaded",tt),this.queue=this.queue.filter(rt=>!rt.done)}read(i,_,$,j=0,_e=this.retryTimeout,et){if(!i.length)return et(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:i,ns:_,fcName:$,tried:j,wait:_e,callback:et});return}this.readingCalls++;const tt=(nt,it)=>{if(this.readingCalls--,this.waitingReads.length>0){const st=this.waitingReads.shift();this.read(st.lng,st.ns,st.fcName,st.tried,st.wait,st.callback)}if(nt&&it&&j<this.maxRetries){setTimeout(()=>{this.read.call(this,i,_,$,j+1,_e*2,et)},_e);return}et(nt,it)},rt=this.backend[$].bind(this.backend);if(rt.length===2){try{const nt=rt(i,_);nt&&typeof nt.then=="function"?nt.then(it=>tt(null,it)).catch(tt):tt(null,nt)}catch(nt){tt(nt)}return}return rt(i,_,tt)}prepareLoading(i,_,$={},j){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),j&&j();isString(i)&&(i=this.languageUtils.toResolveHierarchy(i)),isString(_)&&(_=[_]);const _e=this.queueLoad(i,_,$,j);if(!_e.toLoad.length)return _e.pending.length||j(),null;_e.toLoad.forEach(et=>{this.loadOne(et)})}load(i,_,$){this.prepareLoading(i,_,{},$)}reload(i,_,$){this.prepareLoading(i,_,{reload:!0},$)}loadOne(i,_=""){const $=i.split("|"),j=$[0],_e=$[1];this.read(j,_e,"read",void 0,void 0,(et,tt)=>{et&&this.logger.warn(`${_}loading namespace ${_e} for language ${j} failed`,et),!et&&tt&&this.logger.log(`${_}loaded namespace ${_e} for language ${j}`,tt),this.loaded(i,et,tt)})}saveMissing(i,_,$,j,_e,et={},tt=()=>{}){var rt,nt,it,st,at;if((nt=(rt=this.services)==null?void 0:rt.utils)!=null&&nt.hasLoadedNamespace&&!((st=(it=this.services)==null?void 0:it.utils)!=null&&st.hasLoadedNamespace(_))){this.logger.warn(`did not save key "${$}" as the namespace "${_}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!($==null||$==="")){if((at=this.backend)!=null&&at.create){const ot={...et,isUpdate:_e},lt=this.backend.create.bind(this.backend);if(lt.length<6)try{let ct;lt.length===5?ct=lt(i,_,$,j,ot):ct=lt(i,_,$,j),ct&&typeof ct.then=="function"?ct.then(ft=>tt(null,ft)).catch(tt):tt(null,ct)}catch(ct){tt(ct)}else lt(i,_,$,j,tt,ot)}!i||!i[0]||this.store.addResource(i[0],_,$,j)}}}const get=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:o=>{let i={};if(typeof o[1]=="object"&&(i=o[1]),isString(o[1])&&(i.defaultValue=o[1]),isString(o[2])&&(i.tDescription=o[2]),typeof o[2]=="object"||typeof o[3]=="object"){const _=o[3]||o[2];Object.keys(_).forEach($=>{i[$]=_[$]})}return i},interpolation:{escapeValue:!0,format:o=>o,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),transformOptions=o=>{var i,_;return isString(o.ns)&&(o.ns=[o.ns]),isString(o.fallbackLng)&&(o.fallbackLng=[o.fallbackLng]),isString(o.fallbackNS)&&(o.fallbackNS=[o.fallbackNS]),((_=(i=o.supportedLngs)==null?void 0:i.indexOf)==null?void 0:_.call(i,"cimode"))<0&&(o.supportedLngs=o.supportedLngs.concat(["cimode"])),typeof o.initImmediate=="boolean"&&(o.initAsync=o.initImmediate),o},noop=()=>{},bindMemberFunctions=o=>{Object.getOwnPropertyNames(Object.getPrototypeOf(o)).forEach(_=>{typeof o[_]=="function"&&(o[_]=o[_].bind(o))})};class I18n extends EventEmitter{constructor(i={},_){if(super(),this.options=transformOptions(i),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),_&&!this.isInitialized&&!i.isClone){if(!this.options.initAsync)return this.init(i,_),this;setTimeout(()=>{this.init(i,_)},0)}}init(i={},_){this.isInitializing=!0,typeof i=="function"&&(_=i,i={}),i.defaultNS==null&&i.ns&&(isString(i.ns)?i.defaultNS=i.ns:i.ns.indexOf("translation")<0&&(i.defaultNS=i.ns[0]));const $=get();this.options={...$,...this.options,...transformOptions(i)},this.options.interpolation={...$.interpolation,...this.options.interpolation},i.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=i.keySeparator),i.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=i.nsSeparator);const j=nt=>nt?typeof nt=="function"?new nt:nt:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(j(this.modules.logger),this.options):baseLogger.init(null,this.options);let nt;this.modules.formatter?nt=this.modules.formatter:nt=Formatter;const it=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const st=this.services;st.logger=baseLogger,st.resourceStore=this.store,st.languageUtils=it,st.pluralResolver=new PluralResolver(it,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==$.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),nt&&(!this.options.interpolation.format||this.options.interpolation.format===$.interpolation.format)&&(st.formatter=j(nt),st.formatter.init&&st.formatter.init(st,this.options),this.options.interpolation.format=st.formatter.format.bind(st.formatter)),st.interpolator=new Interpolator(this.options),st.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},st.backendConnector=new Connector(j(this.modules.backend),st.resourceStore,st,this.options),st.backendConnector.on("*",(ot,...lt)=>{this.emit(ot,...lt)}),this.modules.languageDetector&&(st.languageDetector=j(this.modules.languageDetector),st.languageDetector.init&&st.languageDetector.init(st,this.options.detection,this.options)),this.modules.i18nFormat&&(st.i18nFormat=j(this.modules.i18nFormat),st.i18nFormat.init&&st.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",(ot,...lt)=>{this.emit(ot,...lt)}),this.modules.external.forEach(ot=>{ot.init&&ot.init(this)})}if(this.format=this.options.interpolation.format,_||(_=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const nt=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);nt.length>0&&nt[0]!=="dev"&&(this.options.lng=nt[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(nt=>{this[nt]=(...it)=>this.store[nt](...it)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(nt=>{this[nt]=(...it)=>(this.store[nt](...it),this)});const tt=defer(),rt=()=>{const nt=(it,st)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),tt.resolve(st),_(it,st)};if(this.languages&&!this.isInitialized)return nt(null,this.t.bind(this));this.changeLanguage(this.options.lng,nt)};return this.options.resources||!this.options.initAsync?rt():setTimeout(rt,0),tt}loadResources(i,_=noop){var _e,et;let $=_;const j=isString(i)?i:this.language;if(typeof i=="function"&&($=i),!this.options.resources||this.options.partialBundledLanguages){if((j==null?void 0:j.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return $();const tt=[],rt=nt=>{if(!nt||nt==="cimode")return;this.services.languageUtils.toResolveHierarchy(nt).forEach(st=>{st!=="cimode"&&tt.indexOf(st)<0&&tt.push(st)})};j?rt(j):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(it=>rt(it)),(et=(_e=this.options.preload)==null?void 0:_e.forEach)==null||et.call(_e,nt=>rt(nt)),this.services.backendConnector.load(tt,this.options.ns,nt=>{!nt&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),$(nt)})}else $(null)}reloadResources(i,_,$){const j=defer();return typeof i=="function"&&($=i,i=void 0),typeof _=="function"&&($=_,_=void 0),i||(i=this.languages),_||(_=this.options.ns),$||($=noop),this.services.backendConnector.reload(i,_,_e=>{j.resolve(),$(_e)}),j}use(i){if(!i)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!i.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return i.type==="backend"&&(this.modules.backend=i),(i.type==="logger"||i.log&&i.warn&&i.error)&&(this.modules.logger=i),i.type==="languageDetector"&&(this.modules.languageDetector=i),i.type==="i18nFormat"&&(this.modules.i18nFormat=i),i.type==="postProcessor"&&postProcessor.addPostProcessor(i),i.type==="formatter"&&(this.modules.formatter=i),i.type==="3rdParty"&&this.modules.external.push(i),this}setResolvedLanguage(i){if(!(!i||!this.languages)&&!(["cimode","dev"].indexOf(i)>-1)){for(let _=0;_<this.languages.length;_++){const $=this.languages[_];if(!(["cimode","dev"].indexOf($)>-1)&&this.store.hasLanguageSomeTranslations($)){this.resolvedLanguage=$;break}}!this.resolvedLanguage&&this.languages.indexOf(i)<0&&this.store.hasLanguageSomeTranslations(i)&&(this.resolvedLanguage=i,this.languages.unshift(i))}}changeLanguage(i,_){this.isLanguageChangingTo=i;const $=defer();this.emit("languageChanging",i);const j=tt=>{this.language=tt,this.languages=this.services.languageUtils.toResolveHierarchy(tt),this.resolvedLanguage=void 0,this.setResolvedLanguage(tt)},_e=(tt,rt)=>{rt?this.isLanguageChangingTo===i&&(j(rt),this.translator.changeLanguage(rt),this.isLanguageChangingTo=void 0,this.emit("languageChanged",rt),this.logger.log("languageChanged",rt)):this.isLanguageChangingTo=void 0,$.resolve((...nt)=>this.t(...nt)),_&&_(tt,(...nt)=>this.t(...nt))},et=tt=>{var it,st;!i&&!tt&&this.services.languageDetector&&(tt=[]);const rt=isString(tt)?tt:tt&&tt[0],nt=this.store.hasLanguageSomeTranslations(rt)?rt:this.services.languageUtils.getBestMatchFromCodes(isString(tt)?[tt]:tt);nt&&(this.language||j(nt),this.translator.language||this.translator.changeLanguage(nt),(st=(it=this.services.languageDetector)==null?void 0:it.cacheUserLanguage)==null||st.call(it,nt)),this.loadResources(nt,at=>{_e(at,nt)})};return!i&&this.services.languageDetector&&!this.services.languageDetector.async?et(this.services.languageDetector.detect()):!i&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(et):this.services.languageDetector.detect(et):et(i),$}getFixedT(i,_,$){const j=(_e,et,...tt)=>{let rt;typeof et!="object"?rt=this.options.overloadTranslationOptionHandler([_e,et].concat(tt)):rt={...et},rt.lng=rt.lng||j.lng,rt.lngs=rt.lngs||j.lngs,rt.ns=rt.ns||j.ns,rt.keyPrefix!==""&&(rt.keyPrefix=rt.keyPrefix||$||j.keyPrefix);const nt=this.options.keySeparator||".";let it;return rt.keyPrefix&&Array.isArray(_e)?it=_e.map(st=>(typeof st=="function"&&(st=keysFromSelector(st,{...this.options,...et})),`${rt.keyPrefix}${nt}${st}`)):(typeof _e=="function"&&(_e=keysFromSelector(_e,{...this.options,...et})),it=rt.keyPrefix?`${rt.keyPrefix}${nt}${_e}`:_e),this.t(it,rt)};return isString(i)?j.lng=i:j.lngs=i,j.ns=_,j.keyPrefix=$,j}t(...i){var _;return(_=this.translator)==null?void 0:_.translate(...i)}exists(...i){var _;return(_=this.translator)==null?void 0:_.exists(...i)}setDefaultNamespace(i){this.options.defaultNS=i}hasLoadedNamespace(i,_={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const $=_.lng||this.resolvedLanguage||this.languages[0],j=this.options?this.options.fallbackLng:!1,_e=this.languages[this.languages.length-1];if($.toLowerCase()==="cimode")return!0;const et=(tt,rt)=>{const nt=this.services.backendConnector.state[`${tt}|${rt}`];return nt===-1||nt===0||nt===2};if(_.precheck){const tt=_.precheck(this,et);if(tt!==void 0)return tt}return!!(this.hasResourceBundle($,i)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||et($,i)&&(!j||et(_e,i)))}loadNamespaces(i,_){const $=defer();return this.options.ns?(isString(i)&&(i=[i]),i.forEach(j=>{this.options.ns.indexOf(j)<0&&this.options.ns.push(j)}),this.loadResources(j=>{$.resolve(),_&&_(j)}),$):(_&&_(),Promise.resolve())}loadLanguages(i,_){const $=defer();isString(i)&&(i=[i]);const j=this.options.preload||[],_e=i.filter(et=>j.indexOf(et)<0&&this.services.languageUtils.isSupportedCode(et));return _e.length?(this.options.preload=j.concat(_e),this.loadResources(et=>{$.resolve(),_&&_(et)}),$):(_&&_(),Promise.resolve())}dir(i){var j,_e;if(i||(i=this.resolvedLanguage||(((j=this.languages)==null?void 0:j.length)>0?this.languages[0]:this.language)),!i)return"rtl";try{const et=new Intl.Locale(i);if(et&&et.getTextInfo){const tt=et.getTextInfo();if(tt&&tt.direction)return tt.direction}}catch{}const _=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],$=((_e=this.services)==null?void 0:_e.languageUtils)||new LanguageUtil(get());return i.toLowerCase().indexOf("-latn")>1?"ltr":_.indexOf($.getLanguagePartFromCode(i))>-1||i.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(i={},_){return new I18n(i,_)}cloneInstance(i={},_=noop){const $=i.forkResourceStore;$&&delete i.forkResourceStore;const j={...this.options,...i,isClone:!0},_e=new I18n(j);if((i.debug!==void 0||i.prefix!==void 0)&&(_e.logger=_e.logger.clone(i)),["store","services","language"].forEach(tt=>{_e[tt]=this[tt]}),_e.services={...this.services},_e.services.utils={hasLoadedNamespace:_e.hasLoadedNamespace.bind(_e)},$){const tt=Object.keys(this.store.data).reduce((rt,nt)=>(rt[nt]={...this.store.data[nt]},rt[nt]=Object.keys(rt[nt]).reduce((it,st)=>(it[st]={...rt[nt][st]},it),rt[nt]),rt),{});_e.store=new ResourceStore(tt,j),_e.services.resourceStore=_e.store}return _e.translator=new Translator(_e.services,j),_e.translator.on("*",(tt,...rt)=>{_e.emit(tt,...rt)}),_e.init(j,_),_e.translator.options=j,_e.translator.backendConnector.services.utils={hasLoadedNamespace:_e.hasLoadedNamespace.bind(_e)},_e}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=o=>htmlEntities[o],unescape$1=o=>o.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:unescape$1};const setDefaults=(o={})=>{defaultOptions={...defaultOptions,...o}},initReactI18next={type:"3rdParty",init(o){setDefaults(o.options.react)}},{slice,forEach}=[];function defaults(o){return forEach.call(slice.call(arguments,1),i=>{if(i)for(const _ in i)o[_]===void 0&&(o[_]=i[_])}),o}function hasXSS(o){return typeof o!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(_=>_.test(o))}const fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,serializeCookie=function(o,i){const $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},j=encodeURIComponent(i);let _e=`${o}=${j}`;if($.maxAge>0){const et=$.maxAge-0;if(Number.isNaN(et))throw new Error("maxAge should be a Number");_e+=`; Max-Age=${Math.floor(et)}`}if($.domain){if(!fieldContentRegExp.test($.domain))throw new TypeError("option domain is invalid");_e+=`; Domain=${$.domain}`}if($.path){if(!fieldContentRegExp.test($.path))throw new TypeError("option path is invalid");_e+=`; Path=${$.path}`}if($.expires){if(typeof $.expires.toUTCString!="function")throw new TypeError("option expires is invalid");_e+=`; Expires=${$.expires.toUTCString()}`}if($.httpOnly&&(_e+="; HttpOnly"),$.secure&&(_e+="; Secure"),$.sameSite)switch(typeof $.sameSite=="string"?$.sameSite.toLowerCase():$.sameSite){case!0:_e+="; SameSite=Strict";break;case"lax":_e+="; SameSite=Lax";break;case"strict":_e+="; SameSite=Strict";break;case"none":_e+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return $.partitioned&&(_e+="; Partitioned"),_e},cookie={create(o,i,_,$){let j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};_&&(j.expires=new Date,j.expires.setTime(j.expires.getTime()+_*60*1e3)),$&&(j.domain=$),document.cookie=serializeCookie(o,i,j)},read(o){const i=`${o}=`,_=document.cookie.split(";");for(let $=0;$<_.length;$++){let j=_[$];for(;j.charAt(0)===" ";)j=j.substring(1,j.length);if(j.indexOf(i)===0)return j.substring(i.length,j.length)}return null},remove(o,i){this.create(o,"",-1,i)}};var cookie$1={name:"cookie",lookup(o){let{lookupCookie:i}=o;if(i&&typeof document<"u")return cookie.read(i)||void 0},cacheUserLanguage(o,i){let{lookupCookie:_,cookieMinutes:$,cookieDomain:j,cookieOptions:_e}=i;_&&typeof document<"u"&&cookie.create(_,o,$,j,_e)}},querystring={name:"querystring",lookup(o){var $;let{lookupQuerystring:i}=o,_;if(typeof window<"u"){let{search:j}=window.location;!window.location.search&&(($=window.location.hash)==null?void 0:$.indexOf("?"))>-1&&(j=window.location.hash.substring(window.location.hash.indexOf("?")));const et=j.substring(1).split("&");for(let tt=0;tt<et.length;tt++){const rt=et[tt].indexOf("=");rt>0&&et[tt].substring(0,rt)===i&&(_=et[tt].substring(rt+1))}}return _}},hash={name:"hash",lookup(o){var j;let{lookupHash:i,lookupFromHashIndex:_}=o,$;if(typeof window<"u"){const{hash:_e}=window.location;if(_e&&_e.length>2){const et=_e.substring(1);if(i){const tt=et.split("&");for(let rt=0;rt<tt.length;rt++){const nt=tt[rt].indexOf("=");nt>0&&tt[rt].substring(0,nt)===i&&($=tt[rt].substring(nt+1))}}if($)return $;if(!$&&_>-1){const tt=_e.match(/\/([a-zA-Z-]*)/g);return Array.isArray(tt)?(j=tt[typeof _=="number"?_:0])==null?void 0:j.replace("/",""):void 0}}}return $}};let hasLocalStorageSupport=null;const localStorageAvailable=()=>{if(hasLocalStorageSupport!==null)return hasLocalStorageSupport;try{if(hasLocalStorageSupport=typeof window<"u"&&window.localStorage!==null,!hasLocalStorageSupport)return!1;const o="i18next.translate.boo";window.localStorage.setItem(o,"foo"),window.localStorage.removeItem(o)}catch{hasLocalStorageSupport=!1}return hasLocalStorageSupport};var localStorage$1={name:"localStorage",lookup(o){let{lookupLocalStorage:i}=o;if(i&&localStorageAvailable())return window.localStorage.getItem(i)||void 0},cacheUserLanguage(o,i){let{lookupLocalStorage:_}=i;_&&localStorageAvailable()&&window.localStorage.setItem(_,o)}};let hasSessionStorageSupport=null;const sessionStorageAvailable=()=>{if(hasSessionStorageSupport!==null)return hasSessionStorageSupport;try{if(hasSessionStorageSupport=typeof window<"u"&&window.sessionStorage!==null,!hasSessionStorageSupport)return!1;const o="i18next.translate.boo";window.sessionStorage.setItem(o,"foo"),window.sessionStorage.removeItem(o)}catch{hasSessionStorageSupport=!1}return hasSessionStorageSupport};var sessionStorage={name:"sessionStorage",lookup(o){let{lookupSessionStorage:i}=o;if(i&&sessionStorageAvailable())return window.sessionStorage.getItem(i)||void 0},cacheUserLanguage(o,i){let{lookupSessionStorage:_}=i;_&&sessionStorageAvailable()&&window.sessionStorage.setItem(_,o)}},navigator$1={name:"navigator",lookup(o){const i=[];if(typeof navigator<"u"){const{languages:_,userLanguage:$,language:j}=navigator;if(_)for(let _e=0;_e<_.length;_e++)i.push(_[_e]);$&&i.push($),j&&i.push(j)}return i.length>0?i:void 0}},htmlTag={name:"htmlTag",lookup(o){let{htmlTag:i}=o,_;const $=i||(typeof document<"u"?document.documentElement:null);return $&&typeof $.getAttribute=="function"&&(_=$.getAttribute("lang")),_}},path={name:"path",lookup(o){var j;let{lookupFromPathIndex:i}=o;if(typeof window>"u")return;const _=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(_)?(j=_[typeof i=="number"?i:0])==null?void 0:j.replace("/",""):void 0}},subdomain={name:"subdomain",lookup(o){var j,_e;let{lookupFromSubdomainIndex:i}=o;const _=typeof i=="number"?i+1:1,$=typeof window<"u"&&((_e=(j=window.location)==null?void 0:j.hostname)==null?void 0:_e.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if($)return $[_]}};let canCookies=!1;try{document.cookie,canCookies=!0}catch(o){}const order=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];canCookies||order.splice(1,1);const getDefaults=()=>({order,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:o=>o});class Browser{constructor(i){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(i,_)}init(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=i,this.options=defaults(_,this.options||{},getDefaults()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=j=>j.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=$,this.addDetector(cookie$1),this.addDetector(querystring),this.addDetector(localStorage$1),this.addDetector(sessionStorage),this.addDetector(navigator$1),this.addDetector(htmlTag),this.addDetector(path),this.addDetector(subdomain),this.addDetector(hash)}addDetector(i){return this.detectors[i.name]=i,this}detect(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,_=[];return i.forEach($=>{if(this.detectors[$]){let j=this.detectors[$].lookup(this.options);j&&typeof j=="string"&&(j=[j]),j&&(_=_.concat(j))}}),_=_.filter($=>$!=null&&!hasXSS($)).map($=>this.options.convertDetectedLanguage($)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?_:_.length>0?_[0]:null}cacheUserLanguage(i){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;_&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(i)>-1||_.forEach($=>{this.detectors[$]&&this.detectors[$].cacheUserLanguage(i,this.options)}))}}Browser.type="languageDetector";const appName$1="StudyForge",tagline$1="     ",getStarted$1=" ",learnMore$1=" ",home$1="",dashboard$1=" ",subjects$1="",settings$1="",onboarding$1="",login$1=" ",signup$1=" ",logout$1=" ",email$1=" ",password$1=" ",language$1="",arabic$1="",english$1="",theme$1="",light$1="",dark$1="",highContrast$1=" ",disableMotion$1=" ",studyMode$1=" ",save$1="",notes$1="",video$1="",audio$1="",pdf$1="PDF",progress$1="",quiz$1="",search$1="",arCommon={appName:appName$1,tagline:tagline$1,getStarted:getStarted$1,learnMore:learnMore$1,home:home$1,dashboard:dashboard$1,subjects:subjects$1,settings:settings$1,onboarding:onboarding$1,login:login$1,signup:signup$1,logout:logout$1,email:email$1,password:password$1,language:language$1,arabic:arabic$1,english:english$1,theme:theme$1,light:light$1,dark:dark$1,highContrast:highContrast$1,disableMotion:disableMotion$1,studyMode:studyMode$1,save:save$1,notes:notes$1,video:video$1,audio:audio$1,pdf:pdf$1,progress:progress$1,quiz:quiz$1,search:search$1},appName="StudyForge",tagline="Offline-first study platform",getStarted="Get Started",learnMore="Learn More",home="Home",dashboard="Dashboard",subjects="Subjects",settings="Settings",onboarding="Onboarding",login="Login",signup="Sign up",logout="Logout",email="Email",password="Password",language="Language",arabic="Arabic",english="English",theme="Theme",light="Light",dark="Dark",highContrast="High Contrast",disableMotion="Disable Motion",studyMode="Study Mode",save="Save",notes="Notes",video="Video",audio="Audio",pdf="PDF",progress="Progress",quiz="Quiz",search="Search",enCommon={appName,tagline,getStarted,learnMore,home,dashboard,subjects,settings,onboarding,login,signup,logout,email,password,language,arabic,english,theme,light,dark,highContrast,disableMotion,studyMode,save,notes,video,audio,pdf,progress,quiz,search},resources={ar:{common:arCommon},en:{common:enCommon}};instance.use(Browser).use(initReactI18next).init({resources,fallbackLng:"ar",lng:"ar",ns:["common"],defaultNS:"common",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});function App(){const{language:o,theme:i}=useSettingsStore(),{init:_}=useAuthStore();return reactExports.useEffect(()=>{_()},[_]),reactExports.useEffect(()=>{document.documentElement.lang=o==="ar"?"ar":"en",document.documentElement.dir=o==="ar"?"rtl":"ltr",document.documentElement.setAttribute("data-theme",i)},[o,i]),jsxRuntimeExports.jsx(RouterProvider,{router})}createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
